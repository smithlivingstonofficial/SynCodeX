const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/javascript-CiXt6nTG.js","assets/typescript-Di23Ihxc.js"])))=>i.map(i=>d[i]);
var Ywe=Object.defineProperty;var Xwe=(s,e,t)=>e in s?Ywe(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var es=(s,e,t)=>Xwe(s,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=t(n);fetch(n.href,r)}})();var PT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Cae(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var r9={exports:{}},ux={},o9={exports:{}},Di={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vZ;function Zwe(){if(vZ)return Di;vZ=1;var s=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),r=Symbol.for("react.provider"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),u=Symbol.iterator;function h(J){return J===null||typeof J!="object"?null:(J=u&&J[u]||J["@@iterator"],typeof J=="function"?J:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p=Object.assign,_={};function v(J,we,Ae){this.props=J,this.context=we,this.refs=_,this.updater=Ae||g}v.prototype.isReactComponent={},v.prototype.setState=function(J,we){if(typeof J!="object"&&typeof J!="function"&&J!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,J,we,"setState")},v.prototype.forceUpdate=function(J){this.updater.enqueueForceUpdate(this,J,"forceUpdate")};function C(){}C.prototype=v.prototype;function y(J,we,Ae){this.props=J,this.context=we,this.refs=_,this.updater=Ae||g}var x=y.prototype=new C;x.constructor=y,p(x,v.prototype),x.isPureReactComponent=!0;var L=Array.isArray,I=Object.prototype.hasOwnProperty,A={current:null},D={key:!0,ref:!0,__self:!0,__source:!0};function N(J,we,Ae){var ot,tt={},It=null,si=null;if(we!=null)for(ot in we.ref!==void 0&&(si=we.ref),we.key!==void 0&&(It=""+we.key),we)I.call(we,ot)&&!D.hasOwnProperty(ot)&&(tt[ot]=we[ot]);var ai=arguments.length-2;if(ai===1)tt.children=Ae;else if(1<ai){for(var Ii=Array(ai),rn=0;rn<ai;rn++)Ii[rn]=arguments[rn+2];tt.children=Ii}if(J&&J.defaultProps)for(ot in ai=J.defaultProps,ai)tt[ot]===void 0&&(tt[ot]=ai[ot]);return{$$typeof:s,type:J,key:It,ref:si,props:tt,_owner:A.current}}function R(J,we){return{$$typeof:s,type:J.type,key:we,ref:J.ref,props:J.props,_owner:J._owner}}function W(J){return typeof J=="object"&&J!==null&&J.$$typeof===s}function H(J){var we={"=":"=0",":":"=2"};return"$"+J.replace(/[=:]/g,function(Ae){return we[Ae]})}var U=/\/+/g;function B(J,we){return typeof J=="object"&&J!==null&&J.key!=null?H(""+J.key):we.toString(36)}function ee(J,we,Ae,ot,tt){var It=typeof J;(It==="undefined"||It==="boolean")&&(J=null);var si=!1;if(J===null)si=!0;else switch(It){case"string":case"number":si=!0;break;case"object":switch(J.$$typeof){case s:case e:si=!0}}if(si)return si=J,tt=tt(si),J=ot===""?"."+B(si,0):ot,L(tt)?(Ae="",J!=null&&(Ae=J.replace(U,"$&/")+"/"),ee(tt,we,Ae,"",function(rn){return rn})):tt!=null&&(W(tt)&&(tt=R(tt,Ae+(!tt.key||si&&si.key===tt.key?"":(""+tt.key).replace(U,"$&/")+"/")+J)),we.push(tt)),1;if(si=0,ot=ot===""?".":ot+":",L(J))for(var ai=0;ai<J.length;ai++){It=J[ai];var Ii=ot+B(It,ai);si+=ee(It,we,Ae,Ii,tt)}else if(Ii=h(J),typeof Ii=="function")for(J=Ii.call(J),ai=0;!(It=J.next()).done;)It=It.value,Ii=ot+B(It,ai++),si+=ee(It,we,Ae,Ii,tt);else if(It==="object")throw we=String(J),Error("Objects are not valid as a React child (found: "+(we==="[object Object]"?"object with keys {"+Object.keys(J).join(", ")+"}":we)+"). If you meant to render a collection of children, use an array instead.");return si}function re(J,we,Ae){if(J==null)return J;var ot=[],tt=0;return ee(J,ot,"","",function(It){return we.call(Ae,It,tt++)}),ot}function pe(J){if(J._status===-1){var we=J._result;we=we(),we.then(function(Ae){(J._status===0||J._status===-1)&&(J._status=1,J._result=Ae)},function(Ae){(J._status===0||J._status===-1)&&(J._status=2,J._result=Ae)}),J._status===-1&&(J._status=0,J._result=we)}if(J._status===1)return J._result.default;throw J._result}var Ie={current:null},ge={transition:null},_e={ReactCurrentDispatcher:Ie,ReactCurrentBatchConfig:ge,ReactCurrentOwner:A};function Re(){throw Error("act(...) is not supported in production builds of React.")}return Di.Children={map:re,forEach:function(J,we,Ae){re(J,function(){we.apply(this,arguments)},Ae)},count:function(J){var we=0;return re(J,function(){we++}),we},toArray:function(J){return re(J,function(we){return we})||[]},only:function(J){if(!W(J))throw Error("React.Children.only expected to receive a single React element child.");return J}},Di.Component=v,Di.Fragment=t,Di.Profiler=n,Di.PureComponent=y,Di.StrictMode=i,Di.Suspense=l,Di.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_e,Di.act=Re,Di.cloneElement=function(J,we,Ae){if(J==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+J+".");var ot=p({},J.props),tt=J.key,It=J.ref,si=J._owner;if(we!=null){if(we.ref!==void 0&&(It=we.ref,si=A.current),we.key!==void 0&&(tt=""+we.key),J.type&&J.type.defaultProps)var ai=J.type.defaultProps;for(Ii in we)I.call(we,Ii)&&!D.hasOwnProperty(Ii)&&(ot[Ii]=we[Ii]===void 0&&ai!==void 0?ai[Ii]:we[Ii])}var Ii=arguments.length-2;if(Ii===1)ot.children=Ae;else if(1<Ii){ai=Array(Ii);for(var rn=0;rn<Ii;rn++)ai[rn]=arguments[rn+2];ot.children=ai}return{$$typeof:s,type:J.type,key:tt,ref:It,props:ot,_owner:si}},Di.createContext=function(J){return J={$$typeof:o,_currentValue:J,_currentValue2:J,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},J.Provider={$$typeof:r,_context:J},J.Consumer=J},Di.createElement=N,Di.createFactory=function(J){var we=N.bind(null,J);return we.type=J,we},Di.createRef=function(){return{current:null}},Di.forwardRef=function(J){return{$$typeof:a,render:J}},Di.isValidElement=W,Di.lazy=function(J){return{$$typeof:d,_payload:{_status:-1,_result:J},_init:pe}},Di.memo=function(J,we){return{$$typeof:c,type:J,compare:we===void 0?null:we}},Di.startTransition=function(J){var we=ge.transition;ge.transition={};try{J()}finally{ge.transition=we}},Di.unstable_act=Re,Di.useCallback=function(J,we){return Ie.current.useCallback(J,we)},Di.useContext=function(J){return Ie.current.useContext(J)},Di.useDebugValue=function(){},Di.useDeferredValue=function(J){return Ie.current.useDeferredValue(J)},Di.useEffect=function(J,we){return Ie.current.useEffect(J,we)},Di.useId=function(){return Ie.current.useId()},Di.useImperativeHandle=function(J,we,Ae){return Ie.current.useImperativeHandle(J,we,Ae)},Di.useInsertionEffect=function(J,we){return Ie.current.useInsertionEffect(J,we)},Di.useLayoutEffect=function(J,we){return Ie.current.useLayoutEffect(J,we)},Di.useMemo=function(J,we){return Ie.current.useMemo(J,we)},Di.useReducer=function(J,we,Ae){return Ie.current.useReducer(J,we,Ae)},Di.useRef=function(J){return Ie.current.useRef(J)},Di.useState=function(J){return Ie.current.useState(J)},Di.useSyncExternalStore=function(J,we,Ae){return Ie.current.useSyncExternalStore(J,we,Ae)},Di.useTransition=function(){return Ie.current.useTransition()},Di.version="18.3.1",Di}var wZ;function t$(){return wZ||(wZ=1,o9.exports=Zwe()),o9.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CZ;function Jwe(){if(CZ)return ux;CZ=1;var s=t$(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,n=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,r={key:!0,ref:!0,__self:!0,__source:!0};function o(a,l,c){var d,u={},h=null,g=null;c!==void 0&&(h=""+c),l.key!==void 0&&(h=""+l.key),l.ref!==void 0&&(g=l.ref);for(d in l)i.call(l,d)&&!r.hasOwnProperty(d)&&(u[d]=l[d]);if(a&&a.defaultProps)for(d in l=a.defaultProps,l)u[d]===void 0&&(u[d]=l[d]);return{$$typeof:e,type:a,key:h,ref:g,props:u,_owner:n.current}}return ux.Fragment=t,ux.jsx=o,ux.jsxs=o,ux}var yZ;function e0e(){return yZ||(yZ=1,r9.exports=Jwe()),r9.exports}var E=e0e(),ie=t$();const ly=Cae(ie);var MT={},a9={exports:{}},nl={},l9={exports:{}},c9={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var SZ;function t0e(){return SZ||(SZ=1,function(s){function e(ge,_e){var Re=ge.length;ge.push(_e);e:for(;0<Re;){var J=Re-1>>>1,we=ge[J];if(0<n(we,_e))ge[J]=_e,ge[Re]=we,Re=J;else break e}}function t(ge){return ge.length===0?null:ge[0]}function i(ge){if(ge.length===0)return null;var _e=ge[0],Re=ge.pop();if(Re!==_e){ge[0]=Re;e:for(var J=0,we=ge.length,Ae=we>>>1;J<Ae;){var ot=2*(J+1)-1,tt=ge[ot],It=ot+1,si=ge[It];if(0>n(tt,Re))It<we&&0>n(si,tt)?(ge[J]=si,ge[It]=Re,J=It):(ge[J]=tt,ge[ot]=Re,J=ot);else if(It<we&&0>n(si,Re))ge[J]=si,ge[It]=Re,J=It;else break e}}return _e}function n(ge,_e){var Re=ge.sortIndex-_e.sortIndex;return Re!==0?Re:ge.id-_e.id}if(typeof performance=="object"&&typeof performance.now=="function"){var r=performance;s.unstable_now=function(){return r.now()}}else{var o=Date,a=o.now();s.unstable_now=function(){return o.now()-a}}var l=[],c=[],d=1,u=null,h=3,g=!1,p=!1,_=!1,v=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(ge){for(var _e=t(c);_e!==null;){if(_e.callback===null)i(c);else if(_e.startTime<=ge)i(c),_e.sortIndex=_e.expirationTime,e(l,_e);else break;_e=t(c)}}function L(ge){if(_=!1,x(ge),!p)if(t(l)!==null)p=!0,pe(I);else{var _e=t(c);_e!==null&&Ie(L,_e.startTime-ge)}}function I(ge,_e){p=!1,_&&(_=!1,C(N),N=-1),g=!0;var Re=h;try{for(x(_e),u=t(l);u!==null&&(!(u.expirationTime>_e)||ge&&!H());){var J=u.callback;if(typeof J=="function"){u.callback=null,h=u.priorityLevel;var we=J(u.expirationTime<=_e);_e=s.unstable_now(),typeof we=="function"?u.callback=we:u===t(l)&&i(l),x(_e)}else i(l);u=t(l)}if(u!==null)var Ae=!0;else{var ot=t(c);ot!==null&&Ie(L,ot.startTime-_e),Ae=!1}return Ae}finally{u=null,h=Re,g=!1}}var A=!1,D=null,N=-1,R=5,W=-1;function H(){return!(s.unstable_now()-W<R)}function U(){if(D!==null){var ge=s.unstable_now();W=ge;var _e=!0;try{_e=D(!0,ge)}finally{_e?B():(A=!1,D=null)}}else A=!1}var B;if(typeof y=="function")B=function(){y(U)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,re=ee.port2;ee.port1.onmessage=U,B=function(){re.postMessage(null)}}else B=function(){v(U,0)};function pe(ge){D=ge,A||(A=!0,B())}function Ie(ge,_e){N=v(function(){ge(s.unstable_now())},_e)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(ge){ge.callback=null},s.unstable_continueExecution=function(){p||g||(p=!0,pe(I))},s.unstable_forceFrameRate=function(ge){0>ge||125<ge?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<ge?Math.floor(1e3/ge):5},s.unstable_getCurrentPriorityLevel=function(){return h},s.unstable_getFirstCallbackNode=function(){return t(l)},s.unstable_next=function(ge){switch(h){case 1:case 2:case 3:var _e=3;break;default:_e=h}var Re=h;h=_e;try{return ge()}finally{h=Re}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(ge,_e){switch(ge){case 1:case 2:case 3:case 4:case 5:break;default:ge=3}var Re=h;h=ge;try{return _e()}finally{h=Re}},s.unstable_scheduleCallback=function(ge,_e,Re){var J=s.unstable_now();switch(typeof Re=="object"&&Re!==null?(Re=Re.delay,Re=typeof Re=="number"&&0<Re?J+Re:J):Re=J,ge){case 1:var we=-1;break;case 2:we=250;break;case 5:we=1073741823;break;case 4:we=1e4;break;default:we=5e3}return we=Re+we,ge={id:d++,callback:_e,priorityLevel:ge,startTime:Re,expirationTime:we,sortIndex:-1},Re>J?(ge.sortIndex=Re,e(c,ge),t(l)===null&&ge===t(c)&&(_?(C(N),N=-1):_=!0,Ie(L,Re-J))):(ge.sortIndex=we,e(l,ge),p||g||(p=!0,pe(I))),ge},s.unstable_shouldYield=H,s.unstable_wrapCallback=function(ge){var _e=h;return function(){var Re=h;h=_e;try{return ge.apply(this,arguments)}finally{h=Re}}}}(c9)),c9}var xZ;function i0e(){return xZ||(xZ=1,l9.exports=t0e()),l9.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var LZ;function n0e(){if(LZ)return nl;LZ=1;var s=t$(),e=i0e();function t(f){for(var m="https://reactjs.org/docs/error-decoder.html?invariant="+f,w=1;w<arguments.length;w++)m+="&args[]="+encodeURIComponent(arguments[w]);return"Minified React error #"+f+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,n={};function r(f,m){o(f,m),o(f+"Capture",m)}function o(f,m){for(n[f]=m,f=0;f<m.length;f++)i.add(m[f])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l=Object.prototype.hasOwnProperty,c=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},u={};function h(f){return l.call(u,f)?!0:l.call(d,f)?!1:c.test(f)?u[f]=!0:(d[f]=!0,!1)}function g(f,m,w,k){if(w!==null&&w.type===0)return!1;switch(typeof m){case"function":case"symbol":return!0;case"boolean":return k?!1:w!==null?!w.acceptsBooleans:(f=f.toLowerCase().slice(0,5),f!=="data-"&&f!=="aria-");default:return!1}}function p(f,m,w,k){if(m===null||typeof m>"u"||g(f,m,w,k))return!0;if(k)return!1;if(w!==null)switch(w.type){case 3:return!m;case 4:return m===!1;case 5:return isNaN(m);case 6:return isNaN(m)||1>m}return!1}function _(f,m,w,k,T,O,$){this.acceptsBooleans=m===2||m===3||m===4,this.attributeName=k,this.attributeNamespace=T,this.mustUseProperty=w,this.propertyName=f,this.type=m,this.sanitizeURL=O,this.removeEmptyString=$}var v={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(f){v[f]=new _(f,0,!1,f,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(f){var m=f[0];v[m]=new _(m,1,!1,f[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(f){v[f]=new _(f,2,!1,f.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(f){v[f]=new _(f,2,!1,f,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(f){v[f]=new _(f,3,!1,f.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(f){v[f]=new _(f,3,!0,f,null,!1,!1)}),["capture","download"].forEach(function(f){v[f]=new _(f,4,!1,f,null,!1,!1)}),["cols","rows","size","span"].forEach(function(f){v[f]=new _(f,6,!1,f,null,!1,!1)}),["rowSpan","start"].forEach(function(f){v[f]=new _(f,5,!1,f.toLowerCase(),null,!1,!1)});var C=/[\-:]([a-z])/g;function y(f){return f[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(f){var m=f.replace(C,y);v[m]=new _(m,1,!1,f,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(f){var m=f.replace(C,y);v[m]=new _(m,1,!1,f,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(f){var m=f.replace(C,y);v[m]=new _(m,1,!1,f,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(f){v[f]=new _(f,1,!1,f.toLowerCase(),null,!1,!1)}),v.xlinkHref=new _("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(f){v[f]=new _(f,1,!1,f.toLowerCase(),null,!0,!0)});function x(f,m,w,k){var T=v.hasOwnProperty(m)?v[m]:null;(T!==null?T.type!==0:k||!(2<m.length)||m[0]!=="o"&&m[0]!=="O"||m[1]!=="n"&&m[1]!=="N")&&(p(m,w,T,k)&&(w=null),k||T===null?h(m)&&(w===null?f.removeAttribute(m):f.setAttribute(m,""+w)):T.mustUseProperty?f[T.propertyName]=w===null?T.type===3?!1:"":w:(m=T.attributeName,k=T.attributeNamespace,w===null?f.removeAttribute(m):(T=T.type,w=T===3||T===4&&w===!0?"":""+w,k?f.setAttributeNS(k,m,w):f.setAttribute(m,w))))}var L=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,I=Symbol.for("react.element"),A=Symbol.for("react.portal"),D=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),W=Symbol.for("react.provider"),H=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),B=Symbol.for("react.suspense"),ee=Symbol.for("react.suspense_list"),re=Symbol.for("react.memo"),pe=Symbol.for("react.lazy"),Ie=Symbol.for("react.offscreen"),ge=Symbol.iterator;function _e(f){return f===null||typeof f!="object"?null:(f=ge&&f[ge]||f["@@iterator"],typeof f=="function"?f:null)}var Re=Object.assign,J;function we(f){if(J===void 0)try{throw Error()}catch(w){var m=w.stack.trim().match(/\n( *(at )?)/);J=m&&m[1]||""}return`
`+J+f}var Ae=!1;function ot(f,m){if(!f||Ae)return"";Ae=!0;var w=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(m)if(m=function(){throw Error()},Object.defineProperty(m.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(m,[])}catch(Te){var k=Te}Reflect.construct(f,[],m)}else{try{m.call()}catch(Te){k=Te}f.call(m.prototype)}else{try{throw Error()}catch(Te){k=Te}f()}}catch(Te){if(Te&&k&&typeof Te.stack=="string"){for(var T=Te.stack.split(`
`),O=k.stack.split(`
`),$=T.length-1,ne=O.length-1;1<=$&&0<=ne&&T[$]!==O[ne];)ne--;for(;1<=$&&0<=ne;$--,ne--)if(T[$]!==O[ne]){if($!==1||ne!==1)do if($--,ne--,0>ne||T[$]!==O[ne]){var ae=`
`+T[$].replace(" at new "," at ");return f.displayName&&ae.includes("<anonymous>")&&(ae=ae.replace("<anonymous>",f.displayName)),ae}while(1<=$&&0<=ne);break}}}finally{Ae=!1,Error.prepareStackTrace=w}return(f=f?f.displayName||f.name:"")?we(f):""}function tt(f){switch(f.tag){case 5:return we(f.type);case 16:return we("Lazy");case 13:return we("Suspense");case 19:return we("SuspenseList");case 0:case 2:case 15:return f=ot(f.type,!1),f;case 11:return f=ot(f.type.render,!1),f;case 1:return f=ot(f.type,!0),f;default:return""}}function It(f){if(f==null)return null;if(typeof f=="function")return f.displayName||f.name||null;if(typeof f=="string")return f;switch(f){case D:return"Fragment";case A:return"Portal";case R:return"Profiler";case N:return"StrictMode";case B:return"Suspense";case ee:return"SuspenseList"}if(typeof f=="object")switch(f.$$typeof){case H:return(f.displayName||"Context")+".Consumer";case W:return(f._context.displayName||"Context")+".Provider";case U:var m=f.render;return f=f.displayName,f||(f=m.displayName||m.name||"",f=f!==""?"ForwardRef("+f+")":"ForwardRef"),f;case re:return m=f.displayName||null,m!==null?m:It(f.type)||"Memo";case pe:m=f._payload,f=f._init;try{return It(f(m))}catch{}}return null}function si(f){var m=f.type;switch(f.tag){case 24:return"Cache";case 9:return(m.displayName||"Context")+".Consumer";case 10:return(m._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return f=m.render,f=f.displayName||f.name||"",m.displayName||(f!==""?"ForwardRef("+f+")":"ForwardRef");case 7:return"Fragment";case 5:return m;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return It(m);case 8:return m===N?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof m=="function")return m.displayName||m.name||null;if(typeof m=="string")return m}return null}function ai(f){switch(typeof f){case"boolean":case"number":case"string":case"undefined":return f;case"object":return f;default:return""}}function Ii(f){var m=f.type;return(f=f.nodeName)&&f.toLowerCase()==="input"&&(m==="checkbox"||m==="radio")}function rn(f){var m=Ii(f)?"checked":"value",w=Object.getOwnPropertyDescriptor(f.constructor.prototype,m),k=""+f[m];if(!f.hasOwnProperty(m)&&typeof w<"u"&&typeof w.get=="function"&&typeof w.set=="function"){var T=w.get,O=w.set;return Object.defineProperty(f,m,{configurable:!0,get:function(){return T.call(this)},set:function($){k=""+$,O.call(this,$)}}),Object.defineProperty(f,m,{enumerable:w.enumerable}),{getValue:function(){return k},setValue:function($){k=""+$},stopTracking:function(){f._valueTracker=null,delete f[m]}}}}function eo(f){f._valueTracker||(f._valueTracker=rn(f))}function vn(f){if(!f)return!1;var m=f._valueTracker;if(!m)return!0;var w=m.getValue(),k="";return f&&(k=Ii(f)?f.checked?"true":"false":f.value),f=k,f!==w?(m.setValue(f),!0):!1}function zs(f){if(f=f||(typeof document<"u"?document:void 0),typeof f>"u")return null;try{return f.activeElement||f.body}catch{return f.body}}function to(f,m){var w=m.checked;return Re({},m,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:w??f._wrapperState.initialChecked})}function Ec(f,m){var w=m.defaultValue==null?"":m.defaultValue,k=m.checked!=null?m.checked:m.defaultChecked;w=ai(m.value!=null?m.value:w),f._wrapperState={initialChecked:k,initialValue:w,controlled:m.type==="checkbox"||m.type==="radio"?m.checked!=null:m.value!=null}}function _d(f,m){m=m.checked,m!=null&&x(f,"checked",m,!1)}function Ua(f,m){_d(f,m);var w=ai(m.value),k=m.type;if(w!=null)k==="number"?(w===0&&f.value===""||f.value!=w)&&(f.value=""+w):f.value!==""+w&&(f.value=""+w);else if(k==="submit"||k==="reset"){f.removeAttribute("value");return}m.hasOwnProperty("value")?Hl(f,m.type,w):m.hasOwnProperty("defaultValue")&&Hl(f,m.type,ai(m.defaultValue)),m.checked==null&&m.defaultChecked!=null&&(f.defaultChecked=!!m.defaultChecked)}function bd(f,m,w){if(m.hasOwnProperty("value")||m.hasOwnProperty("defaultValue")){var k=m.type;if(!(k!=="submit"&&k!=="reset"||m.value!==void 0&&m.value!==null))return;m=""+f._wrapperState.initialValue,w||m===f.value||(f.value=m),f.defaultValue=m}w=f.name,w!==""&&(f.name=""),f.defaultChecked=!!f._wrapperState.initialChecked,w!==""&&(f.name=w)}function Hl(f,m,w){(m!=="number"||zs(f.ownerDocument)!==f)&&(w==null?f.defaultValue=""+f._wrapperState.initialValue:f.defaultValue!==""+w&&(f.defaultValue=""+w))}var io=Array.isArray;function ja(f,m,w,k){if(f=f.options,m){m={};for(var T=0;T<w.length;T++)m["$"+w[T]]=!0;for(w=0;w<f.length;w++)T=m.hasOwnProperty("$"+f[w].value),f[w].selected!==T&&(f[w].selected=T),T&&k&&(f[w].defaultSelected=!0)}else{for(w=""+ai(w),m=null,T=0;T<f.length;T++){if(f[T].value===w){f[T].selected=!0,k&&(f[T].defaultSelected=!0);return}m!==null||f[T].disabled||(m=f[T])}m!==null&&(m.selected=!0)}}function Su(f,m){if(m.dangerouslySetInnerHTML!=null)throw Error(t(91));return Re({},m,{value:void 0,defaultValue:void 0,children:""+f._wrapperState.initialValue})}function zl(f,m){var w=m.value;if(w==null){if(w=m.children,m=m.defaultValue,w!=null){if(m!=null)throw Error(t(92));if(io(w)){if(1<w.length)throw Error(t(93));w=w[0]}m=w}m==null&&(m=""),w=m}f._wrapperState={initialValue:ai(w)}}function $a(f,m){var w=ai(m.value),k=ai(m.defaultValue);w!=null&&(w=""+w,w!==f.value&&(f.value=w),m.defaultValue==null&&f.defaultValue!==w&&(f.defaultValue=w)),k!=null&&(f.defaultValue=""+k)}function Po(f){var m=f.textContent;m===f._wrapperState.initialValue&&m!==""&&m!==null&&(f.value=m)}function On(f){switch(f){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Zn(f,m){return f==null||f==="http://www.w3.org/1999/xhtml"?On(m):f==="http://www.w3.org/2000/svg"&&m==="foreignObject"?"http://www.w3.org/1999/xhtml":f}var qa,Ul=function(f){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(m,w,k,T){MSApp.execUnsafeLocalFunction(function(){return f(m,w,k,T)})}:f}(function(f,m){if(f.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in f)f.innerHTML=m;else{for(qa=qa||document.createElement("div"),qa.innerHTML="<svg>"+m.valueOf().toString()+"</svg>",m=qa.firstChild;f.firstChild;)f.removeChild(f.firstChild);for(;m.firstChild;)f.appendChild(m.firstChild)}});function Ar(f,m){if(m){var w=f.firstChild;if(w&&w===f.lastChild&&w.nodeType===3){w.nodeValue=m;return}}f.textContent=m}var Ds={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Pr=["Webkit","ms","Moz","O"];Object.keys(Ds).forEach(function(f){Pr.forEach(function(m){m=m+f.charAt(0).toUpperCase()+f.substring(1),Ds[m]=Ds[f]})});function da(f,m,w){return m==null||typeof m=="boolean"||m===""?"":w||typeof m!="number"||m===0||Ds.hasOwnProperty(f)&&Ds[f]?(""+m).trim():m+"px"}function qn(f,m){f=f.style;for(var w in m)if(m.hasOwnProperty(w)){var k=w.indexOf("--")===0,T=da(w,m[w],k);w==="float"&&(w="cssFloat"),k?f.setProperty(w,T):f[w]=T}}var _r=Re({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Dc(f,m){if(m){if(_r[f]&&(m.children!=null||m.dangerouslySetInnerHTML!=null))throw Error(t(137,f));if(m.dangerouslySetInnerHTML!=null){if(m.children!=null)throw Error(t(60));if(typeof m.dangerouslySetInnerHTML!="object"||!("__html"in m.dangerouslySetInnerHTML))throw Error(t(61))}if(m.style!=null&&typeof m.style!="object")throw Error(t(62))}}function no(f,m){if(f.indexOf("-")===-1)return typeof m.is=="string";switch(f){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Li=null;function Ka(f){return f=f.target||f.srcElement||window,f.correspondingUseElement&&(f=f.correspondingUseElement),f.nodeType===3?f.parentNode:f}var xu=null,Mo=null,wn=null;function ua(f){if(f=YS(f)){if(typeof xu!="function")throw Error(t(280));var m=f.stateNode;m&&(m=QD(m),xu(f.stateNode,f.type,m))}}function Ga(f){Mo?wn?wn.push(f):wn=[f]:Mo=f}function Lu(){if(Mo){var f=Mo,m=wn;if(wn=Mo=null,ua(f),m)for(f=0;f<m.length;f++)ua(m[f])}}function jl(f,m){return f(m)}function zt(){}var K=!1;function Q(f,m,w){if(K)return f(m,w);K=!0;try{return jl(f,m,w)}finally{K=!1,(Mo!==null||wn!==null)&&(zt(),Lu())}}function Y(f,m){var w=f.stateNode;if(w===null)return null;var k=QD(w);if(k===null)return null;w=k[m];e:switch(m){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(k=!k.disabled)||(f=f.type,k=!(f==="button"||f==="input"||f==="select"||f==="textarea")),f=!k;break e;default:f=!1}if(f)return null;if(w&&typeof w!="function")throw Error(t(231,m,typeof w));return w}var se=!1;if(a)try{var le={};Object.defineProperty(le,"passive",{get:function(){se=!0}}),window.addEventListener("test",le,le),window.removeEventListener("test",le,le)}catch{se=!1}function be(f,m,w,k,T,O,$,ne,ae){var Te=Array.prototype.slice.call(arguments,3);try{m.apply(w,Te)}catch($e){this.onError($e)}}var Ne=!1,Ze=null,rt=!1,Ft=null,yi={onError:function(f){Ne=!0,Ze=f}};function bi(f,m,w,k,T,O,$,ne,ae){Ne=!1,Ze=null,be.apply(yi,arguments)}function on(f,m,w,k,T,O,$,ne,ae){if(bi.apply(this,arguments),Ne){if(Ne){var Te=Ze;Ne=!1,Ze=null}else throw Error(t(198));rt||(rt=!0,Ft=Te)}}function ki(f){var m=f,w=f;if(f.alternate)for(;m.return;)m=m.return;else{f=m;do m=f,(m.flags&4098)!==0&&(w=m.return),f=m.return;while(f)}return m.tag===3?w:null}function ps(f){if(f.tag===13){var m=f.memoizedState;if(m===null&&(f=f.alternate,f!==null&&(m=f.memoizedState)),m!==null)return m.dehydrated}return null}function ss(f){if(ki(f)!==f)throw Error(t(188))}function ku(f){var m=f.alternate;if(!m){if(m=ki(f),m===null)throw Error(t(188));return m!==f?null:f}for(var w=f,k=m;;){var T=w.return;if(T===null)break;var O=T.alternate;if(O===null){if(k=T.return,k!==null){w=k;continue}break}if(T.child===O.child){for(O=T.child;O;){if(O===w)return ss(T),f;if(O===k)return ss(T),m;O=O.sibling}throw Error(t(188))}if(w.return!==k.return)w=T,k=O;else{for(var $=!1,ne=T.child;ne;){if(ne===w){$=!0,w=T,k=O;break}if(ne===k){$=!0,k=T,w=O;break}ne=ne.sibling}if(!$){for(ne=O.child;ne;){if(ne===w){$=!0,w=O,k=T;break}if(ne===k){$=!0,k=O,w=T;break}ne=ne.sibling}if(!$)throw Error(t(189))}}if(w.alternate!==k)throw Error(t(190))}if(w.tag!==3)throw Error(t(188));return w.stateNode.current===w?f:m}function xt(f){return f=ku(f),f!==null?de(f):null}function de(f){if(f.tag===5||f.tag===6)return f;for(f=f.child;f!==null;){var m=de(f);if(m!==null)return m;f=f.sibling}return null}var Ge=e.unstable_scheduleCallback,pt=e.unstable_cancelCallback,Cn=e.unstable_shouldYield,Js=e.unstable_requestPaint,mi=e.unstable_now,br=e.unstable_getCurrentPriorityLevel,Mr=e.unstable_ImmediatePriority,Qa=e.unstable_UserBlockingPriority,Fn=e.unstable_NormalPriority,zg=e.unstable_LowPriority,x_=e.unstable_IdlePriority,L_=null,$l=null;function LD(f){if($l&&typeof $l.onCommitFiberRoot=="function")try{$l.onCommitFiberRoot(L_,f,void 0,(f.current.flags&128)===128)}catch{}}var ha=Math.clz32?Math.clz32:ID,PS=Math.log,kD=Math.LN2;function ID(f){return f>>>=0,f===0?32:31-(PS(f)/kD|0)|0}var a0=64,l0=4194304;function Ug(f){switch(f&-f){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return f&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return f}}function k_(f,m){var w=f.pendingLanes;if(w===0)return 0;var k=0,T=f.suspendedLanes,O=f.pingedLanes,$=w&268435455;if($!==0){var ne=$&~T;ne!==0?k=Ug(ne):(O&=$,O!==0&&(k=Ug(O)))}else $=w&~T,$!==0?k=Ug($):O!==0&&(k=Ug(O));if(k===0)return 0;if(m!==0&&m!==k&&(m&T)===0&&(T=k&-k,O=m&-m,T>=O||T===16&&(O&4194240)!==0))return m;if((k&4)!==0&&(k|=w&16),m=f.entangledLanes,m!==0)for(f=f.entanglements,m&=k;0<m;)w=31-ha(m),T=1<<w,k|=f[w],m&=~T;return k}function M5(f,m){switch(f){case 1:case 2:case 4:return m+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Xh(f,m){for(var w=f.suspendedLanes,k=f.pingedLanes,T=f.expirationTimes,O=f.pendingLanes;0<O;){var $=31-ha(O),ne=1<<$,ae=T[$];ae===-1?((ne&w)===0||(ne&k)!==0)&&(T[$]=M5(ne,m)):ae<=m&&(f.expiredLanes|=ne),O&=~ne}}function ql(f){return f=f.pendingLanes&-1073741825,f!==0?f:f&1073741824?1073741824:0}function I_(){var f=a0;return a0<<=1,(a0&4194240)===0&&(a0=64),f}function jg(f){for(var m=[],w=0;31>w;w++)m.push(f);return m}function $g(f,m,w){f.pendingLanes|=m,m!==536870912&&(f.suspendedLanes=0,f.pingedLanes=0),f=f.eventTimes,m=31-ha(m),f[m]=w}function Kn(f,m){var w=f.pendingLanes&~m;f.pendingLanes=m,f.suspendedLanes=0,f.pingedLanes=0,f.expiredLanes&=m,f.mutableReadLanes&=m,f.entangledLanes&=m,m=f.entanglements;var k=f.eventTimes;for(f=f.expirationTimes;0<w;){var T=31-ha(w),O=1<<T;m[T]=0,k[T]=-1,f[T]=-1,w&=~O}}function qg(f,m){var w=f.entangledLanes|=m;for(f=f.entanglements;w;){var k=31-ha(w),T=1<<k;T&m|f[k]&m&&(f[k]|=m),w&=~T}}var zi=0;function Kg(f){return f&=-f,1<f?4<f?(f&268435455)!==0?16:536870912:4:1}var ED,c0,DD,TD,ND,MS=!1,Iu=[],so=null,vd=null,wd=null,Gg=new Map,Tc=new Map,Eu=[],O5="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function RD(f,m){switch(f){case"focusin":case"focusout":so=null;break;case"dragenter":case"dragleave":vd=null;break;case"mouseover":case"mouseout":wd=null;break;case"pointerover":case"pointerout":Gg.delete(m.pointerId);break;case"gotpointercapture":case"lostpointercapture":Tc.delete(m.pointerId)}}function Ya(f,m,w,k,T,O){return f===null||f.nativeEvent!==O?(f={blockedOn:m,domEventName:w,eventSystemFlags:k,nativeEvent:O,targetContainers:[T]},m!==null&&(m=YS(m),m!==null&&c0(m)),f):(f.eventSystemFlags|=k,m=f.targetContainers,T!==null&&m.indexOf(T)===-1&&m.push(T),f)}function F5(f,m,w,k,T){switch(m){case"focusin":return so=Ya(so,f,m,w,k,T),!0;case"dragenter":return vd=Ya(vd,f,m,w,k,T),!0;case"mouseover":return wd=Ya(wd,f,m,w,k,T),!0;case"pointerover":var O=T.pointerId;return Gg.set(O,Ya(Gg.get(O)||null,f,m,w,k,T)),!0;case"gotpointercapture":return O=T.pointerId,Tc.set(O,Ya(Tc.get(O)||null,f,m,w,k,T)),!0}return!1}function AD(f){var m=R_(f.target);if(m!==null){var w=ki(m);if(w!==null){if(m=w.tag,m===13){if(m=ps(w),m!==null){f.blockedOn=m,ND(f.priority,function(){DD(w)});return}}else if(m===3&&w.stateNode.current.memoizedState.isDehydrated){f.blockedOn=w.tag===3?w.stateNode.containerInfo:null;return}}}f.blockedOn=null}function Zh(f){if(f.blockedOn!==null)return!1;for(var m=f.targetContainers;0<m.length;){var w=d0(f.domEventName,f.eventSystemFlags,m[0],f.nativeEvent);if(w===null){w=f.nativeEvent;var k=new w.constructor(w.type,w);Li=k,w.target.dispatchEvent(k),Li=null}else return m=YS(w),m!==null&&c0(m),f.blockedOn=w,!1;m.shift()}return!0}function E_(f,m,w){Zh(f)&&w.delete(m)}function PD(){MS=!1,so!==null&&Zh(so)&&(so=null),vd!==null&&Zh(vd)&&(vd=null),wd!==null&&Zh(wd)&&(wd=null),Gg.forEach(E_),Tc.forEach(E_)}function Cd(f,m){f.blockedOn===m&&(f.blockedOn=null,MS||(MS=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,PD)))}function yd(f){function m(T){return Cd(T,f)}if(0<Iu.length){Cd(Iu[0],f);for(var w=1;w<Iu.length;w++){var k=Iu[w];k.blockedOn===f&&(k.blockedOn=null)}}for(so!==null&&Cd(so,f),vd!==null&&Cd(vd,f),wd!==null&&Cd(wd,f),Gg.forEach(m),Tc.forEach(m),w=0;w<Eu.length;w++)k=Eu[w],k.blockedOn===f&&(k.blockedOn=null);for(;0<Eu.length&&(w=Eu[0],w.blockedOn===null);)AD(w),w.blockedOn===null&&Eu.shift()}var Jh=L.ReactCurrentBatchConfig,Qg=!0;function ds(f,m,w,k){var T=zi,O=Jh.transition;Jh.transition=null;try{zi=1,OS(f,m,w,k)}finally{zi=T,Jh.transition=O}}function V5(f,m,w,k){var T=zi,O=Jh.transition;Jh.transition=null;try{zi=4,OS(f,m,w,k)}finally{zi=T,Jh.transition=O}}function OS(f,m,w,k){if(Qg){var T=d0(f,m,w,k);if(T===null)Q5(f,m,k,D_,w),RD(f,k);else if(F5(T,f,m,w,k))k.stopPropagation();else if(RD(f,k),m&4&&-1<O5.indexOf(f)){for(;T!==null;){var O=YS(T);if(O!==null&&ED(O),O=d0(f,m,w,k),O===null&&Q5(f,m,k,D_,w),O===T)break;T=O}T!==null&&k.stopPropagation()}else Q5(f,m,k,null,w)}}var D_=null;function d0(f,m,w,k){if(D_=null,f=Ka(k),f=R_(f),f!==null)if(m=ki(f),m===null)f=null;else if(w=m.tag,w===13){if(f=ps(m),f!==null)return f;f=null}else if(w===3){if(m.stateNode.current.memoizedState.isDehydrated)return m.tag===3?m.stateNode.containerInfo:null;f=null}else m!==f&&(f=null);return D_=f,null}function FS(f){switch(f){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(br()){case Mr:return 1;case Qa:return 4;case Fn:case zg:return 16;case x_:return 536870912;default:return 16}default:return 16}}var Kl=null,u0=null,Xa=null;function VS(){if(Xa)return Xa;var f,m=u0,w=m.length,k,T="value"in Kl?Kl.value:Kl.textContent,O=T.length;for(f=0;f<w&&m[f]===T[f];f++);var $=w-f;for(k=1;k<=$&&m[w-k]===T[O-k];k++);return Xa=T.slice(f,1<k?1-k:void 0)}function h0(f){var m=f.keyCode;return"charCode"in f?(f=f.charCode,f===0&&m===13&&(f=13)):f=m,f===10&&(f=13),32<=f||f===13?f:0}function Du(){return!0}function BS(){return!1}function ro(f){function m(w,k,T,O,$){this._reactName=w,this._targetInst=T,this.type=k,this.nativeEvent=O,this.target=$,this.currentTarget=null;for(var ne in f)f.hasOwnProperty(ne)&&(w=f[ne],this[ne]=w?w(O):O[ne]);return this.isDefaultPrevented=(O.defaultPrevented!=null?O.defaultPrevented:O.returnValue===!1)?Du:BS,this.isPropagationStopped=BS,this}return Re(m.prototype,{preventDefault:function(){this.defaultPrevented=!0;var w=this.nativeEvent;w&&(w.preventDefault?w.preventDefault():typeof w.returnValue!="unknown"&&(w.returnValue=!1),this.isDefaultPrevented=Du)},stopPropagation:function(){var w=this.nativeEvent;w&&(w.stopPropagation?w.stopPropagation():typeof w.cancelBubble!="unknown"&&(w.cancelBubble=!0),this.isPropagationStopped=Du)},persist:function(){},isPersistent:Du}),m}var Sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(f){return f.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},f0=ro(Sd),Tu=Re({},Sd,{view:0,detail:0}),B5=ro(Tu),g0,ef,Yg,T_=Re({},Tu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Nu,button:0,buttons:0,relatedTarget:function(f){return f.relatedTarget===void 0?f.fromElement===f.srcElement?f.toElement:f.fromElement:f.relatedTarget},movementX:function(f){return"movementX"in f?f.movementX:(f!==Yg&&(Yg&&f.type==="mousemove"?(g0=f.screenX-Yg.screenX,ef=f.screenY-Yg.screenY):ef=g0=0,Yg=f),g0)},movementY:function(f){return"movementY"in f?f.movementY:ef}}),p0=ro(T_),WS=Re({},T_,{dataTransfer:0}),MD=ro(WS),m0=Re({},Tu,{relatedTarget:0}),_0=ro(m0),OD=Re({},Sd,{animationName:0,elapsedTime:0,pseudoElement:0}),tf=ro(OD),FD=Re({},Sd,{clipboardData:function(f){return"clipboardData"in f?f.clipboardData:window.clipboardData}}),VD=ro(FD),BD=Re({},Sd,{data:0}),HS=ro(BD),b0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fa={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},WD={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function HD(f){var m=this.nativeEvent;return m.getModifierState?m.getModifierState(f):(f=WD[f])?!!m[f]:!1}function Nu(){return HD}var S=Re({},Tu,{key:function(f){if(f.key){var m=b0[f.key]||f.key;if(m!=="Unidentified")return m}return f.type==="keypress"?(f=h0(f),f===13?"Enter":String.fromCharCode(f)):f.type==="keydown"||f.type==="keyup"?fa[f.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Nu,charCode:function(f){return f.type==="keypress"?h0(f):0},keyCode:function(f){return f.type==="keydown"||f.type==="keyup"?f.keyCode:0},which:function(f){return f.type==="keypress"?h0(f):f.type==="keydown"||f.type==="keyup"?f.keyCode:0}}),P=ro(S),V=Re({},T_,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),G=ro(V),ve=Re({},Tu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Nu}),Pe=ro(ve),lt=Re({},Sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Tn=ro(lt),vr=Re({},T_,{deltaX:function(f){return"deltaX"in f?f.deltaX:"wheelDeltaX"in f?-f.wheelDeltaX:0},deltaY:function(f){return"deltaY"in f?f.deltaY:"wheelDeltaY"in f?-f.wheelDeltaY:"wheelDelta"in f?-f.wheelDelta:0},deltaZ:0,deltaMode:0}),Yi=ro(vr),Or=[9,13,27,32],er=a&&"CompositionEvent"in window,Nc=null;a&&"documentMode"in document&&(Nc=document.documentMode);var Gl=a&&"TextEvent"in window&&!Nc,N_=a&&(!er||Nc&&8<Nc&&11>=Nc),v0=" ",fY=!1;function gY(f,m){switch(f){case"keyup":return Or.indexOf(m.keyCode)!==-1;case"keydown":return m.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function pY(f){return f=f.detail,typeof f=="object"&&"data"in f?f.data:null}var w0=!1;function Kve(f,m){switch(f){case"compositionend":return pY(m);case"keypress":return m.which!==32?null:(fY=!0,v0);case"textInput":return f=m.data,f===v0&&fY?null:f;default:return null}}function Gve(f,m){if(w0)return f==="compositionend"||!er&&gY(f,m)?(f=VS(),Xa=u0=Kl=null,w0=!1,f):null;switch(f){case"paste":return null;case"keypress":if(!(m.ctrlKey||m.altKey||m.metaKey)||m.ctrlKey&&m.altKey){if(m.char&&1<m.char.length)return m.char;if(m.which)return String.fromCharCode(m.which)}return null;case"compositionend":return N_&&m.locale!=="ko"?null:m.data;default:return null}}var Qve={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function mY(f){var m=f&&f.nodeName&&f.nodeName.toLowerCase();return m==="input"?!!Qve[f.type]:m==="textarea"}function _Y(f,m,w,k){Ga(k),m=qD(m,"onChange"),0<m.length&&(w=new f0("onChange","change",null,w,k),f.push({event:w,listeners:m}))}var zS=null,US=null;function Yve(f){MY(f,0)}function zD(f){var m=L0(f);if(vn(m))return f}function Xve(f,m){if(f==="change")return m}var bY=!1;if(a){var W5;if(a){var H5="oninput"in document;if(!H5){var vY=document.createElement("div");vY.setAttribute("oninput","return;"),H5=typeof vY.oninput=="function"}W5=H5}else W5=!1;bY=W5&&(!document.documentMode||9<document.documentMode)}function wY(){zS&&(zS.detachEvent("onpropertychange",CY),US=zS=null)}function CY(f){if(f.propertyName==="value"&&zD(US)){var m=[];_Y(m,US,f,Ka(f)),Q(Yve,m)}}function Zve(f,m,w){f==="focusin"?(wY(),zS=m,US=w,zS.attachEvent("onpropertychange",CY)):f==="focusout"&&wY()}function Jve(f){if(f==="selectionchange"||f==="keyup"||f==="keydown")return zD(US)}function ewe(f,m){if(f==="click")return zD(m)}function twe(f,m){if(f==="input"||f==="change")return zD(m)}function iwe(f,m){return f===m&&(f!==0||1/f===1/m)||f!==f&&m!==m}var xd=typeof Object.is=="function"?Object.is:iwe;function jS(f,m){if(xd(f,m))return!0;if(typeof f!="object"||f===null||typeof m!="object"||m===null)return!1;var w=Object.keys(f),k=Object.keys(m);if(w.length!==k.length)return!1;for(k=0;k<w.length;k++){var T=w[k];if(!l.call(m,T)||!xd(f[T],m[T]))return!1}return!0}function yY(f){for(;f&&f.firstChild;)f=f.firstChild;return f}function SY(f,m){var w=yY(f);f=0;for(var k;w;){if(w.nodeType===3){if(k=f+w.textContent.length,f<=m&&k>=m)return{node:w,offset:m-f};f=k}e:{for(;w;){if(w.nextSibling){w=w.nextSibling;break e}w=w.parentNode}w=void 0}w=yY(w)}}function xY(f,m){return f&&m?f===m?!0:f&&f.nodeType===3?!1:m&&m.nodeType===3?xY(f,m.parentNode):"contains"in f?f.contains(m):f.compareDocumentPosition?!!(f.compareDocumentPosition(m)&16):!1:!1}function LY(){for(var f=window,m=zs();m instanceof f.HTMLIFrameElement;){try{var w=typeof m.contentWindow.location.href=="string"}catch{w=!1}if(w)f=m.contentWindow;else break;m=zs(f.document)}return m}function z5(f){var m=f&&f.nodeName&&f.nodeName.toLowerCase();return m&&(m==="input"&&(f.type==="text"||f.type==="search"||f.type==="tel"||f.type==="url"||f.type==="password")||m==="textarea"||f.contentEditable==="true")}function nwe(f){var m=LY(),w=f.focusedElem,k=f.selectionRange;if(m!==w&&w&&w.ownerDocument&&xY(w.ownerDocument.documentElement,w)){if(k!==null&&z5(w)){if(m=k.start,f=k.end,f===void 0&&(f=m),"selectionStart"in w)w.selectionStart=m,w.selectionEnd=Math.min(f,w.value.length);else if(f=(m=w.ownerDocument||document)&&m.defaultView||window,f.getSelection){f=f.getSelection();var T=w.textContent.length,O=Math.min(k.start,T);k=k.end===void 0?O:Math.min(k.end,T),!f.extend&&O>k&&(T=k,k=O,O=T),T=SY(w,O);var $=SY(w,k);T&&$&&(f.rangeCount!==1||f.anchorNode!==T.node||f.anchorOffset!==T.offset||f.focusNode!==$.node||f.focusOffset!==$.offset)&&(m=m.createRange(),m.setStart(T.node,T.offset),f.removeAllRanges(),O>k?(f.addRange(m),f.extend($.node,$.offset)):(m.setEnd($.node,$.offset),f.addRange(m)))}}for(m=[],f=w;f=f.parentNode;)f.nodeType===1&&m.push({element:f,left:f.scrollLeft,top:f.scrollTop});for(typeof w.focus=="function"&&w.focus(),w=0;w<m.length;w++)f=m[w],f.element.scrollLeft=f.left,f.element.scrollTop=f.top}}var swe=a&&"documentMode"in document&&11>=document.documentMode,C0=null,U5=null,$S=null,j5=!1;function kY(f,m,w){var k=w.window===w?w.document:w.nodeType===9?w:w.ownerDocument;j5||C0==null||C0!==zs(k)||(k=C0,"selectionStart"in k&&z5(k)?k={start:k.selectionStart,end:k.selectionEnd}:(k=(k.ownerDocument&&k.ownerDocument.defaultView||window).getSelection(),k={anchorNode:k.anchorNode,anchorOffset:k.anchorOffset,focusNode:k.focusNode,focusOffset:k.focusOffset}),$S&&jS($S,k)||($S=k,k=qD(U5,"onSelect"),0<k.length&&(m=new f0("onSelect","select",null,m,w),f.push({event:m,listeners:k}),m.target=C0)))}function UD(f,m){var w={};return w[f.toLowerCase()]=m.toLowerCase(),w["Webkit"+f]="webkit"+m,w["Moz"+f]="moz"+m,w}var y0={animationend:UD("Animation","AnimationEnd"),animationiteration:UD("Animation","AnimationIteration"),animationstart:UD("Animation","AnimationStart"),transitionend:UD("Transition","TransitionEnd")},$5={},IY={};a&&(IY=document.createElement("div").style,"AnimationEvent"in window||(delete y0.animationend.animation,delete y0.animationiteration.animation,delete y0.animationstart.animation),"TransitionEvent"in window||delete y0.transitionend.transition);function jD(f){if($5[f])return $5[f];if(!y0[f])return f;var m=y0[f],w;for(w in m)if(m.hasOwnProperty(w)&&w in IY)return $5[f]=m[w];return f}var EY=jD("animationend"),DY=jD("animationiteration"),TY=jD("animationstart"),NY=jD("transitionend"),RY=new Map,AY="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Xg(f,m){RY.set(f,m),r(m,[f])}for(var q5=0;q5<AY.length;q5++){var K5=AY[q5],rwe=K5.toLowerCase(),owe=K5[0].toUpperCase()+K5.slice(1);Xg(rwe,"on"+owe)}Xg(EY,"onAnimationEnd"),Xg(DY,"onAnimationIteration"),Xg(TY,"onAnimationStart"),Xg("dblclick","onDoubleClick"),Xg("focusin","onFocus"),Xg("focusout","onBlur"),Xg(NY,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),r("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),r("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),r("onBeforeInput",["compositionend","keypress","textInput","paste"]),r("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),r("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),r("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var qS="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),awe=new Set("cancel close invalid load scroll toggle".split(" ").concat(qS));function PY(f,m,w){var k=f.type||"unknown-event";f.currentTarget=w,on(k,m,void 0,f),f.currentTarget=null}function MY(f,m){m=(m&4)!==0;for(var w=0;w<f.length;w++){var k=f[w],T=k.event;k=k.listeners;e:{var O=void 0;if(m)for(var $=k.length-1;0<=$;$--){var ne=k[$],ae=ne.instance,Te=ne.currentTarget;if(ne=ne.listener,ae!==O&&T.isPropagationStopped())break e;PY(T,ne,Te),O=ae}else for($=0;$<k.length;$++){if(ne=k[$],ae=ne.instance,Te=ne.currentTarget,ne=ne.listener,ae!==O&&T.isPropagationStopped())break e;PY(T,ne,Te),O=ae}}}if(rt)throw f=Ft,rt=!1,Ft=null,f}function rs(f,m){var w=m[t3];w===void 0&&(w=m[t3]=new Set);var k=f+"__bubble";w.has(k)||(OY(m,f,2,!1),w.add(k))}function G5(f,m,w){var k=0;m&&(k|=4),OY(w,f,k,m)}var $D="_reactListening"+Math.random().toString(36).slice(2);function KS(f){if(!f[$D]){f[$D]=!0,i.forEach(function(w){w!=="selectionchange"&&(awe.has(w)||G5(w,!1,f),G5(w,!0,f))});var m=f.nodeType===9?f:f.ownerDocument;m===null||m[$D]||(m[$D]=!0,G5("selectionchange",!1,m))}}function OY(f,m,w,k){switch(FS(m)){case 1:var T=ds;break;case 4:T=V5;break;default:T=OS}w=T.bind(null,m,w,f),T=void 0,!se||m!=="touchstart"&&m!=="touchmove"&&m!=="wheel"||(T=!0),k?T!==void 0?f.addEventListener(m,w,{capture:!0,passive:T}):f.addEventListener(m,w,!0):T!==void 0?f.addEventListener(m,w,{passive:T}):f.addEventListener(m,w,!1)}function Q5(f,m,w,k,T){var O=k;if((m&1)===0&&(m&2)===0&&k!==null)e:for(;;){if(k===null)return;var $=k.tag;if($===3||$===4){var ne=k.stateNode.containerInfo;if(ne===T||ne.nodeType===8&&ne.parentNode===T)break;if($===4)for($=k.return;$!==null;){var ae=$.tag;if((ae===3||ae===4)&&(ae=$.stateNode.containerInfo,ae===T||ae.nodeType===8&&ae.parentNode===T))return;$=$.return}for(;ne!==null;){if($=R_(ne),$===null)return;if(ae=$.tag,ae===5||ae===6){k=O=$;continue e}ne=ne.parentNode}}k=k.return}Q(function(){var Te=O,$e=Ka(w),Qe=[];e:{var je=RY.get(f);if(je!==void 0){var mt=f0,Lt=f;switch(f){case"keypress":if(h0(w)===0)break e;case"keydown":case"keyup":mt=P;break;case"focusin":Lt="focus",mt=_0;break;case"focusout":Lt="blur",mt=_0;break;case"beforeblur":case"afterblur":mt=_0;break;case"click":if(w.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":mt=p0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":mt=MD;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":mt=Pe;break;case EY:case DY:case TY:mt=tf;break;case NY:mt=Tn;break;case"scroll":mt=B5;break;case"wheel":mt=Yi;break;case"copy":case"cut":case"paste":mt=VD;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":mt=G}var Et=(m&4)!==0,Us=!Et&&f==="scroll",Ce=Et?je!==null?je+"Capture":null:je;Et=[];for(var ue=Te,Se;ue!==null;){Se=ue;var it=Se.stateNode;if(Se.tag===5&&it!==null&&(Se=it,Ce!==null&&(it=Y(ue,Ce),it!=null&&Et.push(GS(ue,it,Se)))),Us)break;ue=ue.return}0<Et.length&&(je=new mt(je,Lt,null,w,$e),Qe.push({event:je,listeners:Et}))}}if((m&7)===0){e:{if(je=f==="mouseover"||f==="pointerover",mt=f==="mouseout"||f==="pointerout",je&&w!==Li&&(Lt=w.relatedTarget||w.fromElement)&&(R_(Lt)||Lt[nf]))break e;if((mt||je)&&(je=$e.window===$e?$e:(je=$e.ownerDocument)?je.defaultView||je.parentWindow:window,mt?(Lt=w.relatedTarget||w.toElement,mt=Te,Lt=Lt?R_(Lt):null,Lt!==null&&(Us=ki(Lt),Lt!==Us||Lt.tag!==5&&Lt.tag!==6)&&(Lt=null)):(mt=null,Lt=Te),mt!==Lt)){if(Et=p0,it="onMouseLeave",Ce="onMouseEnter",ue="mouse",(f==="pointerout"||f==="pointerover")&&(Et=G,it="onPointerLeave",Ce="onPointerEnter",ue="pointer"),Us=mt==null?je:L0(mt),Se=Lt==null?je:L0(Lt),je=new Et(it,ue+"leave",mt,w,$e),je.target=Us,je.relatedTarget=Se,it=null,R_($e)===Te&&(Et=new Et(Ce,ue+"enter",Lt,w,$e),Et.target=Se,Et.relatedTarget=Us,it=Et),Us=it,mt&&Lt)t:{for(Et=mt,Ce=Lt,ue=0,Se=Et;Se;Se=S0(Se))ue++;for(Se=0,it=Ce;it;it=S0(it))Se++;for(;0<ue-Se;)Et=S0(Et),ue--;for(;0<Se-ue;)Ce=S0(Ce),Se--;for(;ue--;){if(Et===Ce||Ce!==null&&Et===Ce.alternate)break t;Et=S0(Et),Ce=S0(Ce)}Et=null}else Et=null;mt!==null&&FY(Qe,je,mt,Et,!1),Lt!==null&&Us!==null&&FY(Qe,Us,Lt,Et,!0)}}e:{if(je=Te?L0(Te):window,mt=je.nodeName&&je.nodeName.toLowerCase(),mt==="select"||mt==="input"&&je.type==="file")var Pt=Xve;else if(mY(je))if(bY)Pt=twe;else{Pt=Jve;var Qt=Zve}else(mt=je.nodeName)&&mt.toLowerCase()==="input"&&(je.type==="checkbox"||je.type==="radio")&&(Pt=ewe);if(Pt&&(Pt=Pt(f,Te))){_Y(Qe,Pt,w,$e);break e}Qt&&Qt(f,je,Te),f==="focusout"&&(Qt=je._wrapperState)&&Qt.controlled&&je.type==="number"&&Hl(je,"number",je.value)}switch(Qt=Te?L0(Te):window,f){case"focusin":(mY(Qt)||Qt.contentEditable==="true")&&(C0=Qt,U5=Te,$S=null);break;case"focusout":$S=U5=C0=null;break;case"mousedown":j5=!0;break;case"contextmenu":case"mouseup":case"dragend":j5=!1,kY(Qe,w,$e);break;case"selectionchange":if(swe)break;case"keydown":case"keyup":kY(Qe,w,$e)}var Yt;if(er)e:{switch(f){case"compositionstart":var ci="onCompositionStart";break e;case"compositionend":ci="onCompositionEnd";break e;case"compositionupdate":ci="onCompositionUpdate";break e}ci=void 0}else w0?gY(f,w)&&(ci="onCompositionEnd"):f==="keydown"&&w.keyCode===229&&(ci="onCompositionStart");ci&&(N_&&w.locale!=="ko"&&(w0||ci!=="onCompositionStart"?ci==="onCompositionEnd"&&w0&&(Yt=VS()):(Kl=$e,u0="value"in Kl?Kl.value:Kl.textContent,w0=!0)),Qt=qD(Te,ci),0<Qt.length&&(ci=new HS(ci,f,null,w,$e),Qe.push({event:ci,listeners:Qt}),Yt?ci.data=Yt:(Yt=pY(w),Yt!==null&&(ci.data=Yt)))),(Yt=Gl?Kve(f,w):Gve(f,w))&&(Te=qD(Te,"onBeforeInput"),0<Te.length&&($e=new HS("onBeforeInput","beforeinput",null,w,$e),Qe.push({event:$e,listeners:Te}),$e.data=Yt))}MY(Qe,m)})}function GS(f,m,w){return{instance:f,listener:m,currentTarget:w}}function qD(f,m){for(var w=m+"Capture",k=[];f!==null;){var T=f,O=T.stateNode;T.tag===5&&O!==null&&(T=O,O=Y(f,w),O!=null&&k.unshift(GS(f,O,T)),O=Y(f,m),O!=null&&k.push(GS(f,O,T))),f=f.return}return k}function S0(f){if(f===null)return null;do f=f.return;while(f&&f.tag!==5);return f||null}function FY(f,m,w,k,T){for(var O=m._reactName,$=[];w!==null&&w!==k;){var ne=w,ae=ne.alternate,Te=ne.stateNode;if(ae!==null&&ae===k)break;ne.tag===5&&Te!==null&&(ne=Te,T?(ae=Y(w,O),ae!=null&&$.unshift(GS(w,ae,ne))):T||(ae=Y(w,O),ae!=null&&$.push(GS(w,ae,ne)))),w=w.return}$.length!==0&&f.push({event:m,listeners:$})}var lwe=/\r\n?/g,cwe=/\u0000|\uFFFD/g;function VY(f){return(typeof f=="string"?f:""+f).replace(lwe,`
`).replace(cwe,"")}function KD(f,m,w){if(m=VY(m),VY(f)!==m&&w)throw Error(t(425))}function GD(){}var Y5=null,X5=null;function Z5(f,m){return f==="textarea"||f==="noscript"||typeof m.children=="string"||typeof m.children=="number"||typeof m.dangerouslySetInnerHTML=="object"&&m.dangerouslySetInnerHTML!==null&&m.dangerouslySetInnerHTML.__html!=null}var J5=typeof setTimeout=="function"?setTimeout:void 0,dwe=typeof clearTimeout=="function"?clearTimeout:void 0,BY=typeof Promise=="function"?Promise:void 0,uwe=typeof queueMicrotask=="function"?queueMicrotask:typeof BY<"u"?function(f){return BY.resolve(null).then(f).catch(hwe)}:J5;function hwe(f){setTimeout(function(){throw f})}function e3(f,m){var w=m,k=0;do{var T=w.nextSibling;if(f.removeChild(w),T&&T.nodeType===8)if(w=T.data,w==="/$"){if(k===0){f.removeChild(T),yd(m);return}k--}else w!=="$"&&w!=="$?"&&w!=="$!"||k++;w=T}while(w);yd(m)}function Zg(f){for(;f!=null;f=f.nextSibling){var m=f.nodeType;if(m===1||m===3)break;if(m===8){if(m=f.data,m==="$"||m==="$!"||m==="$?")break;if(m==="/$")return null}}return f}function WY(f){f=f.previousSibling;for(var m=0;f;){if(f.nodeType===8){var w=f.data;if(w==="$"||w==="$!"||w==="$?"){if(m===0)return f;m--}else w==="/$"&&m++}f=f.previousSibling}return null}var x0=Math.random().toString(36).slice(2),Ru="__reactFiber$"+x0,QS="__reactProps$"+x0,nf="__reactContainer$"+x0,t3="__reactEvents$"+x0,fwe="__reactListeners$"+x0,gwe="__reactHandles$"+x0;function R_(f){var m=f[Ru];if(m)return m;for(var w=f.parentNode;w;){if(m=w[nf]||w[Ru]){if(w=m.alternate,m.child!==null||w!==null&&w.child!==null)for(f=WY(f);f!==null;){if(w=f[Ru])return w;f=WY(f)}return m}f=w,w=f.parentNode}return null}function YS(f){return f=f[Ru]||f[nf],!f||f.tag!==5&&f.tag!==6&&f.tag!==13&&f.tag!==3?null:f}function L0(f){if(f.tag===5||f.tag===6)return f.stateNode;throw Error(t(33))}function QD(f){return f[QS]||null}var i3=[],k0=-1;function Jg(f){return{current:f}}function os(f){0>k0||(f.current=i3[k0],i3[k0]=null,k0--)}function Jn(f,m){k0++,i3[k0]=f.current,f.current=m}var ep={},Oo=Jg(ep),Za=Jg(!1),A_=ep;function I0(f,m){var w=f.type.contextTypes;if(!w)return ep;var k=f.stateNode;if(k&&k.__reactInternalMemoizedUnmaskedChildContext===m)return k.__reactInternalMemoizedMaskedChildContext;var T={},O;for(O in w)T[O]=m[O];return k&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=m,f.__reactInternalMemoizedMaskedChildContext=T),T}function Ja(f){return f=f.childContextTypes,f!=null}function YD(){os(Za),os(Oo)}function HY(f,m,w){if(Oo.current!==ep)throw Error(t(168));Jn(Oo,m),Jn(Za,w)}function zY(f,m,w){var k=f.stateNode;if(m=m.childContextTypes,typeof k.getChildContext!="function")return w;k=k.getChildContext();for(var T in k)if(!(T in m))throw Error(t(108,si(f)||"Unknown",T));return Re({},w,k)}function XD(f){return f=(f=f.stateNode)&&f.__reactInternalMemoizedMergedChildContext||ep,A_=Oo.current,Jn(Oo,f),Jn(Za,Za.current),!0}function UY(f,m,w){var k=f.stateNode;if(!k)throw Error(t(169));w?(f=zY(f,m,A_),k.__reactInternalMemoizedMergedChildContext=f,os(Za),os(Oo),Jn(Oo,f)):os(Za),Jn(Za,w)}var sf=null,ZD=!1,n3=!1;function jY(f){sf===null?sf=[f]:sf.push(f)}function pwe(f){ZD=!0,jY(f)}function tp(){if(!n3&&sf!==null){n3=!0;var f=0,m=zi;try{var w=sf;for(zi=1;f<w.length;f++){var k=w[f];do k=k(!0);while(k!==null)}sf=null,ZD=!1}catch(T){throw sf!==null&&(sf=sf.slice(f+1)),Ge(Mr,tp),T}finally{zi=m,n3=!1}}return null}var E0=[],D0=0,JD=null,eT=0,Rc=[],Ac=0,P_=null,rf=1,of="";function M_(f,m){E0[D0++]=eT,E0[D0++]=JD,JD=f,eT=m}function $Y(f,m,w){Rc[Ac++]=rf,Rc[Ac++]=of,Rc[Ac++]=P_,P_=f;var k=rf;f=of;var T=32-ha(k)-1;k&=~(1<<T),w+=1;var O=32-ha(m)+T;if(30<O){var $=T-T%5;O=(k&(1<<$)-1).toString(32),k>>=$,T-=$,rf=1<<32-ha(m)+T|w<<T|k,of=O+f}else rf=1<<O|w<<T|k,of=f}function s3(f){f.return!==null&&(M_(f,1),$Y(f,1,0))}function r3(f){for(;f===JD;)JD=E0[--D0],E0[D0]=null,eT=E0[--D0],E0[D0]=null;for(;f===P_;)P_=Rc[--Ac],Rc[Ac]=null,of=Rc[--Ac],Rc[Ac]=null,rf=Rc[--Ac],Rc[Ac]=null}var Ql=null,Yl=null,us=!1,Ld=null;function qY(f,m){var w=Fc(5,null,null,0);w.elementType="DELETED",w.stateNode=m,w.return=f,m=f.deletions,m===null?(f.deletions=[w],f.flags|=16):m.push(w)}function KY(f,m){switch(f.tag){case 5:var w=f.type;return m=m.nodeType!==1||w.toLowerCase()!==m.nodeName.toLowerCase()?null:m,m!==null?(f.stateNode=m,Ql=f,Yl=Zg(m.firstChild),!0):!1;case 6:return m=f.pendingProps===""||m.nodeType!==3?null:m,m!==null?(f.stateNode=m,Ql=f,Yl=null,!0):!1;case 13:return m=m.nodeType!==8?null:m,m!==null?(w=P_!==null?{id:rf,overflow:of}:null,f.memoizedState={dehydrated:m,treeContext:w,retryLane:1073741824},w=Fc(18,null,null,0),w.stateNode=m,w.return=f,f.child=w,Ql=f,Yl=null,!0):!1;default:return!1}}function o3(f){return(f.mode&1)!==0&&(f.flags&128)===0}function a3(f){if(us){var m=Yl;if(m){var w=m;if(!KY(f,m)){if(o3(f))throw Error(t(418));m=Zg(w.nextSibling);var k=Ql;m&&KY(f,m)?qY(k,w):(f.flags=f.flags&-4097|2,us=!1,Ql=f)}}else{if(o3(f))throw Error(t(418));f.flags=f.flags&-4097|2,us=!1,Ql=f}}}function GY(f){for(f=f.return;f!==null&&f.tag!==5&&f.tag!==3&&f.tag!==13;)f=f.return;Ql=f}function tT(f){if(f!==Ql)return!1;if(!us)return GY(f),us=!0,!1;var m;if((m=f.tag!==3)&&!(m=f.tag!==5)&&(m=f.type,m=m!=="head"&&m!=="body"&&!Z5(f.type,f.memoizedProps)),m&&(m=Yl)){if(o3(f))throw QY(),Error(t(418));for(;m;)qY(f,m),m=Zg(m.nextSibling)}if(GY(f),f.tag===13){if(f=f.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(t(317));e:{for(f=f.nextSibling,m=0;f;){if(f.nodeType===8){var w=f.data;if(w==="/$"){if(m===0){Yl=Zg(f.nextSibling);break e}m--}else w!=="$"&&w!=="$!"&&w!=="$?"||m++}f=f.nextSibling}Yl=null}}else Yl=Ql?Zg(f.stateNode.nextSibling):null;return!0}function QY(){for(var f=Yl;f;)f=Zg(f.nextSibling)}function T0(){Yl=Ql=null,us=!1}function l3(f){Ld===null?Ld=[f]:Ld.push(f)}var mwe=L.ReactCurrentBatchConfig;function XS(f,m,w){if(f=w.ref,f!==null&&typeof f!="function"&&typeof f!="object"){if(w._owner){if(w=w._owner,w){if(w.tag!==1)throw Error(t(309));var k=w.stateNode}if(!k)throw Error(t(147,f));var T=k,O=""+f;return m!==null&&m.ref!==null&&typeof m.ref=="function"&&m.ref._stringRef===O?m.ref:(m=function($){var ne=T.refs;$===null?delete ne[O]:ne[O]=$},m._stringRef=O,m)}if(typeof f!="string")throw Error(t(284));if(!w._owner)throw Error(t(290,f))}return f}function iT(f,m){throw f=Object.prototype.toString.call(m),Error(t(31,f==="[object Object]"?"object with keys {"+Object.keys(m).join(", ")+"}":f))}function YY(f){var m=f._init;return m(f._payload)}function XY(f){function m(Ce,ue){if(f){var Se=Ce.deletions;Se===null?(Ce.deletions=[ue],Ce.flags|=16):Se.push(ue)}}function w(Ce,ue){if(!f)return null;for(;ue!==null;)m(Ce,ue),ue=ue.sibling;return null}function k(Ce,ue){for(Ce=new Map;ue!==null;)ue.key!==null?Ce.set(ue.key,ue):Ce.set(ue.index,ue),ue=ue.sibling;return Ce}function T(Ce,ue){return Ce=cp(Ce,ue),Ce.index=0,Ce.sibling=null,Ce}function O(Ce,ue,Se){return Ce.index=Se,f?(Se=Ce.alternate,Se!==null?(Se=Se.index,Se<ue?(Ce.flags|=2,ue):Se):(Ce.flags|=2,ue)):(Ce.flags|=1048576,ue)}function $(Ce){return f&&Ce.alternate===null&&(Ce.flags|=2),Ce}function ne(Ce,ue,Se,it){return ue===null||ue.tag!==6?(ue=J3(Se,Ce.mode,it),ue.return=Ce,ue):(ue=T(ue,Se),ue.return=Ce,ue)}function ae(Ce,ue,Se,it){var Pt=Se.type;return Pt===D?$e(Ce,ue,Se.props.children,it,Se.key):ue!==null&&(ue.elementType===Pt||typeof Pt=="object"&&Pt!==null&&Pt.$$typeof===pe&&YY(Pt)===ue.type)?(it=T(ue,Se.props),it.ref=XS(Ce,ue,Se),it.return=Ce,it):(it=kT(Se.type,Se.key,Se.props,null,Ce.mode,it),it.ref=XS(Ce,ue,Se),it.return=Ce,it)}function Te(Ce,ue,Se,it){return ue===null||ue.tag!==4||ue.stateNode.containerInfo!==Se.containerInfo||ue.stateNode.implementation!==Se.implementation?(ue=e9(Se,Ce.mode,it),ue.return=Ce,ue):(ue=T(ue,Se.children||[]),ue.return=Ce,ue)}function $e(Ce,ue,Se,it,Pt){return ue===null||ue.tag!==7?(ue=U_(Se,Ce.mode,it,Pt),ue.return=Ce,ue):(ue=T(ue,Se),ue.return=Ce,ue)}function Qe(Ce,ue,Se){if(typeof ue=="string"&&ue!==""||typeof ue=="number")return ue=J3(""+ue,Ce.mode,Se),ue.return=Ce,ue;if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case I:return Se=kT(ue.type,ue.key,ue.props,null,Ce.mode,Se),Se.ref=XS(Ce,null,ue),Se.return=Ce,Se;case A:return ue=e9(ue,Ce.mode,Se),ue.return=Ce,ue;case pe:var it=ue._init;return Qe(Ce,it(ue._payload),Se)}if(io(ue)||_e(ue))return ue=U_(ue,Ce.mode,Se,null),ue.return=Ce,ue;iT(Ce,ue)}return null}function je(Ce,ue,Se,it){var Pt=ue!==null?ue.key:null;if(typeof Se=="string"&&Se!==""||typeof Se=="number")return Pt!==null?null:ne(Ce,ue,""+Se,it);if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case I:return Se.key===Pt?ae(Ce,ue,Se,it):null;case A:return Se.key===Pt?Te(Ce,ue,Se,it):null;case pe:return Pt=Se._init,je(Ce,ue,Pt(Se._payload),it)}if(io(Se)||_e(Se))return Pt!==null?null:$e(Ce,ue,Se,it,null);iT(Ce,Se)}return null}function mt(Ce,ue,Se,it,Pt){if(typeof it=="string"&&it!==""||typeof it=="number")return Ce=Ce.get(Se)||null,ne(ue,Ce,""+it,Pt);if(typeof it=="object"&&it!==null){switch(it.$$typeof){case I:return Ce=Ce.get(it.key===null?Se:it.key)||null,ae(ue,Ce,it,Pt);case A:return Ce=Ce.get(it.key===null?Se:it.key)||null,Te(ue,Ce,it,Pt);case pe:var Qt=it._init;return mt(Ce,ue,Se,Qt(it._payload),Pt)}if(io(it)||_e(it))return Ce=Ce.get(Se)||null,$e(ue,Ce,it,Pt,null);iT(ue,it)}return null}function Lt(Ce,ue,Se,it){for(var Pt=null,Qt=null,Yt=ue,ci=ue=0,Br=null;Yt!==null&&ci<Se.length;ci++){Yt.index>ci?(Br=Yt,Yt=null):Br=Yt.sibling;var hn=je(Ce,Yt,Se[ci],it);if(hn===null){Yt===null&&(Yt=Br);break}f&&Yt&&hn.alternate===null&&m(Ce,Yt),ue=O(hn,ue,ci),Qt===null?Pt=hn:Qt.sibling=hn,Qt=hn,Yt=Br}if(ci===Se.length)return w(Ce,Yt),us&&M_(Ce,ci),Pt;if(Yt===null){for(;ci<Se.length;ci++)Yt=Qe(Ce,Se[ci],it),Yt!==null&&(ue=O(Yt,ue,ci),Qt===null?Pt=Yt:Qt.sibling=Yt,Qt=Yt);return us&&M_(Ce,ci),Pt}for(Yt=k(Ce,Yt);ci<Se.length;ci++)Br=mt(Yt,Ce,ci,Se[ci],it),Br!==null&&(f&&Br.alternate!==null&&Yt.delete(Br.key===null?ci:Br.key),ue=O(Br,ue,ci),Qt===null?Pt=Br:Qt.sibling=Br,Qt=Br);return f&&Yt.forEach(function(dp){return m(Ce,dp)}),us&&M_(Ce,ci),Pt}function Et(Ce,ue,Se,it){var Pt=_e(Se);if(typeof Pt!="function")throw Error(t(150));if(Se=Pt.call(Se),Se==null)throw Error(t(151));for(var Qt=Pt=null,Yt=ue,ci=ue=0,Br=null,hn=Se.next();Yt!==null&&!hn.done;ci++,hn=Se.next()){Yt.index>ci?(Br=Yt,Yt=null):Br=Yt.sibling;var dp=je(Ce,Yt,hn.value,it);if(dp===null){Yt===null&&(Yt=Br);break}f&&Yt&&dp.alternate===null&&m(Ce,Yt),ue=O(dp,ue,ci),Qt===null?Pt=dp:Qt.sibling=dp,Qt=dp,Yt=Br}if(hn.done)return w(Ce,Yt),us&&M_(Ce,ci),Pt;if(Yt===null){for(;!hn.done;ci++,hn=Se.next())hn=Qe(Ce,hn.value,it),hn!==null&&(ue=O(hn,ue,ci),Qt===null?Pt=hn:Qt.sibling=hn,Qt=hn);return us&&M_(Ce,ci),Pt}for(Yt=k(Ce,Yt);!hn.done;ci++,hn=Se.next())hn=mt(Yt,Ce,ci,hn.value,it),hn!==null&&(f&&hn.alternate!==null&&Yt.delete(hn.key===null?ci:hn.key),ue=O(hn,ue,ci),Qt===null?Pt=hn:Qt.sibling=hn,Qt=hn);return f&&Yt.forEach(function(Qwe){return m(Ce,Qwe)}),us&&M_(Ce,ci),Pt}function Us(Ce,ue,Se,it){if(typeof Se=="object"&&Se!==null&&Se.type===D&&Se.key===null&&(Se=Se.props.children),typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case I:e:{for(var Pt=Se.key,Qt=ue;Qt!==null;){if(Qt.key===Pt){if(Pt=Se.type,Pt===D){if(Qt.tag===7){w(Ce,Qt.sibling),ue=T(Qt,Se.props.children),ue.return=Ce,Ce=ue;break e}}else if(Qt.elementType===Pt||typeof Pt=="object"&&Pt!==null&&Pt.$$typeof===pe&&YY(Pt)===Qt.type){w(Ce,Qt.sibling),ue=T(Qt,Se.props),ue.ref=XS(Ce,Qt,Se),ue.return=Ce,Ce=ue;break e}w(Ce,Qt);break}else m(Ce,Qt);Qt=Qt.sibling}Se.type===D?(ue=U_(Se.props.children,Ce.mode,it,Se.key),ue.return=Ce,Ce=ue):(it=kT(Se.type,Se.key,Se.props,null,Ce.mode,it),it.ref=XS(Ce,ue,Se),it.return=Ce,Ce=it)}return $(Ce);case A:e:{for(Qt=Se.key;ue!==null;){if(ue.key===Qt)if(ue.tag===4&&ue.stateNode.containerInfo===Se.containerInfo&&ue.stateNode.implementation===Se.implementation){w(Ce,ue.sibling),ue=T(ue,Se.children||[]),ue.return=Ce,Ce=ue;break e}else{w(Ce,ue);break}else m(Ce,ue);ue=ue.sibling}ue=e9(Se,Ce.mode,it),ue.return=Ce,Ce=ue}return $(Ce);case pe:return Qt=Se._init,Us(Ce,ue,Qt(Se._payload),it)}if(io(Se))return Lt(Ce,ue,Se,it);if(_e(Se))return Et(Ce,ue,Se,it);iT(Ce,Se)}return typeof Se=="string"&&Se!==""||typeof Se=="number"?(Se=""+Se,ue!==null&&ue.tag===6?(w(Ce,ue.sibling),ue=T(ue,Se),ue.return=Ce,Ce=ue):(w(Ce,ue),ue=J3(Se,Ce.mode,it),ue.return=Ce,Ce=ue),$(Ce)):w(Ce,ue)}return Us}var N0=XY(!0),ZY=XY(!1),nT=Jg(null),sT=null,R0=null,c3=null;function d3(){c3=R0=sT=null}function u3(f){var m=nT.current;os(nT),f._currentValue=m}function h3(f,m,w){for(;f!==null;){var k=f.alternate;if((f.childLanes&m)!==m?(f.childLanes|=m,k!==null&&(k.childLanes|=m)):k!==null&&(k.childLanes&m)!==m&&(k.childLanes|=m),f===w)break;f=f.return}}function A0(f,m){sT=f,c3=R0=null,f=f.dependencies,f!==null&&f.firstContext!==null&&((f.lanes&m)!==0&&(el=!0),f.firstContext=null)}function Pc(f){var m=f._currentValue;if(c3!==f)if(f={context:f,memoizedValue:m,next:null},R0===null){if(sT===null)throw Error(t(308));R0=f,sT.dependencies={lanes:0,firstContext:f}}else R0=R0.next=f;return m}var O_=null;function f3(f){O_===null?O_=[f]:O_.push(f)}function JY(f,m,w,k){var T=m.interleaved;return T===null?(w.next=w,f3(m)):(w.next=T.next,T.next=w),m.interleaved=w,af(f,k)}function af(f,m){f.lanes|=m;var w=f.alternate;for(w!==null&&(w.lanes|=m),w=f,f=f.return;f!==null;)f.childLanes|=m,w=f.alternate,w!==null&&(w.childLanes|=m),w=f,f=f.return;return w.tag===3?w.stateNode:null}var ip=!1;function g3(f){f.updateQueue={baseState:f.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function eX(f,m){f=f.updateQueue,m.updateQueue===f&&(m.updateQueue={baseState:f.baseState,firstBaseUpdate:f.firstBaseUpdate,lastBaseUpdate:f.lastBaseUpdate,shared:f.shared,effects:f.effects})}function lf(f,m){return{eventTime:f,lane:m,tag:0,payload:null,callback:null,next:null}}function np(f,m,w){var k=f.updateQueue;if(k===null)return null;if(k=k.shared,(an&2)!==0){var T=k.pending;return T===null?m.next=m:(m.next=T.next,T.next=m),k.pending=m,af(f,w)}return T=k.interleaved,T===null?(m.next=m,f3(k)):(m.next=T.next,T.next=m),k.interleaved=m,af(f,w)}function rT(f,m,w){if(m=m.updateQueue,m!==null&&(m=m.shared,(w&4194240)!==0)){var k=m.lanes;k&=f.pendingLanes,w|=k,m.lanes=w,qg(f,w)}}function tX(f,m){var w=f.updateQueue,k=f.alternate;if(k!==null&&(k=k.updateQueue,w===k)){var T=null,O=null;if(w=w.firstBaseUpdate,w!==null){do{var $={eventTime:w.eventTime,lane:w.lane,tag:w.tag,payload:w.payload,callback:w.callback,next:null};O===null?T=O=$:O=O.next=$,w=w.next}while(w!==null);O===null?T=O=m:O=O.next=m}else T=O=m;w={baseState:k.baseState,firstBaseUpdate:T,lastBaseUpdate:O,shared:k.shared,effects:k.effects},f.updateQueue=w;return}f=w.lastBaseUpdate,f===null?w.firstBaseUpdate=m:f.next=m,w.lastBaseUpdate=m}function oT(f,m,w,k){var T=f.updateQueue;ip=!1;var O=T.firstBaseUpdate,$=T.lastBaseUpdate,ne=T.shared.pending;if(ne!==null){T.shared.pending=null;var ae=ne,Te=ae.next;ae.next=null,$===null?O=Te:$.next=Te,$=ae;var $e=f.alternate;$e!==null&&($e=$e.updateQueue,ne=$e.lastBaseUpdate,ne!==$&&(ne===null?$e.firstBaseUpdate=Te:ne.next=Te,$e.lastBaseUpdate=ae))}if(O!==null){var Qe=T.baseState;$=0,$e=Te=ae=null,ne=O;do{var je=ne.lane,mt=ne.eventTime;if((k&je)===je){$e!==null&&($e=$e.next={eventTime:mt,lane:0,tag:ne.tag,payload:ne.payload,callback:ne.callback,next:null});e:{var Lt=f,Et=ne;switch(je=m,mt=w,Et.tag){case 1:if(Lt=Et.payload,typeof Lt=="function"){Qe=Lt.call(mt,Qe,je);break e}Qe=Lt;break e;case 3:Lt.flags=Lt.flags&-65537|128;case 0:if(Lt=Et.payload,je=typeof Lt=="function"?Lt.call(mt,Qe,je):Lt,je==null)break e;Qe=Re({},Qe,je);break e;case 2:ip=!0}}ne.callback!==null&&ne.lane!==0&&(f.flags|=64,je=T.effects,je===null?T.effects=[ne]:je.push(ne))}else mt={eventTime:mt,lane:je,tag:ne.tag,payload:ne.payload,callback:ne.callback,next:null},$e===null?(Te=$e=mt,ae=Qe):$e=$e.next=mt,$|=je;if(ne=ne.next,ne===null){if(ne=T.shared.pending,ne===null)break;je=ne,ne=je.next,je.next=null,T.lastBaseUpdate=je,T.shared.pending=null}}while(!0);if($e===null&&(ae=Qe),T.baseState=ae,T.firstBaseUpdate=Te,T.lastBaseUpdate=$e,m=T.shared.interleaved,m!==null){T=m;do $|=T.lane,T=T.next;while(T!==m)}else O===null&&(T.shared.lanes=0);B_|=$,f.lanes=$,f.memoizedState=Qe}}function iX(f,m,w){if(f=m.effects,m.effects=null,f!==null)for(m=0;m<f.length;m++){var k=f[m],T=k.callback;if(T!==null){if(k.callback=null,k=w,typeof T!="function")throw Error(t(191,T));T.call(k)}}}var ZS={},Au=Jg(ZS),JS=Jg(ZS),ex=Jg(ZS);function F_(f){if(f===ZS)throw Error(t(174));return f}function p3(f,m){switch(Jn(ex,m),Jn(JS,f),Jn(Au,ZS),f=m.nodeType,f){case 9:case 11:m=(m=m.documentElement)?m.namespaceURI:Zn(null,"");break;default:f=f===8?m.parentNode:m,m=f.namespaceURI||null,f=f.tagName,m=Zn(m,f)}os(Au),Jn(Au,m)}function P0(){os(Au),os(JS),os(ex)}function nX(f){F_(ex.current);var m=F_(Au.current),w=Zn(m,f.type);m!==w&&(Jn(JS,f),Jn(Au,w))}function m3(f){JS.current===f&&(os(Au),os(JS))}var ms=Jg(0);function aT(f){for(var m=f;m!==null;){if(m.tag===13){var w=m.memoizedState;if(w!==null&&(w=w.dehydrated,w===null||w.data==="$?"||w.data==="$!"))return m}else if(m.tag===19&&m.memoizedProps.revealOrder!==void 0){if((m.flags&128)!==0)return m}else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===f)break;for(;m.sibling===null;){if(m.return===null||m.return===f)return null;m=m.return}m.sibling.return=m.return,m=m.sibling}return null}var _3=[];function b3(){for(var f=0;f<_3.length;f++)_3[f]._workInProgressVersionPrimary=null;_3.length=0}var lT=L.ReactCurrentDispatcher,v3=L.ReactCurrentBatchConfig,V_=0,_s=null,wr=null,Fr=null,cT=!1,tx=!1,ix=0,_we=0;function Fo(){throw Error(t(321))}function w3(f,m){if(m===null)return!1;for(var w=0;w<m.length&&w<f.length;w++)if(!xd(f[w],m[w]))return!1;return!0}function C3(f,m,w,k,T,O){if(V_=O,_s=m,m.memoizedState=null,m.updateQueue=null,m.lanes=0,lT.current=f===null||f.memoizedState===null?Cwe:ywe,f=w(k,T),tx){O=0;do{if(tx=!1,ix=0,25<=O)throw Error(t(301));O+=1,Fr=wr=null,m.updateQueue=null,lT.current=Swe,f=w(k,T)}while(tx)}if(lT.current=hT,m=wr!==null&&wr.next!==null,V_=0,Fr=wr=_s=null,cT=!1,m)throw Error(t(300));return f}function y3(){var f=ix!==0;return ix=0,f}function Pu(){var f={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Fr===null?_s.memoizedState=Fr=f:Fr=Fr.next=f,Fr}function Mc(){if(wr===null){var f=_s.alternate;f=f!==null?f.memoizedState:null}else f=wr.next;var m=Fr===null?_s.memoizedState:Fr.next;if(m!==null)Fr=m,wr=f;else{if(f===null)throw Error(t(310));wr=f,f={memoizedState:wr.memoizedState,baseState:wr.baseState,baseQueue:wr.baseQueue,queue:wr.queue,next:null},Fr===null?_s.memoizedState=Fr=f:Fr=Fr.next=f}return Fr}function nx(f,m){return typeof m=="function"?m(f):m}function S3(f){var m=Mc(),w=m.queue;if(w===null)throw Error(t(311));w.lastRenderedReducer=f;var k=wr,T=k.baseQueue,O=w.pending;if(O!==null){if(T!==null){var $=T.next;T.next=O.next,O.next=$}k.baseQueue=T=O,w.pending=null}if(T!==null){O=T.next,k=k.baseState;var ne=$=null,ae=null,Te=O;do{var $e=Te.lane;if((V_&$e)===$e)ae!==null&&(ae=ae.next={lane:0,action:Te.action,hasEagerState:Te.hasEagerState,eagerState:Te.eagerState,next:null}),k=Te.hasEagerState?Te.eagerState:f(k,Te.action);else{var Qe={lane:$e,action:Te.action,hasEagerState:Te.hasEagerState,eagerState:Te.eagerState,next:null};ae===null?(ne=ae=Qe,$=k):ae=ae.next=Qe,_s.lanes|=$e,B_|=$e}Te=Te.next}while(Te!==null&&Te!==O);ae===null?$=k:ae.next=ne,xd(k,m.memoizedState)||(el=!0),m.memoizedState=k,m.baseState=$,m.baseQueue=ae,w.lastRenderedState=k}if(f=w.interleaved,f!==null){T=f;do O=T.lane,_s.lanes|=O,B_|=O,T=T.next;while(T!==f)}else T===null&&(w.lanes=0);return[m.memoizedState,w.dispatch]}function x3(f){var m=Mc(),w=m.queue;if(w===null)throw Error(t(311));w.lastRenderedReducer=f;var k=w.dispatch,T=w.pending,O=m.memoizedState;if(T!==null){w.pending=null;var $=T=T.next;do O=f(O,$.action),$=$.next;while($!==T);xd(O,m.memoizedState)||(el=!0),m.memoizedState=O,m.baseQueue===null&&(m.baseState=O),w.lastRenderedState=O}return[O,k]}function sX(){}function rX(f,m){var w=_s,k=Mc(),T=m(),O=!xd(k.memoizedState,T);if(O&&(k.memoizedState=T,el=!0),k=k.queue,L3(lX.bind(null,w,k,f),[f]),k.getSnapshot!==m||O||Fr!==null&&Fr.memoizedState.tag&1){if(w.flags|=2048,sx(9,aX.bind(null,w,k,T,m),void 0,null),Vr===null)throw Error(t(349));(V_&30)!==0||oX(w,m,T)}return T}function oX(f,m,w){f.flags|=16384,f={getSnapshot:m,value:w},m=_s.updateQueue,m===null?(m={lastEffect:null,stores:null},_s.updateQueue=m,m.stores=[f]):(w=m.stores,w===null?m.stores=[f]:w.push(f))}function aX(f,m,w,k){m.value=w,m.getSnapshot=k,cX(m)&&dX(f)}function lX(f,m,w){return w(function(){cX(m)&&dX(f)})}function cX(f){var m=f.getSnapshot;f=f.value;try{var w=m();return!xd(f,w)}catch{return!0}}function dX(f){var m=af(f,1);m!==null&&Dd(m,f,1,-1)}function uX(f){var m=Pu();return typeof f=="function"&&(f=f()),m.memoizedState=m.baseState=f,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:nx,lastRenderedState:f},m.queue=f,f=f.dispatch=wwe.bind(null,_s,f),[m.memoizedState,f]}function sx(f,m,w,k){return f={tag:f,create:m,destroy:w,deps:k,next:null},m=_s.updateQueue,m===null?(m={lastEffect:null,stores:null},_s.updateQueue=m,m.lastEffect=f.next=f):(w=m.lastEffect,w===null?m.lastEffect=f.next=f:(k=w.next,w.next=f,f.next=k,m.lastEffect=f)),f}function hX(){return Mc().memoizedState}function dT(f,m,w,k){var T=Pu();_s.flags|=f,T.memoizedState=sx(1|m,w,void 0,k===void 0?null:k)}function uT(f,m,w,k){var T=Mc();k=k===void 0?null:k;var O=void 0;if(wr!==null){var $=wr.memoizedState;if(O=$.destroy,k!==null&&w3(k,$.deps)){T.memoizedState=sx(m,w,O,k);return}}_s.flags|=f,T.memoizedState=sx(1|m,w,O,k)}function fX(f,m){return dT(8390656,8,f,m)}function L3(f,m){return uT(2048,8,f,m)}function gX(f,m){return uT(4,2,f,m)}function pX(f,m){return uT(4,4,f,m)}function mX(f,m){if(typeof m=="function")return f=f(),m(f),function(){m(null)};if(m!=null)return f=f(),m.current=f,function(){m.current=null}}function _X(f,m,w){return w=w!=null?w.concat([f]):null,uT(4,4,mX.bind(null,m,f),w)}function k3(){}function bX(f,m){var w=Mc();m=m===void 0?null:m;var k=w.memoizedState;return k!==null&&m!==null&&w3(m,k[1])?k[0]:(w.memoizedState=[f,m],f)}function vX(f,m){var w=Mc();m=m===void 0?null:m;var k=w.memoizedState;return k!==null&&m!==null&&w3(m,k[1])?k[0]:(f=f(),w.memoizedState=[f,m],f)}function wX(f,m,w){return(V_&21)===0?(f.baseState&&(f.baseState=!1,el=!0),f.memoizedState=w):(xd(w,m)||(w=I_(),_s.lanes|=w,B_|=w,f.baseState=!0),m)}function bwe(f,m){var w=zi;zi=w!==0&&4>w?w:4,f(!0);var k=v3.transition;v3.transition={};try{f(!1),m()}finally{zi=w,v3.transition=k}}function CX(){return Mc().memoizedState}function vwe(f,m,w){var k=ap(f);if(w={lane:k,action:w,hasEagerState:!1,eagerState:null,next:null},yX(f))SX(m,w);else if(w=JY(f,m,w,k),w!==null){var T=pa();Dd(w,f,k,T),xX(w,m,k)}}function wwe(f,m,w){var k=ap(f),T={lane:k,action:w,hasEagerState:!1,eagerState:null,next:null};if(yX(f))SX(m,T);else{var O=f.alternate;if(f.lanes===0&&(O===null||O.lanes===0)&&(O=m.lastRenderedReducer,O!==null))try{var $=m.lastRenderedState,ne=O($,w);if(T.hasEagerState=!0,T.eagerState=ne,xd(ne,$)){var ae=m.interleaved;ae===null?(T.next=T,f3(m)):(T.next=ae.next,ae.next=T),m.interleaved=T;return}}catch{}finally{}w=JY(f,m,T,k),w!==null&&(T=pa(),Dd(w,f,k,T),xX(w,m,k))}}function yX(f){var m=f.alternate;return f===_s||m!==null&&m===_s}function SX(f,m){tx=cT=!0;var w=f.pending;w===null?m.next=m:(m.next=w.next,w.next=m),f.pending=m}function xX(f,m,w){if((w&4194240)!==0){var k=m.lanes;k&=f.pendingLanes,w|=k,m.lanes=w,qg(f,w)}}var hT={readContext:Pc,useCallback:Fo,useContext:Fo,useEffect:Fo,useImperativeHandle:Fo,useInsertionEffect:Fo,useLayoutEffect:Fo,useMemo:Fo,useReducer:Fo,useRef:Fo,useState:Fo,useDebugValue:Fo,useDeferredValue:Fo,useTransition:Fo,useMutableSource:Fo,useSyncExternalStore:Fo,useId:Fo,unstable_isNewReconciler:!1},Cwe={readContext:Pc,useCallback:function(f,m){return Pu().memoizedState=[f,m===void 0?null:m],f},useContext:Pc,useEffect:fX,useImperativeHandle:function(f,m,w){return w=w!=null?w.concat([f]):null,dT(4194308,4,mX.bind(null,m,f),w)},useLayoutEffect:function(f,m){return dT(4194308,4,f,m)},useInsertionEffect:function(f,m){return dT(4,2,f,m)},useMemo:function(f,m){var w=Pu();return m=m===void 0?null:m,f=f(),w.memoizedState=[f,m],f},useReducer:function(f,m,w){var k=Pu();return m=w!==void 0?w(m):m,k.memoizedState=k.baseState=m,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:f,lastRenderedState:m},k.queue=f,f=f.dispatch=vwe.bind(null,_s,f),[k.memoizedState,f]},useRef:function(f){var m=Pu();return f={current:f},m.memoizedState=f},useState:uX,useDebugValue:k3,useDeferredValue:function(f){return Pu().memoizedState=f},useTransition:function(){var f=uX(!1),m=f[0];return f=bwe.bind(null,f[1]),Pu().memoizedState=f,[m,f]},useMutableSource:function(){},useSyncExternalStore:function(f,m,w){var k=_s,T=Pu();if(us){if(w===void 0)throw Error(t(407));w=w()}else{if(w=m(),Vr===null)throw Error(t(349));(V_&30)!==0||oX(k,m,w)}T.memoizedState=w;var O={value:w,getSnapshot:m};return T.queue=O,fX(lX.bind(null,k,O,f),[f]),k.flags|=2048,sx(9,aX.bind(null,k,O,w,m),void 0,null),w},useId:function(){var f=Pu(),m=Vr.identifierPrefix;if(us){var w=of,k=rf;w=(k&~(1<<32-ha(k)-1)).toString(32)+w,m=":"+m+"R"+w,w=ix++,0<w&&(m+="H"+w.toString(32)),m+=":"}else w=_we++,m=":"+m+"r"+w.toString(32)+":";return f.memoizedState=m},unstable_isNewReconciler:!1},ywe={readContext:Pc,useCallback:bX,useContext:Pc,useEffect:L3,useImperativeHandle:_X,useInsertionEffect:gX,useLayoutEffect:pX,useMemo:vX,useReducer:S3,useRef:hX,useState:function(){return S3(nx)},useDebugValue:k3,useDeferredValue:function(f){var m=Mc();return wX(m,wr.memoizedState,f)},useTransition:function(){var f=S3(nx)[0],m=Mc().memoizedState;return[f,m]},useMutableSource:sX,useSyncExternalStore:rX,useId:CX,unstable_isNewReconciler:!1},Swe={readContext:Pc,useCallback:bX,useContext:Pc,useEffect:L3,useImperativeHandle:_X,useInsertionEffect:gX,useLayoutEffect:pX,useMemo:vX,useReducer:x3,useRef:hX,useState:function(){return x3(nx)},useDebugValue:k3,useDeferredValue:function(f){var m=Mc();return wr===null?m.memoizedState=f:wX(m,wr.memoizedState,f)},useTransition:function(){var f=x3(nx)[0],m=Mc().memoizedState;return[f,m]},useMutableSource:sX,useSyncExternalStore:rX,useId:CX,unstable_isNewReconciler:!1};function kd(f,m){if(f&&f.defaultProps){m=Re({},m),f=f.defaultProps;for(var w in f)m[w]===void 0&&(m[w]=f[w]);return m}return m}function I3(f,m,w,k){m=f.memoizedState,w=w(k,m),w=w==null?m:Re({},m,w),f.memoizedState=w,f.lanes===0&&(f.updateQueue.baseState=w)}var fT={isMounted:function(f){return(f=f._reactInternals)?ki(f)===f:!1},enqueueSetState:function(f,m,w){f=f._reactInternals;var k=pa(),T=ap(f),O=lf(k,T);O.payload=m,w!=null&&(O.callback=w),m=np(f,O,T),m!==null&&(Dd(m,f,T,k),rT(m,f,T))},enqueueReplaceState:function(f,m,w){f=f._reactInternals;var k=pa(),T=ap(f),O=lf(k,T);O.tag=1,O.payload=m,w!=null&&(O.callback=w),m=np(f,O,T),m!==null&&(Dd(m,f,T,k),rT(m,f,T))},enqueueForceUpdate:function(f,m){f=f._reactInternals;var w=pa(),k=ap(f),T=lf(w,k);T.tag=2,m!=null&&(T.callback=m),m=np(f,T,k),m!==null&&(Dd(m,f,k,w),rT(m,f,k))}};function LX(f,m,w,k,T,O,$){return f=f.stateNode,typeof f.shouldComponentUpdate=="function"?f.shouldComponentUpdate(k,O,$):m.prototype&&m.prototype.isPureReactComponent?!jS(w,k)||!jS(T,O):!0}function kX(f,m,w){var k=!1,T=ep,O=m.contextType;return typeof O=="object"&&O!==null?O=Pc(O):(T=Ja(m)?A_:Oo.current,k=m.contextTypes,O=(k=k!=null)?I0(f,T):ep),m=new m(w,O),f.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=fT,f.stateNode=m,m._reactInternals=f,k&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=T,f.__reactInternalMemoizedMaskedChildContext=O),m}function IX(f,m,w,k){f=m.state,typeof m.componentWillReceiveProps=="function"&&m.componentWillReceiveProps(w,k),typeof m.UNSAFE_componentWillReceiveProps=="function"&&m.UNSAFE_componentWillReceiveProps(w,k),m.state!==f&&fT.enqueueReplaceState(m,m.state,null)}function E3(f,m,w,k){var T=f.stateNode;T.props=w,T.state=f.memoizedState,T.refs={},g3(f);var O=m.contextType;typeof O=="object"&&O!==null?T.context=Pc(O):(O=Ja(m)?A_:Oo.current,T.context=I0(f,O)),T.state=f.memoizedState,O=m.getDerivedStateFromProps,typeof O=="function"&&(I3(f,m,O,w),T.state=f.memoizedState),typeof m.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(m=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),m!==T.state&&fT.enqueueReplaceState(T,T.state,null),oT(f,w,T,k),T.state=f.memoizedState),typeof T.componentDidMount=="function"&&(f.flags|=4194308)}function M0(f,m){try{var w="",k=m;do w+=tt(k),k=k.return;while(k);var T=w}catch(O){T=`
Error generating stack: `+O.message+`
`+O.stack}return{value:f,source:m,stack:T,digest:null}}function D3(f,m,w){return{value:f,source:null,stack:w??null,digest:m??null}}function T3(f,m){try{console.error(m.value)}catch(w){setTimeout(function(){throw w})}}var xwe=typeof WeakMap=="function"?WeakMap:Map;function EX(f,m,w){w=lf(-1,w),w.tag=3,w.payload={element:null};var k=m.value;return w.callback=function(){wT||(wT=!0,$3=k),T3(f,m)},w}function DX(f,m,w){w=lf(-1,w),w.tag=3;var k=f.type.getDerivedStateFromError;if(typeof k=="function"){var T=m.value;w.payload=function(){return k(T)},w.callback=function(){T3(f,m)}}var O=f.stateNode;return O!==null&&typeof O.componentDidCatch=="function"&&(w.callback=function(){T3(f,m),typeof k!="function"&&(rp===null?rp=new Set([this]):rp.add(this));var $=m.stack;this.componentDidCatch(m.value,{componentStack:$!==null?$:""})}),w}function TX(f,m,w){var k=f.pingCache;if(k===null){k=f.pingCache=new xwe;var T=new Set;k.set(m,T)}else T=k.get(m),T===void 0&&(T=new Set,k.set(m,T));T.has(w)||(T.add(w),f=Vwe.bind(null,f,m,w),m.then(f,f))}function NX(f){do{var m;if((m=f.tag===13)&&(m=f.memoizedState,m=m!==null?m.dehydrated!==null:!0),m)return f;f=f.return}while(f!==null);return null}function RX(f,m,w,k,T){return(f.mode&1)===0?(f===m?f.flags|=65536:(f.flags|=128,w.flags|=131072,w.flags&=-52805,w.tag===1&&(w.alternate===null?w.tag=17:(m=lf(-1,1),m.tag=2,np(w,m,1))),w.lanes|=1),f):(f.flags|=65536,f.lanes=T,f)}var Lwe=L.ReactCurrentOwner,el=!1;function ga(f,m,w,k){m.child=f===null?ZY(m,null,w,k):N0(m,f.child,w,k)}function AX(f,m,w,k,T){w=w.render;var O=m.ref;return A0(m,T),k=C3(f,m,w,k,O,T),w=y3(),f!==null&&!el?(m.updateQueue=f.updateQueue,m.flags&=-2053,f.lanes&=~T,cf(f,m,T)):(us&&w&&s3(m),m.flags|=1,ga(f,m,k,T),m.child)}function PX(f,m,w,k,T){if(f===null){var O=w.type;return typeof O=="function"&&!Z3(O)&&O.defaultProps===void 0&&w.compare===null&&w.defaultProps===void 0?(m.tag=15,m.type=O,MX(f,m,O,k,T)):(f=kT(w.type,null,k,m,m.mode,T),f.ref=m.ref,f.return=m,m.child=f)}if(O=f.child,(f.lanes&T)===0){var $=O.memoizedProps;if(w=w.compare,w=w!==null?w:jS,w($,k)&&f.ref===m.ref)return cf(f,m,T)}return m.flags|=1,f=cp(O,k),f.ref=m.ref,f.return=m,m.child=f}function MX(f,m,w,k,T){if(f!==null){var O=f.memoizedProps;if(jS(O,k)&&f.ref===m.ref)if(el=!1,m.pendingProps=k=O,(f.lanes&T)!==0)(f.flags&131072)!==0&&(el=!0);else return m.lanes=f.lanes,cf(f,m,T)}return N3(f,m,w,k,T)}function OX(f,m,w){var k=m.pendingProps,T=k.children,O=f!==null?f.memoizedState:null;if(k.mode==="hidden")if((m.mode&1)===0)m.memoizedState={baseLanes:0,cachePool:null,transitions:null},Jn(F0,Xl),Xl|=w;else{if((w&1073741824)===0)return f=O!==null?O.baseLanes|w:w,m.lanes=m.childLanes=1073741824,m.memoizedState={baseLanes:f,cachePool:null,transitions:null},m.updateQueue=null,Jn(F0,Xl),Xl|=f,null;m.memoizedState={baseLanes:0,cachePool:null,transitions:null},k=O!==null?O.baseLanes:w,Jn(F0,Xl),Xl|=k}else O!==null?(k=O.baseLanes|w,m.memoizedState=null):k=w,Jn(F0,Xl),Xl|=k;return ga(f,m,T,w),m.child}function FX(f,m){var w=m.ref;(f===null&&w!==null||f!==null&&f.ref!==w)&&(m.flags|=512,m.flags|=2097152)}function N3(f,m,w,k,T){var O=Ja(w)?A_:Oo.current;return O=I0(m,O),A0(m,T),w=C3(f,m,w,k,O,T),k=y3(),f!==null&&!el?(m.updateQueue=f.updateQueue,m.flags&=-2053,f.lanes&=~T,cf(f,m,T)):(us&&k&&s3(m),m.flags|=1,ga(f,m,w,T),m.child)}function VX(f,m,w,k,T){if(Ja(w)){var O=!0;XD(m)}else O=!1;if(A0(m,T),m.stateNode===null)pT(f,m),kX(m,w,k),E3(m,w,k,T),k=!0;else if(f===null){var $=m.stateNode,ne=m.memoizedProps;$.props=ne;var ae=$.context,Te=w.contextType;typeof Te=="object"&&Te!==null?Te=Pc(Te):(Te=Ja(w)?A_:Oo.current,Te=I0(m,Te));var $e=w.getDerivedStateFromProps,Qe=typeof $e=="function"||typeof $.getSnapshotBeforeUpdate=="function";Qe||typeof $.UNSAFE_componentWillReceiveProps!="function"&&typeof $.componentWillReceiveProps!="function"||(ne!==k||ae!==Te)&&IX(m,$,k,Te),ip=!1;var je=m.memoizedState;$.state=je,oT(m,k,$,T),ae=m.memoizedState,ne!==k||je!==ae||Za.current||ip?(typeof $e=="function"&&(I3(m,w,$e,k),ae=m.memoizedState),(ne=ip||LX(m,w,ne,k,je,ae,Te))?(Qe||typeof $.UNSAFE_componentWillMount!="function"&&typeof $.componentWillMount!="function"||(typeof $.componentWillMount=="function"&&$.componentWillMount(),typeof $.UNSAFE_componentWillMount=="function"&&$.UNSAFE_componentWillMount()),typeof $.componentDidMount=="function"&&(m.flags|=4194308)):(typeof $.componentDidMount=="function"&&(m.flags|=4194308),m.memoizedProps=k,m.memoizedState=ae),$.props=k,$.state=ae,$.context=Te,k=ne):(typeof $.componentDidMount=="function"&&(m.flags|=4194308),k=!1)}else{$=m.stateNode,eX(f,m),ne=m.memoizedProps,Te=m.type===m.elementType?ne:kd(m.type,ne),$.props=Te,Qe=m.pendingProps,je=$.context,ae=w.contextType,typeof ae=="object"&&ae!==null?ae=Pc(ae):(ae=Ja(w)?A_:Oo.current,ae=I0(m,ae));var mt=w.getDerivedStateFromProps;($e=typeof mt=="function"||typeof $.getSnapshotBeforeUpdate=="function")||typeof $.UNSAFE_componentWillReceiveProps!="function"&&typeof $.componentWillReceiveProps!="function"||(ne!==Qe||je!==ae)&&IX(m,$,k,ae),ip=!1,je=m.memoizedState,$.state=je,oT(m,k,$,T);var Lt=m.memoizedState;ne!==Qe||je!==Lt||Za.current||ip?(typeof mt=="function"&&(I3(m,w,mt,k),Lt=m.memoizedState),(Te=ip||LX(m,w,Te,k,je,Lt,ae)||!1)?($e||typeof $.UNSAFE_componentWillUpdate!="function"&&typeof $.componentWillUpdate!="function"||(typeof $.componentWillUpdate=="function"&&$.componentWillUpdate(k,Lt,ae),typeof $.UNSAFE_componentWillUpdate=="function"&&$.UNSAFE_componentWillUpdate(k,Lt,ae)),typeof $.componentDidUpdate=="function"&&(m.flags|=4),typeof $.getSnapshotBeforeUpdate=="function"&&(m.flags|=1024)):(typeof $.componentDidUpdate!="function"||ne===f.memoizedProps&&je===f.memoizedState||(m.flags|=4),typeof $.getSnapshotBeforeUpdate!="function"||ne===f.memoizedProps&&je===f.memoizedState||(m.flags|=1024),m.memoizedProps=k,m.memoizedState=Lt),$.props=k,$.state=Lt,$.context=ae,k=Te):(typeof $.componentDidUpdate!="function"||ne===f.memoizedProps&&je===f.memoizedState||(m.flags|=4),typeof $.getSnapshotBeforeUpdate!="function"||ne===f.memoizedProps&&je===f.memoizedState||(m.flags|=1024),k=!1)}return R3(f,m,w,k,O,T)}function R3(f,m,w,k,T,O){FX(f,m);var $=(m.flags&128)!==0;if(!k&&!$)return T&&UY(m,w,!1),cf(f,m,O);k=m.stateNode,Lwe.current=m;var ne=$&&typeof w.getDerivedStateFromError!="function"?null:k.render();return m.flags|=1,f!==null&&$?(m.child=N0(m,f.child,null,O),m.child=N0(m,null,ne,O)):ga(f,m,ne,O),m.memoizedState=k.state,T&&UY(m,w,!0),m.child}function BX(f){var m=f.stateNode;m.pendingContext?HY(f,m.pendingContext,m.pendingContext!==m.context):m.context&&HY(f,m.context,!1),p3(f,m.containerInfo)}function WX(f,m,w,k,T){return T0(),l3(T),m.flags|=256,ga(f,m,w,k),m.child}var A3={dehydrated:null,treeContext:null,retryLane:0};function P3(f){return{baseLanes:f,cachePool:null,transitions:null}}function HX(f,m,w){var k=m.pendingProps,T=ms.current,O=!1,$=(m.flags&128)!==0,ne;if((ne=$)||(ne=f!==null&&f.memoizedState===null?!1:(T&2)!==0),ne?(O=!0,m.flags&=-129):(f===null||f.memoizedState!==null)&&(T|=1),Jn(ms,T&1),f===null)return a3(m),f=m.memoizedState,f!==null&&(f=f.dehydrated,f!==null)?((m.mode&1)===0?m.lanes=1:f.data==="$!"?m.lanes=8:m.lanes=1073741824,null):($=k.children,f=k.fallback,O?(k=m.mode,O=m.child,$={mode:"hidden",children:$},(k&1)===0&&O!==null?(O.childLanes=0,O.pendingProps=$):O=IT($,k,0,null),f=U_(f,k,w,null),O.return=m,f.return=m,O.sibling=f,m.child=O,m.child.memoizedState=P3(w),m.memoizedState=A3,f):M3(m,$));if(T=f.memoizedState,T!==null&&(ne=T.dehydrated,ne!==null))return kwe(f,m,$,k,ne,T,w);if(O){O=k.fallback,$=m.mode,T=f.child,ne=T.sibling;var ae={mode:"hidden",children:k.children};return($&1)===0&&m.child!==T?(k=m.child,k.childLanes=0,k.pendingProps=ae,m.deletions=null):(k=cp(T,ae),k.subtreeFlags=T.subtreeFlags&14680064),ne!==null?O=cp(ne,O):(O=U_(O,$,w,null),O.flags|=2),O.return=m,k.return=m,k.sibling=O,m.child=k,k=O,O=m.child,$=f.child.memoizedState,$=$===null?P3(w):{baseLanes:$.baseLanes|w,cachePool:null,transitions:$.transitions},O.memoizedState=$,O.childLanes=f.childLanes&~w,m.memoizedState=A3,k}return O=f.child,f=O.sibling,k=cp(O,{mode:"visible",children:k.children}),(m.mode&1)===0&&(k.lanes=w),k.return=m,k.sibling=null,f!==null&&(w=m.deletions,w===null?(m.deletions=[f],m.flags|=16):w.push(f)),m.child=k,m.memoizedState=null,k}function M3(f,m){return m=IT({mode:"visible",children:m},f.mode,0,null),m.return=f,f.child=m}function gT(f,m,w,k){return k!==null&&l3(k),N0(m,f.child,null,w),f=M3(m,m.pendingProps.children),f.flags|=2,m.memoizedState=null,f}function kwe(f,m,w,k,T,O,$){if(w)return m.flags&256?(m.flags&=-257,k=D3(Error(t(422))),gT(f,m,$,k)):m.memoizedState!==null?(m.child=f.child,m.flags|=128,null):(O=k.fallback,T=m.mode,k=IT({mode:"visible",children:k.children},T,0,null),O=U_(O,T,$,null),O.flags|=2,k.return=m,O.return=m,k.sibling=O,m.child=k,(m.mode&1)!==0&&N0(m,f.child,null,$),m.child.memoizedState=P3($),m.memoizedState=A3,O);if((m.mode&1)===0)return gT(f,m,$,null);if(T.data==="$!"){if(k=T.nextSibling&&T.nextSibling.dataset,k)var ne=k.dgst;return k=ne,O=Error(t(419)),k=D3(O,k,void 0),gT(f,m,$,k)}if(ne=($&f.childLanes)!==0,el||ne){if(k=Vr,k!==null){switch($&-$){case 4:T=2;break;case 16:T=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:T=32;break;case 536870912:T=268435456;break;default:T=0}T=(T&(k.suspendedLanes|$))!==0?0:T,T!==0&&T!==O.retryLane&&(O.retryLane=T,af(f,T),Dd(k,f,T,-1))}return X3(),k=D3(Error(t(421))),gT(f,m,$,k)}return T.data==="$?"?(m.flags|=128,m.child=f.child,m=Bwe.bind(null,f),T._reactRetry=m,null):(f=O.treeContext,Yl=Zg(T.nextSibling),Ql=m,us=!0,Ld=null,f!==null&&(Rc[Ac++]=rf,Rc[Ac++]=of,Rc[Ac++]=P_,rf=f.id,of=f.overflow,P_=m),m=M3(m,k.children),m.flags|=4096,m)}function zX(f,m,w){f.lanes|=m;var k=f.alternate;k!==null&&(k.lanes|=m),h3(f.return,m,w)}function O3(f,m,w,k,T){var O=f.memoizedState;O===null?f.memoizedState={isBackwards:m,rendering:null,renderingStartTime:0,last:k,tail:w,tailMode:T}:(O.isBackwards=m,O.rendering=null,O.renderingStartTime=0,O.last=k,O.tail=w,O.tailMode=T)}function UX(f,m,w){var k=m.pendingProps,T=k.revealOrder,O=k.tail;if(ga(f,m,k.children,w),k=ms.current,(k&2)!==0)k=k&1|2,m.flags|=128;else{if(f!==null&&(f.flags&128)!==0)e:for(f=m.child;f!==null;){if(f.tag===13)f.memoizedState!==null&&zX(f,w,m);else if(f.tag===19)zX(f,w,m);else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===m)break e;for(;f.sibling===null;){if(f.return===null||f.return===m)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}k&=1}if(Jn(ms,k),(m.mode&1)===0)m.memoizedState=null;else switch(T){case"forwards":for(w=m.child,T=null;w!==null;)f=w.alternate,f!==null&&aT(f)===null&&(T=w),w=w.sibling;w=T,w===null?(T=m.child,m.child=null):(T=w.sibling,w.sibling=null),O3(m,!1,T,w,O);break;case"backwards":for(w=null,T=m.child,m.child=null;T!==null;){if(f=T.alternate,f!==null&&aT(f)===null){m.child=T;break}f=T.sibling,T.sibling=w,w=T,T=f}O3(m,!0,w,null,O);break;case"together":O3(m,!1,null,null,void 0);break;default:m.memoizedState=null}return m.child}function pT(f,m){(m.mode&1)===0&&f!==null&&(f.alternate=null,m.alternate=null,m.flags|=2)}function cf(f,m,w){if(f!==null&&(m.dependencies=f.dependencies),B_|=m.lanes,(w&m.childLanes)===0)return null;if(f!==null&&m.child!==f.child)throw Error(t(153));if(m.child!==null){for(f=m.child,w=cp(f,f.pendingProps),m.child=w,w.return=m;f.sibling!==null;)f=f.sibling,w=w.sibling=cp(f,f.pendingProps),w.return=m;w.sibling=null}return m.child}function Iwe(f,m,w){switch(m.tag){case 3:BX(m),T0();break;case 5:nX(m);break;case 1:Ja(m.type)&&XD(m);break;case 4:p3(m,m.stateNode.containerInfo);break;case 10:var k=m.type._context,T=m.memoizedProps.value;Jn(nT,k._currentValue),k._currentValue=T;break;case 13:if(k=m.memoizedState,k!==null)return k.dehydrated!==null?(Jn(ms,ms.current&1),m.flags|=128,null):(w&m.child.childLanes)!==0?HX(f,m,w):(Jn(ms,ms.current&1),f=cf(f,m,w),f!==null?f.sibling:null);Jn(ms,ms.current&1);break;case 19:if(k=(w&m.childLanes)!==0,(f.flags&128)!==0){if(k)return UX(f,m,w);m.flags|=128}if(T=m.memoizedState,T!==null&&(T.rendering=null,T.tail=null,T.lastEffect=null),Jn(ms,ms.current),k)break;return null;case 22:case 23:return m.lanes=0,OX(f,m,w)}return cf(f,m,w)}var jX,F3,$X,qX;jX=function(f,m){for(var w=m.child;w!==null;){if(w.tag===5||w.tag===6)f.appendChild(w.stateNode);else if(w.tag!==4&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===m)break;for(;w.sibling===null;){if(w.return===null||w.return===m)return;w=w.return}w.sibling.return=w.return,w=w.sibling}},F3=function(){},$X=function(f,m,w,k){var T=f.memoizedProps;if(T!==k){f=m.stateNode,F_(Au.current);var O=null;switch(w){case"input":T=to(f,T),k=to(f,k),O=[];break;case"select":T=Re({},T,{value:void 0}),k=Re({},k,{value:void 0}),O=[];break;case"textarea":T=Su(f,T),k=Su(f,k),O=[];break;default:typeof T.onClick!="function"&&typeof k.onClick=="function"&&(f.onclick=GD)}Dc(w,k);var $;w=null;for(Te in T)if(!k.hasOwnProperty(Te)&&T.hasOwnProperty(Te)&&T[Te]!=null)if(Te==="style"){var ne=T[Te];for($ in ne)ne.hasOwnProperty($)&&(w||(w={}),w[$]="")}else Te!=="dangerouslySetInnerHTML"&&Te!=="children"&&Te!=="suppressContentEditableWarning"&&Te!=="suppressHydrationWarning"&&Te!=="autoFocus"&&(n.hasOwnProperty(Te)?O||(O=[]):(O=O||[]).push(Te,null));for(Te in k){var ae=k[Te];if(ne=T!=null?T[Te]:void 0,k.hasOwnProperty(Te)&&ae!==ne&&(ae!=null||ne!=null))if(Te==="style")if(ne){for($ in ne)!ne.hasOwnProperty($)||ae&&ae.hasOwnProperty($)||(w||(w={}),w[$]="");for($ in ae)ae.hasOwnProperty($)&&ne[$]!==ae[$]&&(w||(w={}),w[$]=ae[$])}else w||(O||(O=[]),O.push(Te,w)),w=ae;else Te==="dangerouslySetInnerHTML"?(ae=ae?ae.__html:void 0,ne=ne?ne.__html:void 0,ae!=null&&ne!==ae&&(O=O||[]).push(Te,ae)):Te==="children"?typeof ae!="string"&&typeof ae!="number"||(O=O||[]).push(Te,""+ae):Te!=="suppressContentEditableWarning"&&Te!=="suppressHydrationWarning"&&(n.hasOwnProperty(Te)?(ae!=null&&Te==="onScroll"&&rs("scroll",f),O||ne===ae||(O=[])):(O=O||[]).push(Te,ae))}w&&(O=O||[]).push("style",w);var Te=O;(m.updateQueue=Te)&&(m.flags|=4)}},qX=function(f,m,w,k){w!==k&&(m.flags|=4)};function rx(f,m){if(!us)switch(f.tailMode){case"hidden":m=f.tail;for(var w=null;m!==null;)m.alternate!==null&&(w=m),m=m.sibling;w===null?f.tail=null:w.sibling=null;break;case"collapsed":w=f.tail;for(var k=null;w!==null;)w.alternate!==null&&(k=w),w=w.sibling;k===null?m||f.tail===null?f.tail=null:f.tail.sibling=null:k.sibling=null}}function Vo(f){var m=f.alternate!==null&&f.alternate.child===f.child,w=0,k=0;if(m)for(var T=f.child;T!==null;)w|=T.lanes|T.childLanes,k|=T.subtreeFlags&14680064,k|=T.flags&14680064,T.return=f,T=T.sibling;else for(T=f.child;T!==null;)w|=T.lanes|T.childLanes,k|=T.subtreeFlags,k|=T.flags,T.return=f,T=T.sibling;return f.subtreeFlags|=k,f.childLanes=w,m}function Ewe(f,m,w){var k=m.pendingProps;switch(r3(m),m.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vo(m),null;case 1:return Ja(m.type)&&YD(),Vo(m),null;case 3:return k=m.stateNode,P0(),os(Za),os(Oo),b3(),k.pendingContext&&(k.context=k.pendingContext,k.pendingContext=null),(f===null||f.child===null)&&(tT(m)?m.flags|=4:f===null||f.memoizedState.isDehydrated&&(m.flags&256)===0||(m.flags|=1024,Ld!==null&&(G3(Ld),Ld=null))),F3(f,m),Vo(m),null;case 5:m3(m);var T=F_(ex.current);if(w=m.type,f!==null&&m.stateNode!=null)$X(f,m,w,k,T),f.ref!==m.ref&&(m.flags|=512,m.flags|=2097152);else{if(!k){if(m.stateNode===null)throw Error(t(166));return Vo(m),null}if(f=F_(Au.current),tT(m)){k=m.stateNode,w=m.type;var O=m.memoizedProps;switch(k[Ru]=m,k[QS]=O,f=(m.mode&1)!==0,w){case"dialog":rs("cancel",k),rs("close",k);break;case"iframe":case"object":case"embed":rs("load",k);break;case"video":case"audio":for(T=0;T<qS.length;T++)rs(qS[T],k);break;case"source":rs("error",k);break;case"img":case"image":case"link":rs("error",k),rs("load",k);break;case"details":rs("toggle",k);break;case"input":Ec(k,O),rs("invalid",k);break;case"select":k._wrapperState={wasMultiple:!!O.multiple},rs("invalid",k);break;case"textarea":zl(k,O),rs("invalid",k)}Dc(w,O),T=null;for(var $ in O)if(O.hasOwnProperty($)){var ne=O[$];$==="children"?typeof ne=="string"?k.textContent!==ne&&(O.suppressHydrationWarning!==!0&&KD(k.textContent,ne,f),T=["children",ne]):typeof ne=="number"&&k.textContent!==""+ne&&(O.suppressHydrationWarning!==!0&&KD(k.textContent,ne,f),T=["children",""+ne]):n.hasOwnProperty($)&&ne!=null&&$==="onScroll"&&rs("scroll",k)}switch(w){case"input":eo(k),bd(k,O,!0);break;case"textarea":eo(k),Po(k);break;case"select":case"option":break;default:typeof O.onClick=="function"&&(k.onclick=GD)}k=T,m.updateQueue=k,k!==null&&(m.flags|=4)}else{$=T.nodeType===9?T:T.ownerDocument,f==="http://www.w3.org/1999/xhtml"&&(f=On(w)),f==="http://www.w3.org/1999/xhtml"?w==="script"?(f=$.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild)):typeof k.is=="string"?f=$.createElement(w,{is:k.is}):(f=$.createElement(w),w==="select"&&($=f,k.multiple?$.multiple=!0:k.size&&($.size=k.size))):f=$.createElementNS(f,w),f[Ru]=m,f[QS]=k,jX(f,m,!1,!1),m.stateNode=f;e:{switch($=no(w,k),w){case"dialog":rs("cancel",f),rs("close",f),T=k;break;case"iframe":case"object":case"embed":rs("load",f),T=k;break;case"video":case"audio":for(T=0;T<qS.length;T++)rs(qS[T],f);T=k;break;case"source":rs("error",f),T=k;break;case"img":case"image":case"link":rs("error",f),rs("load",f),T=k;break;case"details":rs("toggle",f),T=k;break;case"input":Ec(f,k),T=to(f,k),rs("invalid",f);break;case"option":T=k;break;case"select":f._wrapperState={wasMultiple:!!k.multiple},T=Re({},k,{value:void 0}),rs("invalid",f);break;case"textarea":zl(f,k),T=Su(f,k),rs("invalid",f);break;default:T=k}Dc(w,T),ne=T;for(O in ne)if(ne.hasOwnProperty(O)){var ae=ne[O];O==="style"?qn(f,ae):O==="dangerouslySetInnerHTML"?(ae=ae?ae.__html:void 0,ae!=null&&Ul(f,ae)):O==="children"?typeof ae=="string"?(w!=="textarea"||ae!=="")&&Ar(f,ae):typeof ae=="number"&&Ar(f,""+ae):O!=="suppressContentEditableWarning"&&O!=="suppressHydrationWarning"&&O!=="autoFocus"&&(n.hasOwnProperty(O)?ae!=null&&O==="onScroll"&&rs("scroll",f):ae!=null&&x(f,O,ae,$))}switch(w){case"input":eo(f),bd(f,k,!1);break;case"textarea":eo(f),Po(f);break;case"option":k.value!=null&&f.setAttribute("value",""+ai(k.value));break;case"select":f.multiple=!!k.multiple,O=k.value,O!=null?ja(f,!!k.multiple,O,!1):k.defaultValue!=null&&ja(f,!!k.multiple,k.defaultValue,!0);break;default:typeof T.onClick=="function"&&(f.onclick=GD)}switch(w){case"button":case"input":case"select":case"textarea":k=!!k.autoFocus;break e;case"img":k=!0;break e;default:k=!1}}k&&(m.flags|=4)}m.ref!==null&&(m.flags|=512,m.flags|=2097152)}return Vo(m),null;case 6:if(f&&m.stateNode!=null)qX(f,m,f.memoizedProps,k);else{if(typeof k!="string"&&m.stateNode===null)throw Error(t(166));if(w=F_(ex.current),F_(Au.current),tT(m)){if(k=m.stateNode,w=m.memoizedProps,k[Ru]=m,(O=k.nodeValue!==w)&&(f=Ql,f!==null))switch(f.tag){case 3:KD(k.nodeValue,w,(f.mode&1)!==0);break;case 5:f.memoizedProps.suppressHydrationWarning!==!0&&KD(k.nodeValue,w,(f.mode&1)!==0)}O&&(m.flags|=4)}else k=(w.nodeType===9?w:w.ownerDocument).createTextNode(k),k[Ru]=m,m.stateNode=k}return Vo(m),null;case 13:if(os(ms),k=m.memoizedState,f===null||f.memoizedState!==null&&f.memoizedState.dehydrated!==null){if(us&&Yl!==null&&(m.mode&1)!==0&&(m.flags&128)===0)QY(),T0(),m.flags|=98560,O=!1;else if(O=tT(m),k!==null&&k.dehydrated!==null){if(f===null){if(!O)throw Error(t(318));if(O=m.memoizedState,O=O!==null?O.dehydrated:null,!O)throw Error(t(317));O[Ru]=m}else T0(),(m.flags&128)===0&&(m.memoizedState=null),m.flags|=4;Vo(m),O=!1}else Ld!==null&&(G3(Ld),Ld=null),O=!0;if(!O)return m.flags&65536?m:null}return(m.flags&128)!==0?(m.lanes=w,m):(k=k!==null,k!==(f!==null&&f.memoizedState!==null)&&k&&(m.child.flags|=8192,(m.mode&1)!==0&&(f===null||(ms.current&1)!==0?Cr===0&&(Cr=3):X3())),m.updateQueue!==null&&(m.flags|=4),Vo(m),null);case 4:return P0(),F3(f,m),f===null&&KS(m.stateNode.containerInfo),Vo(m),null;case 10:return u3(m.type._context),Vo(m),null;case 17:return Ja(m.type)&&YD(),Vo(m),null;case 19:if(os(ms),O=m.memoizedState,O===null)return Vo(m),null;if(k=(m.flags&128)!==0,$=O.rendering,$===null)if(k)rx(O,!1);else{if(Cr!==0||f!==null&&(f.flags&128)!==0)for(f=m.child;f!==null;){if($=aT(f),$!==null){for(m.flags|=128,rx(O,!1),k=$.updateQueue,k!==null&&(m.updateQueue=k,m.flags|=4),m.subtreeFlags=0,k=w,w=m.child;w!==null;)O=w,f=k,O.flags&=14680066,$=O.alternate,$===null?(O.childLanes=0,O.lanes=f,O.child=null,O.subtreeFlags=0,O.memoizedProps=null,O.memoizedState=null,O.updateQueue=null,O.dependencies=null,O.stateNode=null):(O.childLanes=$.childLanes,O.lanes=$.lanes,O.child=$.child,O.subtreeFlags=0,O.deletions=null,O.memoizedProps=$.memoizedProps,O.memoizedState=$.memoizedState,O.updateQueue=$.updateQueue,O.type=$.type,f=$.dependencies,O.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext}),w=w.sibling;return Jn(ms,ms.current&1|2),m.child}f=f.sibling}O.tail!==null&&mi()>V0&&(m.flags|=128,k=!0,rx(O,!1),m.lanes=4194304)}else{if(!k)if(f=aT($),f!==null){if(m.flags|=128,k=!0,w=f.updateQueue,w!==null&&(m.updateQueue=w,m.flags|=4),rx(O,!0),O.tail===null&&O.tailMode==="hidden"&&!$.alternate&&!us)return Vo(m),null}else 2*mi()-O.renderingStartTime>V0&&w!==1073741824&&(m.flags|=128,k=!0,rx(O,!1),m.lanes=4194304);O.isBackwards?($.sibling=m.child,m.child=$):(w=O.last,w!==null?w.sibling=$:m.child=$,O.last=$)}return O.tail!==null?(m=O.tail,O.rendering=m,O.tail=m.sibling,O.renderingStartTime=mi(),m.sibling=null,w=ms.current,Jn(ms,k?w&1|2:w&1),m):(Vo(m),null);case 22:case 23:return Y3(),k=m.memoizedState!==null,f!==null&&f.memoizedState!==null!==k&&(m.flags|=8192),k&&(m.mode&1)!==0?(Xl&1073741824)!==0&&(Vo(m),m.subtreeFlags&6&&(m.flags|=8192)):Vo(m),null;case 24:return null;case 25:return null}throw Error(t(156,m.tag))}function Dwe(f,m){switch(r3(m),m.tag){case 1:return Ja(m.type)&&YD(),f=m.flags,f&65536?(m.flags=f&-65537|128,m):null;case 3:return P0(),os(Za),os(Oo),b3(),f=m.flags,(f&65536)!==0&&(f&128)===0?(m.flags=f&-65537|128,m):null;case 5:return m3(m),null;case 13:if(os(ms),f=m.memoizedState,f!==null&&f.dehydrated!==null){if(m.alternate===null)throw Error(t(340));T0()}return f=m.flags,f&65536?(m.flags=f&-65537|128,m):null;case 19:return os(ms),null;case 4:return P0(),null;case 10:return u3(m.type._context),null;case 22:case 23:return Y3(),null;case 24:return null;default:return null}}var mT=!1,Bo=!1,Twe=typeof WeakSet=="function"?WeakSet:Set,yt=null;function O0(f,m){var w=f.ref;if(w!==null)if(typeof w=="function")try{w(null)}catch(k){Ts(f,m,k)}else w.current=null}function V3(f,m,w){try{w()}catch(k){Ts(f,m,k)}}var KX=!1;function Nwe(f,m){if(Y5=Qg,f=LY(),z5(f)){if("selectionStart"in f)var w={start:f.selectionStart,end:f.selectionEnd};else e:{w=(w=f.ownerDocument)&&w.defaultView||window;var k=w.getSelection&&w.getSelection();if(k&&k.rangeCount!==0){w=k.anchorNode;var T=k.anchorOffset,O=k.focusNode;k=k.focusOffset;try{w.nodeType,O.nodeType}catch{w=null;break e}var $=0,ne=-1,ae=-1,Te=0,$e=0,Qe=f,je=null;t:for(;;){for(var mt;Qe!==w||T!==0&&Qe.nodeType!==3||(ne=$+T),Qe!==O||k!==0&&Qe.nodeType!==3||(ae=$+k),Qe.nodeType===3&&($+=Qe.nodeValue.length),(mt=Qe.firstChild)!==null;)je=Qe,Qe=mt;for(;;){if(Qe===f)break t;if(je===w&&++Te===T&&(ne=$),je===O&&++$e===k&&(ae=$),(mt=Qe.nextSibling)!==null)break;Qe=je,je=Qe.parentNode}Qe=mt}w=ne===-1||ae===-1?null:{start:ne,end:ae}}else w=null}w=w||{start:0,end:0}}else w=null;for(X5={focusedElem:f,selectionRange:w},Qg=!1,yt=m;yt!==null;)if(m=yt,f=m.child,(m.subtreeFlags&1028)!==0&&f!==null)f.return=m,yt=f;else for(;yt!==null;){m=yt;try{var Lt=m.alternate;if((m.flags&1024)!==0)switch(m.tag){case 0:case 11:case 15:break;case 1:if(Lt!==null){var Et=Lt.memoizedProps,Us=Lt.memoizedState,Ce=m.stateNode,ue=Ce.getSnapshotBeforeUpdate(m.elementType===m.type?Et:kd(m.type,Et),Us);Ce.__reactInternalSnapshotBeforeUpdate=ue}break;case 3:var Se=m.stateNode.containerInfo;Se.nodeType===1?Se.textContent="":Se.nodeType===9&&Se.documentElement&&Se.removeChild(Se.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(it){Ts(m,m.return,it)}if(f=m.sibling,f!==null){f.return=m.return,yt=f;break}yt=m.return}return Lt=KX,KX=!1,Lt}function ox(f,m,w){var k=m.updateQueue;if(k=k!==null?k.lastEffect:null,k!==null){var T=k=k.next;do{if((T.tag&f)===f){var O=T.destroy;T.destroy=void 0,O!==void 0&&V3(m,w,O)}T=T.next}while(T!==k)}}function _T(f,m){if(m=m.updateQueue,m=m!==null?m.lastEffect:null,m!==null){var w=m=m.next;do{if((w.tag&f)===f){var k=w.create;w.destroy=k()}w=w.next}while(w!==m)}}function B3(f){var m=f.ref;if(m!==null){var w=f.stateNode;switch(f.tag){case 5:f=w;break;default:f=w}typeof m=="function"?m(f):m.current=f}}function GX(f){var m=f.alternate;m!==null&&(f.alternate=null,GX(m)),f.child=null,f.deletions=null,f.sibling=null,f.tag===5&&(m=f.stateNode,m!==null&&(delete m[Ru],delete m[QS],delete m[t3],delete m[fwe],delete m[gwe])),f.stateNode=null,f.return=null,f.dependencies=null,f.memoizedProps=null,f.memoizedState=null,f.pendingProps=null,f.stateNode=null,f.updateQueue=null}function QX(f){return f.tag===5||f.tag===3||f.tag===4}function YX(f){e:for(;;){for(;f.sibling===null;){if(f.return===null||QX(f.return))return null;f=f.return}for(f.sibling.return=f.return,f=f.sibling;f.tag!==5&&f.tag!==6&&f.tag!==18;){if(f.flags&2||f.child===null||f.tag===4)continue e;f.child.return=f,f=f.child}if(!(f.flags&2))return f.stateNode}}function W3(f,m,w){var k=f.tag;if(k===5||k===6)f=f.stateNode,m?w.nodeType===8?w.parentNode.insertBefore(f,m):w.insertBefore(f,m):(w.nodeType===8?(m=w.parentNode,m.insertBefore(f,w)):(m=w,m.appendChild(f)),w=w._reactRootContainer,w!=null||m.onclick!==null||(m.onclick=GD));else if(k!==4&&(f=f.child,f!==null))for(W3(f,m,w),f=f.sibling;f!==null;)W3(f,m,w),f=f.sibling}function H3(f,m,w){var k=f.tag;if(k===5||k===6)f=f.stateNode,m?w.insertBefore(f,m):w.appendChild(f);else if(k!==4&&(f=f.child,f!==null))for(H3(f,m,w),f=f.sibling;f!==null;)H3(f,m,w),f=f.sibling}var oo=null,Id=!1;function sp(f,m,w){for(w=w.child;w!==null;)XX(f,m,w),w=w.sibling}function XX(f,m,w){if($l&&typeof $l.onCommitFiberUnmount=="function")try{$l.onCommitFiberUnmount(L_,w)}catch{}switch(w.tag){case 5:Bo||O0(w,m);case 6:var k=oo,T=Id;oo=null,sp(f,m,w),oo=k,Id=T,oo!==null&&(Id?(f=oo,w=w.stateNode,f.nodeType===8?f.parentNode.removeChild(w):f.removeChild(w)):oo.removeChild(w.stateNode));break;case 18:oo!==null&&(Id?(f=oo,w=w.stateNode,f.nodeType===8?e3(f.parentNode,w):f.nodeType===1&&e3(f,w),yd(f)):e3(oo,w.stateNode));break;case 4:k=oo,T=Id,oo=w.stateNode.containerInfo,Id=!0,sp(f,m,w),oo=k,Id=T;break;case 0:case 11:case 14:case 15:if(!Bo&&(k=w.updateQueue,k!==null&&(k=k.lastEffect,k!==null))){T=k=k.next;do{var O=T,$=O.destroy;O=O.tag,$!==void 0&&((O&2)!==0||(O&4)!==0)&&V3(w,m,$),T=T.next}while(T!==k)}sp(f,m,w);break;case 1:if(!Bo&&(O0(w,m),k=w.stateNode,typeof k.componentWillUnmount=="function"))try{k.props=w.memoizedProps,k.state=w.memoizedState,k.componentWillUnmount()}catch(ne){Ts(w,m,ne)}sp(f,m,w);break;case 21:sp(f,m,w);break;case 22:w.mode&1?(Bo=(k=Bo)||w.memoizedState!==null,sp(f,m,w),Bo=k):sp(f,m,w);break;default:sp(f,m,w)}}function ZX(f){var m=f.updateQueue;if(m!==null){f.updateQueue=null;var w=f.stateNode;w===null&&(w=f.stateNode=new Twe),m.forEach(function(k){var T=Wwe.bind(null,f,k);w.has(k)||(w.add(k),k.then(T,T))})}}function Ed(f,m){var w=m.deletions;if(w!==null)for(var k=0;k<w.length;k++){var T=w[k];try{var O=f,$=m,ne=$;e:for(;ne!==null;){switch(ne.tag){case 5:oo=ne.stateNode,Id=!1;break e;case 3:oo=ne.stateNode.containerInfo,Id=!0;break e;case 4:oo=ne.stateNode.containerInfo,Id=!0;break e}ne=ne.return}if(oo===null)throw Error(t(160));XX(O,$,T),oo=null,Id=!1;var ae=T.alternate;ae!==null&&(ae.return=null),T.return=null}catch(Te){Ts(T,m,Te)}}if(m.subtreeFlags&12854)for(m=m.child;m!==null;)JX(m,f),m=m.sibling}function JX(f,m){var w=f.alternate,k=f.flags;switch(f.tag){case 0:case 11:case 14:case 15:if(Ed(m,f),Mu(f),k&4){try{ox(3,f,f.return),_T(3,f)}catch(Et){Ts(f,f.return,Et)}try{ox(5,f,f.return)}catch(Et){Ts(f,f.return,Et)}}break;case 1:Ed(m,f),Mu(f),k&512&&w!==null&&O0(w,w.return);break;case 5:if(Ed(m,f),Mu(f),k&512&&w!==null&&O0(w,w.return),f.flags&32){var T=f.stateNode;try{Ar(T,"")}catch(Et){Ts(f,f.return,Et)}}if(k&4&&(T=f.stateNode,T!=null)){var O=f.memoizedProps,$=w!==null?w.memoizedProps:O,ne=f.type,ae=f.updateQueue;if(f.updateQueue=null,ae!==null)try{ne==="input"&&O.type==="radio"&&O.name!=null&&_d(T,O),no(ne,$);var Te=no(ne,O);for($=0;$<ae.length;$+=2){var $e=ae[$],Qe=ae[$+1];$e==="style"?qn(T,Qe):$e==="dangerouslySetInnerHTML"?Ul(T,Qe):$e==="children"?Ar(T,Qe):x(T,$e,Qe,Te)}switch(ne){case"input":Ua(T,O);break;case"textarea":$a(T,O);break;case"select":var je=T._wrapperState.wasMultiple;T._wrapperState.wasMultiple=!!O.multiple;var mt=O.value;mt!=null?ja(T,!!O.multiple,mt,!1):je!==!!O.multiple&&(O.defaultValue!=null?ja(T,!!O.multiple,O.defaultValue,!0):ja(T,!!O.multiple,O.multiple?[]:"",!1))}T[QS]=O}catch(Et){Ts(f,f.return,Et)}}break;case 6:if(Ed(m,f),Mu(f),k&4){if(f.stateNode===null)throw Error(t(162));T=f.stateNode,O=f.memoizedProps;try{T.nodeValue=O}catch(Et){Ts(f,f.return,Et)}}break;case 3:if(Ed(m,f),Mu(f),k&4&&w!==null&&w.memoizedState.isDehydrated)try{yd(m.containerInfo)}catch(Et){Ts(f,f.return,Et)}break;case 4:Ed(m,f),Mu(f);break;case 13:Ed(m,f),Mu(f),T=f.child,T.flags&8192&&(O=T.memoizedState!==null,T.stateNode.isHidden=O,!O||T.alternate!==null&&T.alternate.memoizedState!==null||(j3=mi())),k&4&&ZX(f);break;case 22:if($e=w!==null&&w.memoizedState!==null,f.mode&1?(Bo=(Te=Bo)||$e,Ed(m,f),Bo=Te):Ed(m,f),Mu(f),k&8192){if(Te=f.memoizedState!==null,(f.stateNode.isHidden=Te)&&!$e&&(f.mode&1)!==0)for(yt=f,$e=f.child;$e!==null;){for(Qe=yt=$e;yt!==null;){switch(je=yt,mt=je.child,je.tag){case 0:case 11:case 14:case 15:ox(4,je,je.return);break;case 1:O0(je,je.return);var Lt=je.stateNode;if(typeof Lt.componentWillUnmount=="function"){k=je,w=je.return;try{m=k,Lt.props=m.memoizedProps,Lt.state=m.memoizedState,Lt.componentWillUnmount()}catch(Et){Ts(k,w,Et)}}break;case 5:O0(je,je.return);break;case 22:if(je.memoizedState!==null){iZ(Qe);continue}}mt!==null?(mt.return=je,yt=mt):iZ(Qe)}$e=$e.sibling}e:for($e=null,Qe=f;;){if(Qe.tag===5){if($e===null){$e=Qe;try{T=Qe.stateNode,Te?(O=T.style,typeof O.setProperty=="function"?O.setProperty("display","none","important"):O.display="none"):(ne=Qe.stateNode,ae=Qe.memoizedProps.style,$=ae!=null&&ae.hasOwnProperty("display")?ae.display:null,ne.style.display=da("display",$))}catch(Et){Ts(f,f.return,Et)}}}else if(Qe.tag===6){if($e===null)try{Qe.stateNode.nodeValue=Te?"":Qe.memoizedProps}catch(Et){Ts(f,f.return,Et)}}else if((Qe.tag!==22&&Qe.tag!==23||Qe.memoizedState===null||Qe===f)&&Qe.child!==null){Qe.child.return=Qe,Qe=Qe.child;continue}if(Qe===f)break e;for(;Qe.sibling===null;){if(Qe.return===null||Qe.return===f)break e;$e===Qe&&($e=null),Qe=Qe.return}$e===Qe&&($e=null),Qe.sibling.return=Qe.return,Qe=Qe.sibling}}break;case 19:Ed(m,f),Mu(f),k&4&&ZX(f);break;case 21:break;default:Ed(m,f),Mu(f)}}function Mu(f){var m=f.flags;if(m&2){try{e:{for(var w=f.return;w!==null;){if(QX(w)){var k=w;break e}w=w.return}throw Error(t(160))}switch(k.tag){case 5:var T=k.stateNode;k.flags&32&&(Ar(T,""),k.flags&=-33);var O=YX(f);H3(f,O,T);break;case 3:case 4:var $=k.stateNode.containerInfo,ne=YX(f);W3(f,ne,$);break;default:throw Error(t(161))}}catch(ae){Ts(f,f.return,ae)}f.flags&=-3}m&4096&&(f.flags&=-4097)}function Rwe(f,m,w){yt=f,eZ(f)}function eZ(f,m,w){for(var k=(f.mode&1)!==0;yt!==null;){var T=yt,O=T.child;if(T.tag===22&&k){var $=T.memoizedState!==null||mT;if(!$){var ne=T.alternate,ae=ne!==null&&ne.memoizedState!==null||Bo;ne=mT;var Te=Bo;if(mT=$,(Bo=ae)&&!Te)for(yt=T;yt!==null;)$=yt,ae=$.child,$.tag===22&&$.memoizedState!==null?nZ(T):ae!==null?(ae.return=$,yt=ae):nZ(T);for(;O!==null;)yt=O,eZ(O),O=O.sibling;yt=T,mT=ne,Bo=Te}tZ(f)}else(T.subtreeFlags&8772)!==0&&O!==null?(O.return=T,yt=O):tZ(f)}}function tZ(f){for(;yt!==null;){var m=yt;if((m.flags&8772)!==0){var w=m.alternate;try{if((m.flags&8772)!==0)switch(m.tag){case 0:case 11:case 15:Bo||_T(5,m);break;case 1:var k=m.stateNode;if(m.flags&4&&!Bo)if(w===null)k.componentDidMount();else{var T=m.elementType===m.type?w.memoizedProps:kd(m.type,w.memoizedProps);k.componentDidUpdate(T,w.memoizedState,k.__reactInternalSnapshotBeforeUpdate)}var O=m.updateQueue;O!==null&&iX(m,O,k);break;case 3:var $=m.updateQueue;if($!==null){if(w=null,m.child!==null)switch(m.child.tag){case 5:w=m.child.stateNode;break;case 1:w=m.child.stateNode}iX(m,$,w)}break;case 5:var ne=m.stateNode;if(w===null&&m.flags&4){w=ne;var ae=m.memoizedProps;switch(m.type){case"button":case"input":case"select":case"textarea":ae.autoFocus&&w.focus();break;case"img":ae.src&&(w.src=ae.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(m.memoizedState===null){var Te=m.alternate;if(Te!==null){var $e=Te.memoizedState;if($e!==null){var Qe=$e.dehydrated;Qe!==null&&yd(Qe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Bo||m.flags&512&&B3(m)}catch(je){Ts(m,m.return,je)}}if(m===f){yt=null;break}if(w=m.sibling,w!==null){w.return=m.return,yt=w;break}yt=m.return}}function iZ(f){for(;yt!==null;){var m=yt;if(m===f){yt=null;break}var w=m.sibling;if(w!==null){w.return=m.return,yt=w;break}yt=m.return}}function nZ(f){for(;yt!==null;){var m=yt;try{switch(m.tag){case 0:case 11:case 15:var w=m.return;try{_T(4,m)}catch(ae){Ts(m,w,ae)}break;case 1:var k=m.stateNode;if(typeof k.componentDidMount=="function"){var T=m.return;try{k.componentDidMount()}catch(ae){Ts(m,T,ae)}}var O=m.return;try{B3(m)}catch(ae){Ts(m,O,ae)}break;case 5:var $=m.return;try{B3(m)}catch(ae){Ts(m,$,ae)}}}catch(ae){Ts(m,m.return,ae)}if(m===f){yt=null;break}var ne=m.sibling;if(ne!==null){ne.return=m.return,yt=ne;break}yt=m.return}}var Awe=Math.ceil,bT=L.ReactCurrentDispatcher,z3=L.ReactCurrentOwner,Oc=L.ReactCurrentBatchConfig,an=0,Vr=null,tr=null,ao=0,Xl=0,F0=Jg(0),Cr=0,ax=null,B_=0,vT=0,U3=0,lx=null,tl=null,j3=0,V0=1/0,df=null,wT=!1,$3=null,rp=null,CT=!1,op=null,yT=0,cx=0,q3=null,ST=-1,xT=0;function pa(){return(an&6)!==0?mi():ST!==-1?ST:ST=mi()}function ap(f){return(f.mode&1)===0?1:(an&2)!==0&&ao!==0?ao&-ao:mwe.transition!==null?(xT===0&&(xT=I_()),xT):(f=zi,f!==0||(f=window.event,f=f===void 0?16:FS(f.type)),f)}function Dd(f,m,w,k){if(50<cx)throw cx=0,q3=null,Error(t(185));$g(f,w,k),((an&2)===0||f!==Vr)&&(f===Vr&&((an&2)===0&&(vT|=w),Cr===4&&lp(f,ao)),il(f,k),w===1&&an===0&&(m.mode&1)===0&&(V0=mi()+500,ZD&&tp()))}function il(f,m){var w=f.callbackNode;Xh(f,m);var k=k_(f,f===Vr?ao:0);if(k===0)w!==null&&pt(w),f.callbackNode=null,f.callbackPriority=0;else if(m=k&-k,f.callbackPriority!==m){if(w!=null&&pt(w),m===1)f.tag===0?pwe(rZ.bind(null,f)):jY(rZ.bind(null,f)),uwe(function(){(an&6)===0&&tp()}),w=null;else{switch(Kg(k)){case 1:w=Mr;break;case 4:w=Qa;break;case 16:w=Fn;break;case 536870912:w=x_;break;default:w=Fn}w=fZ(w,sZ.bind(null,f))}f.callbackPriority=m,f.callbackNode=w}}function sZ(f,m){if(ST=-1,xT=0,(an&6)!==0)throw Error(t(327));var w=f.callbackNode;if(B0()&&f.callbackNode!==w)return null;var k=k_(f,f===Vr?ao:0);if(k===0)return null;if((k&30)!==0||(k&f.expiredLanes)!==0||m)m=LT(f,k);else{m=k;var T=an;an|=2;var O=aZ();(Vr!==f||ao!==m)&&(df=null,V0=mi()+500,H_(f,m));do try{Owe();break}catch(ne){oZ(f,ne)}while(!0);d3(),bT.current=O,an=T,tr!==null?m=0:(Vr=null,ao=0,m=Cr)}if(m!==0){if(m===2&&(T=ql(f),T!==0&&(k=T,m=K3(f,T))),m===1)throw w=ax,H_(f,0),lp(f,k),il(f,mi()),w;if(m===6)lp(f,k);else{if(T=f.current.alternate,(k&30)===0&&!Pwe(T)&&(m=LT(f,k),m===2&&(O=ql(f),O!==0&&(k=O,m=K3(f,O))),m===1))throw w=ax,H_(f,0),lp(f,k),il(f,mi()),w;switch(f.finishedWork=T,f.finishedLanes=k,m){case 0:case 1:throw Error(t(345));case 2:z_(f,tl,df);break;case 3:if(lp(f,k),(k&130023424)===k&&(m=j3+500-mi(),10<m)){if(k_(f,0)!==0)break;if(T=f.suspendedLanes,(T&k)!==k){pa(),f.pingedLanes|=f.suspendedLanes&T;break}f.timeoutHandle=J5(z_.bind(null,f,tl,df),m);break}z_(f,tl,df);break;case 4:if(lp(f,k),(k&4194240)===k)break;for(m=f.eventTimes,T=-1;0<k;){var $=31-ha(k);O=1<<$,$=m[$],$>T&&(T=$),k&=~O}if(k=T,k=mi()-k,k=(120>k?120:480>k?480:1080>k?1080:1920>k?1920:3e3>k?3e3:4320>k?4320:1960*Awe(k/1960))-k,10<k){f.timeoutHandle=J5(z_.bind(null,f,tl,df),k);break}z_(f,tl,df);break;case 5:z_(f,tl,df);break;default:throw Error(t(329))}}}return il(f,mi()),f.callbackNode===w?sZ.bind(null,f):null}function K3(f,m){var w=lx;return f.current.memoizedState.isDehydrated&&(H_(f,m).flags|=256),f=LT(f,m),f!==2&&(m=tl,tl=w,m!==null&&G3(m)),f}function G3(f){tl===null?tl=f:tl.push.apply(tl,f)}function Pwe(f){for(var m=f;;){if(m.flags&16384){var w=m.updateQueue;if(w!==null&&(w=w.stores,w!==null))for(var k=0;k<w.length;k++){var T=w[k],O=T.getSnapshot;T=T.value;try{if(!xd(O(),T))return!1}catch{return!1}}}if(w=m.child,m.subtreeFlags&16384&&w!==null)w.return=m,m=w;else{if(m===f)break;for(;m.sibling===null;){if(m.return===null||m.return===f)return!0;m=m.return}m.sibling.return=m.return,m=m.sibling}}return!0}function lp(f,m){for(m&=~U3,m&=~vT,f.suspendedLanes|=m,f.pingedLanes&=~m,f=f.expirationTimes;0<m;){var w=31-ha(m),k=1<<w;f[w]=-1,m&=~k}}function rZ(f){if((an&6)!==0)throw Error(t(327));B0();var m=k_(f,0);if((m&1)===0)return il(f,mi()),null;var w=LT(f,m);if(f.tag!==0&&w===2){var k=ql(f);k!==0&&(m=k,w=K3(f,k))}if(w===1)throw w=ax,H_(f,0),lp(f,m),il(f,mi()),w;if(w===6)throw Error(t(345));return f.finishedWork=f.current.alternate,f.finishedLanes=m,z_(f,tl,df),il(f,mi()),null}function Q3(f,m){var w=an;an|=1;try{return f(m)}finally{an=w,an===0&&(V0=mi()+500,ZD&&tp())}}function W_(f){op!==null&&op.tag===0&&(an&6)===0&&B0();var m=an;an|=1;var w=Oc.transition,k=zi;try{if(Oc.transition=null,zi=1,f)return f()}finally{zi=k,Oc.transition=w,an=m,(an&6)===0&&tp()}}function Y3(){Xl=F0.current,os(F0)}function H_(f,m){f.finishedWork=null,f.finishedLanes=0;var w=f.timeoutHandle;if(w!==-1&&(f.timeoutHandle=-1,dwe(w)),tr!==null)for(w=tr.return;w!==null;){var k=w;switch(r3(k),k.tag){case 1:k=k.type.childContextTypes,k!=null&&YD();break;case 3:P0(),os(Za),os(Oo),b3();break;case 5:m3(k);break;case 4:P0();break;case 13:os(ms);break;case 19:os(ms);break;case 10:u3(k.type._context);break;case 22:case 23:Y3()}w=w.return}if(Vr=f,tr=f=cp(f.current,null),ao=Xl=m,Cr=0,ax=null,U3=vT=B_=0,tl=lx=null,O_!==null){for(m=0;m<O_.length;m++)if(w=O_[m],k=w.interleaved,k!==null){w.interleaved=null;var T=k.next,O=w.pending;if(O!==null){var $=O.next;O.next=T,k.next=$}w.pending=k}O_=null}return f}function oZ(f,m){do{var w=tr;try{if(d3(),lT.current=hT,cT){for(var k=_s.memoizedState;k!==null;){var T=k.queue;T!==null&&(T.pending=null),k=k.next}cT=!1}if(V_=0,Fr=wr=_s=null,tx=!1,ix=0,z3.current=null,w===null||w.return===null){Cr=1,ax=m,tr=null;break}e:{var O=f,$=w.return,ne=w,ae=m;if(m=ao,ne.flags|=32768,ae!==null&&typeof ae=="object"&&typeof ae.then=="function"){var Te=ae,$e=ne,Qe=$e.tag;if(($e.mode&1)===0&&(Qe===0||Qe===11||Qe===15)){var je=$e.alternate;je?($e.updateQueue=je.updateQueue,$e.memoizedState=je.memoizedState,$e.lanes=je.lanes):($e.updateQueue=null,$e.memoizedState=null)}var mt=NX($);if(mt!==null){mt.flags&=-257,RX(mt,$,ne,O,m),mt.mode&1&&TX(O,Te,m),m=mt,ae=Te;var Lt=m.updateQueue;if(Lt===null){var Et=new Set;Et.add(ae),m.updateQueue=Et}else Lt.add(ae);break e}else{if((m&1)===0){TX(O,Te,m),X3();break e}ae=Error(t(426))}}else if(us&&ne.mode&1){var Us=NX($);if(Us!==null){(Us.flags&65536)===0&&(Us.flags|=256),RX(Us,$,ne,O,m),l3(M0(ae,ne));break e}}O=ae=M0(ae,ne),Cr!==4&&(Cr=2),lx===null?lx=[O]:lx.push(O),O=$;do{switch(O.tag){case 3:O.flags|=65536,m&=-m,O.lanes|=m;var Ce=EX(O,ae,m);tX(O,Ce);break e;case 1:ne=ae;var ue=O.type,Se=O.stateNode;if((O.flags&128)===0&&(typeof ue.getDerivedStateFromError=="function"||Se!==null&&typeof Se.componentDidCatch=="function"&&(rp===null||!rp.has(Se)))){O.flags|=65536,m&=-m,O.lanes|=m;var it=DX(O,ne,m);tX(O,it);break e}}O=O.return}while(O!==null)}cZ(w)}catch(Pt){m=Pt,tr===w&&w!==null&&(tr=w=w.return);continue}break}while(!0)}function aZ(){var f=bT.current;return bT.current=hT,f===null?hT:f}function X3(){(Cr===0||Cr===3||Cr===2)&&(Cr=4),Vr===null||(B_&268435455)===0&&(vT&268435455)===0||lp(Vr,ao)}function LT(f,m){var w=an;an|=2;var k=aZ();(Vr!==f||ao!==m)&&(df=null,H_(f,m));do try{Mwe();break}catch(T){oZ(f,T)}while(!0);if(d3(),an=w,bT.current=k,tr!==null)throw Error(t(261));return Vr=null,ao=0,Cr}function Mwe(){for(;tr!==null;)lZ(tr)}function Owe(){for(;tr!==null&&!Cn();)lZ(tr)}function lZ(f){var m=hZ(f.alternate,f,Xl);f.memoizedProps=f.pendingProps,m===null?cZ(f):tr=m,z3.current=null}function cZ(f){var m=f;do{var w=m.alternate;if(f=m.return,(m.flags&32768)===0){if(w=Ewe(w,m,Xl),w!==null){tr=w;return}}else{if(w=Dwe(w,m),w!==null){w.flags&=32767,tr=w;return}if(f!==null)f.flags|=32768,f.subtreeFlags=0,f.deletions=null;else{Cr=6,tr=null;return}}if(m=m.sibling,m!==null){tr=m;return}tr=m=f}while(m!==null);Cr===0&&(Cr=5)}function z_(f,m,w){var k=zi,T=Oc.transition;try{Oc.transition=null,zi=1,Fwe(f,m,w,k)}finally{Oc.transition=T,zi=k}return null}function Fwe(f,m,w,k){do B0();while(op!==null);if((an&6)!==0)throw Error(t(327));w=f.finishedWork;var T=f.finishedLanes;if(w===null)return null;if(f.finishedWork=null,f.finishedLanes=0,w===f.current)throw Error(t(177));f.callbackNode=null,f.callbackPriority=0;var O=w.lanes|w.childLanes;if(Kn(f,O),f===Vr&&(tr=Vr=null,ao=0),(w.subtreeFlags&2064)===0&&(w.flags&2064)===0||CT||(CT=!0,fZ(Fn,function(){return B0(),null})),O=(w.flags&15990)!==0,(w.subtreeFlags&15990)!==0||O){O=Oc.transition,Oc.transition=null;var $=zi;zi=1;var ne=an;an|=4,z3.current=null,Nwe(f,w),JX(w,f),nwe(X5),Qg=!!Y5,X5=Y5=null,f.current=w,Rwe(w),Js(),an=ne,zi=$,Oc.transition=O}else f.current=w;if(CT&&(CT=!1,op=f,yT=T),O=f.pendingLanes,O===0&&(rp=null),LD(w.stateNode),il(f,mi()),m!==null)for(k=f.onRecoverableError,w=0;w<m.length;w++)T=m[w],k(T.value,{componentStack:T.stack,digest:T.digest});if(wT)throw wT=!1,f=$3,$3=null,f;return(yT&1)!==0&&f.tag!==0&&B0(),O=f.pendingLanes,(O&1)!==0?f===q3?cx++:(cx=0,q3=f):cx=0,tp(),null}function B0(){if(op!==null){var f=Kg(yT),m=Oc.transition,w=zi;try{if(Oc.transition=null,zi=16>f?16:f,op===null)var k=!1;else{if(f=op,op=null,yT=0,(an&6)!==0)throw Error(t(331));var T=an;for(an|=4,yt=f.current;yt!==null;){var O=yt,$=O.child;if((yt.flags&16)!==0){var ne=O.deletions;if(ne!==null){for(var ae=0;ae<ne.length;ae++){var Te=ne[ae];for(yt=Te;yt!==null;){var $e=yt;switch($e.tag){case 0:case 11:case 15:ox(8,$e,O)}var Qe=$e.child;if(Qe!==null)Qe.return=$e,yt=Qe;else for(;yt!==null;){$e=yt;var je=$e.sibling,mt=$e.return;if(GX($e),$e===Te){yt=null;break}if(je!==null){je.return=mt,yt=je;break}yt=mt}}}var Lt=O.alternate;if(Lt!==null){var Et=Lt.child;if(Et!==null){Lt.child=null;do{var Us=Et.sibling;Et.sibling=null,Et=Us}while(Et!==null)}}yt=O}}if((O.subtreeFlags&2064)!==0&&$!==null)$.return=O,yt=$;else e:for(;yt!==null;){if(O=yt,(O.flags&2048)!==0)switch(O.tag){case 0:case 11:case 15:ox(9,O,O.return)}var Ce=O.sibling;if(Ce!==null){Ce.return=O.return,yt=Ce;break e}yt=O.return}}var ue=f.current;for(yt=ue;yt!==null;){$=yt;var Se=$.child;if(($.subtreeFlags&2064)!==0&&Se!==null)Se.return=$,yt=Se;else e:for($=ue;yt!==null;){if(ne=yt,(ne.flags&2048)!==0)try{switch(ne.tag){case 0:case 11:case 15:_T(9,ne)}}catch(Pt){Ts(ne,ne.return,Pt)}if(ne===$){yt=null;break e}var it=ne.sibling;if(it!==null){it.return=ne.return,yt=it;break e}yt=ne.return}}if(an=T,tp(),$l&&typeof $l.onPostCommitFiberRoot=="function")try{$l.onPostCommitFiberRoot(L_,f)}catch{}k=!0}return k}finally{zi=w,Oc.transition=m}}return!1}function dZ(f,m,w){m=M0(w,m),m=EX(f,m,1),f=np(f,m,1),m=pa(),f!==null&&($g(f,1,m),il(f,m))}function Ts(f,m,w){if(f.tag===3)dZ(f,f,w);else for(;m!==null;){if(m.tag===3){dZ(m,f,w);break}else if(m.tag===1){var k=m.stateNode;if(typeof m.type.getDerivedStateFromError=="function"||typeof k.componentDidCatch=="function"&&(rp===null||!rp.has(k))){f=M0(w,f),f=DX(m,f,1),m=np(m,f,1),f=pa(),m!==null&&($g(m,1,f),il(m,f));break}}m=m.return}}function Vwe(f,m,w){var k=f.pingCache;k!==null&&k.delete(m),m=pa(),f.pingedLanes|=f.suspendedLanes&w,Vr===f&&(ao&w)===w&&(Cr===4||Cr===3&&(ao&130023424)===ao&&500>mi()-j3?H_(f,0):U3|=w),il(f,m)}function uZ(f,m){m===0&&((f.mode&1)===0?m=1:(m=l0,l0<<=1,(l0&130023424)===0&&(l0=4194304)));var w=pa();f=af(f,m),f!==null&&($g(f,m,w),il(f,w))}function Bwe(f){var m=f.memoizedState,w=0;m!==null&&(w=m.retryLane),uZ(f,w)}function Wwe(f,m){var w=0;switch(f.tag){case 13:var k=f.stateNode,T=f.memoizedState;T!==null&&(w=T.retryLane);break;case 19:k=f.stateNode;break;default:throw Error(t(314))}k!==null&&k.delete(m),uZ(f,w)}var hZ;hZ=function(f,m,w){if(f!==null)if(f.memoizedProps!==m.pendingProps||Za.current)el=!0;else{if((f.lanes&w)===0&&(m.flags&128)===0)return el=!1,Iwe(f,m,w);el=(f.flags&131072)!==0}else el=!1,us&&(m.flags&1048576)!==0&&$Y(m,eT,m.index);switch(m.lanes=0,m.tag){case 2:var k=m.type;pT(f,m),f=m.pendingProps;var T=I0(m,Oo.current);A0(m,w),T=C3(null,m,k,f,T,w);var O=y3();return m.flags|=1,typeof T=="object"&&T!==null&&typeof T.render=="function"&&T.$$typeof===void 0?(m.tag=1,m.memoizedState=null,m.updateQueue=null,Ja(k)?(O=!0,XD(m)):O=!1,m.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,g3(m),T.updater=fT,m.stateNode=T,T._reactInternals=m,E3(m,k,f,w),m=R3(null,m,k,!0,O,w)):(m.tag=0,us&&O&&s3(m),ga(null,m,T,w),m=m.child),m;case 16:k=m.elementType;e:{switch(pT(f,m),f=m.pendingProps,T=k._init,k=T(k._payload),m.type=k,T=m.tag=zwe(k),f=kd(k,f),T){case 0:m=N3(null,m,k,f,w);break e;case 1:m=VX(null,m,k,f,w);break e;case 11:m=AX(null,m,k,f,w);break e;case 14:m=PX(null,m,k,kd(k.type,f),w);break e}throw Error(t(306,k,""))}return m;case 0:return k=m.type,T=m.pendingProps,T=m.elementType===k?T:kd(k,T),N3(f,m,k,T,w);case 1:return k=m.type,T=m.pendingProps,T=m.elementType===k?T:kd(k,T),VX(f,m,k,T,w);case 3:e:{if(BX(m),f===null)throw Error(t(387));k=m.pendingProps,O=m.memoizedState,T=O.element,eX(f,m),oT(m,k,null,w);var $=m.memoizedState;if(k=$.element,O.isDehydrated)if(O={element:k,isDehydrated:!1,cache:$.cache,pendingSuspenseBoundaries:$.pendingSuspenseBoundaries,transitions:$.transitions},m.updateQueue.baseState=O,m.memoizedState=O,m.flags&256){T=M0(Error(t(423)),m),m=WX(f,m,k,w,T);break e}else if(k!==T){T=M0(Error(t(424)),m),m=WX(f,m,k,w,T);break e}else for(Yl=Zg(m.stateNode.containerInfo.firstChild),Ql=m,us=!0,Ld=null,w=ZY(m,null,k,w),m.child=w;w;)w.flags=w.flags&-3|4096,w=w.sibling;else{if(T0(),k===T){m=cf(f,m,w);break e}ga(f,m,k,w)}m=m.child}return m;case 5:return nX(m),f===null&&a3(m),k=m.type,T=m.pendingProps,O=f!==null?f.memoizedProps:null,$=T.children,Z5(k,T)?$=null:O!==null&&Z5(k,O)&&(m.flags|=32),FX(f,m),ga(f,m,$,w),m.child;case 6:return f===null&&a3(m),null;case 13:return HX(f,m,w);case 4:return p3(m,m.stateNode.containerInfo),k=m.pendingProps,f===null?m.child=N0(m,null,k,w):ga(f,m,k,w),m.child;case 11:return k=m.type,T=m.pendingProps,T=m.elementType===k?T:kd(k,T),AX(f,m,k,T,w);case 7:return ga(f,m,m.pendingProps,w),m.child;case 8:return ga(f,m,m.pendingProps.children,w),m.child;case 12:return ga(f,m,m.pendingProps.children,w),m.child;case 10:e:{if(k=m.type._context,T=m.pendingProps,O=m.memoizedProps,$=T.value,Jn(nT,k._currentValue),k._currentValue=$,O!==null)if(xd(O.value,$)){if(O.children===T.children&&!Za.current){m=cf(f,m,w);break e}}else for(O=m.child,O!==null&&(O.return=m);O!==null;){var ne=O.dependencies;if(ne!==null){$=O.child;for(var ae=ne.firstContext;ae!==null;){if(ae.context===k){if(O.tag===1){ae=lf(-1,w&-w),ae.tag=2;var Te=O.updateQueue;if(Te!==null){Te=Te.shared;var $e=Te.pending;$e===null?ae.next=ae:(ae.next=$e.next,$e.next=ae),Te.pending=ae}}O.lanes|=w,ae=O.alternate,ae!==null&&(ae.lanes|=w),h3(O.return,w,m),ne.lanes|=w;break}ae=ae.next}}else if(O.tag===10)$=O.type===m.type?null:O.child;else if(O.tag===18){if($=O.return,$===null)throw Error(t(341));$.lanes|=w,ne=$.alternate,ne!==null&&(ne.lanes|=w),h3($,w,m),$=O.sibling}else $=O.child;if($!==null)$.return=O;else for($=O;$!==null;){if($===m){$=null;break}if(O=$.sibling,O!==null){O.return=$.return,$=O;break}$=$.return}O=$}ga(f,m,T.children,w),m=m.child}return m;case 9:return T=m.type,k=m.pendingProps.children,A0(m,w),T=Pc(T),k=k(T),m.flags|=1,ga(f,m,k,w),m.child;case 14:return k=m.type,T=kd(k,m.pendingProps),T=kd(k.type,T),PX(f,m,k,T,w);case 15:return MX(f,m,m.type,m.pendingProps,w);case 17:return k=m.type,T=m.pendingProps,T=m.elementType===k?T:kd(k,T),pT(f,m),m.tag=1,Ja(k)?(f=!0,XD(m)):f=!1,A0(m,w),kX(m,k,T),E3(m,k,T,w),R3(null,m,k,!0,f,w);case 19:return UX(f,m,w);case 22:return OX(f,m,w)}throw Error(t(156,m.tag))};function fZ(f,m){return Ge(f,m)}function Hwe(f,m,w,k){this.tag=f,this.key=w,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=m,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=k,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fc(f,m,w,k){return new Hwe(f,m,w,k)}function Z3(f){return f=f.prototype,!(!f||!f.isReactComponent)}function zwe(f){if(typeof f=="function")return Z3(f)?1:0;if(f!=null){if(f=f.$$typeof,f===U)return 11;if(f===re)return 14}return 2}function cp(f,m){var w=f.alternate;return w===null?(w=Fc(f.tag,m,f.key,f.mode),w.elementType=f.elementType,w.type=f.type,w.stateNode=f.stateNode,w.alternate=f,f.alternate=w):(w.pendingProps=m,w.type=f.type,w.flags=0,w.subtreeFlags=0,w.deletions=null),w.flags=f.flags&14680064,w.childLanes=f.childLanes,w.lanes=f.lanes,w.child=f.child,w.memoizedProps=f.memoizedProps,w.memoizedState=f.memoizedState,w.updateQueue=f.updateQueue,m=f.dependencies,w.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext},w.sibling=f.sibling,w.index=f.index,w.ref=f.ref,w}function kT(f,m,w,k,T,O){var $=2;if(k=f,typeof f=="function")Z3(f)&&($=1);else if(typeof f=="string")$=5;else e:switch(f){case D:return U_(w.children,T,O,m);case N:$=8,T|=8;break;case R:return f=Fc(12,w,m,T|2),f.elementType=R,f.lanes=O,f;case B:return f=Fc(13,w,m,T),f.elementType=B,f.lanes=O,f;case ee:return f=Fc(19,w,m,T),f.elementType=ee,f.lanes=O,f;case Ie:return IT(w,T,O,m);default:if(typeof f=="object"&&f!==null)switch(f.$$typeof){case W:$=10;break e;case H:$=9;break e;case U:$=11;break e;case re:$=14;break e;case pe:$=16,k=null;break e}throw Error(t(130,f==null?f:typeof f,""))}return m=Fc($,w,m,T),m.elementType=f,m.type=k,m.lanes=O,m}function U_(f,m,w,k){return f=Fc(7,f,k,m),f.lanes=w,f}function IT(f,m,w,k){return f=Fc(22,f,k,m),f.elementType=Ie,f.lanes=w,f.stateNode={isHidden:!1},f}function J3(f,m,w){return f=Fc(6,f,null,m),f.lanes=w,f}function e9(f,m,w){return m=Fc(4,f.children!==null?f.children:[],f.key,m),m.lanes=w,m.stateNode={containerInfo:f.containerInfo,pendingChildren:null,implementation:f.implementation},m}function Uwe(f,m,w,k,T){this.tag=m,this.containerInfo=f,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=jg(0),this.expirationTimes=jg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=jg(0),this.identifierPrefix=k,this.onRecoverableError=T,this.mutableSourceEagerHydrationData=null}function t9(f,m,w,k,T,O,$,ne,ae){return f=new Uwe(f,m,w,ne,ae),m===1?(m=1,O===!0&&(m|=8)):m=0,O=Fc(3,null,null,m),f.current=O,O.stateNode=f,O.memoizedState={element:k,isDehydrated:w,cache:null,transitions:null,pendingSuspenseBoundaries:null},g3(O),f}function jwe(f,m,w){var k=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:A,key:k==null?null:""+k,children:f,containerInfo:m,implementation:w}}function gZ(f){if(!f)return ep;f=f._reactInternals;e:{if(ki(f)!==f||f.tag!==1)throw Error(t(170));var m=f;do{switch(m.tag){case 3:m=m.stateNode.context;break e;case 1:if(Ja(m.type)){m=m.stateNode.__reactInternalMemoizedMergedChildContext;break e}}m=m.return}while(m!==null);throw Error(t(171))}if(f.tag===1){var w=f.type;if(Ja(w))return zY(f,w,m)}return m}function pZ(f,m,w,k,T,O,$,ne,ae){return f=t9(w,k,!0,f,T,O,$,ne,ae),f.context=gZ(null),w=f.current,k=pa(),T=ap(w),O=lf(k,T),O.callback=m??null,np(w,O,T),f.current.lanes=T,$g(f,T,k),il(f,k),f}function ET(f,m,w,k){var T=m.current,O=pa(),$=ap(T);return w=gZ(w),m.context===null?m.context=w:m.pendingContext=w,m=lf(O,$),m.payload={element:f},k=k===void 0?null:k,k!==null&&(m.callback=k),f=np(T,m,$),f!==null&&(Dd(f,T,$,O),rT(f,T,$)),$}function DT(f){if(f=f.current,!f.child)return null;switch(f.child.tag){case 5:return f.child.stateNode;default:return f.child.stateNode}}function mZ(f,m){if(f=f.memoizedState,f!==null&&f.dehydrated!==null){var w=f.retryLane;f.retryLane=w!==0&&w<m?w:m}}function i9(f,m){mZ(f,m),(f=f.alternate)&&mZ(f,m)}function $we(){return null}var _Z=typeof reportError=="function"?reportError:function(f){console.error(f)};function n9(f){this._internalRoot=f}TT.prototype.render=n9.prototype.render=function(f){var m=this._internalRoot;if(m===null)throw Error(t(409));ET(f,m,null,null)},TT.prototype.unmount=n9.prototype.unmount=function(){var f=this._internalRoot;if(f!==null){this._internalRoot=null;var m=f.containerInfo;W_(function(){ET(null,f,null,null)}),m[nf]=null}};function TT(f){this._internalRoot=f}TT.prototype.unstable_scheduleHydration=function(f){if(f){var m=TD();f={blockedOn:null,target:f,priority:m};for(var w=0;w<Eu.length&&m!==0&&m<Eu[w].priority;w++);Eu.splice(w,0,f),w===0&&AD(f)}};function s9(f){return!(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)}function NT(f){return!(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11&&(f.nodeType!==8||f.nodeValue!==" react-mount-point-unstable "))}function bZ(){}function qwe(f,m,w,k,T){if(T){if(typeof k=="function"){var O=k;k=function(){var Te=DT($);O.call(Te)}}var $=pZ(m,k,f,0,null,!1,!1,"",bZ);return f._reactRootContainer=$,f[nf]=$.current,KS(f.nodeType===8?f.parentNode:f),W_(),$}for(;T=f.lastChild;)f.removeChild(T);if(typeof k=="function"){var ne=k;k=function(){var Te=DT(ae);ne.call(Te)}}var ae=t9(f,0,!1,null,null,!1,!1,"",bZ);return f._reactRootContainer=ae,f[nf]=ae.current,KS(f.nodeType===8?f.parentNode:f),W_(function(){ET(m,ae,w,k)}),ae}function RT(f,m,w,k,T){var O=w._reactRootContainer;if(O){var $=O;if(typeof T=="function"){var ne=T;T=function(){var ae=DT($);ne.call(ae)}}ET(m,$,f,T)}else $=qwe(w,m,f,T,k);return DT($)}ED=function(f){switch(f.tag){case 3:var m=f.stateNode;if(m.current.memoizedState.isDehydrated){var w=Ug(m.pendingLanes);w!==0&&(qg(m,w|1),il(m,mi()),(an&6)===0&&(V0=mi()+500,tp()))}break;case 13:W_(function(){var k=af(f,1);if(k!==null){var T=pa();Dd(k,f,1,T)}}),i9(f,1)}},c0=function(f){if(f.tag===13){var m=af(f,134217728);if(m!==null){var w=pa();Dd(m,f,134217728,w)}i9(f,134217728)}},DD=function(f){if(f.tag===13){var m=ap(f),w=af(f,m);if(w!==null){var k=pa();Dd(w,f,m,k)}i9(f,m)}},TD=function(){return zi},ND=function(f,m){var w=zi;try{return zi=f,m()}finally{zi=w}},xu=function(f,m,w){switch(m){case"input":if(Ua(f,w),m=w.name,w.type==="radio"&&m!=null){for(w=f;w.parentNode;)w=w.parentNode;for(w=w.querySelectorAll("input[name="+JSON.stringify(""+m)+'][type="radio"]'),m=0;m<w.length;m++){var k=w[m];if(k!==f&&k.form===f.form){var T=QD(k);if(!T)throw Error(t(90));vn(k),Ua(k,T)}}}break;case"textarea":$a(f,w);break;case"select":m=w.value,m!=null&&ja(f,!!w.multiple,m,!1)}},jl=Q3,zt=W_;var Kwe={usingClientEntryPoint:!1,Events:[YS,L0,QD,Ga,Lu,Q3]},dx={findFiberByHostInstance:R_,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Gwe={bundleType:dx.bundleType,version:dx.version,rendererPackageName:dx.rendererPackageName,rendererConfig:dx.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:L.ReactCurrentDispatcher,findHostInstanceByFiber:function(f){return f=xt(f),f===null?null:f.stateNode},findFiberByHostInstance:dx.findFiberByHostInstance||$we,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var AT=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!AT.isDisabled&&AT.supportsFiber)try{L_=AT.inject(Gwe),$l=AT}catch{}}return nl.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Kwe,nl.createPortal=function(f,m){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!s9(m))throw Error(t(200));return jwe(f,m,null,w)},nl.createRoot=function(f,m){if(!s9(f))throw Error(t(299));var w=!1,k="",T=_Z;return m!=null&&(m.unstable_strictMode===!0&&(w=!0),m.identifierPrefix!==void 0&&(k=m.identifierPrefix),m.onRecoverableError!==void 0&&(T=m.onRecoverableError)),m=t9(f,1,!1,null,null,w,!1,k,T),f[nf]=m.current,KS(f.nodeType===8?f.parentNode:f),new n9(m)},nl.findDOMNode=function(f){if(f==null)return null;if(f.nodeType===1)return f;var m=f._reactInternals;if(m===void 0)throw typeof f.render=="function"?Error(t(188)):(f=Object.keys(f).join(","),Error(t(268,f)));return f=xt(m),f=f===null?null:f.stateNode,f},nl.flushSync=function(f){return W_(f)},nl.hydrate=function(f,m,w){if(!NT(m))throw Error(t(200));return RT(null,f,m,!0,w)},nl.hydrateRoot=function(f,m,w){if(!s9(f))throw Error(t(405));var k=w!=null&&w.hydratedSources||null,T=!1,O="",$=_Z;if(w!=null&&(w.unstable_strictMode===!0&&(T=!0),w.identifierPrefix!==void 0&&(O=w.identifierPrefix),w.onRecoverableError!==void 0&&($=w.onRecoverableError)),m=pZ(m,null,f,1,w??null,T,!1,O,$),f[nf]=m.current,KS(f),k)for(f=0;f<k.length;f++)w=k[f],T=w._getVersion,T=T(w._source),m.mutableSourceEagerHydrationData==null?m.mutableSourceEagerHydrationData=[w,T]:m.mutableSourceEagerHydrationData.push(w,T);return new TT(m)},nl.render=function(f,m,w){if(!NT(m))throw Error(t(200));return RT(null,f,m,!1,w)},nl.unmountComponentAtNode=function(f){if(!NT(f))throw Error(t(40));return f._reactRootContainer?(W_(function(){RT(null,null,f,!1,function(){f._reactRootContainer=null,f[nf]=null})}),!0):!1},nl.unstable_batchedUpdates=Q3,nl.unstable_renderSubtreeIntoContainer=function(f,m,w,k){if(!NT(w))throw Error(t(200));if(f==null||f._reactInternals===void 0)throw Error(t(38));return RT(f,m,w,!1,k)},nl.version="18.3.1-next-f1338f8080-20240426",nl}var kZ;function s0e(){if(kZ)return a9.exports;kZ=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),a9.exports=n0e(),a9.exports}var IZ;function r0e(){if(IZ)return MT;IZ=1;var s=s0e();return MT.createRoot=s.createRoot,MT.hydrateRoot=s.hydrateRoot,MT}var o0e=r0e(),hx={},EZ;function a0e(){if(EZ)return hx;EZ=1,Object.defineProperty(hx,"__esModule",{value:!0}),hx.parse=o,hx.serialize=c;const s=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,i=/^[\u0020-\u003A\u003D-\u007E]*$/,n=Object.prototype.toString,r=(()=>{const h=function(){};return h.prototype=Object.create(null),h})();function o(h,g){const p=new r,_=h.length;if(_<2)return p;const v=(g==null?void 0:g.decode)||d;let C=0;do{const y=h.indexOf("=",C);if(y===-1)break;const x=h.indexOf(";",C),L=x===-1?_:x;if(y>L){C=h.lastIndexOf(";",y-1)+1;continue}const I=a(h,C,y),A=l(h,y,I),D=h.slice(I,A);if(p[D]===void 0){let N=a(h,y+1,L),R=l(h,L,N);const W=v(h.slice(N,R));p[D]=W}C=L+1}while(C<_);return p}function a(h,g,p){do{const _=h.charCodeAt(g);if(_!==32&&_!==9)return g}while(++g<p);return p}function l(h,g,p){for(;g>p;){const _=h.charCodeAt(--g);if(_!==32&&_!==9)return g+1}return p}function c(h,g,p){const _=(p==null?void 0:p.encode)||encodeURIComponent;if(!s.test(h))throw new TypeError(`argument name is invalid: ${h}`);const v=_(g);if(!e.test(v))throw new TypeError(`argument val is invalid: ${g}`);let C=h+"="+v;if(!p)return C;if(p.maxAge!==void 0){if(!Number.isInteger(p.maxAge))throw new TypeError(`option maxAge is invalid: ${p.maxAge}`);C+="; Max-Age="+p.maxAge}if(p.domain){if(!t.test(p.domain))throw new TypeError(`option domain is invalid: ${p.domain}`);C+="; Domain="+p.domain}if(p.path){if(!i.test(p.path))throw new TypeError(`option path is invalid: ${p.path}`);C+="; Path="+p.path}if(p.expires){if(!u(p.expires)||!Number.isFinite(p.expires.valueOf()))throw new TypeError(`option expires is invalid: ${p.expires}`);C+="; Expires="+p.expires.toUTCString()}if(p.httpOnly&&(C+="; HttpOnly"),p.secure&&(C+="; Secure"),p.partitioned&&(C+="; Partitioned"),p.priority)switch(typeof p.priority=="string"?p.priority.toLowerCase():void 0){case"low":C+="; Priority=Low";break;case"medium":C+="; Priority=Medium";break;case"high":C+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${p.priority}`)}if(p.sameSite)switch(typeof p.sameSite=="string"?p.sameSite.toLowerCase():p.sameSite){case!0:case"strict":C+="; SameSite=Strict";break;case"lax":C+="; SameSite=Lax";break;case"none":C+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${p.sameSite}`)}return C}function d(h){if(h.indexOf("%")===-1)return h;try{return decodeURIComponent(h)}catch{return h}}function u(h){return n.call(h)==="[object Date]"}return hx}a0e();/**
 * react-router v7.4.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var DZ="popstate";function l0e(s={}){function e(i,n){let{pathname:r,search:o,hash:a}=i.location;return t7("",{pathname:r,search:o,hash:a},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function t(i,n){return typeof n=="string"?n:Ak(n)}return d0e(e,t,null,s)}function Ss(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function Lh(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function c0e(){return Math.random().toString(36).substring(2,10)}function TZ(s,e){return{usr:s.state,key:s.key,idx:e}}function t7(s,e,t=null,i){return{pathname:typeof s=="string"?s:s.pathname,search:"",hash:"",...typeof e=="string"?X1(e):e,state:t,key:e&&e.key||i||c0e()}}function Ak({pathname:s="/",search:e="",hash:t=""}){return e&&e!=="?"&&(s+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(s+=t.charAt(0)==="#"?t:"#"+t),s}function X1(s){let e={};if(s){let t=s.indexOf("#");t>=0&&(e.hash=s.substring(t),s=s.substring(0,t));let i=s.indexOf("?");i>=0&&(e.search=s.substring(i),s=s.substring(0,i)),s&&(e.pathname=s)}return e}function d0e(s,e,t,i={}){let{window:n=document.defaultView,v5Compat:r=!1}=i,o=n.history,a="POP",l=null,c=d();c==null&&(c=0,o.replaceState({...o.state,idx:c},""));function d(){return(o.state||{idx:null}).idx}function u(){a="POP";let v=d(),C=v==null?null:v-c;c=v,l&&l({action:a,location:_.location,delta:C})}function h(v,C){a="PUSH";let y=t7(_.location,v,C);c=d()+1;let x=TZ(y,c),L=_.createHref(y);try{o.pushState(x,"",L)}catch(I){if(I instanceof DOMException&&I.name==="DataCloneError")throw I;n.location.assign(L)}r&&l&&l({action:a,location:_.location,delta:1})}function g(v,C){a="REPLACE";let y=t7(_.location,v,C);c=d();let x=TZ(y,c),L=_.createHref(y);o.replaceState(x,"",L),r&&l&&l({action:a,location:_.location,delta:0})}function p(v){let C=n.location.origin!=="null"?n.location.origin:n.location.href,y=typeof v=="string"?v:Ak(v);return y=y.replace(/ $/,"%20"),Ss(C,`No window.location.(origin|href) available to create URL for href: ${y}`),new URL(y,C)}let _={get action(){return a},get location(){return s(n,o)},listen(v){if(l)throw new Error("A history only accepts one active listener");return n.addEventListener(DZ,u),l=v,()=>{n.removeEventListener(DZ,u),l=null}},createHref(v){return e(n,v)},createURL:p,encodeLocation(v){let C=p(v);return{pathname:C.pathname,search:C.search,hash:C.hash}},push:h,replace:g,go(v){return o.go(v)}};return _}function yae(s,e,t="/"){return u0e(s,e,t,!1)}function u0e(s,e,t,i){let n=typeof e=="string"?X1(e):e,r=gg(n.pathname||"/",t);if(r==null)return null;let o=Sae(s);h0e(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=S0e(r);a=C0e(o[l],c,i)}return a}function Sae(s,e=[],t=[],i=""){let n=(r,o,a)=>{let l={relativePath:a===void 0?r.path||"":a,caseSensitive:r.caseSensitive===!0,childrenIndex:o,route:r};l.relativePath.startsWith("/")&&(Ss(l.relativePath.startsWith(i),`Absolute route path "${l.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),l.relativePath=l.relativePath.slice(i.length));let c=sg([i,l.relativePath]),d=t.concat(l);r.children&&r.children.length>0&&(Ss(r.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${c}".`),Sae(r.children,e,d,c)),!(r.path==null&&!r.index)&&e.push({path:c,score:v0e(c,r.index),routesMeta:d})};return s.forEach((r,o)=>{var a;if(r.path===""||!((a=r.path)!=null&&a.includes("?")))n(r,o);else for(let l of xae(r.path))n(r,o,l)}),e}function xae(s){let e=s.split("/");if(e.length===0)return[];let[t,...i]=e,n=t.endsWith("?"),r=t.replace(/\?$/,"");if(i.length===0)return n?[r,""]:[r];let o=xae(i.join("/")),a=[];return a.push(...o.map(l=>l===""?r:[r,l].join("/"))),n&&a.push(...o),a.map(l=>s.startsWith("/")&&l===""?"/":l)}function h0e(s){s.sort((e,t)=>e.score!==t.score?t.score-e.score:w0e(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var f0e=/^:[\w-]+$/,g0e=3,p0e=2,m0e=1,_0e=10,b0e=-2,NZ=s=>s==="*";function v0e(s,e){let t=s.split("/"),i=t.length;return t.some(NZ)&&(i+=b0e),e&&(i+=p0e),t.filter(n=>!NZ(n)).reduce((n,r)=>n+(f0e.test(r)?g0e:r===""?m0e:_0e),i)}function w0e(s,e){return s.length===e.length&&s.slice(0,-1).every((i,n)=>i===e[n])?s[s.length-1]-e[e.length-1]:0}function C0e(s,e,t=!1){let{routesMeta:i}=s,n={},r="/",o=[];for(let a=0;a<i.length;++a){let l=i[a],c=a===i.length-1,d=r==="/"?e:e.slice(r.length)||"/",u=o2({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},d),h=l.route;if(!u&&c&&t&&!i[i.length-1].route.index&&(u=o2({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},d)),!u)return null;Object.assign(n,u.params),o.push({params:n,pathname:sg([r,u.pathname]),pathnameBase:I0e(sg([r,u.pathnameBase])),route:h}),u.pathnameBase!=="/"&&(r=sg([r,u.pathnameBase]))}return o}function o2(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[t,i]=y0e(s.path,s.caseSensitive,s.end),n=e.match(t);if(!n)return null;let r=n[0],o=r.replace(/(.)\/+$/,"$1"),a=n.slice(1);return{params:i.reduce((c,{paramName:d,isOptional:u},h)=>{if(d==="*"){let p=a[h]||"";o=r.slice(0,r.length-p.length).replace(/(.)\/+$/,"$1")}const g=a[h];return u&&!g?c[d]=void 0:c[d]=(g||"").replace(/%2F/g,"/"),c},{}),pathname:r,pathnameBase:o,pattern:s}}function y0e(s,e=!1,t=!0){Lh(s==="*"||!s.endsWith("*")||s.endsWith("/*"),`Route path "${s}" will be treated as if it were "${s.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${s.replace(/\*$/,"/*")}".`);let i=[],n="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(i.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return s.endsWith("*")?(i.push({paramName:"*"}),n+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?n+="\\/*$":s!==""&&s!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,e?void 0:"i"),i]}function S0e(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Lh(!1,`The URL path "${s}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),s}}function gg(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=s.charAt(t);return i&&i!=="/"?null:s.slice(t)||"/"}function x0e(s,e="/"){let{pathname:t,search:i="",hash:n=""}=typeof s=="string"?X1(s):s;return{pathname:t?t.startsWith("/")?t:L0e(t,e):e,search:E0e(i),hash:D0e(n)}}function L0e(s,e){let t=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(n=>{n===".."?t.length>1&&t.pop():n!=="."&&t.push(n)}),t.length>1?t.join("/"):"/"}function d9(s,e,t,i){return`Cannot include a '${s}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function k0e(s){return s.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Lae(s){let e=k0e(s);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function kae(s,e,t,i=!1){let n;typeof s=="string"?n=X1(s):(n={...s},Ss(!n.pathname||!n.pathname.includes("?"),d9("?","pathname","search",n)),Ss(!n.pathname||!n.pathname.includes("#"),d9("#","pathname","hash",n)),Ss(!n.search||!n.search.includes("#"),d9("#","search","hash",n)));let r=s===""||n.pathname==="",o=r?"/":n.pathname,a;if(o==null)a=t;else{let u=e.length-1;if(!i&&o.startsWith("..")){let h=o.split("/");for(;h[0]==="..";)h.shift(),u-=1;n.pathname=h.join("/")}a=u>=0?e[u]:"/"}let l=x0e(n,a),c=o&&o!=="/"&&o.endsWith("/"),d=(r||o===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(c||d)&&(l.pathname+="/"),l}var sg=s=>s.join("/").replace(/\/\/+/g,"/"),I0e=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),E0e=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,D0e=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s;function T0e(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}var Iae=["POST","PUT","PATCH","DELETE"];new Set(Iae);var N0e=["GET",...Iae];new Set(N0e);var Z1=ie.createContext(null);Z1.displayName="DataRouter";var d4=ie.createContext(null);d4.displayName="DataRouterState";var Eae=ie.createContext({isTransitioning:!1});Eae.displayName="ViewTransition";var R0e=ie.createContext(new Map);R0e.displayName="Fetchers";var A0e=ie.createContext(null);A0e.displayName="Await";var Hh=ie.createContext(null);Hh.displayName="Navigation";var kE=ie.createContext(null);kE.displayName="Location";var zh=ie.createContext({outlet:null,matches:[],isDataRoute:!1});zh.displayName="Route";var i$=ie.createContext(null);i$.displayName="RouteError";function P0e(s,{relative:e}={}){Ss(IE(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=ie.useContext(Hh),{hash:n,pathname:r,search:o}=EE(s,{relative:e}),a=r;return t!=="/"&&(a=r==="/"?t:sg([t,r])),i.createHref({pathname:a,search:o,hash:n})}function IE(){return ie.useContext(kE)!=null}function a_(){return Ss(IE(),"useLocation() may be used only in the context of a <Router> component."),ie.useContext(kE).location}var Dae="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Tae(s){ie.useContext(Hh).static||ie.useLayoutEffect(s)}function l_(){let{isDataRoute:s}=ie.useContext(zh);return s?K0e():M0e()}function M0e(){Ss(IE(),"useNavigate() may be used only in the context of a <Router> component.");let s=ie.useContext(Z1),{basename:e,navigator:t}=ie.useContext(Hh),{matches:i}=ie.useContext(zh),{pathname:n}=a_(),r=JSON.stringify(Lae(i)),o=ie.useRef(!1);return Tae(()=>{o.current=!0}),ie.useCallback((l,c={})=>{if(Lh(o.current,Dae),!o.current)return;if(typeof l=="number"){t.go(l);return}let d=kae(l,JSON.parse(r),n,c.relative==="path");s==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:sg([e,d.pathname])),(c.replace?t.replace:t.push)(d,c.state,c)},[e,t,r,n,s])}ie.createContext(null);function J1(){let{matches:s}=ie.useContext(zh),e=s[s.length-1];return e?e.params:{}}function EE(s,{relative:e}={}){let{matches:t}=ie.useContext(zh),{pathname:i}=a_(),n=JSON.stringify(Lae(t));return ie.useMemo(()=>kae(s,JSON.parse(n),i,e==="path"),[s,n,i,e])}function O0e(s,e){return Nae(s,e)}function Nae(s,e,t,i){var y;Ss(IE(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:n,static:r}=ie.useContext(Hh),{matches:o}=ie.useContext(zh),a=o[o.length-1],l=a?a.params:{},c=a?a.pathname:"/",d=a?a.pathnameBase:"/",u=a&&a.route;{let x=u&&u.path||"";Rae(c,!u||x.endsWith("*")||x.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${x}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${x}"> to <Route path="${x==="/"?"*":`${x}/*`}">.`)}let h=a_(),g;if(e){let x=typeof e=="string"?X1(e):e;Ss(d==="/"||((y=x.pathname)==null?void 0:y.startsWith(d)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${d}" but pathname "${x.pathname}" was given in the \`location\` prop.`),g=x}else g=h;let p=g.pathname||"/",_=p;if(d!=="/"){let x=d.replace(/^\//,"").split("/");_="/"+p.replace(/^\//,"").split("/").slice(x.length).join("/")}let v=!r&&t&&t.matches&&t.matches.length>0?t.matches:yae(s,{pathname:_});Lh(u||v!=null,`No routes matched location "${g.pathname}${g.search}${g.hash}" `),Lh(v==null||v[v.length-1].route.element!==void 0||v[v.length-1].route.Component!==void 0||v[v.length-1].route.lazy!==void 0,`Matched leaf route at location "${g.pathname}${g.search}${g.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let C=H0e(v&&v.map(x=>Object.assign({},x,{params:Object.assign({},l,x.params),pathname:sg([d,n.encodeLocation?n.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?d:sg([d,n.encodeLocation?n.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),o,t,i);return e&&C?ie.createElement(kE.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...g},navigationType:"POP"}},C):C}function F0e(){let s=q0e(),e=T0e(s)?`${s.status} ${s.statusText}`:s instanceof Error?s.message:JSON.stringify(s),t=s instanceof Error?s.stack:null,i="rgba(200,200,200, 0.5)",n={padding:"0.5rem",backgroundColor:i},r={padding:"2px 4px",backgroundColor:i},o=null;return console.error("Error handled by React Router default ErrorBoundary:",s),o=ie.createElement(ie.Fragment,null,ie.createElement("p",null,"💿 Hey developer 👋"),ie.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",ie.createElement("code",{style:r},"ErrorBoundary")," or"," ",ie.createElement("code",{style:r},"errorElement")," prop on your route.")),ie.createElement(ie.Fragment,null,ie.createElement("h2",null,"Unexpected Application Error!"),ie.createElement("h3",{style:{fontStyle:"italic"}},e),t?ie.createElement("pre",{style:n},t):null,o)}var V0e=ie.createElement(F0e,null),B0e=class extends ie.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,e){return e.location!==s.location||e.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:e.error,location:e.location,revalidation:s.revalidation||e.revalidation}}componentDidCatch(s,e){console.error("React Router caught the following error during render",s,e)}render(){return this.state.error!==void 0?ie.createElement(zh.Provider,{value:this.props.routeContext},ie.createElement(i$.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function W0e({routeContext:s,match:e,children:t}){let i=ie.useContext(Z1);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),ie.createElement(zh.Provider,{value:s},t)}function H0e(s,e=[],t=null,i=null){if(s==null){if(!t)return null;if(t.errors)s=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)s=t.matches;else return null}let n=s,r=t==null?void 0:t.errors;if(r!=null){let l=n.findIndex(c=>c.route.id&&(r==null?void 0:r[c.route.id])!==void 0);Ss(l>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(r).join(",")}`),n=n.slice(0,Math.min(n.length,l+1))}let o=!1,a=-1;if(t)for(let l=0;l<n.length;l++){let c=n[l];if((c.route.HydrateFallback||c.route.hydrateFallbackElement)&&(a=l),c.route.id){let{loaderData:d,errors:u}=t,h=c.route.loader&&!d.hasOwnProperty(c.route.id)&&(!u||u[c.route.id]===void 0);if(c.route.lazy||h){o=!0,a>=0?n=n.slice(0,a+1):n=[n[0]];break}}}return n.reduceRight((l,c,d)=>{let u,h=!1,g=null,p=null;t&&(u=r&&c.route.id?r[c.route.id]:void 0,g=c.route.errorElement||V0e,o&&(a<0&&d===0?(Rae("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,p=null):a===d&&(h=!0,p=c.route.hydrateFallbackElement||null)));let _=e.concat(n.slice(0,d+1)),v=()=>{let C;return u?C=g:h?C=p:c.route.Component?C=ie.createElement(c.route.Component,null):c.route.element?C=c.route.element:C=l,ie.createElement(W0e,{match:c,routeContext:{outlet:l,matches:_,isDataRoute:t!=null},children:C})};return t&&(c.route.ErrorBoundary||c.route.errorElement||d===0)?ie.createElement(B0e,{location:t.location,revalidation:t.revalidation,component:g,error:u,children:v(),routeContext:{outlet:null,matches:_,isDataRoute:!0}}):v()},null)}function n$(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function z0e(s){let e=ie.useContext(Z1);return Ss(e,n$(s)),e}function U0e(s){let e=ie.useContext(d4);return Ss(e,n$(s)),e}function j0e(s){let e=ie.useContext(zh);return Ss(e,n$(s)),e}function s$(s){let e=j0e(s),t=e.matches[e.matches.length-1];return Ss(t.route.id,`${s} can only be used on routes that contain a unique "id"`),t.route.id}function $0e(){return s$("useRouteId")}function q0e(){var i;let s=ie.useContext(i$),e=U0e("useRouteError"),t=s$("useRouteError");return s!==void 0?s:(i=e.errors)==null?void 0:i[t]}function K0e(){let{router:s}=z0e("useNavigate"),e=s$("useNavigate"),t=ie.useRef(!1);return Tae(()=>{t.current=!0}),ie.useCallback(async(n,r={})=>{Lh(t.current,Dae),t.current&&(typeof n=="number"?s.navigate(n):await s.navigate(n,{fromRouteId:e,...r}))},[s,e])}var RZ={};function Rae(s,e,t){!e&&!RZ[s]&&(RZ[s]=!0,Lh(!1,t))}ie.memo(G0e);function G0e({routes:s,future:e,state:t}){return Nae(s,void 0,t,e)}function Ho(s){Ss(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Q0e({basename:s="/",children:e=null,location:t,navigationType:i="POP",navigator:n,static:r=!1}){Ss(!IE(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=s.replace(/^\/*/,"/"),a=ie.useMemo(()=>({basename:o,navigator:n,static:r,future:{}}),[o,n,r]);typeof t=="string"&&(t=X1(t));let{pathname:l="/",search:c="",hash:d="",state:u=null,key:h="default"}=t,g=ie.useMemo(()=>{let p=gg(l,o);return p==null?null:{location:{pathname:p,search:c,hash:d,state:u,key:h},navigationType:i}},[o,l,c,d,u,h,i]);return Lh(g!=null,`<Router basename="${o}"> is not able to match the URL "${l}${c}${d}" because it does not start with the basename, so the <Router> won't render anything.`),g==null?null:ie.createElement(Hh.Provider,{value:a},ie.createElement(kE.Provider,{children:e,value:g}))}function Y0e({children:s,location:e}){return O0e(i7(s),e)}function i7(s,e=[]){let t=[];return ie.Children.forEach(s,(i,n)=>{if(!ie.isValidElement(i))return;let r=[...e,n];if(i.type===ie.Fragment){t.push.apply(t,i7(i.props.children,r));return}Ss(i.type===Ho,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ss(!i.props.index||!i.props.children,"An index route cannot have child routes.");let o={id:i.props.id||r.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(o.children=i7(i.props.children,r)),t.push(o)}),t}var oR="get",aR="application/x-www-form-urlencoded";function u4(s){return s!=null&&typeof s.tagName=="string"}function X0e(s){return u4(s)&&s.tagName.toLowerCase()==="button"}function Z0e(s){return u4(s)&&s.tagName.toLowerCase()==="form"}function J0e(s){return u4(s)&&s.tagName.toLowerCase()==="input"}function eCe(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function tCe(s,e){return s.button===0&&(!e||e==="_self")&&!eCe(s)}var OT=null;function iCe(){if(OT===null)try{new FormData(document.createElement("form"),0),OT=!1}catch{OT=!0}return OT}var nCe=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function u9(s){return s!=null&&!nCe.has(s)?(Lh(!1,`"${s}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${aR}"`),null):s}function sCe(s,e){let t,i,n,r,o;if(Z0e(s)){let a=s.getAttribute("action");i=a?gg(a,e):null,t=s.getAttribute("method")||oR,n=u9(s.getAttribute("enctype"))||aR,r=new FormData(s)}else if(X0e(s)||J0e(s)&&(s.type==="submit"||s.type==="image")){let a=s.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=s.getAttribute("formaction")||a.getAttribute("action");if(i=l?gg(l,e):null,t=s.getAttribute("formmethod")||a.getAttribute("method")||oR,n=u9(s.getAttribute("formenctype"))||u9(a.getAttribute("enctype"))||aR,r=new FormData(a,s),!iCe()){let{name:c,type:d,value:u}=s;if(d==="image"){let h=c?`${c}.`:"";r.append(`${h}x`,"0"),r.append(`${h}y`,"0")}else c&&r.append(c,u)}}else{if(u4(s))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=oR,i=null,n=aR,o=s}return r&&n==="text/plain"&&(o=r,r=void 0),{action:i,method:t.toLowerCase(),encType:n,formData:r,body:o}}function r$(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}async function rCe(s,e){if(s.id in e)return e[s.id];try{let t=await import(s.module);return e[s.id]=t,t}catch(t){return console.error(`Error loading route module \`${s.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function oCe(s){return s==null?!1:s.href==null?s.rel==="preload"&&typeof s.imageSrcSet=="string"&&typeof s.imageSizes=="string":typeof s.rel=="string"&&typeof s.href=="string"}async function aCe(s,e,t){let i=await Promise.all(s.map(async n=>{let r=e.routes[n.route.id];if(r){let o=await rCe(r,t);return o.links?o.links():[]}return[]}));return uCe(i.flat(1).filter(oCe).filter(n=>n.rel==="stylesheet"||n.rel==="preload").map(n=>n.rel==="stylesheet"?{...n,rel:"prefetch",as:"style"}:{...n,rel:"prefetch"}))}function AZ(s,e,t,i,n,r){let o=(l,c)=>t[c]?l.route.id!==t[c].route.id:!0,a=(l,c)=>{var d;return t[c].pathname!==l.pathname||((d=t[c].route.path)==null?void 0:d.endsWith("*"))&&t[c].params["*"]!==l.params["*"]};return r==="assets"?e.filter((l,c)=>o(l,c)||a(l,c)):r==="data"?e.filter((l,c)=>{var u;let d=i.routes[l.route.id];if(!d||!d.hasLoader)return!1;if(o(l,c)||a(l,c))return!0;if(l.route.shouldRevalidate){let h=l.route.shouldRevalidate({currentUrl:new URL(n.pathname+n.search+n.hash,window.origin),currentParams:((u=t[0])==null?void 0:u.params)||{},nextUrl:new URL(s,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof h=="boolean")return h}return!0}):[]}function lCe(s,e,{includeHydrateFallback:t}={}){return cCe(s.map(i=>{let n=e.routes[i.route.id];if(!n)return[];let r=[n.module];return n.clientActionModule&&(r=r.concat(n.clientActionModule)),n.clientLoaderModule&&(r=r.concat(n.clientLoaderModule)),t&&n.hydrateFallbackModule&&(r=r.concat(n.hydrateFallbackModule)),n.imports&&(r=r.concat(n.imports)),r}).flat(1))}function cCe(s){return[...new Set(s)]}function dCe(s){let e={},t=Object.keys(s).sort();for(let i of t)e[i]=s[i];return e}function uCe(s,e){let t=new Set;return new Set(e),s.reduce((i,n)=>{let r=JSON.stringify(dCe(n));return t.has(r)||(t.add(r),i.push({key:r,link:n})),i},[])}function hCe(s,e){let t=typeof s=="string"?new URL(s,typeof window>"u"?"server://singlefetch/":window.location.origin):s;return t.pathname==="/"?t.pathname="_root.data":e&&gg(t.pathname,e)==="/"?t.pathname=`${e.replace(/\/$/,"")}/_root.data`:t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function Aae(){let s=ie.useContext(Z1);return r$(s,"You must render this element inside a <DataRouterContext.Provider> element"),s}function fCe(){let s=ie.useContext(d4);return r$(s,"You must render this element inside a <DataRouterStateContext.Provider> element"),s}var o$=ie.createContext(void 0);o$.displayName="FrameworkContext";function Pae(){let s=ie.useContext(o$);return r$(s,"You must render this element inside a <HydratedRouter> element"),s}function gCe(s,e){let t=ie.useContext(o$),[i,n]=ie.useState(!1),[r,o]=ie.useState(!1),{onFocus:a,onBlur:l,onMouseEnter:c,onMouseLeave:d,onTouchStart:u}=e,h=ie.useRef(null);ie.useEffect(()=>{if(s==="render"&&o(!0),s==="viewport"){let _=C=>{C.forEach(y=>{o(y.isIntersecting)})},v=new IntersectionObserver(_,{threshold:.5});return h.current&&v.observe(h.current),()=>{v.disconnect()}}},[s]),ie.useEffect(()=>{if(i){let _=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(_)}}},[i]);let g=()=>{n(!0)},p=()=>{n(!1),o(!1)};return t?s!=="intent"?[r,h,{}]:[r,h,{onFocus:fx(a,g),onBlur:fx(l,p),onMouseEnter:fx(c,g),onMouseLeave:fx(d,p),onTouchStart:fx(u,g)}]:[!1,h,{}]}function fx(s,e){return t=>{s&&s(t),t.defaultPrevented||e(t)}}function pCe({page:s,...e}){let{router:t}=Aae(),i=ie.useMemo(()=>yae(t.routes,s,t.basename),[t.routes,s,t.basename]);return i?ie.createElement(_Ce,{page:s,matches:i,...e}):null}function mCe(s){let{manifest:e,routeModules:t}=Pae(),[i,n]=ie.useState([]);return ie.useEffect(()=>{let r=!1;return aCe(s,e,t).then(o=>{r||n(o)}),()=>{r=!0}},[s,e,t]),i}function _Ce({page:s,matches:e,...t}){let i=a_(),{manifest:n,routeModules:r}=Pae(),{basename:o}=Aae(),{loaderData:a,matches:l}=fCe(),c=ie.useMemo(()=>AZ(s,e,l,n,i,"data"),[s,e,l,n,i]),d=ie.useMemo(()=>AZ(s,e,l,n,i,"assets"),[s,e,l,n,i]),u=ie.useMemo(()=>{if(s===i.pathname+i.search+i.hash)return[];let p=new Set,_=!1;if(e.forEach(C=>{var x;let y=n.routes[C.route.id];!y||!y.hasLoader||(!c.some(L=>L.route.id===C.route.id)&&C.route.id in a&&((x=r[C.route.id])!=null&&x.shouldRevalidate)||y.hasClientLoader?_=!0:p.add(C.route.id))}),p.size===0)return[];let v=hCe(s,o);return _&&p.size>0&&v.searchParams.set("_routes",e.filter(C=>p.has(C.route.id)).map(C=>C.route.id).join(",")),[v.pathname+v.search]},[o,a,i,n,c,e,s,r]),h=ie.useMemo(()=>lCe(d,n),[d,n]),g=mCe(d);return ie.createElement(ie.Fragment,null,u.map(p=>ie.createElement("link",{key:p,rel:"prefetch",as:"fetch",href:p,...t})),h.map(p=>ie.createElement("link",{key:p,rel:"modulepreload",href:p,...t})),g.map(({key:p,link:_})=>ie.createElement("link",{key:p,..._})))}function bCe(...s){return e=>{s.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var Mae=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Mae&&(window.__reactRouterVersion="7.4.0")}catch{}function vCe({basename:s,children:e,window:t}){let i=ie.useRef();i.current==null&&(i.current=l0e({window:t,v5Compat:!0}));let n=i.current,[r,o]=ie.useState({action:n.action,location:n.location}),a=ie.useCallback(l=>{ie.startTransition(()=>o(l))},[o]);return ie.useLayoutEffect(()=>n.listen(a),[n,a]),ie.createElement(Q0e,{basename:s,children:e,location:r.location,navigationType:r.action,navigator:n})}var Oae=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,xl=ie.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:n,reloadDocument:r,replace:o,state:a,target:l,to:c,preventScrollReset:d,viewTransition:u,...h},g){let{basename:p}=ie.useContext(Hh),_=typeof c=="string"&&Oae.test(c),v,C=!1;if(typeof c=="string"&&_&&(v=c,Mae))try{let R=new URL(window.location.href),W=c.startsWith("//")?new URL(R.protocol+c):new URL(c),H=gg(W.pathname,p);W.origin===R.origin&&H!=null?c=H+W.search+W.hash:C=!0}catch{Lh(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let y=P0e(c,{relative:n}),[x,L,I]=gCe(i,h),A=SCe(c,{replace:o,state:a,target:l,preventScrollReset:d,relative:n,viewTransition:u});function D(R){e&&e(R),R.defaultPrevented||A(R)}let N=ie.createElement("a",{...h,...I,href:v||y,onClick:C||r?e:D,ref:bCe(g,L),target:l,"data-discover":!_&&t==="render"?"true":void 0});return x&&!_?ie.createElement(ie.Fragment,null,N,ie.createElement(pCe,{page:y})):N});xl.displayName="Link";var wCe=ie.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:n=!1,style:r,to:o,viewTransition:a,children:l,...c},d){let u=EE(o,{relative:c.relative}),h=a_(),g=ie.useContext(d4),{navigator:p,basename:_}=ie.useContext(Hh),v=g!=null&&ECe(u)&&a===!0,C=p.encodeLocation?p.encodeLocation(u).pathname:u.pathname,y=h.pathname,x=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;t||(y=y.toLowerCase(),x=x?x.toLowerCase():null,C=C.toLowerCase()),x&&_&&(x=gg(x,_)||x);const L=C!=="/"&&C.endsWith("/")?C.length-1:C.length;let I=y===C||!n&&y.startsWith(C)&&y.charAt(L)==="/",A=x!=null&&(x===C||!n&&x.startsWith(C)&&x.charAt(C.length)==="/"),D={isActive:I,isPending:A,isTransitioning:v},N=I?e:void 0,R;typeof i=="function"?R=i(D):R=[i,I?"active":null,A?"pending":null,v?"transitioning":null].filter(Boolean).join(" ");let W=typeof r=="function"?r(D):r;return ie.createElement(xl,{...c,"aria-current":N,className:R,ref:d,style:W,to:o,viewTransition:a},typeof l=="function"?l(D):l)});wCe.displayName="NavLink";var CCe=ie.forwardRef(({discover:s="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:n,state:r,method:o=oR,action:a,onSubmit:l,relative:c,preventScrollReset:d,viewTransition:u,...h},g)=>{let p=kCe(),_=ICe(a,{relative:c}),v=o.toLowerCase()==="get"?"get":"post",C=typeof a=="string"&&Oae.test(a),y=x=>{if(l&&l(x),x.defaultPrevented)return;x.preventDefault();let L=x.nativeEvent.submitter,I=(L==null?void 0:L.getAttribute("formmethod"))||o;p(L||x.currentTarget,{fetcherKey:e,method:I,navigate:t,replace:n,state:r,relative:c,preventScrollReset:d,viewTransition:u})};return ie.createElement("form",{ref:g,method:v,action:_,onSubmit:i?l:y,...h,"data-discover":!C&&s==="render"?"true":void 0})});CCe.displayName="Form";function yCe(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Fae(s){let e=ie.useContext(Z1);return Ss(e,yCe(s)),e}function SCe(s,{target:e,replace:t,state:i,preventScrollReset:n,relative:r,viewTransition:o}={}){let a=l_(),l=a_(),c=EE(s,{relative:r});return ie.useCallback(d=>{if(tCe(d,e)){d.preventDefault();let u=t!==void 0?t:Ak(l)===Ak(c);a(s,{replace:u,state:i,preventScrollReset:n,relative:r,viewTransition:o})}},[l,a,c,t,i,e,s,n,r,o])}var xCe=0,LCe=()=>`__${String(++xCe)}__`;function kCe(){let{router:s}=Fae("useSubmit"),{basename:e}=ie.useContext(Hh),t=$0e();return ie.useCallback(async(i,n={})=>{let{action:r,method:o,encType:a,formData:l,body:c}=sCe(i,e);if(n.navigate===!1){let d=n.fetcherKey||LCe();await s.fetch(d,t,n.action||r,{preventScrollReset:n.preventScrollReset,formData:l,body:c,formMethod:n.method||o,formEncType:n.encType||a,flushSync:n.flushSync})}else await s.navigate(n.action||r,{preventScrollReset:n.preventScrollReset,formData:l,body:c,formMethod:n.method||o,formEncType:n.encType||a,replace:n.replace,state:n.state,fromRouteId:t,flushSync:n.flushSync,viewTransition:n.viewTransition})},[s,e,t])}function ICe(s,{relative:e}={}){let{basename:t}=ie.useContext(Hh),i=ie.useContext(zh);Ss(i,"useFormAction must be used inside a RouteContext");let[n]=i.matches.slice(-1),r={...EE(s||".",{relative:e})},o=a_();if(s==null){r.search=o.search;let a=new URLSearchParams(r.search),l=a.getAll("index");if(l.some(d=>d==="")){a.delete("index"),l.filter(u=>u).forEach(u=>a.append("index",u));let d=a.toString();r.search=d?`?${d}`:""}}return(!s||s===".")&&n.route.index&&(r.search=r.search?r.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(r.pathname=r.pathname==="/"?t:sg([t,r.pathname])),Ak(r)}function ECe(s,e={}){let t=ie.useContext(Eae);Ss(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=Fae("useViewTransitionState"),n=EE(s,{relative:e.relative});if(!t.isTransitioning)return!1;let r=gg(t.currentLocation.pathname,i)||t.currentLocation.pathname,o=gg(t.nextLocation.pathname,i)||t.nextLocation.pathname;return o2(n.pathname,o)!=null||o2(n.pathname,r)!=null}new TextEncoder;const DCe=()=>{};var PZ={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vae=function(s){const e=[];let t=0;for(let i=0;i<s.length;i++){let n=s.charCodeAt(i);n<128?e[t++]=n:n<2048?(e[t++]=n>>6|192,e[t++]=n&63|128):(n&64512)===55296&&i+1<s.length&&(s.charCodeAt(i+1)&64512)===56320?(n=65536+((n&1023)<<10)+(s.charCodeAt(++i)&1023),e[t++]=n>>18|240,e[t++]=n>>12&63|128,e[t++]=n>>6&63|128,e[t++]=n&63|128):(e[t++]=n>>12|224,e[t++]=n>>6&63|128,e[t++]=n&63|128)}return e},TCe=function(s){const e=[];let t=0,i=0;for(;t<s.length;){const n=s[t++];if(n<128)e[i++]=String.fromCharCode(n);else if(n>191&&n<224){const r=s[t++];e[i++]=String.fromCharCode((n&31)<<6|r&63)}else if(n>239&&n<365){const r=s[t++],o=s[t++],a=s[t++],l=((n&7)<<18|(r&63)<<12|(o&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(l>>10)),e[i++]=String.fromCharCode(56320+(l&1023))}else{const r=s[t++],o=s[t++];e[i++]=String.fromCharCode((n&15)<<12|(r&63)<<6|o&63)}}return e.join("")},Bae={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let n=0;n<s.length;n+=3){const r=s[n],o=n+1<s.length,a=o?s[n+1]:0,l=n+2<s.length,c=l?s[n+2]:0,d=r>>2,u=(r&3)<<4|a>>4;let h=(a&15)<<2|c>>6,g=c&63;l||(g=64,o||(h=64)),i.push(t[d],t[u],t[h],t[g])}return i.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(Vae(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):TCe(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let n=0;n<s.length;){const r=t[s.charAt(n++)],a=n<s.length?t[s.charAt(n)]:0;++n;const c=n<s.length?t[s.charAt(n)]:64;++n;const u=n<s.length?t[s.charAt(n)]:64;if(++n,r==null||a==null||c==null||u==null)throw new NCe;const h=r<<2|a>>4;if(i.push(h),c!==64){const g=a<<4&240|c>>2;if(i.push(g),u!==64){const p=c<<6&192|u;i.push(p)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class NCe extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const RCe=function(s){const e=Vae(s);return Bae.encodeByteArray(e,!0)},a2=function(s){return RCe(s).replace(/\./g,"")},Wae=function(s){try{return Bae.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ACe(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PCe=()=>ACe().__FIREBASE_DEFAULTS__,MCe=()=>{if(typeof process>"u"||typeof PZ>"u")return;const s=PZ.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},OCe=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&Wae(s[1]);return e&&JSON.parse(e)},h4=()=>{try{return DCe()||PCe()||MCe()||OCe()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},Hae=s=>{var e,t;return(t=(e=h4())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[s]},zae=s=>{const e=Hae(s);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},Uae=()=>{var s;return(s=h4())===null||s===void 0?void 0:s.config},jae=s=>{var e;return(e=h4())===null||e===void 0?void 0:e[`_${s}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FCe{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $ae(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",n=s.iat||0,r=s.sub||s.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:n,exp:n+3600,auth_time:n,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},s);return[a2(JSON.stringify(t)),a2(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ea(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function VCe(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ea())}function BCe(){var s;const e=(s=h4())===null||s===void 0?void 0:s.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function WCe(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function qae(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function HCe(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function zCe(){const s=ea();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function UCe(){return!BCe()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Kae(){try{return typeof indexedDB=="object"}catch{return!1}}function Gae(){return new Promise((s,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",n=self.indexedDB.open(i);n.onsuccess=()=>{n.result.close(),t||self.indexedDB.deleteDatabase(i),s(!0)},n.onupgradeneeded=()=>{t=!1},n.onerror=()=>{var r;e(((r=n.error)===null||r===void 0?void 0:r.message)||"")}}catch(t){e(t)}})}function jCe(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $Ce="FirebaseError";class fd extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=$Ce,Object.setPrototypeOf(this,fd.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Fw.prototype.create)}}class Fw{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},n=`${this.service}/${e}`,r=this.errors[e],o=r?qCe(r,i):"Error",a=`${this.serviceName}: ${o} (${n}).`;return new fd(n,a,i)}}function qCe(s,e){return s.replace(KCe,(t,i)=>{const n=e[i];return n!=null?String(n):`<${i}?>`})}const KCe=/\{\$([^}]+)}/g;function GCe(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function kh(s,e){if(s===e)return!0;const t=Object.keys(s),i=Object.keys(e);for(const n of t){if(!i.includes(n))return!1;const r=s[n],o=e[n];if(MZ(r)&&MZ(o)){if(!kh(r,o))return!1}else if(r!==o)return!1}for(const n of i)if(!t.includes(n))return!1;return!0}function MZ(s){return s!==null&&typeof s=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DE(s){const e=[];for(const[t,i]of Object.entries(s))Array.isArray(i)?i.forEach(n=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function jx(s){const e={};return s.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[n,r]=i.split("=");e[decodeURIComponent(n)]=decodeURIComponent(r)}}),e}function $x(s){const e=s.indexOf("?");if(!e)return"";const t=s.indexOf("#",e);return s.substring(e,t>0?t:void 0)}function QCe(s,e){const t=new YCe(s,e);return t.subscribe.bind(t)}class YCe{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let n;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");XCe(e,["next","error","complete"])?n=e:n={next:e,error:t,complete:i},n.next===void 0&&(n.next=h9),n.error===void 0&&(n.error=h9),n.complete===void 0&&(n.complete=h9);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?n.error(this.finalError):n.complete()}catch{}}),this.observers.push(n),r}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function XCe(s,e){if(typeof s!="object"||s===null)return!1;for(const t of e)if(t in s&&typeof s[t]=="function")return!0;return!1}function h9(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZCe=1e3,JCe=2,eye=4*60*60*1e3,tye=.5;function OZ(s,e=ZCe,t=JCe){const i=e*Math.pow(t,s),n=Math.round(tye*i*(Math.random()-.5)*2);return Math.min(eye,i+n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cs(s){return s&&s._delegate?s._delegate:s}class nd{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ib="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iye{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new FCe;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&i.resolve(n)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(r){if(n)return null;throw r}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(sye(e))try{this.getOrInitializeService({instanceIdentifier:ib})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const r=this.getOrInitializeService({instanceIdentifier:n});i.resolve(r)}catch{}}}}clearInstance(e=ib){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ib){return this.instances.has(e)}getOptions(e=ib){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const n=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[r,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);i===a&&o.resolve(n)}return n}onInit(e,t){var i;const n=this.normalizeInstanceIdentifier(t),r=(i=this.onInitCallbacks.get(n))!==null&&i!==void 0?i:new Set;r.add(e),this.onInitCallbacks.set(n,r);const o=this.instances.get(n);return o&&e(o,n),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const n of i)try{n(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:nye(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=ib){return this.component?this.component.multipleInstances?e:ib:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function nye(s){return s===ib?void 0:s}function sye(s){return s.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rye{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new iye(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fi;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(Fi||(Fi={}));const oye={debug:Fi.DEBUG,verbose:Fi.VERBOSE,info:Fi.INFO,warn:Fi.WARN,error:Fi.ERROR,silent:Fi.SILENT},aye=Fi.INFO,lye={[Fi.DEBUG]:"log",[Fi.VERBOSE]:"log",[Fi.INFO]:"info",[Fi.WARN]:"warn",[Fi.ERROR]:"error"},cye=(s,e,...t)=>{if(e<s.logLevel)return;const i=new Date().toISOString(),n=lye[e];if(n)console[n](`[${i}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class f4{constructor(e){this.name=e,this._logLevel=aye,this._logHandler=cye,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Fi))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?oye[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Fi.DEBUG,...e),this._logHandler(this,Fi.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Fi.VERBOSE,...e),this._logHandler(this,Fi.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Fi.INFO,...e),this._logHandler(this,Fi.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Fi.WARN,...e),this._logHandler(this,Fi.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Fi.ERROR,...e),this._logHandler(this,Fi.ERROR,...e)}}const dye=(s,e)=>e.some(t=>s instanceof t);let FZ,VZ;function uye(){return FZ||(FZ=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function hye(){return VZ||(VZ=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Qae=new WeakMap,n7=new WeakMap,Yae=new WeakMap,f9=new WeakMap,a$=new WeakMap;function fye(s){const e=new Promise((t,i)=>{const n=()=>{s.removeEventListener("success",r),s.removeEventListener("error",o)},r=()=>{t(tm(s.result)),n()},o=()=>{i(s.error),n()};s.addEventListener("success",r),s.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&Qae.set(t,s)}).catch(()=>{}),a$.set(e,s),e}function gye(s){if(n7.has(s))return;const e=new Promise((t,i)=>{const n=()=>{s.removeEventListener("complete",r),s.removeEventListener("error",o),s.removeEventListener("abort",o)},r=()=>{t(),n()},o=()=>{i(s.error||new DOMException("AbortError","AbortError")),n()};s.addEventListener("complete",r),s.addEventListener("error",o),s.addEventListener("abort",o)});n7.set(s,e)}let s7={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return n7.get(s);if(e==="objectStoreNames")return s.objectStoreNames||Yae.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return tm(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function pye(s){s7=s(s7)}function mye(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=s.call(g9(this),e,...t);return Yae.set(i,e.sort?e.sort():[e]),tm(i)}:hye().includes(s)?function(...e){return s.apply(g9(this),e),tm(Qae.get(this))}:function(...e){return tm(s.apply(g9(this),e))}}function _ye(s){return typeof s=="function"?mye(s):(s instanceof IDBTransaction&&gye(s),dye(s,uye())?new Proxy(s,s7):s)}function tm(s){if(s instanceof IDBRequest)return fye(s);if(f9.has(s))return f9.get(s);const e=_ye(s);return e!==s&&(f9.set(s,e),a$.set(e,s)),e}const g9=s=>a$.get(s);function Xae(s,e,{blocked:t,upgrade:i,blocking:n,terminated:r}={}){const o=indexedDB.open(s,e),a=tm(o);return i&&o.addEventListener("upgradeneeded",l=>{i(tm(o.result),l.oldVersion,l.newVersion,tm(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{r&&l.addEventListener("close",()=>r()),n&&l.addEventListener("versionchange",c=>n(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const bye=["get","getKey","getAll","getAllKeys","count"],vye=["put","add","delete","clear"],p9=new Map;function BZ(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(p9.get(e))return p9.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,n=vye.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(n||bye.includes(t)))return;const r=async function(o,...a){const l=this.transaction(o,n?"readwrite":"readonly");let c=l.store;return i&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),n&&l.done]))[0]};return p9.set(e,r),r}pye(s=>({...s,get:(e,t,i)=>BZ(e,t)||s.get(e,t,i),has:(e,t)=>!!BZ(e,t)||s.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wye{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Cye(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function Cye(s){const e=s.getComponent();return(e==null?void 0:e.type)==="VERSION"}const r7="@firebase/app",WZ="0.11.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pg=new f4("@firebase/app"),yye="@firebase/app-compat",Sye="@firebase/analytics-compat",xye="@firebase/analytics",Lye="@firebase/app-check-compat",kye="@firebase/app-check",Iye="@firebase/auth",Eye="@firebase/auth-compat",Dye="@firebase/database",Tye="@firebase/data-connect",Nye="@firebase/database-compat",Rye="@firebase/functions",Aye="@firebase/functions-compat",Pye="@firebase/installations",Mye="@firebase/installations-compat",Oye="@firebase/messaging",Fye="@firebase/messaging-compat",Vye="@firebase/performance",Bye="@firebase/performance-compat",Wye="@firebase/remote-config",Hye="@firebase/remote-config-compat",zye="@firebase/storage",Uye="@firebase/storage-compat",jye="@firebase/firestore",$ye="@firebase/vertexai",qye="@firebase/firestore-compat",Kye="firebase",Gye="11.5.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o7="[DEFAULT]",Qye={[r7]:"fire-core",[yye]:"fire-core-compat",[xye]:"fire-analytics",[Sye]:"fire-analytics-compat",[kye]:"fire-app-check",[Lye]:"fire-app-check-compat",[Iye]:"fire-auth",[Eye]:"fire-auth-compat",[Dye]:"fire-rtdb",[Tye]:"fire-data-connect",[Nye]:"fire-rtdb-compat",[Rye]:"fire-fn",[Aye]:"fire-fn-compat",[Pye]:"fire-iid",[Mye]:"fire-iid-compat",[Oye]:"fire-fcm",[Fye]:"fire-fcm-compat",[Vye]:"fire-perf",[Bye]:"fire-perf-compat",[Wye]:"fire-rc",[Hye]:"fire-rc-compat",[zye]:"fire-gcs",[Uye]:"fire-gcs-compat",[jye]:"fire-fst",[qye]:"fire-fst-compat",[$ye]:"fire-vertex","fire-js":"fire-js",[Kye]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l2=new Map,Yye=new Map,a7=new Map;function HZ(s,e){try{s.container.addComponent(e)}catch(t){pg.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function lu(s){const e=s.name;if(a7.has(e))return pg.debug(`There were multiple attempts to register component ${e}.`),!1;a7.set(e,s);for(const t of l2.values())HZ(t,s);for(const t of Yye.values())HZ(t,s);return!0}function c_(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}function rc(s){return s==null?!1:s.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xye={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},im=new Fw("app","Firebase",Xye);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zye{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new nd("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw im.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vw=Gye;function Zae(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const i=Object.assign({name:o7,automaticDataCollectionEnabled:!1},e),n=i.name;if(typeof n!="string"||!n)throw im.create("bad-app-name",{appName:String(n)});if(t||(t=Uae()),!t)throw im.create("no-options");const r=l2.get(n);if(r){if(kh(t,r.options)&&kh(i,r.config))return r;throw im.create("duplicate-app",{appName:n})}const o=new rye(n);for(const l of a7.values())o.addComponent(l);const a=new Zye(t,i,o);return l2.set(n,a),a}function g4(s=o7){const e=l2.get(s);if(!e&&s===o7&&Uae())return Zae();if(!e)throw im.create("no-app",{appName:s});return e}function Ll(s,e,t){var i;let n=(i=Qye[s])!==null&&i!==void 0?i:s;t&&(n+=`-${t}`);const r=n.match(/\s|\//),o=e.match(/\s|\//);if(r||o){const a=[`Unable to register library "${n}" with version "${e}":`];r&&a.push(`library name "${n}" contains illegal characters (whitespace or "/")`),r&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),pg.warn(a.join(" "));return}lu(new nd(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jye="firebase-heartbeat-database",e1e=1,Pk="firebase-heartbeat-store";let m9=null;function Jae(){return m9||(m9=Xae(Jye,e1e,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(Pk)}catch(t){console.warn(t)}}}}).catch(s=>{throw im.create("idb-open",{originalErrorMessage:s.message})})),m9}async function t1e(s){try{const t=(await Jae()).transaction(Pk),i=await t.objectStore(Pk).get(ele(s));return await t.done,i}catch(e){if(e instanceof fd)pg.warn(e.message);else{const t=im.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});pg.warn(t.message)}}}async function zZ(s,e){try{const i=(await Jae()).transaction(Pk,"readwrite");await i.objectStore(Pk).put(e,ele(s)),await i.done}catch(t){if(t instanceof fd)pg.warn(t.message);else{const i=im.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});pg.warn(i.message)}}}function ele(s){return`${s.name}!${s.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i1e=1024,n1e=30;class s1e{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new o1e(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=UZ();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(o=>o.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>n1e){const o=a1e(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){pg.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=UZ(),{heartbeatsToSend:i,unsentEntries:n}=r1e(this._heartbeatsCache.heartbeats),r=a2(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(t){return pg.warn(t),""}}}function UZ(){return new Date().toISOString().substring(0,10)}function r1e(s,e=i1e){const t=[];let i=s.slice();for(const n of s){const r=t.find(o=>o.agent===n.agent);if(r){if(r.dates.push(n.date),jZ(t)>e){r.dates.pop();break}}else if(t.push({agent:n.agent,dates:[n.date]}),jZ(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class o1e{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Kae()?Gae().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await t1e(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return zZ(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return zZ(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function jZ(s){return a2(JSON.stringify({version:2,heartbeats:s})).length}function a1e(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let i=1;i<s.length;i++)s[i].date<t&&(t=s[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l1e(s){lu(new nd("platform-logger",e=>new wye(e),"PRIVATE")),lu(new nd("heartbeat",e=>new s1e(e),"PRIVATE")),Ll(r7,WZ,s),Ll(r7,WZ,"esm2017"),Ll("fire-js","")}l1e("");function l$(s,e){var t={};for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&e.indexOf(i)<0&&(t[i]=s[i]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(s);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(s,i[n])&&(t[i[n]]=s[i[n]]);return t}function tle(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const c1e=tle,ile=new Fw("auth","Firebase",tle());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c2=new f4("@firebase/auth");function d1e(s,...e){c2.logLevel<=Fi.WARN&&c2.warn(`Auth (${Vw}): ${s}`,...e)}function lR(s,...e){c2.logLevel<=Fi.ERROR&&c2.error(`Auth (${Vw}): ${s}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sd(s,...e){throw d$(s,...e)}function eu(s,...e){return d$(s,...e)}function c$(s,e,t){const i=Object.assign(Object.assign({},c1e()),{[e]:t});return new Fw("auth","Firebase",i).create(e,{appName:s.name})}function nm(s){return c$(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function u1e(s,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&sd(s,"argument-error"),c$(s,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function d$(s,...e){if(typeof s!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=s.name),s._errorFactory.create(t,...i)}return ile.create(s,...e)}function oi(s,e,...t){if(!s)throw d$(e,...t)}function Hf(s){const e="INTERNAL ASSERTION FAILED: "+s;throw lR(e),new Error(e)}function mg(s,e){s||Hf(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l7(){var s;return typeof self<"u"&&((s=self.location)===null||s===void 0?void 0:s.href)||""}function h1e(){return $Z()==="http:"||$Z()==="https:"}function $Z(){var s;return typeof self<"u"&&((s=self.location)===null||s===void 0?void 0:s.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f1e(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(h1e()||qae()||"connection"in navigator)?navigator.onLine:!0}function g1e(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TE{constructor(e,t){this.shortDelay=e,this.longDelay=t,mg(t>e,"Short delay should be less than long delay!"),this.isMobile=VCe()||HCe()}get(){return f1e()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u$(s,e){mg(s.emulator,"Emulator should always be set here");const{url:t}=s.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nle{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Hf("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Hf("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Hf("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p1e={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m1e=new TE(3e4,6e4);function d_(s,e){return s.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:s.tenantId}):e}async function Ag(s,e,t,i,n={}){return sle(s,n,async()=>{let r={},o={};i&&(e==="GET"?o=i:r={body:JSON.stringify(i)});const a=DE(Object.assign({key:s.config.apiKey},o)).slice(1),l=await s._getAdditionalHeaders();l["Content-Type"]="application/json",s.languageCode&&(l["X-Firebase-Locale"]=s.languageCode);const c=Object.assign({method:e,headers:l},r);return WCe()||(c.referrerPolicy="no-referrer"),nle.fetch()(rle(s,s.config.apiHost,t,a),c)})}async function sle(s,e,t){s._canInitEmulator=!1;const i=Object.assign(Object.assign({},p1e),e);try{const n=new b1e(s),r=await Promise.race([t(),n.promise]);n.clearNetworkTimeout();const o=await r.json();if("needConfirmation"in o)throw FT(s,"account-exists-with-different-credential",o);if(r.ok&&!("errorMessage"in o))return o;{const a=r.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw FT(s,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw FT(s,"email-already-in-use",o);if(l==="USER_DISABLED")throw FT(s,"user-disabled",o);const d=i[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw c$(s,d,c);sd(s,d)}}catch(n){if(n instanceof fd)throw n;sd(s,"network-request-failed",{message:String(n)})}}async function p4(s,e,t,i,n={}){const r=await Ag(s,e,t,i,n);return"mfaPendingCredential"in r&&sd(s,"multi-factor-auth-required",{_serverResponse:r}),r}function rle(s,e,t,i){const n=`${e}${t}?${i}`;return s.config.emulator?u$(s.config,n):`${s.config.apiScheme}://${n}`}function _1e(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class b1e{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(eu(this.auth,"network-request-failed")),m1e.get())})}}function FT(s,e,t){const i={appName:s.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const n=eu(s,e,i);return n.customData._tokenResponse=t,n}function qZ(s){return s!==void 0&&s.enterprise!==void 0}class v1e{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return _1e(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function w1e(s,e){return Ag(s,"GET","/v2/recaptchaConfig",d_(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function C1e(s,e){return Ag(s,"POST","/v1/accounts:delete",e)}async function ole(s,e){return Ag(s,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wL(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function y1e(s,e=!1){const t=cs(s),i=await t.getIdToken(e),n=h$(i);oi(n&&n.exp&&n.auth_time&&n.iat,t.auth,"internal-error");const r=typeof n.firebase=="object"?n.firebase:void 0,o=r==null?void 0:r.sign_in_provider;return{claims:n,token:i,authTime:wL(_9(n.auth_time)),issuedAtTime:wL(_9(n.iat)),expirationTime:wL(_9(n.exp)),signInProvider:o||null,signInSecondFactor:(r==null?void 0:r.sign_in_second_factor)||null}}function _9(s){return Number(s)*1e3}function h$(s){const[e,t,i]=s.split(".");if(e===void 0||t===void 0||i===void 0)return lR("JWT malformed, contained fewer than 3 sections"),null;try{const n=Wae(t);return n?JSON.parse(n):(lR("Failed to decode base64 JWT payload"),null)}catch(n){return lR("Caught error parsing JWT payload as JSON",n==null?void 0:n.toString()),null}}function KZ(s){const e=h$(s);return oi(e,"internal-error"),oi(typeof e.exp<"u","internal-error"),oi(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mk(s,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof fd&&S1e(i)&&s.auth.currentUser===s&&await s.auth.signOut(),i}}function S1e({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x1e{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;const n=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c7{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=wL(this.lastLoginAt),this.creationTime=wL(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function d2(s){var e;const t=s.auth,i=await s.getIdToken(),n=await Mk(s,ole(t,{idToken:i}));oi(n==null?void 0:n.users.length,t,"internal-error");const r=n.users[0];s._notifyReloadListener(r);const o=!((e=r.providerUserInfo)===null||e===void 0)&&e.length?ale(r.providerUserInfo):[],a=k1e(s.providerData,o),l=s.isAnonymous,c=!(s.email&&r.passwordHash)&&!(a!=null&&a.length),d=l?c:!1,u={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:a,metadata:new c7(r.createdAt,r.lastLoginAt),isAnonymous:d};Object.assign(s,u)}async function L1e(s){const e=cs(s);await d2(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function k1e(s,e){return[...s.filter(i=>!e.some(n=>n.providerId===i.providerId)),...e]}function ale(s){return s.map(e=>{var{providerId:t}=e,i=l$(e,["providerId"]);return{providerId:t,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function I1e(s,e){const t=await sle(s,{},async()=>{const i=DE({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:n,apiKey:r}=s.config,o=rle(s,n,"/v1/token",`key=${r}`),a=await s._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",nle.fetch()(o,{method:"POST",headers:a,body:i})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function E1e(s,e){return Ag(s,"POST","/v2/accounts:revokeToken",d_(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cy{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){oi(e.idToken,"internal-error"),oi(typeof e.idToken<"u","internal-error"),oi(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):KZ(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){oi(e.length!==0,"internal-error");const t=KZ(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(oi(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:n,expiresIn:r}=await I1e(e,t);this.updateTokensAndExpiration(i,n,Number(r))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:n,expirationTime:r}=t,o=new cy;return i&&(oi(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),n&&(oi(typeof n=="string","internal-error",{appName:e}),o.accessToken=n),r&&(oi(typeof r=="number","internal-error",{appName:e}),o.expirationTime=r),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new cy,this.toJSON())}_performRefresh(){return Hf("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function up(s,e){oi(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class zf{constructor(e){var{uid:t,auth:i,stsTokenManager:n}=e,r=l$(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new x1e(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=i,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new c7(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await Mk(this,this.stsTokenManager.getToken(this.auth,e));return oi(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return y1e(this,e)}reload(){return L1e(this)}_assign(e){this!==e&&(oi(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new zf(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){oi(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await d2(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(rc(this.auth.app))return Promise.reject(nm(this.auth));const e=await this.getIdToken();return await Mk(this,C1e(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var i,n,r,o,a,l,c,d;const u=(i=t.displayName)!==null&&i!==void 0?i:void 0,h=(n=t.email)!==null&&n!==void 0?n:void 0,g=(r=t.phoneNumber)!==null&&r!==void 0?r:void 0,p=(o=t.photoURL)!==null&&o!==void 0?o:void 0,_=(a=t.tenantId)!==null&&a!==void 0?a:void 0,v=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,C=(c=t.createdAt)!==null&&c!==void 0?c:void 0,y=(d=t.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:x,emailVerified:L,isAnonymous:I,providerData:A,stsTokenManager:D}=t;oi(x&&D,e,"internal-error");const N=cy.fromJSON(this.name,D);oi(typeof x=="string",e,"internal-error"),up(u,e.name),up(h,e.name),oi(typeof L=="boolean",e,"internal-error"),oi(typeof I=="boolean",e,"internal-error"),up(g,e.name),up(p,e.name),up(_,e.name),up(v,e.name),up(C,e.name),up(y,e.name);const R=new zf({uid:x,auth:e,email:h,emailVerified:L,displayName:u,isAnonymous:I,photoURL:p,phoneNumber:g,tenantId:_,stsTokenManager:N,createdAt:C,lastLoginAt:y});return A&&Array.isArray(A)&&(R.providerData=A.map(W=>Object.assign({},W))),v&&(R._redirectEventId=v),R}static async _fromIdTokenResponse(e,t,i=!1){const n=new cy;n.updateFromServerResponse(t);const r=new zf({uid:t.localId,auth:e,stsTokenManager:n,isAnonymous:i});return await d2(r),r}static async _fromGetAccountInfoResponse(e,t,i){const n=t.users[0];oi(n.localId!==void 0,"internal-error");const r=n.providerUserInfo!==void 0?ale(n.providerUserInfo):[],o=!(n.email&&n.passwordHash)&&!(r!=null&&r.length),a=new cy;a.updateFromIdToken(i);const l=new zf({uid:n.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:n.localId,displayName:n.displayName||null,photoURL:n.photoUrl||null,email:n.email||null,emailVerified:n.emailVerified||!1,phoneNumber:n.phoneNumber||null,tenantId:n.tenantId||null,providerData:r,metadata:new c7(n.createdAt,n.lastLoginAt),isAnonymous:!(n.email&&n.passwordHash)&&!(r!=null&&r.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GZ=new Map;function Uf(s){mg(s instanceof Function,"Expected a class definition");let e=GZ.get(s);return e?(mg(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,GZ.set(s,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lle{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}lle.type="NONE";const QZ=lle;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cR(s,e,t){return`firebase:${s}:${e}:${t}`}class dy{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:n,name:r}=this.auth;this.fullUserKey=cR(this.userKey,n.apiKey,r),this.fullPersistenceKey=cR("persistence",n.apiKey,r),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?zf._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new dy(Uf(QZ),e,i);const n=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let r=n[0]||Uf(QZ);const o=cR(i,e.config.apiKey,e.name);let a=null;for(const c of t)try{const d=await c._get(o);if(d){const u=zf._fromJSON(e,d);c!==r&&(a=u),r=c;break}}catch{}const l=n.filter(c=>c._shouldAllowMigration);return!r._shouldAllowMigration||!l.length?new dy(r,e,i):(r=l[0],a&&await r._set(o,a.toJSON()),await Promise.all(t.map(async c=>{if(c!==r)try{await c._remove(o)}catch{}})),new dy(r,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YZ(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(hle(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(cle(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(gle(e))return"Blackberry";if(ple(e))return"Webos";if(dle(e))return"Safari";if((e.includes("chrome/")||ule(e))&&!e.includes("edge/"))return"Chrome";if(fle(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=s.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function cle(s=ea()){return/firefox\//i.test(s)}function dle(s=ea()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function ule(s=ea()){return/crios\//i.test(s)}function hle(s=ea()){return/iemobile/i.test(s)}function fle(s=ea()){return/android/i.test(s)}function gle(s=ea()){return/blackberry/i.test(s)}function ple(s=ea()){return/webos/i.test(s)}function f$(s=ea()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function D1e(s=ea()){var e;return f$(s)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function T1e(){return zCe()&&document.documentMode===10}function mle(s=ea()){return f$(s)||fle(s)||ple(s)||gle(s)||/windows phone/i.test(s)||hle(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _le(s,e=[]){let t;switch(s){case"Browser":t=YZ(ea());break;case"Worker":t=`${YZ(ea())}-${s}`;break;default:t=s}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Vw}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N1e{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=r=>new Promise((o,a)=>{try{const l=e(r);o(l)}catch(l){a(l)}});i.onAbort=t,this.queue.push(i);const n=this.queue.length-1;return()=>{this.queue[n]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const n of t)try{n()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function R1e(s,e={}){return Ag(s,"GET","/v2/passwordPolicy",d_(s,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A1e=6;class P1e{constructor(e){var t,i,n,r;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:A1e,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(n=(i=e.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&n!==void 0?n:"",this.forceUpgradeOnSignin=(r=e.forceUpgradeOnSignin)!==null&&r!==void 0?r:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,i,n,r,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(i=l.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(n=l.containsLowercaseLetter)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(r=l.containsUppercaseLetter)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,n=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),n&&(t.meetsMaxPasswordLength=e.length<=n)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let n=0;n<e.length;n++)i=e.charAt(n),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,n,r){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=n)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M1e{constructor(e,t,i,n){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=n,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new XZ(this),this.idTokenSubscription=new XZ(this),this.beforeStateQueue=new N1e(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ile,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=n.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Uf(t)),this._initializationPromise=this.queue(async()=>{var i,n;if(!this._deleted&&(this.persistenceManager=await dy.create(this,e),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((n=this.currentUser)===null||n===void 0?void 0:n.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await ole(this,{idToken:e}),i=await zf._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(rc(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const i=await this.assertedPersistence.getCurrentUser();let n=i,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=n==null?void 0:n._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(n=l.user,r=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(n)}catch(o){n=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return oi(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await d2(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=g1e()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(rc(this.app))return Promise.reject(nm(this));const t=e?cs(e):null;return t&&oi(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&oi(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return rc(this.app)?Promise.reject(nm(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return rc(this.app)?Promise.reject(nm(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Uf(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await R1e(this),t=new P1e(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Fw("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await E1e(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Uf(e)||this._popupRedirectResolver;oi(t,this,"argument-error"),this.redirectPersistenceManager=await dy.create(this,[Uf(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const i=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,n){if(this._deleted)return()=>{};const r=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(oi(a,this,"internal-error"),a.then(()=>{o||r(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,i,n);return()=>{o=!0,l()}}else{const l=e.addObserver(t);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return oi(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=_le(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const i=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());i&&(t["X-Firebase-Client"]=i);const n=await this._getAppCheckToken();return n&&(t["X-Firebase-AppCheck"]=n),t}async _getAppCheckToken(){var e;if(rc(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&d1e(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function u_(s){return cs(s)}class XZ{constructor(e){this.auth=e,this.observer=null,this.addObserver=QCe(t=>this.observer=t)}get next(){return oi(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let m4={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function O1e(s){m4=s}function ble(s){return m4.loadJS(s)}function F1e(){return m4.recaptchaEnterpriseScript}function V1e(){return m4.gapiScript}function B1e(s){return`__${s}${Math.floor(Math.random()*1e6)}`}class W1e{constructor(){this.enterprise=new H1e}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class H1e{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const z1e="recaptcha-enterprise",vle="NO_RECAPTCHA";class U1e{constructor(e){this.type=z1e,this.auth=u_(e)}async verify(e="verify",t=!1){async function i(r){if(!t){if(r.tenantId==null&&r._agentRecaptchaConfig!=null)return r._agentRecaptchaConfig.siteKey;if(r.tenantId!=null&&r._tenantRecaptchaConfigs[r.tenantId]!==void 0)return r._tenantRecaptchaConfigs[r.tenantId].siteKey}return new Promise(async(o,a)=>{w1e(r,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new v1e(l);return r.tenantId==null?r._agentRecaptchaConfig=c:r._tenantRecaptchaConfigs[r.tenantId]=c,o(c.siteKey)}}).catch(l=>{a(l)})})}function n(r,o,a){const l=window.grecaptcha;qZ(l)?l.enterprise.ready(()=>{l.enterprise.execute(r,{action:e}).then(c=>{o(c)}).catch(()=>{o(vle)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new W1e().execute("siteKey",{action:"verify"}):new Promise((r,o)=>{i(this.auth).then(a=>{if(!t&&qZ(window.grecaptcha))n(a,r,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=F1e();l.length!==0&&(l+=a),ble(l).then(()=>{n(a,r,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}}async function ZZ(s,e,t,i=!1,n=!1){const r=new U1e(s);let o;if(n)o=vle;else try{o=await r.verify(t)}catch{o=await r.verify(t,!0)}const a=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,c=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return i?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function d7(s,e,t,i,n){var r;if(!((r=s._getRecaptchaConfig())===null||r===void 0)&&r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await ZZ(s,e,t,t==="getOobCode");return i(s,o)}else return i(s,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await ZZ(s,e,t,t==="getOobCode");return i(s,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j1e(s,e){const t=c_(s,"auth");if(t.isInitialized()){const n=t.getImmediate(),r=t.getOptions();if(kh(r,e??{}))return n;sd(n,"already-initialized")}return t.initialize({options:e})}function $1e(s,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map(Uf);e!=null&&e.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function q1e(s,e,t){const i=u_(s);oi(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const n=!1,r=wle(e),{host:o,port:a}=K1e(e),l=a===null?"":`:${a}`,c={url:`${r}//${o}${l}/`},d=Object.freeze({host:o,port:a,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:n})});if(!i._canInitEmulator){oi(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),oi(kh(c,i.config.emulator)&&kh(d,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=c,i.emulatorConfig=d,i.settings.appVerificationDisabledForTesting=!0,G1e()}function wle(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function K1e(s){const e=wle(s),t=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",n=/^(\[[^\]]+\])(:|$)/.exec(i);if(n){const r=n[1];return{host:r,port:JZ(i.substr(r.length+1))}}else{const[r,o]=i.split(":");return{host:r,port:JZ(o)}}}function JZ(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function G1e(){function s(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g${constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Hf("not implemented")}_getIdTokenResponse(e){return Hf("not implemented")}_linkToIdToken(e,t){return Hf("not implemented")}_getReauthenticationResolver(e){return Hf("not implemented")}}async function Q1e(s,e){return Ag(s,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Y1e(s,e){return p4(s,"POST","/v1/accounts:signInWithPassword",d_(s,e))}async function X1e(s,e){return Ag(s,"POST","/v1/accounts:sendOobCode",d_(s,e))}async function Z1e(s,e){return X1e(s,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function J1e(s,e){return p4(s,"POST","/v1/accounts:signInWithEmailLink",d_(s,e))}async function eSe(s,e){return p4(s,"POST","/v1/accounts:signInWithEmailLink",d_(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ok extends g${constructor(e,t,i,n=null){super("password",i),this._email=e,this._password=t,this._tenantId=n}static _fromEmailAndPassword(e,t){return new Ok(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new Ok(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return d7(e,t,"signInWithPassword",Y1e);case"emailLink":return J1e(e,{email:this._email,oobCode:this._password});default:sd(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return d7(e,i,"signUpPassword",Q1e);case"emailLink":return eSe(e,{idToken:t,email:this._email,oobCode:this._password});default:sd(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uy(s,e){return p4(s,"POST","/v1/accounts:signInWithIdp",d_(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tSe="http://localhost";class nw extends g${constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new nw(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):sd("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:n}=t,r=l$(t,["providerId","signInMethod"]);if(!i||!n)return null;const o=new nw(i,n);return o.idToken=r.idToken||void 0,o.accessToken=r.accessToken||void 0,o.secret=r.secret,o.nonce=r.nonce,o.pendingToken=r.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return uy(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,uy(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,uy(e,t)}buildRequest(){const e={requestUri:tSe,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=DE(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iSe(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function nSe(s){const e=jx($x(s)).link,t=e?jx($x(e)).deep_link_id:null,i=jx($x(s)).deep_link_id;return(i?jx($x(i)).link:null)||i||t||e||s}class p${constructor(e){var t,i,n,r,o,a;const l=jx($x(e)),c=(t=l.apiKey)!==null&&t!==void 0?t:null,d=(i=l.oobCode)!==null&&i!==void 0?i:null,u=iSe((n=l.mode)!==null&&n!==void 0?n:null);oi(c&&d&&u,"argument-error"),this.apiKey=c,this.operation=u,this.code=d,this.continueUrl=(r=l.continueUrl)!==null&&r!==void 0?r:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const t=nSe(e);try{return new p$(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eS{constructor(){this.providerId=eS.PROVIDER_ID}static credential(e,t){return Ok._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=p$.parseLink(t);return oi(i,"argument-error"),Ok._fromEmailAndCode(e,i.code,i.tenantId)}}eS.PROVIDER_ID="password";eS.EMAIL_PASSWORD_SIGN_IN_METHOD="password";eS.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m${constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NE extends m${constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Af extends NE{constructor(){super("facebook.com")}static credential(e){return nw._fromParams({providerId:Af.PROVIDER_ID,signInMethod:Af.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Af.credentialFromTaggedObject(e)}static credentialFromError(e){return Af.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Af.credential(e.oauthAccessToken)}catch{return null}}}Af.FACEBOOK_SIGN_IN_METHOD="facebook.com";Af.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pf extends NE{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return nw._fromParams({providerId:Pf.PROVIDER_ID,signInMethod:Pf.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Pf.credentialFromTaggedObject(e)}static credentialFromError(e){return Pf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Pf.credential(t,i)}catch{return null}}}Pf.GOOGLE_SIGN_IN_METHOD="google.com";Pf.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mf extends NE{constructor(){super("github.com")}static credential(e){return nw._fromParams({providerId:Mf.PROVIDER_ID,signInMethod:Mf.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Mf.credentialFromTaggedObject(e)}static credentialFromError(e){return Mf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Mf.credential(e.oauthAccessToken)}catch{return null}}}Mf.GITHUB_SIGN_IN_METHOD="github.com";Mf.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tp extends NE{constructor(){super("twitter.com")}static credential(e,t){return nw._fromParams({providerId:Tp.PROVIDER_ID,signInMethod:Tp.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Tp.credentialFromTaggedObject(e)}static credentialFromError(e){return Tp.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Tp.credential(t,i)}catch{return null}}}Tp.TWITTER_SIGN_IN_METHOD="twitter.com";Tp.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xy{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,n=!1){const r=await zf._fromIdTokenResponse(e,i,n),o=eJ(i);return new Xy({user:r,providerId:o,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const n=eJ(i);return new Xy({user:e,providerId:n,_tokenResponse:i,operationType:t})}}function eJ(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u2 extends fd{constructor(e,t,i,n){var r;super(t.code,t.message),this.operationType=i,this.user=n,Object.setPrototypeOf(this,u2.prototype),this.customData={appName:e.name,tenantId:(r=e.tenantId)!==null&&r!==void 0?r:void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,n){return new u2(e,t,i,n)}}function Cle(s,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(s):t._getIdTokenResponse(s)).catch(r=>{throw r.code==="auth/multi-factor-auth-required"?u2._fromErrorAndOperation(s,r,e,i):r})}async function sSe(s,e,t=!1){const i=await Mk(s,e._linkToIdToken(s.auth,await s.getIdToken()),t);return Xy._forOperation(s,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rSe(s,e,t=!1){const{auth:i}=s;if(rc(i.app))return Promise.reject(nm(i));const n="reauthenticate";try{const r=await Mk(s,Cle(i,n,e,s),t);oi(r.idToken,i,"internal-error");const o=h$(r.idToken);oi(o,i,"internal-error");const{sub:a}=o;return oi(s.uid===a,i,"user-mismatch"),Xy._forOperation(s,n,r)}catch(r){throw(r==null?void 0:r.code)==="auth/user-not-found"&&sd(i,"user-mismatch"),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yle(s,e,t=!1){if(rc(s.app))return Promise.reject(nm(s));const i="signIn",n=await Cle(s,i,e),r=await Xy._fromIdTokenResponse(s,i,n);return t||await s._updateCurrentUser(r.user),r}async function oSe(s,e){return yle(u_(s),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aSe(s){const e=u_(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function lSe(s,e,t){const i=u_(s);await d7(i,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",Z1e)}function cSe(s,e,t){return rc(s.app)?Promise.reject(nm(s)):oSe(cs(s),eS.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&aSe(s),i})}function dSe(s,e,t,i){return cs(s).onIdTokenChanged(e,t,i)}function uSe(s,e,t){return cs(s).beforeAuthStateChanged(e,t)}function Sle(s,e,t,i){return cs(s).onAuthStateChanged(e,t,i)}function hSe(s){return cs(s).signOut()}const h2="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xle{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(h2,"1"),this.storage.removeItem(h2),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fSe=1e3,gSe=10;class Lle extends xle{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=mle(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),n=this.localCache[t];i!==n&&e(t,n,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const i=e.key;t?this.detachListener():this.stopPolling();const n=()=>{const o=this.storage.getItem(i);!t&&this.localCache[i]===o||this.notifyListeners(i,o)},r=this.storage.getItem(i);T1e()&&r!==e.newValue&&e.newValue!==e.oldValue?setTimeout(n,gSe):n()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const n of Array.from(i))n(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},fSe)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Lle.type="LOCAL";const pSe=Lle;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kle extends xle{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}kle.type="SESSION";const Ile=kle;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mSe(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _4{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(n=>n.isListeningto(e));if(t)return t;const i=new _4(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:n,data:r}=t.data,o=this.handlersMap[n];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:n});const a=Array.from(o).map(async c=>c(t.origin,r)),l=await mSe(a);t.ports[0].postMessage({status:"done",eventId:i,eventType:n,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}_4.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _$(s="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return s+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _Se{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const n=typeof MessageChannel<"u"?new MessageChannel:null;if(!n)throw new Error("connection_unavailable");let r,o;return new Promise((a,l)=>{const c=_$("",20);n.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},i);o={messageChannel:n,onMessage(u){const h=u;if(h.data.eventId===c)switch(h.data.status){case"ack":clearTimeout(d),r=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(r),a(h.data.response);break;default:clearTimeout(d),clearTimeout(r),l(new Error("invalid_response"));break}}},this.handlers.add(o),n.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[n.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bh(){return window}function bSe(s){bh().location.href=s}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ele(){return typeof bh().WorkerGlobalScope<"u"&&typeof bh().importScripts=="function"}async function vSe(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function wSe(){var s;return((s=navigator==null?void 0:navigator.serviceWorker)===null||s===void 0?void 0:s.controller)||null}function CSe(){return Ele()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dle="firebaseLocalStorageDb",ySe=1,f2="firebaseLocalStorage",Tle="fbase_key";class RE{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function b4(s,e){return s.transaction([f2],e?"readwrite":"readonly").objectStore(f2)}function SSe(){const s=indexedDB.deleteDatabase(Dle);return new RE(s).toPromise()}function u7(){const s=indexedDB.open(Dle,ySe);return new Promise((e,t)=>{s.addEventListener("error",()=>{t(s.error)}),s.addEventListener("upgradeneeded",()=>{const i=s.result;try{i.createObjectStore(f2,{keyPath:Tle})}catch(n){t(n)}}),s.addEventListener("success",async()=>{const i=s.result;i.objectStoreNames.contains(f2)?e(i):(i.close(),await SSe(),e(await u7()))})})}async function tJ(s,e,t){const i=b4(s,!0).put({[Tle]:e,value:t});return new RE(i).toPromise()}async function xSe(s,e){const t=b4(s,!1).get(e),i=await new RE(t).toPromise();return i===void 0?null:i.value}function iJ(s,e){const t=b4(s,!0).delete(e);return new RE(t).toPromise()}const LSe=800,kSe=3;class Nle{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await u7(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>kSe)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Ele()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=_4._getInstance(CSe()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await vSe(),!this.activeServiceWorker)return;this.sender=new _Se(this.activeServiceWorker);const i=await this.sender._send("ping",{},800);i&&!((e=i[0])===null||e===void 0)&&e.fulfilled&&!((t=i[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||wSe()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await u7();return await tJ(e,h2,"1"),await iJ(e,h2),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>tJ(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>xSe(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>iJ(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(n=>{const r=b4(n,!1).getAll();return new RE(r).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:n,value:r}of e)i.add(n),JSON.stringify(this.localCache[n])!==JSON.stringify(r)&&(this.notifyListeners(n,r),t.push(n));for(const n of Object.keys(this.localCache))this.localCache[n]&&!i.has(n)&&(this.notifyListeners(n,null),t.push(n));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const n of Array.from(i))n(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),LSe)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Nle.type="LOCAL";const ISe=Nle;new TE(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rle(s,e){return e?Uf(e):(oi(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b$ extends g${constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return uy(e,this._buildIdpRequest())}_linkToIdToken(e,t){return uy(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return uy(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function ESe(s){return yle(s.auth,new b$(s),s.bypassAuthState)}function DSe(s){const{auth:e,user:t}=s;return oi(t,e,"internal-error"),rSe(t,new b$(s),s.bypassAuthState)}async function TSe(s){const{auth:e,user:t}=s;return oi(t,e,"internal-error"),sSe(t,new b$(s),s.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ale{constructor(e,t,i,n,r=!1){this.auth=e,this.resolver=i,this.user=n,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:n,tenantId:r,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:t,sessionId:i,tenantId:r||void 0,postBody:n||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return ESe;case"linkViaPopup":case"linkViaRedirect":return TSe;case"reauthViaPopup":case"reauthViaRedirect":return DSe;default:sd(this.auth,"internal-error")}}resolve(e){mg(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){mg(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NSe=new TE(2e3,1e4);async function b9(s,e,t){if(rc(s.app))return Promise.reject(eu(s,"operation-not-supported-in-this-environment"));const i=u_(s);u1e(s,e,m$);const n=Rle(i,t);return new Mb(i,"signInViaPopup",e,n).executeNotNull()}class Mb extends Ale{constructor(e,t,i,n,r){super(e,t,n,r),this.provider=i,this.authWindow=null,this.pollId=null,Mb.currentPopupAction&&Mb.currentPopupAction.cancel(),Mb.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return oi(e,this.auth,"internal-error"),e}async onExecution(){mg(this.filter.length===1,"Popup operations only handle one event");const e=_$();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(eu(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(eu(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Mb.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if(!((i=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(eu(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,NSe.get())};e()}}Mb.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RSe="pendingRedirect",dR=new Map;class ASe extends Ale{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=dR.get(this.auth._key());if(!e){try{const i=await PSe(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}dR.set(this.auth._key(),e)}return this.bypassAuthState||dR.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function PSe(s,e){const t=FSe(e),i=OSe(s);if(!await i._isAvailable())return!1;const n=await i._get(t)==="true";return await i._remove(t),n}function MSe(s,e){dR.set(s._key(),e)}function OSe(s){return Uf(s._redirectPersistence)}function FSe(s){return cR(RSe,s.config.apiKey,s.name)}async function VSe(s,e,t=!1){if(rc(s.app))return Promise.reject(nm(s));const i=u_(s),n=Rle(i,e),o=await new ASe(i,n,t).execute();return o&&!t&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BSe=10*60*1e3;class WSe{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!HSe(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!Ple(e)){const n=((i=e.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";t.onError(eu(this.auth,n))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=BSe&&this.cachedEventUids.clear(),this.cachedEventUids.has(nJ(e))}saveEventToCache(e){this.cachedEventUids.add(nJ(e)),this.lastProcessedEventTime=Date.now()}}function nJ(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function Ple({type:s,error:e}){return s==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function HSe(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ple(s);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zSe(s,e={}){return Ag(s,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const USe=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,jSe=/^https?/;async function $Se(s){if(s.config.emulator)return;const{authorizedDomains:e}=await zSe(s);for(const t of e)try{if(qSe(t))return}catch{}sd(s,"unauthorized-domain")}function qSe(s){const e=l7(),{protocol:t,hostname:i}=new URL(e);if(s.startsWith("chrome-extension://")){const o=new URL(s);return o.hostname===""&&i===""?t==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===i}if(!jSe.test(t))return!1;if(USe.test(s))return i===s;const n=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+n+"|"+n+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KSe=new TE(3e4,6e4);function sJ(){const s=bh().___jsl;if(s!=null&&s.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let t=0;t<s.CP.length;t++)s.CP[t]=null}}function GSe(s){return new Promise((e,t)=>{var i,n,r;function o(){sJ(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{sJ(),t(eu(s,"network-request-failed"))},timeout:KSe.get()})}if(!((n=(i=bh().gapi)===null||i===void 0?void 0:i.iframes)===null||n===void 0)&&n.Iframe)e(gapi.iframes.getContext());else if(!((r=bh().gapi)===null||r===void 0)&&r.load)o();else{const a=B1e("iframefcb");return bh()[a]=()=>{gapi.load?o():t(eu(s,"network-request-failed"))},ble(`${V1e()}?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw uR=null,e})}let uR=null;function QSe(s){return uR=uR||GSe(s),uR}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YSe=new TE(5e3,15e3),XSe="__/auth/iframe",ZSe="emulator/auth/iframe",JSe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},exe=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function txe(s){const e=s.config;oi(e.authDomain,s,"auth-domain-config-required");const t=e.emulator?u$(e,ZSe):`https://${s.config.authDomain}/${XSe}`,i={apiKey:e.apiKey,appName:s.name,v:Vw},n=exe.get(s.config.apiHost);n&&(i.eid=n);const r=s._getFrameworks();return r.length&&(i.fw=r.join(",")),`${t}?${DE(i).slice(1)}`}async function ixe(s){const e=await QSe(s),t=bh().gapi;return oi(t,s,"internal-error"),e.open({where:document.body,url:txe(s),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:JSe,dontclear:!0},i=>new Promise(async(n,r)=>{await i.restyle({setHideOnLeave:!1});const o=eu(s,"network-request-failed"),a=bh().setTimeout(()=>{r(o)},YSe.get());function l(){bh().clearTimeout(a),n(i)}i.ping(l).then(l,()=>{r(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nxe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},sxe=500,rxe=600,oxe="_blank",axe="http://localhost";class rJ{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function lxe(s,e,t,i=sxe,n=rxe){const r=Math.max((window.screen.availHeight-n)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const l=Object.assign(Object.assign({},nxe),{width:i.toString(),height:n.toString(),top:r,left:o}),c=ea().toLowerCase();t&&(a=ule(c)?oxe:t),cle(c)&&(e=e||axe,l.scrollbars="yes");const d=Object.entries(l).reduce((h,[g,p])=>`${h}${g}=${p},`,"");if(D1e(c)&&a!=="_self")return cxe(e||"",a),new rJ(null);const u=window.open(e||"",a,d);oi(u,s,"popup-blocked");try{u.focus()}catch{}return new rJ(u)}function cxe(s,e){const t=document.createElement("a");t.href=s,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dxe="__/auth/handler",uxe="emulator/auth/handler",hxe=encodeURIComponent("fac");async function oJ(s,e,t,i,n,r){oi(s.config.authDomain,s,"auth-domain-config-required"),oi(s.config.apiKey,s,"invalid-api-key");const o={apiKey:s.config.apiKey,appName:s.name,authType:t,redirectUrl:i,v:Vw,eventId:n};if(e instanceof m$){e.setDefaultLanguage(s.languageCode),o.providerId=e.providerId||"",GCe(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,u]of Object.entries({}))o[d]=u}if(e instanceof NE){const d=e.getScopes().filter(u=>u!=="");d.length>0&&(o.scopes=d.join(","))}s.tenantId&&(o.tid=s.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const l=await s._getAppCheckToken(),c=l?`#${hxe}=${encodeURIComponent(l)}`:"";return`${fxe(s)}?${DE(a).slice(1)}${c}`}function fxe({config:s}){return s.emulator?u$(s,uxe):`https://${s.authDomain}/${dxe}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v9="webStorageSupport";class gxe{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ile,this._completeRedirectFn=VSe,this._overrideRedirectResult=MSe}async _openPopup(e,t,i,n){var r;mg((r=this.eventManagers[e._key()])===null||r===void 0?void 0:r.manager,"_initialize() not called before _openPopup()");const o=await oJ(e,t,i,l7(),n);return lxe(e,o,_$())}async _openRedirect(e,t,i,n){await this._originValidation(e);const r=await oJ(e,t,i,l7(),n);return bSe(r),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:n,promise:r}=this.eventManagers[t];return n?Promise.resolve(n):(mg(r,"If manager is not set, promise should be"),r)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await ixe(e),i=new WSe(e);return t.register("authEvent",n=>(oi(n==null?void 0:n.authEvent,e,"invalid-auth-event"),{status:i.onEvent(n.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(v9,{type:v9},n=>{var r;const o=(r=n==null?void 0:n[0])===null||r===void 0?void 0:r[v9];o!==void 0&&t(!!o),sd(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=$Se(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return mle()||dle()||f$()}}const pxe=gxe;var aJ="@firebase/auth",lJ="1.9.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mxe{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){oi(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _xe(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function bxe(s){lu(new nd("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),n=e.getProvider("heartbeat"),r=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=i.options;oi(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const l={apiKey:o,authDomain:a,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:_le(s)},c=new M1e(i,n,r,l);return $1e(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),lu(new nd("auth-internal",e=>{const t=u_(e.getProvider("auth").getImmediate());return(i=>new mxe(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ll(aJ,lJ,_xe(s)),Ll(aJ,lJ,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vxe=5*60,wxe=jae("authIdTokenMaxAge")||vxe;let cJ=null;const Cxe=s=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>wxe)return;const n=t==null?void 0:t.token;cJ!==n&&(cJ=n,await fetch(s,{method:n?"POST":"DELETE",headers:n?{Authorization:`Bearer ${n}`}:{}}))};function Mle(s=g4()){const e=c_(s,"auth");if(e.isInitialized())return e.getImmediate();const t=j1e(s,{popupRedirectResolver:pxe,persistence:[ISe,pSe,Ile]}),i=jae("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const r=new URL(i,location.origin);if(location.origin===r.origin){const o=Cxe(r.toString());uSe(t,o,()=>o(t.currentUser)),dSe(t,a=>o(a))}}const n=Hae("auth");return n&&q1e(t,`http://${n}`),t}function yxe(){var s,e;return(e=(s=document.getElementsByTagName("head"))===null||s===void 0?void 0:s[0])!==null&&e!==void 0?e:document}O1e({loadJS(s){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",s),i.onload=e,i.onerror=n=>{const r=eu("internal-error");r.customData=n,t(r)},i.type="text/javascript",i.charset="UTF-8",yxe().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});bxe("Browser");var Sxe="firebase",xxe="11.5.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ll(Sxe,xxe,"app");var dJ=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var sm,Ole;(function(){var s;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(D,N){function R(){}R.prototype=N.prototype,D.D=N.prototype,D.prototype=new R,D.prototype.constructor=D,D.C=function(W,H,U){for(var B=Array(arguments.length-2),ee=2;ee<arguments.length;ee++)B[ee-2]=arguments[ee];return N.prototype[H].apply(W,B)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,t),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function n(D,N,R){R||(R=0);var W=Array(16);if(typeof N=="string")for(var H=0;16>H;++H)W[H]=N.charCodeAt(R++)|N.charCodeAt(R++)<<8|N.charCodeAt(R++)<<16|N.charCodeAt(R++)<<24;else for(H=0;16>H;++H)W[H]=N[R++]|N[R++]<<8|N[R++]<<16|N[R++]<<24;N=D.g[0],R=D.g[1],H=D.g[2];var U=D.g[3],B=N+(U^R&(H^U))+W[0]+3614090360&4294967295;N=R+(B<<7&4294967295|B>>>25),B=U+(H^N&(R^H))+W[1]+3905402710&4294967295,U=N+(B<<12&4294967295|B>>>20),B=H+(R^U&(N^R))+W[2]+606105819&4294967295,H=U+(B<<17&4294967295|B>>>15),B=R+(N^H&(U^N))+W[3]+3250441966&4294967295,R=H+(B<<22&4294967295|B>>>10),B=N+(U^R&(H^U))+W[4]+4118548399&4294967295,N=R+(B<<7&4294967295|B>>>25),B=U+(H^N&(R^H))+W[5]+1200080426&4294967295,U=N+(B<<12&4294967295|B>>>20),B=H+(R^U&(N^R))+W[6]+2821735955&4294967295,H=U+(B<<17&4294967295|B>>>15),B=R+(N^H&(U^N))+W[7]+4249261313&4294967295,R=H+(B<<22&4294967295|B>>>10),B=N+(U^R&(H^U))+W[8]+1770035416&4294967295,N=R+(B<<7&4294967295|B>>>25),B=U+(H^N&(R^H))+W[9]+2336552879&4294967295,U=N+(B<<12&4294967295|B>>>20),B=H+(R^U&(N^R))+W[10]+4294925233&4294967295,H=U+(B<<17&4294967295|B>>>15),B=R+(N^H&(U^N))+W[11]+2304563134&4294967295,R=H+(B<<22&4294967295|B>>>10),B=N+(U^R&(H^U))+W[12]+1804603682&4294967295,N=R+(B<<7&4294967295|B>>>25),B=U+(H^N&(R^H))+W[13]+4254626195&4294967295,U=N+(B<<12&4294967295|B>>>20),B=H+(R^U&(N^R))+W[14]+2792965006&4294967295,H=U+(B<<17&4294967295|B>>>15),B=R+(N^H&(U^N))+W[15]+1236535329&4294967295,R=H+(B<<22&4294967295|B>>>10),B=N+(H^U&(R^H))+W[1]+4129170786&4294967295,N=R+(B<<5&4294967295|B>>>27),B=U+(R^H&(N^R))+W[6]+3225465664&4294967295,U=N+(B<<9&4294967295|B>>>23),B=H+(N^R&(U^N))+W[11]+643717713&4294967295,H=U+(B<<14&4294967295|B>>>18),B=R+(U^N&(H^U))+W[0]+3921069994&4294967295,R=H+(B<<20&4294967295|B>>>12),B=N+(H^U&(R^H))+W[5]+3593408605&4294967295,N=R+(B<<5&4294967295|B>>>27),B=U+(R^H&(N^R))+W[10]+38016083&4294967295,U=N+(B<<9&4294967295|B>>>23),B=H+(N^R&(U^N))+W[15]+3634488961&4294967295,H=U+(B<<14&4294967295|B>>>18),B=R+(U^N&(H^U))+W[4]+3889429448&4294967295,R=H+(B<<20&4294967295|B>>>12),B=N+(H^U&(R^H))+W[9]+568446438&4294967295,N=R+(B<<5&4294967295|B>>>27),B=U+(R^H&(N^R))+W[14]+3275163606&4294967295,U=N+(B<<9&4294967295|B>>>23),B=H+(N^R&(U^N))+W[3]+4107603335&4294967295,H=U+(B<<14&4294967295|B>>>18),B=R+(U^N&(H^U))+W[8]+1163531501&4294967295,R=H+(B<<20&4294967295|B>>>12),B=N+(H^U&(R^H))+W[13]+2850285829&4294967295,N=R+(B<<5&4294967295|B>>>27),B=U+(R^H&(N^R))+W[2]+4243563512&4294967295,U=N+(B<<9&4294967295|B>>>23),B=H+(N^R&(U^N))+W[7]+1735328473&4294967295,H=U+(B<<14&4294967295|B>>>18),B=R+(U^N&(H^U))+W[12]+2368359562&4294967295,R=H+(B<<20&4294967295|B>>>12),B=N+(R^H^U)+W[5]+4294588738&4294967295,N=R+(B<<4&4294967295|B>>>28),B=U+(N^R^H)+W[8]+2272392833&4294967295,U=N+(B<<11&4294967295|B>>>21),B=H+(U^N^R)+W[11]+1839030562&4294967295,H=U+(B<<16&4294967295|B>>>16),B=R+(H^U^N)+W[14]+4259657740&4294967295,R=H+(B<<23&4294967295|B>>>9),B=N+(R^H^U)+W[1]+2763975236&4294967295,N=R+(B<<4&4294967295|B>>>28),B=U+(N^R^H)+W[4]+1272893353&4294967295,U=N+(B<<11&4294967295|B>>>21),B=H+(U^N^R)+W[7]+4139469664&4294967295,H=U+(B<<16&4294967295|B>>>16),B=R+(H^U^N)+W[10]+3200236656&4294967295,R=H+(B<<23&4294967295|B>>>9),B=N+(R^H^U)+W[13]+681279174&4294967295,N=R+(B<<4&4294967295|B>>>28),B=U+(N^R^H)+W[0]+3936430074&4294967295,U=N+(B<<11&4294967295|B>>>21),B=H+(U^N^R)+W[3]+3572445317&4294967295,H=U+(B<<16&4294967295|B>>>16),B=R+(H^U^N)+W[6]+76029189&4294967295,R=H+(B<<23&4294967295|B>>>9),B=N+(R^H^U)+W[9]+3654602809&4294967295,N=R+(B<<4&4294967295|B>>>28),B=U+(N^R^H)+W[12]+3873151461&4294967295,U=N+(B<<11&4294967295|B>>>21),B=H+(U^N^R)+W[15]+530742520&4294967295,H=U+(B<<16&4294967295|B>>>16),B=R+(H^U^N)+W[2]+3299628645&4294967295,R=H+(B<<23&4294967295|B>>>9),B=N+(H^(R|~U))+W[0]+4096336452&4294967295,N=R+(B<<6&4294967295|B>>>26),B=U+(R^(N|~H))+W[7]+1126891415&4294967295,U=N+(B<<10&4294967295|B>>>22),B=H+(N^(U|~R))+W[14]+2878612391&4294967295,H=U+(B<<15&4294967295|B>>>17),B=R+(U^(H|~N))+W[5]+4237533241&4294967295,R=H+(B<<21&4294967295|B>>>11),B=N+(H^(R|~U))+W[12]+1700485571&4294967295,N=R+(B<<6&4294967295|B>>>26),B=U+(R^(N|~H))+W[3]+2399980690&4294967295,U=N+(B<<10&4294967295|B>>>22),B=H+(N^(U|~R))+W[10]+4293915773&4294967295,H=U+(B<<15&4294967295|B>>>17),B=R+(U^(H|~N))+W[1]+2240044497&4294967295,R=H+(B<<21&4294967295|B>>>11),B=N+(H^(R|~U))+W[8]+1873313359&4294967295,N=R+(B<<6&4294967295|B>>>26),B=U+(R^(N|~H))+W[15]+4264355552&4294967295,U=N+(B<<10&4294967295|B>>>22),B=H+(N^(U|~R))+W[6]+2734768916&4294967295,H=U+(B<<15&4294967295|B>>>17),B=R+(U^(H|~N))+W[13]+1309151649&4294967295,R=H+(B<<21&4294967295|B>>>11),B=N+(H^(R|~U))+W[4]+4149444226&4294967295,N=R+(B<<6&4294967295|B>>>26),B=U+(R^(N|~H))+W[11]+3174756917&4294967295,U=N+(B<<10&4294967295|B>>>22),B=H+(N^(U|~R))+W[2]+718787259&4294967295,H=U+(B<<15&4294967295|B>>>17),B=R+(U^(H|~N))+W[9]+3951481745&4294967295,D.g[0]=D.g[0]+N&4294967295,D.g[1]=D.g[1]+(H+(B<<21&4294967295|B>>>11))&4294967295,D.g[2]=D.g[2]+H&4294967295,D.g[3]=D.g[3]+U&4294967295}i.prototype.u=function(D,N){N===void 0&&(N=D.length);for(var R=N-this.blockSize,W=this.B,H=this.h,U=0;U<N;){if(H==0)for(;U<=R;)n(this,D,U),U+=this.blockSize;if(typeof D=="string"){for(;U<N;)if(W[H++]=D.charCodeAt(U++),H==this.blockSize){n(this,W),H=0;break}}else for(;U<N;)if(W[H++]=D[U++],H==this.blockSize){n(this,W),H=0;break}}this.h=H,this.o+=N},i.prototype.v=function(){var D=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);D[0]=128;for(var N=1;N<D.length-8;++N)D[N]=0;var R=8*this.o;for(N=D.length-8;N<D.length;++N)D[N]=R&255,R/=256;for(this.u(D),D=Array(16),N=R=0;4>N;++N)for(var W=0;32>W;W+=8)D[R++]=this.g[N]>>>W&255;return D};function r(D,N){var R=a;return Object.prototype.hasOwnProperty.call(R,D)?R[D]:R[D]=N(D)}function o(D,N){this.h=N;for(var R=[],W=!0,H=D.length-1;0<=H;H--){var U=D[H]|0;W&&U==N||(R[H]=U,W=!1)}this.g=R}var a={};function l(D){return-128<=D&&128>D?r(D,function(N){return new o([N|0],0>N?-1:0)}):new o([D|0],0>D?-1:0)}function c(D){if(isNaN(D)||!isFinite(D))return u;if(0>D)return v(c(-D));for(var N=[],R=1,W=0;D>=R;W++)N[W]=D/R|0,R*=4294967296;return new o(N,0)}function d(D,N){if(D.length==0)throw Error("number format error: empty string");if(N=N||10,2>N||36<N)throw Error("radix out of range: "+N);if(D.charAt(0)=="-")return v(d(D.substring(1),N));if(0<=D.indexOf("-"))throw Error('number format error: interior "-" character');for(var R=c(Math.pow(N,8)),W=u,H=0;H<D.length;H+=8){var U=Math.min(8,D.length-H),B=parseInt(D.substring(H,H+U),N);8>U?(U=c(Math.pow(N,U)),W=W.j(U).add(c(B))):(W=W.j(R),W=W.add(c(B)))}return W}var u=l(0),h=l(1),g=l(16777216);s=o.prototype,s.m=function(){if(_(this))return-v(this).m();for(var D=0,N=1,R=0;R<this.g.length;R++){var W=this.i(R);D+=(0<=W?W:4294967296+W)*N,N*=4294967296}return D},s.toString=function(D){if(D=D||10,2>D||36<D)throw Error("radix out of range: "+D);if(p(this))return"0";if(_(this))return"-"+v(this).toString(D);for(var N=c(Math.pow(D,6)),R=this,W="";;){var H=L(R,N).g;R=C(R,H.j(N));var U=((0<R.g.length?R.g[0]:R.h)>>>0).toString(D);if(R=H,p(R))return U+W;for(;6>U.length;)U="0"+U;W=U+W}},s.i=function(D){return 0>D?0:D<this.g.length?this.g[D]:this.h};function p(D){if(D.h!=0)return!1;for(var N=0;N<D.g.length;N++)if(D.g[N]!=0)return!1;return!0}function _(D){return D.h==-1}s.l=function(D){return D=C(this,D),_(D)?-1:p(D)?0:1};function v(D){for(var N=D.g.length,R=[],W=0;W<N;W++)R[W]=~D.g[W];return new o(R,~D.h).add(h)}s.abs=function(){return _(this)?v(this):this},s.add=function(D){for(var N=Math.max(this.g.length,D.g.length),R=[],W=0,H=0;H<=N;H++){var U=W+(this.i(H)&65535)+(D.i(H)&65535),B=(U>>>16)+(this.i(H)>>>16)+(D.i(H)>>>16);W=B>>>16,U&=65535,B&=65535,R[H]=B<<16|U}return new o(R,R[R.length-1]&-2147483648?-1:0)};function C(D,N){return D.add(v(N))}s.j=function(D){if(p(this)||p(D))return u;if(_(this))return _(D)?v(this).j(v(D)):v(v(this).j(D));if(_(D))return v(this.j(v(D)));if(0>this.l(g)&&0>D.l(g))return c(this.m()*D.m());for(var N=this.g.length+D.g.length,R=[],W=0;W<2*N;W++)R[W]=0;for(W=0;W<this.g.length;W++)for(var H=0;H<D.g.length;H++){var U=this.i(W)>>>16,B=this.i(W)&65535,ee=D.i(H)>>>16,re=D.i(H)&65535;R[2*W+2*H]+=B*re,y(R,2*W+2*H),R[2*W+2*H+1]+=U*re,y(R,2*W+2*H+1),R[2*W+2*H+1]+=B*ee,y(R,2*W+2*H+1),R[2*W+2*H+2]+=U*ee,y(R,2*W+2*H+2)}for(W=0;W<N;W++)R[W]=R[2*W+1]<<16|R[2*W];for(W=N;W<2*N;W++)R[W]=0;return new o(R,0)};function y(D,N){for(;(D[N]&65535)!=D[N];)D[N+1]+=D[N]>>>16,D[N]&=65535,N++}function x(D,N){this.g=D,this.h=N}function L(D,N){if(p(N))throw Error("division by zero");if(p(D))return new x(u,u);if(_(D))return N=L(v(D),N),new x(v(N.g),v(N.h));if(_(N))return N=L(D,v(N)),new x(v(N.g),N.h);if(30<D.g.length){if(_(D)||_(N))throw Error("slowDivide_ only works with positive integers.");for(var R=h,W=N;0>=W.l(D);)R=I(R),W=I(W);var H=A(R,1),U=A(W,1);for(W=A(W,2),R=A(R,2);!p(W);){var B=U.add(W);0>=B.l(D)&&(H=H.add(R),U=B),W=A(W,1),R=A(R,1)}return N=C(D,H.j(N)),new x(H,N)}for(H=u;0<=D.l(N);){for(R=Math.max(1,Math.floor(D.m()/N.m())),W=Math.ceil(Math.log(R)/Math.LN2),W=48>=W?1:Math.pow(2,W-48),U=c(R),B=U.j(N);_(B)||0<B.l(D);)R-=W,U=c(R),B=U.j(N);p(U)&&(U=h),H=H.add(U),D=C(D,B)}return new x(H,D)}s.A=function(D){return L(this,D).h},s.and=function(D){for(var N=Math.max(this.g.length,D.g.length),R=[],W=0;W<N;W++)R[W]=this.i(W)&D.i(W);return new o(R,this.h&D.h)},s.or=function(D){for(var N=Math.max(this.g.length,D.g.length),R=[],W=0;W<N;W++)R[W]=this.i(W)|D.i(W);return new o(R,this.h|D.h)},s.xor=function(D){for(var N=Math.max(this.g.length,D.g.length),R=[],W=0;W<N;W++)R[W]=this.i(W)^D.i(W);return new o(R,this.h^D.h)};function I(D){for(var N=D.g.length+1,R=[],W=0;W<N;W++)R[W]=D.i(W)<<1|D.i(W-1)>>>31;return new o(R,D.h)}function A(D,N){var R=N>>5;N%=32;for(var W=D.g.length-R,H=[],U=0;U<W;U++)H[U]=0<N?D.i(U+R)>>>N|D.i(U+R+1)<<32-N:D.i(U+R);return new o(H,D.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,Ole=i,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=d,sm=o}).apply(typeof dJ<"u"?dJ:typeof self<"u"?self:typeof window<"u"?window:{});var VT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Fle,qx,Vle,hR,h7,Ble,Wle,Hle;(function(){var s,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(S,P,V){return S==Array.prototype||S==Object.prototype||(S[P]=V.value),S};function t(S){S=[typeof globalThis=="object"&&globalThis,S,typeof window=="object"&&window,typeof self=="object"&&self,typeof VT=="object"&&VT];for(var P=0;P<S.length;++P){var V=S[P];if(V&&V.Math==Math)return V}throw Error("Cannot find global object")}var i=t(this);function n(S,P){if(P)e:{var V=i;S=S.split(".");for(var G=0;G<S.length-1;G++){var ve=S[G];if(!(ve in V))break e;V=V[ve]}S=S[S.length-1],G=V[S],P=P(G),P!=G&&P!=null&&e(V,S,{configurable:!0,writable:!0,value:P})}}function r(S,P){S instanceof String&&(S+="");var V=0,G=!1,ve={next:function(){if(!G&&V<S.length){var Pe=V++;return{value:P(Pe,S[Pe]),done:!1}}return G=!0,{done:!0,value:void 0}}};return ve[Symbol.iterator]=function(){return ve},ve}n("Array.prototype.values",function(S){return S||function(){return r(this,function(P,V){return V})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(S){var P=typeof S;return P=P!="object"?P:S?Array.isArray(S)?"array":P:"null",P=="array"||P=="object"&&typeof S.length=="number"}function c(S){var P=typeof S;return P=="object"&&S!=null||P=="function"}function d(S,P,V){return S.call.apply(S.bind,arguments)}function u(S,P,V){if(!S)throw Error();if(2<arguments.length){var G=Array.prototype.slice.call(arguments,2);return function(){var ve=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ve,G),S.apply(P,ve)}}return function(){return S.apply(P,arguments)}}function h(S,P,V){return h=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:u,h.apply(null,arguments)}function g(S,P){var V=Array.prototype.slice.call(arguments,1);return function(){var G=V.slice();return G.push.apply(G,arguments),S.apply(this,G)}}function p(S,P){function V(){}V.prototype=P.prototype,S.aa=P.prototype,S.prototype=new V,S.prototype.constructor=S,S.Qb=function(G,ve,Pe){for(var lt=Array(arguments.length-2),Tn=2;Tn<arguments.length;Tn++)lt[Tn-2]=arguments[Tn];return P.prototype[ve].apply(G,lt)}}function _(S){const P=S.length;if(0<P){const V=Array(P);for(let G=0;G<P;G++)V[G]=S[G];return V}return[]}function v(S,P){for(let V=1;V<arguments.length;V++){const G=arguments[V];if(l(G)){const ve=S.length||0,Pe=G.length||0;S.length=ve+Pe;for(let lt=0;lt<Pe;lt++)S[ve+lt]=G[lt]}else S.push(G)}}class C{constructor(P,V){this.i=P,this.j=V,this.h=0,this.g=null}get(){let P;return 0<this.h?(this.h--,P=this.g,this.g=P.next,P.next=null):P=this.i(),P}}function y(S){return/^[\s\xa0]*$/.test(S)}function x(){var S=a.navigator;return S&&(S=S.userAgent)?S:""}function L(S){return L[" "](S),S}L[" "]=function(){};var I=x().indexOf("Gecko")!=-1&&!(x().toLowerCase().indexOf("webkit")!=-1&&x().indexOf("Edge")==-1)&&!(x().indexOf("Trident")!=-1||x().indexOf("MSIE")!=-1)&&x().indexOf("Edge")==-1;function A(S,P,V){for(const G in S)P.call(V,S[G],G,S)}function D(S,P){for(const V in S)P.call(void 0,S[V],V,S)}function N(S){const P={};for(const V in S)P[V]=S[V];return P}const R="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function W(S,P){let V,G;for(let ve=1;ve<arguments.length;ve++){G=arguments[ve];for(V in G)S[V]=G[V];for(let Pe=0;Pe<R.length;Pe++)V=R[Pe],Object.prototype.hasOwnProperty.call(G,V)&&(S[V]=G[V])}}function H(S){var P=1;S=S.split(":");const V=[];for(;0<P&&S.length;)V.push(S.shift()),P--;return S.length&&V.push(S.join(":")),V}function U(S){a.setTimeout(()=>{throw S},0)}function B(){var S=_e;let P=null;return S.g&&(P=S.g,S.g=S.g.next,S.g||(S.h=null),P.next=null),P}class ee{constructor(){this.h=this.g=null}add(P,V){const G=re.get();G.set(P,V),this.h?this.h.next=G:this.g=G,this.h=G}}var re=new C(()=>new pe,S=>S.reset());class pe{constructor(){this.next=this.g=this.h=null}set(P,V){this.h=P,this.g=V,this.next=null}reset(){this.next=this.g=this.h=null}}let Ie,ge=!1,_e=new ee,Re=()=>{const S=a.Promise.resolve(void 0);Ie=()=>{S.then(J)}};var J=()=>{for(var S;S=B();){try{S.h.call(S.g)}catch(V){U(V)}var P=re;P.j(S),100>P.h&&(P.h++,S.next=P.g,P.g=S)}ge=!1};function we(){this.s=this.s,this.C=this.C}we.prototype.s=!1,we.prototype.ma=function(){this.s||(this.s=!0,this.N())},we.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ae(S,P){this.type=S,this.g=this.target=P,this.defaultPrevented=!1}Ae.prototype.h=function(){this.defaultPrevented=!0};var ot=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var S=!1,P=Object.defineProperty({},"passive",{get:function(){S=!0}});try{const V=()=>{};a.addEventListener("test",V,P),a.removeEventListener("test",V,P)}catch{}return S}();function tt(S,P){if(Ae.call(this,S?S.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,S){var V=this.type=S.type,G=S.changedTouches&&S.changedTouches.length?S.changedTouches[0]:null;if(this.target=S.target||S.srcElement,this.g=P,P=S.relatedTarget){if(I){e:{try{L(P.nodeName);var ve=!0;break e}catch{}ve=!1}ve||(P=null)}}else V=="mouseover"?P=S.fromElement:V=="mouseout"&&(P=S.toElement);this.relatedTarget=P,G?(this.clientX=G.clientX!==void 0?G.clientX:G.pageX,this.clientY=G.clientY!==void 0?G.clientY:G.pageY,this.screenX=G.screenX||0,this.screenY=G.screenY||0):(this.clientX=S.clientX!==void 0?S.clientX:S.pageX,this.clientY=S.clientY!==void 0?S.clientY:S.pageY,this.screenX=S.screenX||0,this.screenY=S.screenY||0),this.button=S.button,this.key=S.key||"",this.ctrlKey=S.ctrlKey,this.altKey=S.altKey,this.shiftKey=S.shiftKey,this.metaKey=S.metaKey,this.pointerId=S.pointerId||0,this.pointerType=typeof S.pointerType=="string"?S.pointerType:It[S.pointerType]||"",this.state=S.state,this.i=S,S.defaultPrevented&&tt.aa.h.call(this)}}p(tt,Ae);var It={2:"touch",3:"pen",4:"mouse"};tt.prototype.h=function(){tt.aa.h.call(this);var S=this.i;S.preventDefault?S.preventDefault():S.returnValue=!1};var si="closure_listenable_"+(1e6*Math.random()|0),ai=0;function Ii(S,P,V,G,ve){this.listener=S,this.proxy=null,this.src=P,this.type=V,this.capture=!!G,this.ha=ve,this.key=++ai,this.da=this.fa=!1}function rn(S){S.da=!0,S.listener=null,S.proxy=null,S.src=null,S.ha=null}function eo(S){this.src=S,this.g={},this.h=0}eo.prototype.add=function(S,P,V,G,ve){var Pe=S.toString();S=this.g[Pe],S||(S=this.g[Pe]=[],this.h++);var lt=zs(S,P,G,ve);return-1<lt?(P=S[lt],V||(P.fa=!1)):(P=new Ii(P,this.src,Pe,!!G,ve),P.fa=V,S.push(P)),P};function vn(S,P){var V=P.type;if(V in S.g){var G=S.g[V],ve=Array.prototype.indexOf.call(G,P,void 0),Pe;(Pe=0<=ve)&&Array.prototype.splice.call(G,ve,1),Pe&&(rn(P),S.g[V].length==0&&(delete S.g[V],S.h--))}}function zs(S,P,V,G){for(var ve=0;ve<S.length;++ve){var Pe=S[ve];if(!Pe.da&&Pe.listener==P&&Pe.capture==!!V&&Pe.ha==G)return ve}return-1}var to="closure_lm_"+(1e6*Math.random()|0),Ec={};function _d(S,P,V,G,ve){if(Array.isArray(P)){for(var Pe=0;Pe<P.length;Pe++)_d(S,P[Pe],V,G,ve);return null}return V=Po(V),S&&S[si]?S.K(P,V,c(G)?!!G.capture:!1,ve):Ua(S,P,V,!1,G,ve)}function Ua(S,P,V,G,ve,Pe){if(!P)throw Error("Invalid event type");var lt=c(ve)?!!ve.capture:!!ve,Tn=zl(S);if(Tn||(S[to]=Tn=new eo(S)),V=Tn.add(P,V,G,lt,Pe),V.proxy)return V;if(G=bd(),V.proxy=G,G.src=S,G.listener=V,S.addEventListener)ot||(ve=lt),ve===void 0&&(ve=!1),S.addEventListener(P.toString(),G,ve);else if(S.attachEvent)S.attachEvent(ja(P.toString()),G);else if(S.addListener&&S.removeListener)S.addListener(G);else throw Error("addEventListener and attachEvent are unavailable.");return V}function bd(){function S(V){return P.call(S.src,S.listener,V)}const P=Su;return S}function Hl(S,P,V,G,ve){if(Array.isArray(P))for(var Pe=0;Pe<P.length;Pe++)Hl(S,P[Pe],V,G,ve);else G=c(G)?!!G.capture:!!G,V=Po(V),S&&S[si]?(S=S.i,P=String(P).toString(),P in S.g&&(Pe=S.g[P],V=zs(Pe,V,G,ve),-1<V&&(rn(Pe[V]),Array.prototype.splice.call(Pe,V,1),Pe.length==0&&(delete S.g[P],S.h--)))):S&&(S=zl(S))&&(P=S.g[P.toString()],S=-1,P&&(S=zs(P,V,G,ve)),(V=-1<S?P[S]:null)&&io(V))}function io(S){if(typeof S!="number"&&S&&!S.da){var P=S.src;if(P&&P[si])vn(P.i,S);else{var V=S.type,G=S.proxy;P.removeEventListener?P.removeEventListener(V,G,S.capture):P.detachEvent?P.detachEvent(ja(V),G):P.addListener&&P.removeListener&&P.removeListener(G),(V=zl(P))?(vn(V,S),V.h==0&&(V.src=null,P[to]=null)):rn(S)}}}function ja(S){return S in Ec?Ec[S]:Ec[S]="on"+S}function Su(S,P){if(S.da)S=!0;else{P=new tt(P,this);var V=S.listener,G=S.ha||S.src;S.fa&&io(S),S=V.call(G,P)}return S}function zl(S){return S=S[to],S instanceof eo?S:null}var $a="__closure_events_fn_"+(1e9*Math.random()>>>0);function Po(S){return typeof S=="function"?S:(S[$a]||(S[$a]=function(P){return S.handleEvent(P)}),S[$a])}function On(){we.call(this),this.i=new eo(this),this.M=this,this.F=null}p(On,we),On.prototype[si]=!0,On.prototype.removeEventListener=function(S,P,V,G){Hl(this,S,P,V,G)};function Zn(S,P){var V,G=S.F;if(G)for(V=[];G;G=G.F)V.push(G);if(S=S.M,G=P.type||P,typeof P=="string")P=new Ae(P,S);else if(P instanceof Ae)P.target=P.target||S;else{var ve=P;P=new Ae(G,S),W(P,ve)}if(ve=!0,V)for(var Pe=V.length-1;0<=Pe;Pe--){var lt=P.g=V[Pe];ve=qa(lt,G,!0,P)&&ve}if(lt=P.g=S,ve=qa(lt,G,!0,P)&&ve,ve=qa(lt,G,!1,P)&&ve,V)for(Pe=0;Pe<V.length;Pe++)lt=P.g=V[Pe],ve=qa(lt,G,!1,P)&&ve}On.prototype.N=function(){if(On.aa.N.call(this),this.i){var S=this.i,P;for(P in S.g){for(var V=S.g[P],G=0;G<V.length;G++)rn(V[G]);delete S.g[P],S.h--}}this.F=null},On.prototype.K=function(S,P,V,G){return this.i.add(String(S),P,!1,V,G)},On.prototype.L=function(S,P,V,G){return this.i.add(String(S),P,!0,V,G)};function qa(S,P,V,G){if(P=S.i.g[String(P)],!P)return!0;P=P.concat();for(var ve=!0,Pe=0;Pe<P.length;++Pe){var lt=P[Pe];if(lt&&!lt.da&&lt.capture==V){var Tn=lt.listener,vr=lt.ha||lt.src;lt.fa&&vn(S.i,lt),ve=Tn.call(vr,G)!==!1&&ve}}return ve&&!G.defaultPrevented}function Ul(S,P,V){if(typeof S=="function")V&&(S=h(S,V));else if(S&&typeof S.handleEvent=="function")S=h(S.handleEvent,S);else throw Error("Invalid listener argument");return 2147483647<Number(P)?-1:a.setTimeout(S,P||0)}function Ar(S){S.g=Ul(()=>{S.g=null,S.i&&(S.i=!1,Ar(S))},S.l);const P=S.h;S.h=null,S.m.apply(null,P)}class Ds extends we{constructor(P,V){super(),this.m=P,this.l=V,this.h=null,this.i=!1,this.g=null}j(P){this.h=arguments,this.g?this.i=!0:Ar(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Pr(S){we.call(this),this.h=S,this.g={}}p(Pr,we);var da=[];function qn(S){A(S.g,function(P,V){this.g.hasOwnProperty(V)&&io(P)},S),S.g={}}Pr.prototype.N=function(){Pr.aa.N.call(this),qn(this)},Pr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var _r=a.JSON.stringify,Dc=a.JSON.parse,no=class{stringify(S){return a.JSON.stringify(S,void 0)}parse(S){return a.JSON.parse(S,void 0)}};function Li(){}Li.prototype.h=null;function Ka(S){return S.h||(S.h=S.i())}function xu(){}var Mo={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function wn(){Ae.call(this,"d")}p(wn,Ae);function ua(){Ae.call(this,"c")}p(ua,Ae);var Ga={},Lu=null;function jl(){return Lu=Lu||new On}Ga.La="serverreachability";function zt(S){Ae.call(this,Ga.La,S)}p(zt,Ae);function K(S){const P=jl();Zn(P,new zt(P))}Ga.STAT_EVENT="statevent";function Q(S,P){Ae.call(this,Ga.STAT_EVENT,S),this.stat=P}p(Q,Ae);function Y(S){const P=jl();Zn(P,new Q(P,S))}Ga.Ma="timingevent";function se(S,P){Ae.call(this,Ga.Ma,S),this.size=P}p(se,Ae);function le(S,P){if(typeof S!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){S()},P)}function be(){this.g=!0}be.prototype.xa=function(){this.g=!1};function Ne(S,P,V,G,ve,Pe){S.info(function(){if(S.g)if(Pe)for(var lt="",Tn=Pe.split("&"),vr=0;vr<Tn.length;vr++){var Yi=Tn[vr].split("=");if(1<Yi.length){var Or=Yi[0];Yi=Yi[1];var er=Or.split("_");lt=2<=er.length&&er[1]=="type"?lt+(Or+"="+Yi+"&"):lt+(Or+"=redacted&")}}else lt=null;else lt=Pe;return"XMLHTTP REQ ("+G+") [attempt "+ve+"]: "+P+`
`+V+`
`+lt})}function Ze(S,P,V,G,ve,Pe,lt){S.info(function(){return"XMLHTTP RESP ("+G+") [ attempt "+ve+"]: "+P+`
`+V+`
`+Pe+" "+lt})}function rt(S,P,V,G){S.info(function(){return"XMLHTTP TEXT ("+P+"): "+yi(S,V)+(G?" "+G:"")})}function Ft(S,P){S.info(function(){return"TIMEOUT: "+P})}be.prototype.info=function(){};function yi(S,P){if(!S.g)return P;if(!P)return null;try{var V=JSON.parse(P);if(V){for(S=0;S<V.length;S++)if(Array.isArray(V[S])){var G=V[S];if(!(2>G.length)){var ve=G[1];if(Array.isArray(ve)&&!(1>ve.length)){var Pe=ve[0];if(Pe!="noop"&&Pe!="stop"&&Pe!="close")for(var lt=1;lt<ve.length;lt++)ve[lt]=""}}}}return _r(V)}catch{return P}}var bi={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},on={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ki;function ps(){}p(ps,Li),ps.prototype.g=function(){return new XMLHttpRequest},ps.prototype.i=function(){return{}},ki=new ps;function ss(S,P,V,G){this.j=S,this.i=P,this.l=V,this.R=G||1,this.U=new Pr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ku}function ku(){this.i=null,this.g="",this.h=!1}var xt={},de={};function Ge(S,P,V){S.L=1,S.v=qg(ql(P)),S.m=V,S.P=!0,pt(S,null)}function pt(S,P){S.F=Date.now(),mi(S),S.A=ql(S.v);var V=S.A,G=S.R;Array.isArray(G)||(G=[String(G)]),Gg(V.i,"t",G),S.C=0,V=S.j.J,S.h=new ku,S.g=BD(S.j,V?P:null,!S.m),0<S.O&&(S.M=new Ds(h(S.Y,S,S.g),S.O)),P=S.U,V=S.g,G=S.ca;var ve="readystatechange";Array.isArray(ve)||(ve&&(da[0]=ve.toString()),ve=da);for(var Pe=0;Pe<ve.length;Pe++){var lt=_d(V,ve[Pe],G||P.handleEvent,!1,P.h||P);if(!lt)break;P.g[lt.key]=lt}P=S.H?N(S.H):{},S.m?(S.u||(S.u="POST"),P["Content-Type"]="application/x-www-form-urlencoded",S.g.ea(S.A,S.u,S.m,P)):(S.u="GET",S.g.ea(S.A,S.u,null,P)),K(),Ne(S.i,S.u,S.A,S.l,S.R,S.m)}ss.prototype.ca=function(S){S=S.target;const P=this.M;P&&Xa(S)==3?P.j():this.Y(S)},ss.prototype.Y=function(S){try{if(S==this.g)e:{const er=Xa(this.g);var P=this.g.Ba();const Nc=this.g.Z();if(!(3>er)&&(er!=3||this.g&&(this.h.h||this.g.oa()||VS(this.g)))){this.J||er!=4||P==7||(P==8||0>=Nc?K(3):K(2)),Mr(this);var V=this.g.Z();this.X=V;t:if(Cn(this)){var G=VS(this.g);S="";var ve=G.length,Pe=Xa(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Fn(this),Qa(this);var lt="";break t}this.h.i=new a.TextDecoder}for(P=0;P<ve;P++)this.h.h=!0,S+=this.h.i.decode(G[P],{stream:!(Pe&&P==ve-1)});G.length=0,this.h.g+=S,this.C=0,lt=this.h.g}else lt=this.g.oa();if(this.o=V==200,Ze(this.i,this.u,this.A,this.l,this.R,er,V),this.o){if(this.T&&!this.K){t:{if(this.g){var Tn,vr=this.g;if((Tn=vr.g?vr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!y(Tn)){var Yi=Tn;break t}}Yi=null}if(V=Yi)rt(this.i,this.l,V,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,zg(this,V);else{this.o=!1,this.s=3,Y(12),Fn(this),Qa(this);break e}}if(this.P){V=!0;let Gl;for(;!this.J&&this.C<lt.length;)if(Gl=Js(this,lt),Gl==de){er==4&&(this.s=4,Y(14),V=!1),rt(this.i,this.l,null,"[Incomplete Response]");break}else if(Gl==xt){this.s=4,Y(15),rt(this.i,this.l,lt,"[Invalid Chunk]"),V=!1;break}else rt(this.i,this.l,Gl,null),zg(this,Gl);if(Cn(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),er!=4||lt.length!=0||this.h.h||(this.s=1,Y(16),V=!1),this.o=this.o&&V,!V)rt(this.i,this.l,lt,"[Invalid Chunked Response]"),Fn(this),Qa(this);else if(0<lt.length&&!this.W){this.W=!0;var Or=this.j;Or.g==this&&Or.ba&&!Or.M&&(Or.j.info("Great, no buffering proxy detected. Bytes received: "+lt.length),WS(Or),Or.M=!0,Y(11))}}else rt(this.i,this.l,lt,null),zg(this,lt);er==4&&Fn(this),this.o&&!this.J&&(er==4?_0(this.j,this):(this.o=!1,mi(this)))}else h0(this.g),V==400&&0<lt.indexOf("Unknown SID")?(this.s=3,Y(12)):(this.s=0,Y(13)),Fn(this),Qa(this)}}}catch{}finally{}};function Cn(S){return S.g?S.u=="GET"&&S.L!=2&&S.j.Ca:!1}function Js(S,P){var V=S.C,G=P.indexOf(`
`,V);return G==-1?de:(V=Number(P.substring(V,G)),isNaN(V)?xt:(G+=1,G+V>P.length?de:(P=P.slice(G,G+V),S.C=G+V,P)))}ss.prototype.cancel=function(){this.J=!0,Fn(this)};function mi(S){S.S=Date.now()+S.I,br(S,S.I)}function br(S,P){if(S.B!=null)throw Error("WatchDog timer not null");S.B=le(h(S.ba,S),P)}function Mr(S){S.B&&(a.clearTimeout(S.B),S.B=null)}ss.prototype.ba=function(){this.B=null;const S=Date.now();0<=S-this.S?(Ft(this.i,this.A),this.L!=2&&(K(),Y(17)),Fn(this),this.s=2,Qa(this)):br(this,this.S-S)};function Qa(S){S.j.G==0||S.J||_0(S.j,S)}function Fn(S){Mr(S);var P=S.M;P&&typeof P.ma=="function"&&P.ma(),S.M=null,qn(S.U),S.g&&(P=S.g,S.g=null,P.abort(),P.ma())}function zg(S,P){try{var V=S.j;if(V.G!=0&&(V.g==S||ha(V.h,S))){if(!S.K&&ha(V.h,S)&&V.G==3){try{var G=V.Da.g.parse(P)}catch{G=null}if(Array.isArray(G)&&G.length==3){var ve=G;if(ve[0]==0){e:if(!V.u){if(V.g)if(V.g.F+3e3<S.F)m0(V),Sd(V);else break e;p0(V),Y(18)}}else V.za=ve[1],0<V.za-V.T&&37500>ve[2]&&V.F&&V.v==0&&!V.C&&(V.C=le(h(V.Za,V),6e3));if(1>=LD(V.h)&&V.ca){try{V.ca()}catch{}V.ca=void 0}}else tf(V,11)}else if((S.K||V.g==S)&&m0(V),!y(P))for(ve=V.Da.g.parse(P),P=0;P<ve.length;P++){let Yi=ve[P];if(V.T=Yi[0],Yi=Yi[1],V.G==2)if(Yi[0]=="c"){V.K=Yi[1],V.ia=Yi[2];const Or=Yi[3];Or!=null&&(V.la=Or,V.j.info("VER="+V.la));const er=Yi[4];er!=null&&(V.Aa=er,V.j.info("SVER="+V.Aa));const Nc=Yi[5];Nc!=null&&typeof Nc=="number"&&0<Nc&&(G=1.5*Nc,V.L=G,V.j.info("backChannelRequestTimeoutMs_="+G)),G=V;const Gl=S.g;if(Gl){const N_=Gl.g?Gl.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(N_){var Pe=G.h;Pe.g||N_.indexOf("spdy")==-1&&N_.indexOf("quic")==-1&&N_.indexOf("h2")==-1||(Pe.j=Pe.l,Pe.g=new Set,Pe.h&&(PS(Pe,Pe.h),Pe.h=null))}if(G.D){const v0=Gl.g?Gl.g.getResponseHeader("X-HTTP-Session-Id"):null;v0&&(G.ya=v0,Kn(G.I,G.D,v0))}}V.G=3,V.l&&V.l.ua(),V.ba&&(V.R=Date.now()-S.F,V.j.info("Handshake RTT: "+V.R+"ms")),G=V;var lt=S;if(G.qa=VD(G,G.J?G.ia:null,G.W),lt.K){kD(G.h,lt);var Tn=lt,vr=G.L;vr&&(Tn.I=vr),Tn.B&&(Mr(Tn),mi(Tn)),G.g=lt}else T_(G);0<V.i.length&&Tu(V)}else Yi[0]!="stop"&&Yi[0]!="close"||tf(V,7);else V.G==3&&(Yi[0]=="stop"||Yi[0]=="close"?Yi[0]=="stop"?tf(V,7):ro(V):Yi[0]!="noop"&&V.l&&V.l.ta(Yi),V.v=0)}}K(4)}catch{}}var x_=class{constructor(S,P){this.g=S,this.map=P}};function L_(S){this.l=S||10,a.PerformanceNavigationTiming?(S=a.performance.getEntriesByType("navigation"),S=0<S.length&&(S[0].nextHopProtocol=="hq"||S[0].nextHopProtocol=="h2")):S=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=S?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function $l(S){return S.h?!0:S.g?S.g.size>=S.j:!1}function LD(S){return S.h?1:S.g?S.g.size:0}function ha(S,P){return S.h?S.h==P:S.g?S.g.has(P):!1}function PS(S,P){S.g?S.g.add(P):S.h=P}function kD(S,P){S.h&&S.h==P?S.h=null:S.g&&S.g.has(P)&&S.g.delete(P)}L_.prototype.cancel=function(){if(this.i=ID(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const S of this.g.values())S.cancel();this.g.clear()}};function ID(S){if(S.h!=null)return S.i.concat(S.h.D);if(S.g!=null&&S.g.size!==0){let P=S.i;for(const V of S.g.values())P=P.concat(V.D);return P}return _(S.i)}function a0(S){if(S.V&&typeof S.V=="function")return S.V();if(typeof Map<"u"&&S instanceof Map||typeof Set<"u"&&S instanceof Set)return Array.from(S.values());if(typeof S=="string")return S.split("");if(l(S)){for(var P=[],V=S.length,G=0;G<V;G++)P.push(S[G]);return P}P=[],V=0;for(G in S)P[V++]=S[G];return P}function l0(S){if(S.na&&typeof S.na=="function")return S.na();if(!S.V||typeof S.V!="function"){if(typeof Map<"u"&&S instanceof Map)return Array.from(S.keys());if(!(typeof Set<"u"&&S instanceof Set)){if(l(S)||typeof S=="string"){var P=[];S=S.length;for(var V=0;V<S;V++)P.push(V);return P}P=[],V=0;for(const G in S)P[V++]=G;return P}}}function Ug(S,P){if(S.forEach&&typeof S.forEach=="function")S.forEach(P,void 0);else if(l(S)||typeof S=="string")Array.prototype.forEach.call(S,P,void 0);else for(var V=l0(S),G=a0(S),ve=G.length,Pe=0;Pe<ve;Pe++)P.call(void 0,G[Pe],V&&V[Pe],S)}var k_=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function M5(S,P){if(S){S=S.split("&");for(var V=0;V<S.length;V++){var G=S[V].indexOf("="),ve=null;if(0<=G){var Pe=S[V].substring(0,G);ve=S[V].substring(G+1)}else Pe=S[V];P(Pe,ve?decodeURIComponent(ve.replace(/\+/g," ")):"")}}}function Xh(S){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,S instanceof Xh){this.h=S.h,I_(this,S.j),this.o=S.o,this.g=S.g,jg(this,S.s),this.l=S.l;var P=S.i,V=new Iu;V.i=P.i,P.g&&(V.g=new Map(P.g),V.h=P.h),$g(this,V),this.m=S.m}else S&&(P=String(S).match(k_))?(this.h=!1,I_(this,P[1]||"",!0),this.o=zi(P[2]||""),this.g=zi(P[3]||"",!0),jg(this,P[4]),this.l=zi(P[5]||"",!0),$g(this,P[6]||"",!0),this.m=zi(P[7]||"")):(this.h=!1,this.i=new Iu(null,this.h))}Xh.prototype.toString=function(){var S=[],P=this.j;P&&S.push(Kg(P,c0,!0),":");var V=this.g;return(V||P=="file")&&(S.push("//"),(P=this.o)&&S.push(Kg(P,c0,!0),"@"),S.push(encodeURIComponent(String(V)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),V=this.s,V!=null&&S.push(":",String(V))),(V=this.l)&&(this.g&&V.charAt(0)!="/"&&S.push("/"),S.push(Kg(V,V.charAt(0)=="/"?TD:DD,!0))),(V=this.i.toString())&&S.push("?",V),(V=this.m)&&S.push("#",Kg(V,MS)),S.join("")};function ql(S){return new Xh(S)}function I_(S,P,V){S.j=V?zi(P,!0):P,S.j&&(S.j=S.j.replace(/:$/,""))}function jg(S,P){if(P){if(P=Number(P),isNaN(P)||0>P)throw Error("Bad port number "+P);S.s=P}else S.s=null}function $g(S,P,V){P instanceof Iu?(S.i=P,Eu(S.i,S.h)):(V||(P=Kg(P,ND)),S.i=new Iu(P,S.h))}function Kn(S,P,V){S.i.set(P,V)}function qg(S){return Kn(S,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),S}function zi(S,P){return S?P?decodeURI(S.replace(/%25/g,"%2525")):decodeURIComponent(S):""}function Kg(S,P,V){return typeof S=="string"?(S=encodeURI(S).replace(P,ED),V&&(S=S.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),S):null}function ED(S){return S=S.charCodeAt(0),"%"+(S>>4&15).toString(16)+(S&15).toString(16)}var c0=/[#\/\?@]/g,DD=/[#\?:]/g,TD=/[#\?]/g,ND=/[#\?@]/g,MS=/#/g;function Iu(S,P){this.h=this.g=null,this.i=S||null,this.j=!!P}function so(S){S.g||(S.g=new Map,S.h=0,S.i&&M5(S.i,function(P,V){S.add(decodeURIComponent(P.replace(/\+/g," ")),V)}))}s=Iu.prototype,s.add=function(S,P){so(this),this.i=null,S=Tc(this,S);var V=this.g.get(S);return V||this.g.set(S,V=[]),V.push(P),this.h+=1,this};function vd(S,P){so(S),P=Tc(S,P),S.g.has(P)&&(S.i=null,S.h-=S.g.get(P).length,S.g.delete(P))}function wd(S,P){return so(S),P=Tc(S,P),S.g.has(P)}s.forEach=function(S,P){so(this),this.g.forEach(function(V,G){V.forEach(function(ve){S.call(P,ve,G,this)},this)},this)},s.na=function(){so(this);const S=Array.from(this.g.values()),P=Array.from(this.g.keys()),V=[];for(let G=0;G<P.length;G++){const ve=S[G];for(let Pe=0;Pe<ve.length;Pe++)V.push(P[G])}return V},s.V=function(S){so(this);let P=[];if(typeof S=="string")wd(this,S)&&(P=P.concat(this.g.get(Tc(this,S))));else{S=Array.from(this.g.values());for(let V=0;V<S.length;V++)P=P.concat(S[V])}return P},s.set=function(S,P){return so(this),this.i=null,S=Tc(this,S),wd(this,S)&&(this.h-=this.g.get(S).length),this.g.set(S,[P]),this.h+=1,this},s.get=function(S,P){return S?(S=this.V(S),0<S.length?String(S[0]):P):P};function Gg(S,P,V){vd(S,P),0<V.length&&(S.i=null,S.g.set(Tc(S,P),_(V)),S.h+=V.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const S=[],P=Array.from(this.g.keys());for(var V=0;V<P.length;V++){var G=P[V];const Pe=encodeURIComponent(String(G)),lt=this.V(G);for(G=0;G<lt.length;G++){var ve=Pe;lt[G]!==""&&(ve+="="+encodeURIComponent(String(lt[G]))),S.push(ve)}}return this.i=S.join("&")};function Tc(S,P){return P=String(P),S.j&&(P=P.toLowerCase()),P}function Eu(S,P){P&&!S.j&&(so(S),S.i=null,S.g.forEach(function(V,G){var ve=G.toLowerCase();G!=ve&&(vd(this,G),Gg(this,ve,V))},S)),S.j=P}function O5(S,P){const V=new be;if(a.Image){const G=new Image;G.onload=g(Ya,V,"TestLoadImage: loaded",!0,P,G),G.onerror=g(Ya,V,"TestLoadImage: error",!1,P,G),G.onabort=g(Ya,V,"TestLoadImage: abort",!1,P,G),G.ontimeout=g(Ya,V,"TestLoadImage: timeout",!1,P,G),a.setTimeout(function(){G.ontimeout&&G.ontimeout()},1e4),G.src=S}else P(!1)}function RD(S,P){const V=new be,G=new AbortController,ve=setTimeout(()=>{G.abort(),Ya(V,"TestPingServer: timeout",!1,P)},1e4);fetch(S,{signal:G.signal}).then(Pe=>{clearTimeout(ve),Pe.ok?Ya(V,"TestPingServer: ok",!0,P):Ya(V,"TestPingServer: server error",!1,P)}).catch(()=>{clearTimeout(ve),Ya(V,"TestPingServer: error",!1,P)})}function Ya(S,P,V,G,ve){try{ve&&(ve.onload=null,ve.onerror=null,ve.onabort=null,ve.ontimeout=null),G(V)}catch{}}function F5(){this.g=new no}function AD(S,P,V){const G=V||"";try{Ug(S,function(ve,Pe){let lt=ve;c(ve)&&(lt=_r(ve)),P.push(G+Pe+"="+encodeURIComponent(lt))})}catch(ve){throw P.push(G+"type="+encodeURIComponent("_badmap")),ve}}function Zh(S){this.l=S.Ub||null,this.j=S.eb||!1}p(Zh,Li),Zh.prototype.g=function(){return new E_(this.l,this.j)},Zh.prototype.i=function(S){return function(){return S}}({});function E_(S,P){On.call(this),this.D=S,this.o=P,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}p(E_,On),s=E_.prototype,s.open=function(S,P){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=S,this.A=P,this.readyState=1,yd(this)},s.send=function(S){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const P={headers:this.u,method:this.B,credentials:this.m,cache:void 0};S&&(P.body=S),(this.D||a).fetch(new Request(this.A,P)).then(this.Sa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Cd(this)),this.readyState=0},s.Sa=function(S){if(this.g&&(this.l=S,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=S.headers,this.readyState=2,yd(this)),this.g&&(this.readyState=3,yd(this),this.g)))if(this.responseType==="arraybuffer")S.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in S){if(this.j=S.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;PD(this)}else S.text().then(this.Ra.bind(this),this.ga.bind(this))};function PD(S){S.j.read().then(S.Pa.bind(S)).catch(S.ga.bind(S))}s.Pa=function(S){if(this.g){if(this.o&&S.value)this.response.push(S.value);else if(!this.o){var P=S.value?S.value:new Uint8Array(0);(P=this.v.decode(P,{stream:!S.done}))&&(this.response=this.responseText+=P)}S.done?Cd(this):yd(this),this.readyState==3&&PD(this)}},s.Ra=function(S){this.g&&(this.response=this.responseText=S,Cd(this))},s.Qa=function(S){this.g&&(this.response=S,Cd(this))},s.ga=function(){this.g&&Cd(this)};function Cd(S){S.readyState=4,S.l=null,S.j=null,S.v=null,yd(S)}s.setRequestHeader=function(S,P){this.u.append(S,P)},s.getResponseHeader=function(S){return this.h&&this.h.get(S.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const S=[],P=this.h.entries();for(var V=P.next();!V.done;)V=V.value,S.push(V[0]+": "+V[1]),V=P.next();return S.join(`\r
`)};function yd(S){S.onreadystatechange&&S.onreadystatechange.call(S)}Object.defineProperty(E_.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(S){this.m=S?"include":"same-origin"}});function Jh(S){let P="";return A(S,function(V,G){P+=G,P+=":",P+=V,P+=`\r
`}),P}function Qg(S,P,V){e:{for(G in V){var G=!1;break e}G=!0}G||(V=Jh(V),typeof S=="string"?V!=null&&encodeURIComponent(String(V)):Kn(S,P,V))}function ds(S){On.call(this),this.headers=new Map,this.o=S||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}p(ds,On);var V5=/^https?$/i,OS=["POST","PUT"];s=ds.prototype,s.Ha=function(S){this.J=S},s.ea=function(S,P,V,G){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+S);P=P?P.toUpperCase():"GET",this.D=S,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ki.g(),this.v=this.o?Ka(this.o):Ka(ki),this.g.onreadystatechange=h(this.Ea,this);try{this.B=!0,this.g.open(P,String(S),!0),this.B=!1}catch(Pe){D_(this,Pe);return}if(S=V||"",V=new Map(this.headers),G)if(Object.getPrototypeOf(G)===Object.prototype)for(var ve in G)V.set(ve,G[ve]);else if(typeof G.keys=="function"&&typeof G.get=="function")for(const Pe of G.keys())V.set(Pe,G.get(Pe));else throw Error("Unknown input type for opt_headers: "+String(G));G=Array.from(V.keys()).find(Pe=>Pe.toLowerCase()=="content-type"),ve=a.FormData&&S instanceof a.FormData,!(0<=Array.prototype.indexOf.call(OS,P,void 0))||G||ve||V.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Pe,lt]of V)this.g.setRequestHeader(Pe,lt);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{u0(this),this.u=!0,this.g.send(S),this.u=!1}catch(Pe){D_(this,Pe)}};function D_(S,P){S.h=!1,S.g&&(S.j=!0,S.g.abort(),S.j=!1),S.l=P,S.m=5,d0(S),Kl(S)}function d0(S){S.A||(S.A=!0,Zn(S,"complete"),Zn(S,"error"))}s.abort=function(S){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=S||7,Zn(this,"complete"),Zn(this,"abort"),Kl(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Kl(this,!0)),ds.aa.N.call(this)},s.Ea=function(){this.s||(this.B||this.u||this.j?FS(this):this.bb())},s.bb=function(){FS(this)};function FS(S){if(S.h&&typeof o<"u"&&(!S.v[1]||Xa(S)!=4||S.Z()!=2)){if(S.u&&Xa(S)==4)Ul(S.Ea,0,S);else if(Zn(S,"readystatechange"),Xa(S)==4){S.h=!1;try{const lt=S.Z();e:switch(lt){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var P=!0;break e;default:P=!1}var V;if(!(V=P)){var G;if(G=lt===0){var ve=String(S.D).match(k_)[1]||null;!ve&&a.self&&a.self.location&&(ve=a.self.location.protocol.slice(0,-1)),G=!V5.test(ve?ve.toLowerCase():"")}V=G}if(V)Zn(S,"complete"),Zn(S,"success");else{S.m=6;try{var Pe=2<Xa(S)?S.g.statusText:""}catch{Pe=""}S.l=Pe+" ["+S.Z()+"]",d0(S)}}finally{Kl(S)}}}}function Kl(S,P){if(S.g){u0(S);const V=S.g,G=S.v[0]?()=>{}:null;S.g=null,S.v=null,P||Zn(S,"ready");try{V.onreadystatechange=G}catch{}}}function u0(S){S.I&&(a.clearTimeout(S.I),S.I=null)}s.isActive=function(){return!!this.g};function Xa(S){return S.g?S.g.readyState:0}s.Z=function(){try{return 2<Xa(this)?this.g.status:-1}catch{return-1}},s.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.Oa=function(S){if(this.g){var P=this.g.responseText;return S&&P.indexOf(S)==0&&(P=P.substring(S.length)),Dc(P)}};function VS(S){try{if(!S.g)return null;if("response"in S.g)return S.g.response;switch(S.H){case"":case"text":return S.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in S.g)return S.g.mozResponseArrayBuffer}return null}catch{return null}}function h0(S){const P={};S=(S.g&&2<=Xa(S)&&S.g.getAllResponseHeaders()||"").split(`\r
`);for(let G=0;G<S.length;G++){if(y(S[G]))continue;var V=H(S[G]);const ve=V[0];if(V=V[1],typeof V!="string")continue;V=V.trim();const Pe=P[ve]||[];P[ve]=Pe,Pe.push(V)}D(P,function(G){return G.join(", ")})}s.Ba=function(){return this.m},s.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Du(S,P,V){return V&&V.internalChannelParams&&V.internalChannelParams[S]||P}function BS(S){this.Aa=0,this.i=[],this.j=new be,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Du("failFast",!1,S),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Du("baseRetryDelayMs",5e3,S),this.cb=Du("retryDelaySeedMs",1e4,S),this.Wa=Du("forwardChannelMaxRetries",2,S),this.wa=Du("forwardChannelRequestTimeoutMs",2e4,S),this.pa=S&&S.xmlHttpFactory||void 0,this.Xa=S&&S.Tb||void 0,this.Ca=S&&S.useFetchStreams||!1,this.L=void 0,this.J=S&&S.supportsCrossDomainXhr||!1,this.K="",this.h=new L_(S&&S.concurrentRequestLimit),this.Da=new F5,this.P=S&&S.fastHandshake||!1,this.O=S&&S.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=S&&S.Rb||!1,S&&S.xa&&this.j.xa(),S&&S.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&S&&S.detectBufferingProxy||!1,this.ja=void 0,S&&S.longPollingTimeout&&0<S.longPollingTimeout&&(this.ja=S.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}s=BS.prototype,s.la=8,s.G=1,s.connect=function(S,P,V,G){Y(0),this.W=S,this.H=P||{},V&&G!==void 0&&(this.H.OSID=V,this.H.OAID=G),this.F=this.X,this.I=VD(this,null,this.W),Tu(this)};function ro(S){if(f0(S),S.G==3){var P=S.U++,V=ql(S.I);if(Kn(V,"SID",S.K),Kn(V,"RID",P),Kn(V,"TYPE","terminate"),ef(S,V),P=new ss(S,S.j,P),P.L=2,P.v=qg(ql(V)),V=!1,a.navigator&&a.navigator.sendBeacon)try{V=a.navigator.sendBeacon(P.v.toString(),"")}catch{}!V&&a.Image&&(new Image().src=P.v,V=!0),V||(P.g=BD(P.j,null),P.g.ea(P.v)),P.F=Date.now(),mi(P)}FD(S)}function Sd(S){S.g&&(WS(S),S.g.cancel(),S.g=null)}function f0(S){Sd(S),S.u&&(a.clearTimeout(S.u),S.u=null),m0(S),S.h.cancel(),S.s&&(typeof S.s=="number"&&a.clearTimeout(S.s),S.s=null)}function Tu(S){if(!$l(S.h)&&!S.s){S.s=!0;var P=S.Ga;Ie||Re(),ge||(Ie(),ge=!0),_e.add(P,S),S.B=0}}function B5(S,P){return LD(S.h)>=S.h.j-(S.s?1:0)?!1:S.s?(S.i=P.D.concat(S.i),!0):S.G==1||S.G==2||S.B>=(S.Va?0:S.Wa)?!1:(S.s=le(h(S.Ga,S,P),OD(S,S.B)),S.B++,!0)}s.Ga=function(S){if(this.s)if(this.s=null,this.G==1){if(!S){this.U=Math.floor(1e5*Math.random()),S=this.U++;const ve=new ss(this,this.j,S);let Pe=this.o;if(this.S&&(Pe?(Pe=N(Pe),W(Pe,this.S)):Pe=this.S),this.m!==null||this.O||(ve.H=Pe,Pe=null),this.P)e:{for(var P=0,V=0;V<this.i.length;V++){t:{var G=this.i[V];if("__data__"in G.map&&(G=G.map.__data__,typeof G=="string")){G=G.length;break t}G=void 0}if(G===void 0)break;if(P+=G,4096<P){P=V;break e}if(P===4096||V===this.i.length-1){P=V+1;break e}}P=1e3}else P=1e3;P=Yg(this,ve,P),V=ql(this.I),Kn(V,"RID",S),Kn(V,"CVER",22),this.D&&Kn(V,"X-HTTP-Session-Id",this.D),ef(this,V),Pe&&(this.O?P="headers="+encodeURIComponent(String(Jh(Pe)))+"&"+P:this.m&&Qg(V,this.m,Pe)),PS(this.h,ve),this.Ua&&Kn(V,"TYPE","init"),this.P?(Kn(V,"$req",P),Kn(V,"SID","null"),ve.T=!0,Ge(ve,V,null)):Ge(ve,V,P),this.G=2}}else this.G==3&&(S?g0(this,S):this.i.length==0||$l(this.h)||g0(this))};function g0(S,P){var V;P?V=P.l:V=S.U++;const G=ql(S.I);Kn(G,"SID",S.K),Kn(G,"RID",V),Kn(G,"AID",S.T),ef(S,G),S.m&&S.o&&Qg(G,S.m,S.o),V=new ss(S,S.j,V,S.B+1),S.m===null&&(V.H=S.o),P&&(S.i=P.D.concat(S.i)),P=Yg(S,V,1e3),V.I=Math.round(.5*S.wa)+Math.round(.5*S.wa*Math.random()),PS(S.h,V),Ge(V,G,P)}function ef(S,P){S.H&&A(S.H,function(V,G){Kn(P,G,V)}),S.l&&Ug({},function(V,G){Kn(P,G,V)})}function Yg(S,P,V){V=Math.min(S.i.length,V);var G=S.l?h(S.l.Na,S.l,S):null;e:{var ve=S.i;let Pe=-1;for(;;){const lt=["count="+V];Pe==-1?0<V?(Pe=ve[0].g,lt.push("ofs="+Pe)):Pe=0:lt.push("ofs="+Pe);let Tn=!0;for(let vr=0;vr<V;vr++){let Yi=ve[vr].g;const Or=ve[vr].map;if(Yi-=Pe,0>Yi)Pe=Math.max(0,ve[vr].g-100),Tn=!1;else try{AD(Or,lt,"req"+Yi+"_")}catch{G&&G(Or)}}if(Tn){G=lt.join("&");break e}}}return S=S.i.splice(0,V),P.D=S,G}function T_(S){if(!S.g&&!S.u){S.Y=1;var P=S.Fa;Ie||Re(),ge||(Ie(),ge=!0),_e.add(P,S),S.v=0}}function p0(S){return S.g||S.u||3<=S.v?!1:(S.Y++,S.u=le(h(S.Fa,S),OD(S,S.v)),S.v++,!0)}s.Fa=function(){if(this.u=null,MD(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var S=2*this.R;this.j.info("BP detection timer enabled: "+S),this.A=le(h(this.ab,this),S)}},s.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Y(10),Sd(this),MD(this))};function WS(S){S.A!=null&&(a.clearTimeout(S.A),S.A=null)}function MD(S){S.g=new ss(S,S.j,"rpc",S.Y),S.m===null&&(S.g.H=S.o),S.g.O=0;var P=ql(S.qa);Kn(P,"RID","rpc"),Kn(P,"SID",S.K),Kn(P,"AID",S.T),Kn(P,"CI",S.F?"0":"1"),!S.F&&S.ja&&Kn(P,"TO",S.ja),Kn(P,"TYPE","xmlhttp"),ef(S,P),S.m&&S.o&&Qg(P,S.m,S.o),S.L&&(S.g.I=S.L);var V=S.g;S=S.ia,V.L=1,V.v=qg(ql(P)),V.m=null,V.P=!0,pt(V,S)}s.Za=function(){this.C!=null&&(this.C=null,Sd(this),p0(this),Y(19))};function m0(S){S.C!=null&&(a.clearTimeout(S.C),S.C=null)}function _0(S,P){var V=null;if(S.g==P){m0(S),WS(S),S.g=null;var G=2}else if(ha(S.h,P))V=P.D,kD(S.h,P),G=1;else return;if(S.G!=0){if(P.o)if(G==1){V=P.m?P.m.length:0,P=Date.now()-P.F;var ve=S.B;G=jl(),Zn(G,new se(G,V)),Tu(S)}else T_(S);else if(ve=P.s,ve==3||ve==0&&0<P.X||!(G==1&&B5(S,P)||G==2&&p0(S)))switch(V&&0<V.length&&(P=S.h,P.i=P.i.concat(V)),ve){case 1:tf(S,5);break;case 4:tf(S,10);break;case 3:tf(S,6);break;default:tf(S,2)}}}function OD(S,P){let V=S.Ta+Math.floor(Math.random()*S.cb);return S.isActive()||(V*=2),V*P}function tf(S,P){if(S.j.info("Error code "+P),P==2){var V=h(S.fb,S),G=S.Xa;const ve=!G;G=new Xh(G||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||I_(G,"https"),qg(G),ve?O5(G.toString(),V):RD(G.toString(),V)}else Y(2);S.G=0,S.l&&S.l.sa(P),FD(S),f0(S)}s.fb=function(S){S?(this.j.info("Successfully pinged google.com"),Y(2)):(this.j.info("Failed to ping google.com"),Y(1))};function FD(S){if(S.G=0,S.ka=[],S.l){const P=ID(S.h);(P.length!=0||S.i.length!=0)&&(v(S.ka,P),v(S.ka,S.i),S.h.i.length=0,_(S.i),S.i.length=0),S.l.ra()}}function VD(S,P,V){var G=V instanceof Xh?ql(V):new Xh(V);if(G.g!="")P&&(G.g=P+"."+G.g),jg(G,G.s);else{var ve=a.location;G=ve.protocol,P=P?P+"."+ve.hostname:ve.hostname,ve=+ve.port;var Pe=new Xh(null);G&&I_(Pe,G),P&&(Pe.g=P),ve&&jg(Pe,ve),V&&(Pe.l=V),G=Pe}return V=S.D,P=S.ya,V&&P&&Kn(G,V,P),Kn(G,"VER",S.la),ef(S,G),G}function BD(S,P,V){if(P&&!S.J)throw Error("Can't create secondary domain capable XhrIo object.");return P=S.Ca&&!S.pa?new ds(new Zh({eb:V})):new ds(S.pa),P.Ha(S.J),P}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function HS(){}s=HS.prototype,s.ua=function(){},s.ta=function(){},s.sa=function(){},s.ra=function(){},s.isActive=function(){return!0},s.Na=function(){};function b0(){}b0.prototype.g=function(S,P){return new fa(S,P)};function fa(S,P){On.call(this),this.g=new BS(P),this.l=S,this.h=P&&P.messageUrlParams||null,S=P&&P.messageHeaders||null,P&&P.clientProtocolHeaderRequired&&(S?S["X-Client-Protocol"]="webchannel":S={"X-Client-Protocol":"webchannel"}),this.g.o=S,S=P&&P.initMessageHeaders||null,P&&P.messageContentType&&(S?S["X-WebChannel-Content-Type"]=P.messageContentType:S={"X-WebChannel-Content-Type":P.messageContentType}),P&&P.va&&(S?S["X-WebChannel-Client-Profile"]=P.va:S={"X-WebChannel-Client-Profile":P.va}),this.g.S=S,(S=P&&P.Sb)&&!y(S)&&(this.g.m=S),this.v=P&&P.supportsCrossDomainXhr||!1,this.u=P&&P.sendRawJson||!1,(P=P&&P.httpSessionIdParam)&&!y(P)&&(this.g.D=P,S=this.h,S!==null&&P in S&&(S=this.h,P in S&&delete S[P])),this.j=new Nu(this)}p(fa,On),fa.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},fa.prototype.close=function(){ro(this.g)},fa.prototype.o=function(S){var P=this.g;if(typeof S=="string"){var V={};V.__data__=S,S=V}else this.u&&(V={},V.__data__=_r(S),S=V);P.i.push(new x_(P.Ya++,S)),P.G==3&&Tu(P)},fa.prototype.N=function(){this.g.l=null,delete this.j,ro(this.g),delete this.g,fa.aa.N.call(this)};function WD(S){wn.call(this),S.__headers__&&(this.headers=S.__headers__,this.statusCode=S.__status__,delete S.__headers__,delete S.__status__);var P=S.__sm__;if(P){e:{for(const V in P){S=V;break e}S=void 0}(this.i=S)&&(S=this.i,P=P!==null&&S in P?P[S]:void 0),this.data=P}else this.data=S}p(WD,wn);function HD(){ua.call(this),this.status=1}p(HD,ua);function Nu(S){this.g=S}p(Nu,HS),Nu.prototype.ua=function(){Zn(this.g,"a")},Nu.prototype.ta=function(S){Zn(this.g,new WD(S))},Nu.prototype.sa=function(S){Zn(this.g,new HD)},Nu.prototype.ra=function(){Zn(this.g,"b")},b0.prototype.createWebChannel=b0.prototype.g,fa.prototype.send=fa.prototype.o,fa.prototype.open=fa.prototype.m,fa.prototype.close=fa.prototype.close,Hle=function(){return new b0},Wle=function(){return jl()},Ble=Ga,h7={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},bi.NO_ERROR=0,bi.TIMEOUT=8,bi.HTTP_ERROR=6,hR=bi,on.COMPLETE="complete",Vle=on,xu.EventType=Mo,Mo.OPEN="a",Mo.CLOSE="b",Mo.ERROR="c",Mo.MESSAGE="d",On.prototype.listen=On.prototype.K,qx=xu,ds.prototype.listenOnce=ds.prototype.L,ds.prototype.getLastError=ds.prototype.Ka,ds.prototype.getLastErrorCode=ds.prototype.Ba,ds.prototype.getStatus=ds.prototype.Z,ds.prototype.getResponseJson=ds.prototype.Oa,ds.prototype.getResponseText=ds.prototype.oa,ds.prototype.send=ds.prototype.ea,ds.prototype.setWithCredentials=ds.prototype.Ha,Fle=ds}).apply(typeof VT<"u"?VT:typeof self<"u"?self:typeof window<"u"?window:{});const uJ="@firebase/firestore",hJ="4.7.10";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jo{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}jo.UNAUTHENTICATED=new jo(null),jo.GOOGLE_CREDENTIALS=new jo("google-credentials-uid"),jo.FIRST_PARTY=new jo("first-party-uid"),jo.MOCK_USER=new jo("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tS="11.5.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sw=new f4("@firebase/firestore");function cC(){return sw.logLevel}function bt(s,...e){if(sw.logLevel<=Fi.DEBUG){const t=e.map(v$);sw.debug(`Firestore (${tS}): ${s}`,...t)}}function _g(s,...e){if(sw.logLevel<=Fi.ERROR){const t=e.map(v$);sw.error(`Firestore (${tS}): ${s}`,...t)}}function Zy(s,...e){if(sw.logLevel<=Fi.WARN){const t=e.map(v$);sw.warn(`Firestore (${tS}): ${s}`,...t)}}function v$(s){if(typeof s=="string")return s;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(s)}catch{return s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function li(s="Unexpected state"){const e=`FIRESTORE (${tS}) INTERNAL ASSERTION FAILED: `+s;throw _g(e),new Error(e)}function Dn(s,e){s||li()}function _i(s,e){return s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const We={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class vt extends fd{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rg{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zle{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Lxe{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(jo.UNAUTHENTICATED))}shutdown(){}}class kxe{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Ixe{constructor(e){this.t=e,this.currentUser=jo.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Dn(this.o===void 0);let i=this.i;const n=l=>this.i!==i?(i=this.i,t(l)):Promise.resolve();let r=new rg;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new rg,e.enqueueRetryable(()=>n(this.currentUser))};const o=()=>{const l=r;e.enqueueRetryable(async()=>{await l.promise,await n(this.currentUser)})},a=l=>{bt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(bt("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new rg)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(bt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Dn(typeof i.accessToken=="string"),new zle(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Dn(e===null||typeof e=="string"),new jo(e)}}class Exe{constructor(e,t,i){this.l=e,this.h=t,this.P=i,this.type="FirstParty",this.user=jo.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class Dxe{constructor(e,t,i){this.l=e,this.h=t,this.P=i}getToken(){return Promise.resolve(new Exe(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(jo.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class fJ{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Txe{constructor(e,t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null,this.V=null,rc(e)&&e.settings.appCheckToken&&(this.V=e.settings.appCheckToken)}start(e,t){Dn(this.o===void 0);const i=r=>{r.error!=null&&bt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${r.error.message}`);const o=r.token!==this.R;return this.R=r.token,bt("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(r.token):Promise.resolve()};this.o=r=>{e.enqueueRetryable(()=>i(r))};const n=r=>{bt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=r,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(r=>n(r)),setTimeout(()=>{if(!this.appCheck){const r=this.A.getImmediate({optional:!0});r?n(r):bt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.V)return Promise.resolve(new fJ(this.V));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Dn(typeof t.token=="string"),this.R=t.token,new fJ(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nxe(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<s;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ule(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jle{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const n=Nxe(40);for(let r=0;r<n.length;++r)i.length<20&&n[r]<t&&(i+=e.charAt(n[r]%62))}return i}}function Ei(s,e){return s<e?-1:s>e?1:0}function f7(s,e){let t=0;for(;t<s.length&&t<e.length;){const i=s.codePointAt(t),n=e.codePointAt(t);if(i!==n){if(i<128&&n<128)return Ei(i,n);{const r=Ule(),o=Rxe(r.encode(gJ(s,t)),r.encode(gJ(e,t)));return o!==0?o:Ei(i,n)}}t+=i>65535?2:1}return Ei(s.length,e.length)}function gJ(s,e){return s.codePointAt(e)>65535?s.substring(e,e+2):s.substring(e,e+1)}function Rxe(s,e){for(let t=0;t<s.length&&t<e.length;++t)if(s[t]!==e[t])return Ei(s[t],e[t]);return Ei(s.length,e.length)}function Jy(s,e,t){return s.length===e.length&&s.every((i,n)=>t(i,e[n]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pJ=-62135596800,mJ=1e6;class ur{static now(){return ur.fromMillis(Date.now())}static fromDate(e){return ur.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*mJ);return new ur(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new vt(We.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new vt(We.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<pJ)throw new vt(We.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new vt(We.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/mJ}_compareTo(e){return this.seconds===e.seconds?Ei(this.nanoseconds,e.nanoseconds):Ei(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-pJ;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{static fromTimestamp(e){return new fi(e)}static min(){return new fi(new ur(0,0))}static max(){return new fi(new ur(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _J="__name__";class th{constructor(e,t,i){t===void 0?t=0:t>e.length&&li(),i===void 0?i=e.length-t:i>e.length-t&&li(),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return th.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof th?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let n=0;n<i;n++){const r=th.compareSegments(e.get(n),t.get(n));if(r!==0)return r}return Ei(e.length,t.length)}static compareSegments(e,t){const i=th.isNumericId(e),n=th.isNumericId(t);return i&&!n?-1:!i&&n?1:i&&n?th.extractNumericId(e).compare(th.extractNumericId(t)):f7(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return sm.fromString(e.substring(4,e.length-2))}}class ls extends th{construct(e,t,i){return new ls(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new vt(We.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(n=>n.length>0))}return new ls(t)}static emptyPath(){return new ls([])}}const Axe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class mo extends th{construct(e,t,i){return new mo(e,t,i)}static isValidIdentifier(e){return Axe.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),mo.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===_J}static keyField(){return new mo([_J])}static fromServerFormat(e){const t=[];let i="",n=0;const r=()=>{if(i.length===0)throw new vt(We.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let o=!1;for(;n<e.length;){const a=e[n];if(a==="\\"){if(n+1===e.length)throw new vt(We.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[n+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new vt(We.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=l,n+=2}else a==="`"?(o=!o,n++):a!=="."||o?(i+=a,n++):(r(),n++)}if(r(),o)throw new vt(We.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new mo(t)}static emptyPath(){return new mo([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $t{constructor(e){this.path=e}static fromPath(e){return new $t(ls.fromString(e))}static fromName(e){return new $t(ls.fromString(e).popFirst(5))}static empty(){return new $t(ls.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ls.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ls.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new $t(new ls(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fk=-1;function Pxe(s,e){const t=s.toTimestamp().seconds,i=s.toTimestamp().nanoseconds+1,n=fi.fromTimestamp(i===1e9?new ur(t+1,0):new ur(t,i));return new Rm(n,$t.empty(),e)}function Mxe(s){return new Rm(s.readTime,s.key,Fk)}class Rm{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Rm(fi.min(),$t.empty(),Fk)}static max(){return new Rm(fi.max(),$t.empty(),Fk)}}function Oxe(s,e){let t=s.readTime.compareTo(e.readTime);return t!==0?t:(t=$t.comparator(s.documentKey,e.documentKey),t!==0?t:Ei(s.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fxe="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Vxe{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iS(s){if(s.code!==We.FAILED_PRECONDITION||s.message!==Fxe)throw s;bt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class He{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&li(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new He((i,n)=>{this.nextCallback=r=>{this.wrapSuccess(e,r).next(i,n)},this.catchCallback=r=>{this.wrapFailure(t,r).next(i,n)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof He?t:He.resolve(t)}catch(t){return He.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):He.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):He.reject(t)}static resolve(e){return new He((t,i)=>{t(e)})}static reject(e){return new He((t,i)=>{i(e)})}static waitFor(e){return new He((t,i)=>{let n=0,r=0,o=!1;e.forEach(a=>{++n,a.next(()=>{++r,o&&r===n&&t()},l=>i(l))}),o=!0,r===n&&t()})}static or(e){let t=He.resolve(!1);for(const i of e)t=t.next(n=>n?He.resolve(n):i());return t}static forEach(e,t){const i=[];return e.forEach((n,r)=>{i.push(t.call(this,n,r))}),this.waitFor(i)}static mapArray(e,t){return new He((i,n)=>{const r=e.length,o=new Array(r);let a=0;for(let l=0;l<r;l++){const c=l;t(e[c]).next(d=>{o[c]=d,++a,a===r&&i(o)},d=>n(d))}})}static doWhile(e,t){return new He((i,n)=>{const r=()=>{e()===!0?t().next(()=>{r()},n):i()};r()})}}function Bxe(s){const e=s.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function nS(s){return s.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v4{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.oe(i),this._e=i=>t.writeSequenceNumber(i))}oe(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this._e&&this._e(e),e}}v4.ae=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w$=-1;function w4(s){return s==null}function g2(s){return s===0&&1/s==-1/0}function Wxe(s){return typeof s=="number"&&Number.isInteger(s)&&!g2(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $le="";function Hxe(s){let e="";for(let t=0;t<s.length;t++)e.length>0&&(e=bJ(e)),e=zxe(s.get(t),e);return bJ(e)}function zxe(s,e){let t=e;const i=s.length;for(let n=0;n<i;n++){const r=s.charAt(n);switch(r){case"\0":t+="";break;case $le:t+="";break;default:t+=r}}return t}function bJ(s){return s+$le+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vJ(s){let e=0;for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e++;return e}function h_(s,e){for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e(t,s[t])}function qle(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is{constructor(e,t){this.comparator=e,this.root=t||uo.EMPTY}insert(e,t){return new Is(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,uo.BLACK,null,null))}remove(e){return new Is(this.comparator,this.root.remove(e,this.comparator).copy(null,null,uo.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const n=this.comparator(e,i.key);if(n===0)return t+i.left.size;n<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){const e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new BT(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new BT(this.root,e,this.comparator,!1)}getReverseIterator(){return new BT(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new BT(this.root,e,this.comparator,!0)}}class BT{constructor(e,t,i,n){this.isReverse=n,this.nodeStack=[];let r=1;for(;!e.isEmpty();)if(r=t?i(e.key,t):1,t&&n&&(r*=-1),r<0)e=this.isReverse?e.left:e.right;else{if(r===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class uo{constructor(e,t,i,n,r){this.key=e,this.value=t,this.color=i??uo.RED,this.left=n??uo.EMPTY,this.right=r??uo.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,n,r){return new uo(e??this.key,t??this.value,i??this.color,n??this.left,r??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let n=this;const r=i(e,n.key);return n=r<0?n.copy(null,null,null,n.left.insert(e,t,i),null):r===0?n.copy(null,t,null,null,null):n.copy(null,null,null,null,n.right.insert(e,t,i)),n.fixUp()}removeMin(){if(this.left.isEmpty())return uo.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,n=this;if(t(e,n.key)<0)n.left.isEmpty()||n.left.isRed()||n.left.left.isRed()||(n=n.moveRedLeft()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed()&&(n=n.rotateRight()),n.right.isEmpty()||n.right.isRed()||n.right.left.isRed()||(n=n.moveRedRight()),t(e,n.key)===0){if(n.right.isEmpty())return uo.EMPTY;i=n.right.min(),n=n.copy(i.key,i.value,null,null,n.right.removeMin())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,uo.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,uo.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw li();const e=this.left.check();if(e!==this.right.check())throw li();return e+(this.isRed()?0:1)}}uo.EMPTY=null,uo.RED=!0,uo.BLACK=!1;uo.EMPTY=new class{constructor(){this.size=0}get key(){throw li()}get value(){throw li()}get color(){throw li()}get left(){throw li()}get right(){throw li()}copy(e,t,i,n,r){return this}insert(e,t,i){return new uo(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kr{constructor(e){this.comparator=e,this.data=new Is(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const n=i.getNext();if(this.comparator(n.key,e[1])>=0)return;t(n.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new wJ(this.data.getIterator())}getIteratorFrom(e){return new wJ(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof kr)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const n=t.getNext().key,r=i.getNext().key;if(this.comparator(n,r)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new kr(this.comparator);return t.data=e,t}}class wJ{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cc{constructor(e){this.fields=e,e.sort(mo.comparator)}static empty(){return new cc([])}unionWith(e){let t=new kr(mo.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new cc(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Jy(this.fields,e.fields,(t,i)=>t.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kle extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(n){try{return atob(n)}catch(r){throw typeof DOMException<"u"&&r instanceof DOMException?new Kle("Invalid base64 string: "+r):r}}(e);return new xo(t)}static fromUint8Array(e){const t=function(n){let r="";for(let o=0;o<n.length;++o)r+=String.fromCharCode(n[o]);return r}(e);return new xo(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const i=new Uint8Array(t.length);for(let n=0;n<t.length;n++)i[n]=t.charCodeAt(n);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ei(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}xo.EMPTY_BYTE_STRING=new xo("");const Uxe=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Am(s){if(Dn(!!s),typeof s=="string"){let e=0;const t=Uxe.exec(s);if(Dn(!!t),t[1]){let n=t[1];n=(n+"000000000").substr(0,9),e=Number(n)}const i=new Date(s);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:qs(s.seconds),nanos:qs(s.nanos)}}function qs(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function Pm(s){return typeof s=="string"?xo.fromBase64String(s):xo.fromUint8Array(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gle="server_timestamp",Qle="__type__",Yle="__previous_value__",Xle="__local_write_time__";function C$(s){var e,t;return((t=(((e=s==null?void 0:s.mapValue)===null||e===void 0?void 0:e.fields)||{})[Qle])===null||t===void 0?void 0:t.stringValue)===Gle}function C4(s){const e=s.mapValue.fields[Yle];return C$(e)?C4(e):e}function Vk(s){const e=Am(s.mapValue.fields[Xle].timestampValue);return new ur(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jxe{constructor(e,t,i,n,r,o,a,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=n,this.ssl=r,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}}const p2="(default)";class Bk{constructor(e,t){this.projectId=e,this.database=t||p2}static empty(){return new Bk("","")}get isDefaultDatabase(){return this.database===p2}isEqual(e){return e instanceof Bk&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zle="__type__",$xe="__max__",WT={mapValue:{}},Jle="__vector__",m2="value";function Mm(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?C$(s)?4:Kxe(s)?9007199254740991:qxe(s)?10:11:li()}function Ih(s,e){if(s===e)return!0;const t=Mm(s);if(t!==Mm(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return Vk(s).isEqual(Vk(e));case 3:return function(n,r){if(typeof n.timestampValue=="string"&&typeof r.timestampValue=="string"&&n.timestampValue.length===r.timestampValue.length)return n.timestampValue===r.timestampValue;const o=Am(n.timestampValue),a=Am(r.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(s,e);case 5:return s.stringValue===e.stringValue;case 6:return function(n,r){return Pm(n.bytesValue).isEqual(Pm(r.bytesValue))}(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return function(n,r){return qs(n.geoPointValue.latitude)===qs(r.geoPointValue.latitude)&&qs(n.geoPointValue.longitude)===qs(r.geoPointValue.longitude)}(s,e);case 2:return function(n,r){if("integerValue"in n&&"integerValue"in r)return qs(n.integerValue)===qs(r.integerValue);if("doubleValue"in n&&"doubleValue"in r){const o=qs(n.doubleValue),a=qs(r.doubleValue);return o===a?g2(o)===g2(a):isNaN(o)&&isNaN(a)}return!1}(s,e);case 9:return Jy(s.arrayValue.values||[],e.arrayValue.values||[],Ih);case 10:case 11:return function(n,r){const o=n.mapValue.fields||{},a=r.mapValue.fields||{};if(vJ(o)!==vJ(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Ih(o[l],a[l])))return!1;return!0}(s,e);default:return li()}}function Wk(s,e){return(s.values||[]).find(t=>Ih(t,e))!==void 0}function e1(s,e){if(s===e)return 0;const t=Mm(s),i=Mm(e);if(t!==i)return Ei(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ei(s.booleanValue,e.booleanValue);case 2:return function(r,o){const a=qs(r.integerValue||r.doubleValue),l=qs(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(s,e);case 3:return CJ(s.timestampValue,e.timestampValue);case 4:return CJ(Vk(s),Vk(e));case 5:return f7(s.stringValue,e.stringValue);case 6:return function(r,o){const a=Pm(r),l=Pm(o);return a.compareTo(l)}(s.bytesValue,e.bytesValue);case 7:return function(r,o){const a=r.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const d=Ei(a[c],l[c]);if(d!==0)return d}return Ei(a.length,l.length)}(s.referenceValue,e.referenceValue);case 8:return function(r,o){const a=Ei(qs(r.latitude),qs(o.latitude));return a!==0?a:Ei(qs(r.longitude),qs(o.longitude))}(s.geoPointValue,e.geoPointValue);case 9:return yJ(s.arrayValue,e.arrayValue);case 10:return function(r,o){var a,l,c,d;const u=r.fields||{},h=o.fields||{},g=(a=u[m2])===null||a===void 0?void 0:a.arrayValue,p=(l=h[m2])===null||l===void 0?void 0:l.arrayValue,_=Ei(((c=g==null?void 0:g.values)===null||c===void 0?void 0:c.length)||0,((d=p==null?void 0:p.values)===null||d===void 0?void 0:d.length)||0);return _!==0?_:yJ(g,p)}(s.mapValue,e.mapValue);case 11:return function(r,o){if(r===WT.mapValue&&o===WT.mapValue)return 0;if(r===WT.mapValue)return 1;if(o===WT.mapValue)return-1;const a=r.fields||{},l=Object.keys(a),c=o.fields||{},d=Object.keys(c);l.sort(),d.sort();for(let u=0;u<l.length&&u<d.length;++u){const h=f7(l[u],d[u]);if(h!==0)return h;const g=e1(a[l[u]],c[d[u]]);if(g!==0)return g}return Ei(l.length,d.length)}(s.mapValue,e.mapValue);default:throw li()}}function CJ(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return Ei(s,e);const t=Am(s),i=Am(e),n=Ei(t.seconds,i.seconds);return n!==0?n:Ei(t.nanos,i.nanos)}function yJ(s,e){const t=s.values||[],i=e.values||[];for(let n=0;n<t.length&&n<i.length;++n){const r=e1(t[n],i[n]);if(r)return r}return Ei(t.length,i.length)}function t1(s){return g7(s)}function g7(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?function(t){const i=Am(t);return`time(${i.seconds},${i.nanos})`}(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?function(t){return Pm(t).toBase64()}(s.bytesValue):"referenceValue"in s?function(t){return $t.fromName(t).toString()}(s.referenceValue):"geoPointValue"in s?function(t){return`geo(${t.latitude},${t.longitude})`}(s.geoPointValue):"arrayValue"in s?function(t){let i="[",n=!0;for(const r of t.values||[])n?n=!1:i+=",",i+=g7(r);return i+"]"}(s.arrayValue):"mapValue"in s?function(t){const i=Object.keys(t.fields||{}).sort();let n="{",r=!0;for(const o of i)r?r=!1:n+=",",n+=`${o}:${g7(t.fields[o])}`;return n+"}"}(s.mapValue):li()}function fR(s){switch(Mm(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=C4(s);return e?16+fR(e):16;case 5:return 2*s.stringValue.length;case 6:return Pm(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return function(i){return(i.values||[]).reduce((n,r)=>n+fR(r),0)}(s.arrayValue);case 10:case 11:return function(i){let n=0;return h_(i.fields,(r,o)=>{n+=r.length+fR(o)}),n}(s.mapValue);default:throw li()}}function SJ(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function p7(s){return!!s&&"integerValue"in s}function y$(s){return!!s&&"arrayValue"in s}function xJ(s){return!!s&&"nullValue"in s}function LJ(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function gR(s){return!!s&&"mapValue"in s}function qxe(s){var e,t;return((t=(((e=s==null?void 0:s.mapValue)===null||e===void 0?void 0:e.fields)||{})[Zle])===null||t===void 0?void 0:t.stringValue)===Jle}function CL(s){if(s.geoPointValue)return{geoPointValue:Object.assign({},s.geoPointValue)};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:Object.assign({},s.timestampValue)};if(s.mapValue){const e={mapValue:{fields:{}}};return h_(s.mapValue.fields,(t,i)=>e.mapValue.fields[t]=CL(i)),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(s.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=CL(s.arrayValue.values[t]);return e}return Object.assign({},s)}function Kxe(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===$xe}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pl{constructor(e){this.value=e}static empty(){return new pl({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!gR(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=CL(t)}setAll(e){let t=mo.emptyPath(),i={},n=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,i,n),i={},n=[],t=a.popLast()}o?i[a.lastSegment()]=CL(o):n.push(a.lastSegment())});const r=this.getFieldsMap(t);this.applyChanges(r,i,n)}delete(e){const t=this.field(e.popLast());gR(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ih(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let n=t.mapValue.fields[e.get(i)];gR(n)&&n.mapValue.fields||(n={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=n),t=n}return t.mapValue.fields}applyChanges(e,t,i){h_(t,(n,r)=>e[n]=r);for(const n of i)delete e[n]}clone(){return new pl(CL(this.value))}}function ece(s){const e=[];return h_(s.fields,(t,i)=>{const n=new mo([t]);if(gR(i)){const r=ece(i.mapValue).fields;if(r.length===0)e.push(n);else for(const o of r)e.push(n.child(o))}else e.push(n)}),new cc(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qo{constructor(e,t,i,n,r,o,a){this.key=e,this.documentType=t,this.version=i,this.readTime=n,this.createTime=r,this.data=o,this.documentState=a}static newInvalidDocument(e){return new qo(e,0,fi.min(),fi.min(),fi.min(),pl.empty(),0)}static newFoundDocument(e,t,i,n){return new qo(e,1,t,fi.min(),i,n,0)}static newNoDocument(e,t){return new qo(e,2,t,fi.min(),fi.min(),pl.empty(),0)}static newUnknownDocument(e,t){return new qo(e,3,t,fi.min(),fi.min(),pl.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(fi.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=pl.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=pl.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=fi.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof qo&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new qo(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _2{constructor(e,t){this.position=e,this.inclusive=t}}function kJ(s,e,t){let i=0;for(let n=0;n<s.position.length;n++){const r=e[n],o=s.position[n];if(r.field.isKeyField()?i=$t.comparator($t.fromName(o.referenceValue),t.key):i=e1(o,t.data.field(r.field)),r.dir==="desc"&&(i*=-1),i!==0)break}return i}function IJ(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let t=0;t<s.position.length;t++)if(!Ih(s.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hk{constructor(e,t="asc"){this.field=e,this.dir=t}}function Gxe(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tce{}class lr extends tce{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new Yxe(e,t,i):t==="array-contains"?new Jxe(e,i):t==="in"?new eLe(e,i):t==="not-in"?new tLe(e,i):t==="array-contains-any"?new iLe(e,i):new lr(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new Xxe(e,i):new Zxe(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(e1(t,this.value)):t!==null&&Mm(this.value)===Mm(t)&&this.matchesComparison(e1(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return li()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class cu extends tce{constructor(e,t){super(),this.filters=e,this.op=t,this.ce=null}static create(e,t){return new cu(e,t)}matches(e){return ice(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ce!==null||(this.ce=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ce}getFilters(){return Object.assign([],this.filters)}}function ice(s){return s.op==="and"}function nce(s){return Qxe(s)&&ice(s)}function Qxe(s){for(const e of s.filters)if(e instanceof cu)return!1;return!0}function m7(s){if(s instanceof lr)return s.field.canonicalString()+s.op.toString()+t1(s.value);if(nce(s))return s.filters.map(e=>m7(e)).join(",");{const e=s.filters.map(t=>m7(t)).join(",");return`${s.op}(${e})`}}function sce(s,e){return s instanceof lr?function(i,n){return n instanceof lr&&i.op===n.op&&i.field.isEqual(n.field)&&Ih(i.value,n.value)}(s,e):s instanceof cu?function(i,n){return n instanceof cu&&i.op===n.op&&i.filters.length===n.filters.length?i.filters.reduce((r,o,a)=>r&&sce(o,n.filters[a]),!0):!1}(s,e):void li()}function rce(s){return s instanceof lr?function(t){return`${t.field.canonicalString()} ${t.op} ${t1(t.value)}`}(s):s instanceof cu?function(t){return t.op.toString()+" {"+t.getFilters().map(rce).join(" ,")+"}"}(s):"Filter"}class Yxe extends lr{constructor(e,t,i){super(e,t,i),this.key=$t.fromName(i.referenceValue)}matches(e){const t=$t.comparator(e.key,this.key);return this.matchesComparison(t)}}class Xxe extends lr{constructor(e,t){super(e,"in",t),this.keys=oce("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Zxe extends lr{constructor(e,t){super(e,"not-in",t),this.keys=oce("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function oce(s,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(i=>$t.fromName(i.referenceValue))}class Jxe extends lr{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return y$(t)&&Wk(t.arrayValue,this.value)}}class eLe extends lr{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Wk(this.value.arrayValue,t)}}class tLe extends lr{constructor(e,t){super(e,"not-in",t)}matches(e){if(Wk(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!Wk(this.value.arrayValue,t)}}class iLe extends lr{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!y$(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>Wk(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nLe{constructor(e,t=null,i=[],n=[],r=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=n,this.limit=r,this.startAt=o,this.endAt=a,this.le=null}}function EJ(s,e=null,t=[],i=[],n=null,r=null,o=null){return new nLe(s,e,t,i,n,r,o)}function S$(s){const e=_i(s);if(e.le===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>m7(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>function(r){return r.field.canonicalString()+r.dir}(i)).join(","),w4(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>t1(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>t1(i)).join(",")),e.le=t}return e.le}function x$(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<s.orderBy.length;t++)if(!Gxe(s.orderBy[t],e.orderBy[t]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let t=0;t<s.filters.length;t++)if(!sce(s.filters[t],e.filters[t]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!IJ(s.startAt,e.startAt)&&IJ(s.endAt,e.endAt)}function _7(s){return $t.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sS{constructor(e,t=null,i=[],n=[],r=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=n,this.limit=r,this.limitType=o,this.startAt=a,this.endAt=l,this.he=null,this.Pe=null,this.Te=null,this.startAt,this.endAt}}function sLe(s,e,t,i,n,r,o,a){return new sS(s,e,t,i,n,r,o,a)}function y4(s){return new sS(s)}function DJ(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function ace(s){return s.collectionGroup!==null}function yL(s){const e=_i(s);if(e.he===null){e.he=[];const t=new Set;for(const r of e.explicitOrderBy)e.he.push(r),t.add(r.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new kr(mo.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(r=>{t.has(r.canonicalString())||r.isKeyField()||e.he.push(new Hk(r,i))}),t.has(mo.keyField().canonicalString())||e.he.push(new Hk(mo.keyField(),i))}return e.he}function vh(s){const e=_i(s);return e.Pe||(e.Pe=rLe(e,yL(s))),e.Pe}function rLe(s,e){if(s.limitType==="F")return EJ(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map(n=>{const r=n.dir==="desc"?"asc":"desc";return new Hk(n.field,r)});const t=s.endAt?new _2(s.endAt.position,s.endAt.inclusive):null,i=s.startAt?new _2(s.startAt.position,s.startAt.inclusive):null;return EJ(s.path,s.collectionGroup,e,s.filters,s.limit,t,i)}}function b7(s,e){const t=s.filters.concat([e]);return new sS(s.path,s.collectionGroup,s.explicitOrderBy.slice(),t,s.limit,s.limitType,s.startAt,s.endAt)}function b2(s,e,t){return new sS(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,t,s.startAt,s.endAt)}function S4(s,e){return x$(vh(s),vh(e))&&s.limitType===e.limitType}function lce(s){return`${S$(vh(s))}|lt:${s.limitType}`}function dC(s){return`Query(target=${function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map(n=>rce(n)).join(", ")}]`),w4(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map(n=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(n)).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map(n=>t1(n)).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map(n=>t1(n)).join(",")),`Target(${i})`}(vh(s))}; limitType=${s.limitType})`}function x4(s,e){return e.isFoundDocument()&&function(i,n){const r=n.key.path;return i.collectionGroup!==null?n.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(r):$t.isDocumentKey(i.path)?i.path.isEqual(r):i.path.isImmediateParentOf(r)}(s,e)&&function(i,n){for(const r of yL(i))if(!r.field.isKeyField()&&n.data.field(r.field)===null)return!1;return!0}(s,e)&&function(i,n){for(const r of i.filters)if(!r.matches(n))return!1;return!0}(s,e)&&function(i,n){return!(i.startAt&&!function(o,a,l){const c=kJ(o,a,l);return o.inclusive?c<=0:c<0}(i.startAt,yL(i),n)||i.endAt&&!function(o,a,l){const c=kJ(o,a,l);return o.inclusive?c>=0:c>0}(i.endAt,yL(i),n))}(s,e)}function oLe(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function cce(s){return(e,t)=>{let i=!1;for(const n of yL(s)){const r=aLe(n,e,t);if(r!==0)return r;i=i||n.field.isKeyField()}return 0}}function aLe(s,e,t){const i=s.field.isKeyField()?$t.comparator(e.key,t.key):function(r,o,a){const l=o.data.field(r),c=a.data.field(r);return l!==null&&c!==null?e1(l,c):li()}(s.field,e,t);switch(s.dir){case"asc":return i;case"desc":return-1*i;default:return li()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bw{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[n,r]of i)if(this.equalsFn(n,e))return r}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),n=this.inner[i];if(n===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return void(n[r]=[e,t]);n.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let n=0;n<i.length;n++)if(this.equalsFn(i[n][0],e))return i.length===1?delete this.inner[t]:i.splice(n,1),this.innerSize--,!0;return!1}forEach(e){h_(this.inner,(t,i)=>{for(const[n,r]of i)e(n,r)})}isEmpty(){return qle(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lLe=new Is($t.comparator);function bg(){return lLe}const dce=new Is($t.comparator);function Kx(...s){let e=dce;for(const t of s)e=e.insert(t.key,t);return e}function uce(s){let e=dce;return s.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function Ob(){return SL()}function hce(){return SL()}function SL(){return new Bw(s=>s.toString(),(s,e)=>s.isEqual(e))}const cLe=new Is($t.comparator),dLe=new kr($t.comparator);function Bi(...s){let e=dLe;for(const t of s)e=e.add(t);return e}const uLe=new kr(Ei);function hLe(){return uLe}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L$(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:g2(e)?"-0":e}}function fce(s){return{integerValue:""+s}}function gce(s,e){return Wxe(e)?fce(e):L$(s,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L4{constructor(){this._=void 0}}function fLe(s,e,t){return s instanceof zk?function(n,r){const o={fields:{[Qle]:{stringValue:Gle},[Xle]:{timestampValue:{seconds:n.seconds,nanos:n.nanoseconds}}}};return r&&C$(r)&&(r=C4(r)),r&&(o.fields[Yle]=r),{mapValue:o}}(t,e):s instanceof i1?mce(s,e):s instanceof n1?_ce(s,e):function(n,r){const o=pce(n,r),a=TJ(o)+TJ(n.Ie);return p7(o)&&p7(n.Ie)?fce(a):L$(n.serializer,a)}(s,e)}function gLe(s,e,t){return s instanceof i1?mce(s,e):s instanceof n1?_ce(s,e):t}function pce(s,e){return s instanceof Uk?function(i){return p7(i)||function(r){return!!r&&"doubleValue"in r}(i)}(e)?e:{integerValue:0}:null}class zk extends L4{}class i1 extends L4{constructor(e){super(),this.elements=e}}function mce(s,e){const t=bce(e);for(const i of s.elements)t.some(n=>Ih(n,i))||t.push(i);return{arrayValue:{values:t}}}class n1 extends L4{constructor(e){super(),this.elements=e}}function _ce(s,e){let t=bce(e);for(const i of s.elements)t=t.filter(n=>!Ih(n,i));return{arrayValue:{values:t}}}class Uk extends L4{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function TJ(s){return qs(s.integerValue||s.doubleValue)}function bce(s){return y$(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k4{constructor(e,t){this.field=e,this.transform=t}}function pLe(s,e){return s.field.isEqual(e.field)&&function(i,n){return i instanceof i1&&n instanceof i1||i instanceof n1&&n instanceof n1?Jy(i.elements,n.elements,Ih):i instanceof Uk&&n instanceof Uk?Ih(i.Ie,n.Ie):i instanceof zk&&n instanceof zk}(s.transform,e.transform)}class mLe{constructor(e,t){this.version=e,this.transformResults=t}}class ed{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ed}static exists(e){return new ed(void 0,e)}static updateTime(e){return new ed(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function pR(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class I4{}function vce(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new k$(s.key,ed.none()):new AE(s.key,s.data,ed.none());{const t=s.data,i=pl.empty();let n=new kr(mo.comparator);for(let r of e.fields)if(!n.has(r)){let o=t.field(r);o===null&&r.length>1&&(r=r.popLast(),o=t.field(r)),o===null?i.delete(r):i.set(r,o),n=n.add(r)}return new f_(s.key,i,new cc(n.toArray()),ed.none())}}function _Le(s,e,t){s instanceof AE?function(n,r,o){const a=n.value.clone(),l=RJ(n.fieldTransforms,r,o.transformResults);a.setAll(l),r.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(s,e,t):s instanceof f_?function(n,r,o){if(!pR(n.precondition,r))return void r.convertToUnknownDocument(o.version);const a=RJ(n.fieldTransforms,r,o.transformResults),l=r.data;l.setAll(wce(n)),l.setAll(a),r.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(s,e,t):function(n,r,o){r.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function xL(s,e,t,i){return s instanceof AE?function(r,o,a,l){if(!pR(r.precondition,o))return a;const c=r.value.clone(),d=AJ(r.fieldTransforms,l,o);return c.setAll(d),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(s,e,t,i):s instanceof f_?function(r,o,a,l){if(!pR(r.precondition,o))return a;const c=AJ(r.fieldTransforms,l,o),d=o.data;return d.setAll(wce(r)),d.setAll(c),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map(u=>u.field))}(s,e,t,i):function(r,o,a){return pR(r.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(s,e,t)}function bLe(s,e){let t=null;for(const i of s.fieldTransforms){const n=e.data.field(i.field),r=pce(i.transform,n||null);r!=null&&(t===null&&(t=pl.empty()),t.set(i.field,r))}return t||null}function NJ(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!function(i,n){return i===void 0&&n===void 0||!(!i||!n)&&Jy(i,n,(r,o)=>pLe(r,o))}(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class AE extends I4{constructor(e,t,i,n=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=n,this.type=0}getFieldMask(){return null}}class f_ extends I4{constructor(e,t,i,n,r=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=n,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function wce(s){const e=new Map;return s.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const i=s.data.field(t);e.set(t,i)}}),e}function RJ(s,e,t){const i=new Map;Dn(s.length===t.length);for(let n=0;n<t.length;n++){const r=s[n],o=r.transform,a=e.data.field(r.field);i.set(r.field,gLe(o,a,t[n]))}return i}function AJ(s,e,t){const i=new Map;for(const n of s){const r=n.transform,o=t.data.field(n.field);i.set(n.field,fLe(r,o,e))}return i}class k$ extends I4{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class vLe extends I4{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wLe{constructor(e,t,i,n){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=n}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let n=0;n<this.mutations.length;n++){const r=this.mutations[n];r.key.isEqual(e.key)&&_Le(r,e,i[n])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=xL(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=xL(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=hce();return this.mutations.forEach(n=>{const r=e.get(n.key),o=r.overlayedDocument;let a=this.applyToLocalView(o,r.mutatedFields);a=t.has(n.key)?null:a;const l=vce(o,a);l!==null&&i.set(n.key,l),o.isValidDocument()||o.convertToNoDocument(fi.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Bi())}isEqual(e){return this.batchId===e.batchId&&Jy(this.mutations,e.mutations,(t,i)=>NJ(t,i))&&Jy(this.baseMutations,e.baseMutations,(t,i)=>NJ(t,i))}}class I${constructor(e,t,i,n){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=n}static from(e,t,i){Dn(e.mutations.length===i.length);let n=function(){return cLe}();const r=e.mutations;for(let o=0;o<r.length;o++)n=n.insert(r[o].key,i[o].version);return new I$(e,t,i,n)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CLe{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yLe{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var or,Xi;function SLe(s){switch(s){case We.OK:return li();case We.CANCELLED:case We.UNKNOWN:case We.DEADLINE_EXCEEDED:case We.RESOURCE_EXHAUSTED:case We.INTERNAL:case We.UNAVAILABLE:case We.UNAUTHENTICATED:return!1;case We.INVALID_ARGUMENT:case We.NOT_FOUND:case We.ALREADY_EXISTS:case We.PERMISSION_DENIED:case We.FAILED_PRECONDITION:case We.ABORTED:case We.OUT_OF_RANGE:case We.UNIMPLEMENTED:case We.DATA_LOSS:return!0;default:return li()}}function Cce(s){if(s===void 0)return _g("GRPC error has no .code"),We.UNKNOWN;switch(s){case or.OK:return We.OK;case or.CANCELLED:return We.CANCELLED;case or.UNKNOWN:return We.UNKNOWN;case or.DEADLINE_EXCEEDED:return We.DEADLINE_EXCEEDED;case or.RESOURCE_EXHAUSTED:return We.RESOURCE_EXHAUSTED;case or.INTERNAL:return We.INTERNAL;case or.UNAVAILABLE:return We.UNAVAILABLE;case or.UNAUTHENTICATED:return We.UNAUTHENTICATED;case or.INVALID_ARGUMENT:return We.INVALID_ARGUMENT;case or.NOT_FOUND:return We.NOT_FOUND;case or.ALREADY_EXISTS:return We.ALREADY_EXISTS;case or.PERMISSION_DENIED:return We.PERMISSION_DENIED;case or.FAILED_PRECONDITION:return We.FAILED_PRECONDITION;case or.ABORTED:return We.ABORTED;case or.OUT_OF_RANGE:return We.OUT_OF_RANGE;case or.UNIMPLEMENTED:return We.UNIMPLEMENTED;case or.DATA_LOSS:return We.DATA_LOSS;default:return li()}}(Xi=or||(or={}))[Xi.OK=0]="OK",Xi[Xi.CANCELLED=1]="CANCELLED",Xi[Xi.UNKNOWN=2]="UNKNOWN",Xi[Xi.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Xi[Xi.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Xi[Xi.NOT_FOUND=5]="NOT_FOUND",Xi[Xi.ALREADY_EXISTS=6]="ALREADY_EXISTS",Xi[Xi.PERMISSION_DENIED=7]="PERMISSION_DENIED",Xi[Xi.UNAUTHENTICATED=16]="UNAUTHENTICATED",Xi[Xi.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Xi[Xi.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Xi[Xi.ABORTED=10]="ABORTED",Xi[Xi.OUT_OF_RANGE=11]="OUT_OF_RANGE",Xi[Xi.UNIMPLEMENTED=12]="UNIMPLEMENTED",Xi[Xi.INTERNAL=13]="INTERNAL",Xi[Xi.UNAVAILABLE=14]="UNAVAILABLE",Xi[Xi.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xLe=new sm([4294967295,4294967295],0);function PJ(s){const e=Ule().encode(s),t=new Ole;return t.update(e),new Uint8Array(t.digest())}function MJ(s){const e=new DataView(s.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),n=e.getUint32(8,!0),r=e.getUint32(12,!0);return[new sm([t,i],0),new sm([n,r],0)]}class E${constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new Gx(`Invalid padding: ${t}`);if(i<0)throw new Gx(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Gx(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new Gx(`Invalid padding when bitmap length is 0: ${t}`);this.Ee=8*e.length-t,this.de=sm.fromNumber(this.Ee)}Ae(e,t,i){let n=e.add(t.multiply(sm.fromNumber(i)));return n.compare(xLe)===1&&(n=new sm([n.getBits(0),n.getBits(1)],0)),n.modulo(this.de).toNumber()}Re(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.Ee===0)return!1;const t=PJ(e),[i,n]=MJ(t);for(let r=0;r<this.hashCount;r++){const o=this.Ae(i,n,r);if(!this.Re(o))return!1}return!0}static create(e,t,i){const n=e%8==0?0:8-e%8,r=new Uint8Array(Math.ceil(e/8)),o=new E$(r,n,t);return i.forEach(a=>o.insert(a)),o}insert(e){if(this.Ee===0)return;const t=PJ(e),[i,n]=MJ(t);for(let r=0;r<this.hashCount;r++){const o=this.Ae(i,n,r);this.Ve(o)}}Ve(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class Gx extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E4{constructor(e,t,i,n,r){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=n,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const n=new Map;return n.set(e,PE.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new E4(fi.min(),n,new Is(Ei),bg(),Bi())}}class PE{constructor(e,t,i,n,r){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=n,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new PE(i,t,Bi(),Bi(),Bi())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mR{constructor(e,t,i,n){this.me=e,this.removedTargetIds=t,this.key=i,this.fe=n}}class yce{constructor(e,t){this.targetId=e,this.ge=t}}class Sce{constructor(e,t,i=xo.EMPTY_BYTE_STRING,n=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=n}}class OJ{constructor(){this.pe=0,this.ye=FJ(),this.we=xo.EMPTY_BYTE_STRING,this.Se=!1,this.be=!0}get current(){return this.Se}get resumeToken(){return this.we}get De(){return this.pe!==0}get ve(){return this.be}Ce(e){e.approximateByteSize()>0&&(this.be=!0,this.we=e)}Fe(){let e=Bi(),t=Bi(),i=Bi();return this.ye.forEach((n,r)=>{switch(r){case 0:e=e.add(n);break;case 2:t=t.add(n);break;case 1:i=i.add(n);break;default:li()}}),new PE(this.we,this.Se,e,t,i)}Me(){this.be=!1,this.ye=FJ()}xe(e,t){this.be=!0,this.ye=this.ye.insert(e,t)}Oe(e){this.be=!0,this.ye=this.ye.remove(e)}Ne(){this.pe+=1}Be(){this.pe-=1,Dn(this.pe>=0)}Le(){this.be=!0,this.Se=!0}}class LLe{constructor(e){this.ke=e,this.qe=new Map,this.Qe=bg(),this.$e=HT(),this.Ue=HT(),this.Ke=new Is(Ei)}We(e){for(const t of e.me)e.fe&&e.fe.isFoundDocument()?this.Ge(t,e.fe):this.ze(t,e.key,e.fe);for(const t of e.removedTargetIds)this.ze(t,e.key,e.fe)}je(e){this.forEachTarget(e,t=>{const i=this.He(t);switch(e.state){case 0:this.Je(t)&&i.Ce(e.resumeToken);break;case 1:i.Be(),i.De||i.Me(),i.Ce(e.resumeToken);break;case 2:i.Be(),i.De||this.removeTarget(t);break;case 3:this.Je(t)&&(i.Le(),i.Ce(e.resumeToken));break;case 4:this.Je(t)&&(this.Ye(t),i.Ce(e.resumeToken));break;default:li()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.qe.forEach((i,n)=>{this.Je(n)&&t(n)})}Ze(e){const t=e.targetId,i=e.ge.count,n=this.Xe(t);if(n){const r=n.target;if(_7(r))if(i===0){const o=new $t(r.path);this.ze(t,o,qo.newNoDocument(o,fi.min()))}else Dn(i===1);else{const o=this.et(t);if(o!==i){const a=this.tt(e),l=a?this.nt(a,e,o):1;if(l!==0){this.Ye(t);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,c)}}}}}tt(e){const t=e.ge.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:n=0},hashCount:r=0}=t;let o,a;try{o=Pm(i).toUint8Array()}catch(l){if(l instanceof Kle)return Zy("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new E$(o,n,r)}catch(l){return Zy(l instanceof Gx?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ee===0?null:a}nt(e,t,i){return t.ge.count===i-this.st(e,t.targetId)?0:2}st(e,t){const i=this.ke.getRemoteKeysForTarget(t);let n=0;return i.forEach(r=>{const o=this.ke.it(),a=`projects/${o.projectId}/databases/${o.database}/documents/${r.path.canonicalString()}`;e.mightContain(a)||(this.ze(t,r,null),n++)}),n}ot(e){const t=new Map;this.qe.forEach((r,o)=>{const a=this.Xe(o);if(a){if(r.current&&_7(a.target)){const l=new $t(a.target.path);this._t(l).has(o)||this.ut(o,l)||this.ze(o,l,qo.newNoDocument(l,e))}r.ve&&(t.set(o,r.Fe()),r.Me())}});let i=Bi();this.Ue.forEach((r,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.Xe(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(i=i.add(r))}),this.Qe.forEach((r,o)=>o.setReadTime(e));const n=new E4(e,t,this.Ke,this.Qe,i);return this.Qe=bg(),this.$e=HT(),this.Ue=HT(),this.Ke=new Is(Ei),n}Ge(e,t){if(!this.Je(e))return;const i=this.ut(e,t.key)?2:0;this.He(e).xe(t.key,i),this.Qe=this.Qe.insert(t.key,t),this.$e=this.$e.insert(t.key,this._t(t.key).add(e)),this.Ue=this.Ue.insert(t.key,this.ct(t.key).add(e))}ze(e,t,i){if(!this.Je(e))return;const n=this.He(e);this.ut(e,t)?n.xe(t,1):n.Oe(t),this.Ue=this.Ue.insert(t,this.ct(t).delete(e)),this.Ue=this.Ue.insert(t,this.ct(t).add(e)),i&&(this.Qe=this.Qe.insert(t,i))}removeTarget(e){this.qe.delete(e)}et(e){const t=this.He(e).Fe();return this.ke.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ne(e){this.He(e).Ne()}He(e){let t=this.qe.get(e);return t||(t=new OJ,this.qe.set(e,t)),t}ct(e){let t=this.Ue.get(e);return t||(t=new kr(Ei),this.Ue=this.Ue.insert(e,t)),t}_t(e){let t=this.$e.get(e);return t||(t=new kr(Ei),this.$e=this.$e.insert(e,t)),t}Je(e){const t=this.Xe(e)!==null;return t||bt("WatchChangeAggregator","Detected inactive target",e),t}Xe(e){const t=this.qe.get(e);return t&&t.De?null:this.ke.lt(e)}Ye(e){this.qe.set(e,new OJ),this.ke.getRemoteKeysForTarget(e).forEach(t=>{this.ze(e,t,null)})}ut(e,t){return this.ke.getRemoteKeysForTarget(e).has(t)}}function HT(){return new Is($t.comparator)}function FJ(){return new Is($t.comparator)}const kLe={asc:"ASCENDING",desc:"DESCENDING"},ILe={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ELe={and:"AND",or:"OR"};class DLe{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function v7(s,e){return s.useProto3Json||w4(e)?e:{value:e}}function v2(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function xce(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function TLe(s,e){return v2(s,e.toTimestamp())}function wh(s){return Dn(!!s),fi.fromTimestamp(function(t){const i=Am(t);return new ur(i.seconds,i.nanos)}(s))}function D$(s,e){return w7(s,e).canonicalString()}function w7(s,e){const t=function(n){return new ls(["projects",n.projectId,"databases",n.database])}(s).child("documents");return e===void 0?t:t.child(e)}function Lce(s){const e=ls.fromString(s);return Dn(Tce(e)),e}function C7(s,e){return D$(s.databaseId,e.path)}function w9(s,e){const t=Lce(e);if(t.get(1)!==s.databaseId.projectId)throw new vt(We.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+s.databaseId.projectId);if(t.get(3)!==s.databaseId.database)throw new vt(We.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+s.databaseId.database);return new $t(Ice(t))}function kce(s,e){return D$(s.databaseId,e)}function NLe(s){const e=Lce(s);return e.length===4?ls.emptyPath():Ice(e)}function y7(s){return new ls(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function Ice(s){return Dn(s.length>4&&s.get(4)==="documents"),s.popFirst(5)}function VJ(s,e,t){return{name:C7(s,e),fields:t.value.mapValue.fields}}function RLe(s,e){let t;if("targetChange"in e){e.targetChange;const i=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:li()}(e.targetChange.targetChangeType||"NO_CHANGE"),n=e.targetChange.targetIds||[],r=function(c,d){return c.useProto3Json?(Dn(d===void 0||typeof d=="string"),xo.fromBase64String(d||"")):(Dn(d===void 0||d instanceof Buffer||d instanceof Uint8Array),xo.fromUint8Array(d||new Uint8Array))}(s,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const d=c.code===void 0?We.UNKNOWN:Cce(c.code);return new vt(d,c.message||"")}(o);t=new Sce(i,n,r,a||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const n=w9(s,i.document.name),r=wh(i.document.updateTime),o=i.document.createTime?wh(i.document.createTime):fi.min(),a=new pl({mapValue:{fields:i.document.fields}}),l=qo.newFoundDocument(n,r,o,a),c=i.targetIds||[],d=i.removedTargetIds||[];t=new mR(c,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const n=w9(s,i.document),r=i.readTime?wh(i.readTime):fi.min(),o=qo.newNoDocument(n,r),a=i.removedTargetIds||[];t=new mR([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const n=w9(s,i.document),r=i.removedTargetIds||[];t=new mR([],r,n,null)}else{if(!("filter"in e))return li();{e.filter;const i=e.filter;i.targetId;const{count:n=0,unchangedNames:r}=i,o=new yLe(n,r),a=i.targetId;t=new yce(a,o)}}return t}function ALe(s,e){let t;if(e instanceof AE)t={update:VJ(s,e.key,e.value)};else if(e instanceof k$)t={delete:C7(s,e.key)};else if(e instanceof f_)t={update:VJ(s,e.key,e.data),updateMask:zLe(e.fieldMask)};else{if(!(e instanceof vLe))return li();t={verify:C7(s,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>function(r,o){const a=o.transform;if(a instanceof zk)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof i1)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof n1)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Uk)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw li()}(0,i))),e.precondition.isNone||(t.currentDocument=function(n,r){return r.updateTime!==void 0?{updateTime:TLe(n,r.updateTime)}:r.exists!==void 0?{exists:r.exists}:li()}(s,e.precondition)),t}function PLe(s,e){return s&&s.length>0?(Dn(e!==void 0),s.map(t=>function(n,r){let o=n.updateTime?wh(n.updateTime):wh(r);return o.isEqual(fi.min())&&(o=wh(r)),new mLe(o,n.transformResults||[])}(t,e))):[]}function MLe(s,e){return{documents:[kce(s,e.path)]}}function OLe(s,e){const t={structuredQuery:{}},i=e.path;let n;e.collectionGroup!==null?(n=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=kce(s,n);const r=function(c){if(c.length!==0)return Dce(cu.create(c,"and"))}(e.filters);r&&(t.structuredQuery.where=r);const o=function(c){if(c.length!==0)return c.map(d=>function(h){return{field:uC(h.field),direction:BLe(h.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=v7(s,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{ht:t,parent:n}}function FLe(s){let e=NLe(s.parent);const t=s.structuredQuery,i=t.from?t.from.length:0;let n=null;if(i>0){Dn(i===1);const d=t.from[0];d.allDescendants?n=d.collectionId:e=e.child(d.collectionId)}let r=[];t.where&&(r=function(u){const h=Ece(u);return h instanceof cu&&nce(h)?h.getFilters():[h]}(t.where));let o=[];t.orderBy&&(o=function(u){return u.map(h=>function(p){return new Hk(hC(p.field),function(v){switch(v){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(p.direction))}(h))}(t.orderBy));let a=null;t.limit&&(a=function(u){let h;return h=typeof u=="object"?u.value:u,w4(h)?null:h}(t.limit));let l=null;t.startAt&&(l=function(u){const h=!!u.before,g=u.values||[];return new _2(g,h)}(t.startAt));let c=null;return t.endAt&&(c=function(u){const h=!u.before,g=u.values||[];return new _2(g,h)}(t.endAt)),sLe(e,n,o,r,a,"F",l,c)}function VLe(s,e){const t=function(n){switch(n){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return li()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Ece(s){return s.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=hC(t.unaryFilter.field);return lr.create(i,"==",{doubleValue:NaN});case"IS_NULL":const n=hC(t.unaryFilter.field);return lr.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=hC(t.unaryFilter.field);return lr.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=hC(t.unaryFilter.field);return lr.create(o,"!=",{nullValue:"NULL_VALUE"});default:return li()}}(s):s.fieldFilter!==void 0?function(t){return lr.create(hC(t.fieldFilter.field),function(n){switch(n){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return li()}}(t.fieldFilter.op),t.fieldFilter.value)}(s):s.compositeFilter!==void 0?function(t){return cu.create(t.compositeFilter.filters.map(i=>Ece(i)),function(n){switch(n){case"AND":return"and";case"OR":return"or";default:return li()}}(t.compositeFilter.op))}(s):li()}function BLe(s){return kLe[s]}function WLe(s){return ILe[s]}function HLe(s){return ELe[s]}function uC(s){return{fieldPath:s.canonicalString()}}function hC(s){return mo.fromServerFormat(s.fieldPath)}function Dce(s){return s instanceof lr?function(t){if(t.op==="=="){if(LJ(t.value))return{unaryFilter:{field:uC(t.field),op:"IS_NAN"}};if(xJ(t.value))return{unaryFilter:{field:uC(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(LJ(t.value))return{unaryFilter:{field:uC(t.field),op:"IS_NOT_NAN"}};if(xJ(t.value))return{unaryFilter:{field:uC(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:uC(t.field),op:WLe(t.op),value:t.value}}}(s):s instanceof cu?function(t){const i=t.getFilters().map(n=>Dce(n));return i.length===1?i[0]:{compositeFilter:{op:HLe(t.op),filters:i}}}(s):li()}function zLe(s){const e=[];return s.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Tce(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wp{constructor(e,t,i,n,r=fi.min(),o=fi.min(),a=xo.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=n,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Wp(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Wp(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Wp(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Wp(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ULe{constructor(e){this.Tt=e}}function jLe(s){const e=FLe({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?b2(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $Le{constructor(){this.Tn=new qLe}addToCollectionParentIndex(e,t){return this.Tn.add(t),He.resolve()}getCollectionParents(e,t){return He.resolve(this.Tn.getEntries(t))}addFieldIndex(e,t){return He.resolve()}deleteFieldIndex(e,t){return He.resolve()}deleteAllFieldIndexes(e){return He.resolve()}createTargetIndexes(e,t){return He.resolve()}getDocumentsMatchingTarget(e,t){return He.resolve(null)}getIndexType(e,t){return He.resolve(0)}getFieldIndexes(e,t){return He.resolve([])}getNextCollectionGroupToUpdate(e){return He.resolve(null)}getMinOffset(e,t){return He.resolve(Rm.min())}getMinOffsetFromCollectionGroup(e,t){return He.resolve(Rm.min())}updateCollectionGroup(e,t,i){return He.resolve()}updateIndexEntries(e,t){return He.resolve()}}class qLe{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),n=this.index[t]||new kr(ls.comparator),r=!n.has(i);return this.index[t]=n.add(i),r}has(e){const t=e.lastSegment(),i=e.popLast(),n=this.index[t];return n&&n.has(i)}getEntries(e){return(this.index[e]||new kr(ls.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BJ={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Nce=41943040;class cl{static withCacheSize(e){return new cl(e,cl.DEFAULT_COLLECTION_PERCENTILE,cl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */cl.DEFAULT_COLLECTION_PERCENTILE=10,cl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,cl.DEFAULT=new cl(Nce,cl.DEFAULT_COLLECTION_PERCENTILE,cl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),cl.DISABLED=new cl(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s1{constructor(e){this.$n=e}next(){return this.$n+=2,this.$n}static Un(){return new s1(0)}static Kn(){return new s1(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WJ="LruGarbageCollector",KLe=1048576;function HJ([s,e],[t,i]){const n=Ei(s,t);return n===0?Ei(e,i):n}class GLe{constructor(e){this.Hn=e,this.buffer=new kr(HJ),this.Jn=0}Yn(){return++this.Jn}Zn(e){const t=[e,this.Yn()];if(this.buffer.size<this.Hn)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();HJ(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class QLe{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Xn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.er(6e4)}stop(){this.Xn&&(this.Xn.cancel(),this.Xn=null)}get started(){return this.Xn!==null}er(e){bt(WJ,`Garbage collection scheduled in ${e}ms`),this.Xn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Xn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){nS(t)?bt(WJ,"Ignoring IndexedDB error during garbage collection: ",t):await iS(t)}await this.er(3e5)})}}class YLe{constructor(e,t){this.tr=e,this.params=t}calculateTargetCount(e,t){return this.tr.nr(e).next(i=>Math.floor(t/100*i))}nthSequenceNumber(e,t){if(t===0)return He.resolve(v4.ae);const i=new GLe(t);return this.tr.forEachTarget(e,n=>i.Zn(n.sequenceNumber)).next(()=>this.tr.rr(e,n=>i.Zn(n))).next(()=>i.maxValue)}removeTargets(e,t,i){return this.tr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.tr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(bt("LruGarbageCollector","Garbage collection skipped; disabled"),He.resolve(BJ)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(bt("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),BJ):this.ir(e,t))}getCacheSize(e){return this.tr.getCacheSize(e)}ir(e,t){let i,n,r,o,a,l,c;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(u=>(u>this.params.maximumSequenceNumbersToCollect?(bt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${u}`),n=this.params.maximumSequenceNumbersToCollect):n=u,o=Date.now(),this.nthSequenceNumber(e,n))).next(u=>(i=u,a=Date.now(),this.removeTargets(e,i,t))).next(u=>(r=u,l=Date.now(),this.removeOrphanedDocuments(e,i))).next(u=>(c=Date.now(),cC()<=Fi.DEBUG&&bt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${n} in `+(a-o)+`ms
	Removed ${r} targets in `+(l-a)+`ms
	Removed ${u} documents in `+(c-l)+`ms
Total Duration: ${c-d}ms`),He.resolve({didRun:!0,sequenceNumbersCollected:n,targetsRemoved:r,documentsRemoved:u})))}}function XLe(s,e){return new YLe(s,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZLe{constructor(){this.changes=new Bw(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,qo.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?He.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JLe{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eke{constructor(e,t,i,n){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=n}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(n=>(i=n,this.remoteDocumentCache.getEntry(e,t))).next(n=>(i!==null&&xL(i.mutation,n,cc.empty(),ur.now()),n))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,Bi()).next(()=>i))}getLocalViewOfDocuments(e,t,i=Bi()){const n=Ob();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,i).next(r=>{let o=Kx();return r.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const i=Ob();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,Bi()))}populateOverlays(e,t,i){const n=[];return i.forEach(r=>{t.has(r)||n.push(r)}),this.documentOverlayCache.getOverlays(e,n).next(r=>{r.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,i,n){let r=bg();const o=SL(),a=function(){return SL()}();return t.forEach((l,c)=>{const d=i.get(c.key);n.has(c.key)&&(d===void 0||d.mutation instanceof f_)?r=r.insert(c.key,c):d!==void 0?(o.set(c.key,d.mutation.getFieldMask()),xL(d.mutation,c,d.mutation.getFieldMask(),ur.now())):o.set(c.key,cc.empty())}),this.recalculateAndSaveOverlays(e,r).next(l=>(l.forEach((c,d)=>o.set(c,d)),t.forEach((c,d)=>{var u;return a.set(c,new JLe(d,(u=o.get(c))!==null&&u!==void 0?u:null))}),a))}recalculateAndSaveOverlays(e,t){const i=SL();let n=new Is((o,a)=>o-a),r=Bi();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=t.get(l);if(c===null)return;let d=i.get(l)||cc.empty();d=a.applyToLocalView(c,d),i.set(l,d);const u=(n.get(a.batchId)||Bi()).add(l);n=n.insert(a.batchId,u)})}).next(()=>{const o=[],a=n.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,d=l.value,u=hce();d.forEach(h=>{if(!r.has(h)){const g=vce(t.get(h),i.get(h));g!==null&&u.set(h,g),r=r.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,u))}return He.waitFor(o)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,n){return function(o){return $t.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):ace(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,n):this.getDocumentsMatchingCollectionQuery(e,t,i,n)}getNextDocuments(e,t,i,n){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,n).next(r=>{const o=n-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,n-r.size):He.resolve(Ob());let a=Fk,l=r;return o.next(c=>He.forEach(c,(d,u)=>(a<u.largestBatchId&&(a=u.largestBatchId),r.get(d)?He.resolve():this.remoteDocumentCache.getEntry(e,d).next(h=>{l=l.insert(d,h)}))).next(()=>this.populateOverlays(e,c,r)).next(()=>this.computeViews(e,l,c,Bi())).next(d=>({batchId:a,changes:uce(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new $t(t)).next(i=>{let n=Kx();return i.isFoundDocument()&&(n=n.insert(i.key,i)),n})}getDocumentsMatchingCollectionGroupQuery(e,t,i,n){const r=t.collectionGroup;let o=Kx();return this.indexManager.getCollectionParents(e,r).next(a=>He.forEach(a,l=>{const c=function(u,h){return new sS(h,null,u.explicitOrderBy.slice(),u.filters.slice(),u.limit,u.limitType,u.startAt,u.endAt)}(t,l.child(r));return this.getDocumentsMatchingCollectionQuery(e,c,i,n).next(d=>{d.forEach((u,h)=>{o=o.insert(u,h)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,i,n){let r;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(o=>(r=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,r,n))).next(o=>{r.forEach((l,c)=>{const d=c.getKey();o.get(d)===null&&(o=o.insert(d,qo.newInvalidDocument(d)))});let a=Kx();return o.forEach((l,c)=>{const d=r.get(l);d!==void 0&&xL(d.mutation,c,cc.empty(),ur.now()),x4(t,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tke{constructor(e){this.serializer=e,this.dr=new Map,this.Ar=new Map}getBundleMetadata(e,t){return He.resolve(this.dr.get(t))}saveBundleMetadata(e,t){return this.dr.set(t.id,function(n){return{id:n.id,version:n.version,createTime:wh(n.createTime)}}(t)),He.resolve()}getNamedQuery(e,t){return He.resolve(this.Ar.get(t))}saveNamedQuery(e,t){return this.Ar.set(t.name,function(n){return{name:n.name,query:jLe(n.bundledQuery),readTime:wh(n.readTime)}}(t)),He.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ike{constructor(){this.overlays=new Is($t.comparator),this.Rr=new Map}getOverlay(e,t){return He.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Ob();return He.forEach(t,n=>this.getOverlay(e,n).next(r=>{r!==null&&i.set(n,r)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((n,r)=>{this.Et(e,t,r)}),He.resolve()}removeOverlaysForBatchId(e,t,i){const n=this.Rr.get(i);return n!==void 0&&(n.forEach(r=>this.overlays=this.overlays.remove(r)),this.Rr.delete(i)),He.resolve()}getOverlaysForCollection(e,t,i){const n=Ob(),r=t.length+1,o=new $t(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===r&&l.largestBatchId>i&&n.set(l.getKey(),l)}return He.resolve(n)}getOverlaysForCollectionGroup(e,t,i,n){let r=new Is((c,d)=>c-d);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>i){let d=r.get(c.largestBatchId);d===null&&(d=Ob(),r=r.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}const a=Ob(),l=r.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,d)=>a.set(c,d)),!(a.size()>=n)););return He.resolve(a)}Et(e,t,i){const n=this.overlays.get(i.key);if(n!==null){const o=this.Rr.get(n.largestBatchId).delete(i.key);this.Rr.set(n.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new CLe(t,i));let r=this.Rr.get(t);r===void 0&&(r=Bi(),this.Rr.set(t,r)),this.Rr.set(t,r.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nke{constructor(){this.sessionToken=xo.EMPTY_BYTE_STRING}getSessionToken(e){return He.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,He.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T${constructor(){this.Vr=new kr(jr.mr),this.gr=new kr(jr.pr)}isEmpty(){return this.Vr.isEmpty()}addReference(e,t){const i=new jr(e,t);this.Vr=this.Vr.add(i),this.gr=this.gr.add(i)}yr(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.wr(new jr(e,t))}Sr(e,t){e.forEach(i=>this.removeReference(i,t))}br(e){const t=new $t(new ls([])),i=new jr(t,e),n=new jr(t,e+1),r=[];return this.gr.forEachInRange([i,n],o=>{this.wr(o),r.push(o.key)}),r}Dr(){this.Vr.forEach(e=>this.wr(e))}wr(e){this.Vr=this.Vr.delete(e),this.gr=this.gr.delete(e)}vr(e){const t=new $t(new ls([])),i=new jr(t,e),n=new jr(t,e+1);let r=Bi();return this.gr.forEachInRange([i,n],o=>{r=r.add(o.key)}),r}containsKey(e){const t=new jr(e,0),i=this.Vr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class jr{constructor(e,t){this.key=e,this.Cr=t}static mr(e,t){return $t.comparator(e.key,t.key)||Ei(e.Cr,t.Cr)}static pr(e,t){return Ei(e.Cr,t.Cr)||$t.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ske{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Fr=1,this.Mr=new kr(jr.mr)}checkEmpty(e){return He.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,n){const r=this.Fr;this.Fr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new wLe(r,t,i,n);this.mutationQueue.push(o);for(const a of n)this.Mr=this.Mr.add(new jr(a.key,r)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return He.resolve(o)}lookupMutationBatch(e,t){return He.resolve(this.Or(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,n=this.Nr(i),r=n<0?0:n;return He.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return He.resolve(this.mutationQueue.length===0?w$:this.Fr-1)}getAllMutationBatches(e){return He.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new jr(t,0),n=new jr(t,Number.POSITIVE_INFINITY),r=[];return this.Mr.forEachInRange([i,n],o=>{const a=this.Or(o.Cr);r.push(a)}),He.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new kr(Ei);return t.forEach(n=>{const r=new jr(n,0),o=new jr(n,Number.POSITIVE_INFINITY);this.Mr.forEachInRange([r,o],a=>{i=i.add(a.Cr)})}),He.resolve(this.Br(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,n=i.length+1;let r=i;$t.isDocumentKey(r)||(r=r.child(""));const o=new jr(new $t(r),0);let a=new kr(Ei);return this.Mr.forEachWhile(l=>{const c=l.key.path;return!!i.isPrefixOf(c)&&(c.length===n&&(a=a.add(l.Cr)),!0)},o),He.resolve(this.Br(a))}Br(e){const t=[];return e.forEach(i=>{const n=this.Or(i);n!==null&&t.push(n)}),t}removeMutationBatch(e,t){Dn(this.Lr(t.batchId,"removed")===0),this.mutationQueue.shift();let i=this.Mr;return He.forEach(t.mutations,n=>{const r=new jr(n.key,t.batchId);return i=i.delete(r),this.referenceDelegate.markPotentiallyOrphaned(e,n.key)}).next(()=>{this.Mr=i})}qn(e){}containsKey(e,t){const i=new jr(t,0),n=this.Mr.firstAfterOrEqual(i);return He.resolve(t.isEqual(n&&n.key))}performConsistencyCheck(e){return this.mutationQueue.length,He.resolve()}Lr(e,t){return this.Nr(e)}Nr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Or(e){const t=this.Nr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rke{constructor(e){this.kr=e,this.docs=function(){return new Is($t.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,n=this.docs.get(i),r=n?n.size:0,o=this.kr(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-r,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return He.resolve(i?i.document.mutableCopy():qo.newInvalidDocument(t))}getEntries(e,t){let i=bg();return t.forEach(n=>{const r=this.docs.get(n);i=i.insert(n,r?r.document.mutableCopy():qo.newInvalidDocument(n))}),He.resolve(i)}getDocumentsMatchingQuery(e,t,i,n){let r=bg();const o=t.path,a=new $t(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:d}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||Oxe(Mxe(d),i)<=0||(n.has(d.key)||x4(t,d))&&(r=r.insert(d.key,d.mutableCopy()))}return He.resolve(r)}getAllFromCollectionGroup(e,t,i,n){li()}qr(e,t){return He.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new oke(this)}getSize(e){return He.resolve(this.size)}}class oke extends ZLe{constructor(e){super(),this.Ir=e}applyChanges(e){const t=[];return this.changes.forEach((i,n)=>{n.isValidDocument()?t.push(this.Ir.addEntry(e,n)):this.Ir.removeEntry(i)}),He.waitFor(t)}getFromCache(e,t){return this.Ir.getEntry(e,t)}getAllFromCache(e,t){return this.Ir.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ake{constructor(e){this.persistence=e,this.Qr=new Bw(t=>S$(t),x$),this.lastRemoteSnapshotVersion=fi.min(),this.highestTargetId=0,this.$r=0,this.Ur=new T$,this.targetCount=0,this.Kr=s1.Un()}forEachTarget(e,t){return this.Qr.forEach((i,n)=>t(n)),He.resolve()}getLastRemoteSnapshotVersion(e){return He.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return He.resolve(this.$r)}allocateTargetId(e){return this.highestTargetId=this.Kr.next(),He.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.$r&&(this.$r=t),He.resolve()}zn(e){this.Qr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Kr=new s1(t),this.highestTargetId=t),e.sequenceNumber>this.$r&&(this.$r=e.sequenceNumber)}addTargetData(e,t){return this.zn(t),this.targetCount+=1,He.resolve()}updateTargetData(e,t){return this.zn(t),He.resolve()}removeTargetData(e,t){return this.Qr.delete(t.target),this.Ur.br(t.targetId),this.targetCount-=1,He.resolve()}removeTargets(e,t,i){let n=0;const r=[];return this.Qr.forEach((o,a)=>{a.sequenceNumber<=t&&i.get(a.targetId)===null&&(this.Qr.delete(o),r.push(this.removeMatchingKeysForTargetId(e,a.targetId)),n++)}),He.waitFor(r).next(()=>n)}getTargetCount(e){return He.resolve(this.targetCount)}getTargetData(e,t){const i=this.Qr.get(t)||null;return He.resolve(i)}addMatchingKeys(e,t,i){return this.Ur.yr(t,i),He.resolve()}removeMatchingKeys(e,t,i){this.Ur.Sr(t,i);const n=this.persistence.referenceDelegate,r=[];return n&&t.forEach(o=>{r.push(n.markPotentiallyOrphaned(e,o))}),He.waitFor(r)}removeMatchingKeysForTargetId(e,t){return this.Ur.br(t),He.resolve()}getMatchingKeysForTargetId(e,t){const i=this.Ur.vr(t);return He.resolve(i)}containsKey(e,t){return He.resolve(this.Ur.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rce{constructor(e,t){this.Wr={},this.overlays={},this.Gr=new v4(0),this.zr=!1,this.zr=!0,this.jr=new nke,this.referenceDelegate=e(this),this.Hr=new ake(this),this.indexManager=new $Le,this.remoteDocumentCache=function(n){return new rke(n)}(i=>this.referenceDelegate.Jr(i)),this.serializer=new ULe(t),this.Yr=new tke(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.zr=!1,Promise.resolve()}get started(){return this.zr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new ike,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.Wr[e.toKey()];return i||(i=new ske(t,this.referenceDelegate),this.Wr[e.toKey()]=i),i}getGlobalsCache(){return this.jr}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Yr}runTransaction(e,t,i){bt("MemoryPersistence","Starting transaction:",e);const n=new lke(this.Gr.next());return this.referenceDelegate.Zr(),i(n).next(r=>this.referenceDelegate.Xr(n).next(()=>r)).toPromise().then(r=>(n.raiseOnCommittedEvent(),r))}ei(e,t){return He.or(Object.values(this.Wr).map(i=>()=>i.containsKey(e,t)))}}class lke extends Vxe{constructor(e){super(),this.currentSequenceNumber=e}}class N${constructor(e){this.persistence=e,this.ti=new T$,this.ni=null}static ri(e){return new N$(e)}get ii(){if(this.ni)return this.ni;throw li()}addReference(e,t,i){return this.ti.addReference(i,t),this.ii.delete(i.toString()),He.resolve()}removeReference(e,t,i){return this.ti.removeReference(i,t),this.ii.add(i.toString()),He.resolve()}markPotentiallyOrphaned(e,t){return this.ii.add(t.toString()),He.resolve()}removeTarget(e,t){this.ti.br(t.targetId).forEach(n=>this.ii.add(n.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(n=>{n.forEach(r=>this.ii.add(r.toString()))}).next(()=>i.removeTargetData(e,t))}Zr(){this.ni=new Set}Xr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return He.forEach(this.ii,i=>{const n=$t.fromPath(i);return this.si(e,n).next(r=>{r||t.removeEntry(n,fi.min())})}).next(()=>(this.ni=null,t.apply(e)))}updateLimboDocument(e,t){return this.si(e,t).next(i=>{i?this.ii.delete(t.toString()):this.ii.add(t.toString())})}Jr(e){return 0}si(e,t){return He.or([()=>He.resolve(this.ti.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.ei(e,t)])}}class w2{constructor(e,t){this.persistence=e,this.oi=new Bw(i=>Hxe(i.path),(i,n)=>i.isEqual(n)),this.garbageCollector=XLe(this,t)}static ri(e,t){return new w2(e,t)}Zr(){}Xr(e){return He.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}nr(e){const t=this.sr(e);return this.persistence.getTargetCache().getTargetCount(e).next(i=>t.next(n=>i+n))}sr(e){let t=0;return this.rr(e,i=>{t++}).next(()=>t)}rr(e,t){return He.forEach(this.oi,(i,n)=>this.ar(e,i,n).next(r=>r?He.resolve():t(n)))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const n=this.persistence.getRemoteDocumentCache(),r=n.newChangeBuffer();return n.qr(e,o=>this.ar(e,o,t).next(a=>{a||(i++,r.removeEntry(o,fi.min()))})).next(()=>r.apply(e)).next(()=>i)}markPotentiallyOrphaned(e,t){return this.oi.set(t,e.currentSequenceNumber),He.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.oi.set(i,e.currentSequenceNumber),He.resolve()}removeReference(e,t,i){return this.oi.set(i,e.currentSequenceNumber),He.resolve()}updateLimboDocument(e,t){return this.oi.set(t,e.currentSequenceNumber),He.resolve()}Jr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=fR(e.data.value)),t}ar(e,t,i){return He.or([()=>this.persistence.ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const n=this.oi.get(t);return He.resolve(n!==void 0&&n>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R${constructor(e,t,i,n){this.targetId=e,this.fromCache=t,this.Hi=i,this.Ji=n}static Yi(e,t){let i=Bi(),n=Bi();for(const r of t.docChanges)switch(r.type){case 0:i=i.add(r.doc.key);break;case 1:n=n.add(r.doc.key)}return new R$(e,t.fromCache,i,n)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cke{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dke{constructor(){this.Zi=!1,this.Xi=!1,this.es=100,this.ts=function(){return UCe()?8:Bxe(ea())>0?6:4}()}initialize(e,t){this.ns=e,this.indexManager=t,this.Zi=!0}getDocumentsMatchingQuery(e,t,i,n){const r={result:null};return this.rs(e,t).next(o=>{r.result=o}).next(()=>{if(!r.result)return this.ss(e,t,n,i).next(o=>{r.result=o})}).next(()=>{if(r.result)return;const o=new cke;return this._s(e,t,o).next(a=>{if(r.result=a,this.Xi)return this.us(e,t,o,a.size)})}).next(()=>r.result)}us(e,t,i,n){return i.documentReadCount<this.es?(cC()<=Fi.DEBUG&&bt("QueryEngine","SDK will not create cache indexes for query:",dC(t),"since it only creates cache indexes for collection contains","more than or equal to",this.es,"documents"),He.resolve()):(cC()<=Fi.DEBUG&&bt("QueryEngine","Query:",dC(t),"scans",i.documentReadCount,"local documents and returns",n,"documents as results."),i.documentReadCount>this.ts*n?(cC()<=Fi.DEBUG&&bt("QueryEngine","The SDK decides to create cache indexes for query:",dC(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,vh(t))):He.resolve())}rs(e,t){if(DJ(t))return He.resolve(null);let i=vh(t);return this.indexManager.getIndexType(e,i).next(n=>n===0?null:(t.limit!==null&&n===1&&(t=b2(t,null,"F"),i=vh(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(r=>{const o=Bi(...r);return this.ns.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,i).next(l=>{const c=this.cs(t,a);return this.ls(t,c,o,l.readTime)?this.rs(e,b2(t,null,"F")):this.hs(e,c,t,l)}))})))}ss(e,t,i,n){return DJ(t)||n.isEqual(fi.min())?He.resolve(null):this.ns.getDocuments(e,i).next(r=>{const o=this.cs(t,r);return this.ls(t,o,i,n)?He.resolve(null):(cC()<=Fi.DEBUG&&bt("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),dC(t)),this.hs(e,o,t,Pxe(n,Fk)).next(a=>a))})}cs(e,t){let i=new kr(cce(e));return t.forEach((n,r)=>{x4(e,r)&&(i=i.add(r))}),i}ls(e,t,i,n){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const r=e.limitType==="F"?t.last():t.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(n)>0)}_s(e,t,i){return cC()<=Fi.DEBUG&&bt("QueryEngine","Using full collection scan to execute query:",dC(t)),this.ns.getDocumentsMatchingQuery(e,t,Rm.min(),i)}hs(e,t,i,n){return this.ns.getDocumentsMatchingQuery(e,i,n).next(r=>(t.forEach(o=>{r=r.insert(o.key,o)}),r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A$="LocalStore",uke=3e8;class hke{constructor(e,t,i,n){this.persistence=e,this.Ps=t,this.serializer=n,this.Ts=new Is(Ei),this.Is=new Bw(r=>S$(r),x$),this.Es=new Map,this.ds=e.getRemoteDocumentCache(),this.Hr=e.getTargetCache(),this.Yr=e.getBundleCache(),this.As(i)}As(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new eke(this.ds,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ds.setIndexManager(this.indexManager),this.Ps.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ts))}}function fke(s,e,t,i){return new hke(s,e,t,i)}async function Ace(s,e){const t=_i(s);return await t.persistence.runTransaction("Handle user change","readonly",i=>{let n;return t.mutationQueue.getAllMutationBatches(i).next(r=>(n=r,t.As(e),t.mutationQueue.getAllMutationBatches(i))).next(r=>{const o=[],a=[];let l=Bi();for(const c of n){o.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}for(const c of r){a.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}return t.localDocuments.getDocuments(i,l).next(c=>({Rs:c,removedBatchIds:o,addedBatchIds:a}))})})}function gke(s,e){const t=_i(s);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const n=e.batch.keys(),r=t.ds.newChangeBuffer({trackRemovals:!0});return function(a,l,c,d){const u=c.batch,h=u.keys();let g=He.resolve();return h.forEach(p=>{g=g.next(()=>d.getEntry(l,p)).next(_=>{const v=c.docVersions.get(p);Dn(v!==null),_.version.compareTo(v)<0&&(u.applyToRemoteDocument(_,c),_.isValidDocument()&&(_.setReadTime(c.commitVersion),d.addEntry(_)))})}),g.next(()=>a.mutationQueue.removeMutationBatch(l,u))}(t,i,e,r).next(()=>r.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,n,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(a){let l=Bi();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>t.localDocuments.getDocuments(i,n))})}function Pce(s){const e=_i(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Hr.getLastRemoteSnapshotVersion(t))}function pke(s,e){const t=_i(s),i=e.snapshotVersion;let n=t.Ts;return t.persistence.runTransaction("Apply remote event","readwrite-primary",r=>{const o=t.ds.newChangeBuffer({trackRemovals:!0});n=t.Ts;const a=[];e.targetChanges.forEach((d,u)=>{const h=n.get(u);if(!h)return;a.push(t.Hr.removeMatchingKeys(r,d.removedDocuments,u).next(()=>t.Hr.addMatchingKeys(r,d.addedDocuments,u)));let g=h.withSequenceNumber(r.currentSequenceNumber);e.targetMismatches.get(u)!==null?g=g.withResumeToken(xo.EMPTY_BYTE_STRING,fi.min()).withLastLimboFreeSnapshotVersion(fi.min()):d.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(d.resumeToken,i)),n=n.insert(u,g),function(_,v,C){return _.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-_.snapshotVersion.toMicroseconds()>=uke?!0:C.addedDocuments.size+C.modifiedDocuments.size+C.removedDocuments.size>0}(h,g,d)&&a.push(t.Hr.updateTargetData(r,g))});let l=bg(),c=Bi();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(r,d))}),a.push(mke(r,o,e.documentUpdates).next(d=>{l=d.Vs,c=d.fs})),!i.isEqual(fi.min())){const d=t.Hr.getLastRemoteSnapshotVersion(r).next(u=>t.Hr.setTargetsMetadata(r,r.currentSequenceNumber,i));a.push(d)}return He.waitFor(a).next(()=>o.apply(r)).next(()=>t.localDocuments.getLocalViewOfDocuments(r,l,c)).next(()=>l)}).then(r=>(t.Ts=n,r))}function mke(s,e,t){let i=Bi(),n=Bi();return t.forEach(r=>i=i.add(r)),e.getEntries(s,i).next(r=>{let o=bg();return t.forEach((a,l)=>{const c=r.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(n=n.add(a)),l.isNoDocument()&&l.version.isEqual(fi.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):bt(A$,"Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Vs:o,fs:n}})}function _ke(s,e){const t=_i(s);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=w$),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function bke(s,e){const t=_i(s);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let n;return t.Hr.getTargetData(i,e).next(r=>r?(n=r,He.resolve(n)):t.Hr.allocateTargetId(i).next(o=>(n=new Wp(e,o,"TargetPurposeListen",i.currentSequenceNumber),t.Hr.addTargetData(i,n).next(()=>n))))}).then(i=>{const n=t.Ts.get(i.targetId);return(n===null||i.snapshotVersion.compareTo(n.snapshotVersion)>0)&&(t.Ts=t.Ts.insert(i.targetId,i),t.Is.set(e,i.targetId)),i})}async function S7(s,e,t){const i=_i(s),n=i.Ts.get(e),r=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",r,o=>i.persistence.referenceDelegate.removeTarget(o,n))}catch(o){if(!nS(o))throw o;bt(A$,`Failed to update sequence numbers for target ${e}: ${o}`)}i.Ts=i.Ts.remove(e),i.Is.delete(n.target)}function zJ(s,e,t){const i=_i(s);let n=fi.min(),r=Bi();return i.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,d){const u=_i(l),h=u.Is.get(d);return h!==void 0?He.resolve(u.Ts.get(h)):u.Hr.getTargetData(c,d)}(i,o,vh(e)).next(a=>{if(a)return n=a.lastLimboFreeSnapshotVersion,i.Hr.getMatchingKeysForTargetId(o,a.targetId).next(l=>{r=l})}).next(()=>i.Ps.getDocumentsMatchingQuery(o,e,t?n:fi.min(),t?r:Bi())).next(a=>(vke(i,oLe(e),a),{documents:a,gs:r})))}function vke(s,e,t){let i=s.Es.get(e)||fi.min();t.forEach((n,r)=>{r.readTime.compareTo(i)>0&&(i=r.readTime)}),s.Es.set(e,i)}class UJ{constructor(){this.activeTargetIds=hLe()}Ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}vs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}bs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class wke{constructor(){this.ho=new UJ,this.Po={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.ho.Ds(e),this.Po[e]||"not-current"}updateQueryState(e,t,i){this.Po[e]=t}removeLocalQueryTarget(e){this.ho.vs(e)}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){delete this.Po[e]}getAllActiveQueryTargets(){return this.ho.activeTargetIds}isActiveQueryTarget(e){return this.ho.activeTargetIds.has(e)}start(){return this.ho=new UJ,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cke{To(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jJ="ConnectivityMonitor";class $J{constructor(){this.Io=()=>this.Eo(),this.Ao=()=>this.Ro(),this.Vo=[],this.mo()}To(e){this.Vo.push(e)}shutdown(){window.removeEventListener("online",this.Io),window.removeEventListener("offline",this.Ao)}mo(){window.addEventListener("online",this.Io),window.addEventListener("offline",this.Ao)}Eo(){bt(jJ,"Network connectivity changed: AVAILABLE");for(const e of this.Vo)e(0)}Ro(){bt(jJ,"Network connectivity changed: UNAVAILABLE");for(const e of this.Vo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zT=null;function x7(){return zT===null?zT=function(){return 268435456+Math.round(2147483648*Math.random())}():zT++,"0x"+zT.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C9="RestConnection",yke={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Ske{get fo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),n=encodeURIComponent(this.databaseId.database);this.po=t+"://"+e.host,this.yo=`projects/${i}/databases/${n}`,this.wo=this.databaseId.database===p2?`project_id=${i}`:`project_id=${i}&database_id=${n}`}So(e,t,i,n,r){const o=x7(),a=this.bo(e,t.toUriEncodedString());bt(C9,`Sending RPC '${e}' ${o}:`,a,i);const l={"google-cloud-resource-prefix":this.yo,"x-goog-request-params":this.wo};return this.Do(l,n,r),this.vo(e,a,l,i).then(c=>(bt(C9,`Received RPC '${e}' ${o}: `,c),c),c=>{throw Zy(C9,`RPC '${e}' ${o} failed with error: `,c,"url: ",a,"request:",i),c})}Co(e,t,i,n,r,o){return this.So(e,t,i,n,r)}Do(e,t,i){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+tS}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((n,r)=>e[r]=n),i&&i.headers.forEach((n,r)=>e[r]=n)}bo(e,t){const i=yke[e];return`${this.po}/v1/${t}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xke{constructor(e){this.Fo=e.Fo,this.Mo=e.Mo}xo(e){this.Oo=e}No(e){this.Bo=e}Lo(e){this.ko=e}onMessage(e){this.qo=e}close(){this.Mo()}send(e){this.Fo(e)}Qo(){this.Oo()}$o(){this.Bo()}Uo(e){this.ko(e)}Ko(e){this.qo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wo="WebChannelConnection";class Lke extends Ske{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}vo(e,t,i,n){const r=x7();return new Promise((o,a)=>{const l=new Fle;l.setWithCredentials(!0),l.listenOnce(Vle.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case hR.NO_ERROR:const d=l.getResponseJson();bt(Wo,`XHR for RPC '${e}' ${r} received:`,JSON.stringify(d)),o(d);break;case hR.TIMEOUT:bt(Wo,`RPC '${e}' ${r} timed out`),a(new vt(We.DEADLINE_EXCEEDED,"Request time out"));break;case hR.HTTP_ERROR:const u=l.getStatus();if(bt(Wo,`RPC '${e}' ${r} failed with status:`,u,"response text:",l.getResponseText()),u>0){let h=l.getResponseJson();Array.isArray(h)&&(h=h[0]);const g=h==null?void 0:h.error;if(g&&g.status&&g.message){const p=function(v){const C=v.toLowerCase().replace(/_/g,"-");return Object.values(We).indexOf(C)>=0?C:We.UNKNOWN}(g.status);a(new vt(p,g.message))}else a(new vt(We.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new vt(We.UNAVAILABLE,"Connection failed."));break;default:li()}}finally{bt(Wo,`RPC '${e}' ${r} completed.`)}});const c=JSON.stringify(n);bt(Wo,`RPC '${e}' ${r} sending request:`,n),l.send(t,"POST",c,i,15)})}Wo(e,t,i){const n=x7(),r=[this.po,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Hle(),a=Wle(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Do(l.initMessageHeaders,t,i),l.encodeInitMessageHeaders=!0;const d=r.join("");bt(Wo,`Creating RPC '${e}' stream ${n}: ${d}`,l);const u=o.createWebChannel(d,l);let h=!1,g=!1;const p=new xke({Fo:v=>{g?bt(Wo,`Not sending because RPC '${e}' stream ${n} is closed:`,v):(h||(bt(Wo,`Opening RPC '${e}' stream ${n} transport.`),u.open(),h=!0),bt(Wo,`RPC '${e}' stream ${n} sending:`,v),u.send(v))},Mo:()=>u.close()}),_=(v,C,y)=>{v.listen(C,x=>{try{y(x)}catch(L){setTimeout(()=>{throw L},0)}})};return _(u,qx.EventType.OPEN,()=>{g||(bt(Wo,`RPC '${e}' stream ${n} transport opened.`),p.Qo())}),_(u,qx.EventType.CLOSE,()=>{g||(g=!0,bt(Wo,`RPC '${e}' stream ${n} transport closed`),p.Uo())}),_(u,qx.EventType.ERROR,v=>{g||(g=!0,Zy(Wo,`RPC '${e}' stream ${n} transport errored:`,v),p.Uo(new vt(We.UNAVAILABLE,"The operation could not be completed")))}),_(u,qx.EventType.MESSAGE,v=>{var C;if(!g){const y=v.data[0];Dn(!!y);const x=y,L=(x==null?void 0:x.error)||((C=x[0])===null||C===void 0?void 0:C.error);if(L){bt(Wo,`RPC '${e}' stream ${n} received error:`,L);const I=L.status;let A=function(R){const W=or[R];if(W!==void 0)return Cce(W)}(I),D=L.message;A===void 0&&(A=We.INTERNAL,D="Unknown error status: "+I+" with message "+L.message),g=!0,p.Uo(new vt(A,D)),u.close()}else bt(Wo,`RPC '${e}' stream ${n} received:`,y),p.Ko(y)}}),_(a,Ble.STAT_EVENT,v=>{v.stat===h7.PROXY?bt(Wo,`RPC '${e}' stream ${n} detected buffering proxy`):v.stat===h7.NOPROXY&&bt(Wo,`RPC '${e}' stream ${n} detected no buffering proxy`)}),setTimeout(()=>{p.$o()},0),p}}function y9(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D4(s){return new DLe(s,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mce{constructor(e,t,i=1e3,n=1.5,r=6e4){this.Ti=e,this.timerId=t,this.Go=i,this.zo=n,this.jo=r,this.Ho=0,this.Jo=null,this.Yo=Date.now(),this.reset()}reset(){this.Ho=0}Zo(){this.Ho=this.jo}Xo(e){this.cancel();const t=Math.floor(this.Ho+this.e_()),i=Math.max(0,Date.now()-this.Yo),n=Math.max(0,t-i);n>0&&bt("ExponentialBackoff",`Backing off for ${n} ms (base delay: ${this.Ho} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.Jo=this.Ti.enqueueAfterDelay(this.timerId,n,()=>(this.Yo=Date.now(),e())),this.Ho*=this.zo,this.Ho<this.Go&&(this.Ho=this.Go),this.Ho>this.jo&&(this.Ho=this.jo)}t_(){this.Jo!==null&&(this.Jo.skipDelay(),this.Jo=null)}cancel(){this.Jo!==null&&(this.Jo.cancel(),this.Jo=null)}e_(){return(Math.random()-.5)*this.Ho}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qJ="PersistentStream";class Oce{constructor(e,t,i,n,r,o,a,l){this.Ti=e,this.n_=i,this.r_=n,this.connection=r,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.i_=0,this.s_=null,this.o_=null,this.stream=null,this.__=0,this.a_=new Mce(e,t)}u_(){return this.state===1||this.state===5||this.c_()}c_(){return this.state===2||this.state===3}start(){this.__=0,this.state!==4?this.auth():this.l_()}async stop(){this.u_()&&await this.close(0)}h_(){this.state=0,this.a_.reset()}P_(){this.c_()&&this.s_===null&&(this.s_=this.Ti.enqueueAfterDelay(this.n_,6e4,()=>this.T_()))}I_(e){this.E_(),this.stream.send(e)}async T_(){if(this.c_())return this.close(0)}E_(){this.s_&&(this.s_.cancel(),this.s_=null)}d_(){this.o_&&(this.o_.cancel(),this.o_=null)}async close(e,t){this.E_(),this.d_(),this.a_.cancel(),this.i_++,e!==4?this.a_.reset():t&&t.code===We.RESOURCE_EXHAUSTED?(_g(t.toString()),_g("Using maximum backoff delay to prevent overloading the backend."),this.a_.Zo()):t&&t.code===We.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.A_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Lo(t)}A_(){}auth(){this.state=1;const e=this.R_(this.i_),t=this.i_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,n])=>{this.i_===t&&this.V_(i,n)},i=>{e(()=>{const n=new vt(We.UNKNOWN,"Fetching auth token failed: "+i.message);return this.m_(n)})})}V_(e,t){const i=this.R_(this.i_);this.stream=this.f_(e,t),this.stream.xo(()=>{i(()=>this.listener.xo())}),this.stream.No(()=>{i(()=>(this.state=2,this.o_=this.Ti.enqueueAfterDelay(this.r_,1e4,()=>(this.c_()&&(this.state=3),Promise.resolve())),this.listener.No()))}),this.stream.Lo(n=>{i(()=>this.m_(n))}),this.stream.onMessage(n=>{i(()=>++this.__==1?this.g_(n):this.onNext(n))})}l_(){this.state=5,this.a_.Xo(async()=>{this.state=0,this.start()})}m_(e){return bt(qJ,`close with error: ${e}`),this.stream=null,this.close(4,e)}R_(e){return t=>{this.Ti.enqueueAndForget(()=>this.i_===e?t():(bt(qJ,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class kke extends Oce{constructor(e,t,i,n,r,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,n,o),this.serializer=r}f_(e,t){return this.connection.Wo("Listen",e,t)}g_(e){return this.onNext(e)}onNext(e){this.a_.reset();const t=RLe(this.serializer,e),i=function(r){if(!("targetChange"in r))return fi.min();const o=r.targetChange;return o.targetIds&&o.targetIds.length?fi.min():o.readTime?wh(o.readTime):fi.min()}(e);return this.listener.p_(t,i)}y_(e){const t={};t.database=y7(this.serializer),t.addTarget=function(r,o){let a;const l=o.target;if(a=_7(l)?{documents:MLe(r,l)}:{query:OLe(r,l).ht},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=xce(r,o.resumeToken);const c=v7(r,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(fi.min())>0){a.readTime=v2(r,o.snapshotVersion.toTimestamp());const c=v7(r,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const i=VLe(this.serializer,e);i&&(t.labels=i),this.I_(t)}w_(e){const t={};t.database=y7(this.serializer),t.removeTarget=e,this.I_(t)}}class Ike extends Oce{constructor(e,t,i,n,r,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,n,o),this.serializer=r}get S_(){return this.__>0}start(){this.lastStreamToken=void 0,super.start()}A_(){this.S_&&this.b_([])}f_(e,t){return this.connection.Wo("Write",e,t)}g_(e){return Dn(!!e.streamToken),this.lastStreamToken=e.streamToken,Dn(!e.writeResults||e.writeResults.length===0),this.listener.D_()}onNext(e){Dn(!!e.streamToken),this.lastStreamToken=e.streamToken,this.a_.reset();const t=PLe(e.writeResults,e.commitTime),i=wh(e.commitTime);return this.listener.v_(i,t)}C_(){const e={};e.database=y7(this.serializer),this.I_(e)}b_(e){const t={streamToken:this.lastStreamToken,writes:e.map(i=>ALe(this.serializer,i))};this.I_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eke{}class Dke extends Eke{constructor(e,t,i,n){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=n,this.F_=!1}M_(){if(this.F_)throw new vt(We.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,t,i,n){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,o])=>this.connection.So(e,w7(t,i),n,r,o)).catch(r=>{throw r.name==="FirebaseError"?(r.code===We.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new vt(We.UNKNOWN,r.toString())})}Co(e,t,i,n,r){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Co(e,w7(t,i),n,o,a,r)).catch(o=>{throw o.name==="FirebaseError"?(o.code===We.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new vt(We.UNKNOWN,o.toString())})}terminate(){this.F_=!0,this.connection.terminate()}}class Tke{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.x_=0,this.O_=null,this.N_=!0}B_(){this.x_===0&&(this.L_("Unknown"),this.O_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.O_=null,this.k_("Backend didn't respond within 10 seconds."),this.L_("Offline"),Promise.resolve())))}q_(e){this.state==="Online"?this.L_("Unknown"):(this.x_++,this.x_>=1&&(this.Q_(),this.k_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.L_("Offline")))}set(e){this.Q_(),this.x_=0,e==="Online"&&(this.N_=!1),this.L_(e)}L_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}k_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.N_?(_g(t),this.N_=!1):bt("OnlineStateTracker",t)}Q_(){this.O_!==null&&(this.O_.cancel(),this.O_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rw="RemoteStore";class Nke{constructor(e,t,i,n,r){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.U_=[],this.K_=new Map,this.W_=new Set,this.G_=[],this.z_=r,this.z_.To(o=>{i.enqueueAndForget(async()=>{Ww(this)&&(bt(rw,"Restarting streams for network reachability change."),await async function(l){const c=_i(l);c.W_.add(4),await ME(c),c.j_.set("Unknown"),c.W_.delete(4),await T4(c)}(this))})}),this.j_=new Tke(i,n)}}async function T4(s){if(Ww(s))for(const e of s.G_)await e(!0)}async function ME(s){for(const e of s.G_)await e(!1)}function Fce(s,e){const t=_i(s);t.K_.has(e.targetId)||(t.K_.set(e.targetId,e),F$(t)?O$(t):rS(t).c_()&&M$(t,e))}function P$(s,e){const t=_i(s),i=rS(t);t.K_.delete(e),i.c_()&&Vce(t,e),t.K_.size===0&&(i.c_()?i.P_():Ww(t)&&t.j_.set("Unknown"))}function M$(s,e){if(s.H_.Ne(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(fi.min())>0){const t=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}rS(s).y_(e)}function Vce(s,e){s.H_.Ne(e),rS(s).w_(e)}function O$(s){s.H_=new LLe({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),lt:e=>s.K_.get(e)||null,it:()=>s.datastore.serializer.databaseId}),rS(s).start(),s.j_.B_()}function F$(s){return Ww(s)&&!rS(s).u_()&&s.K_.size>0}function Ww(s){return _i(s).W_.size===0}function Bce(s){s.H_=void 0}async function Rke(s){s.j_.set("Online")}async function Ake(s){s.K_.forEach((e,t)=>{M$(s,e)})}async function Pke(s,e){Bce(s),F$(s)?(s.j_.q_(e),O$(s)):s.j_.set("Unknown")}async function Mke(s,e,t){if(s.j_.set("Online"),e instanceof Sce&&e.state===2&&e.cause)try{await async function(n,r){const o=r.cause;for(const a of r.targetIds)n.K_.has(a)&&(await n.remoteSyncer.rejectListen(a,o),n.K_.delete(a),n.H_.removeTarget(a))}(s,e)}catch(i){bt(rw,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await C2(s,i)}else if(e instanceof mR?s.H_.We(e):e instanceof yce?s.H_.Ze(e):s.H_.je(e),!t.isEqual(fi.min()))try{const i=await Pce(s.localStore);t.compareTo(i)>=0&&await function(r,o){const a=r.H_.ot(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const d=r.K_.get(c);d&&r.K_.set(c,d.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const d=r.K_.get(l);if(!d)return;r.K_.set(l,d.withResumeToken(xo.EMPTY_BYTE_STRING,d.snapshotVersion)),Vce(r,l);const u=new Wp(d.target,l,c,d.sequenceNumber);M$(r,u)}),r.remoteSyncer.applyRemoteEvent(a)}(s,t)}catch(i){bt(rw,"Failed to raise snapshot:",i),await C2(s,i)}}async function C2(s,e,t){if(!nS(e))throw e;s.W_.add(1),await ME(s),s.j_.set("Offline"),t||(t=()=>Pce(s.localStore)),s.asyncQueue.enqueueRetryable(async()=>{bt(rw,"Retrying IndexedDB access"),await t(),s.W_.delete(1),await T4(s)})}function Wce(s,e){return e().catch(t=>C2(s,t,e))}async function N4(s){const e=_i(s),t=Om(e);let i=e.U_.length>0?e.U_[e.U_.length-1].batchId:w$;for(;Oke(e);)try{const n=await _ke(e.localStore,i);if(n===null){e.U_.length===0&&t.P_();break}i=n.batchId,Fke(e,n)}catch(n){await C2(e,n)}Hce(e)&&zce(e)}function Oke(s){return Ww(s)&&s.U_.length<10}function Fke(s,e){s.U_.push(e);const t=Om(s);t.c_()&&t.S_&&t.b_(e.mutations)}function Hce(s){return Ww(s)&&!Om(s).u_()&&s.U_.length>0}function zce(s){Om(s).start()}async function Vke(s){Om(s).C_()}async function Bke(s){const e=Om(s);for(const t of s.U_)e.b_(t.mutations)}async function Wke(s,e,t){const i=s.U_.shift(),n=I$.from(i,e,t);await Wce(s,()=>s.remoteSyncer.applySuccessfulWrite(n)),await N4(s)}async function Hke(s,e){e&&Om(s).S_&&await async function(i,n){if(function(o){return SLe(o)&&o!==We.ABORTED}(n.code)){const r=i.U_.shift();Om(i).h_(),await Wce(i,()=>i.remoteSyncer.rejectFailedWrite(r.batchId,n)),await N4(i)}}(s,e),Hce(s)&&zce(s)}async function KJ(s,e){const t=_i(s);t.asyncQueue.verifyOperationInProgress(),bt(rw,"RemoteStore received new credentials");const i=Ww(t);t.W_.add(3),await ME(t),i&&t.j_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.W_.delete(3),await T4(t)}async function zke(s,e){const t=_i(s);e?(t.W_.delete(2),await T4(t)):e||(t.W_.add(2),await ME(t),t.j_.set("Unknown"))}function rS(s){return s.J_||(s.J_=function(t,i,n){const r=_i(t);return r.M_(),new kke(i,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(s.datastore,s.asyncQueue,{xo:Rke.bind(null,s),No:Ake.bind(null,s),Lo:Pke.bind(null,s),p_:Mke.bind(null,s)}),s.G_.push(async e=>{e?(s.J_.h_(),F$(s)?O$(s):s.j_.set("Unknown")):(await s.J_.stop(),Bce(s))})),s.J_}function Om(s){return s.Y_||(s.Y_=function(t,i,n){const r=_i(t);return r.M_(),new Ike(i,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(s.datastore,s.asyncQueue,{xo:()=>Promise.resolve(),No:Vke.bind(null,s),Lo:Hke.bind(null,s),D_:Bke.bind(null,s),v_:Wke.bind(null,s)}),s.G_.push(async e=>{e?(s.Y_.h_(),await N4(s)):(await s.Y_.stop(),s.U_.length>0&&(bt(rw,`Stopping write stream with ${s.U_.length} pending writes`),s.U_=[]))})),s.Y_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V${constructor(e,t,i,n,r){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=n,this.removalCallback=r,this.deferred=new rg,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,n,r){const o=Date.now()+i,a=new V$(e,t,o,n,r);return a.start(i),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new vt(We.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function B$(s,e){if(_g("AsyncQueue",`${e}: ${s}`),nS(s))return new vt(We.UNAVAILABLE,`${e}: ${s}`);throw s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hy{static emptySet(e){return new hy(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||$t.comparator(t.key,i.key):(t,i)=>$t.comparator(t.key,i.key),this.keyedMap=Kx(),this.sortedSet=new Is(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof hy)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const n=t.getNext().key,r=i.getNext().key;if(!n.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new hy;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GJ{constructor(){this.Z_=new Is($t.comparator)}track(e){const t=e.doc.key,i=this.Z_.get(t);i?e.type!==0&&i.type===3?this.Z_=this.Z_.insert(t,e):e.type===3&&i.type!==1?this.Z_=this.Z_.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.Z_=this.Z_.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.Z_=this.Z_.remove(t):e.type===1&&i.type===2?this.Z_=this.Z_.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):li():this.Z_=this.Z_.insert(t,e)}X_(){const e=[];return this.Z_.inorderTraversal((t,i)=>{e.push(i)}),e}}class r1{constructor(e,t,i,n,r,o,a,l,c){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=n,this.mutatedKeys=r,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,i,n,r){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new r1(e,t,hy.emptySet(t),o,i,n,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&S4(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let n=0;n<t.length;n++)if(t[n].type!==i[n].type||!t[n].doc.isEqual(i[n].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uke{constructor(){this.ea=void 0,this.ta=[]}na(){return this.ta.some(e=>e.ra())}}class jke{constructor(){this.queries=QJ(),this.onlineState="Unknown",this.ia=new Set}terminate(){(function(t,i){const n=_i(t),r=n.queries;n.queries=QJ(),r.forEach((o,a)=>{for(const l of a.ta)l.onError(i)})})(this,new vt(We.ABORTED,"Firestore shutting down"))}}function QJ(){return new Bw(s=>lce(s),S4)}async function W$(s,e){const t=_i(s);let i=3;const n=e.query;let r=t.queries.get(n);r?!r.na()&&e.ra()&&(i=2):(r=new Uke,i=e.ra()?0:1);try{switch(i){case 0:r.ea=await t.onListen(n,!0);break;case 1:r.ea=await t.onListen(n,!1);break;case 2:await t.onFirstRemoteStoreListen(n)}}catch(o){const a=B$(o,`Initialization of query '${dC(e.query)}' failed`);return void e.onError(a)}t.queries.set(n,r),r.ta.push(e),e.sa(t.onlineState),r.ea&&e.oa(r.ea)&&z$(t)}async function H$(s,e){const t=_i(s),i=e.query;let n=3;const r=t.queries.get(i);if(r){const o=r.ta.indexOf(e);o>=0&&(r.ta.splice(o,1),r.ta.length===0?n=e.ra()?0:1:!r.na()&&e.ra()&&(n=2))}switch(n){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function $ke(s,e){const t=_i(s);let i=!1;for(const n of e){const r=n.query,o=t.queries.get(r);if(o){for(const a of o.ta)a.oa(n)&&(i=!0);o.ea=n}}i&&z$(t)}function qke(s,e,t){const i=_i(s),n=i.queries.get(e);if(n)for(const r of n.ta)r.onError(t);i.queries.delete(e)}function z$(s){s.ia.forEach(e=>{e.next()})}var L7,YJ;(YJ=L7||(L7={}))._a="default",YJ.Cache="cache";class U${constructor(e,t,i){this.query=e,this.aa=t,this.ua=!1,this.ca=null,this.onlineState="Unknown",this.options=i||{}}oa(e){if(!this.options.includeMetadataChanges){const i=[];for(const n of e.docChanges)n.type!==3&&i.push(n);e=new r1(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ua?this.la(e)&&(this.aa.next(e),t=!0):this.ha(e,this.onlineState)&&(this.Pa(e),t=!0),this.ca=e,t}onError(e){this.aa.error(e)}sa(e){this.onlineState=e;let t=!1;return this.ca&&!this.ua&&this.ha(this.ca,e)&&(this.Pa(this.ca),t=!0),t}ha(e,t){if(!e.fromCache||!this.ra())return!0;const i=t!=="Offline";return(!this.options.Ta||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}la(e){if(e.docChanges.length>0)return!0;const t=this.ca&&this.ca.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}Pa(e){e=r1.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ua=!0,this.aa.next(e)}ra(){return this.options.source!==L7.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uce{constructor(e){this.key=e}}class jce{constructor(e){this.key=e}}class Kke{constructor(e,t){this.query=e,this.fa=t,this.ga=null,this.hasCachedResults=!1,this.current=!1,this.pa=Bi(),this.mutatedKeys=Bi(),this.ya=cce(e),this.wa=new hy(this.ya)}get Sa(){return this.fa}ba(e,t){const i=t?t.Da:new GJ,n=t?t.wa:this.wa;let r=t?t.mutatedKeys:this.mutatedKeys,o=n,a=!1;const l=this.query.limitType==="F"&&n.size===this.query.limit?n.last():null,c=this.query.limitType==="L"&&n.size===this.query.limit?n.first():null;if(e.inorderTraversal((d,u)=>{const h=n.get(d),g=x4(this.query,u)?u:null,p=!!h&&this.mutatedKeys.has(h.key),_=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let v=!1;h&&g?h.data.isEqual(g.data)?p!==_&&(i.track({type:3,doc:g}),v=!0):this.va(h,g)||(i.track({type:2,doc:g}),v=!0,(l&&this.ya(g,l)>0||c&&this.ya(g,c)<0)&&(a=!0)):!h&&g?(i.track({type:0,doc:g}),v=!0):h&&!g&&(i.track({type:1,doc:h}),v=!0,(l||c)&&(a=!0)),v&&(g?(o=o.add(g),r=_?r.add(d):r.delete(d)):(o=o.delete(d),r=r.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),r=r.delete(d.key),i.track({type:1,doc:d})}return{wa:o,Da:i,ls:a,mutatedKeys:r}}va(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,n){const r=this.wa;this.wa=e.wa,this.mutatedKeys=e.mutatedKeys;const o=e.Da.X_();o.sort((d,u)=>function(g,p){const _=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return li()}};return _(g)-_(p)}(d.type,u.type)||this.ya(d.doc,u.doc)),this.Ca(i),n=n!=null&&n;const a=t&&!n?this.Fa():[],l=this.pa.size===0&&this.current&&!n?1:0,c=l!==this.ga;return this.ga=l,o.length!==0||c?{snapshot:new r1(this.query,e.wa,r,o,e.mutatedKeys,l===0,c,!1,!!i&&i.resumeToken.approximateByteSize()>0),Ma:a}:{Ma:a}}sa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({wa:this.wa,Da:new GJ,mutatedKeys:this.mutatedKeys,ls:!1},!1)):{Ma:[]}}xa(e){return!this.fa.has(e)&&!!this.wa.has(e)&&!this.wa.get(e).hasLocalMutations}Ca(e){e&&(e.addedDocuments.forEach(t=>this.fa=this.fa.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.fa=this.fa.delete(t)),this.current=e.current)}Fa(){if(!this.current)return[];const e=this.pa;this.pa=Bi(),this.wa.forEach(i=>{this.xa(i.key)&&(this.pa=this.pa.add(i.key))});const t=[];return e.forEach(i=>{this.pa.has(i)||t.push(new jce(i))}),this.pa.forEach(i=>{e.has(i)||t.push(new Uce(i))}),t}Oa(e){this.fa=e.gs,this.pa=Bi();const t=this.ba(e.documents);return this.applyChanges(t,!0)}Na(){return r1.fromInitialDocuments(this.query,this.wa,this.mutatedKeys,this.ga===0,this.hasCachedResults)}}const j$="SyncEngine";class Gke{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class Qke{constructor(e){this.key=e,this.Ba=!1}}class Yke{constructor(e,t,i,n,r,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=n,this.currentUser=r,this.maxConcurrentLimboResolutions=o,this.La={},this.ka=new Bw(a=>lce(a),S4),this.qa=new Map,this.Qa=new Set,this.$a=new Is($t.comparator),this.Ua=new Map,this.Ka=new T$,this.Wa={},this.Ga=new Map,this.za=s1.Kn(),this.onlineState="Unknown",this.ja=void 0}get isPrimaryClient(){return this.ja===!0}}async function Xke(s,e,t=!0){const i=Yce(s);let n;const r=i.ka.get(e);return r?(i.sharedClientState.addLocalQueryTarget(r.targetId),n=r.view.Na()):n=await $ce(i,e,t,!0),n}async function Zke(s,e){const t=Yce(s);await $ce(t,e,!0,!1)}async function $ce(s,e,t,i){const n=await bke(s.localStore,vh(e)),r=n.targetId,o=s.sharedClientState.addLocalQueryTarget(r,t);let a;return i&&(a=await Jke(s,e,r,o==="current",n.resumeToken)),s.isPrimaryClient&&t&&Fce(s.remoteStore,n),a}async function Jke(s,e,t,i,n){s.Ha=(u,h,g)=>async function(_,v,C,y){let x=v.view.ba(C);x.ls&&(x=await zJ(_.localStore,v.query,!1).then(({documents:D})=>v.view.ba(D,x)));const L=y&&y.targetChanges.get(v.targetId),I=y&&y.targetMismatches.get(v.targetId)!=null,A=v.view.applyChanges(x,_.isPrimaryClient,L,I);return ZJ(_,v.targetId,A.Ma),A.snapshot}(s,u,h,g);const r=await zJ(s.localStore,e,!0),o=new Kke(e,r.gs),a=o.ba(r.documents),l=PE.createSynthesizedTargetChangeForCurrentChange(t,i&&s.onlineState!=="Offline",n),c=o.applyChanges(a,s.isPrimaryClient,l);ZJ(s,t,c.Ma);const d=new Gke(e,t,o);return s.ka.set(e,d),s.qa.has(t)?s.qa.get(t).push(e):s.qa.set(t,[e]),c.snapshot}async function eIe(s,e,t){const i=_i(s),n=i.ka.get(e),r=i.qa.get(n.targetId);if(r.length>1)return i.qa.set(n.targetId,r.filter(o=>!S4(o,e))),void i.ka.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(n.targetId),i.sharedClientState.isActiveQueryTarget(n.targetId)||await S7(i.localStore,n.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(n.targetId),t&&P$(i.remoteStore,n.targetId),k7(i,n.targetId)}).catch(iS)):(k7(i,n.targetId),await S7(i.localStore,n.targetId,!0))}async function tIe(s,e){const t=_i(s),i=t.ka.get(e),n=t.qa.get(i.targetId);t.isPrimaryClient&&n.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),P$(t.remoteStore,i.targetId))}async function iIe(s,e,t){const i=cIe(s);try{const n=await function(o,a){const l=_i(o),c=ur.now(),d=a.reduce((g,p)=>g.add(p.key),Bi());let u,h;return l.persistence.runTransaction("Locally write mutations","readwrite",g=>{let p=bg(),_=Bi();return l.ds.getEntries(g,d).next(v=>{p=v,p.forEach((C,y)=>{y.isValidDocument()||(_=_.add(C))})}).next(()=>l.localDocuments.getOverlayedDocuments(g,p)).next(v=>{u=v;const C=[];for(const y of a){const x=bLe(y,u.get(y.key).overlayedDocument);x!=null&&C.push(new f_(y.key,x,ece(x.value.mapValue),ed.exists(!0)))}return l.mutationQueue.addMutationBatch(g,c,C,a)}).next(v=>{h=v;const C=v.applyToLocalDocumentSet(u,_);return l.documentOverlayCache.saveOverlays(g,v.batchId,C)})}).then(()=>({batchId:h.batchId,changes:uce(u)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(n.batchId),function(o,a,l){let c=o.Wa[o.currentUser.toKey()];c||(c=new Is(Ei)),c=c.insert(a,l),o.Wa[o.currentUser.toKey()]=c}(i,n.batchId,t),await OE(i,n.changes),await N4(i.remoteStore)}catch(n){const r=B$(n,"Failed to persist write");t.reject(r)}}async function qce(s,e){const t=_i(s);try{const i=await pke(t.localStore,e);e.targetChanges.forEach((n,r)=>{const o=t.Ua.get(r);o&&(Dn(n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size<=1),n.addedDocuments.size>0?o.Ba=!0:n.modifiedDocuments.size>0?Dn(o.Ba):n.removedDocuments.size>0&&(Dn(o.Ba),o.Ba=!1))}),await OE(t,i,e)}catch(i){await iS(i)}}function XJ(s,e,t){const i=_i(s);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const n=[];i.ka.forEach((r,o)=>{const a=o.view.sa(e);a.snapshot&&n.push(a.snapshot)}),function(o,a){const l=_i(o);l.onlineState=a;let c=!1;l.queries.forEach((d,u)=>{for(const h of u.ta)h.sa(a)&&(c=!0)}),c&&z$(l)}(i.eventManager,e),n.length&&i.La.p_(n),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function nIe(s,e,t){const i=_i(s);i.sharedClientState.updateQueryState(e,"rejected",t);const n=i.Ua.get(e),r=n&&n.key;if(r){let o=new Is($t.comparator);o=o.insert(r,qo.newNoDocument(r,fi.min()));const a=Bi().add(r),l=new E4(fi.min(),new Map,new Is(Ei),o,a);await qce(i,l),i.$a=i.$a.remove(r),i.Ua.delete(e),$$(i)}else await S7(i.localStore,e,!1).then(()=>k7(i,e,t)).catch(iS)}async function sIe(s,e){const t=_i(s),i=e.batch.batchId;try{const n=await gke(t.localStore,e);Gce(t,i,null),Kce(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await OE(t,n)}catch(n){await iS(n)}}async function rIe(s,e,t){const i=_i(s);try{const n=await function(o,a){const l=_i(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return l.mutationQueue.lookupMutationBatch(c,a).next(u=>(Dn(u!==null),d=u.keys(),l.mutationQueue.removeMutationBatch(c,u))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,d,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>l.localDocuments.getDocuments(c,d))})}(i.localStore,e);Gce(i,e,t),Kce(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await OE(i,n)}catch(n){await iS(n)}}function Kce(s,e){(s.Ga.get(e)||[]).forEach(t=>{t.resolve()}),s.Ga.delete(e)}function Gce(s,e,t){const i=_i(s);let n=i.Wa[i.currentUser.toKey()];if(n){const r=n.get(e);r&&(t?r.reject(t):r.resolve(),n=n.remove(e)),i.Wa[i.currentUser.toKey()]=n}}function k7(s,e,t=null){s.sharedClientState.removeLocalQueryTarget(e);for(const i of s.qa.get(e))s.ka.delete(i),t&&s.La.Ja(i,t);s.qa.delete(e),s.isPrimaryClient&&s.Ka.br(e).forEach(i=>{s.Ka.containsKey(i)||Qce(s,i)})}function Qce(s,e){s.Qa.delete(e.path.canonicalString());const t=s.$a.get(e);t!==null&&(P$(s.remoteStore,t),s.$a=s.$a.remove(e),s.Ua.delete(t),$$(s))}function ZJ(s,e,t){for(const i of t)i instanceof Uce?(s.Ka.addReference(i.key,e),oIe(s,i)):i instanceof jce?(bt(j$,"Document no longer in limbo: "+i.key),s.Ka.removeReference(i.key,e),s.Ka.containsKey(i.key)||Qce(s,i.key)):li()}function oIe(s,e){const t=e.key,i=t.path.canonicalString();s.$a.get(t)||s.Qa.has(i)||(bt(j$,"New document in limbo: "+t),s.Qa.add(i),$$(s))}function $$(s){for(;s.Qa.size>0&&s.$a.size<s.maxConcurrentLimboResolutions;){const e=s.Qa.values().next().value;s.Qa.delete(e);const t=new $t(ls.fromString(e)),i=s.za.next();s.Ua.set(i,new Qke(t)),s.$a=s.$a.insert(t,i),Fce(s.remoteStore,new Wp(vh(y4(t.path)),i,"TargetPurposeLimboResolution",v4.ae))}}async function OE(s,e,t){const i=_i(s),n=[],r=[],o=[];i.ka.isEmpty()||(i.ka.forEach((a,l)=>{o.push(i.Ha(l,e,t).then(c=>{var d;if((c||t)&&i.isPrimaryClient){const u=c?!c.fromCache:(d=t==null?void 0:t.targetChanges.get(l.targetId))===null||d===void 0?void 0:d.current;i.sharedClientState.updateQueryState(l.targetId,u?"current":"not-current")}if(c){n.push(c);const u=R$.Yi(l.targetId,c);r.push(u)}}))}),await Promise.all(o),i.La.p_(n),await async function(l,c){const d=_i(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",u=>He.forEach(c,h=>He.forEach(h.Hi,g=>d.persistence.referenceDelegate.addReference(u,h.targetId,g)).next(()=>He.forEach(h.Ji,g=>d.persistence.referenceDelegate.removeReference(u,h.targetId,g)))))}catch(u){if(!nS(u))throw u;bt(A$,"Failed to update sequence numbers: "+u)}for(const u of c){const h=u.targetId;if(!u.fromCache){const g=d.Ts.get(h),p=g.snapshotVersion,_=g.withLastLimboFreeSnapshotVersion(p);d.Ts=d.Ts.insert(h,_)}}}(i.localStore,r))}async function aIe(s,e){const t=_i(s);if(!t.currentUser.isEqual(e)){bt(j$,"User change. New user:",e.toKey());const i=await Ace(t.localStore,e);t.currentUser=e,function(r,o){r.Ga.forEach(a=>{a.forEach(l=>{l.reject(new vt(We.CANCELLED,o))})}),r.Ga.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await OE(t,i.Rs)}}function lIe(s,e){const t=_i(s),i=t.Ua.get(e);if(i&&i.Ba)return Bi().add(i.key);{let n=Bi();const r=t.qa.get(e);if(!r)return n;for(const o of r){const a=t.ka.get(o);n=n.unionWith(a.view.Sa)}return n}}function Yce(s){const e=_i(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=qce.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=lIe.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=nIe.bind(null,e),e.La.p_=$ke.bind(null,e.eventManager),e.La.Ja=qke.bind(null,e.eventManager),e}function cIe(s){const e=_i(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=sIe.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=rIe.bind(null,e),e}class y2{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=D4(e.databaseInfo.databaseId),this.sharedClientState=this.Za(e),this.persistence=this.Xa(e),await this.persistence.start(),this.localStore=this.eu(e),this.gcScheduler=this.tu(e,this.localStore),this.indexBackfillerScheduler=this.nu(e,this.localStore)}tu(e,t){return null}nu(e,t){return null}eu(e){return fke(this.persistence,new dke,e.initialUser,this.serializer)}Xa(e){return new Rce(N$.ri,this.serializer)}Za(e){return new wke}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}y2.provider={build:()=>new y2};class dIe extends y2{constructor(e){super(),this.cacheSizeBytes=e}tu(e,t){Dn(this.persistence.referenceDelegate instanceof w2);const i=this.persistence.referenceDelegate.garbageCollector;return new QLe(i,e.asyncQueue,t)}Xa(e){const t=this.cacheSizeBytes!==void 0?cl.withCacheSize(this.cacheSizeBytes):cl.DEFAULT;return new Rce(i=>w2.ri(i,t),this.serializer)}}class I7{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>XJ(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=aIe.bind(null,this.syncEngine),await zke(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new jke}()}createDatastore(e){const t=D4(e.databaseInfo.databaseId),i=function(r){return new Lke(r)}(e.databaseInfo);return function(r,o,a,l){return new Dke(r,o,a,l)}(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return function(i,n,r,o,a){return new Nke(i,n,r,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>XJ(this.syncEngine,t,0),function(){return $J.D()?new $J:new Cke}())}createSyncEngine(e,t){return function(n,r,o,a,l,c,d){const u=new Yke(n,r,o,a,l,c);return d&&(u.ja=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(n){const r=_i(n);bt(rw,"RemoteStore shutting down."),r.W_.add(5),await ME(r),r.z_.shutdown(),r.j_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}I7.provider={build:()=>new I7};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q${constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.iu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.iu(this.observer.error,e):_g("Uncaught Error in snapshot listener:",e.toString()))}su(){this.muted=!0}iu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fm="FirestoreClient";class uIe{constructor(e,t,i,n,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=n,this.user=jo.UNAUTHENTICATED,this.clientId=jle.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=r,this.authCredentials.start(i,async o=>{bt(Fm,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(i,o=>(bt(Fm,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new rg;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=B$(t,"Failed to shutdown persistence");e.reject(i)}}),e.promise}}async function S9(s,e){s.asyncQueue.verifyOperationInProgress(),bt(Fm,"Initializing OfflineComponentProvider");const t=s.configuration;await e.initialize(t);let i=t.initialUser;s.setCredentialChangeListener(async n=>{i.isEqual(n)||(await Ace(e.localStore,n),i=n)}),e.persistence.setDatabaseDeletedListener(()=>s.terminate()),s._offlineComponents=e}async function JJ(s,e){s.asyncQueue.verifyOperationInProgress();const t=await hIe(s);bt(Fm,"Initializing OnlineComponentProvider"),await e.initialize(t,s.configuration),s.setCredentialChangeListener(i=>KJ(e.remoteStore,i)),s.setAppCheckTokenChangeListener((i,n)=>KJ(e.remoteStore,n)),s._onlineComponents=e}async function hIe(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){bt(Fm,"Using user provided OfflineComponentProvider");try{await S9(s,s._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(n){return n.name==="FirebaseError"?n.code===We.FAILED_PRECONDITION||n.code===We.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}(t))throw t;Zy("Error using user provided cache. Falling back to memory cache: "+t),await S9(s,new y2)}}else bt(Fm,"Using default OfflineComponentProvider"),await S9(s,new dIe(void 0));return s._offlineComponents}async function Xce(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(bt(Fm,"Using user provided OnlineComponentProvider"),await JJ(s,s._uninitializedComponentsProvider._online)):(bt(Fm,"Using default OnlineComponentProvider"),await JJ(s,new I7))),s._onlineComponents}function fIe(s){return Xce(s).then(e=>e.syncEngine)}async function S2(s){const e=await Xce(s),t=e.eventManager;return t.onListen=Xke.bind(null,e.syncEngine),t.onUnlisten=eIe.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Zke.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=tIe.bind(null,e.syncEngine),t}function gIe(s,e,t={}){const i=new rg;return s.asyncQueue.enqueueAndForget(async()=>function(r,o,a,l,c){const d=new q$({next:h=>{d.su(),o.enqueueAndForget(()=>H$(r,u));const g=h.docs.has(a);!g&&h.fromCache?c.reject(new vt(We.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&h.fromCache&&l&&l.source==="server"?c.reject(new vt(We.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(h)},error:h=>c.reject(h)}),u=new U$(y4(a.path),d,{includeMetadataChanges:!0,Ta:!0});return W$(r,u)}(await S2(s),s.asyncQueue,e,t,i)),i.promise}function pIe(s,e,t={}){const i=new rg;return s.asyncQueue.enqueueAndForget(async()=>function(r,o,a,l,c){const d=new q$({next:h=>{d.su(),o.enqueueAndForget(()=>H$(r,u)),h.fromCache&&l.source==="server"?c.reject(new vt(We.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(h)},error:h=>c.reject(h)}),u=new U$(a,d,{includeMetadataChanges:!0,Ta:!0});return W$(r,u)}(await S2(s),s.asyncQueue,e,t,i)),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zce(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eee=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jce(s,e,t){if(!t)throw new vt(We.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function mIe(s,e,t,i){if(e===!0&&i===!0)throw new vt(We.INVALID_ARGUMENT,`${s} and ${t} cannot be used together.`)}function tee(s){if(!$t.isDocumentKey(s))throw new vt(We.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function iee(s){if($t.isDocumentKey(s))throw new vt(We.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function R4(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=function(i){return i.constructor?i.constructor.name:null}(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":li()}function kl(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new vt(We.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=R4(s);throw new vt(We.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ede="firestore.googleapis.com",nee=!0;class see{constructor(e){var t,i;if(e.host===void 0){if(e.ssl!==void 0)throw new vt(We.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=ede,this.ssl=nee}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:nee;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Nce;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<KLe)throw new vt(We.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}mIe("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Zce((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new vt(We.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new vt(We.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new vt(We.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(i,n){return i.timeoutSeconds===n.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class A4{constructor(e,t,i,n){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=n,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new see({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new vt(We.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new vt(We.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new see(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new Lxe;switch(i.type){case"firstParty":return new Dxe(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new vt(We.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const i=eee.get(t);i&&(bt("ComponentProvider","Removing Datastore"),eee.delete(t),i.terminate())}(this),Promise.resolve()}}function _Ie(s,e,t,i={}){var n;const r=(s=kl(s,A4))._getSettings(),o=Object.assign(Object.assign({},r),{emulatorOptions:s._getEmulatorOptions()}),a=`${e}:${t}`;r.host!==ede&&r.host!==a&&Zy("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l=Object.assign(Object.assign({},r),{host:a,ssl:!1,emulatorOptions:i});if(!kh(l,o)&&(s._setSettings(l),i.mockUserToken)){let c,d;if(typeof i.mockUserToken=="string")c=i.mockUserToken,d=jo.MOCK_USER;else{c=$ae(i.mockUserToken,(n=s._app)===null||n===void 0?void 0:n.options.projectId);const u=i.mockUserToken.sub||i.mockUserToken.user_id;if(!u)throw new vt(We.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new jo(u)}s._authCredentials=new kxe(new zle(c,d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pg{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Pg(this.firestore,e,this._query)}}class Xo{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new rm(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Xo(this.firestore,e,this._key)}}class rm extends Pg{constructor(e,t,i){super(e,t,y4(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Xo(this.firestore,null,new $t(e))}withConverter(e){return new rm(this.firestore,e,this._path)}}function ta(s,e,...t){if(s=cs(s),Jce("collection","path",e),s instanceof A4){const i=ls.fromString(e,...t);return iee(i),new rm(s,null,i)}{if(!(s instanceof Xo||s instanceof rm))throw new vt(We.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(ls.fromString(e,...t));return iee(i),new rm(s.firestore,null,i)}}function Cs(s,e,...t){if(s=cs(s),arguments.length===1&&(e=jle.newId()),Jce("doc","path",e),s instanceof A4){const i=ls.fromString(e,...t);return tee(i),new Xo(s,null,new $t(i))}{if(!(s instanceof Xo||s instanceof rm))throw new vt(We.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(ls.fromString(e,...t));return tee(i),new Xo(s.firestore,s instanceof rm?s.converter:null,new $t(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ree="AsyncQueue";class oee{constructor(e=Promise.resolve()){this.Vu=[],this.mu=!1,this.fu=[],this.gu=null,this.pu=!1,this.yu=!1,this.wu=[],this.a_=new Mce(this,"async_queue_retry"),this.Su=()=>{const i=y9();i&&bt(ree,"Visibility state changed to "+i.visibilityState),this.a_.t_()},this.bu=e;const t=y9();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Su)}get isShuttingDown(){return this.mu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Du(),this.vu(e)}enterRestrictedMode(e){if(!this.mu){this.mu=!0,this.yu=e||!1;const t=y9();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Su)}}enqueue(e){if(this.Du(),this.mu)return new Promise(()=>{});const t=new rg;return this.vu(()=>this.mu&&this.yu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Vu.push(e),this.Cu()))}async Cu(){if(this.Vu.length!==0){try{await this.Vu[0](),this.Vu.shift(),this.a_.reset()}catch(e){if(!nS(e))throw e;bt(ree,"Operation failed with retryable error: "+e)}this.Vu.length>0&&this.a_.Xo(()=>this.Cu())}}vu(e){const t=this.bu.then(()=>(this.pu=!0,e().catch(i=>{this.gu=i,this.pu=!1;const n=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(i);throw _g("INTERNAL UNHANDLED ERROR: ",n),i}).then(i=>(this.pu=!1,i))));return this.bu=t,t}enqueueAfterDelay(e,t,i){this.Du(),this.wu.indexOf(e)>-1&&(t=0);const n=V$.createAndSchedule(this,e,t,i,r=>this.Fu(r));return this.fu.push(n),n}Du(){this.gu&&li()}verifyOperationInProgress(){}async Mu(){let e;do e=this.bu,await e;while(e!==this.bu)}xu(e){for(const t of this.fu)if(t.timerId===e)return!0;return!1}Ou(e){return this.Mu().then(()=>{this.fu.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(const t of this.fu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Mu()})}Nu(e){this.wu.push(e)}Fu(e){const t=this.fu.indexOf(e);this.fu.splice(t,1)}}function aee(s){return function(t,i){if(typeof t!="object"||t===null)return!1;const n=t;for(const r of i)if(r in n&&typeof n[r]=="function")return!0;return!1}(s,["next","error","complete"])}class vg extends A4{constructor(e,t,i,n){super(e,t,i,n),this.type="firestore",this._queue=new oee,this._persistenceKey=(n==null?void 0:n.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new oee(e),this._firestoreClient=void 0,await e}}}function bIe(s,e){const t=typeof s=="object"?s:g4(),i=typeof s=="string"?s:p2,n=c_(t,"firestore").getImmediate({identifier:i});if(!n._initialized){const r=zae("firestore");r&&_Ie(n,...r)}return n}function P4(s){if(s._terminated)throw new vt(We.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||vIe(s),s._firestoreClient}function vIe(s){var e,t,i;const n=s._freezeSettings(),r=function(a,l,c,d){return new jxe(a,l,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,Zce(d.experimentalLongPollingOptions),d.useFetchStreams)}(s._databaseId,((e=s._app)===null||e===void 0?void 0:e.options.appId)||"",s._persistenceKey,n);s._componentsProvider||!((t=n.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((i=n.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(s._componentsProvider={_offline:n.localCache._offlineComponentProvider,_online:n.localCache._onlineComponentProvider}),s._firestoreClient=new uIe(s._authCredentials,s._appCheckCredentials,s._queue,r,s._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(s._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o1{constructor(e){this._byteString=e}static fromBase64String(e){try{return new o1(xo.fromBase64String(e))}catch(t){throw new vt(We.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new o1(xo.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M4{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new vt(We.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new mo(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hw{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K${constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new vt(We.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new vt(We.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ei(this._lat,e._lat)||Ei(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G${constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(i,n){if(i.length!==n.length)return!1;for(let r=0;r<i.length;++r)if(i[r]!==n[r])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wIe=/^__.*__$/;class CIe{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new f_(e,this.data,this.fieldMask,t,this.fieldTransforms):new AE(e,this.data,t,this.fieldTransforms)}}class tde{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new f_(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function ide(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw li()}}class O4{constructor(e,t,i,n,r,o){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=n,r===void 0&&this.Bu(),this.fieldTransforms=r||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Lu(){return this.settings.Lu}ku(e){return new O4(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}qu(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),n=this.ku({path:i,Qu:!1});return n.$u(e),n}Uu(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),n=this.ku({path:i,Qu:!1});return n.Bu(),n}Ku(e){return this.ku({path:void 0,Qu:!0})}Wu(e){return x2(e,this.settings.methodName,this.settings.Gu||!1,this.path,this.settings.zu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Bu(){if(this.path)for(let e=0;e<this.path.length;e++)this.$u(this.path.get(e))}$u(e){if(e.length===0)throw this.Wu("Document fields must not be empty");if(ide(this.Lu)&&wIe.test(e))throw this.Wu('Document fields cannot begin and end with "__"')}}class yIe{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||D4(e)}ju(e,t,i,n=!1){return new O4({Lu:e,methodName:t,zu:i,path:mo.emptyPath(),Qu:!1,Gu:n},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function F4(s){const e=s._freezeSettings(),t=D4(s._databaseId);return new yIe(s._databaseId,!!e.ignoreUndefinedProperties,t)}function nde(s,e,t,i,n,r={}){const o=s.ju(r.merge||r.mergeFields?2:0,e,t,n);J$("Data must be an object, but it was:",o,i);const a=rde(i,o);let l,c;if(r.merge)l=new cc(o.fieldMask),c=o.fieldTransforms;else if(r.mergeFields){const d=[];for(const u of r.mergeFields){const h=E7(e,u,t);if(!o.contains(h))throw new vt(We.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);ade(d,h)||d.push(h)}l=new cc(d),c=o.fieldTransforms.filter(u=>l.covers(u.field))}else l=null,c=o.fieldTransforms;return new CIe(new pl(a),l,c)}class V4 extends Hw{_toFieldTransform(e){if(e.Lu!==2)throw e.Lu===1?e.Wu(`${this._methodName}() can only appear at the top level of your update data`):e.Wu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof V4}}function sde(s,e,t){return new O4({Lu:3,zu:e.settings.zu,methodName:s._methodName,Qu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Q$ extends Hw{_toFieldTransform(e){return new k4(e.path,new zk)}isEqual(e){return e instanceof Q$}}class Y$ extends Hw{constructor(e,t){super(e),this.Hu=t}_toFieldTransform(e){const t=sde(this,e,!0),i=this.Hu.map(r=>zw(r,t)),n=new i1(i);return new k4(e.path,n)}isEqual(e){return e instanceof Y$&&kh(this.Hu,e.Hu)}}class X$ extends Hw{constructor(e,t){super(e),this.Hu=t}_toFieldTransform(e){const t=sde(this,e,!0),i=this.Hu.map(r=>zw(r,t)),n=new n1(i);return new k4(e.path,n)}isEqual(e){return e instanceof X$&&kh(this.Hu,e.Hu)}}class Z$ extends Hw{constructor(e,t){super(e),this.Ju=t}_toFieldTransform(e){const t=new Uk(e.serializer,gce(e.serializer,this.Ju));return new k4(e.path,t)}isEqual(e){return e instanceof Z$&&this.Ju===e.Ju}}function SIe(s,e,t,i){const n=s.ju(1,e,t);J$("Data must be an object, but it was:",n,i);const r=[],o=pl.empty();h_(i,(l,c)=>{const d=eq(e,l,t);c=cs(c);const u=n.Uu(d);if(c instanceof V4)r.push(d);else{const h=zw(c,u);h!=null&&(r.push(d),o.set(d,h))}});const a=new cc(r);return new tde(o,a,n.fieldTransforms)}function xIe(s,e,t,i,n,r){const o=s.ju(1,e,t),a=[E7(e,i,t)],l=[n];if(r.length%2!=0)throw new vt(We.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<r.length;h+=2)a.push(E7(e,r[h])),l.push(r[h+1]);const c=[],d=pl.empty();for(let h=a.length-1;h>=0;--h)if(!ade(c,a[h])){const g=a[h];let p=l[h];p=cs(p);const _=o.Uu(g);if(p instanceof V4)c.push(g);else{const v=zw(p,_);v!=null&&(c.push(g),d.set(g,v))}}const u=new cc(c);return new tde(d,u,o.fieldTransforms)}function LIe(s,e,t,i=!1){return zw(t,s.ju(i?4:3,e))}function zw(s,e){if(ode(s=cs(s)))return J$("Unsupported field value:",e,s),rde(s,e);if(s instanceof Hw)return function(i,n){if(!ide(n.Lu))throw n.Wu(`${i._methodName}() can only be used with update() and set()`);if(!n.path)throw n.Wu(`${i._methodName}() is not currently supported inside arrays`);const r=i._toFieldTransform(n);r&&n.fieldTransforms.push(r)}(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.Qu&&e.Lu!==4)throw e.Wu("Nested arrays are not supported");return function(i,n){const r=[];let o=0;for(const a of i){let l=zw(a,n.Ku(o));l==null&&(l={nullValue:"NULL_VALUE"}),r.push(l),o++}return{arrayValue:{values:r}}}(s,e)}return function(i,n){if((i=cs(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return gce(n.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const r=ur.fromDate(i);return{timestampValue:v2(n.serializer,r)}}if(i instanceof ur){const r=new ur(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:v2(n.serializer,r)}}if(i instanceof K$)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof o1)return{bytesValue:xce(n.serializer,i._byteString)};if(i instanceof Xo){const r=n.databaseId,o=i.firestore._databaseId;if(!o.isEqual(r))throw n.Wu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:D$(i.firestore._databaseId||n.databaseId,i._key.path)}}if(i instanceof G$)return function(o,a){return{mapValue:{fields:{[Zle]:{stringValue:Jle},[m2]:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw a.Wu("VectorValues must only contain numeric values.");return L$(a.serializer,c)})}}}}}}(i,n);throw n.Wu(`Unsupported field value: ${R4(i)}`)}(s,e)}function rde(s,e){const t={};return qle(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):h_(s,(i,n)=>{const r=zw(n,e.qu(i));r!=null&&(t[i]=r)}),{mapValue:{fields:t}}}function ode(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof ur||s instanceof K$||s instanceof o1||s instanceof Xo||s instanceof Hw||s instanceof G$)}function J$(s,e,t){if(!ode(t)||!function(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}(t)){const i=R4(t);throw i==="an object"?e.Wu(s+" a custom object"):e.Wu(s+" "+i)}}function E7(s,e,t){if((e=cs(e))instanceof M4)return e._internalPath;if(typeof e=="string")return eq(s,e);throw x2("Field path arguments must be of type string or ",s,!1,void 0,t)}const kIe=new RegExp("[~\\*/\\[\\]]");function eq(s,e,t){if(e.search(kIe)>=0)throw x2(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,t);try{return new M4(...e.split("."))._internalPath}catch{throw x2(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,t)}}function x2(s,e,t,i,n){const r=i&&!i.isEmpty(),o=n!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(r||o)&&(l+=" (found",r&&(l+=` in field ${i}`),o&&(l+=` in document ${n}`),l+=")"),new vt(We.INVALID_ARGUMENT,a+s+l)}function ade(s,e){return s.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lde{constructor(e,t,i,n,r){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=n,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new Xo(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new IIe(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(B4("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class IIe extends lde{data(){return super.data()}}function B4(s,e){return typeof e=="string"?eq(s,e):e instanceof M4?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cde(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new vt(We.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class tq{}class iq extends tq{}function Eh(s,e,...t){let i=[];e instanceof tq&&i.push(e),i=i.concat(t),function(r){const o=r.filter(l=>l instanceof nq).length,a=r.filter(l=>l instanceof W4).length;if(o>1||o>0&&a>0)throw new vt(We.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const n of i)s=n._apply(s);return s}class W4 extends iq{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new W4(e,t,i)}_apply(e){const t=this._parse(e);return ude(e._query,t),new Pg(e.firestore,e.converter,b7(e._query,t))}_parse(e){const t=F4(e.firestore);return function(r,o,a,l,c,d,u){let h;if(c.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new vt(We.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){cee(u,d);const p=[];for(const _ of u)p.push(lee(l,r,_));h={arrayValue:{values:p}}}else h=lee(l,r,u)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||cee(u,d),h=LIe(a,o,u,d==="in"||d==="not-in");return lr.create(c,d,h)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function og(s,e,t){const i=e,n=B4("where",s);return W4._create(n,i,t)}class nq extends tq{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new nq(e,t)}_parse(e){const t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return t.length===1?t[0]:cu.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(n,r){let o=n;const a=r.getFlattenedFilters();for(const l of a)ude(o,l),o=b7(o,l)}(e._query,t),new Pg(e.firestore,e.converter,b7(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class sq extends iq{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new sq(e,t)}_apply(e){const t=function(n,r,o){if(n.startAt!==null)throw new vt(We.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(n.endAt!==null)throw new vt(We.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Hk(r,o)}(e._query,this._field,this._direction);return new Pg(e.firestore,e.converter,function(n,r){const o=n.explicitOrderBy.concat([r]);return new sS(n.path,n.collectionGroup,o,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}(e._query,t))}}function dde(s,e="asc"){const t=e,i=B4("orderBy",s);return sq._create(i,t)}class rq extends iq{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new rq(e,t,i)}_apply(e){return new Pg(e.firestore,e.converter,b2(e._query,this._limit,this._limitType))}}function EIe(s){return rq._create("limit",s,"F")}function lee(s,e,t){if(typeof(t=cs(t))=="string"){if(t==="")throw new vt(We.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ace(e)&&t.indexOf("/")!==-1)throw new vt(We.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(ls.fromString(t));if(!$t.isDocumentKey(i))throw new vt(We.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return SJ(s,new $t(i))}if(t instanceof Xo)return SJ(s,t._key);throw new vt(We.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${R4(t)}.`)}function cee(s,e){if(!Array.isArray(s)||s.length===0)throw new vt(We.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function ude(s,e){const t=function(n,r){for(const o of n)for(const a of o.getFlattenedFilters())if(r.indexOf(a.op)>=0)return a.op;return null}(s.filters,function(n){switch(n){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new vt(We.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new vt(We.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class DIe{convertValue(e,t="none"){switch(Mm(e)){case 0:return null;case 1:return e.booleanValue;case 2:return qs(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Pm(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw li()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return h_(e,(n,r)=>{i[n]=this.convertValue(r,t)}),i}convertVectorValue(e){var t,i,n;const r=(n=(i=(t=e.fields)===null||t===void 0?void 0:t[m2].arrayValue)===null||i===void 0?void 0:i.values)===null||n===void 0?void 0:n.map(o=>qs(o.doubleValue));return new G$(r)}convertGeoPoint(e){return new K$(qs(e.latitude),qs(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":const i=C4(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Vk(e));default:return null}}convertTimestamp(e){const t=Am(e);return new ur(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=ls.fromString(e);Dn(Tce(i));const n=new Bk(i.get(1),i.get(3)),r=new $t(i.popFirst(5));return n.isEqual(t)||_g(`Document ${r} contains a document reference within a different database (${n.projectId}/${n.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hde(s,e,t){let i;return i=s?t&&(t.merge||t.mergeFields)?s.toFirestore(e,t):s.toFirestore(e):e,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qx{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class fde extends lde{constructor(e,t,i,n,r,o){super(e,t,i,n,o),this._firestore=e,this._firestoreImpl=e,this.metadata=r}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new _R(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(B4("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}}class _R extends fde{data(e={}){return super.data(e)}}class gde{constructor(e,t,i,n){this._firestore=e,this._userDataWriter=t,this._snapshot=n,this.metadata=new Qx(n.hasPendingWrites,n.fromCache),this.query=i}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new _R(this._firestore,this._userDataWriter,i.key,i,new Qx(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new vt(We.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(n,r){if(n._snapshot.oldDocs.isEmpty()){let o=0;return n._snapshot.docChanges.map(a=>{const l=new _R(n._firestore,n._userDataWriter,a.doc.key,a.doc,new Qx(n._snapshot.mutatedKeys.has(a.doc.key),n._snapshot.fromCache),n.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=n._snapshot.oldDocs;return n._snapshot.docChanges.filter(a=>r||a.type!==3).map(a=>{const l=new _R(n._firestore,n._userDataWriter,a.doc.key,a.doc,new Qx(n._snapshot.mutatedKeys.has(a.doc.key),n._snapshot.fromCache),n.query.converter);let c=-1,d=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:TIe(a.type),doc:l,oldIndex:c,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function TIe(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return li()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dh(s){s=kl(s,Xo);const e=kl(s.firestore,vg);return gIe(P4(e),s._key).then(t=>pde(e,s,t))}class oq extends DIe{constructor(e){super(),this.firestore=e}convertBytes(e){return new o1(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Xo(this.firestore,null,t)}}function a1(s){s=kl(s,Pg);const e=kl(s.firestore,vg),t=P4(e),i=new oq(e);return cde(s._query),pIe(t,s._query).then(n=>new gde(e,i,s,n))}function $b(s,e,t){s=kl(s,Xo);const i=kl(s.firestore,vg),n=hde(s.converter,e,t);return H4(i,[nde(F4(i),"setDoc",s._key,n,s.converter!==null,t).toMutation(s._key,ed.none())])}function l1(s,e,t,...i){s=kl(s,Xo);const n=kl(s.firestore,vg),r=F4(n);let o;return o=typeof(e=cs(e))=="string"||e instanceof M4?xIe(r,"updateDoc",s._key,e,t,i):SIe(r,"updateDoc",s._key,e),H4(n,[o.toMutation(s._key,ed.exists(!0))])}function NIe(s){return H4(kl(s.firestore,vg),[new k$(s._key,ed.none())])}function aq(s,e){const t=kl(s.firestore,vg),i=Cs(s),n=hde(s.converter,e);return H4(t,[nde(F4(s.firestore),"addDoc",i._key,n,s.converter!==null,{}).toMutation(i._key,ed.exists(!1))]).then(()=>i)}function c1(s,...e){var t,i,n;s=cs(s);let r={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||aee(e[o])||(r=e[o],o++);const a={includeMetadataChanges:r.includeMetadataChanges,source:r.source};if(aee(e[o])){const u=e[o];e[o]=(t=u.next)===null||t===void 0?void 0:t.bind(u),e[o+1]=(i=u.error)===null||i===void 0?void 0:i.bind(u),e[o+2]=(n=u.complete)===null||n===void 0?void 0:n.bind(u)}let l,c,d;if(s instanceof Xo)c=kl(s.firestore,vg),d=y4(s._key.path),l={next:u=>{e[o]&&e[o](pde(c,s,u))},error:e[o+1],complete:e[o+2]};else{const u=kl(s,Pg);c=kl(u.firestore,vg),d=u._query;const h=new oq(c);l={next:g=>{e[o]&&e[o](new gde(c,h,u,g))},error:e[o+1],complete:e[o+2]},cde(s._query)}return function(h,g,p,_){const v=new q$(_),C=new U$(g,v,p);return h.asyncQueue.enqueueAndForget(async()=>W$(await S2(h),C)),()=>{v.su(),h.asyncQueue.enqueueAndForget(async()=>H$(await S2(h),C))}}(P4(c),d,a,l)}function H4(s,e){return function(i,n){const r=new rg;return i.asyncQueue.enqueueAndForget(async()=>iIe(await fIe(i),n,r)),r.promise}(P4(s),e)}function pde(s,e,t){const i=t.docs.get(e._key),n=new oq(s);return new fde(s,n,e._key,i,new Qx(t.hasPendingWrites,t.fromCache),e.converter)}function LL(){return new Q$("serverTimestamp")}function mde(...s){return new Y$("arrayUnion",s)}function _de(...s){return new X$("arrayRemove",s)}function RIe(s){return new Z$("increment",s)}(function(e,t=!0){(function(n){tS=n})(Vw),lu(new nd("firestore",(i,{instanceIdentifier:n,options:r})=>{const o=i.getProvider("app").getImmediate(),a=new vg(new Ixe(i.getProvider("auth-internal")),new Txe(o,i.getProvider("app-check-internal")),function(c,d){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new vt(We.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Bk(c.options.projectId,d)}(o,n),o);return r=Object.assign({useFetchStreams:t},r),a._setSettings(r),a},"PUBLIC").setMultipleInstances(!0)),Ll(uJ,hJ,e),Ll(uJ,hJ,"esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bde="firebasestorage.googleapis.com",vde="storageBucket",AIe=2*60*1e3,PIe=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hs extends fd{constructor(e,t,i=0){super(x9(e),`Firebase Storage: ${t} (${x9(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Hs.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return x9(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Vs;(function(s){s.UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Vs||(Vs={}));function x9(s){return"storage/"+s}function lq(){const s="An unknown error occurred, please check the error payload for server response.";return new Hs(Vs.UNKNOWN,s)}function MIe(s){return new Hs(Vs.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")}function OIe(s){return new Hs(Vs.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function FIe(){const s="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Hs(Vs.UNAUTHENTICATED,s)}function VIe(){return new Hs(Vs.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function BIe(s){return new Hs(Vs.UNAUTHORIZED,"User does not have permission to access '"+s+"'.")}function WIe(){return new Hs(Vs.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function HIe(){return new Hs(Vs.CANCELED,"User canceled the upload/download.")}function zIe(s){return new Hs(Vs.INVALID_URL,"Invalid URL '"+s+"'.")}function UIe(s){return new Hs(Vs.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.")}function jIe(){return new Hs(Vs.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+vde+"' property when initializing the app?")}function $Ie(){return new Hs(Vs.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function qIe(){return new Hs(Vs.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function KIe(s){return new Hs(Vs.UNSUPPORTED_ENVIRONMENT,`${s} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function D7(s){return new Hs(Vs.INVALID_ARGUMENT,s)}function wde(){return new Hs(Vs.APP_DELETED,"The Firebase app was deleted.")}function GIe(s){return new Hs(Vs.INVALID_ROOT_OPERATION,"The operation '"+s+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function kL(s,e){return new Hs(Vs.INVALID_FORMAT,"String does not match format '"+s+"': "+e)}function gx(s){throw new Hs(Vs.INTERNAL_ERROR,"Internal error: "+s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dc{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=dc.makeFromUrl(e,t)}catch{return new dc(e,"")}if(i.path==="")return i;throw UIe(e)}static makeFromUrl(e,t){let i=null;const n="([A-Za-z0-9.\\-_]+)";function r(L){L.path.charAt(L.path.length-1)==="/"&&(L.path_=L.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+n+o,"i"),l={bucket:1,path:3};function c(L){L.path_=decodeURIComponent(L.path)}const d="v[A-Za-z0-9_]+",u=t.replace(/[.]/g,"\\."),h="(/([^?#]*).*)?$",g=new RegExp(`^https?://${u}/${d}/b/${n}/o${h}`,"i"),p={bucket:1,path:3},_=t===bde?"(?:storage.googleapis.com|storage.cloud.google.com)":t,v="([^?#]*)",C=new RegExp(`^https?://${_}/${n}/${v}`,"i"),x=[{regex:a,indices:l,postModify:r},{regex:g,indices:p,postModify:c},{regex:C,indices:{bucket:1,path:2},postModify:c}];for(let L=0;L<x.length;L++){const I=x[L],A=I.regex.exec(e);if(A){const D=A[I.indices.bucket];let N=A[I.indices.path];N||(N=""),i=new dc(D,N),I.postModify(i);break}}if(i==null)throw zIe(e);return i}}class QIe{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YIe(s,e,t){let i=1,n=null,r=null,o=!1,a=0;function l(){return a===2}let c=!1;function d(...v){c||(c=!0,e.apply(null,v))}function u(v){n=setTimeout(()=>{n=null,s(g,l())},v)}function h(){r&&clearTimeout(r)}function g(v,...C){if(c){h();return}if(v){h(),d.call(null,v,...C);return}if(l()||o){h(),d.call(null,v,...C);return}i<64&&(i*=2);let x;a===1?(a=2,x=0):x=(i+Math.random())*1e3,u(x)}let p=!1;function _(v){p||(p=!0,h(),!c&&(n!==null?(v||(a=2),clearTimeout(n),u(0)):v||(a=1)))}return u(0),r=setTimeout(()=>{o=!0,_(!0)},t),_}function XIe(s){s(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZIe(s){return s!==void 0}function JIe(s){return typeof s=="object"&&!Array.isArray(s)}function cq(s){return typeof s=="string"||s instanceof String}function dee(s){return dq()&&s instanceof Blob}function dq(){return typeof Blob<"u"}function uee(s,e,t,i){if(i<e)throw D7(`Invalid value for '${s}'. Expected ${e} or greater.`);if(i>t)throw D7(`Invalid value for '${s}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uq(s,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${s}`}function Cde(s){const e=encodeURIComponent;let t="?";for(const i in s)if(s.hasOwnProperty(i)){const n=e(i)+"="+e(s[i]);t=t+n+"&"}return t=t.slice(0,-1),t}var qb;(function(s){s[s.NO_ERROR=0]="NO_ERROR",s[s.NETWORK_ERROR=1]="NETWORK_ERROR",s[s.ABORT=2]="ABORT"})(qb||(qb={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eEe(s,e){const t=s>=500&&s<600,n=[408,429].indexOf(s)!==-1,r=e.indexOf(s)!==-1;return t||n||r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tEe{constructor(e,t,i,n,r,o,a,l,c,d,u,h=!0){this.url_=e,this.method_=t,this.headers_=i,this.body_=n,this.successCodes_=r,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=d,this.connectionFactory_=u,this.retry=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((g,p)=>{this.resolve_=g,this.reject_=p,this.start_()})}start_(){const e=(i,n)=>{if(n){i(!1,new UT(!1,null,!0));return}const r=this.connectionFactory_();this.pendingConnection_=r;const o=a=>{const l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&r.addUploadProgressListener(o),r.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&r.removeUploadProgressListener(o),this.pendingConnection_=null;const a=r.getErrorCode()===qb.NO_ERROR,l=r.getStatus();if(!a||eEe(l,this.additionalRetryCodes_)&&this.retry){const d=r.getErrorCode()===qb.ABORT;i(!1,new UT(!1,null,d));return}const c=this.successCodes_.indexOf(l)!==-1;i(!0,new UT(c,r))})},t=(i,n)=>{const r=this.resolve_,o=this.reject_,a=n.connection;if(n.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());ZIe(l)?r(l):r()}catch(l){o(l)}else if(a!==null){const l=lq();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(n.canceled){const l=this.appDelete_?wde():HIe();o(l)}else{const l=WIe();o(l)}};this.canceled_?t(!1,new UT(!1,null,!0)):this.backoffId_=YIe(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&XIe(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class UT{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function iEe(s,e){e!==null&&e.length>0&&(s.Authorization="Firebase "+e)}function nEe(s,e){s["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function sEe(s,e){e&&(s["X-Firebase-GMPID"]=e)}function rEe(s,e){e!==null&&(s["X-Firebase-AppCheck"]=e)}function oEe(s,e,t,i,n,r,o=!0){const a=Cde(s.urlParams),l=s.url+a,c=Object.assign({},s.headers);return sEe(c,e),iEe(c,t),nEe(c,r),rEe(c,i),new tEe(l,s.method,c,s.body,s.successCodes,s.additionalRetryCodes,s.handler,s.errorHandler,s.timeout,s.progressCallback,n,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aEe(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function lEe(...s){const e=aEe();if(e!==void 0){const t=new e;for(let i=0;i<s.length;i++)t.append(s[i]);return t.getBlob()}else{if(dq())return new Blob(s);throw new Hs(Vs.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function cEe(s,e,t){return s.webkitSlice?s.webkitSlice(e,t):s.mozSlice?s.mozSlice(e,t):s.slice?s.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dEe(s){if(typeof atob>"u")throw KIe("base-64");return atob(s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ph={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class L9{constructor(e,t){this.data=e,this.contentType=t||null}}function uEe(s,e){switch(s){case ph.RAW:return new L9(yde(e));case ph.BASE64:case ph.BASE64URL:return new L9(Sde(s,e));case ph.DATA_URL:return new L9(fEe(e),gEe(e))}throw lq()}function yde(s){const e=[];for(let t=0;t<s.length;t++){let i=s.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<s.length-1&&(s.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const r=i,o=s.charCodeAt(++t);i=65536|(r&1023)<<10|o&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function hEe(s){let e;try{e=decodeURIComponent(s)}catch{throw kL(ph.DATA_URL,"Malformed data URL.")}return yde(e)}function Sde(s,e){switch(s){case ph.BASE64:{const n=e.indexOf("-")!==-1,r=e.indexOf("_")!==-1;if(n||r)throw kL(s,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break}case ph.BASE64URL:{const n=e.indexOf("+")!==-1,r=e.indexOf("/")!==-1;if(n||r)throw kL(s,"Invalid character '"+(n?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=dEe(e)}catch(n){throw n.message.includes("polyfill")?n:kL(s,"Invalid character found")}const i=new Uint8Array(t.length);for(let n=0;n<t.length;n++)i[n]=t.charCodeAt(n);return i}class xde{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw kL(ph.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=pEe(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function fEe(s){const e=new xde(s);return e.base64?Sde(ph.BASE64,e.rest):hEe(e.rest)}function gEe(s){return new xde(s).contentType}function pEe(s,e){return s.length>=e.length?s.substring(s.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Np{constructor(e,t){let i=0,n="";dee(e)?(this.data_=e,i=e.size,n=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=n}size(){return this.size_}type(){return this.type_}slice(e,t){if(dee(this.data_)){const i=this.data_,n=cEe(i,e,t);return n===null?null:new Np(n)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new Np(i,!0)}}static getBlob(...e){if(dq()){const t=e.map(i=>i instanceof Np?i.data_:i);return new Np(lEe.apply(null,t))}else{const t=e.map(o=>cq(o)?uEe(ph.RAW,o).data:o.data_);let i=0;t.forEach(o=>{i+=o.byteLength});const n=new Uint8Array(i);let r=0;return t.forEach(o=>{for(let a=0;a<o.length;a++)n[r++]=o[a]}),new Np(n,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lde(s){let e;try{e=JSON.parse(s)}catch{return null}return JIe(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mEe(s){if(s.length===0)return null;const e=s.lastIndexOf("/");return e===-1?"":s.slice(0,e)}function _Ee(s,e){const t=e.split("/").filter(i=>i.length>0).join("/");return s.length===0?t:s+"/"+t}function kde(s){const e=s.lastIndexOf("/",s.length-2);return e===-1?s:s.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bEe(s,e){return e}class ma{constructor(e,t,i,n){this.server=e,this.local=t||e,this.writable=!!i,this.xform=n||bEe}}let jT=null;function vEe(s){return!cq(s)||s.length<2?s:kde(s)}function Ide(){if(jT)return jT;const s=[];s.push(new ma("bucket")),s.push(new ma("generation")),s.push(new ma("metageneration")),s.push(new ma("name","fullPath",!0));function e(r,o){return vEe(o)}const t=new ma("name");t.xform=e,s.push(t);function i(r,o){return o!==void 0?Number(o):o}const n=new ma("size");return n.xform=i,s.push(n),s.push(new ma("timeCreated")),s.push(new ma("updated")),s.push(new ma("md5Hash",null,!0)),s.push(new ma("cacheControl",null,!0)),s.push(new ma("contentDisposition",null,!0)),s.push(new ma("contentEncoding",null,!0)),s.push(new ma("contentLanguage",null,!0)),s.push(new ma("contentType",null,!0)),s.push(new ma("metadata","customMetadata",!0)),jT=s,jT}function wEe(s,e){function t(){const i=s.bucket,n=s.fullPath,r=new dc(i,n);return e._makeStorageReference(r)}Object.defineProperty(s,"ref",{get:t})}function CEe(s,e,t){const i={};i.type="file";const n=t.length;for(let r=0;r<n;r++){const o=t[r];i[o.local]=o.xform(i,e[o.server])}return wEe(i,s),i}function Ede(s,e,t){const i=Lde(e);return i===null?null:CEe(s,i,t)}function yEe(s,e,t,i){const n=Lde(e);if(n===null||!cq(n.downloadTokens))return null;const r=n.downloadTokens;if(r.length===0)return null;const o=encodeURIComponent;return r.split(",").map(c=>{const d=s.bucket,u=s.fullPath,h="/b/"+o(d)+"/o/"+o(u),g=uq(h,t,i),p=Cde({alt:"media",token:c});return g+p})[0]}function SEe(s,e){const t={},i=e.length;for(let n=0;n<i;n++){const r=e[n];r.writable&&(t[r.server]=s[r.local])}return JSON.stringify(t)}class Dde{constructor(e,t,i,n){this.url=e,this.method=t,this.handler=i,this.timeout=n,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tde(s){if(!s)throw lq()}function xEe(s,e){function t(i,n){const r=Ede(s,n,e);return Tde(r!==null),r}return t}function LEe(s,e){function t(i,n){const r=Ede(s,n,e);return Tde(r!==null),yEe(r,n,s.host,s._protocol)}return t}function Nde(s){function e(t,i){let n;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?n=VIe():n=FIe():t.getStatus()===402?n=OIe(s.bucket):t.getStatus()===403?n=BIe(s.path):n=i,n.status=t.getStatus(),n.serverResponse=i.serverResponse,n}return e}function kEe(s){const e=Nde(s);function t(i,n){let r=e(i,n);return i.getStatus()===404&&(r=MIe(s.path)),r.serverResponse=n.serverResponse,r}return t}function IEe(s,e,t){const i=e.fullServerUrl(),n=uq(i,s.host,s._protocol),r="GET",o=s.maxOperationRetryTime,a=new Dde(n,r,LEe(s,t),o);return a.errorHandler=kEe(e),a}function EEe(s,e){return s&&s.contentType||e&&e.type()||"application/octet-stream"}function DEe(s,e,t){const i=Object.assign({},t);return i.fullPath=s.path,i.size=e.size(),i.contentType||(i.contentType=EEe(null,e)),i}function TEe(s,e,t,i,n){const r=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let x="";for(let L=0;L<2;L++)x=x+Math.random().toString().slice(2);return x}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const c=DEe(e,i,n),d=SEe(c,t),u="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,h=`\r
--`+l+"--",g=Np.getBlob(u,i,h);if(g===null)throw $Ie();const p={name:c.fullPath},_=uq(r,s.host,s._protocol),v="POST",C=s.maxUploadRetryTime,y=new Dde(_,v,xEe(s,t),C);return y.urlParams=p,y.headers=o,y.body=g.uploadData(),y.errorHandler=Nde(e),y}class NEe{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=qb.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=qb.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=qb.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,n){if(this.sent_)throw gx("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),n!==void 0)for(const r in n)n.hasOwnProperty(r)&&this.xhr_.setRequestHeader(r,n[r].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw gx("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw gx("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw gx("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw gx("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class REe extends NEe{initXhr(){this.xhr_.responseType="text"}}function Rde(){return new REe}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ow{constructor(e,t){this._service=e,t instanceof dc?this._location=t:this._location=dc.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new ow(e,t)}get root(){const e=new dc(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return kde(this._location.path)}get storage(){return this._service}get parent(){const e=mEe(this._location.path);if(e===null)return null;const t=new dc(this._location.bucket,e);return new ow(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw GIe(e)}}function AEe(s,e,t){s._throwIfRoot("uploadBytes");const i=TEe(s.storage,s._location,Ide(),new Np(e,!0),t);return s.storage.makeRequestWithTokens(i,Rde).then(n=>({metadata:n,ref:s}))}function PEe(s){s._throwIfRoot("getDownloadURL");const e=IEe(s.storage,s._location,Ide());return s.storage.makeRequestWithTokens(e,Rde).then(t=>{if(t===null)throw qIe();return t})}function MEe(s,e){const t=_Ee(s._location.path,e),i=new dc(s._location.bucket,t);return new ow(s.storage,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OEe(s){return/^[A-Za-z]+:\/\//.test(s)}function FEe(s,e){return new ow(s,e)}function Ade(s,e){if(s instanceof hq){const t=s;if(t._bucket==null)throw jIe();const i=new ow(t,t._bucket);return e!=null?Ade(i,e):i}else return e!==void 0?MEe(s,e):s}function VEe(s,e){if(e&&OEe(e)){if(s instanceof hq)return FEe(s,e);throw D7("To use ref(service, url), the first argument must be a Storage instance.")}else return Ade(s,e)}function hee(s,e){const t=e==null?void 0:e[vde];return t==null?null:dc.makeFromBucketSpec(t,s)}function BEe(s,e,t,i={}){s.host=`${e}:${t}`,s._protocol="http";const{mockUserToken:n}=i;n&&(s._overrideAuthToken=typeof n=="string"?n:$ae(n,s.app.options.projectId))}class hq{constructor(e,t,i,n,r){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=n,this._firebaseVersion=r,this._bucket=null,this._host=bde,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=AIe,this._maxUploadRetryTime=PIe,this._requests=new Set,n!=null?this._bucket=dc.makeFromBucketSpec(n,this._host):this._bucket=hee(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=dc.makeFromBucketSpec(this._url,e):this._bucket=hee(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){uee("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){uee("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(rc(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ow(this,e)}_makeRequest(e,t,i,n,r=!0){if(this._deleted)return new QIe(wde());{const o=oEe(e,this._appId,i,n,t,this._firebaseVersion,r);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[i,n]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,n).getPromise()}}const fee="@firebase/storage",gee="0.13.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pde="storage";function z4(s,e,t){return s=cs(s),AEe(s,e,t)}function U4(s){return s=cs(s),PEe(s)}function j4(s,e){return s=cs(s),VEe(s,e)}function WEe(s=g4(),e){s=cs(s);const i=c_(s,Pde).getImmediate({identifier:e}),n=zae("storage");return n&&HEe(i,...n),i}function HEe(s,e,t,i={}){BEe(s,e,t,i)}function zEe(s,{instanceIdentifier:e}){const t=s.getProvider("app").getImmediate(),i=s.getProvider("auth-internal"),n=s.getProvider("app-check-internal");return new hq(t,i,n,e,Vw)}function UEe(){lu(new nd(Pde,zEe,"PUBLIC").setMultipleInstances(!0)),Ll(fee,gee,""),Ll(fee,gee,"esm2017")}UEe();const jEe={apiKey:"AIzaSyCLvnhZcV0vQ-u5_Co64PaDovbWXaHym38",authDomain:"syncodex.firebaseapp.com",databaseURL:"https://syncodex-default-rtdb.firebaseio.com",projectId:"syncodex",storageBucket:"syncodex.firebasestorage.app",messagingSenderId:"1054429357028",appId:"1:1054429357028:web:4233ddef8c4f3c9771ddf1"},fq=Zae(jEe),wt=Mle(fq),Wi=bIe(fq),$4=WEe(fq),zn=()=>{var e,t;const s=l_();return E.jsxs("nav",{className:"fixed top-0 left-0 right-0 h-14 bg-white dark:bg-gray-900 z-50 flex items-center px-2 md:px-4 justify-between",children:[E.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[E.jsx("button",{onClick:()=>window.dispatchEvent(new CustomEvent("toggle-sidebar")),className:"hidden md:block p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full",children:E.jsx("svg",{className:"w-6 h-6 text-gray-900 dark:text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),E.jsx("div",{className:"flex items-center gap-1",children:E.jsx("span",{className:"text-lg md:text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 via-purple-400 to-purple-500",children:"SynCodeX"})})]}),E.jsx("div",{className:"hidden md:block flex-1 max-w-2xl mx-4",children:E.jsxs("div",{className:"relative",children:[E.jsx("input",{type:"text",placeholder:"Search",className:"w-full bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-white px-4 py-2 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500"}),E.jsx("button",{className:"absolute right-3 top-1/2 -translate-y-1/2 p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full",children:E.jsx("svg",{className:"w-5 h-5 text-gray-600 dark:text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})}),E.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[E.jsx("button",{onClick:()=>s("/search"),className:"md:hidden p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full",children:E.jsx("svg",{className:"w-6 h-6 text-gray-900 dark:text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),E.jsx("button",{onClick:()=>s("/upload"),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full",children:E.jsx("svg",{className:"w-6 h-6 text-gray-900 dark:text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0l-4 4m4-4v12"})})}),E.jsx("button",{className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full",children:E.jsx("svg",{className:"w-6 h-6 text-gray-900 dark:text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})})}),E.jsx("button",{onClick:()=>s("/profile"),className:"hidden md:flex items-center justify-center w-8 h-8 rounded-full bg-purple-500 text-white font-semibold hover:bg-purple-600 transition-colors",children:((t=(e=wt.currentUser)==null?void 0:e.email)==null?void 0:t[0].toUpperCase())||"U"})]})]})},Un=()=>{const s=a_(),[e,t]=ie.useState(()=>{const a=localStorage.getItem("sidebarState");return a!==null?JSON.parse(a):!0}),[i,n]=ie.useState(()=>{const a=localStorage.getItem("theme");return a!==null?JSON.parse(a):!0});ie.useEffect(()=>{localStorage.setItem("sidebarState",JSON.stringify(e)),document.documentElement.style.setProperty("--sidebar-width",e?"16rem":"4rem")},[e]),ie.useEffect(()=>{localStorage.setItem("theme",JSON.stringify(i)),document.documentElement.classList.toggle("dark",i)},[i]),ie.useEffect(()=>{const a=()=>t(!e);return window.addEventListener("toggle-sidebar",a),()=>window.removeEventListener("toggle-sidebar",a)},[e]);const r=[{name:"Home",path:"/home",icon:E.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})},{name:"Project",path:"/projects",icon:E.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})},{name:"Editor",path:"/editor",icon:E.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})},{name:"Team",path:"/teams",icon:E.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})},{name:"Community",path:"/community",icon:E.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"})})},{name:"Following",path:"/following",icon:E.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})},{name:"Saved",path:"/saved",icon:E.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"})})}],o=[{name:"Home",path:"/home",icon:E.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})},{name:"Project",path:"/projects",icon:E.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})},{name:"Dashboard",path:"/dashboard",icon:E.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})},{name:"Following",path:"/following",icon:E.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})}];return E.jsxs(E.Fragment,{children:[E.jsx("div",{className:"hidden md:block fixed left-0 top-14 h-[calc(100vh-3.5rem)] bg-white dark:bg-gray-900 transform transition-transform duration-200 ease-in-out z-40 flex-col justify-between border-r border-gray-200 dark:border-gray-800",style:{width:e?"16rem":"4rem"},children:E.jsxs("div",{className:"p-2 space-y-4 h-full flex flex-col justify-between",children:[E.jsx("div",{className:"space-y-2",children:r.map(a=>E.jsxs(xl,{to:a.path,className:`flex items-center gap-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white px-3 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 ${s.pathname.startsWith(a.path)?"bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-white":""}`,children:[E.jsx("div",{className:`transition-all duration-200 ${e?"w-6 h-6":"w-8 h-8"}`,children:a.icon}),E.jsx("span",{className:`transition-opacity duration-200 ${e?"opacity-100":"opacity-0 w-0 overflow-hidden"}`,children:a.name})]},a.name))}),E.jsxs("button",{onClick:()=>n(!i),className:"flex items-center gap-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white px-3 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 mb-2",children:[E.jsx("div",{className:`transition-all duration-200 ${e?"w-6 h-6":"w-8 h-8"}`,children:i?E.jsx("svg",{className:"w-full h-full",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}):E.jsx("svg",{className:"w-full h-full",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})}),E.jsx("span",{className:`transition-opacity duration-200 ${e?"opacity-100":"opacity-0 w-0 overflow-hidden"}`,children:i?"Light Mode":"Dark Mode"})]})]})}),E.jsx("div",{className:"md:hidden fixed bottom-0 left-0 right-0 bg-white dark:bg-gray-900 border-t border-gray-200 dark:border-gray-800 z-40",children:E.jsx("div",{className:"grid grid-cols-4 gap-1 p-2",children:o.map(a=>E.jsxs(xl,{to:a.path,className:`flex flex-col items-center justify-center gap-1 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white ${s.pathname.startsWith(a.path)?"text-gray-900 dark:text-white":""}`,children:[a.icon,E.jsx("span",{className:"text-xs",children:a.name})]},a.name))})})]})},$Ee=({projectId:s,isOpen:e,onClose:t,position:i})=>{const n=ie.useRef(null);ie.useEffect(()=>{const a=l=>{n.current&&!n.current.contains(l.target)&&t()};return e&&document.addEventListener("mousedown",a),()=>{document.removeEventListener("mousedown",a)}},[e,t]);const r=()=>{const a=`${window.location.origin}/${s}`;navigator.clipboard.writeText(a).then(()=>{console.log("Link copied to clipboard")}).catch(l=>{console.error("Failed to copy link:",l)}),t()},o=()=>{console.log("Save project clicked for:",s),t()};return e?E.jsxs("div",{ref:n,className:"absolute z-50 bg-white dark:bg-gray-800 rounded-lg shadow-lg py-1 w-48",style:{top:i.top,left:i.left},children:[E.jsxs("button",{onClick:r,className:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center",children:[E.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Copy Link"]}),E.jsxs("button",{onClick:o,className:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center",children:[E.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"})}),"Save Project"]})]}):null},pee=()=>{const[s,e]=ie.useState(()=>{const h=localStorage.getItem("sidebarState");return h!==null?JSON.parse(h):!0}),[t,i]=ie.useState([]),[n,r]=ie.useState(!0),[o,a]=ie.useState(null),[l,c]=ie.useState({isOpen:!1,projectId:"",position:{top:0,left:0}}),d=ie.useCallback((h,g)=>{h.preventDefault(),h.stopPropagation();const _=h.currentTarget.getBoundingClientRect();c({isOpen:!0,projectId:g,position:{top:_.bottom+window.scrollY,left:_.left-180+_.width}})},[]),u=ie.useCallback(()=>{c(h=>({...h,isOpen:!1}))},[]);return ie.useEffect(()=>{const h=()=>{e(g=>!g)};return window.addEventListener("toggle-sidebar",h),()=>window.removeEventListener("toggle-sidebar",h)},[]),ie.useEffect(()=>{const h=Eh(ta(Wi,"projects"),og("visibility","==","public")),g=c1(h,async p=>{const _=await Promise.all(p.docs.map(async v=>{var L;const C=v.data(),y=await Dh(Cs(Wi,"channels",C.userId)),x=y.exists()?y.data():void 0;return{id:v.id,...C,createdAt:((L=C.createdAt)==null?void 0:L.toDate())||new Date,channel:x}}));i(_),r(!1)},p=>{console.error("Error fetching projects:",p),a("Failed to load projects. Please try again later."),r(!1)});return()=>g()},[]),n?E.jsx("div",{className:"min-h-screen bg-white dark:bg-gray-950 flex items-center justify-center",children:E.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):o?E.jsx("div",{className:"min-h-screen bg-white dark:bg-gray-950 flex items-center justify-center",children:E.jsx("div",{className:"text-red-500 dark:text-red-400",children:o})}):E.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-950",children:[E.jsx(zn,{}),E.jsx(Un,{}),E.jsxs("main",{className:`pt-14 transition-all duration-200 bg-white dark:bg-gray-950 ${s?"md:ml-64":"md:ml-16"}`,children:[E.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 p-4",children:t.map(h=>{var g,p,_;return E.jsxs(xl,{to:`/${h.id}`,className:"block bg-gray-100 dark:bg-gray-900 rounded-xl overflow-hidden hover:transform hover:scale-105 transition-all duration-200 shadow-lg",children:[E.jsx("div",{className:"aspect-video bg-gray-200 dark:bg-gray-800 relative",children:h.thumbnailUrl?E.jsx("img",{src:h.thumbnailUrl,alt:h.title,className:"w-full h-full object-cover"}):E.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:E.jsx("svg",{className:"w-12 h-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})}),E.jsxs("div",{className:"p-3 space-y-2",children:[E.jsxs("div",{className:"flex items-center justify-between",children:[E.jsxs("div",{className:"flex items-center space-x-2",children:[E.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden bg-gray-200 dark:bg-gray-800",children:(g=h.channel)!=null&&g.logoUrl?E.jsx("img",{src:h.channel.logoUrl,alt:h.channel.name,className:"w-full h-full object-cover"}):E.jsx("svg",{className:"w-full h-full text-gray-400 p-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),E.jsxs("div",{className:"flex-1 min-w-0",children:[E.jsx("h3",{className:"text-gray-900 dark:text-white font-medium truncate",children:h.title}),E.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 truncate",children:["@",((p=h.channel)==null?void 0:p.handle)||"anonymous"]})]})]}),E.jsx("button",{className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-800 rounded-full",onClick:v=>d(v,h.id),children:E.jsx("svg",{className:"w-5 h-5 text-gray-600 dark:text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})})]}),E.jsx("div",{className:"flex items-center space-x-2",children:((_=h.programmingLanguages)==null?void 0:_[0])&&E.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 rounded-full",children:h.programmingLanguages[0]})})]})]},h.id)})}),E.jsx($Ee,{projectId:l.projectId,isOpen:l.isOpen,onClose:u,position:l.position})]})]})},Vc=()=>{const s=l_(),[e,t]=ie.useState(""),[i,n]=ie.useState(""),[r,o]=ie.useState(""),[a,l]=ie.useState(""),[c,d]=ie.useState(!1),u=async g=>{g.preventDefault(),o(""),l("");try{if(c){await lSe(wt,e),l("Password reset email sent. Please check your inbox."),d(!1);return}await cSe(wt,e,i),s("/home")}catch(p){o(p.message)}},h=async g=>{try{switch(g){case"google":await b9(wt,new Pf);break;case"github":await b9(wt,new Mf);break;case"facebook":await b9(wt,new Af);break;default:break}s("/home")}catch(p){o(p.message)}};return E.jsxs("div",{className:"h-screen w-screen flex items-center justify-center bg-gradient-to-br from-gray-950 via-gray-900 to-gray-950 overflow-hidden relative",children:[E.jsx("div",{className:"absolute inset-0 w-full h-full bg-[radial-gradient(ellipse_at_center,_var(--tw-gradient-stops))] from-blue-500/10 via-transparent to-transparent opacity-50"}),E.jsxs("div",{className:"max-w-md w-full mx-4 p-6 sm:p-8 bg-gray-900/40 backdrop-blur-2xl rounded-2xl shadow-[0_8px_32px_rgba(0,0,0,0.4)] border border-gray-700/30 relative z-10",children:[E.jsxs("div",{className:"text-center space-y-1",children:[E.jsx("h1",{className:"text-4xl sm:text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 via-purple-400 to-purple-500 filter drop-shadow-lg",children:"SynCodeX"}),E.jsx("h2",{className:"text-lg sm:text-xl font-medium text-gray-200",children:c?"Reset Password":"Sign in to your account"})]}),E.jsxs("form",{onSubmit:u,className:"mt-8 space-y-4",children:[E.jsxs("div",{className:"space-y-3",children:[E.jsxs("div",{className:"relative group",children:[E.jsx("label",{htmlFor:"email",className:"sr-only",children:"Email address"}),E.jsx("input",{id:"email",name:"email",type:"email",required:!0,value:e,onChange:g=>t(g.target.value),className:"appearance-none relative block w-full px-4 py-3 border-2 border-gray-700/50 bg-gray-900/50 placeholder-gray-500 text-gray-100 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-transparent transition-all duration-200 group-hover:border-gray-600/50",placeholder:"Email address"})]}),!c&&E.jsxs("div",{className:"relative group",children:[E.jsx("label",{htmlFor:"password",className:"sr-only",children:"Password"}),E.jsx("input",{id:"password",name:"password",type:"password",required:!0,value:i,onChange:g=>n(g.target.value),className:"appearance-none relative block w-full px-4 py-3 border-2 border-gray-700/50 bg-gray-900/50 placeholder-gray-500 text-gray-100 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-transparent transition-all duration-200 group-hover:border-gray-600/50",placeholder:"Password"})]})]}),r&&E.jsx("div",{className:"text-red-400 text-sm mt-2 bg-red-500/10 p-3 rounded-xl border border-red-500/20 backdrop-blur-sm",children:r}),a&&E.jsx("div",{className:"text-green-400 text-sm mt-2 bg-green-500/10 p-3 rounded-xl border border-green-500/20 backdrop-blur-sm",children:a}),E.jsx("button",{type:"submit",className:"w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-xl text-white bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-200 transform hover:scale-[1.02] hover:shadow-lg shadow-md",children:c?"Send Reset Link":"Sign in"}),E.jsx("div",{className:"text-center",children:E.jsx("button",{type:"button",onClick:()=>{d(!c),o(""),l("")},className:"text-sm text-gray-400 hover:text-gray-200 transition-colors duration-200 underline-offset-4 hover:underline",children:c?"Back to login":"Forgot password?"})})]}),!c&&E.jsxs("div",{className:"mt-6",children:[E.jsxs("div",{className:"relative",children:[E.jsx("div",{className:"absolute inset-0 flex items-center",children:E.jsx("div",{className:"w-full border-t border-gray-800/50"})}),E.jsx("div",{className:"relative flex justify-center text-sm",children:E.jsx("span",{className:"px-4 text-gray-400 bg-gray-900/80 backdrop-blur-xl rounded-full",children:"Or continue with"})})]}),E.jsxs("div",{className:"mt-4 grid grid-cols-3 gap-3",children:[E.jsx("button",{onClick:()=>h("google"),className:"w-full inline-flex justify-center items-center py-2.5 px-3 border-2 border-gray-700/50 rounded-xl bg-gray-900/30 hover:bg-gray-800/50 text-gray-300 hover:text-white transition-all duration-200 transform hover:scale-[1.02] hover:shadow-lg backdrop-blur-xl group",children:E.jsxs("svg",{className:"w-5 h-5 transition-transform duration-200 group-hover:scale-110",viewBox:"0 0 24 24",children:[E.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),E.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),E.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),E.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]})}),E.jsx("button",{onClick:()=>h("github"),className:"w-full inline-flex justify-center items-center py-2.5 px-3 border-2 border-gray-700/50 rounded-xl bg-gray-900/30 hover:bg-gray-800/50 text-gray-300 hover:text-white transition-all duration-200 transform hover:scale-[1.02] hover:shadow-lg backdrop-blur-xl group",children:E.jsx("svg",{className:"w-5 h-5 transition-transform duration-200 group-hover:scale-110",viewBox:"0 0 24 24",children:E.jsx("path",{d:"M12 1.27a11 11 0 00-3.48 21.46c.55.09.73-.24.73-.53v-1.85c-3.03.66-3.67-1.45-3.67-1.45-.5-1.27-1.21-1.6-1.21-1.6-.99-.67.07-.66.07-.66 1.09.08 1.67 1.12 1.67 1.12.97 1.66 2.54 1.18 3.16.9.1-.7.38-1.18.69-1.45-2.42-.27-4.96-1.21-4.96-5.38 0-1.19.42-2.16 1.12-2.92-.11-.28-.49-1.4.11-2.91 0 0 .92-.29 3 1.12a10.44 10.44 0 015.5 0c2.08-1.41 3-1.12 3-1.12.6 1.51.22 2.63.11 2.91.7.76 1.12 1.73 1.12 2.92 0 4.18-2.55 5.11-4.98 5.37.39.34.74 1 .74 2.02v3c0 .29.19.63.74.53A11 11 0 0012 1.27",fill:"currentColor"})})}),E.jsx("button",{onClick:()=>h("facebook"),className:"w-full inline-flex justify-center items-center py-2.5 px-3 border-2 border-gray-700/50 rounded-xl bg-gray-900/30 hover:bg-gray-800/50 text-gray-300 hover:text-white transition-all duration-200 transform hover:scale-[1.02] hover:shadow-lg backdrop-blur-xl group",children:E.jsx("svg",{className:"w-5 h-5 transition-transform duration-200 group-hover:scale-110",viewBox:"0 0 24 24",children:E.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z",fill:"currentColor"})})})]})]})]})]})},qEe=()=>{const s=l_(),[e,t]=ie.useState({name:"",handle:"",description:"",logoUrl:""}),[i,n]=ie.useState(null),[r,o]=ie.useState(!1),[a,l]=ie.useState(""),[c,d]=ie.useState({isValid:!0,message:"",originalHandle:""});ie.useEffect(()=>{(async()=>{var y,x,L;if(wt.currentUser)try{const I=Cs(Wi,"channels",wt.currentUser.uid),A=await Dh(I);if(A.exists()){const D=A.data();t(D),n(D),d(N=>({...N,originalHandle:D.handle}))}else{const D={name:((y=wt.currentUser)==null?void 0:y.displayName)||((L=(x=wt.currentUser)==null?void 0:x.email)==null?void 0:L.split("@")[0])||"",handle:"",description:"",logoUrl:""};t(D),n(D)}}catch(I){console.error("Error fetching channel data:",I),l("Failed to load channel data")}})()},[]);const u=()=>i?e.name!==i.name||e.handle!==i.handle||e.description!==i.description||e.logoUrl!==i.logoUrl:!1,h=async C=>{if(C){if(C===c.originalHandle){d(y=>({...y,isValid:!0,message:""}));return}try{const y=ta(Wi,"channels"),x=Eh(y,og("handle","==",C));(await a1(x)).empty?d(I=>({...I,isValid:!0,message:"Username is available"})):d(I=>({...I,isValid:!1,message:"Username is already taken"}))}catch(y){console.error("Error checking handle availability:",y),d(x=>({...x,isValid:!1,message:"Error checking username availability"}))}}},g=C=>{const{name:y,value:x}=C.target;if(t(L=>({...L,[y]:x})),y==="handle"){const L=setTimeout(()=>h(x),500);return()=>clearTimeout(L)}},p=async C=>{if(C.preventDefault(),!(!wt.currentUser||!c.isValid)){o(!0),l("");try{const y=Cs(Wi,"channels",wt.currentUser.uid);await $b(y,e),d(x=>({...x,originalHandle:e.handle}))}catch(y){console.error("Error saving channel data:",y),l("Failed to save changes")}finally{o(!1)}}},_=async C=>{var I;const y=(I=C.target.files)==null?void 0:I[0];if(!y||!wt.currentUser)return;if(!["image/jpeg","image/png","image/gif"].includes(y.type)){l("Please upload a valid image file (JPEG, PNG, or GIF)");return}const L=5*1024*1024;if(y.size>L){l("Image size should be less than 5MB");return}o(!0),l("");try{const A=Date.now(),D=`${wt.currentUser.uid}_${A}`,N=j4($4,`profile-pictures/${D}`),R={contentType:y.type,customMetadata:{userId:wt.currentUser.uid,uploadedAt:new Date().toISOString()}};await z4(N,y,R);const H=await U4(N),U={...e,logoUrl:H},B=Cs(Wi,"channels",wt.currentUser.uid);await $b(B,U),t(U),n(U)}catch(A){console.error("Error uploading image:",A),l("Failed to upload image")}finally{o(!1)}},v=async()=>{try{await hSe(wt),s("/")}catch(C){console.error("Error signing out:",C),l("Failed to sign out")}};return E.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-950",children:[E.jsx(zn,{}),E.jsx(Un,{}),E.jsx("div",{className:"pl-[var(--sidebar-width)] pt-14 transition-[padding] duration-200",children:E.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[E.jsxs("div",{className:"bg-gray-100 dark:bg-gray-900/40 backdrop-blur-xl rounded-2xl p-6 border border-gray-200 dark:border-gray-700/30",children:[E.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-6",children:"Profile Settings"}),E.jsx("div",{className:"mb-6",children:E.jsxs("div",{className:"flex items-center space-x-4",children:[E.jsxs("div",{className:"relative group",children:[E.jsx("div",{className:"w-24 h-24 rounded-full overflow-hidden bg-gray-800 border-2 border-gray-700/50",children:e.logoUrl?E.jsx("img",{src:e.logoUrl,alt:"Profile",className:"w-full h-full object-cover"}):E.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:E.jsx("svg",{className:"w-12 h-12",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})})}),E.jsxs("label",{className:"absolute bottom-0 right-0 bg-blue-500 hover:bg-blue-600 text-white rounded-full p-2 cursor-pointer transition-all duration-200 transform hover:scale-110",children:[E.jsx("input",{type:"file",className:"hidden",onChange:_,accept:"image/*"}),E.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})]})]}),E.jsxs("div",{children:[E.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:e.name||"Your Name"}),E.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["@",e.handle||"username"]})]})]})})]}),E.jsxs("div",{className:"flex justify-between items-center mb-8",children:[E.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Channel Customization"}),E.jsx("button",{onClick:v,className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 focus:ring-offset-gray-900 transition-colors",children:"Sign Out"})]}),a&&E.jsx("div",{className:"mb-4 p-4 bg-red-500 bg-opacity-10 border border-red-500 rounded-lg text-red-500",children:a}),E.jsxs("form",{onSubmit:p,className:"space-y-6",children:[E.jsxs("div",{children:[E.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Channel Name"}),E.jsx("input",{type:"text",id:"name",name:"name",value:e.name,onChange:g,className:"mt-1 block w-full px-4 py-3 bg-white dark:bg-gray-800/50 border-2 border-gray-200 dark:border-gray-700/50 rounded-xl text-gray-900 dark:text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-transparent",placeholder:"Enter your channel name"})]}),E.jsxs("div",{children:[E.jsx("label",{htmlFor:"handle",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Username"}),E.jsxs("div",{className:"mt-1 relative",children:[E.jsx("input",{type:"text",id:"handle",name:"handle",value:e.handle,onChange:g,className:`block w-full px-4 py-3 bg-white dark:bg-gray-800/50 border-2 ${c.isValid?"border-gray-200 dark:border-gray-700/50":"border-red-500/50"} rounded-xl text-gray-900 dark:text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-transparent`,placeholder:"Choose a unique username"}),c.message&&E.jsx("p",{className:`mt-2 text-sm ${c.isValid?"text-green-400":"text-red-400"}`,children:c.message})]})]}),E.jsxs("div",{children:[E.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Description"}),E.jsx("textarea",{id:"description",name:"description",value:e.description,onChange:g,rows:4,className:"mt-1 block w-full px-4 py-3 bg-white dark:bg-gray-800/50 border-2 border-gray-200 dark:border-gray-700/50 rounded-xl text-gray-900 dark:text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-transparent resize-none",placeholder:"Tell us about your channel"})]}),a&&E.jsx("div",{className:"p-4 bg-red-500/10 border border-red-500/20 rounded-xl",children:E.jsx("p",{className:"text-red-400",children:a})}),E.jsxs("div",{className:"flex items-center justify-between pt-4",children:[E.jsx("button",{type:"button",onClick:v,className:"px-4 py-2 text-gray-400 hover:text-white transition-colors duration-200",children:"Sign Out"}),E.jsx("button",{type:"submit",disabled:!u()||!c.isValid||r,className:`px-6 py-3 rounded-xl text-white font-medium transition-all duration-200 ${u()&&c.isValid&&!r?"bg-blue-500 hover:bg-blue-600":"bg-gray-700 cursor-not-allowed"}`,children:r?"Saving...":"Save Changes"})]})]})]})})]})},KEe=()=>{const s=l_(),[e,t]=ie.useState(!1),[i,n]=ie.useState(""),[r,o]=ie.useState(null),[a,l]=ie.useState(""),[c,d]=ie.useState({title:"",description:"",language:"",visibility:"public",tags:"",thumbnailUrl:""}),u=["JavaScript","TypeScript","Python","Java","C++","C#","Ruby","PHP","Swift","Kotlin","Go","Rust","Other"],h=_=>{const{name:v,value:C}=_.target;d(y=>({...y,[v]:C}))},g=_=>{var L;const v=(L=_.target.files)==null?void 0:L[0];if(!v)return;if(!["image/jpeg","image/png","image/gif"].includes(v.type)){n("Please upload a valid image file (JPEG, PNG, or GIF)");return}const y=5*1024*1024;if(v.size>y){n("Image size should be less than 5MB");return}o(v),n("");const x=new FileReader;x.onloadend=()=>{l(x.result)},x.readAsDataURL(v)},p=async _=>{if(_.preventDefault(),!wt.currentUser){n("Please ensure you are logged in");return}if(!c.title.trim()){n("Please enter a project title");return}t(!0),n("");try{let v="",C="";if(r){C=Cs(ta(Wi,"projects")).id;const L=`thumbnail_${r.name}`,I=j4($4,`projects/${C}/thumbnail/${L}`),A={contentType:r.type,customMetadata:{projectId:C,userId:wt.currentUser.uid,uploadedAt:new Date().toISOString(),originalName:r.name}};try{const D=await z4(I,r,A);v=await U4(D.ref)}catch(D){throw console.error("Error uploading thumbnail:",D),D.code==="storage/unauthorized"?new Error("You do not have permission to upload files"):D.code==="storage/canceled"?new Error("Upload was canceled"):D.code==="storage/unknown"?new Error("An unknown error occurred during upload"):new Error("Failed to upload thumbnail: "+(D.message||"Unknown error"))}}const y=c.tags?c.tags.split(",").map(x=>x.trim()).filter(x=>x):[];C||(C=Cs(ta(Wi,"projects")).id),await $b(Cs(Wi,"projects",C),{projectId:C,title:c.title.trim(),description:c.description.trim(),programmingLanguages:[c.language],visibility:c.visibility,uploadedAt:LL(),userId:wt.currentUser.uid,tags:y,likes:[],thumbnailUrl:v}),s("/home")}catch(v){console.error("Error uploading project:",v),n(v.message||"Failed to upload project")}finally{t(!1)}};return E.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-950",children:[E.jsx(zn,{}),E.jsx(Un,{}),E.jsx("div",{className:"pl-[var(--sidebar-width)] pt-14 transition-[padding] duration-200",children:E.jsx("div",{className:"max-w-4xl mx-auto p-6",children:E.jsxs("div",{className:"bg-gray-100 dark:bg-gray-900/40 backdrop-blur-xl rounded-2xl p-6 border border-gray-200 dark:border-gray-700/30",children:[E.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-6",children:"Upload Project"}),E.jsxs("form",{onSubmit:p,className:"space-y-6",children:[E.jsxs("div",{className:"space-y-4",children:[E.jsxs("div",{children:[E.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Project Title"}),E.jsx("input",{type:"text",id:"title",name:"title",required:!0,value:c.title,onChange:h,className:"mt-1 block w-full px-4 py-3 bg-white dark:bg-gray-800/50 border-2 border-gray-200 dark:border-gray-700/50 rounded-xl text-gray-900 dark:text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-transparent",placeholder:"Enter your project title"})]}),E.jsxs("div",{children:[E.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Description"}),E.jsx("textarea",{id:"description",name:"description",required:!0,value:c.description,onChange:h,rows:4,className:"mt-1 block w-full px-4 py-3 bg-white dark:bg-gray-800/50 border-2 border-gray-200 dark:border-gray-700/50 rounded-xl text-gray-900 dark:text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-transparent resize-none",placeholder:"Describe your project"})]}),E.jsxs("div",{children:[E.jsx("label",{htmlFor:"language",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Programming Language"}),E.jsxs("select",{id:"language",name:"language",required:!0,value:c.language,onChange:h,className:"mt-1 block w-full px-4 py-3 bg-white dark:bg-gray-800/50 border-2 border-gray-200 dark:border-gray-700/50 rounded-xl text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-transparent",children:[E.jsx("option",{value:"",children:"Select a language"}),u.map(_=>E.jsx("option",{value:_,children:_},_))]})]}),E.jsxs("div",{children:[E.jsx("label",{htmlFor:"thumbnail",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Project Thumbnail"}),E.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-200 dark:border-gray-700/50 border-dashed rounded-xl",children:E.jsx("div",{className:"space-y-1 text-center",children:a?E.jsxs("div",{className:"relative w-full max-w-[300px] mx-auto",children:[E.jsx("img",{src:a,alt:"Thumbnail preview",className:"rounded-lg shadow-lg"}),E.jsx("button",{type:"button",onClick:()=>{o(null),l("")},className:"absolute top-2 right-2 p-1 bg-red-500 text-white rounded-full hover:bg-red-600 focus:outline-none",children:E.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):E.jsxs(E.Fragment,{children:[E.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:E.jsx("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),E.jsxs("div",{className:"flex text-sm text-gray-600 dark:text-gray-400",children:[E.jsxs("label",{htmlFor:"thumbnail",className:"relative cursor-pointer rounded-md font-medium text-blue-500 hover:text-blue-400 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-blue-500",children:[E.jsx("span",{children:"Upload a file"}),E.jsx("input",{id:"thumbnail",name:"thumbnail",type:"file",accept:"image/*",onChange:g,className:"sr-only"})]}),E.jsx("p",{className:"pl-1",children:"or drag and drop"})]}),E.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"PNG, JPG, GIF up to 5MB"})]})})})]}),E.jsxs("div",{children:[E.jsx("label",{htmlFor:"tags",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Tags"}),E.jsx("input",{type:"text",id:"tags",name:"tags",value:c.tags,onChange:h,className:"mt-1 block w-full px-4 py-3 bg-white dark:bg-gray-800/50 border-2 border-gray-200 dark:border-gray-700/50 rounded-xl text-gray-900 dark:text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-transparent",placeholder:"Enter tags separated by commas"})]}),E.jsxs("div",{children:[E.jsx("label",{htmlFor:"visibility",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Visibility"}),E.jsxs("select",{id:"visibility",name:"visibility",value:c.visibility,onChange:h,className:"mt-1 block w-full px-4 py-3 bg-white dark:bg-gray-800/50 border-2 border-gray-200 dark:border-gray-700/50 rounded-xl text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-transparent",children:[E.jsx("option",{value:"public",children:"Public"}),E.jsx("option",{value:"private",children:"Private"})]})]})]}),i&&E.jsx("div",{className:"text-red-400 text-sm mt-2 bg-red-500/10 p-3 rounded-xl border border-red-500/20 backdrop-blur-sm",children:i}),E.jsx("button",{type:"submit",disabled:e,className:`w-full flex items-center justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-xl text-white bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-200 transform hover:scale-[1.02] hover:shadow-lg shadow-md ${e?"opacity-50 cursor-not-allowed":""}`,children:e?E.jsxs(E.Fragment,{children:[E.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[E.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),E.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Uploading..."]}):"Upload Project"})]})]})})})]})},mee=({projectId:s,isModal:e=!1})=>{const[t,i]=ie.useState([]),[n,r]=ie.useState(""),[o,a]=ie.useState(!0),[l,c]=ie.useState("");ie.useEffect(()=>{if(!s)return;const p=Eh(ta(Wi,`projects/${s}/comments`),dde("createdAt","desc")),_=c1(p,v=>{const C=v.docs.map(y=>({id:y.id,...y.data()}));i(C),a(!1)},v=>{console.error("Error fetching comments:",v),c("Failed to load comments"),a(!1)});return()=>_()},[s]);const d=async p=>{if(p.preventDefault(),!wt.currentUser){c("Please sign in to comment");return}if(!n.trim()){c("Comment cannot be empty");return}if(!s){c("Invalid project reference");return}try{c(""),a(!0);const _={projectId:s,text:n.trim(),userId:wt.currentUser.uid,userName:wt.currentUser.displayName||"Anonymous",userPhotoUrl:wt.currentUser.photoURL||"",createdAt:ur.now(),likes:[]};await aq(ta(Wi,`projects/${s}/comments`),_),r("")}catch(_){console.error("Error adding comment:",_),c(_ instanceof Error?_.message:"Failed to add comment. Please try again.")}finally{a(!1)}},u=async(p,_)=>{if(wt.currentUser)try{const v=Cs(Wi,`projects/${s}/comments`,p),C=wt.currentUser.uid;_.includes(C)?await l1(v,{likes:_de(C)}):await l1(v,{likes:mde(C)})}catch(v){console.error("Error updating like:",v)}},h=async(p,_)=>{if(!(!wt.currentUser||wt.currentUser.uid!==_))try{await NIe(Cs(Wi,`projects/${s}/comments`,p))}catch(v){console.error("Error deleting comment:",v),c("Failed to delete comment")}},g=p=>{const _=p.toDate(),C=Math.abs(new Date().getTime()-_.getTime()),y=Math.floor(C/(1e3*60*60*24)),x=Math.floor(C/(1e3*60*60)),L=Math.floor(C/(1e3*60));return y>7?_.toLocaleDateString():y>0?`${y} day${y>1?"s":""} ago`:x>0?`${x} hour${x>1?"s":""} ago`:L>0?`${L} minute${L>1?"s":""} ago`:"Just now"};return o?E.jsx("div",{className:"flex justify-center items-center py-8",children:E.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"})}):E.jsxs("div",{className:`${e?"h-full flex flex-col":"mt-8"} space-y-6 relative flex flex-col ${e?"h-[100dvh]":"h-[600px]"}`,children:[E.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white sticky top-0 bg-white dark:bg-gray-950 py-4 z-10 border-b border-gray-200 dark:border-gray-800",children:"Comments"}),E.jsx("div",{className:"flex-1 overflow-y-auto space-y-4 px-4 pb-20 overscroll-contain",children:t.map(p=>{var _,v,C;return E.jsxs("div",{className:"flex space-x-3",children:[E.jsx("div",{className:"flex-shrink-0",children:E.jsx("img",{src:p.userPhotoUrl||"/default-avatar.png",alt:p.userName,className:"h-8 w-8 rounded-full"})}),E.jsxs("div",{className:"flex-1 min-w-0",children:[E.jsxs("div",{className:"bg-gray-100 dark:bg-gray-800 rounded-2xl px-4 py-2 max-w-[85%] inline-block",children:[E.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[E.jsx("span",{className:"font-medium text-sm text-gray-900 dark:text-white",children:p.userName}),E.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:g(p.createdAt)})]}),E.jsx("p",{className:"text-gray-800 dark:text-gray-200 text-sm break-words",children:p.text})]}),E.jsxs("div",{className:"mt-1 flex items-center space-x-4",children:[E.jsxs("button",{onClick:()=>u(p.id,p.likes),className:`flex items-center space-x-1 text-xs ${p.likes.includes(((_=wt.currentUser)==null?void 0:_.uid)||"")?"text-blue-500":"text-gray-500 dark:text-gray-400"}`,children:[E.jsx("svg",{className:"w-4 h-4",fill:p.likes.includes(((v=wt.currentUser)==null?void 0:v.uid)||"")?"currentColor":"none",stroke:"currentColor",viewBox:"0 0 24 24",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21h-4.017c-.163 0-.326-.02-.485-.06L7 20m7-10V5a2 2 0 00-2-2h-.095c-.5 0-.905.405-.905.905 0 .714-.211 1.412-.608 2.006L7 11v9m7-10h-2M7 20H5a2 2 0 01-2-2v-6a2 2 0 012-2h2.5"})}),E.jsx("span",{children:p.likes.length})]}),((C=wt.currentUser)==null?void 0:C.uid)===p.userId&&E.jsx("button",{onClick:()=>h(p.id,p.userId),className:"text-xs text-red-500 hover:text-red-600 transition-colors duration-200",children:"Delete"})]})]})]},p.id)})}),E.jsxs("div",{className:"sticky bottom-0 left-0 right-0 bg-white dark:bg-gray-950 border-t border-gray-200 dark:border-gray-800 p-4 z-10",children:[l&&E.jsx("div",{className:"text-red-500 dark:text-red-400 text-sm mb-2",children:l}),E.jsxs("form",{onSubmit:d,className:"flex space-x-2",children:[E.jsx("input",{type:"text",value:n,onChange:p=>r(p.target.value),placeholder:"Write a comment...",className:"flex-1 bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:!wt.currentUser||o}),E.jsx("button",{type:"submit",disabled:!wt.currentUser||o,className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:o?E.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-white"}):"Send"})]}),!wt.currentUser&&E.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2",children:"Please sign in to comment"})]}),t.length===0&&E.jsx("div",{className:"text-center text-gray-500 dark:text-gray-400 py-8",children:"No comments yet. Be the first to comment!"})]})},GEe=s=>{const[e,t]=ie.useState(0),[i,n]=ie.useState(!0);return ie.useEffect(()=>{(async()=>{if(!s||!wt.currentUser){n(!1);return}try{const a=`${wt.currentUser.uid}_${s}`,l=Cs(Wi,"project_views",a),c=Cs(Wi,"projects",s),d=await Dh(c);d.exists()&&t(d.data().views||0);const u=await Dh(l),h=new Date,g=new Date(h.getTime()-3*60*60*1e3);(!u.exists()||u.data().lastViewed.toDate()<g)&&(await $b(l,{lastViewed:h},{merge:!0}),await l1(c,{views:RIe(1)}),t(p=>p+1))}catch(o){console.error("Error tracking view:",o)}finally{n(!1)}})()},[s]),{viewCount:e,loading:i}},QEe=()=>{var x,L;const{projectId:s}=J1(),{viewCount:e}=GEe(s||""),[t,i]=ie.useState(null),[n,r]=ie.useState(null),[o,a]=ie.useState(!0),[l,c]=ie.useState(""),[d,u]=ie.useState(!1),[h,g]=ie.useState(0),[p,_]=ie.useState(!1),[v,C]=ie.useState(!1);ie.useEffect(()=>{(async()=>{var A,D,N;if(s)try{const R=await Dh(Cs(Wi,"projects",s));if(!R.exists()){c("Project not found"),a(!1);return}const W=R.data();i(W),g(((A=W.likes)==null?void 0:A.length)||0),u(((N=W.likes)==null?void 0:N.includes(((D=wt.currentUser)==null?void 0:D.uid)||""))||!1);const H=await Dh(Cs(Wi,"channels",W.userId));H.exists()&&r(H.data())}catch(R){console.error("Error fetching project:",R),c("Failed to load project")}finally{a(!1)}})()},[s]);const y=async()=>{if(!(!wt.currentUser||!s||p)){_(!0);try{const I=Cs(Wi,"projects",s),A=wt.currentUser.uid;d?(await l1(I,{likes:_de(A)}),g(D=>D-1)):(await l1(I,{likes:mde(A)}),g(D=>D+1)),u(!d)}catch(I){console.error("Error updating like:",I)}finally{_(!1)}}};return o?E.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-950",children:[E.jsx(zn,{}),E.jsx(Un,{}),E.jsx("div",{className:"pl-[var(--sidebar-width)] md:pl-[var(--sidebar-width)] pt-14 transition-[padding] duration-200",children:E.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-3.5rem)]",children:E.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})})})]}):l||!t?E.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-950",children:[E.jsx(zn,{}),E.jsx(Un,{}),E.jsx("div",{className:"pl-[var(--sidebar-width)] md:pl-[var(--sidebar-width)] pt-14 transition-[padding] duration-200",children:E.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-3.5rem)]",children:E.jsx("div",{className:"text-red-500 dark:text-red-400",children:l||"Project not found"})})})]}):E.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-950",children:[E.jsx(zn,{}),E.jsx(Un,{}),E.jsx("div",{className:"pl-0 md:pl-[var(--sidebar-width)] pt-14 transition-[padding] duration-200",children:E.jsxs("div",{className:"max-w-[1920px] mx-auto p-3 md:p-6 grid grid-cols-1 lg:grid-cols-[1fr,400px] gap-6",children:[E.jsxs("div",{className:"bg-gray-100 dark:bg-gray-900/40 backdrop-blur-xl rounded-xl md:rounded-2xl p-4 md:p-6 border border-gray-200 dark:border-gray-700/30",children:[t.thumbnailUrl&&E.jsx("div",{className:"relative w-full h-[200px] md:h-[400px] mb-4 md:mb-6 rounded-lg md:rounded-xl overflow-hidden",children:E.jsx("img",{src:t.thumbnailUrl,alt:t.title,className:"w-full h-full object-cover"})}),E.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-4 md:gap-6 mb-4 md:mb-6",children:[E.jsxs("div",{children:[E.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900 dark:text-white mb-2",children:t.title}),E.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400 flex items-center space-x-4",children:[E.jsx("span",{children:(x=t.uploadedAt)==null?void 0:x.toDate().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}),E.jsxs("span",{className:"flex items-center space-x-1",children:[E.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),E.jsxs("span",{children:[e," views"]})]})]})]}),E.jsxs("div",{className:"flex space-x-2",children:[E.jsxs("button",{onClick:y,disabled:!wt.currentUser||p,className:`flex items-center justify-center md:justify-start space-x-2 px-4 py-2 rounded-xl transition-all duration-200 ${d?"bg-blue-500 text-white":"bg-gray-200 dark:bg-gray-800 text-gray-700 dark:text-gray-300"} hover:scale-105 disabled:opacity-50 disabled:hover:scale-100 w-full md:w-auto`,children:[E.jsx("svg",{className:`w-5 h-5 ${d?"fill-current":"stroke-current fill-none"}`,viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),E.jsx("span",{children:h})]}),((L=wt.currentUser)==null?void 0:L.uid)===t.userId&&E.jsxs(xl,{to:`/projects/${s}`,className:"flex items-center justify-center space-x-2 px-4 py-2 rounded-xl bg-gray-200 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:scale-105 transition-all duration-200 w-full md:w-auto",children:[E.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),E.jsx("span",{children:"Edit"})]}),E.jsxs("button",{onClick:()=>C(!0),className:"lg:hidden flex items-center justify-center space-x-2 px-4 py-2 rounded-xl bg-gray-200 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:scale-105 transition-all duration-200 w-full md:w-auto",children:[E.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),E.jsx("span",{children:"Comments"})]})]})]}),E.jsx("div",{className:"prose dark:prose-invert max-w-none mb-4 md:mb-6",children:E.jsx("p",{className:"text-sm md:text-base text-gray-700 dark:text-gray-300 whitespace-pre-wrap",children:t.description})}),n&&E.jsx("div",{className:"flex items-center space-x-3 md:space-x-4 p-3 md:p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg md:rounded-xl mb-4 md:mb-6 hover:bg-gray-100 dark:hover:bg-gray-800/70 transition-colors cursor-pointer",children:E.jsxs(xl,{to:`/channel/${n.handle}`,className:"flex items-center space-x-3 md:space-x-4 flex-1",children:[E.jsx("div",{className:"w-12 h-12 md:w-16 md:h-16 rounded-full overflow-hidden flex-shrink-0",children:E.jsx("img",{src:n.logoUrl||"/default-avatar.png",alt:n.name,className:"w-full h-full object-cover"})}),E.jsx("div",{children:E.jsx("h3",{className:"text-base md:text-lg font-semibold text-gray-900 dark:text-white hover:text-blue-500 dark:hover:text-blue-400 transition-colors",children:n.name})})]})})]}),E.jsx("div",{className:"hidden lg:block sticky top-[calc(3.5rem+1.5rem)] h-[calc(100vh-5rem)]",children:E.jsx("div",{className:"bg-gray-100 dark:bg-gray-900/40 backdrop-blur-xl rounded-xl md:rounded-2xl p-4 md:p-6 border border-gray-200 dark:border-gray-700/30 h-full overflow-hidden",children:E.jsx(mee,{projectId:s||""})})})]})}),v&&E.jsxs("div",{className:"fixed inset-0 z-50 lg:hidden",children:[E.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>C(!1)}),E.jsx("div",{className:"absolute inset-x-0 bottom-0 bg-white dark:bg-gray-950 rounded-t-2xl max-h-[80vh] flex flex-col transform transition-transform duration-300 ease-out",children:E.jsx("div",{className:"p-4 flex-1 overflow-hidden",children:E.jsx(mee,{projectId:s||"",isModal:!0})})})]})]})},YEe=()=>{const{projectId:s}=J1(),e=l_(),[t,i]=ie.useState(!1),[n,r]=ie.useState(""),[o,a]=ie.useState({title:"",description:"",programmingLanguages:[],visibility:"public",tags:[],thumbnail:null}),[l,c]=ie.useState("");ie.useEffect(()=>{(async()=>{var v;if(s)try{const C=await Dh(Cs(Wi,"projects",s));if(!C.exists()){r("Project not found");return}const y=C.data();if(y.userId!==((v=wt.currentUser)==null?void 0:v.uid)){r("You do not have permission to edit this project");return}a({title:y.title,description:y.description,programmingLanguages:y.programmingLanguages,visibility:y.visibility,tags:y.tags,thumbnail:null}),c(y.thumbnailUrl)}catch(C){console.error("Error fetching project:",C),r("Failed to load project")}})()},[s]);const d=_=>{const{name:v,value:C}=_.target;a(y=>({...y,[v]:C}))},u=_=>{const v=_.target.value.trim();v&&!o.programmingLanguages.includes(v)&&a(C=>({...C,programmingLanguages:[...C.programmingLanguages,v]}))},h=_=>{const v=_.target.value.trim();v&&!o.tags.includes(v)&&a(C=>({...C,tags:[...C.tags,v]}))},g=_=>{var C;const v=(C=_.target.files)==null?void 0:C[0];v&&a(y=>({...y,thumbnail:v}))},p=async _=>{if(_.preventDefault(),!(!wt.currentUser||!s)){i(!0),r("");try{const v=Cs(Wi,"projects",s);let C=l;if(o.thumbnail){const y=`${Date.now()}_${o.thumbnail.name}`,x=j4($4,`projects/${s}/thumbnail/${y}`);await z4(x,o.thumbnail),C=await U4(x)}await l1(v,{title:o.title,description:o.description,programmingLanguages:o.programmingLanguages,visibility:o.visibility,tags:o.tags,thumbnailUrl:C,updatedAt:new Date}),e(`/projects/${s}`)}catch(v){console.error("Error updating project:",v),r("Failed to update project. Please try again.")}finally{i(!1)}}};return n?E.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-950",children:[E.jsx(zn,{}),E.jsx(Un,{}),E.jsx("div",{className:"pl-[var(--sidebar-width)] pt-14 transition-[padding] duration-200",children:E.jsx("div",{className:"max-w-3xl mx-auto p-4 md:p-8",children:E.jsx("div",{className:"text-red-500 dark:text-red-400",children:n})})})]}):E.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-950",children:[E.jsx(zn,{}),E.jsx(Un,{}),E.jsx("div",{className:"pl-[var(--sidebar-width)] pt-14 transition-[padding] duration-200",children:E.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[E.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900 dark:text-white mb-6",children:"Edit Project"}),E.jsxs("form",{onSubmit:p,className:"space-y-6",children:[E.jsxs("div",{className:"space-y-4",children:[E.jsxs("div",{children:[E.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Title"}),E.jsx("input",{type:"text",id:"title",name:"title",required:!0,value:o.title,onChange:d,className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-900 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),E.jsxs("div",{children:[E.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Description"}),E.jsx("textarea",{id:"description",name:"description",required:!0,value:o.description,onChange:d,rows:4,className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-900 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),E.jsxs("div",{children:[E.jsx("label",{htmlFor:"programmingLanguages",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Programming Languages"}),E.jsx("input",{type:"text",id:"programmingLanguages",placeholder:"Press Enter to add",onKeyPress:_=>_.key==="Enter"&&u(_),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-900 shadow-sm focus:border-blue-500 focus:ring-blue-500"}),E.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:o.programmingLanguages.map(_=>E.jsxs("span",{className:"px-2 py-1 text-sm bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 rounded",children:[_,E.jsx("button",{type:"button",onClick:()=>a(v=>({...v,programmingLanguages:v.programmingLanguages.filter(C=>C!==_)})),className:"ml-2 text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200",children:"×"})]},_))})]}),E.jsxs("div",{children:[E.jsx("label",{htmlFor:"visibility",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Visibility"}),E.jsxs("select",{id:"visibility",name:"visibility",value:o.visibility,onChange:d,className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-900 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[E.jsx("option",{value:"public",children:"Public"}),E.jsx("option",{value:"private",children:"Private"})]})]}),E.jsxs("div",{children:[E.jsx("label",{htmlFor:"tags",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Tags"}),E.jsx("input",{type:"text",id:"tags",placeholder:"Press Enter to add",onKeyPress:_=>_.key==="Enter"&&h(_),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-900 shadow-sm focus:border-blue-500 focus:ring-blue-500"}),E.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:o.tags.map(_=>E.jsxs("span",{className:"px-2 py-1 text-sm bg-gray-100 dark:bg-gray-800 text-gray-800 dark:text-gray-200 rounded",children:[_,E.jsx("button",{type:"button",onClick:()=>a(v=>({...v,tags:v.tags.filter(C=>C!==_)})),className:"ml-2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200",children:"×"})]},_))})]}),E.jsxs("div",{children:[E.jsx("label",{htmlFor:"thumbnail",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Thumbnail"}),l&&E.jsx("div",{className:"mt-2 mb-4",children:E.jsx("img",{src:l,alt:"Current thumbnail",className:"w-48 h-48 object-cover rounded-lg"})}),E.jsx("input",{type:"file",id:"thumbnail",accept:"image/*",onChange:g,className:`mt-1 block w-full text-sm text-gray-500 dark:text-gray-400\r
                  file:mr-4 file:py-2 file:px-4\r
                  file:rounded-md file:border-0\r
                  file:text-sm file:font-medium\r
                  file:bg-blue-50 file:text-blue-700\r
                  dark:file:bg-blue-900/50 dark:file:text-blue-200\r
                  hover:file:bg-blue-100 dark:hover:file:bg-blue-900`})]})]}),n&&E.jsx("div",{className:"text-red-500 dark:text-red-400 text-sm",children:n}),E.jsxs("div",{className:"flex justify-end space-x-4",children:[E.jsx("button",{type:"button",onClick:()=>e(`/projects/${s}`),className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-200 bg-gray-100 dark:bg-gray-800 rounded-md hover:bg-gray-200 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:"Cancel"}),E.jsx("button",{type:"submit",disabled:t,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:t?E.jsxs("div",{className:"flex items-center",children:[E.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2"}),"Saving..."]}):"Save Changes"})]})]})]})})]})},XEe=()=>{const[s,e]=ie.useState([]),[t,i]=ie.useState(!0),[n,r]=ie.useState("");return ie.useEffect(()=>{let o=!0;return(async()=>{if(!wt.currentUser){o&&i(!1);return}try{const l=ta(Wi,"projects"),c=Eh(l,og("userId","==",wt.currentUser.uid)),d=await a1(c);if(o){const u=d.docs.map(h=>({projectId:h.id,...h.data()}));e(u),i(!1)}}catch(l){console.error("Error fetching projects:",l),o&&(r("Failed to load projects"),i(!1))}})(),()=>{o=!1}},[]),wt.currentUser?E.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-950",children:[E.jsx(zn,{}),E.jsx(Un,{}),E.jsx("div",{className:"pl-[var(--sidebar-width)] pt-14 transition-[padding] duration-200",children:E.jsxs("div",{className:"max-w-7xl mx-auto p-4 md:p-8",children:[E.jsxs("div",{className:"flex justify-between items-center mb-6",children:[E.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900 dark:text-white",children:"My Projects"}),E.jsx(xl,{to:"/upload",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Create Project"})]}),t?E.jsx("div",{className:"flex items-center justify-center py-12",children:E.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):n?E.jsx("div",{className:"text-center py-8",children:E.jsx("p",{className:"text-red-500 dark:text-red-400",children:n})}):s.length===0?E.jsx("div",{className:"text-center py-8",children:E.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"You haven't created any projects yet"})}):E.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(o=>{var a,l;return E.jsxs(xl,{to:`/projects/${o.projectId}`,className:"group bg-gray-100 dark:bg-gray-900/40 backdrop-blur-xl rounded-xl p-6 border border-gray-200 dark:border-gray-700/30 hover:bg-gray-200 dark:hover:bg-gray-800/50 transition-all duration-200 hover:shadow-lg relative",children:[E.jsx("div",{className:"absolute top-4 right-4",children:E.jsx(xl,{to:`/projects/${o.projectId}/edit`,className:"p-2 bg-gray-200 dark:bg-gray-800 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-700 transition-colors",onClick:c=>c.stopPropagation(),children:E.jsx("svg",{className:"w-5 h-5 text-gray-600 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})})}),E.jsxs("div",{className:"flex flex-col space-y-4",children:[o.thumbnailUrl&&E.jsx("div",{className:"aspect-video w-full rounded-lg overflow-hidden bg-gray-200 dark:bg-gray-800",children:E.jsx("img",{src:o.thumbnailUrl,alt:o.title,className:"w-full h-full object-cover",onError:c=>{const d=c.target;d.src="https://via.placeholder.com/400x225?text=No+Image"}})}),E.jsxs("div",{children:[E.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white group-hover:text-blue-500 transition-colors",children:o.title}),E.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-300 line-clamp-2",children:o.description})]}),E.jsx("div",{className:"flex flex-wrap gap-2",children:((a=o.programmingLanguages)==null?void 0:a.map(c=>E.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-gray-200 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-md",children:c},c)))||null}),E.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 dark:text-gray-400",children:[E.jsxs("div",{className:"flex items-center space-x-2",children:[E.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),E.jsx("span",{children:((l=o.likes)==null?void 0:l.length)||0})]}),E.jsx("span",{children:o.uploadedAt?new Date(o.uploadedAt.seconds*1e3).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Date not available"})]})]})]},o.projectId)})})]})})]}):E.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-950",children:[E.jsx(zn,{}),E.jsx(Un,{}),E.jsx("div",{className:"pl-[var(--sidebar-width)] pt-14 transition-[padding] duration-200",children:E.jsx("div",{className:"max-w-7xl mx-auto p-4 md:p-8",children:E.jsx("div",{className:"text-center py-8",children:E.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Please sign in to view your projects"})})})})]})},ZEe=()=>{const{handle:s}=J1(),[e,t]=ie.useState(null),[i,n]=ie.useState([]),[r,o]=ie.useState(!0),[a,l]=ie.useState("");return ie.useEffect(()=>{(async()=>{if(s)try{const d=ta(Wi,"channels"),u=Eh(d,og("handle","==",s.replace("@",""))),h=await a1(u);if(h.empty){l("Channel not found"),o(!1);return}const g=h.docs[0],p=g.data();t(p);const _=Eh(ta(Wi,"projects"),og("userId","==",g.id),og("visibility","==","public")),C=(await a1(_)).docs.map(y=>({...y.data(),projectId:y.id}));n(C)}catch(d){console.error("Error fetching channel data:",d),l("Failed to load channel data")}finally{o(!1)}})()},[s]),r?E.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-950",children:[E.jsx(zn,{}),E.jsx(Un,{}),E.jsx("div",{className:"pl-[var(--sidebar-width)] pt-14 transition-[padding] duration-200",children:E.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-3.5rem)]",children:E.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})})})]}):a||!e?E.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-950",children:[E.jsx(zn,{}),E.jsx(Un,{}),E.jsx("div",{className:"pl-[var(--sidebar-width)] pt-14 transition-[padding] duration-200",children:E.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-3.5rem)]",children:E.jsx("div",{className:"text-red-500 dark:text-red-400",children:a||"Channel not found"})})})]}):E.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-950",children:[E.jsx(zn,{}),E.jsx(Un,{}),E.jsxs("div",{className:"pl-[var(--sidebar-width)] pt-14 transition-[padding] duration-200",children:[E.jsxs("div",{className:"relative",children:[E.jsx("div",{className:"h-48 bg-gradient-to-r from-blue-500 to-purple-600"}),E.jsx("div",{className:"max-w-6xl mx-auto px-6 pb-6",children:E.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-end gap-6 -mt-16 relative z-10",children:[E.jsx("div",{className:"w-32 h-32 rounded-full overflow-hidden border-4 border-white dark:border-gray-900 bg-white dark:bg-gray-800",children:E.jsx("img",{src:e.logoUrl||"/default-avatar.png",alt:e.name,className:"w-full h-full object-cover"})}),E.jsxs("div",{className:"flex-1",children:[E.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:e.name}),E.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-2",children:["@",e.handle]}),E.jsx("p",{className:"text-gray-700 dark:text-gray-300 max-w-2xl",children:e.description})]})]})})]}),E.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-8",children:[E.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-6",children:"Projects"}),E.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map(c=>E.jsxs("a",{href:`/${c.projectId}`,className:"block bg-gray-100 dark:bg-gray-900/40 backdrop-blur-xl rounded-xl overflow-hidden hover:transform hover:scale-105 transition-all duration-200 border border-gray-200 dark:border-gray-700/30",children:[E.jsx("div",{className:"aspect-video bg-gray-200 dark:bg-gray-800 relative",children:c.thumbnailUrl?E.jsx("img",{src:c.thumbnailUrl,alt:c.title,className:"w-full h-full object-cover"}):E.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:E.jsx("svg",{className:"w-12 h-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})}),E.jsxs("div",{className:"p-4",children:[E.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2 line-clamp-2",children:c.title}),E.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3 line-clamp-2",children:c.description}),E.jsx("div",{className:"flex flex-wrap gap-2",children:c.programmingLanguages.map((d,u)=>E.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-purple-100 dark:bg-purple-900/30 text-purple-800 dark:text-purple-300 rounded-full",children:d},u))})]})]},c.projectId))})]})]})]})},JEe=()=>{const s=l_(),[e,t]=ie.useState(""),[i,n]=ie.useState(""),[r,o]=ie.useState(null),[a,l]=ie.useState(!1),[c,d]=ie.useState(""),[u,h]=ie.useState(""),g=_=>{var C;const v=(C=_.target.files)==null?void 0:C[0];if(v){if(v.size>5*1024*1024){d("Image size should be less than 5MB");return}o(v);const y=URL.createObjectURL(v);h(y)}},p=async _=>{if(_.preventDefault(),!wt.currentUser){d("Please sign in to create a team");return}if(!e.trim()){d("Team name is required");return}l(!0),d("");try{let v="";if(r){const y=j4($4,`team-profiles/${Date.now()}-${r.name}`),x=await z4(y,r);v=await U4(x.ref)}const C={name:e.trim(),bio:i.trim(),profileUrl:v,createdBy:wt.currentUser.uid,createdAt:new Date,members:{[wt.currentUser.uid]:"admin"}};await aq(ta(Wi,"teams"),C),s("/teams")}catch(v){console.error("Error creating team:",v),v instanceof Error&&v.message.includes("permission-denied")?d("You do not have permission to create a team. Please check your account status."):d("Failed to create team. Please try again later.")}finally{l(!1)}};return E.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-950",children:[E.jsx(zn,{}),E.jsx(Un,{}),E.jsx("div",{className:"pl-[var(--sidebar-width)] pt-14 transition-[padding] duration-200",children:E.jsxs("div",{className:"max-w-2xl mx-auto p-4 md:p-8",children:[E.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900 dark:text-white mb-6",children:"Create New Team"}),E.jsxs("form",{onSubmit:p,className:"space-y-6",children:[E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Team Profile"}),E.jsxs("div",{className:"flex items-center space-x-4",children:[E.jsx("div",{className:"w-24 h-24 rounded-full overflow-hidden bg-gray-100 dark:bg-gray-800 flex items-center justify-center",children:u?E.jsx("img",{src:u,alt:"Team profile preview",className:"w-full h-full object-cover"}):E.jsx("svg",{className:"w-12 h-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),E.jsxs("div",{children:[E.jsx("input",{type:"file",accept:"image/*",onChange:g,className:"hidden",id:"team-profile"}),E.jsx("label",{htmlFor:"team-profile",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 cursor-pointer",children:"Upload Image"}),E.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Max file size: 5MB"})]})]})]}),E.jsxs("div",{children:[E.jsx("label",{htmlFor:"team-name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Team Name"}),E.jsx("input",{type:"text",id:"team-name",value:e,onChange:_=>t(_.target.value),className:"block w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter team name",required:!0})]}),E.jsxs("div",{children:[E.jsx("label",{htmlFor:"team-bio",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Team Bio"}),E.jsx("textarea",{id:"team-bio",value:i,onChange:_=>n(_.target.value),rows:4,className:"block w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-blue-500 focus:border-blue-500",placeholder:"Tell us about your team"})]}),c&&E.jsx("div",{className:"text-red-500 dark:text-red-400 text-sm",children:c}),E.jsx("button",{type:"submit",disabled:a,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:a?E.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-white"}):"Create Team"})]})]})})]})},eDe=()=>{const[s,e]=ie.useState([]),[t,i]=ie.useState(!0),[n,r]=ie.useState("");return ie.useEffect(()=>{(async()=>{if(wt.currentUser)try{const a=ta(Wi,"teams"),l=Eh(a,og(`members.${wt.currentUser.uid}`,"!=",null)),d=(await a1(l)).docs.map(u=>{var h;return{id:u.id,...u.data(),createdAt:(h=u.data().createdAt)==null?void 0:h.toDate()}});e(d)}catch(a){console.error("Error fetching teams:",a),r("Failed to load teams")}finally{i(!1)}})()},[]),wt.currentUser?E.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-950",children:[E.jsx(zn,{}),E.jsx(Un,{}),E.jsx("div",{className:"pl-[var(--sidebar-width)] pt-14 transition-[padding] duration-200",children:E.jsxs("div",{className:"max-w-7xl mx-auto p-4 md:p-8",children:[E.jsxs("div",{className:"flex justify-between items-center mb-6",children:[E.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900 dark:text-white",children:"My Teams"}),E.jsx(xl,{to:"/teams/create",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Create Team"})]}),t?E.jsx("div",{className:"flex items-center justify-center py-12",children:E.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):n?E.jsx("div",{className:"text-center py-8",children:E.jsx("p",{className:"text-red-500 dark:text-red-400",children:n})}):s.length===0?E.jsx("div",{className:"text-center py-8",children:E.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"You haven't joined any teams yet"})}):E.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(o=>{var a;return E.jsx(xl,{to:`/teams/${o.id}`,className:"group bg-gray-100 dark:bg-gray-900/40 backdrop-blur-xl rounded-xl p-6 border border-gray-200 dark:border-gray-700/30 hover:bg-gray-200 dark:hover:bg-gray-800/50 transition-all duration-200 hover:shadow-lg",children:E.jsxs("div",{className:"flex flex-col space-y-4",children:[E.jsxs("div",{className:"flex items-center space-x-4",children:[E.jsx("div",{className:"w-16 h-16 rounded-full overflow-hidden bg-gray-200 dark:bg-gray-800 flex-shrink-0 group-hover:ring-2 ring-blue-500 transition-all duration-200",children:o.profileUrl?E.jsx("img",{src:o.profileUrl,alt:o.name,className:"w-full h-full object-cover"}):E.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:E.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})})}),E.jsxs("div",{className:"flex-1 min-w-0",children:[E.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white truncate group-hover:text-blue-500 transition-colors",children:o.name}),E.jsx("div",{className:"flex items-center space-x-2 text-sm text-gray-500 dark:text-gray-400",children:E.jsxs("span",{children:[Object.keys(o.members).length," members"]})})]})]}),E.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 line-clamp-2",children:o.bio}),E.jsxs("div",{className:"text-xs text-gray-400 dark:text-gray-500",children:["Created ",(a=o.createdAt)==null?void 0:a.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})]})]})},o.id)})})]})})]}):E.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-950",children:[E.jsx(zn,{}),E.jsx(Un,{}),E.jsx("div",{className:"pl-[var(--sidebar-width)] pt-14 transition-[padding] duration-200",children:E.jsx("div",{className:"max-w-7xl mx-auto p-4 md:p-8",children:E.jsx("div",{className:"text-center py-8",children:E.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Please sign in to view teams"})})})})]})},tDe=({teamId:s})=>{const[e,t]=ie.useState([]),[i,n]=ie.useState(""),[r,o]=ie.useState(!0),a=ie.useRef(null),l=()=>{var d;(d=a.current)==null||d.scrollIntoView({behavior:"smooth"})};ie.useEffect(()=>{if(!s)return;const d=ta(Wi,"teams",s,"messages"),u=Eh(d,dde("createdAt","desc"),EIe(50)),h=c1(u,g=>{const p=g.docs.map(_=>{var v;return{id:_.id,..._.data(),createdAt:(v=_.data().createdAt)==null?void 0:v.toDate()}});t(p.reverse()),o(!1),l()});return()=>h()},[s]);const c=async d=>{if(d.preventDefault(),!(!wt.currentUser||!i.trim()))try{const u=ta(Wi,"teams",s,"messages");await aq(u,{text:i.trim(),userId:wt.currentUser.uid,userName:wt.currentUser.displayName||"Anonymous",userPhotoURL:wt.currentUser.photoURL||"",createdAt:LL()}),n("")}catch(u){console.error("Error sending message:",u)}};return E.jsxs("div",{className:"flex flex-col h-full bg-[url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIj48cmVjdCB4PSIwIiB5PSIwIiB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJyZ2JhKDIzMywgMjM0LCAyMzcsIDAuMikiPjwvcmVjdD48L3N2Zz4=')] dark:bg-gray-900/40",children:[E.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[r?E.jsx("div",{className:"flex items-center justify-center h-full",children:E.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"})}):e.length===0?E.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 dark:text-gray-400",children:"No messages yet"}):e.map(d=>{var u,h,g,p;return E.jsx("div",{className:`flex ${d.userId===((u=wt.currentUser)==null?void 0:u.uid)?"justify-end":"justify-start"}`,children:E.jsxs("div",{className:`flex items-end space-x-2 max-w-[70%] ${d.userId===((h=wt.currentUser)==null?void 0:h.uid)?"flex-row-reverse space-x-reverse":"flex-row"}`,children:[E.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden flex-shrink-0",children:d.userPhotoURL?E.jsx("img",{src:d.userPhotoURL,alt:d.userName,className:"w-full h-full object-cover"}):E.jsx("div",{className:"w-full h-full bg-gray-300 dark:bg-gray-700 flex items-center justify-center text-gray-500 dark:text-gray-400",children:d.userName.charAt(0).toUpperCase()})}),E.jsxs("div",{className:`rounded-2xl px-4 py-2 ${d.userId===((g=wt.currentUser)==null?void 0:g.uid)?"bg-blue-500 text-white":"bg-white dark:bg-gray-800 text-gray-900 dark:text-white"}`,children:[E.jsx("div",{className:"text-sm",children:d.text}),E.jsx("div",{className:"text-[10px] mt-1 opacity-70",children:(p=d.createdAt)==null?void 0:p.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})},d.id)}),E.jsx("div",{ref:a})]}),E.jsx("form",{onSubmit:c,className:"p-4 bg-white dark:bg-gray-800/80 backdrop-blur-sm border-t border-gray-200 dark:border-gray-700/30",children:E.jsxs("div",{className:"flex items-center space-x-2",children:[E.jsx("input",{type:"text",value:i,onChange:d=>n(d.target.value),placeholder:"Type a message",className:"flex-1 px-4 py-3 rounded-full bg-gray-100 dark:bg-gray-700/50 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-transparent transition-all duration-200"}),E.jsx("button",{type:"submit",disabled:!i.trim(),className:"p-3 bg-blue-500 text-white rounded-full hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:E.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 12h14M12 5l7 7-7 7"})})})]})})]})},iDe=({members:s,isOpen:e,onClose:t,teamId:i})=>{const[n,r]=ie.useState(!1),[o,a]=ie.useState("");if(!e)return null;const l=()=>{const d=`${window.location.origin}/teams/join/${i}`;a(d),r(!0)},c=async()=>{try{await navigator.clipboard.writeText(o)}catch(d){console.error("Failed to copy link:",d)}};return E.jsxs("div",{className:"w-80 h-full bg-white dark:bg-gray-900/90 backdrop-blur-xl border-l border-gray-200 dark:border-gray-700/30 shadow-xl flex flex-col",children:[E.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700/30",children:[E.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Team Members"}),E.jsxs("div",{className:"flex items-center space-x-2",children:[E.jsx("button",{onClick:l,className:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors",title:"Invite Members",children:E.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),E.jsx("button",{onClick:t,className:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors",children:E.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),E.jsx("div",{className:"flex-1 overflow-y-auto",children:E.jsx("div",{className:"p-4 space-y-4",children:s.map(d=>E.jsxs("div",{className:"flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800/50 transition-colors",children:[E.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden bg-gray-200 dark:bg-gray-700 flex-shrink-0",children:d.photoURL?E.jsx("img",{src:d.photoURL,alt:d.name,className:"w-full h-full object-cover"}):E.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:d.name.charAt(0).toUpperCase()})}),E.jsxs("div",{className:"flex-1 min-w-0",children:[E.jsx("div",{className:"font-medium text-gray-900 dark:text-white truncate",children:d.name}),E.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 capitalize",children:d.role})]}),d.lastActive&&E.jsx("div",{className:"text-xs text-gray-400 dark:text-gray-500",children:d.lastActive.toLocaleDateString()})]},d.id))})}),n&&E.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:E.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4",children:[E.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Invite Team Members"}),E.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[E.jsx("input",{type:"text",readOnly:!0,value:o,className:"flex-1 p-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white"}),E.jsx("button",{onClick:c,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Copy"})]}),E.jsx("button",{onClick:()=>r(!1),className:"w-full px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-900 dark:text-white rounded-md hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",children:"Close"})]})})]})},nDe=()=>{const{teamId:s}=J1(),e=l_(),[t,i]=ie.useState(null),[n,r]=ie.useState([]),[o,a]=ie.useState(!0),[l,c]=ie.useState(""),[d,u]=ie.useState(!1);return ie.useEffect(()=>{(async()=>{var g;if(!s||!wt.currentUser){c("Please sign in to view team details"),a(!1);return}try{const p=await Dh(Cs(Wi,"teams",s));if(!p.exists()){c("Team not found. Please check the team ID and try again."),a(!1);return}const _=p.data();if(!_||!_.name||!_.members){c("Invalid team data structure"),a(!1);return}if(!_.members[wt.currentUser.uid]){c("You do not have permission to view this team"),a(!1);return}const v={id:p.id,..._,createdAt:((g=_.createdAt)==null?void 0:g.toDate())||new Date};i(v);const C=ta(Wi,"profiles"),y=Object.keys(v.members);if(y.length===0){r([]),a(!1);return}const x=Eh(C,og("uid","in",y)),I=(await a1(x)).docs.map(A=>{var D;return{id:A.id,name:A.data().displayName||"Anonymous",photoURL:A.data().photoURL||"",role:v.members[A.id]||"member",lastActive:(D=A.data().lastActive)==null?void 0:D.toDate()}});r(I)}catch(p){console.error("Error fetching team data:",p),c(p.message||"Failed to load team data. Please try again later.")}finally{a(!1)}})()},[s]),wt.currentUser?o?E.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-950",children:[E.jsx(zn,{}),E.jsx(Un,{}),E.jsx("div",{className:"pl-[var(--sidebar-width)] pt-14 transition-[padding] duration-200",children:E.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-3.5rem)]",children:E.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})})})]}):l||!t?E.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-950",children:[E.jsx(zn,{}),E.jsx(Un,{}),E.jsx("div",{className:"pl-[var(--sidebar-width)] pt-14 transition-[padding] duration-200",children:E.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-3.5rem)]",children:E.jsx("div",{className:"text-red-500 dark:text-red-400",children:l||"Team not found"})})})]}):E.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-950",children:[E.jsx(zn,{}),E.jsx(Un,{}),E.jsx("div",{className:"pl-[var(--sidebar-width)] pt-14 transition-[padding] duration-200",children:E.jsxs("div",{className:"h-[calc(100vh-3.5rem)] flex flex-col",children:[E.jsxs("div",{className:"bg-gray-100 dark:bg-gray-900/40 backdrop-blur-xl border-b border-gray-200 dark:border-gray-700/30 p-4 flex items-center space-x-4 cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-800/50 transition-colors",onClick:()=>u(!d),children:[E.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden bg-gray-200 dark:bg-gray-800 flex-shrink-0",children:t.profileUrl?E.jsx("img",{src:t.profileUrl,alt:t.name,className:"w-full h-full object-cover"}):E.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:E.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})})}),E.jsxs("div",{className:"flex-1 min-w-0",children:[E.jsx("h1",{className:"text-xl font-semibold text-gray-900 dark:text-white truncate",children:t.name}),E.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 truncate",children:[Object.keys(t.members).length," members"]})]}),E.jsx("button",{className:"p-2 rounded-full hover:bg-gray-300 dark:hover:bg-gray-700 transition-colors",onClick:h=>{h.stopPropagation(),e(`/teams/${t.id}/meet`)},children:E.jsx("svg",{className:"w-6 h-6 text-gray-600 dark:text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),E.jsx("button",{className:"p-2 rounded-full hover:bg-gray-300 dark:hover:bg-gray-700 transition-colors",onClick:h=>{h.stopPropagation(),e(`/teams/${t.id}/editor`)},children:E.jsx("svg",{className:"w-6 h-6 text-gray-600 dark:text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 4a2 2 0 114 0v1a1 1 0 001 1h3a1 1 0 011 1v3a1 1 0 01-1 1h-1a2 2 0 100 4h1a1 1 0 011 1v3a1 1 0 01-1 1h-3a1 1 0 01-1-1v-1a2 2 0 10-4 0v1a1 1 0 01-1 1H7a1 1 0 01-1-1v-3a1 1 0 00-1-1H4a2 2 0 110-4h1a1 1 0 001-1V7a1 1 0 011-1h3a1 1 0 001-1V4z"})})})]}),E.jsxs("div",{className:"flex-1 overflow-hidden bg-gray-50 dark:bg-gray-900/20 flex",children:[E.jsx("div",{className:"flex-1",children:E.jsx(tDe,{teamId:t.id})}),E.jsx(iDe,{members:n,isOpen:d,onClose:()=>u(!1),teamId:t.id})]})]})})]}):E.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-950",children:[E.jsx(zn,{}),E.jsx(Un,{}),E.jsx("div",{className:"pl-[var(--sidebar-width)] pt-14 transition-[padding] duration-200",children:E.jsx("div",{className:"max-w-7xl mx-auto p-4 md:p-8",children:E.jsx("div",{className:"text-center py-8",children:E.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Please sign in to view team details"})})})})]})},sDe=()=>{const{teamId:s}=J1(),e=wt.currentUser;return ie.useEffect(()=>{if(!e||!s)return;const t="meet.jit.si",i={roomName:`syncodex-team-${s}`,width:"100%",height:"100%",parentNode:document.querySelector("#meet"),userInfo:{displayName:e.displayName||"Team Member",email:e.email||""},configOverwrite:{prejoinPageEnabled:!1,startWithAudioMuted:!0,startWithVideoMuted:!1},interfaceConfigOverwrite:{TOOLBAR_BUTTONS:["microphone","camera","closedcaptions","desktop","fullscreen","fodeviceselection","hangup","profile","chat","recording","livestreaming","etherpad","sharedvideo","settings","raisehand","videoquality","filmstrip","invite","feedback","stats","shortcuts","tileview","select-background","download","help","mute-everyone","security"]}},n=()=>{const o=document.createElement("script");o.src="https://meet.jit.si/external_api.js",o.async=!0,o.onload=()=>r(),document.body.appendChild(o)},r=()=>{new window.JitsiMeetExternalAPI(t,i)};return typeof window.JitsiMeetExternalAPI>"u"?n():r(),()=>{const o=document.querySelector('script[src="https://meet.jit.si/external_api.js"]');o&&document.body.removeChild(o)}},[s,e]),e?E.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-950",children:[E.jsx(zn,{}),E.jsx(Un,{}),E.jsx("div",{className:"pl-[var(--sidebar-width)] pt-14 transition-[padding] duration-200",children:E.jsx("div",{id:"meet",className:"w-full h-[calc(100vh-3.5rem)]"})})]}):E.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-950",children:[E.jsx(zn,{}),E.jsx(Un,{}),E.jsx("div",{className:"pl-[var(--sidebar-width)] pt-14 transition-[padding] duration-200",children:E.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-3.5rem)]",children:E.jsx("div",{className:"text-red-500 dark:text-red-400",children:"Please sign in to join the meeting"})})})]})},rDe=()=>{const[s,e]=ie.useState(null),[t,i]=ie.useState(!0);return ie.useEffect(()=>{const n=Mle(),r=Sle(n,o=>{e(o),i(!1)});return()=>r()},[]),{user:s,loading:t}};function oDe(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function _ee(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(s,n).enumerable})),t.push.apply(t,i)}return t}function bee(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?_ee(Object(t),!0).forEach(function(i){oDe(s,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):_ee(Object(t)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(t,i))})}return s}function aDe(s,e){if(s==null)return{};var t={},i=Object.keys(s),n,r;for(r=0;r<i.length;r++)n=i[r],!(e.indexOf(n)>=0)&&(t[n]=s[n]);return t}function lDe(s,e){if(s==null)return{};var t=aDe(s,e),i,n;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(s);for(n=0;n<r.length;n++)i=r[n],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(s,i)&&(t[i]=s[i])}return t}function cDe(s,e){return dDe(s)||uDe(s,e)||hDe(s,e)||fDe()}function dDe(s){if(Array.isArray(s))return s}function uDe(s,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(s)))){var t=[],i=!0,n=!1,r=void 0;try{for(var o=s[Symbol.iterator](),a;!(i=(a=o.next()).done)&&(t.push(a.value),!(e&&t.length===e));i=!0);}catch(l){n=!0,r=l}finally{try{!i&&o.return!=null&&o.return()}finally{if(n)throw r}}return t}}function hDe(s,e){if(s){if(typeof s=="string")return vee(s,e);var t=Object.prototype.toString.call(s).slice(8,-1);if(t==="Object"&&s.constructor&&(t=s.constructor.name),t==="Map"||t==="Set")return Array.from(s);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return vee(s,e)}}function vee(s,e){(e==null||e>s.length)&&(e=s.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=s[t];return i}function fDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gDe(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function wee(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(s,n).enumerable})),t.push.apply(t,i)}return t}function Cee(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?wee(Object(t),!0).forEach(function(i){gDe(s,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):wee(Object(t)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(t,i))})}return s}function pDe(){for(var s=arguments.length,e=new Array(s),t=0;t<s;t++)e[t]=arguments[t];return function(i){return e.reduceRight(function(n,r){return r(n)},i)}}function Yx(s){return function e(){for(var t=this,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return n.length>=s.length?s.apply(this,n):function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return e.apply(t,[].concat(n,a))}}}function L2(s){return{}.toString.call(s).includes("Object")}function mDe(s){return!Object.keys(s).length}function jk(s){return typeof s=="function"}function _De(s,e){return Object.prototype.hasOwnProperty.call(s,e)}function bDe(s,e){return L2(e)||om("changeType"),Object.keys(e).some(function(t){return!_De(s,t)})&&om("changeField"),e}function vDe(s){jk(s)||om("selectorType")}function wDe(s){jk(s)||L2(s)||om("handlerType"),L2(s)&&Object.values(s).some(function(e){return!jk(e)})&&om("handlersType")}function CDe(s){s||om("initialIsRequired"),L2(s)||om("initialType"),mDe(s)&&om("initialContent")}function yDe(s,e){throw new Error(s[e]||s.default)}var SDe={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},om=Yx(yDe)(SDe),$T={changes:bDe,selector:vDe,handler:wDe,initial:CDe};function xDe(s){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};$T.initial(s),$T.handler(e);var t={current:s},i=Yx(IDe)(t,e),n=Yx(kDe)(t),r=Yx($T.changes)(s),o=Yx(LDe)(t);function a(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(d){return d};return $T.selector(c),c(t.current)}function l(c){pDe(i,n,r,o)(c)}return[a,l]}function LDe(s,e){return jk(e)?e(s.current):e}function kDe(s,e){return s.current=Cee(Cee({},s.current),e),e}function IDe(s,e,t){return jk(e)?e(s.current):Object.keys(t).forEach(function(i){var n;return(n=e[i])===null||n===void 0?void 0:n.call(e,s.current[i])}),t}var EDe={create:xDe},DDe={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.52.2/min/vs"}};function TDe(s){return function e(){for(var t=this,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return n.length>=s.length?s.apply(this,n):function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return e.apply(t,[].concat(n,a))}}}function NDe(s){return{}.toString.call(s).includes("Object")}function RDe(s){return s||yee("configIsRequired"),NDe(s)||yee("configType"),s.urls?(ADe(),{paths:{vs:s.urls.monacoBase}}):s}function ADe(){console.warn(Mde.deprecation)}function PDe(s,e){throw new Error(s[e]||s.default)}var Mde={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},yee=TDe(PDe)(Mde),MDe={config:RDe},ODe=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(n){return t.reduceRight(function(r,o){return o(r)},n)}};function Ode(s,e){return Object.keys(e).forEach(function(t){e[t]instanceof Object&&s[t]&&Object.assign(e[t],Ode(s[t],e[t]))}),bee(bee({},s),e)}var FDe={type:"cancelation",msg:"operation is manually canceled"};function k9(s){var e=!1,t=new Promise(function(i,n){s.then(function(r){return e?n(FDe):i(r)}),s.catch(n)});return t.cancel=function(){return e=!0},t}var VDe=EDe.create({config:DDe,isInitialized:!1,resolve:null,reject:null,monaco:null}),Fde=cDe(VDe,2),FE=Fde[0],q4=Fde[1];function BDe(s){var e=MDe.config(s),t=e.monaco,i=lDe(e,["monaco"]);q4(function(n){return{config:Ode(n.config,i),monaco:t}})}function WDe(){var s=FE(function(e){var t=e.monaco,i=e.isInitialized,n=e.resolve;return{monaco:t,isInitialized:i,resolve:n}});if(!s.isInitialized){if(q4({isInitialized:!0}),s.monaco)return s.resolve(s.monaco),k9(I9);if(window.monaco&&window.monaco.editor)return Vde(window.monaco),s.resolve(window.monaco),k9(I9);ODe(HDe,UDe)(jDe)}return k9(I9)}function HDe(s){return document.body.appendChild(s)}function zDe(s){var e=document.createElement("script");return s&&(e.src=s),e}function UDe(s){var e=FE(function(i){var n=i.config,r=i.reject;return{config:n,reject:r}}),t=zDe("".concat(e.config.paths.vs,"/loader.js"));return t.onload=function(){return s()},t.onerror=e.reject,t}function jDe(){var s=FE(function(t){var i=t.config,n=t.resolve,r=t.reject;return{config:i,resolve:n,reject:r}}),e=window.require;e.config(s.config),e(["vs/editor/editor.main"],function(t){Vde(t),s.resolve(t)},function(t){s.reject(t)})}function Vde(s){FE().monaco||q4({monaco:s})}function $De(){return FE(function(s){var e=s.monaco;return e})}var I9=new Promise(function(s,e){return q4({resolve:s,reject:e})}),Bde={config:BDe,init:WDe,__getMonacoInstance:$De},qDe={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},E9=qDe,KDe={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},GDe=KDe;function QDe({children:s}){return ly.createElement("div",{style:GDe.container},s)}var YDe=QDe,XDe=YDe;function ZDe({width:s,height:e,isEditorReady:t,loading:i,_ref:n,className:r,wrapperProps:o}){return ly.createElement("section",{style:{...E9.wrapper,width:s,height:e},...o},!t&&ly.createElement(XDe,null,i),ly.createElement("div",{ref:n,style:{...E9.fullWidth,...!t&&E9.hide},className:r}))}var JDe=ZDe,Wde=ie.memo(JDe);function eTe(s){ie.useEffect(s,[])}var Hde=eTe;function tTe(s,e,t=!0){let i=ie.useRef(!0);ie.useEffect(i.current||!t?()=>{i.current=!1}:s,e)}var nc=tTe;function IL(){}function wC(s,e,t,i){return iTe(s,i)||nTe(s,e,t,i)}function iTe(s,e){return s.editor.getModel(zde(s,e))}function nTe(s,e,t,i){return s.editor.createModel(e,t,i?zde(s,i):void 0)}function zde(s,e){return s.Uri.parse(e)}function sTe({original:s,modified:e,language:t,originalLanguage:i,modifiedLanguage:n,originalModelPath:r,modifiedModelPath:o,keepCurrentOriginalModel:a=!1,keepCurrentModifiedModel:l=!1,theme:c="light",loading:d="Loading...",options:u={},height:h="100%",width:g="100%",className:p,wrapperProps:_={},beforeMount:v=IL,onMount:C=IL}){let[y,x]=ie.useState(!1),[L,I]=ie.useState(!0),A=ie.useRef(null),D=ie.useRef(null),N=ie.useRef(null),R=ie.useRef(C),W=ie.useRef(v),H=ie.useRef(!1);Hde(()=>{let re=Bde.init();return re.then(pe=>(D.current=pe)&&I(!1)).catch(pe=>(pe==null?void 0:pe.type)!=="cancelation"&&console.error("Monaco initialization: error:",pe)),()=>A.current?ee():re.cancel()}),nc(()=>{if(A.current&&D.current){let re=A.current.getOriginalEditor(),pe=wC(D.current,s||"",i||t||"text",r||"");pe!==re.getModel()&&re.setModel(pe)}},[r],y),nc(()=>{if(A.current&&D.current){let re=A.current.getModifiedEditor(),pe=wC(D.current,e||"",n||t||"text",o||"");pe!==re.getModel()&&re.setModel(pe)}},[o],y),nc(()=>{let re=A.current.getModifiedEditor();re.getOption(D.current.editor.EditorOption.readOnly)?re.setValue(e||""):e!==re.getValue()&&(re.executeEdits("",[{range:re.getModel().getFullModelRange(),text:e||"",forceMoveMarkers:!0}]),re.pushUndoStop())},[e],y),nc(()=>{var re,pe;(pe=(re=A.current)==null?void 0:re.getModel())==null||pe.original.setValue(s||"")},[s],y),nc(()=>{let{original:re,modified:pe}=A.current.getModel();D.current.editor.setModelLanguage(re,i||t||"text"),D.current.editor.setModelLanguage(pe,n||t||"text")},[t,i,n],y),nc(()=>{var re;(re=D.current)==null||re.editor.setTheme(c)},[c],y),nc(()=>{var re;(re=A.current)==null||re.updateOptions(u)},[u],y);let U=ie.useCallback(()=>{var Ie;if(!D.current)return;W.current(D.current);let re=wC(D.current,s||"",i||t||"text",r||""),pe=wC(D.current,e||"",n||t||"text",o||"");(Ie=A.current)==null||Ie.setModel({original:re,modified:pe})},[t,e,n,s,i,r,o]),B=ie.useCallback(()=>{var re;!H.current&&N.current&&(A.current=D.current.editor.createDiffEditor(N.current,{automaticLayout:!0,...u}),U(),(re=D.current)==null||re.editor.setTheme(c),x(!0),H.current=!0)},[u,c,U]);ie.useEffect(()=>{y&&R.current(A.current,D.current)},[y]),ie.useEffect(()=>{!L&&!y&&B()},[L,y,B]);function ee(){var pe,Ie,ge,_e;let re=(pe=A.current)==null?void 0:pe.getModel();a||((Ie=re==null?void 0:re.original)==null||Ie.dispose()),l||((ge=re==null?void 0:re.modified)==null||ge.dispose()),(_e=A.current)==null||_e.dispose()}return ly.createElement(Wde,{width:g,height:h,isEditorReady:y,loading:d,_ref:N,className:p,wrapperProps:_})}var rTe=sTe;ie.memo(rTe);function oTe(s){let e=ie.useRef();return ie.useEffect(()=>{e.current=s},[s]),e.current}var aTe=oTe,qT=new Map;function lTe({defaultValue:s,defaultLanguage:e,defaultPath:t,value:i,language:n,path:r,theme:o="light",line:a,loading:l="Loading...",options:c={},overrideServices:d={},saveViewState:u=!0,keepCurrentModel:h=!1,width:g="100%",height:p="100%",className:_,wrapperProps:v={},beforeMount:C=IL,onMount:y=IL,onChange:x,onValidate:L=IL}){let[I,A]=ie.useState(!1),[D,N]=ie.useState(!0),R=ie.useRef(null),W=ie.useRef(null),H=ie.useRef(null),U=ie.useRef(y),B=ie.useRef(C),ee=ie.useRef(),re=ie.useRef(i),pe=aTe(r),Ie=ie.useRef(!1),ge=ie.useRef(!1);Hde(()=>{let J=Bde.init();return J.then(we=>(R.current=we)&&N(!1)).catch(we=>(we==null?void 0:we.type)!=="cancelation"&&console.error("Monaco initialization: error:",we)),()=>W.current?Re():J.cancel()}),nc(()=>{var we,Ae,ot,tt;let J=wC(R.current,s||i||"",e||n||"",r||t||"");J!==((we=W.current)==null?void 0:we.getModel())&&(u&&qT.set(pe,(Ae=W.current)==null?void 0:Ae.saveViewState()),(ot=W.current)==null||ot.setModel(J),u&&((tt=W.current)==null||tt.restoreViewState(qT.get(r))))},[r],I),nc(()=>{var J;(J=W.current)==null||J.updateOptions(c)},[c],I),nc(()=>{!W.current||i===void 0||(W.current.getOption(R.current.editor.EditorOption.readOnly)?W.current.setValue(i):i!==W.current.getValue()&&(ge.current=!0,W.current.executeEdits("",[{range:W.current.getModel().getFullModelRange(),text:i,forceMoveMarkers:!0}]),W.current.pushUndoStop(),ge.current=!1))},[i],I),nc(()=>{var we,Ae;let J=(we=W.current)==null?void 0:we.getModel();J&&n&&((Ae=R.current)==null||Ae.editor.setModelLanguage(J,n))},[n],I),nc(()=>{var J;a!==void 0&&((J=W.current)==null||J.revealLine(a))},[a],I),nc(()=>{var J;(J=R.current)==null||J.editor.setTheme(o)},[o],I);let _e=ie.useCallback(()=>{var J;if(!(!H.current||!R.current)&&!Ie.current){B.current(R.current);let we=r||t,Ae=wC(R.current,i||s||"",e||n||"",we||"");W.current=(J=R.current)==null?void 0:J.editor.create(H.current,{model:Ae,automaticLayout:!0,...c},d),u&&W.current.restoreViewState(qT.get(we)),R.current.editor.setTheme(o),a!==void 0&&W.current.revealLine(a),A(!0),Ie.current=!0}},[s,e,t,i,n,r,c,d,u,o,a]);ie.useEffect(()=>{I&&U.current(W.current,R.current)},[I]),ie.useEffect(()=>{!D&&!I&&_e()},[D,I,_e]),re.current=i,ie.useEffect(()=>{var J,we;I&&x&&((J=ee.current)==null||J.dispose(),ee.current=(we=W.current)==null?void 0:we.onDidChangeModelContent(Ae=>{ge.current||x(W.current.getValue(),Ae)}))},[I,x]),ie.useEffect(()=>{if(I){let J=R.current.editor.onDidChangeMarkers(we=>{var ot;let Ae=(ot=W.current.getModel())==null?void 0:ot.uri;if(Ae&&we.find(tt=>tt.path===Ae.path)){let tt=R.current.editor.getModelMarkers({resource:Ae});L==null||L(tt)}});return()=>{J==null||J.dispose()}}return()=>{}},[I,L]);function Re(){var J,we;(J=ee.current)==null||J.dispose(),h?u&&qT.set(r,W.current.saveViewState()):(we=W.current.getModel())==null||we.dispose(),W.current.dispose()}return ly.createElement(Wde,{width:g,height:p,isEditorReady:I,loading:l,_ref:H,className:_,wrapperProps:v})}var cTe=lTe,dTe=ie.memo(cTe),uTe=dTe;const hTe=()=>{const[s,e]=ie.useState(()=>document.documentElement.classList.contains("dark"));return ie.useEffect(()=>{const t=new MutationObserver(i=>{i.forEach(n=>{n.attributeName==="class"&&e(document.documentElement.classList.contains("dark"))})});return t.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),()=>t.disconnect()},[]),{isDarkMode:s}};var D9,See;function Ude(){if(See)return D9;See=1;function s(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}return D9=s,D9}var T9,xee;function fTe(){if(xee)return T9;xee=1;var s=typeof PT=="object"&&PT&&PT.Object===Object&&PT;return T9=s,T9}var N9,Lee;function jde(){if(Lee)return N9;Lee=1;var s=fTe(),e=typeof self=="object"&&self&&self.Object===Object&&self,t=s||e||Function("return this")();return N9=t,N9}var R9,kee;function gTe(){if(kee)return R9;kee=1;var s=jde(),e=function(){return s.Date.now()};return R9=e,R9}var A9,Iee;function pTe(){if(Iee)return A9;Iee=1;var s=/\s/;function e(t){for(var i=t.length;i--&&s.test(t.charAt(i)););return i}return A9=e,A9}var P9,Eee;function mTe(){if(Eee)return P9;Eee=1;var s=pTe(),e=/^\s+/;function t(i){return i&&i.slice(0,s(i)+1).replace(e,"")}return P9=t,P9}var M9,Dee;function $de(){if(Dee)return M9;Dee=1;var s=jde(),e=s.Symbol;return M9=e,M9}var O9,Tee;function _Te(){if(Tee)return O9;Tee=1;var s=$de(),e=Object.prototype,t=e.hasOwnProperty,i=e.toString,n=s?s.toStringTag:void 0;function r(o){var a=t.call(o,n),l=o[n];try{o[n]=void 0;var c=!0}catch{}var d=i.call(o);return c&&(a?o[n]=l:delete o[n]),d}return O9=r,O9}var F9,Nee;function bTe(){if(Nee)return F9;Nee=1;var s=Object.prototype,e=s.toString;function t(i){return e.call(i)}return F9=t,F9}var V9,Ree;function vTe(){if(Ree)return V9;Ree=1;var s=$de(),e=_Te(),t=bTe(),i="[object Null]",n="[object Undefined]",r=s?s.toStringTag:void 0;function o(a){return a==null?a===void 0?n:i:r&&r in Object(a)?e(a):t(a)}return V9=o,V9}var B9,Aee;function wTe(){if(Aee)return B9;Aee=1;function s(e){return e!=null&&typeof e=="object"}return B9=s,B9}var W9,Pee;function CTe(){if(Pee)return W9;Pee=1;var s=vTe(),e=wTe(),t="[object Symbol]";function i(n){return typeof n=="symbol"||e(n)&&s(n)==t}return W9=i,W9}var H9,Mee;function yTe(){if(Mee)return H9;Mee=1;var s=mTe(),e=Ude(),t=CTe(),i=NaN,n=/^[-+]0x[0-9a-f]+$/i,r=/^0b[01]+$/i,o=/^0o[0-7]+$/i,a=parseInt;function l(c){if(typeof c=="number")return c;if(t(c))return i;if(e(c)){var d=typeof c.valueOf=="function"?c.valueOf():c;c=e(d)?d+"":d}if(typeof c!="string")return c===0?c:+c;c=s(c);var u=r.test(c);return u||o.test(c)?a(c.slice(2),u?2:8):n.test(c)?i:+c}return H9=l,H9}var z9,Oee;function STe(){if(Oee)return z9;Oee=1;var s=Ude(),e=gTe(),t=yTe(),i="Expected a function",n=Math.max,r=Math.min;function o(a,l,c){var d,u,h,g,p,_,v=0,C=!1,y=!1,x=!0;if(typeof a!="function")throw new TypeError(i);l=t(l)||0,s(c)&&(C=!!c.leading,y="maxWait"in c,h=y?n(t(c.maxWait)||0,l):h,x="trailing"in c?!!c.trailing:x);function L(B){var ee=d,re=u;return d=u=void 0,v=B,g=a.apply(re,ee),g}function I(B){return v=B,p=setTimeout(N,l),C?L(B):g}function A(B){var ee=B-_,re=B-v,pe=l-ee;return y?r(pe,h-re):pe}function D(B){var ee=B-_,re=B-v;return _===void 0||ee>=l||ee<0||y&&re>=h}function N(){var B=e();if(D(B))return R(B);p=setTimeout(N,A(B))}function R(B){return p=void 0,x&&d?L(B):(d=u=void 0,g)}function W(){p!==void 0&&clearTimeout(p),v=0,d=_=u=p=void 0}function H(){return p===void 0?g:R(e())}function U(){var B=e(),ee=D(B);if(d=arguments,u=this,_=B,ee){if(p===void 0)return I(_);if(y)return clearTimeout(p),p=setTimeout(N,l),L(_)}return p===void 0&&(p=setTimeout(N,l)),g}return U.cancel=W,U.flush=H,U}return z9=o,z9}var xTe=STe();const Fee=Cae(xTe);function Zl(s,e=0){return s[s.length-(1+e)]}function LTe(s){if(s.length===0)throw new Error("Invalid tail call");return[s.slice(0,s.length-1),s[s.length-1]]}function dn(s,e,t=(i,n)=>i===n){if(s===e)return!0;if(!s||!e||s.length!==e.length)return!1;for(let i=0,n=s.length;i<n;i++)if(!t(s[i],e[i]))return!1;return!0}function kTe(s,e){const t=s.length-1;e<t&&(s[e]=s[t]),s.pop()}function $k(s,e,t){return ITe(s.length,i=>t(s[i],e))}function ITe(s,e){let t=0,i=s-1;for(;t<=i;){const n=(t+i)/2|0,r=e(n);if(r<0)t=n+1;else if(r>0)i=n-1;else return n}return-(t+1)}function T7(s,e,t){if(s=s|0,s>=e.length)throw new TypeError("invalid index");const i=e[Math.floor(e.length*Math.random())],n=[],r=[],o=[];for(const a of e){const l=t(a,i);l<0?n.push(a):l>0?r.push(a):o.push(a)}return s<n.length?T7(s,n,t):s<n.length+o.length?o[0]:T7(s-(n.length+o.length),r,t)}function Vee(s,e){const t=[];let i;for(const n of s.slice(0).sort(e))!i||e(i[0],n)!==0?(i=[n],t.push(i)):i.push(n);return t}function*gq(s,e){let t,i;for(const n of s)i!==void 0&&e(i,n)?t.push(n):(t&&(yield t),t=[n]),i=n;t&&(yield t)}function qde(s,e){for(let t=0;t<=s.length;t++)e(t===0?void 0:s[t-1],t===s.length?void 0:s[t])}function ETe(s,e){for(let t=0;t<s.length;t++)e(t===0?void 0:s[t-1],s[t],t+1===s.length?void 0:s[t+1])}function rd(s){return s.filter(e=>!!e)}function Bee(s){let e=0;for(let t=0;t<s.length;t++)s[t]&&(s[e]=s[t],e+=1);s.length=e}function Kde(s){return!Array.isArray(s)||s.length===0}function Xr(s){return Array.isArray(s)&&s.length>0}function wg(s,e=t=>t){const t=new Set;return s.filter(i=>{const n=e(i);return t.has(n)?!1:(t.add(n),!0)})}function pq(s,e){return s.length>0?s[0]:e}function Uo(s,e){let t=typeof e=="number"?s:0;typeof e=="number"?t=s:(t=0,e=s);const i=[];if(t<=e)for(let n=t;n<e;n++)i.push(n);else for(let n=t;n>e;n--)i.push(n);return i}function K4(s,e,t){const i=s.slice(0,e),n=s.slice(e);return i.concat(t,n)}function U9(s,e){const t=s.indexOf(e);t>-1&&(s.splice(t,1),s.unshift(e))}function KT(s,e){const t=s.indexOf(e);t>-1&&(s.splice(t,1),s.push(e))}function N7(s,e){for(const t of e)s.push(t)}function mq(s){return Array.isArray(s)?s:[s]}function DTe(s,e,t){const i=Gde(s,e),n=s.length,r=t.length;s.length=n+r;for(let o=n-1;o>=i;o--)s[o+r]=s[o];for(let o=0;o<r;o++)s[o+i]=t[o]}function Wee(s,e,t,i){const n=Gde(s,e);let r=s.splice(n,t);return r===void 0&&(r=[]),DTe(s,n,i),r}function Gde(s,e){return e<0?Math.max(e+s.length,0):Math.min(e,s.length)}var qk;(function(s){function e(r){return r<0}s.isLessThan=e;function t(r){return r<=0}s.isLessThanOrEqual=t;function i(r){return r>0}s.isGreaterThan=i;function n(r){return r===0}s.isNeitherLessOrGreaterThan=n,s.greaterThan=1,s.lessThan=-1,s.neitherLessOrGreaterThan=0})(qk||(qk={}));function Co(s,e){return(t,i)=>e(s(t),s(i))}function TTe(...s){return(e,t)=>{for(const i of s){const n=i(e,t);if(!qk.isNeitherLessOrGreaterThan(n))return n}return qk.neitherLessOrGreaterThan}}const td=(s,e)=>s-e,NTe=(s,e)=>td(s?1:0,e?1:0);function Qde(s){return(e,t)=>-s(e,t)}class Cg{constructor(e){this.items=e,this.firstIdx=0,this.lastIdx=this.items.length-1}get length(){return this.lastIdx-this.firstIdx+1}takeWhile(e){let t=this.firstIdx;for(;t<this.items.length&&e(this.items[t]);)t++;const i=t===this.firstIdx?null:this.items.slice(this.firstIdx,t);return this.firstIdx=t,i}takeFromEndWhile(e){let t=this.lastIdx;for(;t>=0&&e(this.items[t]);)t--;const i=t===this.lastIdx?null:this.items.slice(t+1,this.lastIdx+1);return this.lastIdx=t,i}peek(){if(this.length!==0)return this.items[this.firstIdx]}dequeue(){const e=this.items[this.firstIdx];return this.firstIdx++,e}takeCount(e){const t=this.items.slice(this.firstIdx,this.firstIdx+e);return this.firstIdx+=e,t}}const qC=class qC{constructor(e){this.iterate=e}toArray(){const e=[];return this.iterate(t=>(e.push(t),!0)),e}filter(e){return new qC(t=>this.iterate(i=>e(i)?t(i):!0))}map(e){return new qC(t=>this.iterate(i=>t(e(i))))}findLast(e){let t;return this.iterate(i=>(e(i)&&(t=i),!0)),t}findLastMaxBy(e){let t,i=!0;return this.iterate(n=>((i||qk.isGreaterThan(e(n,t)))&&(i=!1,t=n),!0)),t}};qC.empty=new qC(e=>{});let Kb=qC;class k2{constructor(e){this._indexMap=e}static createSortPermutation(e,t){const i=Array.from(e.keys()).sort((n,r)=>t(e[n],e[r]));return new k2(i)}apply(e){return e.map((t,i)=>e[this._indexMap[i]])}inverse(){const e=this._indexMap.slice();for(let t=0;t<this._indexMap.length;t++)e[this._indexMap[t]]=t;return new k2(e)}}function Zo(s){return typeof s=="string"}function Ms(s){return typeof s=="object"&&s!==null&&!Array.isArray(s)&&!(s instanceof RegExp)&&!(s instanceof Date)}function RTe(s){const e=Object.getPrototypeOf(Uint8Array);return typeof s=="object"&&s instanceof e}function Vm(s){return typeof s=="number"&&!isNaN(s)}function Hee(s){return!!s&&typeof s[Symbol.iterator]=="function"}function Yde(s){return s===!0||s===!1}function Yr(s){return typeof s>"u"}function Ch(s){return!ml(s)}function ml(s){return Yr(s)||s===null}function ii(s,e){if(!s)throw new Error(e?`Unexpected type, expected '${e}'`:"Unexpected type")}function Hp(s){if(ml(s))throw new Error("Assertion Failed: argument is undefined or null");return s}function Kk(s){return typeof s=="function"}function ATe(s,e){const t=Math.min(s.length,e.length);for(let i=0;i<t;i++)PTe(s[i],e[i])}function PTe(s,e){if(Zo(e)){if(typeof s!==e)throw new Error(`argument does not match constraint: typeof ${e}`)}else if(Kk(e)){try{if(s instanceof e)return}catch{}if(!ml(s)&&s.constructor===e||e.length===1&&e.call(void 0,s)===!0)return;throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}function Ef(s){if(!s||typeof s!="object"||s instanceof RegExp)return s;const e=Array.isArray(s)?[]:{};return Object.entries(s).forEach(([t,i])=>{e[t]=i&&typeof i=="object"?Ef(i):i}),e}function MTe(s){if(!s||typeof s!="object")return s;const e=[s];for(;e.length>0;){const t=e.shift();Object.freeze(t);for(const i in t)if(Xde.call(t,i)){const n=t[i];typeof n=="object"&&!Object.isFrozen(n)&&!RTe(n)&&e.push(n)}}return s}const Xde=Object.prototype.hasOwnProperty;function Zde(s,e){return R7(s,e,new Set)}function R7(s,e,t){if(ml(s))return s;const i=e(s);if(typeof i<"u")return i;if(Array.isArray(s)){const n=[];for(const r of s)n.push(R7(r,e,t));return n}if(Ms(s)){if(t.has(s))throw new Error("Cannot clone recursive data-structure");t.add(s);const n={};for(const r in s)Xde.call(s,r)&&(n[r]=R7(s[r],e,t));return t.delete(s),n}return s}function G4(s,e,t=!0){return Ms(s)?(Ms(e)&&Object.keys(e).forEach(i=>{i in s?t&&(Ms(s[i])&&Ms(e[i])?G4(s[i],e[i],t):s[i]=e[i]):s[i]=e[i]}),s):e}function Ta(s,e){if(s===e)return!0;if(s==null||e===null||e===void 0||typeof s!=typeof e||typeof s!="object"||Array.isArray(s)!==Array.isArray(e))return!1;let t,i;if(Array.isArray(s)){if(s.length!==e.length)return!1;for(t=0;t<s.length;t++)if(!Ta(s[t],e[t]))return!1}else{const n=[];for(i in s)n.push(i);n.sort();const r=[];for(i in e)r.push(i);if(r.sort(),!Ta(n,r))return!1;for(t=0;t<n.length;t++)if(!Ta(s[n[t]],e[n[t]]))return!1}return!0}function OTe(s){let e=[];for(;Object.prototype!==s;)e=e.concat(Object.getOwnPropertyNames(s)),s=Object.getPrototypeOf(s);return e}function A7(s){const e=[];for(const t of OTe(s))typeof s[t]=="function"&&e.push(t);return e}function FTe(s,e){const t=n=>function(){const r=Array.prototype.slice.call(arguments,0);return e(n,r)},i={};for(const n of s)i[n]=t(n);return i}function Jde(){return globalThis._VSCODE_NLS_MESSAGES}function _q(){return globalThis._VSCODE_NLS_LANGUAGE}const VTe=_q()==="pseudo"||typeof document<"u"&&document.location&&document.location.hash.indexOf("pseudo=true")>=0;function I2(s,e){let t;return e.length===0?t=s:t=s.replace(/\{(\d+)\}/g,(i,n)=>{const r=n[0],o=e[r];let a=i;return typeof o=="string"?a=o:(typeof o=="number"||typeof o=="boolean"||o===void 0||o===null)&&(a=String(o)),a}),VTe&&(t="［"+t.replace(/[aouei]/g,"$&$&")+"］"),t}function b(s,e,...t){return I2(typeof s=="number"?eue(s,e):e,t)}function eue(s,e){var i;const t=(i=Jde())==null?void 0:i[s];if(typeof t!="string"){if(typeof e=="string")return e;throw new Error(`!!! NLS MISSING: ${s} !!!`)}return t}function dt(s,e,...t){let i;typeof s=="number"?i=eue(s,e):i=e;const n=I2(i,t);return{value:n,original:e===i?n:I2(e,t)}}const CC="en";let E2=!1,D2=!1,bR=!1,tue=!1,bq=!1,vq=!1,iue=!1,GT,vR=CC,zee=CC,BTe,Nd;const ag=globalThis;let co;var _ae;typeof ag.vscode<"u"&&typeof ag.vscode.process<"u"?co=ag.vscode.process:typeof process<"u"&&typeof((_ae=process==null?void 0:process.versions)==null?void 0:_ae.node)=="string"&&(co=process);var bae;const WTe=typeof((bae=co==null?void 0:co.versions)==null?void 0:bae.electron)=="string",HTe=WTe&&(co==null?void 0:co.type)==="renderer";var vae;if(typeof co=="object"){E2=co.platform==="win32",D2=co.platform==="darwin",bR=co.platform==="linux",bR&&co.env.SNAP&&co.env.SNAP_REVISION,co.env.CI||co.env.BUILD_ARTIFACTSTAGINGDIRECTORY,GT=CC,vR=CC;const s=co.env.VSCODE_NLS_CONFIG;if(s)try{const e=JSON.parse(s);GT=e.userLocale,zee=e.osLocale,vR=e.resolvedLanguage||CC,BTe=(vae=e.languagePack)==null?void 0:vae.translationsConfigFile}catch{}tue=!0}else typeof navigator=="object"&&!HTe?(Nd=navigator.userAgent,E2=Nd.indexOf("Windows")>=0,D2=Nd.indexOf("Macintosh")>=0,vq=(Nd.indexOf("Macintosh")>=0||Nd.indexOf("iPad")>=0||Nd.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,bR=Nd.indexOf("Linux")>=0,iue=(Nd==null?void 0:Nd.indexOf("Mobi"))>=0,bq=!0,vR=_q()||CC,GT=navigator.language.toLowerCase(),zee=GT):console.error("Unable to resolve platform.");const gr=E2,Wt=D2,Lo=bR,Th=tue,Uw=bq,zTe=bq&&typeof ag.importScripts=="function",UTe=zTe?ag.origin:void 0,du=vq,nue=iue,Nh=Nd,jTe=vR,$Te=typeof ag.postMessage=="function"&&!ag.importScripts,sue=(()=>{if($Te){const s=[];ag.addEventListener("message",t=>{if(t.data&&t.data.vscodeScheduleAsyncWork)for(let i=0,n=s.length;i<n;i++){const r=s[i];if(r.id===t.data.vscodeScheduleAsyncWork){s.splice(i,1),r.callback();return}}});let e=0;return t=>{const i=++e;s.push({id:i,callback:t}),ag.postMessage({vscodeScheduleAsyncWork:i},"*")}}return s=>setTimeout(s)})(),Da=D2||vq?2:E2?1:3;let Uee=!0,jee=!1;function rue(){if(!jee){jee=!0;const s=new Uint8Array(2);s[0]=1,s[1]=2,Uee=new Uint16Array(s.buffer)[0]===513}return Uee}const oue=!!(Nh&&Nh.indexOf("Chrome")>=0),qTe=!!(Nh&&Nh.indexOf("Firefox")>=0),KTe=!!(!oue&&Nh&&Nh.indexOf("Safari")>=0),GTe=!!(Nh&&Nh.indexOf("Edg/")>=0),QTe=!!(Nh&&Nh.indexOf("Android")>=0),xr={tabSize:4,indentSize:4,insertSpaces:!0,detectIndentation:!0,trimAutoWhitespace:!0,largeFileOptimizations:!0,bracketPairColorizationOptions:{enabled:!0,independentColorPoolPerBracketType:!1}};var Kt;(function(s){function e(L){return L&&typeof L=="object"&&typeof L[Symbol.iterator]=="function"}s.is=e;const t=Object.freeze([]);function i(){return t}s.empty=i;function*n(L){yield L}s.single=n;function r(L){return e(L)?L:n(L)}s.wrap=r;function o(L){return L||t}s.from=o;function*a(L){for(let I=L.length-1;I>=0;I--)yield L[I]}s.reverse=a;function l(L){return!L||L[Symbol.iterator]().next().done===!0}s.isEmpty=l;function c(L){return L[Symbol.iterator]().next().value}s.first=c;function d(L,I){let A=0;for(const D of L)if(I(D,A++))return!0;return!1}s.some=d;function u(L,I){for(const A of L)if(I(A))return A}s.find=u;function*h(L,I){for(const A of L)I(A)&&(yield A)}s.filter=h;function*g(L,I){let A=0;for(const D of L)yield I(D,A++)}s.map=g;function*p(L,I){let A=0;for(const D of L)yield*I(D,A++)}s.flatMap=p;function*_(...L){for(const I of L)yield*I}s.concat=_;function v(L,I,A){let D=A;for(const N of L)D=I(D,N);return D}s.reduce=v;function*C(L,I,A=L.length){for(I<0&&(I+=L.length),A<0?A+=L.length:A>L.length&&(A=L.length);I<A;I++)yield L[I]}s.slice=C;function y(L,I=Number.POSITIVE_INFINITY){const A=[];if(I===0)return[A,L];const D=L[Symbol.iterator]();for(let N=0;N<I;N++){const R=D.next();if(R.done)return[A,s.empty()];A.push(R.value)}return[A,{[Symbol.iterator](){return D}}]}s.consume=y;async function x(L){const I=[];for await(const A of L)I.push(A);return Promise.resolve(I)}s.asyncToArray=x})(Kt||(Kt={}));var Zf;let bs=(Zf=class{constructor(e){this.element=e,this.next=Zf.Undefined,this.prev=Zf.Undefined}},Zf.Undefined=new Zf(void 0),Zf);class _o{constructor(){this._first=bs.Undefined,this._last=bs.Undefined,this._size=0}get size(){return this._size}isEmpty(){return this._first===bs.Undefined}clear(){let e=this._first;for(;e!==bs.Undefined;){const t=e.next;e.prev=bs.Undefined,e.next=bs.Undefined,e=t}this._first=bs.Undefined,this._last=bs.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,t){const i=new bs(e);if(this._first===bs.Undefined)this._first=i,this._last=i;else if(t){const r=this._last;this._last=i,i.prev=r,r.next=i}else{const r=this._first;this._first=i,i.next=r,r.prev=i}this._size+=1;let n=!1;return()=>{n||(n=!0,this._remove(i))}}shift(){if(this._first!==bs.Undefined){const e=this._first.element;return this._remove(this._first),e}}pop(){if(this._last!==bs.Undefined){const e=this._last.element;return this._remove(this._last),e}}_remove(e){if(e.prev!==bs.Undefined&&e.next!==bs.Undefined){const t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===bs.Undefined&&e.next===bs.Undefined?(this._first=bs.Undefined,this._last=bs.Undefined):e.next===bs.Undefined?(this._last=this._last.prev,this._last.next=bs.Undefined):e.prev===bs.Undefined&&(this._first=this._first.next,this._first.prev=bs.Undefined);this._size-=1}*[Symbol.iterator](){let e=this._first;for(;e!==bs.Undefined;)yield e.element,e=e.next}}const T2="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function YTe(s=""){let e="(-?\\d*\\.\\d\\w*)|([^";for(const t of T2)s.indexOf(t)>=0||(e+="\\"+t);return e+="\\s]+)",new RegExp(e,"g")}const wq=YTe();function Cq(s){let e=wq;if(s&&s instanceof RegExp)if(s.global)e=s;else{let t="g";s.ignoreCase&&(t+="i"),s.multiline&&(t+="m"),s.unicode&&(t+="u"),e=new RegExp(s.source,t)}return e.lastIndex=0,e}const aue=new _o;aue.unshift({maxLen:1e3,windowSize:15,timeBudget:150});function Gk(s,e,t,i,n){if(e=Cq(e),n||(n=Kt.first(aue)),t.length>n.maxLen){let c=s-n.maxLen/2;return c<0?c=0:i+=c,t=t.substring(c,s+n.maxLen/2),Gk(s,e,t,i,n)}const r=Date.now(),o=s-1-i;let a=-1,l=null;for(let c=1;!(Date.now()-r>=n.timeBudget);c++){const d=o-n.windowSize*c;e.lastIndex=Math.max(0,d);const u=XTe(e,t,o,a);if(!u&&l||(l=u,d<=0))break;a=d}if(l){const c={word:l[0],startColumn:i+1+l.index,endColumn:i+1+l.index+l[0].length};return e.lastIndex=0,c}return null}function XTe(s,e,t,i){let n;for(;n=s.exec(e);){const r=n.index||0;if(r<=t&&s.lastIndex>=t)return n;if(i>0&&r>i)return null}return null}const Uu=8;class lue{constructor(e){this._values=e}hasChanged(e){return this._values[e]}}class cue{constructor(){this.stableMinimapLayoutInput=null,this.stableFitMaxMinimapScale=0,this.stableFitRemainingWidth=0}}class sn{constructor(e,t,i,n){this.id=e,this.name=t,this.defaultValue=i,this.schema=n}applyUpdate(e,t){return Q4(e,t)}compute(e,t,i){return i}}class EL{constructor(e,t){this.newValue=e,this.didChange=t}}function Q4(s,e){if(typeof s!="object"||typeof e!="object"||!s||!e)return new EL(e,s!==e);if(Array.isArray(s)||Array.isArray(e)){const i=Array.isArray(s)&&Array.isArray(e)&&dn(s,e);return new EL(e,!i)}let t=!1;for(const i in e)if(e.hasOwnProperty(i)){const n=Q4(s[i],e[i]);n.didChange&&(s[i]=n.newValue,t=!0)}return new EL(s,t)}class VE{constructor(e){this.schema=void 0,this.id=e,this.name="_never_",this.defaultValue=void 0}applyUpdate(e,t){return Q4(e,t)}validate(e){return this.defaultValue}}class oS{constructor(e,t,i,n){this.id=e,this.name=t,this.defaultValue=i,this.schema=n}applyUpdate(e,t){return Q4(e,t)}validate(e){return typeof e>"u"?this.defaultValue:e}compute(e,t,i){return i}}function Ke(s,e){return typeof s>"u"?e:s==="false"?!1:!!s}class ei extends oS{constructor(e,t,i,n=void 0){typeof n<"u"&&(n.type="boolean",n.default=i),super(e,t,i,n)}validate(e){return Ke(e,this.defaultValue)}}function nb(s,e,t,i){if(typeof s>"u")return e;let n=parseInt(s,10);return isNaN(n)?e:(n=Math.max(t,n),n=Math.min(i,n),n|0)}class Pi extends oS{static clampedInt(e,t,i,n){return nb(e,t,i,n)}constructor(e,t,i,n,r,o=void 0){typeof o<"u"&&(o.type="integer",o.default=i,o.minimum=n,o.maximum=r),super(e,t,i,o),this.minimum=n,this.maximum=r}validate(e){return Pi.clampedInt(e,this.defaultValue,this.minimum,this.maximum)}}function ZTe(s,e,t,i){if(typeof s>"u")return e;const n=wl.float(s,e);return wl.clamp(n,t,i)}class wl extends oS{static clamp(e,t,i){return e<t?t:e>i?i:e}static float(e,t){if(typeof e=="number")return e;if(typeof e>"u")return t;const i=parseFloat(e);return isNaN(i)?t:i}constructor(e,t,i,n,r){typeof r<"u"&&(r.type="number",r.default=i),super(e,t,i,r),this.validationFn=n}validate(e){return this.validationFn(wl.float(e,this.defaultValue))}}class Gr extends oS{static string(e,t){return typeof e!="string"?t:e}constructor(e,t,i,n=void 0){typeof n<"u"&&(n.type="string",n.default=i),super(e,t,i,n)}validate(e){return Gr.string(e,this.defaultValue)}}function xn(s,e,t,i){return typeof s!="string"?e:i&&s in i?i[s]:t.indexOf(s)===-1?e:s}class Sn extends oS{constructor(e,t,i,n,r=void 0){typeof r<"u"&&(r.type="string",r.enum=n,r.default=i),super(e,t,i,r),this._allowedValues=n}validate(e){return xn(e,this.defaultValue,this._allowedValues)}}class QT extends sn{constructor(e,t,i,n,r,o,a=void 0){typeof a<"u"&&(a.type="string",a.enum=r,a.default=n),super(e,t,i,a),this._allowedValues=r,this._convert=o}validate(e){return typeof e!="string"?this.defaultValue:this._allowedValues.indexOf(e)===-1?this.defaultValue:this._convert(e)}}function JTe(s){switch(s){case"none":return 0;case"keep":return 1;case"brackets":return 2;case"advanced":return 3;case"full":return 4}}class eNe extends sn{constructor(){super(2,"accessibilitySupport",0,{type:"string",enum:["auto","on","off"],enumDescriptions:[b("accessibilitySupport.auto","Use platform APIs to detect when a Screen Reader is attached."),b("accessibilitySupport.on","Optimize for usage with a Screen Reader."),b("accessibilitySupport.off","Assume a screen reader is not attached.")],default:"auto",tags:["accessibility"],description:b("accessibilitySupport","Controls if the UI should run in a mode where it is optimized for screen readers.")})}validate(e){switch(e){case"auto":return 0;case"off":return 1;case"on":return 2}return this.defaultValue}compute(e,t,i){return i===0?e.accessibilitySupport:i}}class tNe extends sn{constructor(){const e={insertSpace:!0,ignoreEmptyLines:!0};super(23,"comments",e,{"editor.comments.insertSpace":{type:"boolean",default:e.insertSpace,description:b("comments.insertSpace","Controls whether a space character is inserted when commenting.")},"editor.comments.ignoreEmptyLines":{type:"boolean",default:e.ignoreEmptyLines,description:b("comments.ignoreEmptyLines","Controls if empty lines should be ignored with toggle, add or remove actions for line comments.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{insertSpace:Ke(t.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:Ke(t.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}}function iNe(s){switch(s){case"blink":return 1;case"smooth":return 2;case"phase":return 3;case"expand":return 4;case"solid":return 5}}var Gs;(function(s){s[s.Line=1]="Line",s[s.Block=2]="Block",s[s.Underline=3]="Underline",s[s.LineThin=4]="LineThin",s[s.BlockOutline=5]="BlockOutline",s[s.UnderlineThin=6]="UnderlineThin"})(Gs||(Gs={}));function nNe(s){switch(s){case"line":return Gs.Line;case"block":return Gs.Block;case"underline":return Gs.Underline;case"line-thin":return Gs.LineThin;case"block-outline":return Gs.BlockOutline;case"underline-thin":return Gs.UnderlineThin}}class sNe extends VE{constructor(){super(143)}compute(e,t,i){const n=["monaco-editor"];return t.get(39)&&n.push(t.get(39)),e.extraEditorClassName&&n.push(e.extraEditorClassName),t.get(74)==="default"?n.push("mouse-default"):t.get(74)==="copy"&&n.push("mouse-copy"),t.get(112)&&n.push("showUnused"),t.get(141)&&n.push("showDeprecated"),n.join(" ")}}class rNe extends ei{constructor(){super(37,"emptySelectionClipboard",!0,{description:b("emptySelectionClipboard","Controls whether copying without a selection copies the current line.")})}compute(e,t,i){return i&&e.emptySelectionClipboard}}class oNe extends sn{constructor(){const e={cursorMoveOnType:!0,seedSearchStringFromSelection:"always",autoFindInSelection:"never",globalFindClipboard:!1,addExtraSpaceOnTop:!0,loop:!0};super(41,"find",e,{"editor.find.cursorMoveOnType":{type:"boolean",default:e.cursorMoveOnType,description:b("find.cursorMoveOnType","Controls whether the cursor should jump to find matches while typing.")},"editor.find.seedSearchStringFromSelection":{type:"string",enum:["never","always","selection"],default:e.seedSearchStringFromSelection,enumDescriptions:[b("editor.find.seedSearchStringFromSelection.never","Never seed search string from the editor selection."),b("editor.find.seedSearchStringFromSelection.always","Always seed search string from the editor selection, including word at cursor position."),b("editor.find.seedSearchStringFromSelection.selection","Only seed search string from the editor selection.")],description:b("find.seedSearchStringFromSelection","Controls whether the search string in the Find Widget is seeded from the editor selection.")},"editor.find.autoFindInSelection":{type:"string",enum:["never","always","multiline"],default:e.autoFindInSelection,enumDescriptions:[b("editor.find.autoFindInSelection.never","Never turn on Find in Selection automatically (default)."),b("editor.find.autoFindInSelection.always","Always turn on Find in Selection automatically."),b("editor.find.autoFindInSelection.multiline","Turn on Find in Selection automatically when multiple lines of content are selected.")],description:b("find.autoFindInSelection","Controls the condition for turning on Find in Selection automatically.")},"editor.find.globalFindClipboard":{type:"boolean",default:e.globalFindClipboard,description:b("find.globalFindClipboard","Controls whether the Find Widget should read or modify the shared find clipboard on macOS."),included:Wt},"editor.find.addExtraSpaceOnTop":{type:"boolean",default:e.addExtraSpaceOnTop,description:b("find.addExtraSpaceOnTop","Controls whether the Find Widget should add extra lines on top of the editor. When true, you can scroll beyond the first line when the Find Widget is visible.")},"editor.find.loop":{type:"boolean",default:e.loop,description:b("find.loop","Controls whether the search automatically restarts from the beginning (or the end) when no further matches can be found.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{cursorMoveOnType:Ke(t.cursorMoveOnType,this.defaultValue.cursorMoveOnType),seedSearchStringFromSelection:typeof e.seedSearchStringFromSelection=="boolean"?e.seedSearchStringFromSelection?"always":"never":xn(t.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection,["never","always","selection"]),autoFindInSelection:typeof e.autoFindInSelection=="boolean"?e.autoFindInSelection?"always":"never":xn(t.autoFindInSelection,this.defaultValue.autoFindInSelection,["never","always","multiline"]),globalFindClipboard:Ke(t.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:Ke(t.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:Ke(t.loop,this.defaultValue.loop)}}}const Sf=class Sf extends sn{constructor(){super(51,"fontLigatures",Sf.OFF,{anyOf:[{type:"boolean",description:b("fontLigatures","Enables/Disables font ligatures ('calt' and 'liga' font features). Change this to a string for fine-grained control of the 'font-feature-settings' CSS property.")},{type:"string",description:b("fontFeatureSettings","Explicit 'font-feature-settings' CSS property. A boolean can be passed instead if one only needs to turn on/off ligatures.")}],description:b("fontLigaturesGeneral","Configures font ligatures or font features. Can be either a boolean to enable/disable ligatures or a string for the value of the CSS 'font-feature-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"||e.length===0?Sf.OFF:e==="true"?Sf.ON:e:e?Sf.ON:Sf.OFF}};Sf.OFF='"liga" off, "calt" off',Sf.ON='"liga" on, "calt" on';let Bm=Sf;const xf=class xf extends sn{constructor(){super(54,"fontVariations",xf.OFF,{anyOf:[{type:"boolean",description:b("fontVariations","Enables/Disables the translation from font-weight to font-variation-settings. Change this to a string for fine-grained control of the 'font-variation-settings' CSS property.")},{type:"string",description:b("fontVariationSettings","Explicit 'font-variation-settings' CSS property. A boolean can be passed instead if one only needs to translate font-weight to font-variation-settings.")}],description:b("fontVariationsGeneral","Configures font variations. Can be either a boolean to enable/disable the translation from font-weight to font-variation-settings or a string for the value of the CSS 'font-variation-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"?xf.OFF:e==="true"?xf.TRANSLATE:e:e?xf.TRANSLATE:xf.OFF}compute(e,t,i){return e.fontInfo.fontVariationSettings}};xf.OFF="normal",xf.TRANSLATE="translate";let Qk=xf;class aNe extends VE{constructor(){super(50)}compute(e,t,i){return e.fontInfo}}class lNe extends oS{constructor(){super(52,"fontSize",yo.fontSize,{type:"number",minimum:6,maximum:100,default:yo.fontSize,description:b("fontSize","Controls the font size in pixels.")})}validate(e){const t=wl.float(e,this.defaultValue);return t===0?yo.fontSize:wl.clamp(t,6,100)}compute(e,t,i){return e.fontInfo.fontSize}}const Gu=class Gu extends sn{constructor(){super(53,"fontWeight",yo.fontWeight,{anyOf:[{type:"number",minimum:Gu.MINIMUM_VALUE,maximum:Gu.MAXIMUM_VALUE,errorMessage:b("fontWeightErrorMessage",'Only "normal" and "bold" keywords or numbers between 1 and 1000 are allowed.')},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:Gu.SUGGESTION_VALUES}],default:yo.fontWeight,description:b("fontWeight",'Controls the font weight. Accepts "normal" and "bold" keywords or numbers between 1 and 1000.')})}validate(e){return e==="normal"||e==="bold"?e:String(Pi.clampedInt(e,yo.fontWeight,Gu.MINIMUM_VALUE,Gu.MAXIMUM_VALUE))}};Gu.SUGGESTION_VALUES=["normal","bold","100","200","300","400","500","600","700","800","900"],Gu.MINIMUM_VALUE=1,Gu.MAXIMUM_VALUE=1e3;let P7=Gu;class cNe extends sn{constructor(){const e={multiple:"peek",multipleDefinitions:"peek",multipleTypeDefinitions:"peek",multipleDeclarations:"peek",multipleImplementations:"peek",multipleReferences:"peek",multipleTests:"peek",alternativeDefinitionCommand:"editor.action.goToReferences",alternativeTypeDefinitionCommand:"editor.action.goToReferences",alternativeDeclarationCommand:"editor.action.goToReferences",alternativeImplementationCommand:"",alternativeReferenceCommand:"",alternativeTestsCommand:""},t={type:"string",enum:["peek","gotoAndPeek","goto"],default:e.multiple,enumDescriptions:[b("editor.gotoLocation.multiple.peek","Show Peek view of the results (default)"),b("editor.gotoLocation.multiple.gotoAndPeek","Go to the primary result and show a Peek view"),b("editor.gotoLocation.multiple.goto","Go to the primary result and enable Peek-less navigation to others")]},i=["","editor.action.referenceSearch.trigger","editor.action.goToReferences","editor.action.peekImplementation","editor.action.goToImplementation","editor.action.peekTypeDefinition","editor.action.goToTypeDefinition","editor.action.peekDeclaration","editor.action.revealDeclaration","editor.action.peekDefinition","editor.action.revealDefinitionAside","editor.action.revealDefinition"];super(58,"gotoLocation",e,{"editor.gotoLocation.multiple":{deprecationMessage:b("editor.gotoLocation.multiple.deprecated","This setting is deprecated, please use separate settings like 'editor.editor.gotoLocation.multipleDefinitions' or 'editor.editor.gotoLocation.multipleImplementations' instead.")},"editor.gotoLocation.multipleDefinitions":{description:b("editor.editor.gotoLocation.multipleDefinitions","Controls the behavior the 'Go to Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleTypeDefinitions":{description:b("editor.editor.gotoLocation.multipleTypeDefinitions","Controls the behavior the 'Go to Type Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleDeclarations":{description:b("editor.editor.gotoLocation.multipleDeclarations","Controls the behavior the 'Go to Declaration'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleImplementations":{description:b("editor.editor.gotoLocation.multipleImplemenattions","Controls the behavior the 'Go to Implementations'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleReferences":{description:b("editor.editor.gotoLocation.multipleReferences","Controls the behavior the 'Go to References'-command when multiple target locations exist."),...t},"editor.gotoLocation.alternativeDefinitionCommand":{type:"string",default:e.alternativeDefinitionCommand,enum:i,description:b("alternativeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Definition' is the current location.")},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:"string",default:e.alternativeTypeDefinitionCommand,enum:i,description:b("alternativeTypeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Type Definition' is the current location.")},"editor.gotoLocation.alternativeDeclarationCommand":{type:"string",default:e.alternativeDeclarationCommand,enum:i,description:b("alternativeDeclarationCommand","Alternative command id that is being executed when the result of 'Go to Declaration' is the current location.")},"editor.gotoLocation.alternativeImplementationCommand":{type:"string",default:e.alternativeImplementationCommand,enum:i,description:b("alternativeImplementationCommand","Alternative command id that is being executed when the result of 'Go to Implementation' is the current location.")},"editor.gotoLocation.alternativeReferenceCommand":{type:"string",default:e.alternativeReferenceCommand,enum:i,description:b("alternativeReferenceCommand","Alternative command id that is being executed when the result of 'Go to Reference' is the current location.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{multiple:xn(t.multiple,this.defaultValue.multiple,["peek","gotoAndPeek","goto"]),multipleDefinitions:t.multipleDefinitions??xn(t.multipleDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleTypeDefinitions:t.multipleTypeDefinitions??xn(t.multipleTypeDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleDeclarations:t.multipleDeclarations??xn(t.multipleDeclarations,"peek",["peek","gotoAndPeek","goto"]),multipleImplementations:t.multipleImplementations??xn(t.multipleImplementations,"peek",["peek","gotoAndPeek","goto"]),multipleReferences:t.multipleReferences??xn(t.multipleReferences,"peek",["peek","gotoAndPeek","goto"]),multipleTests:t.multipleTests??xn(t.multipleTests,"peek",["peek","gotoAndPeek","goto"]),alternativeDefinitionCommand:Gr.string(t.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:Gr.string(t.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:Gr.string(t.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:Gr.string(t.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:Gr.string(t.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand),alternativeTestsCommand:Gr.string(t.alternativeTestsCommand,this.defaultValue.alternativeTestsCommand)}}}class dNe extends sn{constructor(){const e={enabled:!0,delay:300,hidingDelay:300,sticky:!0,above:!0};super(60,"hover",e,{"editor.hover.enabled":{type:"boolean",default:e.enabled,description:b("hover.enabled","Controls whether the hover is shown.")},"editor.hover.delay":{type:"number",default:e.delay,minimum:0,maximum:1e4,description:b("hover.delay","Controls the delay in milliseconds after which the hover is shown.")},"editor.hover.sticky":{type:"boolean",default:e.sticky,description:b("hover.sticky","Controls whether the hover should remain visible when mouse is moved over it.")},"editor.hover.hidingDelay":{type:"integer",minimum:0,default:e.hidingDelay,description:b("hover.hidingDelay","Controls the delay in milliseconds after which the hover is hidden. Requires `editor.hover.sticky` to be enabled.")},"editor.hover.above":{type:"boolean",default:e.above,description:b("hover.above","Prefer showing hovers above the line, if there's space.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Ke(t.enabled,this.defaultValue.enabled),delay:Pi.clampedInt(t.delay,this.defaultValue.delay,0,1e4),sticky:Ke(t.sticky,this.defaultValue.sticky),hidingDelay:Pi.clampedInt(t.hidingDelay,this.defaultValue.hidingDelay,0,6e5),above:Ke(t.above,this.defaultValue.above)}}}class fy extends VE{constructor(){super(146)}compute(e,t,i){return fy.computeLayout(t,{memory:e.memory,outerWidth:e.outerWidth,outerHeight:e.outerHeight,isDominatedByLongLines:e.isDominatedByLongLines,lineHeight:e.fontInfo.lineHeight,viewLineCount:e.viewLineCount,lineNumbersDigitCount:e.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:e.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:e.fontInfo.maxDigitWidth,pixelRatio:e.pixelRatio,glyphMarginDecorationLaneCount:e.glyphMarginDecorationLaneCount})}static computeContainedMinimapLineCount(e){const t=e.height/e.lineHeight,i=Math.floor(e.paddingTop/e.lineHeight);let n=Math.floor(e.paddingBottom/e.lineHeight);e.scrollBeyondLastLine&&(n=Math.max(n,t-1));const r=(i+e.viewLineCount+n)/(e.pixelRatio*e.height),o=Math.floor(e.viewLineCount/r);return{typicalViewportLineCount:t,extraLinesBeforeFirstLine:i,extraLinesBeyondLastLine:n,desiredRatio:r,minimapLineCount:o}}static _computeMinimapLayout(e,t){const i=e.outerWidth,n=e.outerHeight,r=e.pixelRatio;if(!e.minimap.enabled)return{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(r*n),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:n};const o=t.stableMinimapLayoutInput,a=o&&e.outerHeight===o.outerHeight&&e.lineHeight===o.lineHeight&&e.typicalHalfwidthCharacterWidth===o.typicalHalfwidthCharacterWidth&&e.pixelRatio===o.pixelRatio&&e.scrollBeyondLastLine===o.scrollBeyondLastLine&&e.paddingTop===o.paddingTop&&e.paddingBottom===o.paddingBottom&&e.minimap.enabled===o.minimap.enabled&&e.minimap.side===o.minimap.side&&e.minimap.size===o.minimap.size&&e.minimap.showSlider===o.minimap.showSlider&&e.minimap.renderCharacters===o.minimap.renderCharacters&&e.minimap.maxColumn===o.minimap.maxColumn&&e.minimap.scale===o.minimap.scale&&e.verticalScrollbarWidth===o.verticalScrollbarWidth&&e.isViewportWrapping===o.isViewportWrapping,l=e.lineHeight,c=e.typicalHalfwidthCharacterWidth,d=e.scrollBeyondLastLine,u=e.minimap.renderCharacters;let h=r>=2?Math.round(e.minimap.scale*2):e.minimap.scale;const g=e.minimap.maxColumn,p=e.minimap.size,_=e.minimap.side,v=e.verticalScrollbarWidth,C=e.viewLineCount,y=e.remainingWidth,x=e.isViewportWrapping,L=u?2:3;let I=Math.floor(r*n);const A=I/r;let D=!1,N=!1,R=L*h,W=h/r,H=1;if(p==="fill"||p==="fit"){const{typicalViewportLineCount:ge,extraLinesBeforeFirstLine:_e,extraLinesBeyondLastLine:Re,desiredRatio:J,minimapLineCount:we}=fy.computeContainedMinimapLineCount({viewLineCount:C,scrollBeyondLastLine:d,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:n,lineHeight:l,pixelRatio:r});if(C/we>1)D=!0,N=!0,h=1,R=1,W=h/r;else{let ot=!1,tt=h+1;if(p==="fit"){const It=Math.ceil((_e+C+Re)*R);x&&a&&y<=t.stableFitRemainingWidth?(ot=!0,tt=t.stableFitMaxMinimapScale):ot=It>I}if(p==="fill"||ot){D=!0;const It=h;R=Math.min(l*r,Math.max(1,Math.floor(1/J))),x&&a&&y<=t.stableFitRemainingWidth&&(tt=t.stableFitMaxMinimapScale),h=Math.min(tt,Math.max(1,Math.floor(R/L))),h>It&&(H=Math.min(2,h/It)),W=h/r/H,I=Math.ceil(Math.max(ge,_e+C+Re)*R),x?(t.stableMinimapLayoutInput=e,t.stableFitRemainingWidth=y,t.stableFitMaxMinimapScale=h):(t.stableMinimapLayoutInput=null,t.stableFitRemainingWidth=0)}}}const U=Math.floor(g*W),B=Math.min(U,Math.max(0,Math.floor((y-v-2)*W/(c+W)))+Uu);let ee=Math.floor(r*B);const re=ee/r;ee=Math.floor(ee*H);const pe=u?1:2,Ie=_==="left"?0:i-B-v;return{renderMinimap:pe,minimapLeft:Ie,minimapWidth:B,minimapHeightIsEditorHeight:D,minimapIsSampling:N,minimapScale:h,minimapLineHeight:R,minimapCanvasInnerWidth:ee,minimapCanvasInnerHeight:I,minimapCanvasOuterWidth:re,minimapCanvasOuterHeight:A}}static computeLayout(e,t){const i=t.outerWidth|0,n=t.outerHeight|0,r=t.lineHeight|0,o=t.lineNumbersDigitCount|0,a=t.typicalHalfwidthCharacterWidth,l=t.maxDigitWidth,c=t.pixelRatio,d=t.viewLineCount,u=e.get(138),h=u==="inherit"?e.get(137):u,g=h==="inherit"?e.get(133):h,p=e.get(136),_=t.isDominatedByLongLines,v=e.get(57),C=e.get(68).renderType!==0,y=e.get(69),x=e.get(106),L=e.get(84),I=e.get(73),A=e.get(104),D=A.verticalScrollbarSize,N=A.verticalHasArrows,R=A.arrowSize,W=A.horizontalScrollbarSize,H=e.get(43),U=e.get(111)!=="never";let B=e.get(66);H&&U&&(B+=16);let ee=0;if(C){const ai=Math.max(o,y);ee=Math.round(ai*l)}let re=0;v&&(re=r*t.glyphMarginDecorationLaneCount);let pe=0,Ie=pe+re,ge=Ie+ee,_e=ge+B;const Re=i-re-ee-B;let J=!1,we=!1,Ae=-1;h==="inherit"&&_?(J=!0,we=!0):g==="on"||g==="bounded"?we=!0:g==="wordWrapColumn"&&(Ae=p);const ot=fy._computeMinimapLayout({outerWidth:i,outerHeight:n,lineHeight:r,typicalHalfwidthCharacterWidth:a,pixelRatio:c,scrollBeyondLastLine:x,paddingTop:L.top,paddingBottom:L.bottom,minimap:I,verticalScrollbarWidth:D,viewLineCount:d,remainingWidth:Re,isViewportWrapping:we},t.memory||new cue);ot.renderMinimap!==0&&ot.minimapLeft===0&&(pe+=ot.minimapWidth,Ie+=ot.minimapWidth,ge+=ot.minimapWidth,_e+=ot.minimapWidth);const tt=Re-ot.minimapWidth,It=Math.max(1,Math.floor((tt-D-2)/a)),si=N?R:0;return we&&(Ae=Math.max(1,It),g==="bounded"&&(Ae=Math.min(Ae,p))),{width:i,height:n,glyphMarginLeft:pe,glyphMarginWidth:re,glyphMarginDecorationLaneCount:t.glyphMarginDecorationLaneCount,lineNumbersLeft:Ie,lineNumbersWidth:ee,decorationsLeft:ge,decorationsWidth:B,contentLeft:_e,contentWidth:tt,minimap:ot,viewportColumn:It,isWordWrapMinified:J,isViewportWrapping:we,wrappingColumn:Ae,verticalScrollbarWidth:D,horizontalScrollbarHeight:W,overviewRuler:{top:si,width:D,height:n-2*si,right:0}}}}class uNe extends sn{constructor(){super(140,"wrappingStrategy","simple",{"editor.wrappingStrategy":{enumDescriptions:[b("wrappingStrategy.simple","Assumes that all characters are of the same width. This is a fast algorithm that works correctly for monospace fonts and certain scripts (like Latin characters) where glyphs are of equal width."),b("wrappingStrategy.advanced","Delegates wrapping points computation to the browser. This is a slow algorithm, that might cause freezes for large files, but it works correctly in all cases.")],type:"string",enum:["simple","advanced"],default:"simple",description:b("wrappingStrategy","Controls the algorithm that computes wrapping points. Note that when in accessibility mode, advanced will be used for the best experience.")}})}validate(e){return xn(e,"simple",["simple","advanced"])}compute(e,t,i){return t.get(2)===2?"advanced":i}}var qc;(function(s){s.Off="off",s.OnCode="onCode",s.On="on"})(qc||(qc={}));class hNe extends sn{constructor(){const e={enabled:qc.OnCode};super(65,"lightbulb",e,{"editor.lightbulb.enabled":{type:"string",tags:["experimental"],enum:[qc.Off,qc.OnCode,qc.On],default:e.enabled,enumDescriptions:[b("editor.lightbulb.enabled.off","Disable the code action menu."),b("editor.lightbulb.enabled.onCode","Show the code action menu when the cursor is on lines with code."),b("editor.lightbulb.enabled.on","Show the code action menu when the cursor is on lines with code or on empty lines.")],description:b("enabled","Enables the Code Action lightbulb in the editor.")}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{enabled:xn(e.enabled,this.defaultValue.enabled,[qc.Off,qc.OnCode,qc.On])}}}class fNe extends sn{constructor(){const e={enabled:!0,maxLineCount:5,defaultModel:"outlineModel",scrollWithEditor:!0};super(116,"stickyScroll",e,{"editor.stickyScroll.enabled":{type:"boolean",default:e.enabled,description:b("editor.stickyScroll.enabled","Shows the nested current scopes during the scroll at the top of the editor."),tags:["experimental"]},"editor.stickyScroll.maxLineCount":{type:"number",default:e.maxLineCount,minimum:1,maximum:20,description:b("editor.stickyScroll.maxLineCount","Defines the maximum number of sticky lines to show.")},"editor.stickyScroll.defaultModel":{type:"string",enum:["outlineModel","foldingProviderModel","indentationModel"],default:e.defaultModel,description:b("editor.stickyScroll.defaultModel","Defines the model to use for determining which lines to stick. If the outline model does not exist, it will fall back on the folding provider model which falls back on the indentation model. This order is respected in all three cases.")},"editor.stickyScroll.scrollWithEditor":{type:"boolean",default:e.scrollWithEditor,description:b("editor.stickyScroll.scrollWithEditor","Enable scrolling of Sticky Scroll with the editor's horizontal scrollbar.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Ke(t.enabled,this.defaultValue.enabled),maxLineCount:Pi.clampedInt(t.maxLineCount,this.defaultValue.maxLineCount,1,20),defaultModel:xn(t.defaultModel,this.defaultValue.defaultModel,["outlineModel","foldingProviderModel","indentationModel"]),scrollWithEditor:Ke(t.scrollWithEditor,this.defaultValue.scrollWithEditor)}}}class gNe extends sn{constructor(){const e={enabled:"on",fontSize:0,fontFamily:"",padding:!1};super(142,"inlayHints",e,{"editor.inlayHints.enabled":{type:"string",default:e.enabled,description:b("inlayHints.enable","Enables the inlay hints in the editor."),enum:["on","onUnlessPressed","offUnlessPressed","off"],markdownEnumDescriptions:[b("editor.inlayHints.on","Inlay hints are enabled"),b("editor.inlayHints.onUnlessPressed","Inlay hints are showing by default and hide when holding {0}",Wt?"Ctrl+Option":"Ctrl+Alt"),b("editor.inlayHints.offUnlessPressed","Inlay hints are hidden by default and show when holding {0}",Wt?"Ctrl+Option":"Ctrl+Alt"),b("editor.inlayHints.off","Inlay hints are disabled")]},"editor.inlayHints.fontSize":{type:"number",default:e.fontSize,markdownDescription:b("inlayHints.fontSize","Controls font size of inlay hints in the editor. As default the {0} is used when the configured value is less than {1} or greater than the editor font size.","`#editor.fontSize#`","`5`")},"editor.inlayHints.fontFamily":{type:"string",default:e.fontFamily,markdownDescription:b("inlayHints.fontFamily","Controls font family of inlay hints in the editor. When set to empty, the {0} is used.","`#editor.fontFamily#`")},"editor.inlayHints.padding":{type:"boolean",default:e.padding,description:b("inlayHints.padding","Enables the padding around the inlay hints in the editor.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return typeof t.enabled=="boolean"&&(t.enabled=t.enabled?"on":"off"),{enabled:xn(t.enabled,this.defaultValue.enabled,["on","off","offUnlessPressed","onUnlessPressed"]),fontSize:Pi.clampedInt(t.fontSize,this.defaultValue.fontSize,0,100),fontFamily:Gr.string(t.fontFamily,this.defaultValue.fontFamily),padding:Ke(t.padding,this.defaultValue.padding)}}}class pNe extends sn{constructor(){super(66,"lineDecorationsWidth",10)}validate(e){return typeof e=="string"&&/^\d+(\.\d+)?ch$/.test(e)?-parseFloat(e.substring(0,e.length-2)):Pi.clampedInt(e,this.defaultValue,0,1e3)}compute(e,t,i){return i<0?Pi.clampedInt(-i*e.fontInfo.typicalHalfwidthCharacterWidth,this.defaultValue,0,1e3):i}}class mNe extends wl{constructor(){super(67,"lineHeight",yo.lineHeight,e=>wl.clamp(e,0,150),{markdownDescription:b("lineHeight",`Controls the line height. 
 - Use 0 to automatically compute the line height from the font size.
 - Values between 0 and 8 will be used as a multiplier with the font size.
 - Values greater than or equal to 8 will be used as effective values.`)})}compute(e,t,i){return e.fontInfo.lineHeight}}class _Ne extends sn{constructor(){const e={enabled:!0,size:"proportional",side:"right",showSlider:"mouseover",autohide:!1,renderCharacters:!0,maxColumn:120,scale:1,showRegionSectionHeaders:!0,showMarkSectionHeaders:!0,sectionHeaderFontSize:9,sectionHeaderLetterSpacing:1};super(73,"minimap",e,{"editor.minimap.enabled":{type:"boolean",default:e.enabled,description:b("minimap.enabled","Controls whether the minimap is shown.")},"editor.minimap.autohide":{type:"boolean",default:e.autohide,description:b("minimap.autohide","Controls whether the minimap is hidden automatically.")},"editor.minimap.size":{type:"string",enum:["proportional","fill","fit"],enumDescriptions:[b("minimap.size.proportional","The minimap has the same size as the editor contents (and might scroll)."),b("minimap.size.fill","The minimap will stretch or shrink as necessary to fill the height of the editor (no scrolling)."),b("minimap.size.fit","The minimap will shrink as necessary to never be larger than the editor (no scrolling).")],default:e.size,description:b("minimap.size","Controls the size of the minimap.")},"editor.minimap.side":{type:"string",enum:["left","right"],default:e.side,description:b("minimap.side","Controls the side where to render the minimap.")},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:e.showSlider,description:b("minimap.showSlider","Controls when the minimap slider is shown.")},"editor.minimap.scale":{type:"number",default:e.scale,minimum:1,maximum:3,enum:[1,2,3],description:b("minimap.scale","Scale of content drawn in the minimap: 1, 2 or 3.")},"editor.minimap.renderCharacters":{type:"boolean",default:e.renderCharacters,description:b("minimap.renderCharacters","Render the actual characters on a line as opposed to color blocks.")},"editor.minimap.maxColumn":{type:"number",default:e.maxColumn,description:b("minimap.maxColumn","Limit the width of the minimap to render at most a certain number of columns.")},"editor.minimap.showRegionSectionHeaders":{type:"boolean",default:e.showRegionSectionHeaders,description:b("minimap.showRegionSectionHeaders","Controls whether named regions are shown as section headers in the minimap.")},"editor.minimap.showMarkSectionHeaders":{type:"boolean",default:e.showMarkSectionHeaders,description:b("minimap.showMarkSectionHeaders","Controls whether MARK: comments are shown as section headers in the minimap.")},"editor.minimap.sectionHeaderFontSize":{type:"number",default:e.sectionHeaderFontSize,description:b("minimap.sectionHeaderFontSize","Controls the font size of section headers in the minimap.")},"editor.minimap.sectionHeaderLetterSpacing":{type:"number",default:e.sectionHeaderLetterSpacing,description:b("minimap.sectionHeaderLetterSpacing","Controls the amount of space (in pixels) between characters of section header. This helps the readability of the header in small font sizes.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Ke(t.enabled,this.defaultValue.enabled),autohide:Ke(t.autohide,this.defaultValue.autohide),size:xn(t.size,this.defaultValue.size,["proportional","fill","fit"]),side:xn(t.side,this.defaultValue.side,["right","left"]),showSlider:xn(t.showSlider,this.defaultValue.showSlider,["always","mouseover"]),renderCharacters:Ke(t.renderCharacters,this.defaultValue.renderCharacters),scale:Pi.clampedInt(t.scale,1,1,3),maxColumn:Pi.clampedInt(t.maxColumn,this.defaultValue.maxColumn,1,1e4),showRegionSectionHeaders:Ke(t.showRegionSectionHeaders,this.defaultValue.showRegionSectionHeaders),showMarkSectionHeaders:Ke(t.showMarkSectionHeaders,this.defaultValue.showMarkSectionHeaders),sectionHeaderFontSize:wl.clamp(t.sectionHeaderFontSize??this.defaultValue.sectionHeaderFontSize,4,32),sectionHeaderLetterSpacing:wl.clamp(t.sectionHeaderLetterSpacing??this.defaultValue.sectionHeaderLetterSpacing,0,5)}}}function bNe(s){return s==="ctrlCmd"?Wt?"metaKey":"ctrlKey":"altKey"}class vNe extends sn{constructor(){super(84,"padding",{top:0,bottom:0},{"editor.padding.top":{type:"number",default:0,minimum:0,maximum:1e3,description:b("padding.top","Controls the amount of space between the top edge of the editor and the first line.")},"editor.padding.bottom":{type:"number",default:0,minimum:0,maximum:1e3,description:b("padding.bottom","Controls the amount of space between the bottom edge of the editor and the last line.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{top:Pi.clampedInt(t.top,0,0,1e3),bottom:Pi.clampedInt(t.bottom,0,0,1e3)}}}class wNe extends sn{constructor(){const e={enabled:!0,cycle:!0};super(86,"parameterHints",e,{"editor.parameterHints.enabled":{type:"boolean",default:e.enabled,description:b("parameterHints.enabled","Enables a pop-up that shows parameter documentation and type information as you type.")},"editor.parameterHints.cycle":{type:"boolean",default:e.cycle,description:b("parameterHints.cycle","Controls whether the parameter hints menu cycles or closes when reaching the end of the list.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Ke(t.enabled,this.defaultValue.enabled),cycle:Ke(t.cycle,this.defaultValue.cycle)}}}class CNe extends VE{constructor(){super(144)}compute(e,t,i){return e.pixelRatio}}class yNe extends sn{constructor(){super(88,"placeholder",void 0)}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e:this.defaultValue}}class SNe extends sn{constructor(){const e={other:"on",comments:"off",strings:"off"},t=[{type:"boolean"},{type:"string",enum:["on","inline","off"],enumDescriptions:[b("on","Quick suggestions show inside the suggest widget"),b("inline","Quick suggestions show as ghost text"),b("off","Quick suggestions are disabled")]}];super(90,"quickSuggestions",e,{type:"object",additionalProperties:!1,properties:{strings:{anyOf:t,default:e.strings,description:b("quickSuggestions.strings","Enable quick suggestions inside strings.")},comments:{anyOf:t,default:e.comments,description:b("quickSuggestions.comments","Enable quick suggestions inside comments.")},other:{anyOf:t,default:e.other,description:b("quickSuggestions.other","Enable quick suggestions outside of strings and comments.")}},default:e,markdownDescription:b("quickSuggestions","Controls whether suggestions should automatically show up while typing. This can be controlled for typing in comments, strings, and other code. Quick suggestion can be configured to show as ghost text or with the suggest widget. Also be aware of the {0}-setting which controls if suggestions are triggered by special characters.","`#editor.suggestOnTriggerCharacters#`")}),this.defaultValue=e}validate(e){if(typeof e=="boolean"){const c=e?"on":"off";return{comments:c,strings:c,other:c}}if(!e||typeof e!="object")return this.defaultValue;const{other:t,comments:i,strings:n}=e,r=["on","inline","off"];let o,a,l;return typeof t=="boolean"?o=t?"on":"off":o=xn(t,this.defaultValue.other,r),typeof i=="boolean"?a=i?"on":"off":a=xn(i,this.defaultValue.comments,r),typeof n=="boolean"?l=n?"on":"off":l=xn(n,this.defaultValue.strings,r),{other:o,comments:a,strings:l}}}class xNe extends sn{constructor(){super(68,"lineNumbers",{renderType:1,renderFn:null},{type:"string",enum:["off","on","relative","interval"],enumDescriptions:[b("lineNumbers.off","Line numbers are not rendered."),b("lineNumbers.on","Line numbers are rendered as absolute number."),b("lineNumbers.relative","Line numbers are rendered as distance in lines to cursor position."),b("lineNumbers.interval","Line numbers are rendered every 10 lines.")],default:"on",description:b("lineNumbers","Controls the display of line numbers.")})}validate(e){let t=this.defaultValue.renderType,i=this.defaultValue.renderFn;return typeof e<"u"&&(typeof e=="function"?(t=4,i=e):e==="interval"?t=3:e==="relative"?t=2:e==="on"?t=1:t=0),{renderType:t,renderFn:i}}}function N2(s){const e=s.get(99);return e==="editable"?s.get(92):e!=="on"}class LNe extends sn{constructor(){const e=[],t={type:"number",description:b("rulers.size","Number of monospace characters at which this editor ruler will render.")};super(103,"rulers",e,{type:"array",items:{anyOf:[t,{type:["object"],properties:{column:t,color:{type:"string",description:b("rulers.color","Color of this editor ruler."),format:"color-hex"}}}]},default:e,description:b("rulers","Render vertical rulers after a certain number of monospace characters. Use multiple values for multiple rulers. No rulers are drawn if array is empty.")})}validate(e){if(Array.isArray(e)){const t=[];for(const i of e)if(typeof i=="number")t.push({column:Pi.clampedInt(i,0,0,1e4),color:null});else if(i&&typeof i=="object"){const n=i;t.push({column:Pi.clampedInt(n.column,0,0,1e4),color:n.color})}return t.sort((i,n)=>i.column-n.column),t}return this.defaultValue}}class kNe extends sn{constructor(){super(93,"readOnlyMessage",void 0)}validate(e){return!e||typeof e!="object"?this.defaultValue:e}}function $ee(s,e){if(typeof s!="string")return e;switch(s){case"hidden":return 2;case"visible":return 3;default:return 1}}let INe=class extends sn{constructor(){const e={vertical:1,horizontal:1,arrowSize:11,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:!0,alwaysConsumeMouseWheel:!0,scrollByPage:!1,ignoreHorizontalScrollbarInContentHeight:!1};super(104,"scrollbar",e,{"editor.scrollbar.vertical":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[b("scrollbar.vertical.auto","The vertical scrollbar will be visible only when necessary."),b("scrollbar.vertical.visible","The vertical scrollbar will always be visible."),b("scrollbar.vertical.fit","The vertical scrollbar will always be hidden.")],default:"auto",description:b("scrollbar.vertical","Controls the visibility of the vertical scrollbar.")},"editor.scrollbar.horizontal":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[b("scrollbar.horizontal.auto","The horizontal scrollbar will be visible only when necessary."),b("scrollbar.horizontal.visible","The horizontal scrollbar will always be visible."),b("scrollbar.horizontal.fit","The horizontal scrollbar will always be hidden.")],default:"auto",description:b("scrollbar.horizontal","Controls the visibility of the horizontal scrollbar.")},"editor.scrollbar.verticalScrollbarSize":{type:"number",default:e.verticalScrollbarSize,description:b("scrollbar.verticalScrollbarSize","The width of the vertical scrollbar.")},"editor.scrollbar.horizontalScrollbarSize":{type:"number",default:e.horizontalScrollbarSize,description:b("scrollbar.horizontalScrollbarSize","The height of the horizontal scrollbar.")},"editor.scrollbar.scrollByPage":{type:"boolean",default:e.scrollByPage,description:b("scrollbar.scrollByPage","Controls whether clicks scroll by page or jump to click position.")},"editor.scrollbar.ignoreHorizontalScrollbarInContentHeight":{type:"boolean",default:e.ignoreHorizontalScrollbarInContentHeight,description:b("scrollbar.ignoreHorizontalScrollbarInContentHeight","When set, the horizontal scrollbar will not increase the size of the editor's content.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e,i=Pi.clampedInt(t.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3),n=Pi.clampedInt(t.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:Pi.clampedInt(t.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:$ee(t.vertical,this.defaultValue.vertical),horizontal:$ee(t.horizontal,this.defaultValue.horizontal),useShadows:Ke(t.useShadows,this.defaultValue.useShadows),verticalHasArrows:Ke(t.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:Ke(t.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:Ke(t.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:Ke(t.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize:i,horizontalSliderSize:Pi.clampedInt(t.horizontalSliderSize,i,0,1e3),verticalScrollbarSize:n,verticalSliderSize:Pi.clampedInt(t.verticalSliderSize,n,0,1e3),scrollByPage:Ke(t.scrollByPage,this.defaultValue.scrollByPage),ignoreHorizontalScrollbarInContentHeight:Ke(t.ignoreHorizontalScrollbarInContentHeight,this.defaultValue.ignoreHorizontalScrollbarInContentHeight)}}};const al="inUntrustedWorkspace",$o={allowedCharacters:"editor.unicodeHighlight.allowedCharacters",invisibleCharacters:"editor.unicodeHighlight.invisibleCharacters",nonBasicASCII:"editor.unicodeHighlight.nonBasicASCII",ambiguousCharacters:"editor.unicodeHighlight.ambiguousCharacters",includeComments:"editor.unicodeHighlight.includeComments",includeStrings:"editor.unicodeHighlight.includeStrings",allowedLocales:"editor.unicodeHighlight.allowedLocales"};class ENe extends sn{constructor(){const e={nonBasicASCII:al,invisibleCharacters:!0,ambiguousCharacters:!0,includeComments:al,includeStrings:!0,allowedCharacters:{},allowedLocales:{_os:!0,_vscode:!0}};super(126,"unicodeHighlight",e,{[$o.nonBasicASCII]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,al],default:e.nonBasicASCII,description:b("unicodeHighlight.nonBasicASCII","Controls whether all non-basic ASCII characters are highlighted. Only characters between U+0020 and U+007E, tab, line-feed and carriage-return are considered basic ASCII.")},[$o.invisibleCharacters]:{restricted:!0,type:"boolean",default:e.invisibleCharacters,description:b("unicodeHighlight.invisibleCharacters","Controls whether characters that just reserve space or have no width at all are highlighted.")},[$o.ambiguousCharacters]:{restricted:!0,type:"boolean",default:e.ambiguousCharacters,description:b("unicodeHighlight.ambiguousCharacters","Controls whether characters are highlighted that can be confused with basic ASCII characters, except those that are common in the current user locale.")},[$o.includeComments]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,al],default:e.includeComments,description:b("unicodeHighlight.includeComments","Controls whether characters in comments should also be subject to Unicode highlighting.")},[$o.includeStrings]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,al],default:e.includeStrings,description:b("unicodeHighlight.includeStrings","Controls whether characters in strings should also be subject to Unicode highlighting.")},[$o.allowedCharacters]:{restricted:!0,type:"object",default:e.allowedCharacters,description:b("unicodeHighlight.allowedCharacters","Defines allowed characters that are not being highlighted."),additionalProperties:{type:"boolean"}},[$o.allowedLocales]:{restricted:!0,type:"object",additionalProperties:{type:"boolean"},default:e.allowedLocales,description:b("unicodeHighlight.allowedLocales","Unicode characters that are common in allowed locales are not being highlighted.")}})}applyUpdate(e,t){let i=!1;t.allowedCharacters&&e&&(Ta(e.allowedCharacters,t.allowedCharacters)||(e={...e,allowedCharacters:t.allowedCharacters},i=!0)),t.allowedLocales&&e&&(Ta(e.allowedLocales,t.allowedLocales)||(e={...e,allowedLocales:t.allowedLocales},i=!0));const n=super.applyUpdate(e,t);return i?new EL(n.newValue,!0):n}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{nonBasicASCII:gy(t.nonBasicASCII,al,[!0,!1,al]),invisibleCharacters:Ke(t.invisibleCharacters,this.defaultValue.invisibleCharacters),ambiguousCharacters:Ke(t.ambiguousCharacters,this.defaultValue.ambiguousCharacters),includeComments:gy(t.includeComments,al,[!0,!1,al]),includeStrings:gy(t.includeStrings,al,[!0,!1,al]),allowedCharacters:this.validateBooleanMap(e.allowedCharacters,this.defaultValue.allowedCharacters),allowedLocales:this.validateBooleanMap(e.allowedLocales,this.defaultValue.allowedLocales)}}validateBooleanMap(e,t){if(typeof e!="object"||!e)return t;const i={};for(const[n,r]of Object.entries(e))r===!0&&(i[n]=!0);return i}}class DNe extends sn{constructor(){const e={enabled:!0,mode:"subwordSmart",showToolbar:"onHover",suppressSuggestions:!1,keepOnBlur:!1,fontFamily:"default"};super(62,"inlineSuggest",e,{"editor.inlineSuggest.enabled":{type:"boolean",default:e.enabled,description:b("inlineSuggest.enabled","Controls whether to automatically show inline suggestions in the editor.")},"editor.inlineSuggest.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[b("inlineSuggest.showToolbar.always","Show the inline suggestion toolbar whenever an inline suggestion is shown."),b("inlineSuggest.showToolbar.onHover","Show the inline suggestion toolbar when hovering over an inline suggestion."),b("inlineSuggest.showToolbar.never","Never show the inline suggestion toolbar.")],description:b("inlineSuggest.showToolbar","Controls when to show the inline suggestion toolbar.")},"editor.inlineSuggest.suppressSuggestions":{type:"boolean",default:e.suppressSuggestions,description:b("inlineSuggest.suppressSuggestions","Controls how inline suggestions interact with the suggest widget. If enabled, the suggest widget is not shown automatically when inline suggestions are available.")},"editor.inlineSuggest.fontFamily":{type:"string",default:e.fontFamily,description:b("inlineSuggest.fontFamily","Controls the font family of the inline suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Ke(t.enabled,this.defaultValue.enabled),mode:xn(t.mode,this.defaultValue.mode,["prefix","subword","subwordSmart"]),showToolbar:xn(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),suppressSuggestions:Ke(t.suppressSuggestions,this.defaultValue.suppressSuggestions),keepOnBlur:Ke(t.keepOnBlur,this.defaultValue.keepOnBlur),fontFamily:Gr.string(t.fontFamily,this.defaultValue.fontFamily)}}}class TNe extends sn{constructor(){const e={enabled:!1,showToolbar:"onHover",fontFamily:"default",keepOnBlur:!1};super(63,"experimentalInlineEdit",e,{"editor.experimentalInlineEdit.enabled":{type:"boolean",default:e.enabled,description:b("inlineEdit.enabled","Controls whether to show inline edits in the editor.")},"editor.experimentalInlineEdit.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[b("inlineEdit.showToolbar.always","Show the inline edit toolbar whenever an inline suggestion is shown."),b("inlineEdit.showToolbar.onHover","Show the inline edit toolbar when hovering over an inline suggestion."),b("inlineEdit.showToolbar.never","Never show the inline edit toolbar.")],description:b("inlineEdit.showToolbar","Controls when to show the inline edit toolbar.")},"editor.experimentalInlineEdit.fontFamily":{type:"string",default:e.fontFamily,description:b("inlineEdit.fontFamily","Controls the font family of the inline edit.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Ke(t.enabled,this.defaultValue.enabled),showToolbar:xn(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),fontFamily:Gr.string(t.fontFamily,this.defaultValue.fontFamily),keepOnBlur:Ke(t.keepOnBlur,this.defaultValue.keepOnBlur)}}}class NNe extends sn{constructor(){const e={enabled:xr.bracketPairColorizationOptions.enabled,independentColorPoolPerBracketType:xr.bracketPairColorizationOptions.independentColorPoolPerBracketType};super(15,"bracketPairColorization",e,{"editor.bracketPairColorization.enabled":{type:"boolean",default:e.enabled,markdownDescription:b("bracketPairColorization.enabled","Controls whether bracket pair colorization is enabled or not. Use {0} to override the bracket highlight colors.","`#workbench.colorCustomizations#`")},"editor.bracketPairColorization.independentColorPoolPerBracketType":{type:"boolean",default:e.independentColorPoolPerBracketType,description:b("bracketPairColorization.independentColorPoolPerBracketType","Controls whether each bracket type has its own independent color pool.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Ke(t.enabled,this.defaultValue.enabled),independentColorPoolPerBracketType:Ke(t.independentColorPoolPerBracketType,this.defaultValue.independentColorPoolPerBracketType)}}}class RNe extends sn{constructor(){const e={bracketPairs:!1,bracketPairsHorizontal:"active",highlightActiveBracketPair:!0,indentation:!0,highlightActiveIndentation:!0};super(16,"guides",e,{"editor.guides.bracketPairs":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[b("editor.guides.bracketPairs.true","Enables bracket pair guides."),b("editor.guides.bracketPairs.active","Enables bracket pair guides only for the active bracket pair."),b("editor.guides.bracketPairs.false","Disables bracket pair guides.")],default:e.bracketPairs,description:b("editor.guides.bracketPairs","Controls whether bracket pair guides are enabled or not.")},"editor.guides.bracketPairsHorizontal":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[b("editor.guides.bracketPairsHorizontal.true","Enables horizontal guides as addition to vertical bracket pair guides."),b("editor.guides.bracketPairsHorizontal.active","Enables horizontal guides only for the active bracket pair."),b("editor.guides.bracketPairsHorizontal.false","Disables horizontal bracket pair guides.")],default:e.bracketPairsHorizontal,description:b("editor.guides.bracketPairsHorizontal","Controls whether horizontal bracket pair guides are enabled or not.")},"editor.guides.highlightActiveBracketPair":{type:"boolean",default:e.highlightActiveBracketPair,description:b("editor.guides.highlightActiveBracketPair","Controls whether the editor should highlight the active bracket pair.")},"editor.guides.indentation":{type:"boolean",default:e.indentation,description:b("editor.guides.indentation","Controls whether the editor should render indent guides.")},"editor.guides.highlightActiveIndentation":{type:["boolean","string"],enum:[!0,"always",!1],enumDescriptions:[b("editor.guides.highlightActiveIndentation.true","Highlights the active indent guide."),b("editor.guides.highlightActiveIndentation.always","Highlights the active indent guide even if bracket guides are highlighted."),b("editor.guides.highlightActiveIndentation.false","Do not highlight the active indent guide.")],default:e.highlightActiveIndentation,description:b("editor.guides.highlightActiveIndentation","Controls whether the editor should highlight the active indent guide.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{bracketPairs:gy(t.bracketPairs,this.defaultValue.bracketPairs,[!0,!1,"active"]),bracketPairsHorizontal:gy(t.bracketPairsHorizontal,this.defaultValue.bracketPairsHorizontal,[!0,!1,"active"]),highlightActiveBracketPair:Ke(t.highlightActiveBracketPair,this.defaultValue.highlightActiveBracketPair),indentation:Ke(t.indentation,this.defaultValue.indentation),highlightActiveIndentation:gy(t.highlightActiveIndentation,this.defaultValue.highlightActiveIndentation,[!0,!1,"always"])}}}function gy(s,e,t){const i=t.indexOf(s);return i===-1?e:t[i]}class ANe extends sn{constructor(){const e={insertMode:"insert",filterGraceful:!0,snippetsPreventQuickSuggestions:!1,localityBonus:!1,shareSuggestSelections:!1,selectionMode:"always",showIcons:!0,showStatusBar:!1,preview:!1,previewMode:"subwordSmart",showInlineDetails:!0,showMethods:!0,showFunctions:!0,showConstructors:!0,showDeprecated:!0,matchOnWordStartOnly:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0,showUsers:!0,showIssues:!0};super(119,"suggest",e,{"editor.suggest.insertMode":{type:"string",enum:["insert","replace"],enumDescriptions:[b("suggest.insertMode.insert","Insert suggestion without overwriting text right of the cursor."),b("suggest.insertMode.replace","Insert suggestion and overwrite text right of the cursor.")],default:e.insertMode,description:b("suggest.insertMode","Controls whether words are overwritten when accepting completions. Note that this depends on extensions opting into this feature.")},"editor.suggest.filterGraceful":{type:"boolean",default:e.filterGraceful,description:b("suggest.filterGraceful","Controls whether filtering and sorting suggestions accounts for small typos.")},"editor.suggest.localityBonus":{type:"boolean",default:e.localityBonus,description:b("suggest.localityBonus","Controls whether sorting favors words that appear close to the cursor.")},"editor.suggest.shareSuggestSelections":{type:"boolean",default:e.shareSuggestSelections,markdownDescription:b("suggest.shareSuggestSelections","Controls whether remembered suggestion selections are shared between multiple workspaces and windows (needs `#editor.suggestSelection#`).")},"editor.suggest.selectionMode":{type:"string",enum:["always","never","whenTriggerCharacter","whenQuickSuggestion"],enumDescriptions:[b("suggest.insertMode.always","Always select a suggestion when automatically triggering IntelliSense."),b("suggest.insertMode.never","Never select a suggestion when automatically triggering IntelliSense."),b("suggest.insertMode.whenTriggerCharacter","Select a suggestion only when triggering IntelliSense from a trigger character."),b("suggest.insertMode.whenQuickSuggestion","Select a suggestion only when triggering IntelliSense as you type.")],default:e.selectionMode,markdownDescription:b("suggest.selectionMode","Controls whether a suggestion is selected when the widget shows. Note that this only applies to automatically triggered suggestions ({0} and {1}) and that a suggestion is always selected when explicitly invoked, e.g via `Ctrl+Space`.","`#editor.quickSuggestions#`","`#editor.suggestOnTriggerCharacters#`")},"editor.suggest.snippetsPreventQuickSuggestions":{type:"boolean",default:e.snippetsPreventQuickSuggestions,description:b("suggest.snippetsPreventQuickSuggestions","Controls whether an active snippet prevents quick suggestions.")},"editor.suggest.showIcons":{type:"boolean",default:e.showIcons,description:b("suggest.showIcons","Controls whether to show or hide icons in suggestions.")},"editor.suggest.showStatusBar":{type:"boolean",default:e.showStatusBar,description:b("suggest.showStatusBar","Controls the visibility of the status bar at the bottom of the suggest widget.")},"editor.suggest.preview":{type:"boolean",default:e.preview,description:b("suggest.preview","Controls whether to preview the suggestion outcome in the editor.")},"editor.suggest.showInlineDetails":{type:"boolean",default:e.showInlineDetails,description:b("suggest.showInlineDetails","Controls whether suggest details show inline with the label or only in the details widget.")},"editor.suggest.maxVisibleSuggestions":{type:"number",deprecationMessage:b("suggest.maxVisibleSuggestions.dep","This setting is deprecated. The suggest widget can now be resized.")},"editor.suggest.filteredTypes":{type:"object",deprecationMessage:b("deprecated","This setting is deprecated, please use separate settings like 'editor.suggest.showKeywords' or 'editor.suggest.showSnippets' instead.")},"editor.suggest.showMethods":{type:"boolean",default:!0,markdownDescription:b("editor.suggest.showMethods","When enabled IntelliSense shows `method`-suggestions.")},"editor.suggest.showFunctions":{type:"boolean",default:!0,markdownDescription:b("editor.suggest.showFunctions","When enabled IntelliSense shows `function`-suggestions.")},"editor.suggest.showConstructors":{type:"boolean",default:!0,markdownDescription:b("editor.suggest.showConstructors","When enabled IntelliSense shows `constructor`-suggestions.")},"editor.suggest.showDeprecated":{type:"boolean",default:!0,markdownDescription:b("editor.suggest.showDeprecated","When enabled IntelliSense shows `deprecated`-suggestions.")},"editor.suggest.matchOnWordStartOnly":{type:"boolean",default:!0,markdownDescription:b("editor.suggest.matchOnWordStartOnly","When enabled IntelliSense filtering requires that the first character matches on a word start. For example, `c` on `Console` or `WebContext` but _not_ on `description`. When disabled IntelliSense will show more results but still sorts them by match quality.")},"editor.suggest.showFields":{type:"boolean",default:!0,markdownDescription:b("editor.suggest.showFields","When enabled IntelliSense shows `field`-suggestions.")},"editor.suggest.showVariables":{type:"boolean",default:!0,markdownDescription:b("editor.suggest.showVariables","When enabled IntelliSense shows `variable`-suggestions.")},"editor.suggest.showClasses":{type:"boolean",default:!0,markdownDescription:b("editor.suggest.showClasss","When enabled IntelliSense shows `class`-suggestions.")},"editor.suggest.showStructs":{type:"boolean",default:!0,markdownDescription:b("editor.suggest.showStructs","When enabled IntelliSense shows `struct`-suggestions.")},"editor.suggest.showInterfaces":{type:"boolean",default:!0,markdownDescription:b("editor.suggest.showInterfaces","When enabled IntelliSense shows `interface`-suggestions.")},"editor.suggest.showModules":{type:"boolean",default:!0,markdownDescription:b("editor.suggest.showModules","When enabled IntelliSense shows `module`-suggestions.")},"editor.suggest.showProperties":{type:"boolean",default:!0,markdownDescription:b("editor.suggest.showPropertys","When enabled IntelliSense shows `property`-suggestions.")},"editor.suggest.showEvents":{type:"boolean",default:!0,markdownDescription:b("editor.suggest.showEvents","When enabled IntelliSense shows `event`-suggestions.")},"editor.suggest.showOperators":{type:"boolean",default:!0,markdownDescription:b("editor.suggest.showOperators","When enabled IntelliSense shows `operator`-suggestions.")},"editor.suggest.showUnits":{type:"boolean",default:!0,markdownDescription:b("editor.suggest.showUnits","When enabled IntelliSense shows `unit`-suggestions.")},"editor.suggest.showValues":{type:"boolean",default:!0,markdownDescription:b("editor.suggest.showValues","When enabled IntelliSense shows `value`-suggestions.")},"editor.suggest.showConstants":{type:"boolean",default:!0,markdownDescription:b("editor.suggest.showConstants","When enabled IntelliSense shows `constant`-suggestions.")},"editor.suggest.showEnums":{type:"boolean",default:!0,markdownDescription:b("editor.suggest.showEnums","When enabled IntelliSense shows `enum`-suggestions.")},"editor.suggest.showEnumMembers":{type:"boolean",default:!0,markdownDescription:b("editor.suggest.showEnumMembers","When enabled IntelliSense shows `enumMember`-suggestions.")},"editor.suggest.showKeywords":{type:"boolean",default:!0,markdownDescription:b("editor.suggest.showKeywords","When enabled IntelliSense shows `keyword`-suggestions.")},"editor.suggest.showWords":{type:"boolean",default:!0,markdownDescription:b("editor.suggest.showTexts","When enabled IntelliSense shows `text`-suggestions.")},"editor.suggest.showColors":{type:"boolean",default:!0,markdownDescription:b("editor.suggest.showColors","When enabled IntelliSense shows `color`-suggestions.")},"editor.suggest.showFiles":{type:"boolean",default:!0,markdownDescription:b("editor.suggest.showFiles","When enabled IntelliSense shows `file`-suggestions.")},"editor.suggest.showReferences":{type:"boolean",default:!0,markdownDescription:b("editor.suggest.showReferences","When enabled IntelliSense shows `reference`-suggestions.")},"editor.suggest.showCustomcolors":{type:"boolean",default:!0,markdownDescription:b("editor.suggest.showCustomcolors","When enabled IntelliSense shows `customcolor`-suggestions.")},"editor.suggest.showFolders":{type:"boolean",default:!0,markdownDescription:b("editor.suggest.showFolders","When enabled IntelliSense shows `folder`-suggestions.")},"editor.suggest.showTypeParameters":{type:"boolean",default:!0,markdownDescription:b("editor.suggest.showTypeParameters","When enabled IntelliSense shows `typeParameter`-suggestions.")},"editor.suggest.showSnippets":{type:"boolean",default:!0,markdownDescription:b("editor.suggest.showSnippets","When enabled IntelliSense shows `snippet`-suggestions.")},"editor.suggest.showUsers":{type:"boolean",default:!0,markdownDescription:b("editor.suggest.showUsers","When enabled IntelliSense shows `user`-suggestions.")},"editor.suggest.showIssues":{type:"boolean",default:!0,markdownDescription:b("editor.suggest.showIssues","When enabled IntelliSense shows `issues`-suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{insertMode:xn(t.insertMode,this.defaultValue.insertMode,["insert","replace"]),filterGraceful:Ke(t.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:Ke(t.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:Ke(t.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:Ke(t.shareSuggestSelections,this.defaultValue.shareSuggestSelections),selectionMode:xn(t.selectionMode,this.defaultValue.selectionMode,["always","never","whenQuickSuggestion","whenTriggerCharacter"]),showIcons:Ke(t.showIcons,this.defaultValue.showIcons),showStatusBar:Ke(t.showStatusBar,this.defaultValue.showStatusBar),preview:Ke(t.preview,this.defaultValue.preview),previewMode:xn(t.previewMode,this.defaultValue.previewMode,["prefix","subword","subwordSmart"]),showInlineDetails:Ke(t.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:Ke(t.showMethods,this.defaultValue.showMethods),showFunctions:Ke(t.showFunctions,this.defaultValue.showFunctions),showConstructors:Ke(t.showConstructors,this.defaultValue.showConstructors),showDeprecated:Ke(t.showDeprecated,this.defaultValue.showDeprecated),matchOnWordStartOnly:Ke(t.matchOnWordStartOnly,this.defaultValue.matchOnWordStartOnly),showFields:Ke(t.showFields,this.defaultValue.showFields),showVariables:Ke(t.showVariables,this.defaultValue.showVariables),showClasses:Ke(t.showClasses,this.defaultValue.showClasses),showStructs:Ke(t.showStructs,this.defaultValue.showStructs),showInterfaces:Ke(t.showInterfaces,this.defaultValue.showInterfaces),showModules:Ke(t.showModules,this.defaultValue.showModules),showProperties:Ke(t.showProperties,this.defaultValue.showProperties),showEvents:Ke(t.showEvents,this.defaultValue.showEvents),showOperators:Ke(t.showOperators,this.defaultValue.showOperators),showUnits:Ke(t.showUnits,this.defaultValue.showUnits),showValues:Ke(t.showValues,this.defaultValue.showValues),showConstants:Ke(t.showConstants,this.defaultValue.showConstants),showEnums:Ke(t.showEnums,this.defaultValue.showEnums),showEnumMembers:Ke(t.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:Ke(t.showKeywords,this.defaultValue.showKeywords),showWords:Ke(t.showWords,this.defaultValue.showWords),showColors:Ke(t.showColors,this.defaultValue.showColors),showFiles:Ke(t.showFiles,this.defaultValue.showFiles),showReferences:Ke(t.showReferences,this.defaultValue.showReferences),showFolders:Ke(t.showFolders,this.defaultValue.showFolders),showTypeParameters:Ke(t.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:Ke(t.showSnippets,this.defaultValue.showSnippets),showUsers:Ke(t.showUsers,this.defaultValue.showUsers),showIssues:Ke(t.showIssues,this.defaultValue.showIssues)}}}class PNe extends sn{constructor(){super(114,"smartSelect",{selectLeadingAndTrailingWhitespace:!0,selectSubwords:!0},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:b("selectLeadingAndTrailingWhitespace","Whether leading and trailing whitespace should always be selected."),default:!0,type:"boolean"},"editor.smartSelect.selectSubwords":{description:b("selectSubwords","Whether subwords (like 'foo' in 'fooBar' or 'foo_bar') should be selected."),default:!0,type:"boolean"}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{selectLeadingAndTrailingWhitespace:Ke(e.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace),selectSubwords:Ke(e.selectSubwords,this.defaultValue.selectSubwords)}}}class MNe extends sn{constructor(){const e=[];super(131,"wordSegmenterLocales",e,{anyOf:[{description:b("wordSegmenterLocales","Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"string"},{description:b("wordSegmenterLocales","Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"array",items:{type:"string"}}]})}validate(e){if(typeof e=="string"&&(e=[e]),Array.isArray(e)){const t=[];for(const i of e)if(typeof i=="string")try{Intl.Segmenter.supportedLocalesOf(i).length>0&&t.push(i)}catch{}return t}return this.defaultValue}}class ONe extends sn{constructor(){super(139,"wrappingIndent",1,{"editor.wrappingIndent":{type:"string",enum:["none","same","indent","deepIndent"],enumDescriptions:[b("wrappingIndent.none","No indentation. Wrapped lines begin at column 1."),b("wrappingIndent.same","Wrapped lines get the same indentation as the parent."),b("wrappingIndent.indent","Wrapped lines get +1 indentation toward the parent."),b("wrappingIndent.deepIndent","Wrapped lines get +2 indentation toward the parent.")],description:b("wrappingIndent","Controls the indentation of wrapped lines."),default:"same"}})}validate(e){switch(e){case"none":return 0;case"same":return 1;case"indent":return 2;case"deepIndent":return 3}return 1}compute(e,t,i){return t.get(2)===2?0:i}}class FNe extends VE{constructor(){super(147)}compute(e,t,i){const n=t.get(146);return{isDominatedByLongLines:e.isDominatedByLongLines,isWordWrapMinified:n.isWordWrapMinified,isViewportWrapping:n.isViewportWrapping,wrappingColumn:n.wrappingColumn}}}class VNe extends sn{constructor(){const e={enabled:!0,showDropSelector:"afterDrop"};super(36,"dropIntoEditor",e,{"editor.dropIntoEditor.enabled":{type:"boolean",default:e.enabled,markdownDescription:b("dropIntoEditor.enabled","Controls whether you can drag and drop a file into a text editor by holding down the `Shift` key (instead of opening the file in an editor).")},"editor.dropIntoEditor.showDropSelector":{type:"string",markdownDescription:b("dropIntoEditor.showDropSelector","Controls if a widget is shown when dropping files into the editor. This widget lets you control how the file is dropped."),enum:["afterDrop","never"],enumDescriptions:[b("dropIntoEditor.showDropSelector.afterDrop","Show the drop selector widget after a file is dropped into the editor."),b("dropIntoEditor.showDropSelector.never","Never show the drop selector widget. Instead the default drop provider is always used.")],default:"afterDrop"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Ke(t.enabled,this.defaultValue.enabled),showDropSelector:xn(t.showDropSelector,this.defaultValue.showDropSelector,["afterDrop","never"])}}}class BNe extends sn{constructor(){const e={enabled:!0,showPasteSelector:"afterPaste"};super(85,"pasteAs",e,{"editor.pasteAs.enabled":{type:"boolean",default:e.enabled,markdownDescription:b("pasteAs.enabled","Controls whether you can paste content in different ways.")},"editor.pasteAs.showPasteSelector":{type:"string",markdownDescription:b("pasteAs.showPasteSelector","Controls if a widget is shown when pasting content in to the editor. This widget lets you control how the file is pasted."),enum:["afterPaste","never"],enumDescriptions:[b("pasteAs.showPasteSelector.afterPaste","Show the paste selector widget after content is pasted into the editor."),b("pasteAs.showPasteSelector.never","Never show the paste selector widget. Instead the default pasting behavior is always used.")],default:"afterPaste"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Ke(t.enabled,this.defaultValue.enabled),showPasteSelector:xn(t.showPasteSelector,this.defaultValue.showPasteSelector,["afterPaste","never"])}}}const WNe="Consolas, 'Courier New', monospace",HNe="Menlo, Monaco, 'Courier New', monospace",zNe="'Droid Sans Mono', 'monospace', monospace",yo={fontFamily:Wt?HNe:Lo?zNe:WNe,fontWeight:"normal",fontSize:Wt?12:14,lineHeight:0,letterSpacing:0},yC=[];function Ee(s){return yC[s.id]=s,s}const bu={acceptSuggestionOnCommitCharacter:Ee(new ei(0,"acceptSuggestionOnCommitCharacter",!0,{markdownDescription:b("acceptSuggestionOnCommitCharacter","Controls whether suggestions should be accepted on commit characters. For example, in JavaScript, the semi-colon (`;`) can be a commit character that accepts a suggestion and types that character.")})),acceptSuggestionOnEnter:Ee(new Sn(1,"acceptSuggestionOnEnter","on",["on","smart","off"],{markdownEnumDescriptions:["",b("acceptSuggestionOnEnterSmart","Only accept a suggestion with `Enter` when it makes a textual change."),""],markdownDescription:b("acceptSuggestionOnEnter","Controls whether suggestions should be accepted on `Enter`, in addition to `Tab`. Helps to avoid ambiguity between inserting new lines or accepting suggestions.")})),accessibilitySupport:Ee(new eNe),accessibilityPageSize:Ee(new Pi(3,"accessibilityPageSize",10,1,1073741824,{description:b("accessibilityPageSize","Controls the number of lines in the editor that can be read out by a screen reader at once. When we detect a screen reader we automatically set the default to be 500. Warning: this has a performance implication for numbers larger than the default."),tags:["accessibility"]})),ariaLabel:Ee(new Gr(4,"ariaLabel",b("editorViewAccessibleLabel","Editor content"))),ariaRequired:Ee(new ei(5,"ariaRequired",!1,void 0)),screenReaderAnnounceInlineSuggestion:Ee(new ei(8,"screenReaderAnnounceInlineSuggestion",!0,{description:b("screenReaderAnnounceInlineSuggestion","Control whether inline suggestions are announced by a screen reader."),tags:["accessibility"]})),autoClosingBrackets:Ee(new Sn(6,"autoClosingBrackets","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",b("editor.autoClosingBrackets.languageDefined","Use language configurations to determine when to autoclose brackets."),b("editor.autoClosingBrackets.beforeWhitespace","Autoclose brackets only when the cursor is to the left of whitespace."),""],description:b("autoClosingBrackets","Controls whether the editor should automatically close brackets after the user adds an opening bracket.")})),autoClosingComments:Ee(new Sn(7,"autoClosingComments","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",b("editor.autoClosingComments.languageDefined","Use language configurations to determine when to autoclose comments."),b("editor.autoClosingComments.beforeWhitespace","Autoclose comments only when the cursor is to the left of whitespace."),""],description:b("autoClosingComments","Controls whether the editor should automatically close comments after the user adds an opening comment.")})),autoClosingDelete:Ee(new Sn(9,"autoClosingDelete","auto",["always","auto","never"],{enumDescriptions:["",b("editor.autoClosingDelete.auto","Remove adjacent closing quotes or brackets only if they were automatically inserted."),""],description:b("autoClosingDelete","Controls whether the editor should remove adjacent closing quotes or brackets when deleting.")})),autoClosingOvertype:Ee(new Sn(10,"autoClosingOvertype","auto",["always","auto","never"],{enumDescriptions:["",b("editor.autoClosingOvertype.auto","Type over closing quotes or brackets only if they were automatically inserted."),""],description:b("autoClosingOvertype","Controls whether the editor should type over closing quotes or brackets.")})),autoClosingQuotes:Ee(new Sn(11,"autoClosingQuotes","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",b("editor.autoClosingQuotes.languageDefined","Use language configurations to determine when to autoclose quotes."),b("editor.autoClosingQuotes.beforeWhitespace","Autoclose quotes only when the cursor is to the left of whitespace."),""],description:b("autoClosingQuotes","Controls whether the editor should automatically close quotes after the user adds an opening quote.")})),autoIndent:Ee(new QT(12,"autoIndent",4,"full",["none","keep","brackets","advanced","full"],JTe,{enumDescriptions:[b("editor.autoIndent.none","The editor will not insert indentation automatically."),b("editor.autoIndent.keep","The editor will keep the current line's indentation."),b("editor.autoIndent.brackets","The editor will keep the current line's indentation and honor language defined brackets."),b("editor.autoIndent.advanced","The editor will keep the current line's indentation, honor language defined brackets and invoke special onEnterRules defined by languages."),b("editor.autoIndent.full","The editor will keep the current line's indentation, honor language defined brackets, invoke special onEnterRules defined by languages, and honor indentationRules defined by languages.")],description:b("autoIndent","Controls whether the editor should automatically adjust the indentation when users type, paste, move or indent lines.")})),automaticLayout:Ee(new ei(13,"automaticLayout",!1)),autoSurround:Ee(new Sn(14,"autoSurround","languageDefined",["languageDefined","quotes","brackets","never"],{enumDescriptions:[b("editor.autoSurround.languageDefined","Use language configurations to determine when to automatically surround selections."),b("editor.autoSurround.quotes","Surround with quotes but not brackets."),b("editor.autoSurround.brackets","Surround with brackets but not quotes."),""],description:b("autoSurround","Controls whether the editor should automatically surround selections when typing quotes or brackets.")})),bracketPairColorization:Ee(new NNe),bracketPairGuides:Ee(new RNe),stickyTabStops:Ee(new ei(117,"stickyTabStops",!1,{description:b("stickyTabStops","Emulate selection behavior of tab characters when using spaces for indentation. Selection will stick to tab stops.")})),codeLens:Ee(new ei(17,"codeLens",!0,{description:b("codeLens","Controls whether the editor shows CodeLens.")})),codeLensFontFamily:Ee(new Gr(18,"codeLensFontFamily","",{description:b("codeLensFontFamily","Controls the font family for CodeLens.")})),codeLensFontSize:Ee(new Pi(19,"codeLensFontSize",0,0,100,{type:"number",default:0,minimum:0,maximum:100,markdownDescription:b("codeLensFontSize","Controls the font size in pixels for CodeLens. When set to 0, 90% of `#editor.fontSize#` is used.")})),colorDecorators:Ee(new ei(20,"colorDecorators",!0,{description:b("colorDecorators","Controls whether the editor should render the inline color decorators and color picker.")})),colorDecoratorActivatedOn:Ee(new Sn(149,"colorDecoratorsActivatedOn","clickAndHover",["clickAndHover","hover","click"],{enumDescriptions:[b("editor.colorDecoratorActivatedOn.clickAndHover","Make the color picker appear both on click and hover of the color decorator"),b("editor.colorDecoratorActivatedOn.hover","Make the color picker appear on hover of the color decorator"),b("editor.colorDecoratorActivatedOn.click","Make the color picker appear on click of the color decorator")],description:b("colorDecoratorActivatedOn","Controls the condition to make a color picker appear from a color decorator")})),colorDecoratorsLimit:Ee(new Pi(21,"colorDecoratorsLimit",500,1,1e6,{markdownDescription:b("colorDecoratorsLimit","Controls the max number of color decorators that can be rendered in an editor at once.")})),columnSelection:Ee(new ei(22,"columnSelection",!1,{description:b("columnSelection","Enable that the selection with the mouse and keys is doing column selection.")})),comments:Ee(new tNe),contextmenu:Ee(new ei(24,"contextmenu",!0)),copyWithSyntaxHighlighting:Ee(new ei(25,"copyWithSyntaxHighlighting",!0,{description:b("copyWithSyntaxHighlighting","Controls whether syntax highlighting should be copied into the clipboard.")})),cursorBlinking:Ee(new QT(26,"cursorBlinking",1,"blink",["blink","smooth","phase","expand","solid"],iNe,{description:b("cursorBlinking","Control the cursor animation style.")})),cursorSmoothCaretAnimation:Ee(new Sn(27,"cursorSmoothCaretAnimation","off",["off","explicit","on"],{enumDescriptions:[b("cursorSmoothCaretAnimation.off","Smooth caret animation is disabled."),b("cursorSmoothCaretAnimation.explicit","Smooth caret animation is enabled only when the user moves the cursor with an explicit gesture."),b("cursorSmoothCaretAnimation.on","Smooth caret animation is always enabled.")],description:b("cursorSmoothCaretAnimation","Controls whether the smooth caret animation should be enabled.")})),cursorStyle:Ee(new QT(28,"cursorStyle",Gs.Line,"line",["line","block","underline","line-thin","block-outline","underline-thin"],nNe,{description:b("cursorStyle","Controls the cursor style.")})),cursorSurroundingLines:Ee(new Pi(29,"cursorSurroundingLines",0,0,1073741824,{description:b("cursorSurroundingLines","Controls the minimal number of visible leading lines (minimum 0) and trailing lines (minimum 1) surrounding the cursor. Known as 'scrollOff' or 'scrollOffset' in some other editors.")})),cursorSurroundingLinesStyle:Ee(new Sn(30,"cursorSurroundingLinesStyle","default",["default","all"],{enumDescriptions:[b("cursorSurroundingLinesStyle.default","`cursorSurroundingLines` is enforced only when triggered via the keyboard or API."),b("cursorSurroundingLinesStyle.all","`cursorSurroundingLines` is enforced always.")],markdownDescription:b("cursorSurroundingLinesStyle","Controls when `#editor.cursorSurroundingLines#` should be enforced.")})),cursorWidth:Ee(new Pi(31,"cursorWidth",0,0,1073741824,{markdownDescription:b("cursorWidth","Controls the width of the cursor when `#editor.cursorStyle#` is set to `line`.")})),disableLayerHinting:Ee(new ei(32,"disableLayerHinting",!1)),disableMonospaceOptimizations:Ee(new ei(33,"disableMonospaceOptimizations",!1)),domReadOnly:Ee(new ei(34,"domReadOnly",!1)),dragAndDrop:Ee(new ei(35,"dragAndDrop",!0,{description:b("dragAndDrop","Controls whether the editor should allow moving selections via drag and drop.")})),emptySelectionClipboard:Ee(new rNe),dropIntoEditor:Ee(new VNe),stickyScroll:Ee(new fNe),experimentalWhitespaceRendering:Ee(new Sn(38,"experimentalWhitespaceRendering","svg",["svg","font","off"],{enumDescriptions:[b("experimentalWhitespaceRendering.svg","Use a new rendering method with svgs."),b("experimentalWhitespaceRendering.font","Use a new rendering method with font characters."),b("experimentalWhitespaceRendering.off","Use the stable rendering method.")],description:b("experimentalWhitespaceRendering","Controls whether whitespace is rendered with a new, experimental method.")})),extraEditorClassName:Ee(new Gr(39,"extraEditorClassName","")),fastScrollSensitivity:Ee(new wl(40,"fastScrollSensitivity",5,s=>s<=0?5:s,{markdownDescription:b("fastScrollSensitivity","Scrolling speed multiplier when pressing `Alt`.")})),find:Ee(new oNe),fixedOverflowWidgets:Ee(new ei(42,"fixedOverflowWidgets",!1)),folding:Ee(new ei(43,"folding",!0,{description:b("folding","Controls whether the editor has code folding enabled.")})),foldingStrategy:Ee(new Sn(44,"foldingStrategy","auto",["auto","indentation"],{enumDescriptions:[b("foldingStrategy.auto","Use a language-specific folding strategy if available, else the indentation-based one."),b("foldingStrategy.indentation","Use the indentation-based folding strategy.")],description:b("foldingStrategy","Controls the strategy for computing folding ranges.")})),foldingHighlight:Ee(new ei(45,"foldingHighlight",!0,{description:b("foldingHighlight","Controls whether the editor should highlight folded ranges.")})),foldingImportsByDefault:Ee(new ei(46,"foldingImportsByDefault",!1,{description:b("foldingImportsByDefault","Controls whether the editor automatically collapses import ranges.")})),foldingMaximumRegions:Ee(new Pi(47,"foldingMaximumRegions",5e3,10,65e3,{description:b("foldingMaximumRegions","The maximum number of foldable regions. Increasing this value may result in the editor becoming less responsive when the current source has a large number of foldable regions.")})),unfoldOnClickAfterEndOfLine:Ee(new ei(48,"unfoldOnClickAfterEndOfLine",!1,{description:b("unfoldOnClickAfterEndOfLine","Controls whether clicking on the empty content after a folded line will unfold the line.")})),fontFamily:Ee(new Gr(49,"fontFamily",yo.fontFamily,{description:b("fontFamily","Controls the font family.")})),fontInfo:Ee(new aNe),fontLigatures2:Ee(new Bm),fontSize:Ee(new lNe),fontWeight:Ee(new P7),fontVariations:Ee(new Qk),formatOnPaste:Ee(new ei(55,"formatOnPaste",!1,{description:b("formatOnPaste","Controls whether the editor should automatically format the pasted content. A formatter must be available and the formatter should be able to format a range in a document.")})),formatOnType:Ee(new ei(56,"formatOnType",!1,{description:b("formatOnType","Controls whether the editor should automatically format the line after typing.")})),glyphMargin:Ee(new ei(57,"glyphMargin",!0,{description:b("glyphMargin","Controls whether the editor should render the vertical glyph margin. Glyph margin is mostly used for debugging.")})),gotoLocation:Ee(new cNe),hideCursorInOverviewRuler:Ee(new ei(59,"hideCursorInOverviewRuler",!1,{description:b("hideCursorInOverviewRuler","Controls whether the cursor should be hidden in the overview ruler.")})),hover:Ee(new dNe),inDiffEditor:Ee(new ei(61,"inDiffEditor",!1)),letterSpacing:Ee(new wl(64,"letterSpacing",yo.letterSpacing,s=>wl.clamp(s,-5,20),{description:b("letterSpacing","Controls the letter spacing in pixels.")})),lightbulb:Ee(new hNe),lineDecorationsWidth:Ee(new pNe),lineHeight:Ee(new mNe),lineNumbers:Ee(new xNe),lineNumbersMinChars:Ee(new Pi(69,"lineNumbersMinChars",5,1,300)),linkedEditing:Ee(new ei(70,"linkedEditing",!1,{description:b("linkedEditing","Controls whether the editor has linked editing enabled. Depending on the language, related symbols such as HTML tags, are updated while editing.")})),links:Ee(new ei(71,"links",!0,{description:b("links","Controls whether the editor should detect links and make them clickable.")})),matchBrackets:Ee(new Sn(72,"matchBrackets","always",["always","near","never"],{description:b("matchBrackets","Highlight matching brackets.")})),minimap:Ee(new _Ne),mouseStyle:Ee(new Sn(74,"mouseStyle","text",["text","default","copy"])),mouseWheelScrollSensitivity:Ee(new wl(75,"mouseWheelScrollSensitivity",1,s=>s===0?1:s,{markdownDescription:b("mouseWheelScrollSensitivity","A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")})),mouseWheelZoom:Ee(new ei(76,"mouseWheelZoom",!1,{markdownDescription:Wt?b("mouseWheelZoom.mac","Zoom the font of the editor when using mouse wheel and holding `Cmd`."):b("mouseWheelZoom","Zoom the font of the editor when using mouse wheel and holding `Ctrl`.")})),multiCursorMergeOverlapping:Ee(new ei(77,"multiCursorMergeOverlapping",!0,{description:b("multiCursorMergeOverlapping","Merge multiple cursors when they are overlapping.")})),multiCursorModifier:Ee(new QT(78,"multiCursorModifier","altKey","alt",["ctrlCmd","alt"],bNe,{markdownEnumDescriptions:[b("multiCursorModifier.ctrlCmd","Maps to `Control` on Windows and Linux and to `Command` on macOS."),b("multiCursorModifier.alt","Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],markdownDescription:b({key:"multiCursorModifier",comment:["- `ctrlCmd` refers to a value the setting can take and should not be localized.","- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized."]},"The modifier to be used to add multiple cursors with the mouse. The Go to Definition and Open Link mouse gestures will adapt such that they do not conflict with the [multicursor modifier](https://code.visualstudio.com/docs/editor/codebasics#_multicursor-modifier).")})),multiCursorPaste:Ee(new Sn(79,"multiCursorPaste","spread",["spread","full"],{markdownEnumDescriptions:[b("multiCursorPaste.spread","Each cursor pastes a single line of the text."),b("multiCursorPaste.full","Each cursor pastes the full text.")],markdownDescription:b("multiCursorPaste","Controls pasting when the line count of the pasted text matches the cursor count.")})),multiCursorLimit:Ee(new Pi(80,"multiCursorLimit",1e4,1,1e5,{markdownDescription:b("multiCursorLimit","Controls the max number of cursors that can be in an active editor at once.")})),occurrencesHighlight:Ee(new Sn(81,"occurrencesHighlight","singleFile",["off","singleFile","multiFile"],{markdownEnumDescriptions:[b("occurrencesHighlight.off","Does not highlight occurrences."),b("occurrencesHighlight.singleFile","Highlights occurrences only in the current file."),b("occurrencesHighlight.multiFile","Experimental: Highlights occurrences across all valid open files.")],markdownDescription:b("occurrencesHighlight","Controls whether occurrences should be highlighted across open files.")})),overviewRulerBorder:Ee(new ei(82,"overviewRulerBorder",!0,{description:b("overviewRulerBorder","Controls whether a border should be drawn around the overview ruler.")})),overviewRulerLanes:Ee(new Pi(83,"overviewRulerLanes",3,0,3)),padding:Ee(new vNe),pasteAs:Ee(new BNe),parameterHints:Ee(new wNe),peekWidgetDefaultFocus:Ee(new Sn(87,"peekWidgetDefaultFocus","tree",["tree","editor"],{enumDescriptions:[b("peekWidgetDefaultFocus.tree","Focus the tree when opening peek"),b("peekWidgetDefaultFocus.editor","Focus the editor when opening peek")],description:b("peekWidgetDefaultFocus","Controls whether to focus the inline editor or the tree in the peek widget.")})),placeholder:Ee(new yNe),definitionLinkOpensInPeek:Ee(new ei(89,"definitionLinkOpensInPeek",!1,{description:b("definitionLinkOpensInPeek","Controls whether the Go to Definition mouse gesture always opens the peek widget.")})),quickSuggestions:Ee(new SNe),quickSuggestionsDelay:Ee(new Pi(91,"quickSuggestionsDelay",10,0,1073741824,{description:b("quickSuggestionsDelay","Controls the delay in milliseconds after which quick suggestions will show up.")})),readOnly:Ee(new ei(92,"readOnly",!1)),readOnlyMessage:Ee(new kNe),renameOnType:Ee(new ei(94,"renameOnType",!1,{description:b("renameOnType","Controls whether the editor auto renames on type."),markdownDeprecationMessage:b("renameOnTypeDeprecate","Deprecated, use `editor.linkedEditing` instead.")})),renderControlCharacters:Ee(new ei(95,"renderControlCharacters",!0,{description:b("renderControlCharacters","Controls whether the editor should render control characters."),restricted:!0})),renderFinalNewline:Ee(new Sn(96,"renderFinalNewline",Lo?"dimmed":"on",["off","on","dimmed"],{description:b("renderFinalNewline","Render last line number when the file ends with a newline.")})),renderLineHighlight:Ee(new Sn(97,"renderLineHighlight","line",["none","gutter","line","all"],{enumDescriptions:["","","",b("renderLineHighlight.all","Highlights both the gutter and the current line.")],description:b("renderLineHighlight","Controls how the editor should render the current line highlight.")})),renderLineHighlightOnlyWhenFocus:Ee(new ei(98,"renderLineHighlightOnlyWhenFocus",!1,{description:b("renderLineHighlightOnlyWhenFocus","Controls if the editor should render the current line highlight only when the editor is focused.")})),renderValidationDecorations:Ee(new Sn(99,"renderValidationDecorations","editable",["editable","on","off"])),renderWhitespace:Ee(new Sn(100,"renderWhitespace","selection",["none","boundary","selection","trailing","all"],{enumDescriptions:["",b("renderWhitespace.boundary","Render whitespace characters except for single spaces between words."),b("renderWhitespace.selection","Render whitespace characters only on selected text."),b("renderWhitespace.trailing","Render only trailing whitespace characters."),""],description:b("renderWhitespace","Controls how the editor should render whitespace characters.")})),revealHorizontalRightPadding:Ee(new Pi(101,"revealHorizontalRightPadding",15,0,1e3)),roundedSelection:Ee(new ei(102,"roundedSelection",!0,{description:b("roundedSelection","Controls whether selections should have rounded corners.")})),rulers:Ee(new LNe),scrollbar:Ee(new INe),scrollBeyondLastColumn:Ee(new Pi(105,"scrollBeyondLastColumn",4,0,1073741824,{description:b("scrollBeyondLastColumn","Controls the number of extra characters beyond which the editor will scroll horizontally.")})),scrollBeyondLastLine:Ee(new ei(106,"scrollBeyondLastLine",!0,{description:b("scrollBeyondLastLine","Controls whether the editor will scroll beyond the last line.")})),scrollPredominantAxis:Ee(new ei(107,"scrollPredominantAxis",!0,{description:b("scrollPredominantAxis","Scroll only along the predominant axis when scrolling both vertically and horizontally at the same time. Prevents horizontal drift when scrolling vertically on a trackpad.")})),selectionClipboard:Ee(new ei(108,"selectionClipboard",!0,{description:b("selectionClipboard","Controls whether the Linux primary clipboard should be supported."),included:Lo})),selectionHighlight:Ee(new ei(109,"selectionHighlight",!0,{description:b("selectionHighlight","Controls whether the editor should highlight matches similar to the selection.")})),selectOnLineNumbers:Ee(new ei(110,"selectOnLineNumbers",!0)),showFoldingControls:Ee(new Sn(111,"showFoldingControls","mouseover",["always","never","mouseover"],{enumDescriptions:[b("showFoldingControls.always","Always show the folding controls."),b("showFoldingControls.never","Never show the folding controls and reduce the gutter size."),b("showFoldingControls.mouseover","Only show the folding controls when the mouse is over the gutter.")],description:b("showFoldingControls","Controls when the folding controls on the gutter are shown.")})),showUnused:Ee(new ei(112,"showUnused",!0,{description:b("showUnused","Controls fading out of unused code.")})),showDeprecated:Ee(new ei(141,"showDeprecated",!0,{description:b("showDeprecated","Controls strikethrough deprecated variables.")})),inlayHints:Ee(new gNe),snippetSuggestions:Ee(new Sn(113,"snippetSuggestions","inline",["top","bottom","inline","none"],{enumDescriptions:[b("snippetSuggestions.top","Show snippet suggestions on top of other suggestions."),b("snippetSuggestions.bottom","Show snippet suggestions below other suggestions."),b("snippetSuggestions.inline","Show snippets suggestions with other suggestions."),b("snippetSuggestions.none","Do not show snippet suggestions.")],description:b("snippetSuggestions","Controls whether snippets are shown with other suggestions and how they are sorted.")})),smartSelect:Ee(new PNe),smoothScrolling:Ee(new ei(115,"smoothScrolling",!1,{description:b("smoothScrolling","Controls whether the editor will scroll using an animation.")})),stopRenderingLineAfter:Ee(new Pi(118,"stopRenderingLineAfter",1e4,-1,1073741824)),suggest:Ee(new ANe),inlineSuggest:Ee(new DNe),inlineEdit:Ee(new TNe),inlineCompletionsAccessibilityVerbose:Ee(new ei(150,"inlineCompletionsAccessibilityVerbose",!1,{description:b("inlineCompletionsAccessibilityVerbose","Controls whether the accessibility hint should be provided to screen reader users when an inline completion is shown.")})),suggestFontSize:Ee(new Pi(120,"suggestFontSize",0,0,1e3,{markdownDescription:b("suggestFontSize","Font size for the suggest widget. When set to {0}, the value of {1} is used.","`0`","`#editor.fontSize#`")})),suggestLineHeight:Ee(new Pi(121,"suggestLineHeight",0,0,1e3,{markdownDescription:b("suggestLineHeight","Line height for the suggest widget. When set to {0}, the value of {1} is used. The minimum value is 8.","`0`","`#editor.lineHeight#`")})),suggestOnTriggerCharacters:Ee(new ei(122,"suggestOnTriggerCharacters",!0,{description:b("suggestOnTriggerCharacters","Controls whether suggestions should automatically show up when typing trigger characters.")})),suggestSelection:Ee(new Sn(123,"suggestSelection","first",["first","recentlyUsed","recentlyUsedByPrefix"],{markdownEnumDescriptions:[b("suggestSelection.first","Always select the first suggestion."),b("suggestSelection.recentlyUsed","Select recent suggestions unless further typing selects one, e.g. `console.| -> console.log` because `log` has been completed recently."),b("suggestSelection.recentlyUsedByPrefix","Select suggestions based on previous prefixes that have completed those suggestions, e.g. `co -> console` and `con -> const`.")],description:b("suggestSelection","Controls how suggestions are pre-selected when showing the suggest list.")})),tabCompletion:Ee(new Sn(124,"tabCompletion","off",["on","off","onlySnippets"],{enumDescriptions:[b("tabCompletion.on","Tab complete will insert the best matching suggestion when pressing tab."),b("tabCompletion.off","Disable tab completions."),b("tabCompletion.onlySnippets","Tab complete snippets when their prefix match. Works best when 'quickSuggestions' aren't enabled.")],description:b("tabCompletion","Enables tab completions.")})),tabIndex:Ee(new Pi(125,"tabIndex",0,-1,1073741824)),unicodeHighlight:Ee(new ENe),unusualLineTerminators:Ee(new Sn(127,"unusualLineTerminators","prompt",["auto","off","prompt"],{enumDescriptions:[b("unusualLineTerminators.auto","Unusual line terminators are automatically removed."),b("unusualLineTerminators.off","Unusual line terminators are ignored."),b("unusualLineTerminators.prompt","Unusual line terminators prompt to be removed.")],description:b("unusualLineTerminators","Remove unusual line terminators that might cause problems.")})),useShadowDOM:Ee(new ei(128,"useShadowDOM",!0)),useTabStops:Ee(new ei(129,"useTabStops",!0,{description:b("useTabStops","Spaces and tabs are inserted and deleted in alignment with tab stops.")})),wordBreak:Ee(new Sn(130,"wordBreak","normal",["normal","keepAll"],{markdownEnumDescriptions:[b("wordBreak.normal","Use the default line break rule."),b("wordBreak.keepAll","Word breaks should not be used for Chinese/Japanese/Korean (CJK) text. Non-CJK text behavior is the same as for normal.")],description:b("wordBreak","Controls the word break rules used for Chinese/Japanese/Korean (CJK) text.")})),wordSegmenterLocales:Ee(new MNe),wordSeparators:Ee(new Gr(132,"wordSeparators",T2,{description:b("wordSeparators","Characters that will be used as word separators when doing word related navigations or operations.")})),wordWrap:Ee(new Sn(133,"wordWrap","off",["off","on","wordWrapColumn","bounded"],{markdownEnumDescriptions:[b("wordWrap.off","Lines will never wrap."),b("wordWrap.on","Lines will wrap at the viewport width."),b({key:"wordWrap.wordWrapColumn",comment:["- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at `#editor.wordWrapColumn#`."),b({key:"wordWrap.bounded",comment:["- viewport means the edge of the visible window size.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at the minimum of viewport and `#editor.wordWrapColumn#`.")],description:b({key:"wordWrap",comment:["- 'off', 'on', 'wordWrapColumn' and 'bounded' refer to values the setting can take and should not be localized.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Controls how lines should wrap.")})),wordWrapBreakAfterCharacters:Ee(new Gr(134,"wordWrapBreakAfterCharacters"," 	})]?|/&.,;¢°′″‰℃、。｡､￠，．：；？！％・･ゝゞヽヾーァィゥェォッャュョヮヵヶぁぃぅぇぉっゃゅょゎゕゖㇰㇱㇲㇳㇴㇵㇶㇷㇸㇹㇺㇻㇼㇽㇾㇿ々〻ｧｨｩｪｫｬｭｮｯｰ”〉》」』】〕）］｝｣")),wordWrapBreakBeforeCharacters:Ee(new Gr(135,"wordWrapBreakBeforeCharacters","([{‘“〈《「『【〔（［｛｢£¥＄￡￥+＋")),wordWrapColumn:Ee(new Pi(136,"wordWrapColumn",80,1,1073741824,{markdownDescription:b({key:"wordWrapColumn",comment:["- `editor.wordWrap` refers to a different setting and should not be localized.","- 'wordWrapColumn' and 'bounded' refer to values the different setting can take and should not be localized."]},"Controls the wrapping column of the editor when `#editor.wordWrap#` is `wordWrapColumn` or `bounded`.")})),wordWrapOverride1:Ee(new Sn(137,"wordWrapOverride1","inherit",["off","on","inherit"])),wordWrapOverride2:Ee(new Sn(138,"wordWrapOverride2","inherit",["off","on","inherit"])),editorClassName:Ee(new sNe),defaultColorDecorators:Ee(new ei(148,"defaultColorDecorators",!1,{markdownDescription:b("defaultColorDecorators","Controls whether inline color decorations should be shown using the default document color provider")})),pixelRatio:Ee(new CNe),tabFocusMode:Ee(new ei(145,"tabFocusMode",!1,{markdownDescription:b("tabFocusMode","Controls whether the editor receives tabs or defers them to the workbench for navigation.")})),layoutInfo:Ee(new fy),wrappingInfo:Ee(new FNe),wrappingIndent:Ee(new ONe),wrappingStrategy:Ee(new uNe)};class UNe{constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout(()=>{throw e.stack?d1.isErrorNoTelemetry(e)?new d1(e.message+`

`+e.stack):new Error(e.message+`

`+e.stack):e},0)}}emit(e){this.listeners.forEach(t=>{t(e)})}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}}const due=new UNe;function ft(s){xc(s)||due.onUnexpectedError(s)}function Mn(s){xc(s)||due.onUnexpectedExternalError(s)}function qee(s){if(s instanceof Error){const{name:e,message:t}=s,i=s.stacktrace||s.stack;return{$isError:!0,name:e,message:t,stack:i,noTelemetry:d1.isErrorNoTelemetry(s)}}return s}const R2="Canceled";function xc(s){return s instanceof od?!0:s instanceof Error&&s.name===R2&&s.message===R2}class od extends Error{constructor(){super(R2),this.name=this.message}}function jNe(){const s=new Error(R2);return s.name=s.message,s}function fc(s){return s?new Error(`Illegal argument: ${s}`):new Error("Illegal argument")}function yq(s){return s?new Error(`Illegal state: ${s}`):new Error("Illegal state")}class $Ne extends Error{constructor(e){super("NotSupported"),e&&(this.message=e)}}class d1 extends Error{constructor(e){super(e),this.name="CodeExpectedError"}static fromError(e){if(e instanceof d1)return e;const t=new d1;return t.message=e.message,t.stack=e.stack,t}static isErrorNoTelemetry(e){return e.name==="CodeExpectedError"}}class di extends Error{constructor(e){super(e||"An unexpected bug occurred."),Object.setPrototypeOf(this,di.prototype)}}function Wm(s,e){const t=this;let i=!1,n;return function(){return i||(i=!0,n=s.apply(t,arguments)),n}}function Y4(s){return typeof s=="object"&&s!==null&&typeof s.dispose=="function"&&s.dispose.length===0}function Ni(s){if(Kt.is(s)){const e=[];for(const t of s)if(t)try{t.dispose()}catch(i){e.push(i)}if(e.length===1)throw e[0];if(e.length>1)throw new AggregateError(e,"Encountered errors while disposing of store");return Array.isArray(s)?[]:s}else if(s)return s.dispose(),s}function id(...s){return Ye(()=>Ni(s))}function Ye(s){return{dispose:Wm(()=>{s()})}}const DM=class DM{constructor(){this._toDispose=new Set,this._isDisposed=!1}dispose(){this._isDisposed||(this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{Ni(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return this._isDisposed?DM.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}deleteAndLeak(e){e&&this._toDispose.has(e)&&this._toDispose.delete(e)}};DM.DISABLE_DISPOSED_WARNING=!1;let ce=DM;const sY=class sY{constructor(){this._store=new ce,this._store}dispose(){this._store.dispose()}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}};sY.None=Object.freeze({dispose(){}});let te=sY;class Es{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(e){var t;this._isDisposed||e===this._value||((t=this._value)==null||t.dispose(),this._value=e)}clear(){this.value=void 0}dispose(){var e;this._isDisposed=!0,(e=this._value)==null||e.dispose(),this._value=void 0}}class qNe{constructor(e){this._disposable=e,this._counter=1}acquire(){return this._counter++,this}release(){return--this._counter===0&&this._disposable.dispose(),this}}class KNe{constructor(e){this.object=e}dispose(){}}class Sq{constructor(){this._store=new Map,this._isDisposed=!1}dispose(){this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{Ni(this._store.values())}finally{this._store.clear()}}get(e){return this._store.get(e)}set(e,t,i=!1){var n;this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),i||(n=this._store.get(e))==null||n.dispose(),this._store.set(e,t)}deleteAndDispose(e){var t;(t=this._store.get(e))==null||t.dispose(),this._store.delete(e)}[Symbol.iterator](){return this._store[Symbol.iterator]()}}const GNe=globalThis.performance&&typeof globalThis.performance.now=="function";class Bs{static create(e){return new Bs(e)}constructor(e){this._now=GNe&&e===!1?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}}var De;(function(s){s.None=()=>te.None;function e(B,ee){return h(B,()=>{},0,void 0,!0,void 0,ee)}s.defer=e;function t(B){return(ee,re=null,pe)=>{let Ie=!1,ge;return ge=B(_e=>{if(!Ie)return ge?ge.dispose():Ie=!0,ee.call(re,_e)},null,pe),Ie&&ge.dispose(),ge}}s.once=t;function i(B,ee){return s.once(s.filter(B,ee))}s.onceIf=i;function n(B,ee,re){return d((pe,Ie=null,ge)=>B(_e=>pe.call(Ie,ee(_e)),null,ge),re)}s.map=n;function r(B,ee,re){return d((pe,Ie=null,ge)=>B(_e=>{ee(_e),pe.call(Ie,_e)},null,ge),re)}s.forEach=r;function o(B,ee,re){return d((pe,Ie=null,ge)=>B(_e=>ee(_e)&&pe.call(Ie,_e),null,ge),re)}s.filter=o;function a(B){return B}s.signal=a;function l(...B){return(ee,re=null,pe)=>{const Ie=id(...B.map(ge=>ge(_e=>ee.call(re,_e))));return u(Ie,pe)}}s.any=l;function c(B,ee,re,pe){let Ie=re;return n(B,ge=>(Ie=ee(Ie,ge),Ie),pe)}s.reduce=c;function d(B,ee){let re;const pe={onWillAddFirstListener(){re=B(Ie.fire,Ie)},onDidRemoveLastListener(){re==null||re.dispose()}},Ie=new Z(pe);return ee==null||ee.add(Ie),Ie.event}function u(B,ee){return ee instanceof Array?ee.push(B):ee&&ee.add(B),B}function h(B,ee,re=100,pe=!1,Ie=!1,ge,_e){let Re,J,we,Ae=0,ot;const tt={leakWarningThreshold:ge,onWillAddFirstListener(){Re=B(si=>{Ae++,J=ee(J,si),pe&&!we&&(It.fire(J),J=void 0),ot=()=>{const ai=J;J=void 0,we=void 0,(!pe||Ae>1)&&It.fire(ai),Ae=0},typeof re=="number"?(clearTimeout(we),we=setTimeout(ot,re)):we===void 0&&(we=0,queueMicrotask(ot))})},onWillRemoveListener(){Ie&&Ae>0&&(ot==null||ot())},onDidRemoveLastListener(){ot=void 0,Re.dispose()}},It=new Z(tt);return _e==null||_e.add(It),It.event}s.debounce=h;function g(B,ee=0,re){return s.debounce(B,(pe,Ie)=>pe?(pe.push(Ie),pe):[Ie],ee,void 0,!0,void 0,re)}s.accumulate=g;function p(B,ee=(pe,Ie)=>pe===Ie,re){let pe=!0,Ie;return o(B,ge=>{const _e=pe||!ee(ge,Ie);return pe=!1,Ie=ge,_e},re)}s.latch=p;function _(B,ee,re){return[s.filter(B,ee,re),s.filter(B,pe=>!ee(pe),re)]}s.split=_;function v(B,ee=!1,re=[],pe){let Ie=re.slice(),ge=B(J=>{Ie?Ie.push(J):Re.fire(J)});pe&&pe.add(ge);const _e=()=>{Ie==null||Ie.forEach(J=>Re.fire(J)),Ie=null},Re=new Z({onWillAddFirstListener(){ge||(ge=B(J=>Re.fire(J)),pe&&pe.add(ge))},onDidAddFirstListener(){Ie&&(ee?setTimeout(_e):_e())},onDidRemoveLastListener(){ge&&ge.dispose(),ge=null}});return pe&&pe.add(Re),Re.event}s.buffer=v;function C(B,ee){return(pe,Ie,ge)=>{const _e=ee(new x);return B(function(Re){const J=_e.evaluate(Re);J!==y&&pe.call(Ie,J)},void 0,ge)}}s.chain=C;const y=Symbol("HaltChainable");class x{constructor(){this.steps=[]}map(ee){return this.steps.push(ee),this}forEach(ee){return this.steps.push(re=>(ee(re),re)),this}filter(ee){return this.steps.push(re=>ee(re)?re:y),this}reduce(ee,re){let pe=re;return this.steps.push(Ie=>(pe=ee(pe,Ie),pe)),this}latch(ee=(re,pe)=>re===pe){let re=!0,pe;return this.steps.push(Ie=>{const ge=re||!ee(Ie,pe);return re=!1,pe=Ie,ge?Ie:y}),this}evaluate(ee){for(const re of this.steps)if(ee=re(ee),ee===y)break;return ee}}function L(B,ee,re=pe=>pe){const pe=(...Re)=>_e.fire(re(...Re)),Ie=()=>B.on(ee,pe),ge=()=>B.removeListener(ee,pe),_e=new Z({onWillAddFirstListener:Ie,onDidRemoveLastListener:ge});return _e.event}s.fromNodeEventEmitter=L;function I(B,ee,re=pe=>pe){const pe=(...Re)=>_e.fire(re(...Re)),Ie=()=>B.addEventListener(ee,pe),ge=()=>B.removeEventListener(ee,pe),_e=new Z({onWillAddFirstListener:Ie,onDidRemoveLastListener:ge});return _e.event}s.fromDOMEventEmitter=I;function A(B){return new Promise(ee=>t(B)(ee))}s.toPromise=A;function D(B){const ee=new Z;return B.then(re=>{ee.fire(re)},()=>{ee.fire(void 0)}).finally(()=>{ee.dispose()}),ee.event}s.fromPromise=D;function N(B,ee){return B(re=>ee.fire(re))}s.forward=N;function R(B,ee,re){return ee(re),B(pe=>ee(pe))}s.runAndSubscribe=R;class W{constructor(ee,re){this._observable=ee,this._counter=0,this._hasChanged=!1;const pe={onWillAddFirstListener:()=>{ee.addObserver(this),this._observable.reportChanges()},onDidRemoveLastListener:()=>{ee.removeObserver(this)}};this.emitter=new Z(pe),re&&re.add(this.emitter)}beginUpdate(ee){this._counter++}handlePossibleChange(ee){}handleChange(ee,re){this._hasChanged=!0}endUpdate(ee){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function H(B,ee){return new W(B,ee).emitter.event}s.fromObservable=H;function U(B){return(ee,re,pe)=>{let Ie=0,ge=!1;const _e={beginUpdate(){Ie++},endUpdate(){Ie--,Ie===0&&(B.reportChanges(),ge&&(ge=!1,ee.call(re)))},handlePossibleChange(){},handleChange(){ge=!0}};B.addObserver(_e),B.reportChanges();const Re={dispose(){B.removeObserver(_e)}};return pe instanceof ce?pe.add(Re):Array.isArray(pe)&&pe.push(Re),Re}}s.fromObservableLight=U})(De||(De={}));const KC=class KC{constructor(e){this.listenerCount=0,this.invocationCount=0,this.elapsedOverall=0,this.durations=[],this.name=`${e}_${KC._idPool++}`,KC.all.add(this)}start(e){this._stopWatch=new Bs,this.listenerCount=e}stop(){if(this._stopWatch){const e=this._stopWatch.elapsed();this.durations.push(e),this.elapsedOverall+=e,this.invocationCount+=1,this._stopWatch=void 0}}};KC.all=new Set,KC._idPool=0;let M7=KC,QNe=-1;const TM=class TM{constructor(e,t,i=(TM._idPool++).toString(16).padStart(3,"0")){this._errorHandler=e,this.threshold=t,this.name=i,this._warnCountdown=0}dispose(){var e;(e=this._stacks)==null||e.clear()}check(e,t){const i=this.threshold;if(i<=0||t<i)return;this._stacks||(this._stacks=new Map);const n=this._stacks.get(e.value)||0;if(this._stacks.set(e.value,n+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=i*.5;const[r,o]=this.getMostFrequentStack(),a=`[${this.name}] potential listener LEAK detected, having ${t} listeners already. MOST frequent listener (${o}):`;console.warn(a),console.warn(r);const l=new YNe(a,r);this._errorHandler(l)}return()=>{const r=this._stacks.get(e.value)||0;this._stacks.set(e.value,r-1)}}getMostFrequentStack(){if(!this._stacks)return;let e,t=0;for(const[i,n]of this._stacks)(!e||t<n)&&(e=[i,n],t=n);return e}};TM._idPool=1;let O7=TM;class xq{static create(){const e=new Error;return new xq(e.stack??"")}constructor(e){this.value=e}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}}class YNe extends Error{constructor(e,t){super(e),this.name="ListenerLeakError",this.stack=t}}class XNe extends Error{constructor(e,t){super(e),this.name="ListenerRefusalError",this.stack=t}}class j9{constructor(e){this.value=e}}const ZNe=2;let Z=class{constructor(e){var t,i,n,r;this._size=0,this._options=e,this._leakageMon=(t=this._options)!=null&&t.leakWarningThreshold?new O7((e==null?void 0:e.onListenerError)??ft,((i=this._options)==null?void 0:i.leakWarningThreshold)??QNe):void 0,this._perfMon=(n=this._options)!=null&&n._profName?new M7(this._options._profName):void 0,this._deliveryQueue=(r=this._options)==null?void 0:r.deliveryQueue}dispose(){var e,t,i,n;this._disposed||(this._disposed=!0,((e=this._deliveryQueue)==null?void 0:e.current)===this&&this._deliveryQueue.reset(),this._listeners&&(this._listeners=void 0,this._size=0),(i=(t=this._options)==null?void 0:t.onDidRemoveLastListener)==null||i.call(t),(n=this._leakageMon)==null||n.dispose())}get event(){return this._event??(this._event=(e,t,i)=>{var a,l,c,d,u;if(this._leakageMon&&this._size>this._leakageMon.threshold**2){const h=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(h);const g=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1],p=new XNe(`${h}. HINT: Stack shows most frequent listener (${g[1]}-times)`,g[0]);return(((a=this._options)==null?void 0:a.onListenerError)||ft)(p),te.None}if(this._disposed)return te.None;t&&(e=e.bind(t));const n=new j9(e);let r;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(n.stack=xq.create(),r=this._leakageMon.check(n.stack,this._size+1)),this._listeners?this._listeners instanceof j9?(this._deliveryQueue??(this._deliveryQueue=new uue),this._listeners=[this._listeners,n]):this._listeners.push(n):((c=(l=this._options)==null?void 0:l.onWillAddFirstListener)==null||c.call(l,this),this._listeners=n,(u=(d=this._options)==null?void 0:d.onDidAddFirstListener)==null||u.call(d,this)),this._size++;const o=Ye(()=>{r==null||r(),this._removeListener(n)});return i instanceof ce?i.add(o):Array.isArray(i)&&i.push(o),o}),this._event}_removeListener(e){var r,o,a,l;if((o=(r=this._options)==null?void 0:r.onWillRemoveListener)==null||o.call(r,this),!this._listeners)return;if(this._size===1){this._listeners=void 0,(l=(a=this._options)==null?void 0:a.onDidRemoveLastListener)==null||l.call(a,this),this._size=0;return}const t=this._listeners,i=t.indexOf(e);if(i===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,t[i]=void 0;const n=this._deliveryQueue.current===this;if(this._size*ZNe<=t.length){let c=0;for(let d=0;d<t.length;d++)t[d]?t[c++]=t[d]:n&&(this._deliveryQueue.end--,c<this._deliveryQueue.i&&this._deliveryQueue.i--);t.length=c}}_deliver(e,t){var n;if(!e)return;const i=((n=this._options)==null?void 0:n.onListenerError)||ft;if(!i){e.value(t);return}try{e.value(t)}catch(r){i(r)}}_deliverQueue(e){const t=e.current._listeners;for(;e.i<e.end;)this._deliver(t[e.i++],e.value);e.reset()}fire(e){var t,i,n,r;if((t=this._deliveryQueue)!=null&&t.current&&(this._deliverQueue(this._deliveryQueue),(i=this._perfMon)==null||i.stop()),(n=this._perfMon)==null||n.start(this._size),this._listeners)if(this._listeners instanceof j9)this._deliver(this._listeners,e);else{const o=this._deliveryQueue;o.enqueue(this,e,this._listeners.length),this._deliverQueue(o)}(r=this._perfMon)==null||r.stop()}hasListeners(){return this._size>0}};const JNe=()=>new uue;class uue{constructor(){this.i=-1,this.end=0}enqueue(e,t,i){this.i=0,this.end=i,this.current=e,this.value=t}reset(){this.i=this.end,this.current=void 0,this.value=void 0}}class aw extends Z{constructor(e){super(e),this._isPaused=0,this._eventQueue=new _o,this._mergeFn=e==null?void 0:e.merge}pause(){this._isPaused++}resume(){if(this._isPaused!==0&&--this._isPaused===0)if(this._mergeFn){if(this._eventQueue.size>0){const e=Array.from(this._eventQueue);this._eventQueue.clear(),super.fire(this._mergeFn(e))}}else for(;!this._isPaused&&this._eventQueue.size!==0;)super.fire(this._eventQueue.shift())}fire(e){this._size&&(this._isPaused!==0?this._eventQueue.push(e):super.fire(e))}}class hue extends aw{constructor(e){super(e),this._delay=e.delay??100}fire(e){this._handle||(this.pause(),this._handle=setTimeout(()=>{this._handle=void 0,this.resume()},this._delay)),super.fire(e)}}class eRe extends Z{constructor(e){super(e),this._queuedEvents=[],this._mergeFn=e==null?void 0:e.merge}fire(e){this.hasListeners()&&(this._queuedEvents.push(e),this._queuedEvents.length===1&&queueMicrotask(()=>{this._mergeFn?super.fire(this._mergeFn(this._queuedEvents)):this._queuedEvents.forEach(t=>super.fire(t)),this._queuedEvents=[]}))}}class tRe{constructor(){this.hasListeners=!1,this.events=[],this.emitter=new Z({onWillAddFirstListener:()=>this.onFirstListenerAdd(),onDidRemoveLastListener:()=>this.onLastListenerRemove()})}get event(){return this.emitter.event}add(e){const t={event:e,listener:null};return this.events.push(t),this.hasListeners&&this.hook(t),Ye(Wm(()=>{this.hasListeners&&this.unhook(t);const n=this.events.indexOf(t);this.events.splice(n,1)}))}onFirstListenerAdd(){this.hasListeners=!0,this.events.forEach(e=>this.hook(e))}onLastListenerRemove(){this.hasListeners=!1,this.events.forEach(e=>this.unhook(e))}hook(e){e.listener=e.event(t=>this.emitter.fire(t))}unhook(e){var t;(t=e.listener)==null||t.dispose(),e.listener=null}dispose(){var e;this.emitter.dispose();for(const t of this.events)(e=t.listener)==null||e.dispose();this.events=[]}}class BE{constructor(){this.data=[]}wrapEvent(e,t,i){return(n,r,o)=>e(a=>{const l=this.data[this.data.length-1];if(!t){l?l.buffers.push(()=>n.call(r,a)):n.call(r,a);return}const c=l;if(!c){n.call(r,t(i,a));return}c.items??(c.items=[]),c.items.push(a),c.buffers.length===0&&l.buffers.push(()=>{c.reducedResult??(c.reducedResult=i?c.items.reduce(t,i):c.items.reduce(t)),n.call(r,c.reducedResult)})},void 0,o)}bufferEvents(e){const t={buffers:new Array};this.data.push(t);const i=e();return this.data.pop(),t.buffers.forEach(n=>n()),i}}class Kee{constructor(){this.listening=!1,this.inputEvent=De.None,this.inputEventListener=te.None,this.emitter=new Z({onDidAddFirstListener:()=>{this.listening=!0,this.inputEventListener=this.inputEvent(this.emitter.fire,this.emitter)},onDidRemoveLastListener:()=>{this.listening=!1,this.inputEventListener.dispose()}}),this.event=this.emitter.event}set input(e){this.inputEvent=e,this.listening&&(this.inputEventListener.dispose(),this.inputEventListener=e(this.emitter.fire,this.emitter))}dispose(){this.inputEventListener.dispose(),this.emitter.dispose()}}const fue=Object.freeze(function(s,e){const t=setTimeout(s.bind(e),0);return{dispose(){clearTimeout(t)}}});var kt;(function(s){function e(t){return t===s.None||t===s.Cancelled||t instanceof wR?!0:!t||typeof t!="object"?!1:typeof t.isCancellationRequested=="boolean"&&typeof t.onCancellationRequested=="function"}s.isCancellationToken=e,s.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:De.None}),s.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:fue})})(kt||(kt={}));class wR{constructor(){this._isCancelled=!1,this._emitter=null}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?fue:(this._emitter||(this._emitter=new Z),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}}let mn=class{constructor(e){this._token=void 0,this._parentListener=void 0,this._parentListener=e&&e.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new wR),this._token}cancel(){this._token?this._token instanceof wR&&this._token.cancel():this._token=kt.Cancelled}dispose(e=!1){var t;e&&this.cancel(),(t=this._parentListener)==null||t.dispose(),this._token?this._token instanceof wR&&this._token.dispose():this._token=kt.None}};function F7(s){const e=new mn;return s.add({dispose(){e.cancel()}}),e.token}class Lq{constructor(){this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}define(e,t){this._keyCodeToStr[e]=t,this._strToKeyCode[t.toLowerCase()]=e}keyCodeToStr(e){return this._keyCodeToStr[e]}strToKeyCode(e){return this._strToKeyCode[e.toLowerCase()]||0}}const CR=new Lq,V7=new Lq,B7=new Lq,gue=new Array(230),iRe=Object.create(null),nRe=Object.create(null),kq=[];for(let s=0;s<=193;s++)kq[s]=-1;(function(){const s="",e=[[1,0,"None",0,"unknown",0,"VK_UNKNOWN",s,s],[1,1,"Hyper",0,s,0,s,s,s],[1,2,"Super",0,s,0,s,s,s],[1,3,"Fn",0,s,0,s,s,s],[1,4,"FnLock",0,s,0,s,s,s],[1,5,"Suspend",0,s,0,s,s,s],[1,6,"Resume",0,s,0,s,s,s],[1,7,"Turbo",0,s,0,s,s,s],[1,8,"Sleep",0,s,0,"VK_SLEEP",s,s],[1,9,"WakeUp",0,s,0,s,s,s],[0,10,"KeyA",31,"A",65,"VK_A",s,s],[0,11,"KeyB",32,"B",66,"VK_B",s,s],[0,12,"KeyC",33,"C",67,"VK_C",s,s],[0,13,"KeyD",34,"D",68,"VK_D",s,s],[0,14,"KeyE",35,"E",69,"VK_E",s,s],[0,15,"KeyF",36,"F",70,"VK_F",s,s],[0,16,"KeyG",37,"G",71,"VK_G",s,s],[0,17,"KeyH",38,"H",72,"VK_H",s,s],[0,18,"KeyI",39,"I",73,"VK_I",s,s],[0,19,"KeyJ",40,"J",74,"VK_J",s,s],[0,20,"KeyK",41,"K",75,"VK_K",s,s],[0,21,"KeyL",42,"L",76,"VK_L",s,s],[0,22,"KeyM",43,"M",77,"VK_M",s,s],[0,23,"KeyN",44,"N",78,"VK_N",s,s],[0,24,"KeyO",45,"O",79,"VK_O",s,s],[0,25,"KeyP",46,"P",80,"VK_P",s,s],[0,26,"KeyQ",47,"Q",81,"VK_Q",s,s],[0,27,"KeyR",48,"R",82,"VK_R",s,s],[0,28,"KeyS",49,"S",83,"VK_S",s,s],[0,29,"KeyT",50,"T",84,"VK_T",s,s],[0,30,"KeyU",51,"U",85,"VK_U",s,s],[0,31,"KeyV",52,"V",86,"VK_V",s,s],[0,32,"KeyW",53,"W",87,"VK_W",s,s],[0,33,"KeyX",54,"X",88,"VK_X",s,s],[0,34,"KeyY",55,"Y",89,"VK_Y",s,s],[0,35,"KeyZ",56,"Z",90,"VK_Z",s,s],[0,36,"Digit1",22,"1",49,"VK_1",s,s],[0,37,"Digit2",23,"2",50,"VK_2",s,s],[0,38,"Digit3",24,"3",51,"VK_3",s,s],[0,39,"Digit4",25,"4",52,"VK_4",s,s],[0,40,"Digit5",26,"5",53,"VK_5",s,s],[0,41,"Digit6",27,"6",54,"VK_6",s,s],[0,42,"Digit7",28,"7",55,"VK_7",s,s],[0,43,"Digit8",29,"8",56,"VK_8",s,s],[0,44,"Digit9",30,"9",57,"VK_9",s,s],[0,45,"Digit0",21,"0",48,"VK_0",s,s],[1,46,"Enter",3,"Enter",13,"VK_RETURN",s,s],[1,47,"Escape",9,"Escape",27,"VK_ESCAPE",s,s],[1,48,"Backspace",1,"Backspace",8,"VK_BACK",s,s],[1,49,"Tab",2,"Tab",9,"VK_TAB",s,s],[1,50,"Space",10,"Space",32,"VK_SPACE",s,s],[0,51,"Minus",88,"-",189,"VK_OEM_MINUS","-","OEM_MINUS"],[0,52,"Equal",86,"=",187,"VK_OEM_PLUS","=","OEM_PLUS"],[0,53,"BracketLeft",92,"[",219,"VK_OEM_4","[","OEM_4"],[0,54,"BracketRight",94,"]",221,"VK_OEM_6","]","OEM_6"],[0,55,"Backslash",93,"\\",220,"VK_OEM_5","\\","OEM_5"],[0,56,"IntlHash",0,s,0,s,s,s],[0,57,"Semicolon",85,";",186,"VK_OEM_1",";","OEM_1"],[0,58,"Quote",95,"'",222,"VK_OEM_7","'","OEM_7"],[0,59,"Backquote",91,"`",192,"VK_OEM_3","`","OEM_3"],[0,60,"Comma",87,",",188,"VK_OEM_COMMA",",","OEM_COMMA"],[0,61,"Period",89,".",190,"VK_OEM_PERIOD",".","OEM_PERIOD"],[0,62,"Slash",90,"/",191,"VK_OEM_2","/","OEM_2"],[1,63,"CapsLock",8,"CapsLock",20,"VK_CAPITAL",s,s],[1,64,"F1",59,"F1",112,"VK_F1",s,s],[1,65,"F2",60,"F2",113,"VK_F2",s,s],[1,66,"F3",61,"F3",114,"VK_F3",s,s],[1,67,"F4",62,"F4",115,"VK_F4",s,s],[1,68,"F5",63,"F5",116,"VK_F5",s,s],[1,69,"F6",64,"F6",117,"VK_F6",s,s],[1,70,"F7",65,"F7",118,"VK_F7",s,s],[1,71,"F8",66,"F8",119,"VK_F8",s,s],[1,72,"F9",67,"F9",120,"VK_F9",s,s],[1,73,"F10",68,"F10",121,"VK_F10",s,s],[1,74,"F11",69,"F11",122,"VK_F11",s,s],[1,75,"F12",70,"F12",123,"VK_F12",s,s],[1,76,"PrintScreen",0,s,0,s,s,s],[1,77,"ScrollLock",84,"ScrollLock",145,"VK_SCROLL",s,s],[1,78,"Pause",7,"PauseBreak",19,"VK_PAUSE",s,s],[1,79,"Insert",19,"Insert",45,"VK_INSERT",s,s],[1,80,"Home",14,"Home",36,"VK_HOME",s,s],[1,81,"PageUp",11,"PageUp",33,"VK_PRIOR",s,s],[1,82,"Delete",20,"Delete",46,"VK_DELETE",s,s],[1,83,"End",13,"End",35,"VK_END",s,s],[1,84,"PageDown",12,"PageDown",34,"VK_NEXT",s,s],[1,85,"ArrowRight",17,"RightArrow",39,"VK_RIGHT","Right",s],[1,86,"ArrowLeft",15,"LeftArrow",37,"VK_LEFT","Left",s],[1,87,"ArrowDown",18,"DownArrow",40,"VK_DOWN","Down",s],[1,88,"ArrowUp",16,"UpArrow",38,"VK_UP","Up",s],[1,89,"NumLock",83,"NumLock",144,"VK_NUMLOCK",s,s],[1,90,"NumpadDivide",113,"NumPad_Divide",111,"VK_DIVIDE",s,s],[1,91,"NumpadMultiply",108,"NumPad_Multiply",106,"VK_MULTIPLY",s,s],[1,92,"NumpadSubtract",111,"NumPad_Subtract",109,"VK_SUBTRACT",s,s],[1,93,"NumpadAdd",109,"NumPad_Add",107,"VK_ADD",s,s],[1,94,"NumpadEnter",3,s,0,s,s,s],[1,95,"Numpad1",99,"NumPad1",97,"VK_NUMPAD1",s,s],[1,96,"Numpad2",100,"NumPad2",98,"VK_NUMPAD2",s,s],[1,97,"Numpad3",101,"NumPad3",99,"VK_NUMPAD3",s,s],[1,98,"Numpad4",102,"NumPad4",100,"VK_NUMPAD4",s,s],[1,99,"Numpad5",103,"NumPad5",101,"VK_NUMPAD5",s,s],[1,100,"Numpad6",104,"NumPad6",102,"VK_NUMPAD6",s,s],[1,101,"Numpad7",105,"NumPad7",103,"VK_NUMPAD7",s,s],[1,102,"Numpad8",106,"NumPad8",104,"VK_NUMPAD8",s,s],[1,103,"Numpad9",107,"NumPad9",105,"VK_NUMPAD9",s,s],[1,104,"Numpad0",98,"NumPad0",96,"VK_NUMPAD0",s,s],[1,105,"NumpadDecimal",112,"NumPad_Decimal",110,"VK_DECIMAL",s,s],[0,106,"IntlBackslash",97,"OEM_102",226,"VK_OEM_102",s,s],[1,107,"ContextMenu",58,"ContextMenu",93,s,s,s],[1,108,"Power",0,s,0,s,s,s],[1,109,"NumpadEqual",0,s,0,s,s,s],[1,110,"F13",71,"F13",124,"VK_F13",s,s],[1,111,"F14",72,"F14",125,"VK_F14",s,s],[1,112,"F15",73,"F15",126,"VK_F15",s,s],[1,113,"F16",74,"F16",127,"VK_F16",s,s],[1,114,"F17",75,"F17",128,"VK_F17",s,s],[1,115,"F18",76,"F18",129,"VK_F18",s,s],[1,116,"F19",77,"F19",130,"VK_F19",s,s],[1,117,"F20",78,"F20",131,"VK_F20",s,s],[1,118,"F21",79,"F21",132,"VK_F21",s,s],[1,119,"F22",80,"F22",133,"VK_F22",s,s],[1,120,"F23",81,"F23",134,"VK_F23",s,s],[1,121,"F24",82,"F24",135,"VK_F24",s,s],[1,122,"Open",0,s,0,s,s,s],[1,123,"Help",0,s,0,s,s,s],[1,124,"Select",0,s,0,s,s,s],[1,125,"Again",0,s,0,s,s,s],[1,126,"Undo",0,s,0,s,s,s],[1,127,"Cut",0,s,0,s,s,s],[1,128,"Copy",0,s,0,s,s,s],[1,129,"Paste",0,s,0,s,s,s],[1,130,"Find",0,s,0,s,s,s],[1,131,"AudioVolumeMute",117,"AudioVolumeMute",173,"VK_VOLUME_MUTE",s,s],[1,132,"AudioVolumeUp",118,"AudioVolumeUp",175,"VK_VOLUME_UP",s,s],[1,133,"AudioVolumeDown",119,"AudioVolumeDown",174,"VK_VOLUME_DOWN",s,s],[1,134,"NumpadComma",110,"NumPad_Separator",108,"VK_SEPARATOR",s,s],[0,135,"IntlRo",115,"ABNT_C1",193,"VK_ABNT_C1",s,s],[1,136,"KanaMode",0,s,0,s,s,s],[0,137,"IntlYen",0,s,0,s,s,s],[1,138,"Convert",0,s,0,s,s,s],[1,139,"NonConvert",0,s,0,s,s,s],[1,140,"Lang1",0,s,0,s,s,s],[1,141,"Lang2",0,s,0,s,s,s],[1,142,"Lang3",0,s,0,s,s,s],[1,143,"Lang4",0,s,0,s,s,s],[1,144,"Lang5",0,s,0,s,s,s],[1,145,"Abort",0,s,0,s,s,s],[1,146,"Props",0,s,0,s,s,s],[1,147,"NumpadParenLeft",0,s,0,s,s,s],[1,148,"NumpadParenRight",0,s,0,s,s,s],[1,149,"NumpadBackspace",0,s,0,s,s,s],[1,150,"NumpadMemoryStore",0,s,0,s,s,s],[1,151,"NumpadMemoryRecall",0,s,0,s,s,s],[1,152,"NumpadMemoryClear",0,s,0,s,s,s],[1,153,"NumpadMemoryAdd",0,s,0,s,s,s],[1,154,"NumpadMemorySubtract",0,s,0,s,s,s],[1,155,"NumpadClear",131,"Clear",12,"VK_CLEAR",s,s],[1,156,"NumpadClearEntry",0,s,0,s,s,s],[1,0,s,5,"Ctrl",17,"VK_CONTROL",s,s],[1,0,s,4,"Shift",16,"VK_SHIFT",s,s],[1,0,s,6,"Alt",18,"VK_MENU",s,s],[1,0,s,57,"Meta",91,"VK_COMMAND",s,s],[1,157,"ControlLeft",5,s,0,"VK_LCONTROL",s,s],[1,158,"ShiftLeft",4,s,0,"VK_LSHIFT",s,s],[1,159,"AltLeft",6,s,0,"VK_LMENU",s,s],[1,160,"MetaLeft",57,s,0,"VK_LWIN",s,s],[1,161,"ControlRight",5,s,0,"VK_RCONTROL",s,s],[1,162,"ShiftRight",4,s,0,"VK_RSHIFT",s,s],[1,163,"AltRight",6,s,0,"VK_RMENU",s,s],[1,164,"MetaRight",57,s,0,"VK_RWIN",s,s],[1,165,"BrightnessUp",0,s,0,s,s,s],[1,166,"BrightnessDown",0,s,0,s,s,s],[1,167,"MediaPlay",0,s,0,s,s,s],[1,168,"MediaRecord",0,s,0,s,s,s],[1,169,"MediaFastForward",0,s,0,s,s,s],[1,170,"MediaRewind",0,s,0,s,s,s],[1,171,"MediaTrackNext",124,"MediaTrackNext",176,"VK_MEDIA_NEXT_TRACK",s,s],[1,172,"MediaTrackPrevious",125,"MediaTrackPrevious",177,"VK_MEDIA_PREV_TRACK",s,s],[1,173,"MediaStop",126,"MediaStop",178,"VK_MEDIA_STOP",s,s],[1,174,"Eject",0,s,0,s,s,s],[1,175,"MediaPlayPause",127,"MediaPlayPause",179,"VK_MEDIA_PLAY_PAUSE",s,s],[1,176,"MediaSelect",128,"LaunchMediaPlayer",181,"VK_MEDIA_LAUNCH_MEDIA_SELECT",s,s],[1,177,"LaunchMail",129,"LaunchMail",180,"VK_MEDIA_LAUNCH_MAIL",s,s],[1,178,"LaunchApp2",130,"LaunchApp2",183,"VK_MEDIA_LAUNCH_APP2",s,s],[1,179,"LaunchApp1",0,s,0,"VK_MEDIA_LAUNCH_APP1",s,s],[1,180,"SelectTask",0,s,0,s,s,s],[1,181,"LaunchScreenSaver",0,s,0,s,s,s],[1,182,"BrowserSearch",120,"BrowserSearch",170,"VK_BROWSER_SEARCH",s,s],[1,183,"BrowserHome",121,"BrowserHome",172,"VK_BROWSER_HOME",s,s],[1,184,"BrowserBack",122,"BrowserBack",166,"VK_BROWSER_BACK",s,s],[1,185,"BrowserForward",123,"BrowserForward",167,"VK_BROWSER_FORWARD",s,s],[1,186,"BrowserStop",0,s,0,"VK_BROWSER_STOP",s,s],[1,187,"BrowserRefresh",0,s,0,"VK_BROWSER_REFRESH",s,s],[1,188,"BrowserFavorites",0,s,0,"VK_BROWSER_FAVORITES",s,s],[1,189,"ZoomToggle",0,s,0,s,s,s],[1,190,"MailReply",0,s,0,s,s,s],[1,191,"MailForward",0,s,0,s,s,s],[1,192,"MailSend",0,s,0,s,s,s],[1,0,s,114,"KeyInComposition",229,s,s,s],[1,0,s,116,"ABNT_C2",194,"VK_ABNT_C2",s,s],[1,0,s,96,"OEM_8",223,"VK_OEM_8",s,s],[1,0,s,0,s,0,"VK_KANA",s,s],[1,0,s,0,s,0,"VK_HANGUL",s,s],[1,0,s,0,s,0,"VK_JUNJA",s,s],[1,0,s,0,s,0,"VK_FINAL",s,s],[1,0,s,0,s,0,"VK_HANJA",s,s],[1,0,s,0,s,0,"VK_KANJI",s,s],[1,0,s,0,s,0,"VK_CONVERT",s,s],[1,0,s,0,s,0,"VK_NONCONVERT",s,s],[1,0,s,0,s,0,"VK_ACCEPT",s,s],[1,0,s,0,s,0,"VK_MODECHANGE",s,s],[1,0,s,0,s,0,"VK_SELECT",s,s],[1,0,s,0,s,0,"VK_PRINT",s,s],[1,0,s,0,s,0,"VK_EXECUTE",s,s],[1,0,s,0,s,0,"VK_SNAPSHOT",s,s],[1,0,s,0,s,0,"VK_HELP",s,s],[1,0,s,0,s,0,"VK_APPS",s,s],[1,0,s,0,s,0,"VK_PROCESSKEY",s,s],[1,0,s,0,s,0,"VK_PACKET",s,s],[1,0,s,0,s,0,"VK_DBE_SBCSCHAR",s,s],[1,0,s,0,s,0,"VK_DBE_DBCSCHAR",s,s],[1,0,s,0,s,0,"VK_ATTN",s,s],[1,0,s,0,s,0,"VK_CRSEL",s,s],[1,0,s,0,s,0,"VK_EXSEL",s,s],[1,0,s,0,s,0,"VK_EREOF",s,s],[1,0,s,0,s,0,"VK_PLAY",s,s],[1,0,s,0,s,0,"VK_ZOOM",s,s],[1,0,s,0,s,0,"VK_NONAME",s,s],[1,0,s,0,s,0,"VK_PA1",s,s],[1,0,s,0,s,0,"VK_OEM_CLEAR",s,s]],t=[],i=[];for(const n of e){const[r,o,a,l,c,d,u,h,g]=n;if(i[o]||(i[o]=!0,iRe[a]=o,nRe[a.toLowerCase()]=o,r&&(kq[o]=l)),!t[l]){if(t[l]=!0,!c)throw new Error(`String representation missing for key code ${l} around scan code ${a}`);CR.define(l,c),V7.define(l,h||c),B7.define(l,g||h||c)}d&&(gue[d]=l)}})();var Of;(function(s){function e(a){return CR.keyCodeToStr(a)}s.toString=e;function t(a){return CR.strToKeyCode(a)}s.fromString=t;function i(a){return V7.keyCodeToStr(a)}s.toUserSettingsUS=i;function n(a){return B7.keyCodeToStr(a)}s.toUserSettingsGeneral=n;function r(a){return V7.strToKeyCode(a)||B7.strToKeyCode(a)}s.fromUserSettings=r;function o(a){if(a>=98&&a<=113)return null;switch(a){case 16:return"Up";case 18:return"Down";case 15:return"Left";case 17:return"Right"}return CR.keyCodeToStr(a)}s.toElectronAccelerator=o})(Of||(Of={}));function ns(s,e){const t=(e&65535)<<16>>>0;return(s|t)>>>0}var Gee={};let py;const $9=globalThis.vscode;var wae;if(typeof $9<"u"&&typeof $9.process<"u"){const s=$9.process;py={get platform(){return s.platform},get arch(){return s.arch},get env(){return s.env},cwd(){return s.cwd()}}}else typeof process<"u"&&typeof((wae=process==null?void 0:process.versions)==null?void 0:wae.node)=="string"?py={get platform(){return process.platform},get arch(){return process.arch},get env(){return Gee},cwd(){return Gee.VSCODE_CWD||process.cwd()}}:py={get platform(){return gr?"win32":Wt?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};const A2=py.cwd,W7=py.env,sRe=py.platform,rRe=65,oRe=97,aRe=90,lRe=122,am=46,zr=47,rl=92,hp=58,cRe=63;class pue extends Error{constructor(e,t,i){let n;typeof t=="string"&&t.indexOf("not ")===0?(n="must not be",t=t.replace(/^not /,"")):n="must be";const r=e.indexOf(".")!==-1?"property":"argument";let o=`The "${e}" ${r} ${n} of type ${t}`;o+=`. Received type ${typeof i}`,super(o),this.code="ERR_INVALID_ARG_TYPE"}}function dRe(s,e){if(s===null||typeof s!="object")throw new pue(e,"Object",s)}function As(s,e){if(typeof s!="string")throw new pue(e,"string",s)}const Mg=sRe==="win32";function Si(s){return s===zr||s===rl}function H7(s){return s===zr}function fp(s){return s>=rRe&&s<=aRe||s>=oRe&&s<=lRe}function P2(s,e,t,i){let n="",r=0,o=-1,a=0,l=0;for(let c=0;c<=s.length;++c){if(c<s.length)l=s.charCodeAt(c);else{if(i(l))break;l=zr}if(i(l)){if(!(o===c-1||a===1))if(a===2){if(n.length<2||r!==2||n.charCodeAt(n.length-1)!==am||n.charCodeAt(n.length-2)!==am){if(n.length>2){const d=n.lastIndexOf(t);d===-1?(n="",r=0):(n=n.slice(0,d),r=n.length-1-n.lastIndexOf(t)),o=c,a=0;continue}else if(n.length!==0){n="",r=0,o=c,a=0;continue}}e&&(n+=n.length>0?`${t}..`:"..",r=2)}else n.length>0?n+=`${t}${s.slice(o+1,c)}`:n=s.slice(o+1,c),r=c-o-1;o=c,a=0}else l===am&&a!==-1?++a:a=-1}return n}function uRe(s){return s?`${s[0]==="."?"":"."}${s}`:""}function mue(s,e){dRe(e,"pathObject");const t=e.dir||e.root,i=e.base||`${e.name||""}${uRe(e.ext)}`;return t?t===e.root?`${t}${i}`:`${t}${s}${i}`:i}const Yo={resolve(...s){let e="",t="",i=!1;for(let n=s.length-1;n>=-1;n--){let r;if(n>=0){if(r=s[n],As(r,`paths[${n}]`),r.length===0)continue}else e.length===0?r=A2():(r=W7[`=${e}`]||A2(),(r===void 0||r.slice(0,2).toLowerCase()!==e.toLowerCase()&&r.charCodeAt(2)===rl)&&(r=`${e}\\`));const o=r.length;let a=0,l="",c=!1;const d=r.charCodeAt(0);if(o===1)Si(d)&&(a=1,c=!0);else if(Si(d))if(c=!0,Si(r.charCodeAt(1))){let u=2,h=u;for(;u<o&&!Si(r.charCodeAt(u));)u++;if(u<o&&u!==h){const g=r.slice(h,u);for(h=u;u<o&&Si(r.charCodeAt(u));)u++;if(u<o&&u!==h){for(h=u;u<o&&!Si(r.charCodeAt(u));)u++;(u===o||u!==h)&&(l=`\\\\${g}\\${r.slice(h,u)}`,a=u)}}}else a=1;else fp(d)&&r.charCodeAt(1)===hp&&(l=r.slice(0,2),a=2,o>2&&Si(r.charCodeAt(2))&&(c=!0,a=3));if(l.length>0)if(e.length>0){if(l.toLowerCase()!==e.toLowerCase())continue}else e=l;if(i){if(e.length>0)break}else if(t=`${r.slice(a)}\\${t}`,i=c,c&&e.length>0)break}return t=P2(t,!i,"\\",Si),i?`${e}\\${t}`:`${e}${t}`||"."},normalize(s){As(s,"path");const e=s.length;if(e===0)return".";let t=0,i,n=!1;const r=s.charCodeAt(0);if(e===1)return H7(r)?"\\":s;if(Si(r))if(n=!0,Si(s.charCodeAt(1))){let a=2,l=a;for(;a<e&&!Si(s.charCodeAt(a));)a++;if(a<e&&a!==l){const c=s.slice(l,a);for(l=a;a<e&&Si(s.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!Si(s.charCodeAt(a));)a++;if(a===e)return`\\\\${c}\\${s.slice(l)}\\`;a!==l&&(i=`\\\\${c}\\${s.slice(l,a)}`,t=a)}}}else t=1;else fp(r)&&s.charCodeAt(1)===hp&&(i=s.slice(0,2),t=2,e>2&&Si(s.charCodeAt(2))&&(n=!0,t=3));let o=t<e?P2(s.slice(t),!n,"\\",Si):"";return o.length===0&&!n&&(o="."),o.length>0&&Si(s.charCodeAt(e-1))&&(o+="\\"),i===void 0?n?`\\${o}`:o:n?`${i}\\${o}`:`${i}${o}`},isAbsolute(s){As(s,"path");const e=s.length;if(e===0)return!1;const t=s.charCodeAt(0);return Si(t)||e>2&&fp(t)&&s.charCodeAt(1)===hp&&Si(s.charCodeAt(2))},join(...s){if(s.length===0)return".";let e,t;for(let r=0;r<s.length;++r){const o=s[r];As(o,"path"),o.length>0&&(e===void 0?e=t=o:e+=`\\${o}`)}if(e===void 0)return".";let i=!0,n=0;if(typeof t=="string"&&Si(t.charCodeAt(0))){++n;const r=t.length;r>1&&Si(t.charCodeAt(1))&&(++n,r>2&&(Si(t.charCodeAt(2))?++n:i=!1))}if(i){for(;n<e.length&&Si(e.charCodeAt(n));)n++;n>=2&&(e=`\\${e.slice(n)}`)}return Yo.normalize(e)},relative(s,e){if(As(s,"from"),As(e,"to"),s===e)return"";const t=Yo.resolve(s),i=Yo.resolve(e);if(t===i||(s=t.toLowerCase(),e=i.toLowerCase(),s===e))return"";let n=0;for(;n<s.length&&s.charCodeAt(n)===rl;)n++;let r=s.length;for(;r-1>n&&s.charCodeAt(r-1)===rl;)r--;const o=r-n;let a=0;for(;a<e.length&&e.charCodeAt(a)===rl;)a++;let l=e.length;for(;l-1>a&&e.charCodeAt(l-1)===rl;)l--;const c=l-a,d=o<c?o:c;let u=-1,h=0;for(;h<d;h++){const p=s.charCodeAt(n+h);if(p!==e.charCodeAt(a+h))break;p===rl&&(u=h)}if(h!==d){if(u===-1)return i}else{if(c>d){if(e.charCodeAt(a+h)===rl)return i.slice(a+h+1);if(h===2)return i.slice(a+h)}o>d&&(s.charCodeAt(n+h)===rl?u=h:h===2&&(u=3)),u===-1&&(u=0)}let g="";for(h=n+u+1;h<=r;++h)(h===r||s.charCodeAt(h)===rl)&&(g+=g.length===0?"..":"\\..");return a+=u,g.length>0?`${g}${i.slice(a,l)}`:(i.charCodeAt(a)===rl&&++a,i.slice(a,l))},toNamespacedPath(s){if(typeof s!="string"||s.length===0)return s;const e=Yo.resolve(s);if(e.length<=2)return s;if(e.charCodeAt(0)===rl){if(e.charCodeAt(1)===rl){const t=e.charCodeAt(2);if(t!==cRe&&t!==am)return`\\\\?\\UNC\\${e.slice(2)}`}}else if(fp(e.charCodeAt(0))&&e.charCodeAt(1)===hp&&e.charCodeAt(2)===rl)return`\\\\?\\${e}`;return s},dirname(s){As(s,"path");const e=s.length;if(e===0)return".";let t=-1,i=0;const n=s.charCodeAt(0);if(e===1)return Si(n)?s:".";if(Si(n)){if(t=i=1,Si(s.charCodeAt(1))){let a=2,l=a;for(;a<e&&!Si(s.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&Si(s.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!Si(s.charCodeAt(a));)a++;if(a===e)return s;a!==l&&(t=i=a+1)}}}}else fp(n)&&s.charCodeAt(1)===hp&&(t=e>2&&Si(s.charCodeAt(2))?3:2,i=t);let r=-1,o=!0;for(let a=e-1;a>=i;--a)if(Si(s.charCodeAt(a))){if(!o){r=a;break}}else o=!1;if(r===-1){if(t===-1)return".";r=t}return s.slice(0,r)},basename(s,e){e!==void 0&&As(e,"suffix"),As(s,"path");let t=0,i=-1,n=!0,r;if(s.length>=2&&fp(s.charCodeAt(0))&&s.charCodeAt(1)===hp&&(t=2),e!==void 0&&e.length>0&&e.length<=s.length){if(e===s)return"";let o=e.length-1,a=-1;for(r=s.length-1;r>=t;--r){const l=s.charCodeAt(r);if(Si(l)){if(!n){t=r+1;break}}else a===-1&&(n=!1,a=r+1),o>=0&&(l===e.charCodeAt(o)?--o===-1&&(i=r):(o=-1,i=a))}return t===i?i=a:i===-1&&(i=s.length),s.slice(t,i)}for(r=s.length-1;r>=t;--r)if(Si(s.charCodeAt(r))){if(!n){t=r+1;break}}else i===-1&&(n=!1,i=r+1);return i===-1?"":s.slice(t,i)},extname(s){As(s,"path");let e=0,t=-1,i=0,n=-1,r=!0,o=0;s.length>=2&&s.charCodeAt(1)===hp&&fp(s.charCodeAt(0))&&(e=i=2);for(let a=s.length-1;a>=e;--a){const l=s.charCodeAt(a);if(Si(l)){if(!r){i=a+1;break}continue}n===-1&&(r=!1,n=a+1),l===am?t===-1?t=a:o!==1&&(o=1):t!==-1&&(o=-1)}return t===-1||n===-1||o===0||o===1&&t===n-1&&t===i+1?"":s.slice(t,n)},format:mue.bind(null,"\\"),parse(s){As(s,"path");const e={root:"",dir:"",base:"",ext:"",name:""};if(s.length===0)return e;const t=s.length;let i=0,n=s.charCodeAt(0);if(t===1)return Si(n)?(e.root=e.dir=s,e):(e.base=e.name=s,e);if(Si(n)){if(i=1,Si(s.charCodeAt(1))){let u=2,h=u;for(;u<t&&!Si(s.charCodeAt(u));)u++;if(u<t&&u!==h){for(h=u;u<t&&Si(s.charCodeAt(u));)u++;if(u<t&&u!==h){for(h=u;u<t&&!Si(s.charCodeAt(u));)u++;u===t?i=u:u!==h&&(i=u+1)}}}}else if(fp(n)&&s.charCodeAt(1)===hp){if(t<=2)return e.root=e.dir=s,e;if(i=2,Si(s.charCodeAt(2))){if(t===3)return e.root=e.dir=s,e;i=3}}i>0&&(e.root=s.slice(0,i));let r=-1,o=i,a=-1,l=!0,c=s.length-1,d=0;for(;c>=i;--c){if(n=s.charCodeAt(c),Si(n)){if(!l){o=c+1;break}continue}a===-1&&(l=!1,a=c+1),n===am?r===-1?r=c:d!==1&&(d=1):r!==-1&&(d=-1)}return a!==-1&&(r===-1||d===0||d===1&&r===a-1&&r===o+1?e.base=e.name=s.slice(o,a):(e.name=s.slice(o,r),e.base=s.slice(o,a),e.ext=s.slice(r,a))),o>0&&o!==i?e.dir=s.slice(0,o-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null},hRe=(()=>{if(Mg){const s=/\\/g;return()=>{const e=A2().replace(s,"/");return e.slice(e.indexOf("/"))}}return()=>A2()})(),Yn={resolve(...s){let e="",t=!1;for(let i=s.length-1;i>=-1&&!t;i--){const n=i>=0?s[i]:hRe();As(n,`paths[${i}]`),n.length!==0&&(e=`${n}/${e}`,t=n.charCodeAt(0)===zr)}return e=P2(e,!t,"/",H7),t?`/${e}`:e.length>0?e:"."},normalize(s){if(As(s,"path"),s.length===0)return".";const e=s.charCodeAt(0)===zr,t=s.charCodeAt(s.length-1)===zr;return s=P2(s,!e,"/",H7),s.length===0?e?"/":t?"./":".":(t&&(s+="/"),e?`/${s}`:s)},isAbsolute(s){return As(s,"path"),s.length>0&&s.charCodeAt(0)===zr},join(...s){if(s.length===0)return".";let e;for(let t=0;t<s.length;++t){const i=s[t];As(i,"path"),i.length>0&&(e===void 0?e=i:e+=`/${i}`)}return e===void 0?".":Yn.normalize(e)},relative(s,e){if(As(s,"from"),As(e,"to"),s===e||(s=Yn.resolve(s),e=Yn.resolve(e),s===e))return"";const t=1,i=s.length,n=i-t,r=1,o=e.length-r,a=n<o?n:o;let l=-1,c=0;for(;c<a;c++){const u=s.charCodeAt(t+c);if(u!==e.charCodeAt(r+c))break;u===zr&&(l=c)}if(c===a)if(o>a){if(e.charCodeAt(r+c)===zr)return e.slice(r+c+1);if(c===0)return e.slice(r+c)}else n>a&&(s.charCodeAt(t+c)===zr?l=c:c===0&&(l=0));let d="";for(c=t+l+1;c<=i;++c)(c===i||s.charCodeAt(c)===zr)&&(d+=d.length===0?"..":"/..");return`${d}${e.slice(r+l)}`},toNamespacedPath(s){return s},dirname(s){if(As(s,"path"),s.length===0)return".";const e=s.charCodeAt(0)===zr;let t=-1,i=!0;for(let n=s.length-1;n>=1;--n)if(s.charCodeAt(n)===zr){if(!i){t=n;break}}else i=!1;return t===-1?e?"/":".":e&&t===1?"//":s.slice(0,t)},basename(s,e){e!==void 0&&As(e,"ext"),As(s,"path");let t=0,i=-1,n=!0,r;if(e!==void 0&&e.length>0&&e.length<=s.length){if(e===s)return"";let o=e.length-1,a=-1;for(r=s.length-1;r>=0;--r){const l=s.charCodeAt(r);if(l===zr){if(!n){t=r+1;break}}else a===-1&&(n=!1,a=r+1),o>=0&&(l===e.charCodeAt(o)?--o===-1&&(i=r):(o=-1,i=a))}return t===i?i=a:i===-1&&(i=s.length),s.slice(t,i)}for(r=s.length-1;r>=0;--r)if(s.charCodeAt(r)===zr){if(!n){t=r+1;break}}else i===-1&&(n=!1,i=r+1);return i===-1?"":s.slice(t,i)},extname(s){As(s,"path");let e=-1,t=0,i=-1,n=!0,r=0;for(let o=s.length-1;o>=0;--o){const a=s.charCodeAt(o);if(a===zr){if(!n){t=o+1;break}continue}i===-1&&(n=!1,i=o+1),a===am?e===-1?e=o:r!==1&&(r=1):e!==-1&&(r=-1)}return e===-1||i===-1||r===0||r===1&&e===i-1&&e===t+1?"":s.slice(e,i)},format:mue.bind(null,"/"),parse(s){As(s,"path");const e={root:"",dir:"",base:"",ext:"",name:""};if(s.length===0)return e;const t=s.charCodeAt(0)===zr;let i;t?(e.root="/",i=1):i=0;let n=-1,r=0,o=-1,a=!0,l=s.length-1,c=0;for(;l>=i;--l){const d=s.charCodeAt(l);if(d===zr){if(!a){r=l+1;break}continue}o===-1&&(a=!1,o=l+1),d===am?n===-1?n=l:c!==1&&(c=1):n!==-1&&(c=-1)}if(o!==-1){const d=r===0&&t?1:r;n===-1||c===0||c===1&&n===o-1&&n===r+1?e.base=e.name=s.slice(d,o):(e.name=s.slice(d,n),e.base=s.slice(d,o),e.ext=s.slice(n,o))}return r>0?e.dir=s.slice(0,r-1):t&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};Yn.win32=Yo.win32=Yo;Yn.posix=Yo.posix=Yn;const _ue=Mg?Yo.normalize:Yn.normalize,fRe=Mg?Yo.join:Yn.join,gRe=Mg?Yo.resolve:Yn.resolve,pRe=Mg?Yo.relative:Yn.relative,bue=Mg?Yo.dirname:Yn.dirname,lm=Mg?Yo.basename:Yn.basename,mRe=Mg?Yo.extname:Yn.extname,tu=Mg?Yo.sep:Yn.sep,_Re=/^\w[\w\d+.-]*$/,bRe=/^\//,vRe=/^\/\//;function wRe(s,e){if(!s.scheme&&e)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${s.authority}", path: "${s.path}", query: "${s.query}", fragment: "${s.fragment}"}`);if(s.scheme&&!_Re.test(s.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(s.path){if(s.authority){if(!bRe.test(s.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(vRe.test(s.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function CRe(s,e){return!s&&!e?"file":s}function yRe(s,e){switch(s){case"https":case"http":case"file":e?e[0]!==$d&&(e=$d+e):e=$d;break}return e}const Gn="",$d="/",SRe=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class Je{static isUri(e){return e instanceof Je?!0:e?typeof e.authority=="string"&&typeof e.fragment=="string"&&typeof e.path=="string"&&typeof e.query=="string"&&typeof e.scheme=="string"&&typeof e.fsPath=="string"&&typeof e.with=="function"&&typeof e.toString=="function":!1}constructor(e,t,i,n,r,o=!1){typeof e=="object"?(this.scheme=e.scheme||Gn,this.authority=e.authority||Gn,this.path=e.path||Gn,this.query=e.query||Gn,this.fragment=e.fragment||Gn):(this.scheme=CRe(e,o),this.authority=t||Gn,this.path=yRe(this.scheme,i||Gn),this.query=n||Gn,this.fragment=r||Gn,wRe(this,o))}get fsPath(){return M2(this,!1)}with(e){if(!e)return this;let{scheme:t,authority:i,path:n,query:r,fragment:o}=e;return t===void 0?t=this.scheme:t===null&&(t=Gn),i===void 0?i=this.authority:i===null&&(i=Gn),n===void 0?n=this.path:n===null&&(n=Gn),r===void 0?r=this.query:r===null&&(r=Gn),o===void 0?o=this.fragment:o===null&&(o=Gn),t===this.scheme&&i===this.authority&&n===this.path&&r===this.query&&o===this.fragment?this:new W0(t,i,n,r,o)}static parse(e,t=!1){const i=SRe.exec(e);return i?new W0(i[2]||Gn,YT(i[4]||Gn),YT(i[5]||Gn),YT(i[7]||Gn),YT(i[9]||Gn),t):new W0(Gn,Gn,Gn,Gn,Gn)}static file(e){let t=Gn;if(gr&&(e=e.replace(/\\/g,$d)),e[0]===$d&&e[1]===$d){const i=e.indexOf($d,2);i===-1?(t=e.substring(2),e=$d):(t=e.substring(2,i),e=e.substring(i)||$d)}return new W0("file",t,e,Gn,Gn)}static from(e,t){return new W0(e.scheme,e.authority,e.path,e.query,e.fragment,t)}static joinPath(e,...t){if(!e.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let i;return gr&&e.scheme==="file"?i=Je.file(Yo.join(M2(e,!0),...t)).path:i=Yn.join(e.path,...t),e.with({path:i})}toString(e=!1){return z7(this,e)}toJSON(){return this}static revive(e){if(e){if(e instanceof Je)return e;{const t=new W0(e);return t._formatted=e.external??null,t._fsPath=e._sep===vue?e.fsPath??null:null,t}}else return e}}const vue=gr?1:void 0;let W0=class extends Je{constructor(){super(...arguments),this._formatted=null,this._fsPath=null}get fsPath(){return this._fsPath||(this._fsPath=M2(this,!1)),this._fsPath}toString(e=!1){return e?z7(this,!0):(this._formatted||(this._formatted=z7(this,!1)),this._formatted)}toJSON(){const e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=vue),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}};const wue={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function Qee(s,e,t){let i,n=-1;for(let r=0;r<s.length;r++){const o=s.charCodeAt(r);if(o>=97&&o<=122||o>=65&&o<=90||o>=48&&o<=57||o===45||o===46||o===95||o===126||e&&o===47||t&&o===91||t&&o===93||t&&o===58)n!==-1&&(i+=encodeURIComponent(s.substring(n,r)),n=-1),i!==void 0&&(i+=s.charAt(r));else{i===void 0&&(i=s.substr(0,r));const a=wue[o];a!==void 0?(n!==-1&&(i+=encodeURIComponent(s.substring(n,r)),n=-1),i+=a):n===-1&&(n=r)}}return n!==-1&&(i+=encodeURIComponent(s.substring(n))),i!==void 0?i:s}function xRe(s){let e;for(let t=0;t<s.length;t++){const i=s.charCodeAt(t);i===35||i===63?(e===void 0&&(e=s.substr(0,t)),e+=wue[i]):e!==void 0&&(e+=s[t])}return e!==void 0?e:s}function M2(s,e){let t;return s.authority&&s.path.length>1&&s.scheme==="file"?t=`//${s.authority}${s.path}`:s.path.charCodeAt(0)===47&&(s.path.charCodeAt(1)>=65&&s.path.charCodeAt(1)<=90||s.path.charCodeAt(1)>=97&&s.path.charCodeAt(1)<=122)&&s.path.charCodeAt(2)===58?e?t=s.path.substr(1):t=s.path[1].toLowerCase()+s.path.substr(2):t=s.path,gr&&(t=t.replace(/\//g,"\\")),t}function z7(s,e){const t=e?xRe:Qee;let i="",{scheme:n,authority:r,path:o,query:a,fragment:l}=s;if(n&&(i+=n,i+=":"),(r||n==="file")&&(i+=$d,i+=$d),r){let c=r.indexOf("@");if(c!==-1){const d=r.substr(0,c);r=r.substr(c+1),c=d.lastIndexOf(":"),c===-1?i+=t(d,!1,!1):(i+=t(d.substr(0,c),!1,!1),i+=":",i+=t(d.substr(c+1),!1,!0)),i+="@"}r=r.toLowerCase(),c=r.lastIndexOf(":"),c===-1?i+=t(r,!1,!0):(i+=t(r.substr(0,c),!1,!0),i+=r.substr(c))}if(o){if(o.length>=3&&o.charCodeAt(0)===47&&o.charCodeAt(2)===58){const c=o.charCodeAt(1);c>=65&&c<=90&&(o=`/${String.fromCharCode(c+32)}:${o.substr(3)}`)}else if(o.length>=2&&o.charCodeAt(1)===58){const c=o.charCodeAt(0);c>=65&&c<=90&&(o=`${String.fromCharCode(c+32)}:${o.substr(2)}`)}i+=t(o,!0,!1)}return a&&(i+="?",i+=t(a,!1,!1)),l&&(i+="#",i+=e?l:Qee(l,!1,!1)),i}function Cue(s){try{return decodeURIComponent(s)}catch{return s.length>3?s.substr(0,3)+Cue(s.substr(3)):s}}const Yee=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function YT(s){return s.match(Yee)?s.replace(Yee,e=>Cue(e)):s}let X=class sb{constructor(e,t){this.lineNumber=e,this.column=t}with(e=this.lineNumber,t=this.column){return e===this.lineNumber&&t===this.column?this:new sb(e,t)}delta(e=0,t=0){return this.with(this.lineNumber+e,this.column+t)}equals(e){return sb.equals(this,e)}static equals(e,t){return!e&&!t?!0:!!e&&!!t&&e.lineNumber===t.lineNumber&&e.column===t.column}isBefore(e){return sb.isBefore(this,e)}static isBefore(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<t.column}isBeforeOrEqual(e){return sb.isBeforeOrEqual(this,e)}static isBeforeOrEqual(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<=t.column}static compare(e,t){const i=e.lineNumber|0,n=t.lineNumber|0;if(i===n){const r=e.column|0,o=t.column|0;return r-o}return i-n}clone(){return new sb(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(e){return new sb(e.lineNumber,e.column)}static isIPosition(e){return e&&typeof e.lineNumber=="number"&&typeof e.column=="number"}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}},F=class js{constructor(e,t,i,n){e>i||e===i&&t>n?(this.startLineNumber=i,this.startColumn=n,this.endLineNumber=e,this.endColumn=t):(this.startLineNumber=e,this.startColumn=t,this.endLineNumber=i,this.endColumn=n)}isEmpty(){return js.isEmpty(this)}static isEmpty(e){return e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn}containsPosition(e){return js.containsPosition(this,e)}static containsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<e.startColumn||t.lineNumber===e.endLineNumber&&t.column>e.endColumn)}static strictContainsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<=e.startColumn||t.lineNumber===e.endLineNumber&&t.column>=e.endColumn)}containsRange(e){return js.containsRange(this,e)}static containsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>e.endColumn)}strictContainsRange(e){return js.strictContainsRange(this,e)}static strictContainsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<=e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>=e.endColumn)}plusRange(e){return js.plusRange(this,e)}static plusRange(e,t){let i,n,r,o;return t.startLineNumber<e.startLineNumber?(i=t.startLineNumber,n=t.startColumn):t.startLineNumber===e.startLineNumber?(i=t.startLineNumber,n=Math.min(t.startColumn,e.startColumn)):(i=e.startLineNumber,n=e.startColumn),t.endLineNumber>e.endLineNumber?(r=t.endLineNumber,o=t.endColumn):t.endLineNumber===e.endLineNumber?(r=t.endLineNumber,o=Math.max(t.endColumn,e.endColumn)):(r=e.endLineNumber,o=e.endColumn),new js(i,n,r,o)}intersectRanges(e){return js.intersectRanges(this,e)}static intersectRanges(e,t){let i=e.startLineNumber,n=e.startColumn,r=e.endLineNumber,o=e.endColumn;const a=t.startLineNumber,l=t.startColumn,c=t.endLineNumber,d=t.endColumn;return i<a?(i=a,n=l):i===a&&(n=Math.max(n,l)),r>c?(r=c,o=d):r===c&&(o=Math.min(o,d)),i>r||i===r&&n>o?null:new js(i,n,r,o)}equalsRange(e){return js.equalsRange(this,e)}static equalsRange(e,t){return!e&&!t?!0:!!e&&!!t&&e.startLineNumber===t.startLineNumber&&e.startColumn===t.startColumn&&e.endLineNumber===t.endLineNumber&&e.endColumn===t.endColumn}getEndPosition(){return js.getEndPosition(this)}static getEndPosition(e){return new X(e.endLineNumber,e.endColumn)}getStartPosition(){return js.getStartPosition(this)}static getStartPosition(e){return new X(e.startLineNumber,e.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(e,t){return new js(this.startLineNumber,this.startColumn,e,t)}setStartPosition(e,t){return new js(e,t,this.endLineNumber,this.endColumn)}collapseToStart(){return js.collapseToStart(this)}static collapseToStart(e){return new js(e.startLineNumber,e.startColumn,e.startLineNumber,e.startColumn)}collapseToEnd(){return js.collapseToEnd(this)}static collapseToEnd(e){return new js(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn)}delta(e){return new js(this.startLineNumber+e,this.startColumn,this.endLineNumber+e,this.endColumn)}static fromPositions(e,t=e){return new js(e.lineNumber,e.column,t.lineNumber,t.column)}static lift(e){return e?new js(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):null}static isIRange(e){return e&&typeof e.startLineNumber=="number"&&typeof e.startColumn=="number"&&typeof e.endLineNumber=="number"&&typeof e.endColumn=="number"}static areIntersectingOrTouching(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn)}static areIntersecting(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<=t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<=e.startColumn)}static compareRangesUsingStarts(e,t){if(e&&t){const r=e.startLineNumber|0,o=t.startLineNumber|0;if(r===o){const a=e.startColumn|0,l=t.startColumn|0;if(a===l){const c=e.endLineNumber|0,d=t.endLineNumber|0;if(c===d){const u=e.endColumn|0,h=t.endColumn|0;return u-h}return c-d}return a-l}return r-o}return(e?1:0)-(t?1:0)}static compareRangesUsingEnds(e,t){return e.endLineNumber===t.endLineNumber?e.endColumn===t.endColumn?e.startLineNumber===t.startLineNumber?e.startColumn-t.startColumn:e.startLineNumber-t.startLineNumber:e.endColumn-t.endColumn:e.endLineNumber-t.endLineNumber}static spansMultipleLines(e){return e.endLineNumber>e.startLineNumber}toJSON(){return this}},Ue=class Wc extends F{constructor(e,t,i,n){super(e,t,i,n),this.selectionStartLineNumber=e,this.selectionStartColumn=t,this.positionLineNumber=i,this.positionColumn=n}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(e){return Wc.selectionsEqual(this,e)}static selectionsEqual(e,t){return e.selectionStartLineNumber===t.selectionStartLineNumber&&e.selectionStartColumn===t.selectionStartColumn&&e.positionLineNumber===t.positionLineNumber&&e.positionColumn===t.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?0:1}setEndPosition(e,t){return this.getDirection()===0?new Wc(this.startLineNumber,this.startColumn,e,t):new Wc(e,t,this.startLineNumber,this.startColumn)}getPosition(){return new X(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new X(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(e,t){return this.getDirection()===0?new Wc(e,t,this.endLineNumber,this.endColumn):new Wc(this.endLineNumber,this.endColumn,e,t)}static fromPositions(e,t=e){return new Wc(e.lineNumber,e.column,t.lineNumber,t.column)}static fromRange(e,t){return t===0?new Wc(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):new Wc(e.endLineNumber,e.endColumn,e.startLineNumber,e.startColumn)}static liftSelection(e){return new Wc(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn)}static selectionsArrEqual(e,t){if(e&&!t||!e&&t)return!1;if(!e&&!t)return!0;if(e.length!==t.length)return!1;for(let i=0,n=e.length;i<n;i++)if(!this.selectionsEqual(e[i],t[i]))return!1;return!0}static isISelection(e){return e&&typeof e.selectionStartLineNumber=="number"&&typeof e.selectionStartColumn=="number"&&typeof e.positionLineNumber=="number"&&typeof e.positionColumn=="number"}static createWithDirection(e,t,i,n,r){return r===0?new Wc(e,t,i,n):new Wc(i,n,e,t)}};const U7=Object.create(null);function M(s,e){if(Zo(e)){const t=U7[e];if(t===void 0)throw new Error(`${s} references an unknown codicon: ${e}`);e=t}return U7[s]=e,{id:s}}function yue(){return U7}const LRe={add:M("add",6e4),plus:M("plus",6e4),gistNew:M("gist-new",6e4),repoCreate:M("repo-create",6e4),lightbulb:M("lightbulb",60001),lightBulb:M("light-bulb",60001),repo:M("repo",60002),repoDelete:M("repo-delete",60002),gistFork:M("gist-fork",60003),repoForked:M("repo-forked",60003),gitPullRequest:M("git-pull-request",60004),gitPullRequestAbandoned:M("git-pull-request-abandoned",60004),recordKeys:M("record-keys",60005),keyboard:M("keyboard",60005),tag:M("tag",60006),gitPullRequestLabel:M("git-pull-request-label",60006),tagAdd:M("tag-add",60006),tagRemove:M("tag-remove",60006),person:M("person",60007),personFollow:M("person-follow",60007),personOutline:M("person-outline",60007),personFilled:M("person-filled",60007),gitBranch:M("git-branch",60008),gitBranchCreate:M("git-branch-create",60008),gitBranchDelete:M("git-branch-delete",60008),sourceControl:M("source-control",60008),mirror:M("mirror",60009),mirrorPublic:M("mirror-public",60009),star:M("star",60010),starAdd:M("star-add",60010),starDelete:M("star-delete",60010),starEmpty:M("star-empty",60010),comment:M("comment",60011),commentAdd:M("comment-add",60011),alert:M("alert",60012),warning:M("warning",60012),search:M("search",60013),searchSave:M("search-save",60013),logOut:M("log-out",60014),signOut:M("sign-out",60014),logIn:M("log-in",60015),signIn:M("sign-in",60015),eye:M("eye",60016),eyeUnwatch:M("eye-unwatch",60016),eyeWatch:M("eye-watch",60016),circleFilled:M("circle-filled",60017),primitiveDot:M("primitive-dot",60017),closeDirty:M("close-dirty",60017),debugBreakpoint:M("debug-breakpoint",60017),debugBreakpointDisabled:M("debug-breakpoint-disabled",60017),debugHint:M("debug-hint",60017),terminalDecorationSuccess:M("terminal-decoration-success",60017),primitiveSquare:M("primitive-square",60018),edit:M("edit",60019),pencil:M("pencil",60019),info:M("info",60020),issueOpened:M("issue-opened",60020),gistPrivate:M("gist-private",60021),gitForkPrivate:M("git-fork-private",60021),lock:M("lock",60021),mirrorPrivate:M("mirror-private",60021),close:M("close",60022),removeClose:M("remove-close",60022),x:M("x",60022),repoSync:M("repo-sync",60023),sync:M("sync",60023),clone:M("clone",60024),desktopDownload:M("desktop-download",60024),beaker:M("beaker",60025),microscope:M("microscope",60025),vm:M("vm",60026),deviceDesktop:M("device-desktop",60026),file:M("file",60027),fileText:M("file-text",60027),more:M("more",60028),ellipsis:M("ellipsis",60028),kebabHorizontal:M("kebab-horizontal",60028),mailReply:M("mail-reply",60029),reply:M("reply",60029),organization:M("organization",60030),organizationFilled:M("organization-filled",60030),organizationOutline:M("organization-outline",60030),newFile:M("new-file",60031),fileAdd:M("file-add",60031),newFolder:M("new-folder",60032),fileDirectoryCreate:M("file-directory-create",60032),trash:M("trash",60033),trashcan:M("trashcan",60033),history:M("history",60034),clock:M("clock",60034),folder:M("folder",60035),fileDirectory:M("file-directory",60035),symbolFolder:M("symbol-folder",60035),logoGithub:M("logo-github",60036),markGithub:M("mark-github",60036),github:M("github",60036),terminal:M("terminal",60037),console:M("console",60037),repl:M("repl",60037),zap:M("zap",60038),symbolEvent:M("symbol-event",60038),error:M("error",60039),stop:M("stop",60039),variable:M("variable",60040),symbolVariable:M("symbol-variable",60040),array:M("array",60042),symbolArray:M("symbol-array",60042),symbolModule:M("symbol-module",60043),symbolPackage:M("symbol-package",60043),symbolNamespace:M("symbol-namespace",60043),symbolObject:M("symbol-object",60043),symbolMethod:M("symbol-method",60044),symbolFunction:M("symbol-function",60044),symbolConstructor:M("symbol-constructor",60044),symbolBoolean:M("symbol-boolean",60047),symbolNull:M("symbol-null",60047),symbolNumeric:M("symbol-numeric",60048),symbolNumber:M("symbol-number",60048),symbolStructure:M("symbol-structure",60049),symbolStruct:M("symbol-struct",60049),symbolParameter:M("symbol-parameter",60050),symbolTypeParameter:M("symbol-type-parameter",60050),symbolKey:M("symbol-key",60051),symbolText:M("symbol-text",60051),symbolReference:M("symbol-reference",60052),goToFile:M("go-to-file",60052),symbolEnum:M("symbol-enum",60053),symbolValue:M("symbol-value",60053),symbolRuler:M("symbol-ruler",60054),symbolUnit:M("symbol-unit",60054),activateBreakpoints:M("activate-breakpoints",60055),archive:M("archive",60056),arrowBoth:M("arrow-both",60057),arrowDown:M("arrow-down",60058),arrowLeft:M("arrow-left",60059),arrowRight:M("arrow-right",60060),arrowSmallDown:M("arrow-small-down",60061),arrowSmallLeft:M("arrow-small-left",60062),arrowSmallRight:M("arrow-small-right",60063),arrowSmallUp:M("arrow-small-up",60064),arrowUp:M("arrow-up",60065),bell:M("bell",60066),bold:M("bold",60067),book:M("book",60068),bookmark:M("bookmark",60069),debugBreakpointConditionalUnverified:M("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:M("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:M("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:M("debug-breakpoint-data-unverified",60072),debugBreakpointData:M("debug-breakpoint-data",60073),debugBreakpointDataDisabled:M("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:M("debug-breakpoint-log-unverified",60074),debugBreakpointLog:M("debug-breakpoint-log",60075),debugBreakpointLogDisabled:M("debug-breakpoint-log-disabled",60075),briefcase:M("briefcase",60076),broadcast:M("broadcast",60077),browser:M("browser",60078),bug:M("bug",60079),calendar:M("calendar",60080),caseSensitive:M("case-sensitive",60081),check:M("check",60082),checklist:M("checklist",60083),chevronDown:M("chevron-down",60084),chevronLeft:M("chevron-left",60085),chevronRight:M("chevron-right",60086),chevronUp:M("chevron-up",60087),chromeClose:M("chrome-close",60088),chromeMaximize:M("chrome-maximize",60089),chromeMinimize:M("chrome-minimize",60090),chromeRestore:M("chrome-restore",60091),circleOutline:M("circle-outline",60092),circle:M("circle",60092),debugBreakpointUnverified:M("debug-breakpoint-unverified",60092),terminalDecorationIncomplete:M("terminal-decoration-incomplete",60092),circleSlash:M("circle-slash",60093),circuitBoard:M("circuit-board",60094),clearAll:M("clear-all",60095),clippy:M("clippy",60096),closeAll:M("close-all",60097),cloudDownload:M("cloud-download",60098),cloudUpload:M("cloud-upload",60099),code:M("code",60100),collapseAll:M("collapse-all",60101),colorMode:M("color-mode",60102),commentDiscussion:M("comment-discussion",60103),creditCard:M("credit-card",60105),dash:M("dash",60108),dashboard:M("dashboard",60109),database:M("database",60110),debugContinue:M("debug-continue",60111),debugDisconnect:M("debug-disconnect",60112),debugPause:M("debug-pause",60113),debugRestart:M("debug-restart",60114),debugStart:M("debug-start",60115),debugStepInto:M("debug-step-into",60116),debugStepOut:M("debug-step-out",60117),debugStepOver:M("debug-step-over",60118),debugStop:M("debug-stop",60119),debug:M("debug",60120),deviceCameraVideo:M("device-camera-video",60121),deviceCamera:M("device-camera",60122),deviceMobile:M("device-mobile",60123),diffAdded:M("diff-added",60124),diffIgnored:M("diff-ignored",60125),diffModified:M("diff-modified",60126),diffRemoved:M("diff-removed",60127),diffRenamed:M("diff-renamed",60128),diff:M("diff",60129),diffSidebyside:M("diff-sidebyside",60129),discard:M("discard",60130),editorLayout:M("editor-layout",60131),emptyWindow:M("empty-window",60132),exclude:M("exclude",60133),extensions:M("extensions",60134),eyeClosed:M("eye-closed",60135),fileBinary:M("file-binary",60136),fileCode:M("file-code",60137),fileMedia:M("file-media",60138),filePdf:M("file-pdf",60139),fileSubmodule:M("file-submodule",60140),fileSymlinkDirectory:M("file-symlink-directory",60141),fileSymlinkFile:M("file-symlink-file",60142),fileZip:M("file-zip",60143),files:M("files",60144),filter:M("filter",60145),flame:M("flame",60146),foldDown:M("fold-down",60147),foldUp:M("fold-up",60148),fold:M("fold",60149),folderActive:M("folder-active",60150),folderOpened:M("folder-opened",60151),gear:M("gear",60152),gift:M("gift",60153),gistSecret:M("gist-secret",60154),gist:M("gist",60155),gitCommit:M("git-commit",60156),gitCompare:M("git-compare",60157),compareChanges:M("compare-changes",60157),gitMerge:M("git-merge",60158),githubAction:M("github-action",60159),githubAlt:M("github-alt",60160),globe:M("globe",60161),grabber:M("grabber",60162),graph:M("graph",60163),gripper:M("gripper",60164),heart:M("heart",60165),home:M("home",60166),horizontalRule:M("horizontal-rule",60167),hubot:M("hubot",60168),inbox:M("inbox",60169),issueReopened:M("issue-reopened",60171),issues:M("issues",60172),italic:M("italic",60173),jersey:M("jersey",60174),json:M("json",60175),kebabVertical:M("kebab-vertical",60176),key:M("key",60177),law:M("law",60178),lightbulbAutofix:M("lightbulb-autofix",60179),linkExternal:M("link-external",60180),link:M("link",60181),listOrdered:M("list-ordered",60182),listUnordered:M("list-unordered",60183),liveShare:M("live-share",60184),loading:M("loading",60185),location:M("location",60186),mailRead:M("mail-read",60187),mail:M("mail",60188),markdown:M("markdown",60189),megaphone:M("megaphone",60190),mention:M("mention",60191),milestone:M("milestone",60192),gitPullRequestMilestone:M("git-pull-request-milestone",60192),mortarBoard:M("mortar-board",60193),move:M("move",60194),multipleWindows:M("multiple-windows",60195),mute:M("mute",60196),noNewline:M("no-newline",60197),note:M("note",60198),octoface:M("octoface",60199),openPreview:M("open-preview",60200),package:M("package",60201),paintcan:M("paintcan",60202),pin:M("pin",60203),play:M("play",60204),run:M("run",60204),plug:M("plug",60205),preserveCase:M("preserve-case",60206),preview:M("preview",60207),project:M("project",60208),pulse:M("pulse",60209),question:M("question",60210),quote:M("quote",60211),radioTower:M("radio-tower",60212),reactions:M("reactions",60213),references:M("references",60214),refresh:M("refresh",60215),regex:M("regex",60216),remoteExplorer:M("remote-explorer",60217),remote:M("remote",60218),remove:M("remove",60219),replaceAll:M("replace-all",60220),replace:M("replace",60221),repoClone:M("repo-clone",60222),repoForcePush:M("repo-force-push",60223),repoPull:M("repo-pull",60224),repoPush:M("repo-push",60225),report:M("report",60226),requestChanges:M("request-changes",60227),rocket:M("rocket",60228),rootFolderOpened:M("root-folder-opened",60229),rootFolder:M("root-folder",60230),rss:M("rss",60231),ruby:M("ruby",60232),saveAll:M("save-all",60233),saveAs:M("save-as",60234),save:M("save",60235),screenFull:M("screen-full",60236),screenNormal:M("screen-normal",60237),searchStop:M("search-stop",60238),server:M("server",60240),settingsGear:M("settings-gear",60241),settings:M("settings",60242),shield:M("shield",60243),smiley:M("smiley",60244),sortPrecedence:M("sort-precedence",60245),splitHorizontal:M("split-horizontal",60246),splitVertical:M("split-vertical",60247),squirrel:M("squirrel",60248),starFull:M("star-full",60249),starHalf:M("star-half",60250),symbolClass:M("symbol-class",60251),symbolColor:M("symbol-color",60252),symbolConstant:M("symbol-constant",60253),symbolEnumMember:M("symbol-enum-member",60254),symbolField:M("symbol-field",60255),symbolFile:M("symbol-file",60256),symbolInterface:M("symbol-interface",60257),symbolKeyword:M("symbol-keyword",60258),symbolMisc:M("symbol-misc",60259),symbolOperator:M("symbol-operator",60260),symbolProperty:M("symbol-property",60261),wrench:M("wrench",60261),wrenchSubaction:M("wrench-subaction",60261),symbolSnippet:M("symbol-snippet",60262),tasklist:M("tasklist",60263),telescope:M("telescope",60264),textSize:M("text-size",60265),threeBars:M("three-bars",60266),thumbsdown:M("thumbsdown",60267),thumbsup:M("thumbsup",60268),tools:M("tools",60269),triangleDown:M("triangle-down",60270),triangleLeft:M("triangle-left",60271),triangleRight:M("triangle-right",60272),triangleUp:M("triangle-up",60273),twitter:M("twitter",60274),unfold:M("unfold",60275),unlock:M("unlock",60276),unmute:M("unmute",60277),unverified:M("unverified",60278),verified:M("verified",60279),versions:M("versions",60280),vmActive:M("vm-active",60281),vmOutline:M("vm-outline",60282),vmRunning:M("vm-running",60283),watch:M("watch",60284),whitespace:M("whitespace",60285),wholeWord:M("whole-word",60286),window:M("window",60287),wordWrap:M("word-wrap",60288),zoomIn:M("zoom-in",60289),zoomOut:M("zoom-out",60290),listFilter:M("list-filter",60291),listFlat:M("list-flat",60292),listSelection:M("list-selection",60293),selection:M("selection",60293),listTree:M("list-tree",60294),debugBreakpointFunctionUnverified:M("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:M("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:M("debug-breakpoint-function-disabled",60296),debugStackframeActive:M("debug-stackframe-active",60297),circleSmallFilled:M("circle-small-filled",60298),debugStackframeDot:M("debug-stackframe-dot",60298),terminalDecorationMark:M("terminal-decoration-mark",60298),debugStackframe:M("debug-stackframe",60299),debugStackframeFocused:M("debug-stackframe-focused",60299),debugBreakpointUnsupported:M("debug-breakpoint-unsupported",60300),symbolString:M("symbol-string",60301),debugReverseContinue:M("debug-reverse-continue",60302),debugStepBack:M("debug-step-back",60303),debugRestartFrame:M("debug-restart-frame",60304),debugAlt:M("debug-alt",60305),callIncoming:M("call-incoming",60306),callOutgoing:M("call-outgoing",60307),menu:M("menu",60308),expandAll:M("expand-all",60309),feedback:M("feedback",60310),gitPullRequestReviewer:M("git-pull-request-reviewer",60310),groupByRefType:M("group-by-ref-type",60311),ungroupByRefType:M("ungroup-by-ref-type",60312),account:M("account",60313),gitPullRequestAssignee:M("git-pull-request-assignee",60313),bellDot:M("bell-dot",60314),debugConsole:M("debug-console",60315),library:M("library",60316),output:M("output",60317),runAll:M("run-all",60318),syncIgnored:M("sync-ignored",60319),pinned:M("pinned",60320),githubInverted:M("github-inverted",60321),serverProcess:M("server-process",60322),serverEnvironment:M("server-environment",60323),pass:M("pass",60324),issueClosed:M("issue-closed",60324),stopCircle:M("stop-circle",60325),playCircle:M("play-circle",60326),record:M("record",60327),debugAltSmall:M("debug-alt-small",60328),vmConnect:M("vm-connect",60329),cloud:M("cloud",60330),merge:M("merge",60331),export:M("export",60332),graphLeft:M("graph-left",60333),magnet:M("magnet",60334),notebook:M("notebook",60335),redo:M("redo",60336),checkAll:M("check-all",60337),pinnedDirty:M("pinned-dirty",60338),passFilled:M("pass-filled",60339),circleLargeFilled:M("circle-large-filled",60340),circleLarge:M("circle-large",60341),circleLargeOutline:M("circle-large-outline",60341),combine:M("combine",60342),gather:M("gather",60342),table:M("table",60343),variableGroup:M("variable-group",60344),typeHierarchy:M("type-hierarchy",60345),typeHierarchySub:M("type-hierarchy-sub",60346),typeHierarchySuper:M("type-hierarchy-super",60347),gitPullRequestCreate:M("git-pull-request-create",60348),runAbove:M("run-above",60349),runBelow:M("run-below",60350),notebookTemplate:M("notebook-template",60351),debugRerun:M("debug-rerun",60352),workspaceTrusted:M("workspace-trusted",60353),workspaceUntrusted:M("workspace-untrusted",60354),workspaceUnknown:M("workspace-unknown",60355),terminalCmd:M("terminal-cmd",60356),terminalDebian:M("terminal-debian",60357),terminalLinux:M("terminal-linux",60358),terminalPowershell:M("terminal-powershell",60359),terminalTmux:M("terminal-tmux",60360),terminalUbuntu:M("terminal-ubuntu",60361),terminalBash:M("terminal-bash",60362),arrowSwap:M("arrow-swap",60363),copy:M("copy",60364),personAdd:M("person-add",60365),filterFilled:M("filter-filled",60366),wand:M("wand",60367),debugLineByLine:M("debug-line-by-line",60368),inspect:M("inspect",60369),layers:M("layers",60370),layersDot:M("layers-dot",60371),layersActive:M("layers-active",60372),compass:M("compass",60373),compassDot:M("compass-dot",60374),compassActive:M("compass-active",60375),azure:M("azure",60376),issueDraft:M("issue-draft",60377),gitPullRequestClosed:M("git-pull-request-closed",60378),gitPullRequestDraft:M("git-pull-request-draft",60379),debugAll:M("debug-all",60380),debugCoverage:M("debug-coverage",60381),runErrors:M("run-errors",60382),folderLibrary:M("folder-library",60383),debugContinueSmall:M("debug-continue-small",60384),beakerStop:M("beaker-stop",60385),graphLine:M("graph-line",60386),graphScatter:M("graph-scatter",60387),pieChart:M("pie-chart",60388),bracket:M("bracket",60175),bracketDot:M("bracket-dot",60389),bracketError:M("bracket-error",60390),lockSmall:M("lock-small",60391),azureDevops:M("azure-devops",60392),verifiedFilled:M("verified-filled",60393),newline:M("newline",60394),layout:M("layout",60395),layoutActivitybarLeft:M("layout-activitybar-left",60396),layoutActivitybarRight:M("layout-activitybar-right",60397),layoutPanelLeft:M("layout-panel-left",60398),layoutPanelCenter:M("layout-panel-center",60399),layoutPanelJustify:M("layout-panel-justify",60400),layoutPanelRight:M("layout-panel-right",60401),layoutPanel:M("layout-panel",60402),layoutSidebarLeft:M("layout-sidebar-left",60403),layoutSidebarRight:M("layout-sidebar-right",60404),layoutStatusbar:M("layout-statusbar",60405),layoutMenubar:M("layout-menubar",60406),layoutCentered:M("layout-centered",60407),target:M("target",60408),indent:M("indent",60409),recordSmall:M("record-small",60410),errorSmall:M("error-small",60411),terminalDecorationError:M("terminal-decoration-error",60411),arrowCircleDown:M("arrow-circle-down",60412),arrowCircleLeft:M("arrow-circle-left",60413),arrowCircleRight:M("arrow-circle-right",60414),arrowCircleUp:M("arrow-circle-up",60415),layoutSidebarRightOff:M("layout-sidebar-right-off",60416),layoutPanelOff:M("layout-panel-off",60417),layoutSidebarLeftOff:M("layout-sidebar-left-off",60418),blank:M("blank",60419),heartFilled:M("heart-filled",60420),map:M("map",60421),mapHorizontal:M("map-horizontal",60421),foldHorizontal:M("fold-horizontal",60421),mapFilled:M("map-filled",60422),mapHorizontalFilled:M("map-horizontal-filled",60422),foldHorizontalFilled:M("fold-horizontal-filled",60422),circleSmall:M("circle-small",60423),bellSlash:M("bell-slash",60424),bellSlashDot:M("bell-slash-dot",60425),commentUnresolved:M("comment-unresolved",60426),gitPullRequestGoToChanges:M("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:M("git-pull-request-new-changes",60428),searchFuzzy:M("search-fuzzy",60429),commentDraft:M("comment-draft",60430),send:M("send",60431),sparkle:M("sparkle",60432),insert:M("insert",60433),mic:M("mic",60434),thumbsdownFilled:M("thumbsdown-filled",60435),thumbsupFilled:M("thumbsup-filled",60436),coffee:M("coffee",60437),snake:M("snake",60438),game:M("game",60439),vr:M("vr",60440),chip:M("chip",60441),piano:M("piano",60442),music:M("music",60443),micFilled:M("mic-filled",60444),repoFetch:M("repo-fetch",60445),copilot:M("copilot",60446),lightbulbSparkle:M("lightbulb-sparkle",60447),robot:M("robot",60448),sparkleFilled:M("sparkle-filled",60449),diffSingle:M("diff-single",60450),diffMultiple:M("diff-multiple",60451),surroundWith:M("surround-with",60452),share:M("share",60453),gitStash:M("git-stash",60454),gitStashApply:M("git-stash-apply",60455),gitStashPop:M("git-stash-pop",60456),vscode:M("vscode",60457),vscodeInsiders:M("vscode-insiders",60458),codeOss:M("code-oss",60459),runCoverage:M("run-coverage",60460),runAllCoverage:M("run-all-coverage",60461),coverage:M("coverage",60462),githubProject:M("github-project",60463),mapVertical:M("map-vertical",60464),foldVertical:M("fold-vertical",60464),mapVerticalFilled:M("map-vertical-filled",60465),foldVerticalFilled:M("fold-vertical-filled",60465),goToSearch:M("go-to-search",60466),percentage:M("percentage",60467),sortPercentage:M("sort-percentage",60467),attach:M("attach",60468)},kRe={dialogError:M("dialog-error","error"),dialogWarning:M("dialog-warning","warning"),dialogInfo:M("dialog-info","info"),dialogClose:M("dialog-close","close"),treeItemExpanded:M("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:M("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:M("tree-filter-on-type-off","list-selection"),treeFilterClear:M("tree-filter-clear","close"),treeItemLoading:M("tree-item-loading","loading"),menuSelection:M("menu-selection","check"),menuSubmenu:M("menu-submenu","chevron-right"),menuBarMore:M("menubar-more","more"),scrollbarButtonLeft:M("scrollbar-button-left","triangle-left"),scrollbarButtonRight:M("scrollbar-button-right","triangle-right"),scrollbarButtonUp:M("scrollbar-button-up","triangle-up"),scrollbarButtonDown:M("scrollbar-button-down","triangle-down"),toolBarMore:M("toolbar-more","more"),quickInputBack:M("quick-input-back","arrow-left"),dropDownButton:M("drop-down-button",60084),symbolCustomColor:M("symbol-customcolor",60252),exportIcon:M("export",60332),workspaceUnspecified:M("workspace-unspecified",60355),newLine:M("newline",60394),thumbsDownFilled:M("thumbsdown-filled",60435),thumbsUpFilled:M("thumbsup-filled",60436),gitFetch:M("git-fetch",60445),lightbulbSparkleAutofix:M("lightbulb-sparkle-autofix",60447),debugBreakpointPending:M("debug-breakpoint-pending",60377)},xe={...LRe,...kRe};let Sue=class{constructor(){this._tokenizationSupports=new Map,this._factories=new Map,this._onDidChange=new Z,this.onDidChange=this._onDidChange.event,this._colorMap=null}handleChange(e){this._onDidChange.fire({changedLanguages:e,changedColorMap:!1})}register(e,t){return this._tokenizationSupports.set(e,t),this.handleChange([e]),Ye(()=>{this._tokenizationSupports.get(e)===t&&(this._tokenizationSupports.delete(e),this.handleChange([e]))})}get(e){return this._tokenizationSupports.get(e)||null}registerFactory(e,t){var n;(n=this._factories.get(e))==null||n.dispose();const i=new IRe(this,e,t);return this._factories.set(e,i),Ye(()=>{const r=this._factories.get(e);!r||r!==i||(this._factories.delete(e),r.dispose())})}async getOrCreate(e){const t=this.get(e);if(t)return t;const i=this._factories.get(e);return!i||i.isResolved?null:(await i.resolve(),this.get(e))}isResolved(e){if(this.get(e))return!0;const i=this._factories.get(e);return!!(!i||i.isResolved)}setColorMap(e){this._colorMap=e,this._onDidChange.fire({changedLanguages:Array.from(this._tokenizationSupports.keys()),changedColorMap:!0})}getColorMap(){return this._colorMap}getDefaultBackground(){return this._colorMap&&this._colorMap.length>2?this._colorMap[2]:null}};class IRe extends te{get isResolved(){return this._isResolved}constructor(e,t,i){super(),this._registry=e,this._languageId=t,this._factory=i,this._isDisposed=!1,this._resolvePromise=null,this._isResolved=!1}dispose(){this._isDisposed=!0,super.dispose()}async resolve(){return this._resolvePromise||(this._resolvePromise=this._create()),this._resolvePromise}async _create(){const e=await this._factory.tokenizationSupport;this._isResolved=!0,e&&!this._isDisposed&&this._register(this._registry.register(this._languageId,e))}}let Yk=class{constructor(e,t,i){this.offset=e,this.type=t,this.language=i,this._tokenBrand=void 0}toString(){return"("+this.offset+", "+this.type+")"}};class Iq{constructor(e,t){this.tokens=e,this.endState=t,this._tokenizationResultBrand=void 0}}class X4{constructor(e,t){this.tokens=e,this.endState=t,this._encodedTokenizationResultBrand=void 0}}var La;(function(s){s[s.Increase=0]="Increase",s[s.Decrease=1]="Decrease"})(La||(La={}));var Xk;(function(s){const e=new Map;e.set(0,xe.symbolMethod),e.set(1,xe.symbolFunction),e.set(2,xe.symbolConstructor),e.set(3,xe.symbolField),e.set(4,xe.symbolVariable),e.set(5,xe.symbolClass),e.set(6,xe.symbolStruct),e.set(7,xe.symbolInterface),e.set(8,xe.symbolModule),e.set(9,xe.symbolProperty),e.set(10,xe.symbolEvent),e.set(11,xe.symbolOperator),e.set(12,xe.symbolUnit),e.set(13,xe.symbolValue),e.set(15,xe.symbolEnum),e.set(14,xe.symbolConstant),e.set(15,xe.symbolEnum),e.set(16,xe.symbolEnumMember),e.set(17,xe.symbolKeyword),e.set(27,xe.symbolSnippet),e.set(18,xe.symbolText),e.set(19,xe.symbolColor),e.set(20,xe.symbolFile),e.set(21,xe.symbolReference),e.set(22,xe.symbolCustomColor),e.set(23,xe.symbolFolder),e.set(24,xe.symbolTypeParameter),e.set(25,xe.account),e.set(26,xe.issues);function t(r){let o=e.get(r);return o||(console.info("No codicon found for CompletionItemKind "+r),o=xe.symbolProperty),o}s.toIcon=t;const i=new Map;i.set("method",0),i.set("function",1),i.set("constructor",2),i.set("field",3),i.set("variable",4),i.set("class",5),i.set("struct",6),i.set("interface",7),i.set("module",8),i.set("property",9),i.set("event",10),i.set("operator",11),i.set("unit",12),i.set("value",13),i.set("constant",14),i.set("enum",15),i.set("enum-member",16),i.set("enumMember",16),i.set("keyword",17),i.set("snippet",27),i.set("text",18),i.set("color",19),i.set("file",20),i.set("reference",21),i.set("customcolor",22),i.set("folder",23),i.set("type-parameter",24),i.set("typeParameter",24),i.set("account",25),i.set("issue",26);function n(r,o){let a=i.get(r);return typeof a>"u"&&!o&&(a=9),a}s.fromString=n})(Xk||(Xk={}));var iu;(function(s){s[s.Automatic=0]="Automatic",s[s.Explicit=1]="Explicit"})(iu||(iu={}));class xue{constructor(e,t,i,n){this.range=e,this.text=t,this.completionKind=i,this.isSnippetText=n}equals(e){return F.lift(this.range).equalsRange(e.range)&&this.text===e.text&&this.completionKind===e.completionKind&&this.isSnippetText===e.isSnippetText}}var Zk;(function(s){s[s.Automatic=0]="Automatic",s[s.PasteAs=1]="PasteAs"})(Zk||(Zk={}));var yh;(function(s){s[s.Invoke=1]="Invoke",s[s.TriggerCharacter=2]="TriggerCharacter",s[s.ContentChange=3]="ContentChange"})(yh||(yh={}));var u1;(function(s){s[s.Text=0]="Text",s[s.Read=1]="Read",s[s.Write=2]="Write"})(u1||(u1={}));function ERe(s){return s&&Je.isUri(s.uri)&&F.isIRange(s.range)&&(F.isIRange(s.originSelectionRange)||F.isIRange(s.targetSelectionRange))}const DRe={17:b("Array","array"),16:b("Boolean","boolean"),4:b("Class","class"),13:b("Constant","constant"),8:b("Constructor","constructor"),9:b("Enum","enumeration"),21:b("EnumMember","enumeration member"),23:b("Event","event"),7:b("Field","field"),0:b("File","file"),11:b("Function","function"),10:b("Interface","interface"),19:b("Key","key"),5:b("Method","method"),1:b("Module","module"),2:b("Namespace","namespace"),20:b("Null","null"),15:b("Number","number"),18:b("Object","object"),24:b("Operator","operator"),3:b("Package","package"),6:b("Property","property"),14:b("String","string"),22:b("Struct","struct"),25:b("TypeParameter","type parameter"),12:b("Variable","variable")};function TRe(s,e){return b("symbolAriaLabel","{0} ({1})",s,DRe[e])}var O2;(function(s){const e=new Map;e.set(0,xe.symbolFile),e.set(1,xe.symbolModule),e.set(2,xe.symbolNamespace),e.set(3,xe.symbolPackage),e.set(4,xe.symbolClass),e.set(5,xe.symbolMethod),e.set(6,xe.symbolProperty),e.set(7,xe.symbolField),e.set(8,xe.symbolConstructor),e.set(9,xe.symbolEnum),e.set(10,xe.symbolInterface),e.set(11,xe.symbolFunction),e.set(12,xe.symbolVariable),e.set(13,xe.symbolConstant),e.set(14,xe.symbolString),e.set(15,xe.symbolNumber),e.set(16,xe.symbolBoolean),e.set(17,xe.symbolArray),e.set(18,xe.symbolObject),e.set(19,xe.symbolKey),e.set(20,xe.symbolNull),e.set(21,xe.symbolEnumMember),e.set(22,xe.symbolStruct),e.set(23,xe.symbolEvent),e.set(24,xe.symbolOperator),e.set(25,xe.symbolTypeParameter);function t(i){let n=e.get(i);return n||(console.info("No codicon found for SymbolKind "+i),n=xe.symbolProperty),n}s.toIcon=t})(O2||(O2={}));const zc=class zc{static fromValue(e){switch(e){case"comment":return zc.Comment;case"imports":return zc.Imports;case"region":return zc.Region}return new zc(e)}constructor(e){this.value=e}};zc.Comment=new zc("comment"),zc.Imports=new zc("imports"),zc.Region=new zc("region");let Hm=zc;var j7;(function(s){s[s.AIGenerated=1]="AIGenerated"})(j7||(j7={}));var Jk;(function(s){s[s.Invoke=0]="Invoke",s[s.Automatic=1]="Automatic"})(Jk||(Jk={}));var $7;(function(s){function e(t){return!t||typeof t!="object"?!1:typeof t.id=="string"&&typeof t.title=="string"}s.is=e})($7||($7={}));var F2;(function(s){s[s.Type=1]="Type",s[s.Parameter=2]="Parameter"})(F2||(F2={}));class NRe{constructor(e){this.createSupport=e,this._tokenizationSupport=null}dispose(){this._tokenizationSupport&&this._tokenizationSupport.then(e=>{e&&e.dispose()})}get tokenizationSupport(){return this._tokenizationSupport||(this._tokenizationSupport=this.createSupport()),this._tokenizationSupport}}const Ln=new Sue,q7=new Sue;var V2;(function(s){s[s.Invoke=0]="Invoke",s[s.Automatic=1]="Automatic"})(V2||(V2={}));var K7;(function(s){s[s.Unknown=0]="Unknown",s[s.Disabled=1]="Disabled",s[s.Enabled=2]="Enabled"})(K7||(K7={}));var G7;(function(s){s[s.Invoke=1]="Invoke",s[s.Auto=2]="Auto"})(G7||(G7={}));var Q7;(function(s){s[s.None=0]="None",s[s.KeepWhitespace=1]="KeepWhitespace",s[s.InsertAsSnippet=4]="InsertAsSnippet"})(Q7||(Q7={}));var Y7;(function(s){s[s.Method=0]="Method",s[s.Function=1]="Function",s[s.Constructor=2]="Constructor",s[s.Field=3]="Field",s[s.Variable=4]="Variable",s[s.Class=5]="Class",s[s.Struct=6]="Struct",s[s.Interface=7]="Interface",s[s.Module=8]="Module",s[s.Property=9]="Property",s[s.Event=10]="Event",s[s.Operator=11]="Operator",s[s.Unit=12]="Unit",s[s.Value=13]="Value",s[s.Constant=14]="Constant",s[s.Enum=15]="Enum",s[s.EnumMember=16]="EnumMember",s[s.Keyword=17]="Keyword",s[s.Text=18]="Text",s[s.Color=19]="Color",s[s.File=20]="File",s[s.Reference=21]="Reference",s[s.Customcolor=22]="Customcolor",s[s.Folder=23]="Folder",s[s.TypeParameter=24]="TypeParameter",s[s.User=25]="User",s[s.Issue=26]="Issue",s[s.Snippet=27]="Snippet"})(Y7||(Y7={}));var X7;(function(s){s[s.Deprecated=1]="Deprecated"})(X7||(X7={}));var Z7;(function(s){s[s.Invoke=0]="Invoke",s[s.TriggerCharacter=1]="TriggerCharacter",s[s.TriggerForIncompleteCompletions=2]="TriggerForIncompleteCompletions"})(Z7||(Z7={}));var J7;(function(s){s[s.EXACT=0]="EXACT",s[s.ABOVE=1]="ABOVE",s[s.BELOW=2]="BELOW"})(J7||(J7={}));var eW;(function(s){s[s.NotSet=0]="NotSet",s[s.ContentFlush=1]="ContentFlush",s[s.RecoverFromMarkers=2]="RecoverFromMarkers",s[s.Explicit=3]="Explicit",s[s.Paste=4]="Paste",s[s.Undo=5]="Undo",s[s.Redo=6]="Redo"})(eW||(eW={}));var tW;(function(s){s[s.LF=1]="LF",s[s.CRLF=2]="CRLF"})(tW||(tW={}));var iW;(function(s){s[s.Text=0]="Text",s[s.Read=1]="Read",s[s.Write=2]="Write"})(iW||(iW={}));var nW;(function(s){s[s.None=0]="None",s[s.Keep=1]="Keep",s[s.Brackets=2]="Brackets",s[s.Advanced=3]="Advanced",s[s.Full=4]="Full"})(nW||(nW={}));var sW;(function(s){s[s.acceptSuggestionOnCommitCharacter=0]="acceptSuggestionOnCommitCharacter",s[s.acceptSuggestionOnEnter=1]="acceptSuggestionOnEnter",s[s.accessibilitySupport=2]="accessibilitySupport",s[s.accessibilityPageSize=3]="accessibilityPageSize",s[s.ariaLabel=4]="ariaLabel",s[s.ariaRequired=5]="ariaRequired",s[s.autoClosingBrackets=6]="autoClosingBrackets",s[s.autoClosingComments=7]="autoClosingComments",s[s.screenReaderAnnounceInlineSuggestion=8]="screenReaderAnnounceInlineSuggestion",s[s.autoClosingDelete=9]="autoClosingDelete",s[s.autoClosingOvertype=10]="autoClosingOvertype",s[s.autoClosingQuotes=11]="autoClosingQuotes",s[s.autoIndent=12]="autoIndent",s[s.automaticLayout=13]="automaticLayout",s[s.autoSurround=14]="autoSurround",s[s.bracketPairColorization=15]="bracketPairColorization",s[s.guides=16]="guides",s[s.codeLens=17]="codeLens",s[s.codeLensFontFamily=18]="codeLensFontFamily",s[s.codeLensFontSize=19]="codeLensFontSize",s[s.colorDecorators=20]="colorDecorators",s[s.colorDecoratorsLimit=21]="colorDecoratorsLimit",s[s.columnSelection=22]="columnSelection",s[s.comments=23]="comments",s[s.contextmenu=24]="contextmenu",s[s.copyWithSyntaxHighlighting=25]="copyWithSyntaxHighlighting",s[s.cursorBlinking=26]="cursorBlinking",s[s.cursorSmoothCaretAnimation=27]="cursorSmoothCaretAnimation",s[s.cursorStyle=28]="cursorStyle",s[s.cursorSurroundingLines=29]="cursorSurroundingLines",s[s.cursorSurroundingLinesStyle=30]="cursorSurroundingLinesStyle",s[s.cursorWidth=31]="cursorWidth",s[s.disableLayerHinting=32]="disableLayerHinting",s[s.disableMonospaceOptimizations=33]="disableMonospaceOptimizations",s[s.domReadOnly=34]="domReadOnly",s[s.dragAndDrop=35]="dragAndDrop",s[s.dropIntoEditor=36]="dropIntoEditor",s[s.emptySelectionClipboard=37]="emptySelectionClipboard",s[s.experimentalWhitespaceRendering=38]="experimentalWhitespaceRendering",s[s.extraEditorClassName=39]="extraEditorClassName",s[s.fastScrollSensitivity=40]="fastScrollSensitivity",s[s.find=41]="find",s[s.fixedOverflowWidgets=42]="fixedOverflowWidgets",s[s.folding=43]="folding",s[s.foldingStrategy=44]="foldingStrategy",s[s.foldingHighlight=45]="foldingHighlight",s[s.foldingImportsByDefault=46]="foldingImportsByDefault",s[s.foldingMaximumRegions=47]="foldingMaximumRegions",s[s.unfoldOnClickAfterEndOfLine=48]="unfoldOnClickAfterEndOfLine",s[s.fontFamily=49]="fontFamily",s[s.fontInfo=50]="fontInfo",s[s.fontLigatures=51]="fontLigatures",s[s.fontSize=52]="fontSize",s[s.fontWeight=53]="fontWeight",s[s.fontVariations=54]="fontVariations",s[s.formatOnPaste=55]="formatOnPaste",s[s.formatOnType=56]="formatOnType",s[s.glyphMargin=57]="glyphMargin",s[s.gotoLocation=58]="gotoLocation",s[s.hideCursorInOverviewRuler=59]="hideCursorInOverviewRuler",s[s.hover=60]="hover",s[s.inDiffEditor=61]="inDiffEditor",s[s.inlineSuggest=62]="inlineSuggest",s[s.inlineEdit=63]="inlineEdit",s[s.letterSpacing=64]="letterSpacing",s[s.lightbulb=65]="lightbulb",s[s.lineDecorationsWidth=66]="lineDecorationsWidth",s[s.lineHeight=67]="lineHeight",s[s.lineNumbers=68]="lineNumbers",s[s.lineNumbersMinChars=69]="lineNumbersMinChars",s[s.linkedEditing=70]="linkedEditing",s[s.links=71]="links",s[s.matchBrackets=72]="matchBrackets",s[s.minimap=73]="minimap",s[s.mouseStyle=74]="mouseStyle",s[s.mouseWheelScrollSensitivity=75]="mouseWheelScrollSensitivity",s[s.mouseWheelZoom=76]="mouseWheelZoom",s[s.multiCursorMergeOverlapping=77]="multiCursorMergeOverlapping",s[s.multiCursorModifier=78]="multiCursorModifier",s[s.multiCursorPaste=79]="multiCursorPaste",s[s.multiCursorLimit=80]="multiCursorLimit",s[s.occurrencesHighlight=81]="occurrencesHighlight",s[s.overviewRulerBorder=82]="overviewRulerBorder",s[s.overviewRulerLanes=83]="overviewRulerLanes",s[s.padding=84]="padding",s[s.pasteAs=85]="pasteAs",s[s.parameterHints=86]="parameterHints",s[s.peekWidgetDefaultFocus=87]="peekWidgetDefaultFocus",s[s.placeholder=88]="placeholder",s[s.definitionLinkOpensInPeek=89]="definitionLinkOpensInPeek",s[s.quickSuggestions=90]="quickSuggestions",s[s.quickSuggestionsDelay=91]="quickSuggestionsDelay",s[s.readOnly=92]="readOnly",s[s.readOnlyMessage=93]="readOnlyMessage",s[s.renameOnType=94]="renameOnType",s[s.renderControlCharacters=95]="renderControlCharacters",s[s.renderFinalNewline=96]="renderFinalNewline",s[s.renderLineHighlight=97]="renderLineHighlight",s[s.renderLineHighlightOnlyWhenFocus=98]="renderLineHighlightOnlyWhenFocus",s[s.renderValidationDecorations=99]="renderValidationDecorations",s[s.renderWhitespace=100]="renderWhitespace",s[s.revealHorizontalRightPadding=101]="revealHorizontalRightPadding",s[s.roundedSelection=102]="roundedSelection",s[s.rulers=103]="rulers",s[s.scrollbar=104]="scrollbar",s[s.scrollBeyondLastColumn=105]="scrollBeyondLastColumn",s[s.scrollBeyondLastLine=106]="scrollBeyondLastLine",s[s.scrollPredominantAxis=107]="scrollPredominantAxis",s[s.selectionClipboard=108]="selectionClipboard",s[s.selectionHighlight=109]="selectionHighlight",s[s.selectOnLineNumbers=110]="selectOnLineNumbers",s[s.showFoldingControls=111]="showFoldingControls",s[s.showUnused=112]="showUnused",s[s.snippetSuggestions=113]="snippetSuggestions",s[s.smartSelect=114]="smartSelect",s[s.smoothScrolling=115]="smoothScrolling",s[s.stickyScroll=116]="stickyScroll",s[s.stickyTabStops=117]="stickyTabStops",s[s.stopRenderingLineAfter=118]="stopRenderingLineAfter",s[s.suggest=119]="suggest",s[s.suggestFontSize=120]="suggestFontSize",s[s.suggestLineHeight=121]="suggestLineHeight",s[s.suggestOnTriggerCharacters=122]="suggestOnTriggerCharacters",s[s.suggestSelection=123]="suggestSelection",s[s.tabCompletion=124]="tabCompletion",s[s.tabIndex=125]="tabIndex",s[s.unicodeHighlighting=126]="unicodeHighlighting",s[s.unusualLineTerminators=127]="unusualLineTerminators",s[s.useShadowDOM=128]="useShadowDOM",s[s.useTabStops=129]="useTabStops",s[s.wordBreak=130]="wordBreak",s[s.wordSegmenterLocales=131]="wordSegmenterLocales",s[s.wordSeparators=132]="wordSeparators",s[s.wordWrap=133]="wordWrap",s[s.wordWrapBreakAfterCharacters=134]="wordWrapBreakAfterCharacters",s[s.wordWrapBreakBeforeCharacters=135]="wordWrapBreakBeforeCharacters",s[s.wordWrapColumn=136]="wordWrapColumn",s[s.wordWrapOverride1=137]="wordWrapOverride1",s[s.wordWrapOverride2=138]="wordWrapOverride2",s[s.wrappingIndent=139]="wrappingIndent",s[s.wrappingStrategy=140]="wrappingStrategy",s[s.showDeprecated=141]="showDeprecated",s[s.inlayHints=142]="inlayHints",s[s.editorClassName=143]="editorClassName",s[s.pixelRatio=144]="pixelRatio",s[s.tabFocusMode=145]="tabFocusMode",s[s.layoutInfo=146]="layoutInfo",s[s.wrappingInfo=147]="wrappingInfo",s[s.defaultColorDecorators=148]="defaultColorDecorators",s[s.colorDecoratorsActivatedOn=149]="colorDecoratorsActivatedOn",s[s.inlineCompletionsAccessibilityVerbose=150]="inlineCompletionsAccessibilityVerbose"})(sW||(sW={}));var rW;(function(s){s[s.TextDefined=0]="TextDefined",s[s.LF=1]="LF",s[s.CRLF=2]="CRLF"})(rW||(rW={}));var oW;(function(s){s[s.LF=0]="LF",s[s.CRLF=1]="CRLF"})(oW||(oW={}));var aW;(function(s){s[s.Left=1]="Left",s[s.Center=2]="Center",s[s.Right=3]="Right"})(aW||(aW={}));var lW;(function(s){s[s.Increase=0]="Increase",s[s.Decrease=1]="Decrease"})(lW||(lW={}));var cW;(function(s){s[s.None=0]="None",s[s.Indent=1]="Indent",s[s.IndentOutdent=2]="IndentOutdent",s[s.Outdent=3]="Outdent"})(cW||(cW={}));var dW;(function(s){s[s.Both=0]="Both",s[s.Right=1]="Right",s[s.Left=2]="Left",s[s.None=3]="None"})(dW||(dW={}));var uW;(function(s){s[s.Type=1]="Type",s[s.Parameter=2]="Parameter"})(uW||(uW={}));var hW;(function(s){s[s.Automatic=0]="Automatic",s[s.Explicit=1]="Explicit"})(hW||(hW={}));var fW;(function(s){s[s.Invoke=0]="Invoke",s[s.Automatic=1]="Automatic"})(fW||(fW={}));var gW;(function(s){s[s.DependsOnKbLayout=-1]="DependsOnKbLayout",s[s.Unknown=0]="Unknown",s[s.Backspace=1]="Backspace",s[s.Tab=2]="Tab",s[s.Enter=3]="Enter",s[s.Shift=4]="Shift",s[s.Ctrl=5]="Ctrl",s[s.Alt=6]="Alt",s[s.PauseBreak=7]="PauseBreak",s[s.CapsLock=8]="CapsLock",s[s.Escape=9]="Escape",s[s.Space=10]="Space",s[s.PageUp=11]="PageUp",s[s.PageDown=12]="PageDown",s[s.End=13]="End",s[s.Home=14]="Home",s[s.LeftArrow=15]="LeftArrow",s[s.UpArrow=16]="UpArrow",s[s.RightArrow=17]="RightArrow",s[s.DownArrow=18]="DownArrow",s[s.Insert=19]="Insert",s[s.Delete=20]="Delete",s[s.Digit0=21]="Digit0",s[s.Digit1=22]="Digit1",s[s.Digit2=23]="Digit2",s[s.Digit3=24]="Digit3",s[s.Digit4=25]="Digit4",s[s.Digit5=26]="Digit5",s[s.Digit6=27]="Digit6",s[s.Digit7=28]="Digit7",s[s.Digit8=29]="Digit8",s[s.Digit9=30]="Digit9",s[s.KeyA=31]="KeyA",s[s.KeyB=32]="KeyB",s[s.KeyC=33]="KeyC",s[s.KeyD=34]="KeyD",s[s.KeyE=35]="KeyE",s[s.KeyF=36]="KeyF",s[s.KeyG=37]="KeyG",s[s.KeyH=38]="KeyH",s[s.KeyI=39]="KeyI",s[s.KeyJ=40]="KeyJ",s[s.KeyK=41]="KeyK",s[s.KeyL=42]="KeyL",s[s.KeyM=43]="KeyM",s[s.KeyN=44]="KeyN",s[s.KeyO=45]="KeyO",s[s.KeyP=46]="KeyP",s[s.KeyQ=47]="KeyQ",s[s.KeyR=48]="KeyR",s[s.KeyS=49]="KeyS",s[s.KeyT=50]="KeyT",s[s.KeyU=51]="KeyU",s[s.KeyV=52]="KeyV",s[s.KeyW=53]="KeyW",s[s.KeyX=54]="KeyX",s[s.KeyY=55]="KeyY",s[s.KeyZ=56]="KeyZ",s[s.Meta=57]="Meta",s[s.ContextMenu=58]="ContextMenu",s[s.F1=59]="F1",s[s.F2=60]="F2",s[s.F3=61]="F3",s[s.F4=62]="F4",s[s.F5=63]="F5",s[s.F6=64]="F6",s[s.F7=65]="F7",s[s.F8=66]="F8",s[s.F9=67]="F9",s[s.F10=68]="F10",s[s.F11=69]="F11",s[s.F12=70]="F12",s[s.F13=71]="F13",s[s.F14=72]="F14",s[s.F15=73]="F15",s[s.F16=74]="F16",s[s.F17=75]="F17",s[s.F18=76]="F18",s[s.F19=77]="F19",s[s.F20=78]="F20",s[s.F21=79]="F21",s[s.F22=80]="F22",s[s.F23=81]="F23",s[s.F24=82]="F24",s[s.NumLock=83]="NumLock",s[s.ScrollLock=84]="ScrollLock",s[s.Semicolon=85]="Semicolon",s[s.Equal=86]="Equal",s[s.Comma=87]="Comma",s[s.Minus=88]="Minus",s[s.Period=89]="Period",s[s.Slash=90]="Slash",s[s.Backquote=91]="Backquote",s[s.BracketLeft=92]="BracketLeft",s[s.Backslash=93]="Backslash",s[s.BracketRight=94]="BracketRight",s[s.Quote=95]="Quote",s[s.OEM_8=96]="OEM_8",s[s.IntlBackslash=97]="IntlBackslash",s[s.Numpad0=98]="Numpad0",s[s.Numpad1=99]="Numpad1",s[s.Numpad2=100]="Numpad2",s[s.Numpad3=101]="Numpad3",s[s.Numpad4=102]="Numpad4",s[s.Numpad5=103]="Numpad5",s[s.Numpad6=104]="Numpad6",s[s.Numpad7=105]="Numpad7",s[s.Numpad8=106]="Numpad8",s[s.Numpad9=107]="Numpad9",s[s.NumpadMultiply=108]="NumpadMultiply",s[s.NumpadAdd=109]="NumpadAdd",s[s.NUMPAD_SEPARATOR=110]="NUMPAD_SEPARATOR",s[s.NumpadSubtract=111]="NumpadSubtract",s[s.NumpadDecimal=112]="NumpadDecimal",s[s.NumpadDivide=113]="NumpadDivide",s[s.KEY_IN_COMPOSITION=114]="KEY_IN_COMPOSITION",s[s.ABNT_C1=115]="ABNT_C1",s[s.ABNT_C2=116]="ABNT_C2",s[s.AudioVolumeMute=117]="AudioVolumeMute",s[s.AudioVolumeUp=118]="AudioVolumeUp",s[s.AudioVolumeDown=119]="AudioVolumeDown",s[s.BrowserSearch=120]="BrowserSearch",s[s.BrowserHome=121]="BrowserHome",s[s.BrowserBack=122]="BrowserBack",s[s.BrowserForward=123]="BrowserForward",s[s.MediaTrackNext=124]="MediaTrackNext",s[s.MediaTrackPrevious=125]="MediaTrackPrevious",s[s.MediaStop=126]="MediaStop",s[s.MediaPlayPause=127]="MediaPlayPause",s[s.LaunchMediaPlayer=128]="LaunchMediaPlayer",s[s.LaunchMail=129]="LaunchMail",s[s.LaunchApp2=130]="LaunchApp2",s[s.Clear=131]="Clear",s[s.MAX_VALUE=132]="MAX_VALUE"})(gW||(gW={}));var pW;(function(s){s[s.Hint=1]="Hint",s[s.Info=2]="Info",s[s.Warning=4]="Warning",s[s.Error=8]="Error"})(pW||(pW={}));var mW;(function(s){s[s.Unnecessary=1]="Unnecessary",s[s.Deprecated=2]="Deprecated"})(mW||(mW={}));var _W;(function(s){s[s.Inline=1]="Inline",s[s.Gutter=2]="Gutter"})(_W||(_W={}));var bW;(function(s){s[s.Normal=1]="Normal",s[s.Underlined=2]="Underlined"})(bW||(bW={}));var vW;(function(s){s[s.UNKNOWN=0]="UNKNOWN",s[s.TEXTAREA=1]="TEXTAREA",s[s.GUTTER_GLYPH_MARGIN=2]="GUTTER_GLYPH_MARGIN",s[s.GUTTER_LINE_NUMBERS=3]="GUTTER_LINE_NUMBERS",s[s.GUTTER_LINE_DECORATIONS=4]="GUTTER_LINE_DECORATIONS",s[s.GUTTER_VIEW_ZONE=5]="GUTTER_VIEW_ZONE",s[s.CONTENT_TEXT=6]="CONTENT_TEXT",s[s.CONTENT_EMPTY=7]="CONTENT_EMPTY",s[s.CONTENT_VIEW_ZONE=8]="CONTENT_VIEW_ZONE",s[s.CONTENT_WIDGET=9]="CONTENT_WIDGET",s[s.OVERVIEW_RULER=10]="OVERVIEW_RULER",s[s.SCROLLBAR=11]="SCROLLBAR",s[s.OVERLAY_WIDGET=12]="OVERLAY_WIDGET",s[s.OUTSIDE_EDITOR=13]="OUTSIDE_EDITOR"})(vW||(vW={}));var wW;(function(s){s[s.AIGenerated=1]="AIGenerated"})(wW||(wW={}));var CW;(function(s){s[s.Invoke=0]="Invoke",s[s.Automatic=1]="Automatic"})(CW||(CW={}));var yW;(function(s){s[s.TOP_RIGHT_CORNER=0]="TOP_RIGHT_CORNER",s[s.BOTTOM_RIGHT_CORNER=1]="BOTTOM_RIGHT_CORNER",s[s.TOP_CENTER=2]="TOP_CENTER"})(yW||(yW={}));var SW;(function(s){s[s.Left=1]="Left",s[s.Center=2]="Center",s[s.Right=4]="Right",s[s.Full=7]="Full"})(SW||(SW={}));var xW;(function(s){s[s.Word=0]="Word",s[s.Line=1]="Line",s[s.Suggest=2]="Suggest"})(xW||(xW={}));var LW;(function(s){s[s.Left=0]="Left",s[s.Right=1]="Right",s[s.None=2]="None",s[s.LeftOfInjectedText=3]="LeftOfInjectedText",s[s.RightOfInjectedText=4]="RightOfInjectedText"})(LW||(LW={}));var kW;(function(s){s[s.Off=0]="Off",s[s.On=1]="On",s[s.Relative=2]="Relative",s[s.Interval=3]="Interval",s[s.Custom=4]="Custom"})(kW||(kW={}));var IW;(function(s){s[s.None=0]="None",s[s.Text=1]="Text",s[s.Blocks=2]="Blocks"})(IW||(IW={}));var EW;(function(s){s[s.Smooth=0]="Smooth",s[s.Immediate=1]="Immediate"})(EW||(EW={}));var DW;(function(s){s[s.Auto=1]="Auto",s[s.Hidden=2]="Hidden",s[s.Visible=3]="Visible"})(DW||(DW={}));var TW;(function(s){s[s.LTR=0]="LTR",s[s.RTL=1]="RTL"})(TW||(TW={}));var NW;(function(s){s.Off="off",s.OnCode="onCode",s.On="on"})(NW||(NW={}));var RW;(function(s){s[s.Invoke=1]="Invoke",s[s.TriggerCharacter=2]="TriggerCharacter",s[s.ContentChange=3]="ContentChange"})(RW||(RW={}));var AW;(function(s){s[s.File=0]="File",s[s.Module=1]="Module",s[s.Namespace=2]="Namespace",s[s.Package=3]="Package",s[s.Class=4]="Class",s[s.Method=5]="Method",s[s.Property=6]="Property",s[s.Field=7]="Field",s[s.Constructor=8]="Constructor",s[s.Enum=9]="Enum",s[s.Interface=10]="Interface",s[s.Function=11]="Function",s[s.Variable=12]="Variable",s[s.Constant=13]="Constant",s[s.String=14]="String",s[s.Number=15]="Number",s[s.Boolean=16]="Boolean",s[s.Array=17]="Array",s[s.Object=18]="Object",s[s.Key=19]="Key",s[s.Null=20]="Null",s[s.EnumMember=21]="EnumMember",s[s.Struct=22]="Struct",s[s.Event=23]="Event",s[s.Operator=24]="Operator",s[s.TypeParameter=25]="TypeParameter"})(AW||(AW={}));var PW;(function(s){s[s.Deprecated=1]="Deprecated"})(PW||(PW={}));var MW;(function(s){s[s.Hidden=0]="Hidden",s[s.Blink=1]="Blink",s[s.Smooth=2]="Smooth",s[s.Phase=3]="Phase",s[s.Expand=4]="Expand",s[s.Solid=5]="Solid"})(MW||(MW={}));var OW;(function(s){s[s.Line=1]="Line",s[s.Block=2]="Block",s[s.Underline=3]="Underline",s[s.LineThin=4]="LineThin",s[s.BlockOutline=5]="BlockOutline",s[s.UnderlineThin=6]="UnderlineThin"})(OW||(OW={}));var FW;(function(s){s[s.AlwaysGrowsWhenTypingAtEdges=0]="AlwaysGrowsWhenTypingAtEdges",s[s.NeverGrowsWhenTypingAtEdges=1]="NeverGrowsWhenTypingAtEdges",s[s.GrowsOnlyWhenTypingBefore=2]="GrowsOnlyWhenTypingBefore",s[s.GrowsOnlyWhenTypingAfter=3]="GrowsOnlyWhenTypingAfter"})(FW||(FW={}));var VW;(function(s){s[s.None=0]="None",s[s.Same=1]="Same",s[s.Indent=2]="Indent",s[s.DeepIndent=3]="DeepIndent"})(VW||(VW={}));var Jf;let RRe=(Jf=class{static chord(e,t){return ns(e,t)}},Jf.CtrlCmd=2048,Jf.Shift=1024,Jf.Alt=512,Jf.WinCtrl=256,Jf);function Lue(){return{editor:void 0,languages:void 0,CancellationTokenSource:mn,Emitter:Z,KeyCode:gW,KeyMod:RRe,Position:X,Range:F,Selection:Ue,SelectionDirection:TW,MarkerSeverity:pW,MarkerTag:mW,Uri:Je,Token:Yk}}function ARe(s,e){const t=s;typeof t.vscodeWindowId!="number"&&Object.defineProperty(t,"vscodeWindowId",{get:()=>e})}const Ri=window;function kue(s){return s}class PRe{constructor(e,t){this.lastCache=void 0,this.lastArgKey=void 0,typeof e=="function"?(this._fn=e,this._computeKey=kue):(this._fn=t,this._computeKey=e.getCacheKey)}get(e){const t=this._computeKey(e);return this.lastArgKey!==t&&(this.lastArgKey=t,this.lastCache=this._fn(e)),this.lastCache}}class Xee{get cachedValues(){return this._map}constructor(e,t){this._map=new Map,this._map2=new Map,typeof e=="function"?(this._fn=e,this._computeKey=kue):(this._fn=t,this._computeKey=e.getCacheKey)}get(e){const t=this._computeKey(e);if(this._map2.has(t))return this._map2.get(t);const i=this._fn(e);return this._map.set(e,i),this._map2.set(t,i),i}}class uu{constructor(e){this.executor=e,this._didRun=!1}get value(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}}function Iue(s){return!s||typeof s!="string"?!0:s.trim().length===0}const MRe=/{(\d+)}/g;function lw(s,...e){return e.length===0?s:s.replace(MRe,function(t,i){const n=parseInt(i,10);return isNaN(n)||n<0||n>=e.length?t:e[n]})}function ORe(s){return s.replace(/[<>"'&]/g,e=>{switch(e){case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&apos;";case"&":return"&amp;"}return e})}function DL(s){return s.replace(/[<>&]/g,function(e){switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";default:return e}})}function Nl(s){return s.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function FRe(s,e=" "){const t=WE(s,e);return Eue(t,e)}function WE(s,e){if(!s||!e)return s;const t=e.length;if(t===0||s.length===0)return s;let i=0;for(;s.indexOf(e,i)===i;)i=i+t;return s.substring(i)}function Eue(s,e){if(!s||!e)return s;const t=e.length,i=s.length;if(t===0||i===0)return s;let n=i,r=-1;for(;r=s.lastIndexOf(e,n-1),!(r===-1||r+t!==n);){if(r===0)return"";n=r}return s.substring(0,n)}function VRe(s){return s.replace(/[\-\\\{\}\+\?\|\^\$\.\,\[\]\(\)\#\s]/g,"\\$&").replace(/[\*]/g,".*")}function BRe(s){return s.replace(/\*/g,"")}function Due(s,e,t={}){if(!s)throw new Error("Cannot create regex from empty string");e||(s=Nl(s)),t.wholeWord&&(/\B/.test(s.charAt(0))||(s="\\b"+s),/\B/.test(s.charAt(s.length-1))||(s=s+"\\b"));let i="";return t.global&&(i+="g"),t.matchCase||(i+="i"),t.multiline&&(i+="m"),t.unicode&&(i+="u"),new RegExp(s,i)}function WRe(s){return s.source==="^"||s.source==="^$"||s.source==="$"||s.source==="^\\s*$"?!1:!!(s.exec("")&&s.lastIndex===0)}function Uh(s){return s.split(/\r\n|\r|\n/)}function HRe(s){const e=[],t=s.split(/(\r\n|\r|\n)/);for(let i=0;i<Math.ceil(t.length/2);i++)e.push(t[2*i]+(t[2*i+1]??""));return e}function Zr(s){for(let e=0,t=s.length;e<t;e++){const i=s.charCodeAt(e);if(i!==32&&i!==9)return e}return-1}function Ti(s,e=0,t=s.length){for(let i=e;i<t;i++){const n=s.charCodeAt(i);if(n!==32&&n!==9)return s.substring(e,i)}return s.substring(e,t)}function nu(s,e=s.length-1){for(let t=e;t>=0;t--){const i=s.charCodeAt(t);if(i!==32&&i!==9)return t}return-1}function eI(s,e){return s<e?-1:s>e?1:0}function Eq(s,e,t=0,i=s.length,n=0,r=e.length){for(;t<i&&n<r;t++,n++){const l=s.charCodeAt(t),c=e.charCodeAt(n);if(l<c)return-1;if(l>c)return 1}const o=i-t,a=r-n;return o<a?-1:o>a?1:0}function BW(s,e){return HE(s,e,0,s.length,0,e.length)}function HE(s,e,t=0,i=s.length,n=0,r=e.length){for(;t<i&&n<r;t++,n++){let l=s.charCodeAt(t),c=e.charCodeAt(n);if(l===c)continue;if(l>=128||c>=128)return Eq(s.toLowerCase(),e.toLowerCase(),t,i,n,r);zp(l)&&(l-=32),zp(c)&&(c-=32);const d=l-c;if(d!==0)return d}const o=i-t,a=r-n;return o<a?-1:o>a?1:0}function XT(s){return s>=48&&s<=57}function zp(s){return s>=97&&s<=122}function sh(s){return s>=65&&s<=90}function SC(s,e){return s.length===e.length&&HE(s,e)===0}function Dq(s,e){const t=e.length;return e.length>s.length?!1:HE(s,e,0,t)===0}function zm(s,e){const t=Math.min(s.length,e.length);let i;for(i=0;i<t;i++)if(s.charCodeAt(i)!==e.charCodeAt(i))return i;return t}function B2(s,e){const t=Math.min(s.length,e.length);let i;const n=s.length-1,r=e.length-1;for(i=0;i<t;i++)if(s.charCodeAt(n-i)!==e.charCodeAt(r-i))return i;return t}function ws(s){return 55296<=s&&s<=56319}function cw(s){return 56320<=s&&s<=57343}function Tq(s,e){return(s-55296<<10)+(e-56320)+65536}function W2(s,e,t){const i=s.charCodeAt(t);if(ws(i)&&t+1<e){const n=s.charCodeAt(t+1);if(cw(n))return Tq(i,n)}return i}function zRe(s,e){const t=s.charCodeAt(e-1);if(cw(t)&&e>1){const i=s.charCodeAt(e-2);if(ws(i))return Tq(i,t)}return t}class Nq{get offset(){return this._offset}constructor(e,t=0){this._str=e,this._len=e.length,this._offset=t}setOffset(e){this._offset=e}prevCodePoint(){const e=zRe(this._str,this._offset);return this._offset-=e>=65536?2:1,e}nextCodePoint(){const e=W2(this._str,this._len,this._offset);return this._offset+=e>=65536?2:1,e}eol(){return this._offset>=this._len}}class H2{get offset(){return this._iterator.offset}constructor(e,t=0){this._iterator=new Nq(e,t)}nextGraphemeLength(){const e=z2.getInstance(),t=this._iterator,i=t.offset;let n=e.getGraphemeBreakType(t.nextCodePoint());for(;!t.eol();){const r=t.offset,o=e.getGraphemeBreakType(t.nextCodePoint());if(Zee(n,o)){t.setOffset(r);break}n=o}return t.offset-i}prevGraphemeLength(){const e=z2.getInstance(),t=this._iterator,i=t.offset;let n=e.getGraphemeBreakType(t.prevCodePoint());for(;t.offset>0;){const r=t.offset,o=e.getGraphemeBreakType(t.prevCodePoint());if(Zee(o,n)){t.setOffset(r);break}n=o}return i-t.offset}eol(){return this._iterator.eol()}}function Rq(s,e){return new H2(s,e).nextGraphemeLength()}function Tue(s,e){return new H2(s,e).prevGraphemeLength()}function URe(s,e){e>0&&cw(s.charCodeAt(e))&&e--;const t=e+Rq(s,e);return[t-Tue(s,t),t]}let q9;function jRe(){return/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDC7\uFDF0-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE35\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDD23\uDE80-\uDEA9\uDEAD-\uDF45\uDF51-\uDF81\uDF86-\uDFF6]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD4B-\uDFFF]|\uD83B[\uDC00-\uDEBB])/}function h1(s){return q9||(q9=jRe()),q9.test(s)}const $Re=/^[\t\n\r\x20-\x7E]*$/;function zE(s){return $Re.test(s)}const Nue=/[\u2028\u2029]/;function Rue(s){return Nue.test(s)}function Um(s){return s>=11904&&s<=55215||s>=63744&&s<=64255||s>=65281&&s<=65374}function Aq(s){return s>=127462&&s<=127487||s===8986||s===8987||s===9200||s===9203||s>=9728&&s<=10175||s===11088||s===11093||s>=127744&&s<=128591||s>=128640&&s<=128764||s>=128992&&s<=129008||s>=129280&&s<=129535||s>=129648&&s<=129782}const qRe="\uFEFF";function Pq(s){return!!(s&&s.length>0&&s.charCodeAt(0)===65279)}function KRe(s,e=!1){return s?(e&&(s=s.replace(/\\./g,"")),s.toLowerCase()!==s):!1}function Aue(s){return s=s%(2*26),s<26?String.fromCharCode(97+s):String.fromCharCode(65+s-26)}function Zee(s,e){return s===0?e!==5&&e!==7:s===2&&e===3?!1:s===4||s===2||s===3||e===4||e===2||e===3?!0:!(s===8&&(e===8||e===9||e===11||e===12)||(s===11||s===9)&&(e===9||e===10)||(s===12||s===10)&&e===10||e===5||e===13||e===7||s===1||s===13&&e===14||s===6&&e===6)}const Eb=class Eb{static getInstance(){return Eb._INSTANCE||(Eb._INSTANCE=new Eb),Eb._INSTANCE}constructor(){this._data=GRe()}getGraphemeBreakType(e){if(e<32)return e===10?3:e===13?2:4;if(e<127)return 0;const t=this._data,i=t.length/3;let n=1;for(;n<=i;)if(e<t[3*n])n=2*n;else if(e>t[3*n+1])n=2*n+1;else return t[3*n+2];return 0}};Eb._INSTANCE=null;let z2=Eb;function GRe(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}function QRe(s,e){if(s===0)return 0;const t=YRe(s,e);if(t!==void 0)return t;const i=new Nq(e,s);return i.prevCodePoint(),i.offset}function YRe(s,e){const t=new Nq(e,s);let i=t.prevCodePoint();for(;XRe(i)||i===65039||i===8419;){if(t.offset===0)return;i=t.prevCodePoint()}if(!Aq(i))return;let n=t.offset;return n>0&&t.prevCodePoint()===8205&&(n=t.offset),n}function XRe(s){return 127995<=s&&s<=127999}const Pue=" ",Qu=class Qu{static getInstance(e){return Qu.cache.get(Array.from(e))}static getLocales(){return Qu._locales.value}constructor(e){this.confusableDictionary=e}isAmbiguous(e){return this.confusableDictionary.has(e)}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}};Qu.ambiguousCharacterData=new uu(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}')),Qu.cache=new PRe({getCacheKey:JSON.stringify},e=>{function t(d){const u=new Map;for(let h=0;h<d.length;h+=2)u.set(d[h],d[h+1]);return u}function i(d,u){const h=new Map(d);for(const[g,p]of u)h.set(g,p);return h}function n(d,u){if(!d)return u;const h=new Map;for(const[g,p]of d)u.has(g)&&h.set(g,p);return h}const r=Qu.ambiguousCharacterData.value;let o=e.filter(d=>!d.startsWith("_")&&d in r);o.length===0&&(o=["_default"]);let a;for(const d of o){const u=t(r[d]);a=n(a,u)}const l=t(r._common),c=i(l,a);return new Qu(c)}),Qu._locales=new uu(()=>Object.keys(Qu.ambiguousCharacterData.value).filter(e=>!e.startsWith("_")));let tI=Qu;const GC=class GC{static getRawData(){return JSON.parse("[9,10,11,12,13,32,127,160,173,847,1564,4447,4448,6068,6069,6155,6156,6157,6158,7355,7356,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8203,8204,8205,8206,8207,8234,8235,8236,8237,8238,8239,8287,8288,8289,8290,8291,8292,8293,8294,8295,8296,8297,8298,8299,8300,8301,8302,8303,10240,12288,12644,65024,65025,65026,65027,65028,65029,65030,65031,65032,65033,65034,65035,65036,65037,65038,65039,65279,65440,65520,65521,65522,65523,65524,65525,65526,65527,65528,65532,78844,119155,119156,119157,119158,119159,119160,119161,119162,917504,917505,917506,917507,917508,917509,917510,917511,917512,917513,917514,917515,917516,917517,917518,917519,917520,917521,917522,917523,917524,917525,917526,917527,917528,917529,917530,917531,917532,917533,917534,917535,917536,917537,917538,917539,917540,917541,917542,917543,917544,917545,917546,917547,917548,917549,917550,917551,917552,917553,917554,917555,917556,917557,917558,917559,917560,917561,917562,917563,917564,917565,917566,917567,917568,917569,917570,917571,917572,917573,917574,917575,917576,917577,917578,917579,917580,917581,917582,917583,917584,917585,917586,917587,917588,917589,917590,917591,917592,917593,917594,917595,917596,917597,917598,917599,917600,917601,917602,917603,917604,917605,917606,917607,917608,917609,917610,917611,917612,917613,917614,917615,917616,917617,917618,917619,917620,917621,917622,917623,917624,917625,917626,917627,917628,917629,917630,917631,917760,917761,917762,917763,917764,917765,917766,917767,917768,917769,917770,917771,917772,917773,917774,917775,917776,917777,917778,917779,917780,917781,917782,917783,917784,917785,917786,917787,917788,917789,917790,917791,917792,917793,917794,917795,917796,917797,917798,917799,917800,917801,917802,917803,917804,917805,917806,917807,917808,917809,917810,917811,917812,917813,917814,917815,917816,917817,917818,917819,917820,917821,917822,917823,917824,917825,917826,917827,917828,917829,917830,917831,917832,917833,917834,917835,917836,917837,917838,917839,917840,917841,917842,917843,917844,917845,917846,917847,917848,917849,917850,917851,917852,917853,917854,917855,917856,917857,917858,917859,917860,917861,917862,917863,917864,917865,917866,917867,917868,917869,917870,917871,917872,917873,917874,917875,917876,917877,917878,917879,917880,917881,917882,917883,917884,917885,917886,917887,917888,917889,917890,917891,917892,917893,917894,917895,917896,917897,917898,917899,917900,917901,917902,917903,917904,917905,917906,917907,917908,917909,917910,917911,917912,917913,917914,917915,917916,917917,917918,917919,917920,917921,917922,917923,917924,917925,917926,917927,917928,917929,917930,917931,917932,917933,917934,917935,917936,917937,917938,917939,917940,917941,917942,917943,917944,917945,917946,917947,917948,917949,917950,917951,917952,917953,917954,917955,917956,917957,917958,917959,917960,917961,917962,917963,917964,917965,917966,917967,917968,917969,917970,917971,917972,917973,917974,917975,917976,917977,917978,917979,917980,917981,917982,917983,917984,917985,917986,917987,917988,917989,917990,917991,917992,917993,917994,917995,917996,917997,917998,917999]")}static getData(){return this._data||(this._data=new Set(GC.getRawData())),this._data}static isInvisibleCharacter(e){return GC.getData().has(e)}static get codePoints(){return GC.getData()}};GC._data=void 0;let Gb=GC;const NM=class NM{constructor(){this.mapWindowIdToZoomFactor=new Map}getZoomFactor(e){return this.mapWindowIdToZoomFactor.get(this.getWindowId(e))??1}getWindowId(e){return e.vscodeWindowId}};NM.INSTANCE=new NM;let WW=NM;function Mue(s,e,t){typeof e=="string"&&(e=s.matchMedia(e)),e.addEventListener("change",t)}function ZRe(s){return WW.INSTANCE.getZoomFactor(s)}const aS=navigator.userAgent,_c=aS.indexOf("Firefox")>=0,Z4=aS.indexOf("AppleWebKit")>=0,UE=aS.indexOf("Chrome")>=0,jm=!UE&&aS.indexOf("Safari")>=0,Oue=!UE&&!jm&&Z4;aS.indexOf("Electron/")>=0;const Jee=aS.indexOf("Android")>=0;let K9=!1;if(typeof Ri.matchMedia=="function"){const s=Ri.matchMedia("(display-mode: standalone) or (display-mode: window-controls-overlay)"),e=Ri.matchMedia("(display-mode: fullscreen)");K9=s.matches,Mue(Ri,s,({matches:t})=>{K9&&e.matches||(K9=t)})}const Mq={clipboard:{writeText:Th||document.queryCommandSupported&&document.queryCommandSupported("copy")||!!(navigator&&navigator.clipboard&&navigator.clipboard.writeText),readText:Th||!!(navigator&&navigator.clipboard&&navigator.clipboard.readText)},pointerEvents:Ri.PointerEvent&&("ontouchstart"in Ri||navigator.maxTouchPoints>0)};function HW(s,e){if(typeof s=="number"){if(s===0)return null;const t=(s&65535)>>>0,i=(s&4294901760)>>>16;return i!==0?new G9([ZT(t,e),ZT(i,e)]):new G9([ZT(t,e)])}else{const t=[];for(let i=0;i<s.length;i++)t.push(ZT(s[i],e));return new G9(t)}}function ZT(s,e){const t=!!(s&2048),i=!!(s&256),n=e===2?i:t,r=!!(s&1024),o=!!(s&512),a=e===2?t:i,l=s&255;return new yg(n,r,o,a,l)}class yg{constructor(e,t,i,n,r){this.ctrlKey=e,this.shiftKey=t,this.altKey=i,this.metaKey=n,this.keyCode=r}equals(e){return e instanceof yg&&this.ctrlKey===e.ctrlKey&&this.shiftKey===e.shiftKey&&this.altKey===e.altKey&&this.metaKey===e.metaKey&&this.keyCode===e.keyCode}isModifierKey(){return this.keyCode===0||this.keyCode===5||this.keyCode===57||this.keyCode===6||this.keyCode===4}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===5||this.shiftKey&&this.keyCode===4||this.altKey&&this.keyCode===6||this.metaKey&&this.keyCode===57}}class G9{constructor(e){if(e.length===0)throw fc("chords");this.chords=e}}class JRe{constructor(e,t,i,n,r,o){this.ctrlKey=e,this.shiftKey=t,this.altKey=i,this.metaKey=n,this.keyLabel=r,this.keyAriaLabel=o}}class e2e{}function t2e(s){if(s.charCode){const t=String.fromCharCode(s.charCode).toUpperCase();return Of.fromString(t)}const e=s.keyCode;if(e===3)return 7;if(_c)switch(e){case 59:return 85;case 60:if(Lo)return 97;break;case 61:return 86;case 107:return 109;case 109:return 111;case 173:return 88;case 224:if(Wt)return 57;break}else if(Z4){if(Wt&&e===93)return 57;if(!Wt&&e===92)return 57}return gue[e]||0}const i2e=Wt?256:2048,n2e=512,s2e=1024,r2e=Wt?2048:256;class Mi{constructor(e){var i;this._standardKeyboardEventBrand=!0;const t=e;this.browserEvent=t,this.target=t.target,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,this.altGraphKey=(i=t.getModifierState)==null?void 0:i.call(t,"AltGraph"),this.keyCode=t2e(t),this.code=t.code,this.ctrlKey=this.ctrlKey||this.keyCode===5,this.altKey=this.altKey||this.keyCode===6,this.shiftKey=this.shiftKey||this.keyCode===4,this.metaKey=this.metaKey||this.keyCode===57,this._asKeybinding=this._computeKeybinding(),this._asKeyCodeChord=this._computeKeyCodeChord()}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()}toKeyCodeChord(){return this._asKeyCodeChord}equals(e){return this._asKeybinding===e}_computeKeybinding(){let e=0;this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode);let t=0;return this.ctrlKey&&(t|=i2e),this.altKey&&(t|=n2e),this.shiftKey&&(t|=s2e),this.metaKey&&(t|=r2e),t|=e,t}_computeKeyCodeChord(){let e=0;return this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode),new yg(this.ctrlKey,this.shiftKey,this.altKey,this.metaKey,e)}}const ete=new WeakMap;function o2e(s){if(!s.parent||s.parent===s)return null;try{const e=s.location,t=s.parent.location;if(e.origin!=="null"&&t.origin!=="null"&&e.origin!==t.origin)return null}catch{return null}return s.parent}class a2e{static getSameOriginWindowChain(e){let t=ete.get(e);if(!t){t=[],ete.set(e,t);let i=e,n;do n=o2e(i),n?t.push({window:new WeakRef(i),iframeElement:i.frameElement||null}):t.push({window:new WeakRef(i),iframeElement:null}),i=n;while(i)}return t.slice(0)}static getPositionOfChildWindowRelativeToAncestorWindow(e,t){if(!t||e===t)return{top:0,left:0};let i=0,n=0;const r=this.getSameOriginWindowChain(e);for(const o of r){const a=o.window.deref();if(i+=(a==null?void 0:a.scrollY)??0,n+=(a==null?void 0:a.scrollX)??0,a===t||!o.iframeElement)break;const l=o.iframeElement.getBoundingClientRect();i+=l.top,n+=l.left}return{top:i,left:n}}}class Xc{constructor(e,t){this.timestamp=Date.now(),this.browserEvent=t,this.leftButton=t.button===0,this.middleButton=t.button===1,this.rightButton=t.button===2,this.buttons=t.buttons,this.target=t.target,this.detail=t.detail||1,t.type==="dblclick"&&(this.detail=2),this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,typeof t.pageX=="number"?(this.posx=t.pageX,this.posy=t.pageY):(this.posx=t.clientX+this.target.ownerDocument.body.scrollLeft+this.target.ownerDocument.documentElement.scrollLeft,this.posy=t.clientY+this.target.ownerDocument.body.scrollTop+this.target.ownerDocument.documentElement.scrollTop);const i=a2e.getPositionOfChildWindowRelativeToAncestorWindow(e,t.view);this.posx-=i.left,this.posy-=i.top}preventDefault(){this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent.stopPropagation()}}class dw{constructor(e,t=0,i=0){var r;this.browserEvent=e||null,this.target=e?e.target||e.targetNode||e.srcElement:null,this.deltaY=i,this.deltaX=t;let n=!1;if(UE){const o=navigator.userAgent.match(/Chrome\/(\d+)/);n=(o?parseInt(o[1]):123)<=122}if(e){const o=e,a=e,l=((r=e.view)==null?void 0:r.devicePixelRatio)||1;if(typeof o.wheelDeltaY<"u")n?this.deltaY=o.wheelDeltaY/(120*l):this.deltaY=o.wheelDeltaY/120;else if(typeof a.VERTICAL_AXIS<"u"&&a.axis===a.VERTICAL_AXIS)this.deltaY=-a.detail/3;else if(e.type==="wheel"){const c=e;c.deltaMode===c.DOM_DELTA_LINE?_c&&!Wt?this.deltaY=-e.deltaY/3:this.deltaY=-e.deltaY:this.deltaY=-e.deltaY/40}if(typeof o.wheelDeltaX<"u")jm&&gr?this.deltaX=-(o.wheelDeltaX/120):n?this.deltaX=o.wheelDeltaX/(120*l):this.deltaX=o.wheelDeltaX/120;else if(typeof a.HORIZONTAL_AXIS<"u"&&a.axis===a.HORIZONTAL_AXIS)this.deltaX=-e.detail/3;else if(e.type==="wheel"){const c=e;c.deltaMode===c.DOM_DELTA_LINE?_c&&!Wt?this.deltaX=-e.deltaX/3:this.deltaX=-e.deltaX:this.deltaX=-e.deltaX/40}this.deltaY===0&&this.deltaX===0&&e.wheelDelta&&(n?this.deltaY=e.wheelDelta/(120*l):this.deltaY=e.wheelDelta/120)}}preventDefault(){var e;(e=this.browserEvent)==null||e.preventDefault()}stopPropagation(){var e;(e=this.browserEvent)==null||e.stopPropagation()}}const Fue=Symbol("MicrotaskDelay");function zW(s){return!!s&&typeof s.then=="function"}function xs(s){const e=new mn,t=s(e.token),i=new Promise((n,r)=>{const o=e.token.onCancellationRequested(()=>{o.dispose(),r(new od)});Promise.resolve(t).then(a=>{o.dispose(),e.dispose(),n(a)},a=>{o.dispose(),e.dispose(),r(a)})});return new class{cancel(){e.cancel(),e.dispose()}then(n,r){return i.then(n,r)}catch(n){return this.then(void 0,n)}finally(n){return i.finally(n)}}}function jE(s,e,t){return new Promise((i,n)=>{const r=e.onCancellationRequested(()=>{r.dispose(),i(t)});s.then(i,n).finally(()=>r.dispose())})}class l2e{constructor(){this.isDisposed=!1,this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(e){if(this.isDisposed)return Promise.reject(new Error("Throttler is disposed"));if(this.activePromise){if(this.queuedPromiseFactory=e,!this.queuedPromise){const t=()=>{if(this.queuedPromise=null,this.isDisposed)return;const i=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,i};this.queuedPromise=new Promise(i=>{this.activePromise.then(t,t).then(i)})}return new Promise((t,i)=>{this.queuedPromise.then(t,i)})}return this.activePromise=e(),new Promise((t,i)=>{this.activePromise.then(n=>{this.activePromise=null,t(n)},n=>{this.activePromise=null,i(n)})})}dispose(){this.isDisposed=!0}}const c2e=(s,e)=>{let t=!0;const i=setTimeout(()=>{t=!1,e()},s);return{isTriggered:()=>t,dispose:()=>{clearTimeout(i),t=!1}}},d2e=s=>{let e=!0;return queueMicrotask(()=>{e&&(e=!1,s())}),{isTriggered:()=>e,dispose:()=>{e=!1}}};class bc{constructor(e){this.defaultDelay=e,this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}trigger(e,t=this.defaultDelay){this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((n,r)=>{this.doResolve=n,this.doReject=r}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){const n=this.task;return this.task=null,n()}}));const i=()=>{var n;this.deferred=null,(n=this.doResolve)==null||n.call(this,null)};return this.deferred=t===Fue?d2e(i):c2e(t,i),this.completionPromise}isTriggered(){var e;return!!((e=this.deferred)!=null&&e.isTriggered())}cancel(){var e;this.cancelTimeout(),this.completionPromise&&((e=this.doReject)==null||e.call(this,new od),this.completionPromise=null)}cancelTimeout(){var e;(e=this.deferred)==null||e.dispose(),this.deferred=null}dispose(){this.cancel()}}class Vue{constructor(e){this.delayer=new bc(e),this.throttler=new l2e}trigger(e,t){return this.delayer.trigger(()=>this.throttler.queue(e),t)}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose(),this.throttler.dispose()}}function Sg(s,e){return e?new Promise((t,i)=>{const n=setTimeout(()=>{r.dispose(),t()},s),r=e.onCancellationRequested(()=>{clearTimeout(n),r.dispose(),i(new od)})}):xs(t=>Sg(s,t))}function $m(s,e=0,t){const i=setTimeout(()=>{s(),t&&n.dispose()},e),n=Ye(()=>{clearTimeout(i),t==null||t.deleteAndLeak(n)});return t==null||t.add(n),n}function Oq(s,e=i=>!!i,t=null){let i=0;const n=s.length,r=()=>{if(i>=n)return Promise.resolve(t);const o=s[i++];return Promise.resolve(o()).then(l=>e(l)?Promise.resolve(l):r())};return r()}class gd{constructor(e,t){this._isDisposed=!1,this._token=-1,typeof e=="function"&&typeof t=="number"&&this.setIfNotSet(e,t)}dispose(){this.cancel(),this._isDisposed=!0}cancel(){this._token!==-1&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(e,t){if(this._isDisposed)throw new di("Calling 'cancelAndSet' on a disposed TimeoutTimer");this.cancel(),this._token=setTimeout(()=>{this._token=-1,e()},t)}setIfNotSet(e,t){if(this._isDisposed)throw new di("Calling 'setIfNotSet' on a disposed TimeoutTimer");this._token===-1&&(this._token=setTimeout(()=>{this._token=-1,e()},t))}}class Fq{constructor(){this.disposable=void 0,this.isDisposed=!1}cancel(){var e;(e=this.disposable)==null||e.dispose(),this.disposable=void 0}cancelAndSet(e,t,i=globalThis){if(this.isDisposed)throw new di("Calling 'cancelAndSet' on a disposed IntervalTimer");this.cancel();const n=i.setInterval(()=>{e()},t);this.disposable=Ye(()=>{i.clearInterval(n),this.disposable=void 0})}dispose(){this.cancel(),this.isDisposed=!0}}class xi{constructor(e,t){this.timeoutToken=-1,this.runner=e,this.timeout=t,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(e=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,e)}get delay(){return this.timeout}set delay(e){this.timeout=e}isScheduled(){return this.timeoutToken!==-1}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){var e;(e=this.runner)==null||e.call(this)}}let Bue,TL;(function(){typeof globalThis.requestIdleCallback!="function"||typeof globalThis.cancelIdleCallback!="function"?TL=(s,e)=>{sue(()=>{if(t)return;const i=Date.now()+15;e(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,i-Date.now())}}))});let t=!1;return{dispose(){t||(t=!0)}}}:TL=(s,e,t)=>{const i=s.requestIdleCallback(e,typeof t=="number"?{timeout:t}:void 0);let n=!1;return{dispose(){n||(n=!0,s.cancelIdleCallback(i))}}},Bue=s=>TL(globalThis,s)})();class Wue{constructor(e,t){this._didRun=!1,this._executor=()=>{try{this._value=t()}catch(i){this._error=i}finally{this._didRun=!0}},this._handle=TL(e,()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}}class u2e extends Wue{constructor(e){super(globalThis,e)}}class lS{get isRejected(){var e;return((e=this.outcome)==null?void 0:e.outcome)===1}get isSettled(){return!!this.outcome}constructor(){this.p=new Promise((e,t)=>{this.completeCallback=e,this.errorCallback=t})}complete(e){return new Promise(t=>{this.completeCallback(e),this.outcome={outcome:0,value:e},t()})}error(e){return new Promise(t=>{this.errorCallback(e),this.outcome={outcome:1,value:e},t()})}cancel(){return this.error(new od)}}var UW;(function(s){async function e(i){let n;const r=await Promise.all(i.map(o=>o.then(a=>a,a=>{n||(n=a)})));if(typeof n<"u")throw n;return r}s.settled=e;function t(i){return new Promise(async(n,r)=>{try{await i(n,r)}catch(o){r(o)}})}s.withAsyncBody=t})(UW||(UW={}));const wa=class wa{static fromArray(e){return new wa(t=>{t.emitMany(e)})}static fromPromise(e){return new wa(async t=>{t.emitMany(await e)})}static fromPromises(e){return new wa(async t=>{await Promise.all(e.map(async i=>t.emitOne(await i)))})}static merge(e){return new wa(async t=>{await Promise.all(e.map(async i=>{for await(const n of i)t.emitOne(n)}))})}constructor(e,t){this._state=0,this._results=[],this._error=null,this._onReturn=t,this._onStateChanged=new Z,queueMicrotask(async()=>{const i={emitOne:n=>this.emitOne(n),emitMany:n=>this.emitMany(n),reject:n=>this.reject(n)};try{await Promise.resolve(e(i)),this.resolve()}catch(n){this.reject(n)}finally{i.emitOne=void 0,i.emitMany=void 0,i.reject=void 0}})}[Symbol.asyncIterator](){let e=0;return{next:async()=>{do{if(this._state===2)throw this._error;if(e<this._results.length)return{done:!1,value:this._results[e++]};if(this._state===1)return{done:!0,value:void 0};await De.toPromise(this._onStateChanged.event)}while(!0)},return:async()=>{var t;return(t=this._onReturn)==null||t.call(this),{done:!0,value:void 0}}}}static map(e,t){return new wa(async i=>{for await(const n of e)i.emitOne(t(n))})}map(e){return wa.map(this,e)}static filter(e,t){return new wa(async i=>{for await(const n of e)t(n)&&i.emitOne(n)})}filter(e){return wa.filter(this,e)}static coalesce(e){return wa.filter(e,t=>!!t)}coalesce(){return wa.coalesce(this)}static async toPromise(e){const t=[];for await(const i of e)t.push(i);return t}toPromise(){return wa.toPromise(this)}emitOne(e){this._state===0&&(this._results.push(e),this._onStateChanged.fire())}emitMany(e){this._state===0&&(this._results=this._results.concat(e),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(e){this._state===0&&(this._state=2,this._error=e,this._onStateChanged.fire())}};wa.EMPTY=wa.fromArray([]);let Cl=wa;class h2e extends Cl{constructor(e,t){super(t),this._source=e}cancel(){this._source.cancel()}}function f2e(s){const e=new mn,t=s(e.token);return new h2e(e,async i=>{const n=e.token.onCancellationRequested(()=>{n.dispose(),e.dispose(),i.reject(new od)});try{for await(const r of t){if(e.token.isCancellationRequested)return;i.emitOne(r)}n.dispose(),e.dispose()}catch(r){n.dispose(),e.dispose(),i.reject(r)}})}/*! @license DOMPurify 3.1.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.1.7/LICENSE */const{entries:Hue,setPrototypeOf:tte,isFrozen:g2e,getPrototypeOf:p2e,getOwnPropertyDescriptor:m2e}=Object;let{freeze:Oa,seal:ad,create:zue}=Object,{apply:jW,construct:$W}=typeof Reflect<"u"&&Reflect;Oa||(Oa=function(e){return e});ad||(ad=function(e){return e});jW||(jW=function(e,t,i){return e.apply(t,i)});$W||($W=function(e,t){return new e(...t)});const JT=vc(Array.prototype.forEach),ite=vc(Array.prototype.pop),px=vc(Array.prototype.push),yR=vc(String.prototype.toLowerCase),Q9=vc(String.prototype.toString),nte=vc(String.prototype.match),mx=vc(String.prototype.replace),_2e=vc(String.prototype.indexOf),b2e=vc(String.prototype.trim),Od=vc(Object.prototype.hasOwnProperty),_a=vc(RegExp.prototype.test),_x=v2e(TypeError);function vc(s){return function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return jW(s,e,i)}}function v2e(s){return function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return $W(s,t)}}function Ai(s,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:yR;tte&&tte(s,null);let i=e.length;for(;i--;){let n=e[i];if(typeof n=="string"){const r=t(n);r!==n&&(g2e(e)||(e[i]=r),n=r)}s[n]=!0}return s}function w2e(s){for(let e=0;e<s.length;e++)Od(s,e)||(s[e]=null);return s}function rb(s){const e=zue(null);for(const[t,i]of Hue(s))Od(s,t)&&(Array.isArray(i)?e[t]=w2e(i):i&&typeof i=="object"&&i.constructor===Object?e[t]=rb(i):e[t]=i);return e}function bx(s,e){for(;s!==null;){const i=m2e(s,e);if(i){if(i.get)return vc(i.get);if(typeof i.value=="function")return vc(i.value)}s=p2e(s)}function t(){return null}return t}const ste=Oa(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Y9=Oa(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),X9=Oa(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),C2e=Oa(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Z9=Oa(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),y2e=Oa(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),rte=Oa(["#text"]),ote=Oa(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),J9=Oa(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),ate=Oa(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),eN=Oa(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),S2e=ad(/\{\{[\w\W]*|[\w\W]*\}\}/gm),x2e=ad(/<%[\w\W]*|[\w\W]*%>/gm),L2e=ad(/\${[\w\W]*}/gm),k2e=ad(/^data-[\-\w.\u00B7-\uFFFF]/),I2e=ad(/^aria-[\-\w]+$/),Uue=ad(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),E2e=ad(/^(?:\w+script|data):/i),D2e=ad(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),jue=ad(/^html$/i),T2e=ad(/^[a-z][.\w]*(-[.\w]+)+$/i);var lte=Object.freeze({__proto__:null,MUSTACHE_EXPR:S2e,ERB_EXPR:x2e,TMPLIT_EXPR:L2e,DATA_ATTR:k2e,ARIA_ATTR:I2e,IS_ALLOWED_URI:Uue,IS_SCRIPT_OR_DATA:E2e,ATTR_WHITESPACE:D2e,DOCTYPE_NAME:jue,CUSTOM_ELEMENT:T2e});const vx={element:1,text:3,progressingInstruction:7,comment:8,document:9},N2e=function(){return typeof window>"u"?null:window},R2e=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let i=null;const n="data-tt-policy-suffix";t&&t.hasAttribute(n)&&(i=t.getAttribute(n));const r="dompurify"+(i?"#"+i:"");try{return e.createPolicy(r,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+r+" could not be created."),null}};function $ue(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:N2e();const e=xt=>$ue(xt);if(e.version="3.1.7",e.removed=[],!s||!s.document||s.document.nodeType!==vx.document)return e.isSupported=!1,e;let{document:t}=s;const i=t,n=i.currentScript,{DocumentFragment:r,HTMLTemplateElement:o,Node:a,Element:l,NodeFilter:c,NamedNodeMap:d=s.NamedNodeMap||s.MozNamedAttrMap,HTMLFormElement:u,DOMParser:h,trustedTypes:g}=s,p=l.prototype,_=bx(p,"cloneNode"),v=bx(p,"remove"),C=bx(p,"nextSibling"),y=bx(p,"childNodes"),x=bx(p,"parentNode");if(typeof o=="function"){const xt=t.createElement("template");xt.content&&xt.content.ownerDocument&&(t=xt.content.ownerDocument)}let L,I="";const{implementation:A,createNodeIterator:D,createDocumentFragment:N,getElementsByTagName:R}=t,{importNode:W}=i;let H={};e.isSupported=typeof Hue=="function"&&typeof x=="function"&&A&&A.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:U,ERB_EXPR:B,TMPLIT_EXPR:ee,DATA_ATTR:re,ARIA_ATTR:pe,IS_SCRIPT_OR_DATA:Ie,ATTR_WHITESPACE:ge,CUSTOM_ELEMENT:_e}=lte;let{IS_ALLOWED_URI:Re}=lte,J=null;const we=Ai({},[...ste,...Y9,...X9,...Z9,...rte]);let Ae=null;const ot=Ai({},[...ote,...J9,...ate,...eN]);let tt=Object.seal(zue(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),It=null,si=null,ai=!0,Ii=!0,rn=!1,eo=!0,vn=!1,zs=!0,to=!1,Ec=!1,_d=!1,Ua=!1,bd=!1,Hl=!1,io=!0,ja=!1;const Su="user-content-";let zl=!0,$a=!1,Po={},On=null;const Zn=Ai({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let qa=null;const Ul=Ai({},["audio","video","img","source","image","track"]);let Ar=null;const Ds=Ai({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Pr="http://www.w3.org/1998/Math/MathML",da="http://www.w3.org/2000/svg",qn="http://www.w3.org/1999/xhtml";let _r=qn,Dc=!1,no=null;const Li=Ai({},[Pr,da,qn],Q9);let Ka=null;const xu=["application/xhtml+xml","text/html"],Mo="text/html";let wn=null,ua=null;const Ga=t.createElement("form"),Lu=function(de){return de instanceof RegExp||de instanceof Function},jl=function(){let de=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(ua&&ua===de)){if((!de||typeof de!="object")&&(de={}),de=rb(de),Ka=xu.indexOf(de.PARSER_MEDIA_TYPE)===-1?Mo:de.PARSER_MEDIA_TYPE,wn=Ka==="application/xhtml+xml"?Q9:yR,J=Od(de,"ALLOWED_TAGS")?Ai({},de.ALLOWED_TAGS,wn):we,Ae=Od(de,"ALLOWED_ATTR")?Ai({},de.ALLOWED_ATTR,wn):ot,no=Od(de,"ALLOWED_NAMESPACES")?Ai({},de.ALLOWED_NAMESPACES,Q9):Li,Ar=Od(de,"ADD_URI_SAFE_ATTR")?Ai(rb(Ds),de.ADD_URI_SAFE_ATTR,wn):Ds,qa=Od(de,"ADD_DATA_URI_TAGS")?Ai(rb(Ul),de.ADD_DATA_URI_TAGS,wn):Ul,On=Od(de,"FORBID_CONTENTS")?Ai({},de.FORBID_CONTENTS,wn):Zn,It=Od(de,"FORBID_TAGS")?Ai({},de.FORBID_TAGS,wn):{},si=Od(de,"FORBID_ATTR")?Ai({},de.FORBID_ATTR,wn):{},Po=Od(de,"USE_PROFILES")?de.USE_PROFILES:!1,ai=de.ALLOW_ARIA_ATTR!==!1,Ii=de.ALLOW_DATA_ATTR!==!1,rn=de.ALLOW_UNKNOWN_PROTOCOLS||!1,eo=de.ALLOW_SELF_CLOSE_IN_ATTR!==!1,vn=de.SAFE_FOR_TEMPLATES||!1,zs=de.SAFE_FOR_XML!==!1,to=de.WHOLE_DOCUMENT||!1,Ua=de.RETURN_DOM||!1,bd=de.RETURN_DOM_FRAGMENT||!1,Hl=de.RETURN_TRUSTED_TYPE||!1,_d=de.FORCE_BODY||!1,io=de.SANITIZE_DOM!==!1,ja=de.SANITIZE_NAMED_PROPS||!1,zl=de.KEEP_CONTENT!==!1,$a=de.IN_PLACE||!1,Re=de.ALLOWED_URI_REGEXP||Uue,_r=de.NAMESPACE||qn,tt=de.CUSTOM_ELEMENT_HANDLING||{},de.CUSTOM_ELEMENT_HANDLING&&Lu(de.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(tt.tagNameCheck=de.CUSTOM_ELEMENT_HANDLING.tagNameCheck),de.CUSTOM_ELEMENT_HANDLING&&Lu(de.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(tt.attributeNameCheck=de.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),de.CUSTOM_ELEMENT_HANDLING&&typeof de.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(tt.allowCustomizedBuiltInElements=de.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),vn&&(Ii=!1),bd&&(Ua=!0),Po&&(J=Ai({},rte),Ae=[],Po.html===!0&&(Ai(J,ste),Ai(Ae,ote)),Po.svg===!0&&(Ai(J,Y9),Ai(Ae,J9),Ai(Ae,eN)),Po.svgFilters===!0&&(Ai(J,X9),Ai(Ae,J9),Ai(Ae,eN)),Po.mathMl===!0&&(Ai(J,Z9),Ai(Ae,ate),Ai(Ae,eN))),de.ADD_TAGS&&(J===we&&(J=rb(J)),Ai(J,de.ADD_TAGS,wn)),de.ADD_ATTR&&(Ae===ot&&(Ae=rb(Ae)),Ai(Ae,de.ADD_ATTR,wn)),de.ADD_URI_SAFE_ATTR&&Ai(Ar,de.ADD_URI_SAFE_ATTR,wn),de.FORBID_CONTENTS&&(On===Zn&&(On=rb(On)),Ai(On,de.FORBID_CONTENTS,wn)),zl&&(J["#text"]=!0),to&&Ai(J,["html","head","body"]),J.table&&(Ai(J,["tbody"]),delete It.tbody),de.TRUSTED_TYPES_POLICY){if(typeof de.TRUSTED_TYPES_POLICY.createHTML!="function")throw _x('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof de.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw _x('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');L=de.TRUSTED_TYPES_POLICY,I=L.createHTML("")}else L===void 0&&(L=R2e(g,n)),L!==null&&typeof I=="string"&&(I=L.createHTML(""));Oa&&Oa(de),ua=de}},zt=Ai({},["mi","mo","mn","ms","mtext"]),K=Ai({},["annotation-xml"]),Q=Ai({},["title","style","font","a","script"]),Y=Ai({},[...Y9,...X9,...C2e]),se=Ai({},[...Z9,...y2e]),le=function(de){let Ge=x(de);(!Ge||!Ge.tagName)&&(Ge={namespaceURI:_r,tagName:"template"});const pt=yR(de.tagName),Cn=yR(Ge.tagName);return no[de.namespaceURI]?de.namespaceURI===da?Ge.namespaceURI===qn?pt==="svg":Ge.namespaceURI===Pr?pt==="svg"&&(Cn==="annotation-xml"||zt[Cn]):!!Y[pt]:de.namespaceURI===Pr?Ge.namespaceURI===qn?pt==="math":Ge.namespaceURI===da?pt==="math"&&K[Cn]:!!se[pt]:de.namespaceURI===qn?Ge.namespaceURI===da&&!K[Cn]||Ge.namespaceURI===Pr&&!zt[Cn]?!1:!se[pt]&&(Q[pt]||!Y[pt]):!!(Ka==="application/xhtml+xml"&&no[de.namespaceURI]):!1},be=function(de){px(e.removed,{element:de});try{x(de).removeChild(de)}catch{v(de)}},Ne=function(de,Ge){try{px(e.removed,{attribute:Ge.getAttributeNode(de),from:Ge})}catch{px(e.removed,{attribute:null,from:Ge})}if(Ge.removeAttribute(de),de==="is"&&!Ae[de])if(Ua||bd)try{be(Ge)}catch{}else try{Ge.setAttribute(de,"")}catch{}},Ze=function(de){let Ge=null,pt=null;if(_d)de="<remove></remove>"+de;else{const mi=nte(de,/^[\r\n\t ]+/);pt=mi&&mi[0]}Ka==="application/xhtml+xml"&&_r===qn&&(de='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+de+"</body></html>");const Cn=L?L.createHTML(de):de;if(_r===qn)try{Ge=new h().parseFromString(Cn,Ka)}catch{}if(!Ge||!Ge.documentElement){Ge=A.createDocument(_r,"template",null);try{Ge.documentElement.innerHTML=Dc?I:Cn}catch{}}const Js=Ge.body||Ge.documentElement;return de&&pt&&Js.insertBefore(t.createTextNode(pt),Js.childNodes[0]||null),_r===qn?R.call(Ge,to?"html":"body")[0]:to?Ge.documentElement:Js},rt=function(de){return D.call(de.ownerDocument||de,de,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT|c.SHOW_PROCESSING_INSTRUCTION|c.SHOW_CDATA_SECTION,null)},Ft=function(de){return de instanceof u&&(typeof de.nodeName!="string"||typeof de.textContent!="string"||typeof de.removeChild!="function"||!(de.attributes instanceof d)||typeof de.removeAttribute!="function"||typeof de.setAttribute!="function"||typeof de.namespaceURI!="string"||typeof de.insertBefore!="function"||typeof de.hasChildNodes!="function")},yi=function(de){return typeof a=="function"&&de instanceof a},bi=function(de,Ge,pt){H[de]&&JT(H[de],Cn=>{Cn.call(e,Ge,pt,ua)})},on=function(de){let Ge=null;if(bi("beforeSanitizeElements",de,null),Ft(de))return be(de),!0;const pt=wn(de.nodeName);if(bi("uponSanitizeElement",de,{tagName:pt,allowedTags:J}),de.hasChildNodes()&&!yi(de.firstElementChild)&&_a(/<[/\w]/g,de.innerHTML)&&_a(/<[/\w]/g,de.textContent)||de.nodeType===vx.progressingInstruction||zs&&de.nodeType===vx.comment&&_a(/<[/\w]/g,de.data))return be(de),!0;if(!J[pt]||It[pt]){if(!It[pt]&&ps(pt)&&(tt.tagNameCheck instanceof RegExp&&_a(tt.tagNameCheck,pt)||tt.tagNameCheck instanceof Function&&tt.tagNameCheck(pt)))return!1;if(zl&&!On[pt]){const Cn=x(de)||de.parentNode,Js=y(de)||de.childNodes;if(Js&&Cn){const mi=Js.length;for(let br=mi-1;br>=0;--br){const Mr=_(Js[br],!0);Mr.__removalCount=(de.__removalCount||0)+1,Cn.insertBefore(Mr,C(de))}}}return be(de),!0}return de instanceof l&&!le(de)||(pt==="noscript"||pt==="noembed"||pt==="noframes")&&_a(/<\/no(script|embed|frames)/i,de.innerHTML)?(be(de),!0):(vn&&de.nodeType===vx.text&&(Ge=de.textContent,JT([U,B,ee],Cn=>{Ge=mx(Ge,Cn," ")}),de.textContent!==Ge&&(px(e.removed,{element:de.cloneNode()}),de.textContent=Ge)),bi("afterSanitizeElements",de,null),!1)},ki=function(de,Ge,pt){if(io&&(Ge==="id"||Ge==="name")&&(pt in t||pt in Ga))return!1;if(!(Ii&&!si[Ge]&&_a(re,Ge))){if(!(ai&&_a(pe,Ge))){if(!Ae[Ge]||si[Ge]){if(!(ps(de)&&(tt.tagNameCheck instanceof RegExp&&_a(tt.tagNameCheck,de)||tt.tagNameCheck instanceof Function&&tt.tagNameCheck(de))&&(tt.attributeNameCheck instanceof RegExp&&_a(tt.attributeNameCheck,Ge)||tt.attributeNameCheck instanceof Function&&tt.attributeNameCheck(Ge))||Ge==="is"&&tt.allowCustomizedBuiltInElements&&(tt.tagNameCheck instanceof RegExp&&_a(tt.tagNameCheck,pt)||tt.tagNameCheck instanceof Function&&tt.tagNameCheck(pt))))return!1}else if(!Ar[Ge]){if(!_a(Re,mx(pt,ge,""))){if(!((Ge==="src"||Ge==="xlink:href"||Ge==="href")&&de!=="script"&&_2e(pt,"data:")===0&&qa[de])){if(!(rn&&!_a(Ie,mx(pt,ge,"")))){if(pt)return!1}}}}}}return!0},ps=function(de){return de!=="annotation-xml"&&nte(de,_e)},ss=function(de){bi("beforeSanitizeAttributes",de,null);const{attributes:Ge}=de;if(!Ge)return;const pt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Ae};let Cn=Ge.length;for(;Cn--;){const Js=Ge[Cn],{name:mi,namespaceURI:br,value:Mr}=Js,Qa=wn(mi);let Fn=mi==="value"?Mr:b2e(Mr);if(pt.attrName=Qa,pt.attrValue=Fn,pt.keepAttr=!0,pt.forceKeepAttr=void 0,bi("uponSanitizeAttribute",de,pt),Fn=pt.attrValue,pt.forceKeepAttr||(Ne(mi,de),!pt.keepAttr))continue;if(!eo&&_a(/\/>/i,Fn)){Ne(mi,de);continue}vn&&JT([U,B,ee],x_=>{Fn=mx(Fn,x_," ")});const zg=wn(de.nodeName);if(ki(zg,Qa,Fn)){if(ja&&(Qa==="id"||Qa==="name")&&(Ne(mi,de),Fn=Su+Fn),zs&&_a(/((--!?|])>)|<\/(style|title)/i,Fn)){Ne(mi,de);continue}if(L&&typeof g=="object"&&typeof g.getAttributeType=="function"&&!br)switch(g.getAttributeType(zg,Qa)){case"TrustedHTML":{Fn=L.createHTML(Fn);break}case"TrustedScriptURL":{Fn=L.createScriptURL(Fn);break}}try{br?de.setAttributeNS(br,mi,Fn):de.setAttribute(mi,Fn),Ft(de)?be(de):ite(e.removed)}catch{}}}bi("afterSanitizeAttributes",de,null)},ku=function xt(de){let Ge=null;const pt=rt(de);for(bi("beforeSanitizeShadowDOM",de,null);Ge=pt.nextNode();)bi("uponSanitizeShadowNode",Ge,null),!on(Ge)&&(Ge.content instanceof r&&xt(Ge.content),ss(Ge));bi("afterSanitizeShadowDOM",de,null)};return e.sanitize=function(xt){let de=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Ge=null,pt=null,Cn=null,Js=null;if(Dc=!xt,Dc&&(xt="<!-->"),typeof xt!="string"&&!yi(xt))if(typeof xt.toString=="function"){if(xt=xt.toString(),typeof xt!="string")throw _x("dirty is not a string, aborting")}else throw _x("toString is not a function");if(!e.isSupported)return xt;if(Ec||jl(de),e.removed=[],typeof xt=="string"&&($a=!1),$a){if(xt.nodeName){const Mr=wn(xt.nodeName);if(!J[Mr]||It[Mr])throw _x("root node is forbidden and cannot be sanitized in-place")}}else if(xt instanceof a)Ge=Ze("<!---->"),pt=Ge.ownerDocument.importNode(xt,!0),pt.nodeType===vx.element&&pt.nodeName==="BODY"||pt.nodeName==="HTML"?Ge=pt:Ge.appendChild(pt);else{if(!Ua&&!vn&&!to&&xt.indexOf("<")===-1)return L&&Hl?L.createHTML(xt):xt;if(Ge=Ze(xt),!Ge)return Ua?null:Hl?I:""}Ge&&_d&&be(Ge.firstChild);const mi=rt($a?xt:Ge);for(;Cn=mi.nextNode();)on(Cn)||(Cn.content instanceof r&&ku(Cn.content),ss(Cn));if($a)return xt;if(Ua){if(bd)for(Js=N.call(Ge.ownerDocument);Ge.firstChild;)Js.appendChild(Ge.firstChild);else Js=Ge;return(Ae.shadowroot||Ae.shadowrootmode)&&(Js=W.call(i,Js,!0)),Js}let br=to?Ge.outerHTML:Ge.innerHTML;return to&&J["!doctype"]&&Ge.ownerDocument&&Ge.ownerDocument.doctype&&Ge.ownerDocument.doctype.name&&_a(jue,Ge.ownerDocument.doctype.name)&&(br="<!DOCTYPE "+Ge.ownerDocument.doctype.name+`>
`+br),vn&&JT([U,B,ee],Mr=>{br=mx(br,Mr," ")}),L&&Hl?L.createHTML(br):br},e.setConfig=function(){let xt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};jl(xt),Ec=!0},e.clearConfig=function(){ua=null,Ec=!1},e.isValidAttribute=function(xt,de,Ge){ua||jl({});const pt=wn(xt),Cn=wn(de);return ki(pt,Cn,Ge)},e.addHook=function(xt,de){typeof de=="function"&&(H[xt]=H[xt]||[],px(H[xt],de))},e.removeHook=function(xt){if(H[xt])return ite(H[xt])},e.removeHooks=function(xt){H[xt]&&(H[xt]=[])},e.removeAllHooks=function(){H={}},e}var jh=$ue();jh.version;jh.isSupported;const que=jh.sanitize;jh.setConfig;jh.clearConfig;jh.isValidAttribute;const Kue=jh.addHook,Gue=jh.removeHook;jh.removeHooks;jh.removeAllHooks;var gt;(function(s){s.inMemory="inmemory",s.vscode="vscode",s.internal="private",s.walkThrough="walkThrough",s.walkThroughSnippet="walkThroughSnippet",s.http="http",s.https="https",s.file="file",s.mailto="mailto",s.untitled="untitled",s.data="data",s.command="command",s.vscodeRemote="vscode-remote",s.vscodeRemoteResource="vscode-remote-resource",s.vscodeManagedRemoteResource="vscode-managed-remote-resource",s.vscodeUserData="vscode-userdata",s.vscodeCustomEditor="vscode-custom-editor",s.vscodeNotebookCell="vscode-notebook-cell",s.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",s.vscodeNotebookCellMetadataDiff="vscode-notebook-cell-metadata-diff",s.vscodeNotebookCellOutput="vscode-notebook-cell-output",s.vscodeNotebookCellOutputDiff="vscode-notebook-cell-output-diff",s.vscodeNotebookMetadata="vscode-notebook-metadata",s.vscodeInteractiveInput="vscode-interactive-input",s.vscodeSettings="vscode-settings",s.vscodeWorkspaceTrust="vscode-workspace-trust",s.vscodeTerminal="vscode-terminal",s.vscodeChatCodeBlock="vscode-chat-code-block",s.vscodeChatCodeCompareBlock="vscode-chat-code-compare-block",s.vscodeChatSesssion="vscode-chat-editor",s.webviewPanel="webview-panel",s.vscodeWebview="vscode-webview",s.extension="extension",s.vscodeFileResource="vscode-file",s.tmp="tmp",s.vsls="vsls",s.vscodeSourceControl="vscode-scm",s.commentsInput="comment",s.codeSetting="code-setting",s.outputChannel="output"})(gt||(gt={}));function J4(s,e){return Je.isUri(s)?SC(s.scheme,e):Dq(s,e+":")}function qW(s,...e){return e.some(t=>J4(s,t))}const A2e="tkn";class P2e{constructor(){this._hosts=Object.create(null),this._ports=Object.create(null),this._connectionTokens=Object.create(null),this._preferredWebSchema="http",this._delegate=null,this._serverRootPath="/"}setPreferredWebSchema(e){this._preferredWebSchema=e}get _remoteResourcesPath(){return Yn.join(this._serverRootPath,gt.vscodeRemoteResource)}rewrite(e){if(this._delegate)try{return this._delegate(e)}catch(a){return ft(a),e}const t=e.authority;let i=this._hosts[t];i&&i.indexOf(":")!==-1&&i.indexOf("[")===-1&&(i=`[${i}]`);const n=this._ports[t],r=this._connectionTokens[t];let o=`path=${encodeURIComponent(e.path)}`;return typeof r=="string"&&(o+=`&${A2e}=${encodeURIComponent(r)}`),Je.from({scheme:Uw?this._preferredWebSchema:gt.vscodeRemoteResource,authority:`${i}:${n}`,path:this._remoteResourcesPath,query:o})}}const Que=new P2e,M2e="vscode-app",pk=class pk{asBrowserUri(e){const t=this.toUri(e);return this.uriToBrowserUri(t)}uriToBrowserUri(e){return e.scheme===gt.vscodeRemote?Que.rewrite(e):e.scheme===gt.file&&(Th||UTe===`${gt.vscodeFileResource}://${pk.FALLBACK_AUTHORITY}`)?e.with({scheme:gt.vscodeFileResource,authority:e.authority||pk.FALLBACK_AUTHORITY,query:null,fragment:null}):e}toUri(e,t){if(Je.isUri(e))return e;if(globalThis._VSCODE_FILE_ROOT){const i=globalThis._VSCODE_FILE_ROOT;if(/^\w[\w\d+.-]*:\/\//.test(i))return Je.joinPath(Je.parse(i,!0),e);const n=fRe(i,e);return Je.file(n)}return Je.parse(t.toUrl(e))}};pk.FALLBACK_AUTHORITY=M2e;let KW=pk;const eF=new KW;var GW;(function(s){const e=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);s.CoopAndCoep=Object.freeze(e.get("3"));const t="vscode-coi";function i(r){let o;typeof r=="string"?o=new URL(r).searchParams:r instanceof URL?o=r.searchParams:Je.isUri(r)&&(o=new URL(r.toString(!0)).searchParams);const a=o==null?void 0:o.get(t);if(a)return e.get(a)}s.getHeadersFromQuery=i;function n(r,o,a){if(!globalThis.crossOriginIsolated)return;const l=o&&a?"3":a?"2":"1";r instanceof URLSearchParams?r.set(t,l):r[t]=l}s.addSearchParam=n})(GW||(GW={}));function tF(s){return iF(s,0)}function iF(s,e){switch(typeof s){case"object":return s===null?jf(349,e):Array.isArray(s)?F2e(s,e):V2e(s,e);case"string":return Vq(s,e);case"boolean":return O2e(s,e);case"number":return jf(s,e);case"undefined":return jf(937,e);default:return jf(617,e)}}function jf(s,e){return(e<<5)-e+s|0}function O2e(s,e){return jf(s?433:863,e)}function Vq(s,e){e=jf(149417,e);for(let t=0,i=s.length;t<i;t++)e=jf(s.charCodeAt(t),e);return e}function F2e(s,e){return e=jf(104579,e),s.reduce((t,i)=>iF(i,t),e)}function V2e(s,e){return e=jf(181387,e),Object.keys(s).sort().reduce((t,i)=>(t=Vq(i,t),iF(s[i],t)),e)}function eV(s,e,t=32){const i=t-e,n=~((1<<i)-1);return(s<<e|(n&s)>>>i)>>>0}function cte(s,e=0,t=s.byteLength,i=0){for(let n=0;n<t;n++)s[e+n]=i}function B2e(s,e,t="0"){for(;s.length<e;)s=t+s;return s}function wx(s,e=32){return s instanceof ArrayBuffer?Array.from(new Uint8Array(s)).map(t=>t.toString(16).padStart(2,"0")).join(""):B2e((s>>>0).toString(16),e/4)}const RM=class RM{constructor(){this._h0=1732584193,this._h1=4023233417,this._h2=2562383102,this._h3=271733878,this._h4=3285377520,this._buff=new Uint8Array(67),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._leftoverHighSurrogate=0,this._finished=!1}update(e){const t=e.length;if(t===0)return;const i=this._buff;let n=this._buffLen,r=this._leftoverHighSurrogate,o,a;for(r!==0?(o=r,a=-1,r=0):(o=e.charCodeAt(0),a=0);;){let l=o;if(ws(o))if(a+1<t){const c=e.charCodeAt(a+1);cw(c)?(a++,l=Tq(o,c)):l=65533}else{r=o;break}else cw(o)&&(l=65533);if(n=this._push(i,n,l),a++,a<t)o=e.charCodeAt(a);else break}this._buffLen=n,this._leftoverHighSurrogate=r}_push(e,t,i){return i<128?e[t++]=i:i<2048?(e[t++]=192|(i&1984)>>>6,e[t++]=128|(i&63)>>>0):i<65536?(e[t++]=224|(i&61440)>>>12,e[t++]=128|(i&4032)>>>6,e[t++]=128|(i&63)>>>0):(e[t++]=240|(i&1835008)>>>18,e[t++]=128|(i&258048)>>>12,e[t++]=128|(i&4032)>>>6,e[t++]=128|(i&63)>>>0),t>=64&&(this._step(),t-=64,this._totalLen+=64,e[0]=e[64],e[1]=e[65],e[2]=e[66]),t}digest(){return this._finished||(this._finished=!0,this._leftoverHighSurrogate&&(this._leftoverHighSurrogate=0,this._buffLen=this._push(this._buff,this._buffLen,65533)),this._totalLen+=this._buffLen,this._wrapUp()),wx(this._h0)+wx(this._h1)+wx(this._h2)+wx(this._h3)+wx(this._h4)}_wrapUp(){this._buff[this._buffLen++]=128,cte(this._buff,this._buffLen),this._buffLen>56&&(this._step(),cte(this._buff));const e=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(e/4294967296),!1),this._buffDV.setUint32(60,e%4294967296,!1),this._step()}_step(){const e=RM._bigBlock32,t=this._buffDV;for(let u=0;u<64;u+=4)e.setUint32(u,t.getUint32(u,!1),!1);for(let u=64;u<320;u+=4)e.setUint32(u,eV(e.getUint32(u-12,!1)^e.getUint32(u-32,!1)^e.getUint32(u-56,!1)^e.getUint32(u-64,!1),1),!1);let i=this._h0,n=this._h1,r=this._h2,o=this._h3,a=this._h4,l,c,d;for(let u=0;u<80;u++)u<20?(l=n&r|~n&o,c=1518500249):u<40?(l=n^r^o,c=1859775393):u<60?(l=n&r|n&o|r&o,c=2400959708):(l=n^r^o,c=3395469782),d=eV(i,5)+l+a+c+e.getUint32(u*4,!1)&4294967295,a=o,o=r,r=eV(n,30),n=i,i=d;this._h0=this._h0+i&4294967295,this._h1=this._h1+n&4294967295,this._h2=this._h2+r&4294967295,this._h3=this._h3+o&4294967295,this._h4=this._h4+a&4294967295}};RM._bigBlock32=new DataView(new ArrayBuffer(320));let QW=RM;const{getWindow:nt,getWindows:Yue,getWindowsCount:W2e,getWindowId:U2,getWindowById:dte,onDidRegisterWindow:nF,onWillUnregisterWindow:H2e,onDidUnregisterWindow:z2e}=function(){const s=new Map;ARe(Ri,1);const e={window:Ri,disposables:new ce};s.set(Ri.vscodeWindowId,e);const t=new Z,i=new Z,n=new Z;function r(o,a){return(typeof o=="number"?s.get(o):void 0)??(a?e:void 0)}return{onDidRegisterWindow:t.event,onWillUnregisterWindow:n.event,onDidUnregisterWindow:i.event,registerWindow(o){if(s.has(o.vscodeWindowId))return te.None;const a=new ce,l={window:o,disposables:a.add(new ce)};return s.set(o.vscodeWindowId,l),a.add(Ye(()=>{s.delete(o.vscodeWindowId),i.fire(o)})),a.add(oe(o,Le.BEFORE_UNLOAD,()=>{n.fire(o)})),t.fire(l),a},getWindows(){return s.values()},getWindowsCount(){return s.size},getWindowId(o){return o.vscodeWindowId},hasWindow(o){return s.has(o)},getWindowById:r,getWindow(o){var c;const a=o;if((c=a==null?void 0:a.ownerDocument)!=null&&c.defaultView)return a.ownerDocument.defaultView.window;const l=o;return l!=null&&l.view?l.view.window:Ri},getDocument(o){return nt(o).document}}}();function Ys(s){for(;s.firstChild;)s.firstChild.remove()}class U2e{constructor(e,t,i,n){this._node=e,this._type=t,this._handler=i,this._options=n||!1,this._node.addEventListener(this._type,this._handler,this._options)}dispose(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}}function oe(s,e,t,i){return new U2e(s,e,t,i)}function Xue(s,e){return function(t){return e(new Xc(s,t))}}function j2e(s){return function(e){return s(new Mi(e))}}const yn=function(e,t,i,n){let r=i;return t==="click"||t==="mousedown"||t==="contextmenu"?r=Xue(nt(e),i):(t==="keydown"||t==="keypress"||t==="keyup")&&(r=j2e(i)),oe(e,t,r,n)},$2e=function(e,t,i){const n=Xue(nt(e),t);return q2e(e,n,i)};function q2e(s,e,t){return oe(s,du&&Mq.pointerEvents?Le.POINTER_DOWN:Le.MOUSE_DOWN,e,t)}function Xx(s,e,t){return TL(s,e,t)}class tV extends Wue{constructor(e,t){super(e,t)}}let j2,Fa;class Bq extends Fq{constructor(e){super(),this.defaultTarget=e&&nt(e)}cancelAndSet(e,t,i){return super.cancelAndSet(e,t,i??this.defaultTarget)}}class iV{constructor(e,t=0){this._runner=e,this.priority=t,this._canceled=!1}dispose(){this._canceled=!0}execute(){if(!this._canceled)try{this._runner()}catch(e){ft(e)}}static sort(e,t){return t.priority-e.priority}}(function(){const s=new Map,e=new Map,t=new Map,i=new Map,n=r=>{t.set(r,!1);const o=s.get(r)??[];for(e.set(r,o),s.set(r,[]),i.set(r,!0);o.length>0;)o.sort(iV.sort),o.shift().execute();i.set(r,!1)};Fa=(r,o,a=0)=>{const l=U2(r),c=new iV(o,a);let d=s.get(l);return d||(d=[],s.set(l,d)),d.push(c),t.get(l)||(t.set(l,!0),r.requestAnimationFrame(()=>n(l))),c},j2=(r,o,a)=>{const l=U2(r);if(i.get(l)){const c=new iV(o,a);let d=e.get(l);return d||(d=[],e.set(l,d)),d.push(c),c}else return Fa(r,o,a)}})();function sF(s){return nt(s).getComputedStyle(s,null)}function qm(s,e){const t=nt(s),i=t.document;if(s!==i.body)return new Ci(s.clientWidth,s.clientHeight);if(du&&(t!=null&&t.visualViewport))return new Ci(t.visualViewport.width,t.visualViewport.height);if(t!=null&&t.innerWidth&&t.innerHeight)return new Ci(t.innerWidth,t.innerHeight);if(i.body&&i.body.clientWidth&&i.body.clientHeight)return new Ci(i.body.clientWidth,i.body.clientHeight);if(i.documentElement&&i.documentElement.clientWidth&&i.documentElement.clientHeight)return new Ci(i.documentElement.clientWidth,i.documentElement.clientHeight);throw new Error("Unable to figure out browser width and height")}class Wn{static convertToPixels(e,t){return parseFloat(t)||0}static getDimension(e,t,i){const n=sF(e),r=n?n.getPropertyValue(t):"0";return Wn.convertToPixels(e,r)}static getBorderLeftWidth(e){return Wn.getDimension(e,"border-left-width","borderLeftWidth")}static getBorderRightWidth(e){return Wn.getDimension(e,"border-right-width","borderRightWidth")}static getBorderTopWidth(e){return Wn.getDimension(e,"border-top-width","borderTopWidth")}static getBorderBottomWidth(e){return Wn.getDimension(e,"border-bottom-width","borderBottomWidth")}static getPaddingLeft(e){return Wn.getDimension(e,"padding-left","paddingLeft")}static getPaddingRight(e){return Wn.getDimension(e,"padding-right","paddingRight")}static getPaddingTop(e){return Wn.getDimension(e,"padding-top","paddingTop")}static getPaddingBottom(e){return Wn.getDimension(e,"padding-bottom","paddingBottom")}static getMarginLeft(e){return Wn.getDimension(e,"margin-left","marginLeft")}static getMarginTop(e){return Wn.getDimension(e,"margin-top","marginTop")}static getMarginRight(e){return Wn.getDimension(e,"margin-right","marginRight")}static getMarginBottom(e){return Wn.getDimension(e,"margin-bottom","marginBottom")}}const Db=class Db{constructor(e,t){this.width=e,this.height=t}with(e=this.width,t=this.height){return e!==this.width||t!==this.height?new Db(e,t):this}static is(e){return typeof e=="object"&&typeof e.height=="number"&&typeof e.width=="number"}static lift(e){return e instanceof Db?e:new Db(e.width,e.height)}static equals(e,t){return e===t?!0:!e||!t?!1:e.width===t.width&&e.height===t.height}};Db.None=new Db(0,0);let Ci=Db;function Zue(s){let e=s.offsetParent,t=s.offsetTop,i=s.offsetLeft;for(;(s=s.parentNode)!==null&&s!==s.ownerDocument.body&&s!==s.ownerDocument.documentElement;){t-=s.scrollTop;const n=ehe(s)?null:sF(s);n&&(i-=n.direction!=="rtl"?s.scrollLeft:-s.scrollLeft),s===e&&(i+=Wn.getBorderLeftWidth(s),t+=Wn.getBorderTopWidth(s),t+=s.offsetTop,i+=s.offsetLeft,e=s.offsetParent)}return{left:i,top:t}}function K2e(s,e,t){typeof e=="number"&&(s.style.width=`${e}px`),typeof t=="number"&&(s.style.height=`${t}px`)}function Pn(s){const e=s.getBoundingClientRect(),t=nt(s);return{left:e.left+t.scrollX,top:e.top+t.scrollY,width:e.width,height:e.height}}function Jue(s){let e=s,t=1;do{const i=sF(e).zoom;i!=null&&i!=="1"&&(t*=i),e=e.parentElement}while(e!==null&&e!==e.ownerDocument.documentElement);return t}function ya(s){const e=Wn.getMarginLeft(s)+Wn.getMarginRight(s);return s.offsetWidth+e}function nV(s){const e=Wn.getBorderLeftWidth(s)+Wn.getBorderRightWidth(s),t=Wn.getPaddingLeft(s)+Wn.getPaddingRight(s);return s.offsetWidth-e-t}function G2e(s){const e=Wn.getBorderTopWidth(s)+Wn.getBorderBottomWidth(s),t=Wn.getPaddingTop(s)+Wn.getPaddingBottom(s);return s.offsetHeight-e-t}function $f(s){const e=Wn.getMarginTop(s)+Wn.getMarginBottom(s);return s.offsetHeight+e}function ys(s,e){return!!(e!=null&&e.contains(s))}function Q2e(s,e,t){for(;s&&s.nodeType===s.ELEMENT_NODE;){if(s.classList.contains(e))return s;if(t){if(typeof t=="string"){if(s.classList.contains(t))return null}else if(s===t)return null}s=s.parentNode}return null}function sV(s,e,t){return!!Q2e(s,e,t)}function ehe(s){return s&&!!s.host&&!!s.mode}function $2(s){return!!uw(s)}function uw(s){var e;for(;s.parentNode;){if(s===((e=s.ownerDocument)==null?void 0:e.body))return null;s=s.parentNode}return ehe(s)?s:null}function hr(){let s=cS().activeElement;for(;s!=null&&s.shadowRoot;)s=s.shadowRoot.activeElement;return s}function rF(s){return hr()===s}function the(s){return ys(hr(),s)}function cS(){return W2e()<=1?Ri.document:Array.from(Yue()).map(({window:e})=>e.document).find(e=>e.hasFocus())??Ri.document}function Zx(){var e;return((e=cS().defaultView)==null?void 0:e.window)??Ri}const Wq=new Map;function ihe(){return new Y2e}class Y2e{constructor(){this._currentCssStyle="",this._styleSheet=void 0}setStyle(e){e!==this._currentCssStyle&&(this._currentCssStyle=e,this._styleSheet?this._styleSheet.innerText=e:this._styleSheet=Rl(Ri.document.head,t=>t.innerText=e))}dispose(){this._styleSheet&&(this._styleSheet.remove(),this._styleSheet=void 0)}}function Rl(s=Ri.document.head,e,t){const i=document.createElement("style");if(i.type="text/css",i.media="screen",e==null||e(i),s.appendChild(i),t&&t.add(Ye(()=>i.remove())),s===Ri.document.head){const n=new Set;Wq.set(i,n);for(const{window:r,disposables:o}of Yue()){if(r===Ri)continue;const a=o.add(X2e(i,n,r));t==null||t.add(a)}}return i}function X2e(s,e,t){var r,o;const i=new ce,n=s.cloneNode(!0);t.document.head.appendChild(n),i.add(Ye(()=>n.remove()));for(const a of she(s))(o=n.sheet)==null||o.insertRule(a.cssText,(r=n.sheet)==null?void 0:r.cssRules.length);return i.add(Z2e.observe(s,i,{childList:!0})(()=>{n.textContent=s.textContent})),e.add(n),i.add(Ye(()=>e.delete(n))),i}const Z2e=new class{constructor(){this.mutationObservers=new Map}observe(s,e,t){let i=this.mutationObservers.get(s);i||(i=new Map,this.mutationObservers.set(s,i));const n=tF(t);let r=i.get(n);if(r)r.users+=1;else{const o=new Z,a=new MutationObserver(c=>o.fire(c));a.observe(s,t);const l=r={users:1,observer:a,onDidMutate:o.event};e.add(Ye(()=>{l.users-=1,l.users===0&&(o.dispose(),a.disconnect(),i==null||i.delete(n),(i==null?void 0:i.size)===0&&this.mutationObservers.delete(s))})),i.set(n,r)}return r.onDidMutate}};let rV=null;function nhe(){return rV||(rV=Rl()),rV}function she(s){var e,t;return(e=s==null?void 0:s.sheet)!=null&&e.rules?s.sheet.rules:(t=s==null?void 0:s.sheet)!=null&&t.cssRules?s.sheet.cssRules:[]}function q2(s,e,t=nhe()){var i;if(!(!t||!e)){(i=t.sheet)==null||i.insertRule(`${s} {${e}}`,0);for(const n of Wq.get(t)??[])q2(s,e,n)}}function YW(s,e=nhe()){var n;if(!e)return;const t=she(e),i=[];for(let r=0;r<t.length;r++){const o=t[r];J2e(o)&&o.selectorText.indexOf(s)!==-1&&i.push(r)}for(let r=i.length-1;r>=0;r--)(n=e.sheet)==null||n.deleteRule(i[r]);for(const r of Wq.get(e)??[])YW(s,r)}function J2e(s){return typeof s.selectorText=="string"}function Ls(s){return s instanceof HTMLElement||s instanceof nt(s).HTMLElement}function ute(s){return s instanceof HTMLAnchorElement||s instanceof nt(s).HTMLAnchorElement}function eAe(s){return s instanceof SVGElement||s instanceof nt(s).SVGElement}function Hq(s){return s instanceof MouseEvent||s instanceof nt(s).MouseEvent}function Df(s){return s instanceof KeyboardEvent||s instanceof nt(s).KeyboardEvent}const Le={CLICK:"click",AUXCLICK:"auxclick",DBLCLICK:"dblclick",MOUSE_UP:"mouseup",MOUSE_DOWN:"mousedown",MOUSE_OVER:"mouseover",MOUSE_MOVE:"mousemove",MOUSE_OUT:"mouseout",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_WHEEL:"wheel",POINTER_UP:"pointerup",POINTER_DOWN:"pointerdown",POINTER_MOVE:"pointermove",POINTER_LEAVE:"pointerleave",CONTEXT_MENU:"contextmenu",KEY_DOWN:"keydown",KEY_UP:"keyup",BEFORE_UNLOAD:"beforeunload",CHANGE:"change",FOCUS:"focus",FOCUS_IN:"focusin",FOCUS_OUT:"focusout",BLUR:"blur",INPUT:"input",DRAG_START:"dragstart",DRAG:"drag",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DROP:"drop",DRAG_END:"dragend"};function tAe(s){const e=s;return!!(e&&typeof e.preventDefault=="function"&&typeof e.stopPropagation=="function")}const jt={stop:(s,e)=>(s.preventDefault(),e&&s.stopPropagation(),s)};function iAe(s){const e=[];for(let t=0;s&&s.nodeType===s.ELEMENT_NODE;t++)e[t]=s.scrollTop,s=s.parentNode;return e}function nAe(s,e){for(let t=0;s&&s.nodeType===s.ELEMENT_NODE;t++)s.scrollTop!==e[t]&&(s.scrollTop=e[t]),s=s.parentNode}class K2 extends te{static hasFocusWithin(e){if(Ls(e)){const t=uw(e),i=t?t.activeElement:e.ownerDocument.activeElement;return ys(i,e)}else{const t=e;return ys(t.document.activeElement,t.document)}}constructor(e){super(),this._onDidFocus=this._register(new Z),this.onDidFocus=this._onDidFocus.event,this._onDidBlur=this._register(new Z),this.onDidBlur=this._onDidBlur.event;let t=K2.hasFocusWithin(e),i=!1;const n=()=>{i=!1,t||(t=!0,this._onDidFocus.fire())},r=()=>{t&&(i=!0,(Ls(e)?nt(e):e).setTimeout(()=>{i&&(i=!1,t=!1,this._onDidBlur.fire())},0))};this._refreshStateHandler=()=>{K2.hasFocusWithin(e)!==t&&(t?r():n())},this._register(oe(e,Le.FOCUS,n,!0)),this._register(oe(e,Le.BLUR,r,!0)),Ls(e)&&(this._register(oe(e,Le.FOCUS_IN,()=>this._refreshStateHandler())),this._register(oe(e,Le.FOCUS_OUT,()=>this._refreshStateHandler())))}}function hu(s){return new K2(s)}function sAe(s,e){return s.after(e),e}function me(s,...e){if(s.append(...e),e.length===1&&typeof e[0]!="string")return e[0]}function zq(s,e){return s.insertBefore(e,s.firstChild),e}function Xs(s,...e){s.innerText="",me(s,...e)}const rAe=/([\w\-]+)?(#([\w\-]+))?((\.([\w\-]+))*)/;var iI;(function(s){s.HTML="http://www.w3.org/1999/xhtml",s.SVG="http://www.w3.org/2000/svg"})(iI||(iI={}));function rhe(s,e,t,...i){const n=rAe.exec(e);if(!n)throw new Error("Bad use of emmet");const r=n[1]||"div";let o;return s!==iI.HTML?o=document.createElementNS(s,r):o=document.createElement(r),n[3]&&(o.id=n[3]),n[4]&&(o.className=n[4].replace(/\./g," ").trim()),t&&Object.entries(t).forEach(([a,l])=>{typeof l>"u"||(/^on\w+$/.test(a)?o[a]=l:a==="selected"?l&&o.setAttribute(a,"true"):o.setAttribute(a,l))}),o.append(...i),o}function ke(s,e,...t){return rhe(iI.HTML,s,e,...t)}ke.SVG=function(s,e,...t){return rhe(iI.SVG,s,e,...t)};function oAe(s,...e){s?ka(...e):fo(...e)}function ka(...s){for(const e of s)e.style.display="",e.removeAttribute("aria-hidden")}function fo(...s){for(const e of s)e.style.display="none",e.setAttribute("aria-hidden","true")}function hte(s,e){const t=s.devicePixelRatio*e;return Math.max(1,Math.floor(t))/s.devicePixelRatio}function ohe(s){Ri.open(s,"_blank","noopener")}function aAe(s,e){const t=()=>{e(),i=Fa(s,t)};let i=Fa(s,t);return Ye(()=>i.dispose())}Que.setPreferredWebSchema(/^https:/.test(Ri.location.href)?"https":"http");function xg(s){return s?`url('${eF.uriToBrowserUri(s).toString(!0).replace(/'/g,"%27")}')`:"url('')"}function oV(s){return`'${s.replace(/'/g,"%27")}'`}function lg(s,e){if(s!==void 0){const t=s.match(/^\s*var\((.+)\)$/);if(t){const i=t[1].split(",",2);return i.length===2&&(e=lg(i[1].trim(),e)),`var(${i[0]}, ${e})`}return s}return e}function lAe(s,e=!1){const t=document.createElement("a");return Kue("afterSanitizeAttributes",i=>{for(const n of["href","src"])if(i.hasAttribute(n)){const r=i.getAttribute(n);if(n==="href"&&r.startsWith("#"))continue;if(t.href=r,!s.includes(t.protocol.replace(/:$/,""))){if(e&&n==="src"&&t.href.startsWith("data:"))continue;i.removeAttribute(n)}}}),Ye(()=>{Gue("afterSanitizeAttributes")})}const cAe=Object.freeze(["a","abbr","b","bdo","blockquote","br","caption","cite","code","col","colgroup","dd","del","details","dfn","div","dl","dt","em","figcaption","figure","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","label","li","mark","ol","p","pre","q","rp","rt","ruby","samp","small","small","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","time","tr","tt","u","ul","var","video","wbr"]);class qf extends Z{constructor(){super(),this._subscriptions=new ce,this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1},this._subscriptions.add(De.runAndSubscribe(nF,({window:e,disposables:t})=>this.registerListeners(e,t),{window:Ri,disposables:this._subscriptions}))}registerListeners(e,t){t.add(oe(e,"keydown",i=>{if(i.defaultPrevented)return;const n=new Mi(i);if(!(n.keyCode===6&&i.repeat)){if(i.altKey&&!this._keyStatus.altKey)this._keyStatus.lastKeyPressed="alt";else if(i.ctrlKey&&!this._keyStatus.ctrlKey)this._keyStatus.lastKeyPressed="ctrl";else if(i.metaKey&&!this._keyStatus.metaKey)this._keyStatus.lastKeyPressed="meta";else if(i.shiftKey&&!this._keyStatus.shiftKey)this._keyStatus.lastKeyPressed="shift";else if(n.keyCode!==6)this._keyStatus.lastKeyPressed=void 0;else return;this._keyStatus.altKey=i.altKey,this._keyStatus.ctrlKey=i.ctrlKey,this._keyStatus.metaKey=i.metaKey,this._keyStatus.shiftKey=i.shiftKey,this._keyStatus.lastKeyPressed&&(this._keyStatus.event=i,this.fire(this._keyStatus))}},!0)),t.add(oe(e,"keyup",i=>{i.defaultPrevented||(!i.altKey&&this._keyStatus.altKey?this._keyStatus.lastKeyReleased="alt":!i.ctrlKey&&this._keyStatus.ctrlKey?this._keyStatus.lastKeyReleased="ctrl":!i.metaKey&&this._keyStatus.metaKey?this._keyStatus.lastKeyReleased="meta":!i.shiftKey&&this._keyStatus.shiftKey?this._keyStatus.lastKeyReleased="shift":this._keyStatus.lastKeyReleased=void 0,this._keyStatus.lastKeyPressed!==this._keyStatus.lastKeyReleased&&(this._keyStatus.lastKeyPressed=void 0),this._keyStatus.altKey=i.altKey,this._keyStatus.ctrlKey=i.ctrlKey,this._keyStatus.metaKey=i.metaKey,this._keyStatus.shiftKey=i.shiftKey,this._keyStatus.lastKeyReleased&&(this._keyStatus.event=i,this.fire(this._keyStatus)))},!0)),t.add(oe(e.document.body,"mousedown",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),t.add(oe(e.document.body,"mouseup",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),t.add(oe(e.document.body,"mousemove",i=>{i.buttons&&(this._keyStatus.lastKeyPressed=void 0)},!0)),t.add(oe(e,"blur",()=>{this.resetKeyStatus()}))}get keyStatus(){return this._keyStatus}resetKeyStatus(){this.doResetKeyStatus(),this.fire(this._keyStatus)}doResetKeyStatus(){this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1}}static getInstance(){return qf.instance||(qf.instance=new qf),qf.instance}dispose(){super.dispose(),this._subscriptions.dispose()}}class dAe extends te{constructor(e,t){super(),this.element=e,this.callbacks=t,this.counter=0,this.dragStartTime=0,this.registerListeners()}registerListeners(){this.callbacks.onDragStart&&this._register(oe(this.element,Le.DRAG_START,e=>{var t,i;(i=(t=this.callbacks).onDragStart)==null||i.call(t,e)})),this.callbacks.onDrag&&this._register(oe(this.element,Le.DRAG,e=>{var t,i;(i=(t=this.callbacks).onDrag)==null||i.call(t,e)})),this._register(oe(this.element,Le.DRAG_ENTER,e=>{var t,i;this.counter++,this.dragStartTime=e.timeStamp,(i=(t=this.callbacks).onDragEnter)==null||i.call(t,e)})),this._register(oe(this.element,Le.DRAG_OVER,e=>{var t,i;e.preventDefault(),(i=(t=this.callbacks).onDragOver)==null||i.call(t,e,e.timeStamp-this.dragStartTime)})),this._register(oe(this.element,Le.DRAG_LEAVE,e=>{var t,i;this.counter--,this.counter===0&&(this.dragStartTime=0,(i=(t=this.callbacks).onDragLeave)==null||i.call(t,e))})),this._register(oe(this.element,Le.DRAG_END,e=>{var t,i;this.counter=0,this.dragStartTime=0,(i=(t=this.callbacks).onDragEnd)==null||i.call(t,e)})),this._register(oe(this.element,Le.DROP,e=>{var t,i;this.counter=0,this.dragStartTime=0,(i=(t=this.callbacks).onDrop)==null||i.call(t,e)}))}}const ahe=/(?<tag>[\w\-]+)?(?:#(?<id>[\w\-]+))?(?<class>(?:\.(?:[\w\-]+))*)(?:@(?<name>(?:[\w\_])+))?/;function Vt(s,...e){let t,i;Array.isArray(e[0])?(t={},i=e[0]):(t=e[0]||{},i=e[1]);const n=ahe.exec(s);if(!n||!n.groups)throw new Error("Bad use of h");const r=n.groups.tag||"div",o=document.createElement(r);n.groups.id&&(o.id=n.groups.id);const a=[];if(n.groups.class)for(const c of n.groups.class.split("."))c!==""&&a.push(c);if(t.className!==void 0)for(const c of t.className.split("."))c!==""&&a.push(c);a.length>0&&(o.className=a.join(" "));const l={};if(n.groups.name&&(l[n.groups.name]=o),i)for(const c of i)Ls(c)?o.appendChild(c):typeof c=="string"?o.append(c):"root"in c&&(Object.assign(l,c),o.appendChild(c.root));for(const[c,d]of Object.entries(t))if(c!=="className")if(c==="style")for(const[u,h]of Object.entries(d))o.style.setProperty(G2(u),typeof h=="number"?h+"px":""+h);else c==="tabIndex"?o.tabIndex=d:o.setAttribute(G2(c),d.toString());return l.root=o,l}function H0(s,...e){let t,i;Array.isArray(e[0])?(t={},i=e[0]):(t=e[0]||{},i=e[1]);const n=ahe.exec(s);if(!n||!n.groups)throw new Error("Bad use of h");const r=n.groups.tag||"div",o=document.createElementNS("http://www.w3.org/2000/svg",r);n.groups.id&&(o.id=n.groups.id);const a=[];if(n.groups.class)for(const c of n.groups.class.split("."))c!==""&&a.push(c);if(t.className!==void 0)for(const c of t.className.split("."))c!==""&&a.push(c);a.length>0&&(o.className=a.join(" "));const l={};if(n.groups.name&&(l[n.groups.name]=o),i)for(const c of i)Ls(c)?o.appendChild(c):typeof c=="string"?o.append(c):"root"in c&&(Object.assign(l,c),o.appendChild(c.root));for(const[c,d]of Object.entries(t))if(c!=="className")if(c==="style")for(const[u,h]of Object.entries(d))o.style.setProperty(G2(u),typeof h=="number"?h+"px":""+h);else c==="tabIndex"?o.tabIndex=d:o.setAttribute(G2(c),d.toString());return l.root=o,l}function G2(s){return s.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}class uAe extends te{constructor(e){super(),this._onDidChange=this._register(new Z),this.onDidChange=this._onDidChange.event,this._listener=()=>this._handleChange(e,!0),this._mediaQueryList=null,this._handleChange(e,!1)}_handleChange(e,t){var i;(i=this._mediaQueryList)==null||i.removeEventListener("change",this._listener),this._mediaQueryList=e.matchMedia(`(resolution: ${e.devicePixelRatio}dppx)`),this._mediaQueryList.addEventListener("change",this._listener),t&&this._onDidChange.fire()}}class hAe extends te{get value(){return this._value}constructor(e){super(),this._onDidChange=this._register(new Z),this.onDidChange=this._onDidChange.event,this._value=this._getPixelRatio(e);const t=this._register(new uAe(e));this._register(t.onDidChange(()=>{this._value=this._getPixelRatio(e),this._onDidChange.fire(this._value)}))}_getPixelRatio(e){const t=document.createElement("canvas").getContext("2d"),i=e.devicePixelRatio||1,n=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return i/n}}class fAe{constructor(){this.mapWindowIdToPixelRatioMonitor=new Map}_getOrCreatePixelRatioMonitor(e){const t=U2(e);let i=this.mapWindowIdToPixelRatioMonitor.get(t);return i||(i=new hAe(e),this.mapWindowIdToPixelRatioMonitor.set(t,i),De.once(z2e)(({vscodeWindowId:n})=>{n===t&&(i==null||i.dispose(),this.mapWindowIdToPixelRatioMonitor.delete(t))})),i}getInstance(e){return this._getOrCreatePixelRatioMonitor(e)}}const nI=new fAe;class lhe{constructor(e){this.domNode=e,this._maxWidth="",this._width="",this._height="",this._top="",this._left="",this._bottom="",this._right="",this._paddingLeft="",this._fontFamily="",this._fontWeight="",this._fontSize="",this._fontStyle="",this._fontFeatureSettings="",this._fontVariationSettings="",this._textDecoration="",this._lineHeight="",this._letterSpacing="",this._className="",this._display="",this._position="",this._visibility="",this._color="",this._backgroundColor="",this._layerHint=!1,this._contain="none",this._boxShadow=""}setMaxWidth(e){const t=Td(e);this._maxWidth!==t&&(this._maxWidth=t,this.domNode.style.maxWidth=this._maxWidth)}setWidth(e){const t=Td(e);this._width!==t&&(this._width=t,this.domNode.style.width=this._width)}setHeight(e){const t=Td(e);this._height!==t&&(this._height=t,this.domNode.style.height=this._height)}setTop(e){const t=Td(e);this._top!==t&&(this._top=t,this.domNode.style.top=this._top)}setLeft(e){const t=Td(e);this._left!==t&&(this._left=t,this.domNode.style.left=this._left)}setBottom(e){const t=Td(e);this._bottom!==t&&(this._bottom=t,this.domNode.style.bottom=this._bottom)}setRight(e){const t=Td(e);this._right!==t&&(this._right=t,this.domNode.style.right=this._right)}setPaddingLeft(e){const t=Td(e);this._paddingLeft!==t&&(this._paddingLeft=t,this.domNode.style.paddingLeft=this._paddingLeft)}setFontFamily(e){this._fontFamily!==e&&(this._fontFamily=e,this.domNode.style.fontFamily=this._fontFamily)}setFontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.domNode.style.fontWeight=this._fontWeight)}setFontSize(e){const t=Td(e);this._fontSize!==t&&(this._fontSize=t,this.domNode.style.fontSize=this._fontSize)}setFontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.domNode.style.fontStyle=this._fontStyle)}setFontFeatureSettings(e){this._fontFeatureSettings!==e&&(this._fontFeatureSettings=e,this.domNode.style.fontFeatureSettings=this._fontFeatureSettings)}setFontVariationSettings(e){this._fontVariationSettings!==e&&(this._fontVariationSettings=e,this.domNode.style.fontVariationSettings=this._fontVariationSettings)}setTextDecoration(e){this._textDecoration!==e&&(this._textDecoration=e,this.domNode.style.textDecoration=this._textDecoration)}setLineHeight(e){const t=Td(e);this._lineHeight!==t&&(this._lineHeight=t,this.domNode.style.lineHeight=this._lineHeight)}setLetterSpacing(e){const t=Td(e);this._letterSpacing!==t&&(this._letterSpacing=t,this.domNode.style.letterSpacing=this._letterSpacing)}setClassName(e){this._className!==e&&(this._className=e,this.domNode.className=this._className)}toggleClassName(e,t){this.domNode.classList.toggle(e,t),this._className=this.domNode.className}setDisplay(e){this._display!==e&&(this._display=e,this.domNode.style.display=this._display)}setPosition(e){this._position!==e&&(this._position=e,this.domNode.style.position=this._position)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this.domNode.style.visibility=this._visibility)}setColor(e){this._color!==e&&(this._color=e,this.domNode.style.color=this._color)}setBackgroundColor(e){this._backgroundColor!==e&&(this._backgroundColor=e,this.domNode.style.backgroundColor=this._backgroundColor)}setLayerHinting(e){this._layerHint!==e&&(this._layerHint=e,this.domNode.style.transform=this._layerHint?"translate3d(0px, 0px, 0px)":"")}setBoxShadow(e){this._boxShadow!==e&&(this._boxShadow=e,this.domNode.style.boxShadow=e)}setContain(e){this._contain!==e&&(this._contain=e,this.domNode.style.contain=this._contain)}setAttribute(e,t){this.domNode.setAttribute(e,t)}removeAttribute(e){this.domNode.removeAttribute(e)}appendChild(e){this.domNode.appendChild(e.domNode)}removeChild(e){this.domNode.removeChild(e.domNode)}}function Td(s){return typeof s=="number"?`${s}px`:s}function gi(s){return new lhe(s)}function Zs(s,e){s instanceof lhe?(s.setFontFamily(e.getMassagedFontFamily()),s.setFontWeight(e.fontWeight),s.setFontSize(e.fontSize),s.setFontFeatureSettings(e.fontFeatureSettings),s.setFontVariationSettings(e.fontVariationSettings),s.setLineHeight(e.lineHeight),s.setLetterSpacing(e.letterSpacing)):(s.style.fontFamily=e.getMassagedFontFamily(),s.style.fontWeight=e.fontWeight,s.style.fontSize=e.fontSize+"px",s.style.fontFeatureSettings=e.fontFeatureSettings,s.style.fontVariationSettings=e.fontVariationSettings,s.style.lineHeight=e.lineHeight+"px",s.style.letterSpacing=e.letterSpacing+"px")}class gAe{constructor(e,t){this.chr=e,this.type=t,this.width=0}fulfill(e){this.width=e}}class Uq{constructor(e,t){this._bareFontInfo=e,this._requests=t,this._container=null,this._testElements=null}read(e){var t;this._createDomElements(),e.document.body.appendChild(this._container),this._readFromDomElements(),(t=this._container)==null||t.remove(),this._container=null,this._testElements=null}_createDomElements(){const e=document.createElement("div");e.style.position="absolute",e.style.top="-50000px",e.style.width="50000px";const t=document.createElement("div");Zs(t,this._bareFontInfo),e.appendChild(t);const i=document.createElement("div");Zs(i,this._bareFontInfo),i.style.fontWeight="bold",e.appendChild(i);const n=document.createElement("div");Zs(n,this._bareFontInfo),n.style.fontStyle="italic",e.appendChild(n);const r=[];for(const o of this._requests){let a;o.type===0&&(a=t),o.type===2&&(a=i),o.type===1&&(a=n),a.appendChild(document.createElement("br"));const l=document.createElement("span");Uq._render(l,o),a.appendChild(l),r.push(l)}this._container=e,this._testElements=r}static _render(e,t){if(t.chr===" "){let i=" ";for(let n=0;n<8;n++)i+=i;e.innerText=i}else{let i=t.chr;for(let n=0;n<8;n++)i+=i;e.textContent=i}}_readFromDomElements(){for(let e=0,t=this._requests.length;e<t;e++){const i=this._requests[e],n=this._testElements[e];i.fulfill(n.offsetWidth/256)}}}function pAe(s,e,t){new Uq(e,t).read(s)}const oc=new class{constructor(){this._zoomLevel=0,this._onDidChangeZoomLevel=new Z,this.onDidChangeZoomLevel=this._onDidChangeZoomLevel.event}getZoomLevel(){return this._zoomLevel}setZoomLevel(s){s=Math.min(Math.max(-5,s),20),this._zoomLevel!==s&&(this._zoomLevel=s,this._onDidChangeZoomLevel.fire(this._zoomLevel))}},mAe=Wt?1.5:1.35,aV=8;class Qb{static createFromValidatedSettings(e,t,i){const n=e.get(49),r=e.get(53),o=e.get(52),a=e.get(51),l=e.get(54),c=e.get(67),d=e.get(64);return Qb._create(n,r,o,a,l,c,d,t,i)}static _create(e,t,i,n,r,o,a,l,c){o===0?o=mAe*i:o<aV&&(o=o*i),o=Math.round(o),o<aV&&(o=aV);const d=1+(c?0:oc.getZoomLevel()*.1);return i*=d,o*=d,r===Qk.TRANSLATE&&(t==="normal"||t==="bold"?r=Qk.OFF:(r=`'wght' ${parseInt(t,10)}`,t="normal")),new Qb({pixelRatio:l,fontFamily:e,fontWeight:t,fontSize:i,fontFeatureSettings:n,fontVariationSettings:r,lineHeight:o,letterSpacing:a})}constructor(e){this._bareFontInfoBrand=void 0,this.pixelRatio=e.pixelRatio,this.fontFamily=String(e.fontFamily),this.fontWeight=String(e.fontWeight),this.fontSize=e.fontSize,this.fontFeatureSettings=e.fontFeatureSettings,this.fontVariationSettings=e.fontVariationSettings,this.lineHeight=e.lineHeight|0,this.letterSpacing=e.letterSpacing}getId(){return`${this.pixelRatio}-${this.fontFamily}-${this.fontWeight}-${this.fontSize}-${this.fontFeatureSettings}-${this.fontVariationSettings}-${this.lineHeight}-${this.letterSpacing}`}getMassagedFontFamily(){const e=yo.fontFamily,t=Qb._wrapInQuotes(this.fontFamily);return e&&this.fontFamily!==e?`${t}, ${e}`:t}static _wrapInQuotes(e){return/[,"']/.test(e)?e:/[+ ]/.test(e)?`"${e}"`:e}}const _Ae=2;class XW extends Qb{constructor(e,t){super(e),this._editorStylingBrand=void 0,this.version=_Ae,this.isTrusted=t,this.isMonospace=e.isMonospace,this.typicalHalfwidthCharacterWidth=e.typicalHalfwidthCharacterWidth,this.typicalFullwidthCharacterWidth=e.typicalFullwidthCharacterWidth,this.canUseHalfwidthRightwardsArrow=e.canUseHalfwidthRightwardsArrow,this.spaceWidth=e.spaceWidth,this.middotWidth=e.middotWidth,this.wsmiddotWidth=e.wsmiddotWidth,this.maxDigitWidth=e.maxDigitWidth}equals(e){return this.fontFamily===e.fontFamily&&this.fontWeight===e.fontWeight&&this.fontSize===e.fontSize&&this.fontFeatureSettings===e.fontFeatureSettings&&this.fontVariationSettings===e.fontVariationSettings&&this.lineHeight===e.lineHeight&&this.letterSpacing===e.letterSpacing&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.typicalFullwidthCharacterWidth===e.typicalFullwidthCharacterWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.maxDigitWidth===e.maxDigitWidth}}class bAe extends te{constructor(){super(...arguments),this._cache=new Map,this._evictUntrustedReadingsTimeout=-1,this._onDidChange=this._register(new Z),this.onDidChange=this._onDidChange.event}dispose(){this._evictUntrustedReadingsTimeout!==-1&&(clearTimeout(this._evictUntrustedReadingsTimeout),this._evictUntrustedReadingsTimeout=-1),super.dispose()}clearAllFontInfos(){this._cache.clear(),this._onDidChange.fire()}_ensureCache(e){const t=U2(e);let i=this._cache.get(t);return i||(i=new vAe,this._cache.set(t,i)),i}_writeToCache(e,t,i){this._ensureCache(e).put(t,i),!i.isTrusted&&this._evictUntrustedReadingsTimeout===-1&&(this._evictUntrustedReadingsTimeout=e.setTimeout(()=>{this._evictUntrustedReadingsTimeout=-1,this._evictUntrustedReadings(e)},5e3))}_evictUntrustedReadings(e){const t=this._ensureCache(e),i=t.getValues();let n=!1;for(const r of i)r.isTrusted||(n=!0,t.remove(r));n&&this._onDidChange.fire()}readFontInfo(e,t){const i=this._ensureCache(e);if(!i.has(t)){let n=this._actualReadFontInfo(e,t);(n.typicalHalfwidthCharacterWidth<=2||n.typicalFullwidthCharacterWidth<=2||n.spaceWidth<=2||n.maxDigitWidth<=2)&&(n=new XW({pixelRatio:nI.getInstance(e).value,fontFamily:n.fontFamily,fontWeight:n.fontWeight,fontSize:n.fontSize,fontFeatureSettings:n.fontFeatureSettings,fontVariationSettings:n.fontVariationSettings,lineHeight:n.lineHeight,letterSpacing:n.letterSpacing,isMonospace:n.isMonospace,typicalHalfwidthCharacterWidth:Math.max(n.typicalHalfwidthCharacterWidth,5),typicalFullwidthCharacterWidth:Math.max(n.typicalFullwidthCharacterWidth,5),canUseHalfwidthRightwardsArrow:n.canUseHalfwidthRightwardsArrow,spaceWidth:Math.max(n.spaceWidth,5),middotWidth:Math.max(n.middotWidth,5),wsmiddotWidth:Math.max(n.wsmiddotWidth,5),maxDigitWidth:Math.max(n.maxDigitWidth,5)},!1)),this._writeToCache(e,t,n)}return i.get(t)}_createRequest(e,t,i,n){const r=new gAe(e,t);return i.push(r),n==null||n.push(r),r}_actualReadFontInfo(e,t){const i=[],n=[],r=this._createRequest("n",0,i,n),o=this._createRequest("ｍ",0,i,null),a=this._createRequest(" ",0,i,n),l=this._createRequest("0",0,i,n),c=this._createRequest("1",0,i,n),d=this._createRequest("2",0,i,n),u=this._createRequest("3",0,i,n),h=this._createRequest("4",0,i,n),g=this._createRequest("5",0,i,n),p=this._createRequest("6",0,i,n),_=this._createRequest("7",0,i,n),v=this._createRequest("8",0,i,n),C=this._createRequest("9",0,i,n),y=this._createRequest("→",0,i,n),x=this._createRequest("￫",0,i,null),L=this._createRequest("·",0,i,n),I=this._createRequest("⸱",0,i,null),A="|/-_ilm%";for(let H=0,U=A.length;H<U;H++)this._createRequest(A.charAt(H),0,i,n),this._createRequest(A.charAt(H),1,i,n),this._createRequest(A.charAt(H),2,i,n);pAe(e,t,i);const D=Math.max(l.width,c.width,d.width,u.width,h.width,g.width,p.width,_.width,v.width,C.width);let N=t.fontFeatureSettings===Bm.OFF;const R=n[0].width;for(let H=1,U=n.length;N&&H<U;H++){const B=R-n[H].width;if(B<-.001||B>.001){N=!1;break}}let W=!0;return N&&x.width!==R&&(W=!1),x.width>y.width&&(W=!1),new XW({pixelRatio:nI.getInstance(e).value,fontFamily:t.fontFamily,fontWeight:t.fontWeight,fontSize:t.fontSize,fontFeatureSettings:t.fontFeatureSettings,fontVariationSettings:t.fontVariationSettings,lineHeight:t.lineHeight,letterSpacing:t.letterSpacing,isMonospace:N,typicalHalfwidthCharacterWidth:r.width,typicalFullwidthCharacterWidth:o.width,canUseHalfwidthRightwardsArrow:W,spaceWidth:a.width,middotWidth:L.width,wsmiddotWidth:I.width,maxDigitWidth:D},!0)}}class vAe{constructor(){this._keys=Object.create(null),this._values=Object.create(null)}has(e){const t=e.getId();return!!this._values[t]}get(e){const t=e.getId();return this._values[t]}put(e,t){const i=e.getId();this._keys[i]=e,this._values[i]=t}remove(e){const t=e.getId();delete this._keys[t],delete this._values[t]}getValues(){return Object.keys(this._keys).map(e=>this._values[e])}}const ZW=new bAe;var Xd;(function(s){s.serviceIds=new Map,s.DI_TARGET="$di$target",s.DI_DEPENDENCIES="$di$dependencies";function e(t){return t[s.DI_DEPENDENCIES]||[]}s.getServiceDependencies=e})(Xd||(Xd={}));const Xe=Ht("instantiationService");function wAe(s,e,t){e[Xd.DI_TARGET]===e?e[Xd.DI_DEPENDENCIES].push({id:s,index:t}):(e[Xd.DI_DEPENDENCIES]=[{id:s,index:t}],e[Xd.DI_TARGET]=e)}function Ht(s){if(Xd.serviceIds.has(s))return Xd.serviceIds.get(s);const e=function(t,i,n){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");wAe(e,t,n)};return e.toString=()=>s,Xd.serviceIds.set(s,e),e}const ni=Ht("codeEditorService"),Gi=Ht("modelService"),oa=Ht("textModelService");class Na extends te{constructor(e,t="",i="",n=!0,r){super(),this._onDidChange=this._register(new Z),this.onDidChange=this._onDidChange.event,this._enabled=!0,this._id=e,this._label=t,this._cssClass=i,this._enabled=n,this._actionCallback=r}get id(){return this._id}get label(){return this._label}set label(e){this._setLabel(e)}_setLabel(e){this._label!==e&&(this._label=e,this._onDidChange.fire({label:e}))}get tooltip(){return this._tooltip||""}set tooltip(e){this._setTooltip(e)}_setTooltip(e){this._tooltip!==e&&(this._tooltip=e,this._onDidChange.fire({tooltip:e}))}get class(){return this._cssClass}set class(e){this._setClass(e)}_setClass(e){this._cssClass!==e&&(this._cssClass=e,this._onDidChange.fire({class:e}))}get enabled(){return this._enabled}set enabled(e){this._setEnabled(e)}_setEnabled(e){this._enabled!==e&&(this._enabled=e,this._onDidChange.fire({enabled:e}))}get checked(){return this._checked}set checked(e){this._setChecked(e)}_setChecked(e){this._checked!==e&&(this._checked=e,this._onDidChange.fire({checked:e}))}async run(e,t){this._actionCallback&&await this._actionCallback(e)}}class hw extends te{constructor(){super(...arguments),this._onWillRun=this._register(new Z),this.onWillRun=this._onWillRun.event,this._onDidRun=this._register(new Z),this.onDidRun=this._onDidRun.event}async run(e,t){if(!e.enabled)return;this._onWillRun.fire({action:e});let i;try{await this.runAction(e,t)}catch(n){i=n}this._onDidRun.fire({action:e,error:i})}async runAction(e,t){await e.run(t)}}const mk=class mk{constructor(){this.id=mk.ID,this.label="",this.tooltip="",this.class="separator",this.enabled=!1,this.checked=!1}static join(...e){let t=[];for(const i of e)i.length&&(t.length?t=[...t,new mk,...i]:t=i);return t}async run(){}};mk.ID="vs.actions.separator";let ks=mk;class f1{get actions(){return this._actions}constructor(e,t,i,n){this.tooltip="",this.enabled=!0,this.checked=void 0,this.id=e,this.label=t,this.class=n,this._actions=i}async run(){}}const AM=class AM extends Na{constructor(){super(AM.ID,b("submenu.empty","(empty)"),void 0,!1)}};AM.ID="vs.actions.empty";let JW=AM;function Yb(s){return{id:s.id,label:s.label,tooltip:s.tooltip??s.label,class:s.class,enabled:s.enabled??!0,checked:s.checked,run:async(...e)=>s.run(...e)}}var e6;(function(s){function e(t){return t&&typeof t=="object"&&typeof t.id=="string"}s.isThemeColor=e})(e6||(e6={}));var at;(function(s){s.iconNameSegment="[A-Za-z0-9]+",s.iconNameExpression="[A-Za-z0-9-]+",s.iconModifierExpression="~[A-Za-z]+",s.iconNameCharacter="[A-Za-z0-9~-]";const e=new RegExp(`^(${s.iconNameExpression})(${s.iconModifierExpression})?$`);function t(h){const g=e.exec(h.id);if(!g)return t(xe.error);const[,p,_]=g,v=["codicon","codicon-"+p];return _&&v.push("codicon-modifier-"+_.substring(1)),v}s.asClassNameArray=t;function i(h){return t(h).join(" ")}s.asClassName=i;function n(h){return"."+t(h).join(".")}s.asCSSSelector=n;function r(h){return h&&typeof h=="object"&&typeof h.id=="string"&&(typeof h.color>"u"||e6.isThemeColor(h.color))}s.isThemeIcon=r;const o=new RegExp(`^\\$\\((${s.iconNameExpression}(?:${s.iconModifierExpression})?)\\)$`);function a(h){const g=o.exec(h);if(!g)return;const[,p]=g;return{id:p}}s.fromString=a;function l(h){return{id:h}}s.fromId=l;function c(h,g){let p=h.id;const _=p.lastIndexOf("~");return _!==-1&&(p=p.substring(0,_)),g&&(p=`${p}~${g}`),{id:p}}s.modify=c;function d(h){const g=h.id.lastIndexOf("~");if(g!==-1)return h.id.substring(g+1)}s.getModifier=d;function u(h,g){var p,_;return h.id===g.id&&((p=h.color)==null?void 0:p.id)===((_=g.color)==null?void 0:_.id)}s.isEqual=u})(at||(at={}));const Hi=Ht("commandService"),Gt=new class{constructor(){this._commands=new Map,this._onDidRegisterCommand=new Z,this.onDidRegisterCommand=this._onDidRegisterCommand.event}registerCommand(s,e){if(!s)throw new Error("invalid command");if(typeof s=="string"){if(!e)throw new Error("invalid command");return this.registerCommand({id:s,handler:e})}if(s.metadata&&Array.isArray(s.metadata.args)){const o=[];for(const l of s.metadata.args)o.push(l.constraint);const a=s.handler;s.handler=function(l,...c){return ATe(c,o),a(l,...c)}}const{id:t}=s;let i=this._commands.get(t);i||(i=new _o,this._commands.set(t,i));const n=i.unshift(s),r=Ye(()=>{n();const o=this._commands.get(t);o!=null&&o.isEmpty()&&this._commands.delete(t)});return this._onDidRegisterCommand.fire(t),r}registerCommandAlias(s,e){return Gt.registerCommand(s,(t,...i)=>t.get(Hi).executeCommand(e,...i))}getCommand(s){const e=this._commands.get(s);if(!(!e||e.isEmpty()))return Kt.first(e)}getCommands(){const s=new Map;for(const e of this._commands.keys()){const t=this.getCommand(e);t&&s.set(e,t)}return s}};Gt.registerCommand("noop",()=>{});function lV(...s){switch(s.length){case 1:return b("contextkey.scanner.hint.didYouMean1","Did you mean {0}?",s[0]);case 2:return b("contextkey.scanner.hint.didYouMean2","Did you mean {0} or {1}?",s[0],s[1]);case 3:return b("contextkey.scanner.hint.didYouMean3","Did you mean {0}, {1} or {2}?",s[0],s[1],s[2]);default:return}}const CAe=b("contextkey.scanner.hint.didYouForgetToOpenOrCloseQuote","Did you forget to open or close the quote?"),yAe=b("contextkey.scanner.hint.didYouForgetToEscapeSlash","Did you forget to escape the '/' (slash) character? Put two backslashes before it to escape, e.g., '\\\\/'.");var eg;let Cx=(eg=class{constructor(){this._input="",this._start=0,this._current=0,this._tokens=[],this._errors=[],this.stringRe=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy}static getLexeme(e){switch(e.type){case 0:return"(";case 1:return")";case 2:return"!";case 3:return e.isTripleEq?"===":"==";case 4:return e.isTripleEq?"!==":"!=";case 5:return"<";case 6:return"<=";case 7:return">=";case 8:return">=";case 9:return"=~";case 10:return e.lexeme;case 11:return"true";case 12:return"false";case 13:return"in";case 14:return"not";case 15:return"&&";case 16:return"||";case 17:return e.lexeme;case 18:return e.lexeme;case 19:return e.lexeme;case 20:return"EOF";default:throw yq(`unhandled token type: ${JSON.stringify(e)}; have you forgotten to add a case?`)}}reset(e){return this._input=e,this._start=0,this._current=0,this._tokens=[],this._errors=[],this}scan(){for(;!this._isAtEnd();)switch(this._start=this._current,this._advance()){case 40:this._addToken(0);break;case 41:this._addToken(1);break;case 33:if(this._match(61)){const t=this._match(61);this._tokens.push({type:4,offset:this._start,isTripleEq:t})}else this._addToken(2);break;case 39:this._quotedString();break;case 47:this._regex();break;case 61:if(this._match(61)){const t=this._match(61);this._tokens.push({type:3,offset:this._start,isTripleEq:t})}else this._match(126)?this._addToken(9):this._error(lV("==","=~"));break;case 60:this._addToken(this._match(61)?6:5);break;case 62:this._addToken(this._match(61)?8:7);break;case 38:this._match(38)?this._addToken(15):this._error(lV("&&"));break;case 124:this._match(124)?this._addToken(16):this._error(lV("||"));break;case 32:case 13:case 9:case 10:case 160:break;default:this._string()}return this._start=this._current,this._addToken(20),Array.from(this._tokens)}_match(e){return this._isAtEnd()||this._input.charCodeAt(this._current)!==e?!1:(this._current++,!0)}_advance(){return this._input.charCodeAt(this._current++)}_peek(){return this._isAtEnd()?0:this._input.charCodeAt(this._current)}_addToken(e){this._tokens.push({type:e,offset:this._start})}_error(e){const t=this._start,i=this._input.substring(this._start,this._current),n={type:19,offset:this._start,lexeme:i};this._errors.push({offset:t,lexeme:i,additionalInfo:e}),this._tokens.push(n)}_string(){this.stringRe.lastIndex=this._start;const e=this.stringRe.exec(this._input);if(e){this._current=this._start+e[0].length;const t=this._input.substring(this._start,this._current),i=eg._keywords.get(t);i?this._addToken(i):this._tokens.push({type:17,lexeme:t,offset:this._start})}}_quotedString(){for(;this._peek()!==39&&!this._isAtEnd();)this._advance();if(this._isAtEnd()){this._error(CAe);return}this._advance(),this._tokens.push({type:18,lexeme:this._input.substring(this._start+1,this._current-1),offset:this._start+1})}_regex(){let e=this._current,t=!1,i=!1;for(;;){if(e>=this._input.length){this._current=e,this._error(yAe);return}const r=this._input.charCodeAt(e);if(t)t=!1;else if(r===47&&!i){e++;break}else r===91?i=!0:r===92?t=!0:r===93&&(i=!1);e++}for(;e<this._input.length&&eg._regexFlags.has(this._input.charCodeAt(e));)e++;this._current=e;const n=this._input.substring(this._start,this._current);this._tokens.push({type:10,lexeme:n,offset:this._start})}_isAtEnd(){return this._current>=this._input.length}},eg._regexFlags=new Set(["i","g","s","m","y","u"].map(e=>e.charCodeAt(0))),eg._keywords=new Map([["not",14],["in",13],["false",12],["true",11]]),eg);const Ir=new Map;Ir.set("false",!1);Ir.set("true",!0);Ir.set("isMac",Wt);Ir.set("isLinux",Lo);Ir.set("isWindows",gr);Ir.set("isWeb",Uw);Ir.set("isMacNative",Wt&&!Uw);Ir.set("isEdge",GTe);Ir.set("isFirefox",qTe);Ir.set("isChrome",oue);Ir.set("isSafari",KTe);const SAe=Object.prototype.hasOwnProperty,xAe={regexParsingWithErrorRecovery:!0},LAe=b("contextkey.parser.error.emptyString","Empty context key expression"),kAe=b("contextkey.parser.error.emptyString.hint","Did you forget to write an expression? You can also put 'false' or 'true' to always evaluate to false or true, respectively."),IAe=b("contextkey.parser.error.noInAfterNot","'in' after 'not'."),fte=b("contextkey.parser.error.closingParenthesis","closing parenthesis ')'"),EAe=b("contextkey.parser.error.unexpectedToken","Unexpected token"),DAe=b("contextkey.parser.error.unexpectedToken.hint","Did you forget to put && or || before the token?"),TAe=b("contextkey.parser.error.unexpectedEOF","Unexpected end of expression"),NAe=b("contextkey.parser.error.unexpectedEOF.hint","Did you forget to put a context key?");var hh;let RAe=(hh=class{constructor(e=xAe){this._config=e,this._scanner=new Cx,this._tokens=[],this._current=0,this._parsingErrors=[],this._flagsGYRe=/g|y/g}parse(e){if(e===""){this._parsingErrors.push({message:LAe,offset:0,lexeme:"",additionalInfo:kAe});return}this._tokens=this._scanner.reset(e).scan(),this._current=0,this._parsingErrors=[];try{const t=this._expr();if(!this._isAtEnd()){const i=this._peek(),n=i.type===17?DAe:void 0;throw this._parsingErrors.push({message:EAe,offset:i.offset,lexeme:Cx.getLexeme(i),additionalInfo:n}),hh._parseError}return t}catch(t){if(t!==hh._parseError)throw t;return}}_expr(){return this._or()}_or(){const e=[this._and()];for(;this._matchOne(16);){const t=this._and();e.push(t)}return e.length===1?e[0]:he.or(...e)}_and(){const e=[this._term()];for(;this._matchOne(15);){const t=this._term();e.push(t)}return e.length===1?e[0]:he.and(...e)}_term(){if(this._matchOne(2)){const e=this._peek();switch(e.type){case 11:return this._advance(),ko.INSTANCE;case 12:return this._advance(),ia.INSTANCE;case 0:{this._advance();const t=this._expr();return this._consume(1,fte),t==null?void 0:t.negate()}case 17:return this._advance(),$w.create(e.lexeme);default:throw this._errExpectedButGot("KEY | true | false | '(' expression ')'",e)}}return this._primary()}_primary(){const e=this._peek();switch(e.type){case 11:return this._advance(),he.true();case 12:return this._advance(),he.false();case 0:{this._advance();const t=this._expr();return this._consume(1,fte),t}case 17:{const t=e.lexeme;if(this._advance(),this._matchOne(9)){const n=this._peek();if(!this._config.regexParsingWithErrorRecovery){if(this._advance(),n.type!==10)throw this._errExpectedButGot("REGEX",n);const r=n.lexeme,o=r.lastIndexOf("/"),a=o===r.length-1?void 0:this._removeFlagsGY(r.substring(o+1));let l;try{l=new RegExp(r.substring(1,o),a)}catch{throw this._errExpectedButGot("REGEX",n)}return sI.create(t,l)}switch(n.type){case 10:case 19:{const r=[n.lexeme];this._advance();let o=this._peek(),a=0;for(let h=0;h<n.lexeme.length;h++)n.lexeme.charCodeAt(h)===40?a++:n.lexeme.charCodeAt(h)===41&&a--;for(;!this._isAtEnd()&&o.type!==15&&o.type!==16;){switch(o.type){case 0:a++;break;case 1:a--;break;case 10:case 18:for(let h=0;h<o.lexeme.length;h++)o.lexeme.charCodeAt(h)===40?a++:n.lexeme.charCodeAt(h)===41&&a--}if(a<0)break;r.push(Cx.getLexeme(o)),this._advance(),o=this._peek()}const l=r.join(""),c=l.lastIndexOf("/"),d=c===l.length-1?void 0:this._removeFlagsGY(l.substring(c+1));let u;try{u=new RegExp(l.substring(1,c),d)}catch{throw this._errExpectedButGot("REGEX",n)}return he.regex(t,u)}case 18:{const r=n.lexeme;this._advance();let o=null;if(!Iue(r)){const a=r.indexOf("/"),l=r.lastIndexOf("/");if(a!==l&&a>=0){const c=r.slice(a+1,l),d=r[l+1]==="i"?"i":"";try{o=new RegExp(c,d)}catch{throw this._errExpectedButGot("REGEX",n)}}}if(o===null)throw this._errExpectedButGot("REGEX",n);return sI.create(t,o)}default:throw this._errExpectedButGot("REGEX",this._peek())}}if(this._matchOne(14)){this._consume(13,IAe);const n=this._value();return he.notIn(t,n)}switch(this._peek().type){case 3:{this._advance();const n=this._value();if(this._previous().type===18)return he.equals(t,n);switch(n){case"true":return he.has(t);case"false":return he.not(t);default:return he.equals(t,n)}}case 4:{this._advance();const n=this._value();if(this._previous().type===18)return he.notEquals(t,n);switch(n){case"true":return he.not(t);case"false":return he.has(t);default:return he.notEquals(t,n)}}case 5:return this._advance(),hF.create(t,this._value());case 6:return this._advance(),fF.create(t,this._value());case 7:return this._advance(),dF.create(t,this._value());case 8:return this._advance(),uF.create(t,this._value());case 13:return this._advance(),he.in(t,this._value());default:return he.has(t)}}case 20:throw this._parsingErrors.push({message:TAe,offset:e.offset,lexeme:"",additionalInfo:NAe}),hh._parseError;default:throw this._errExpectedButGot(`true | false | KEY 
	| KEY '=~' REGEX 
	| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this._peek())}}_value(){const e=this._peek();switch(e.type){case 17:case 18:return this._advance(),e.lexeme;case 11:return this._advance(),"true";case 12:return this._advance(),"false";case 13:return this._advance(),"in";default:return""}}_removeFlagsGY(e){return e.replaceAll(this._flagsGYRe,"")}_previous(){return this._tokens[this._current-1]}_matchOne(e){return this._check(e)?(this._advance(),!0):!1}_advance(){return this._isAtEnd()||this._current++,this._previous()}_consume(e,t){if(this._check(e))return this._advance();throw this._errExpectedButGot(t,this._peek())}_errExpectedButGot(e,t,i){const n=b("contextkey.parser.error.expectedButGot",`Expected: {0}
Received: '{1}'.`,e,Cx.getLexeme(t)),r=t.offset,o=Cx.getLexeme(t);return this._parsingErrors.push({message:n,offset:r,lexeme:o,additionalInfo:i}),hh._parseError}_check(e){return this._peek().type===e}_peek(){return this._tokens[this._current]}_isAtEnd(){return this._peek().type===20}},hh._parseError=new Error,hh);const rY=class rY{static false(){return ko.INSTANCE}static true(){return ia.INSTANCE}static has(e){return jw.create(e)}static equals(e,t){return dS.create(e,t)}static notEquals(e,t){return lF.create(e,t)}static regex(e,t){return sI.create(e,t)}static in(e,t){return oF.create(e,t)}static notIn(e,t){return aF.create(e,t)}static not(e){return $w.create(e)}static and(...e){return Fb.create(e,null,!0)}static or(...e){return Ff.create(e,null,!0)}static deserialize(e){return e==null?void 0:this._parser.parse(e)}};rY._parser=new RAe({regexParsingWithErrorRecovery:!1});let he=rY;function AAe(s,e){const t=s?s.substituteConstants():void 0,i=e?e.substituteConstants():void 0;return!t&&!i?!0:!t||!i?!1:t.equals(i)}function NL(s,e){return s.cmp(e)}const PM=class PM{constructor(){this.type=0}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!1}serialize(){return"false"}keys(){return[]}negate(){return ia.INSTANCE}};PM.INSTANCE=new PM;let ko=PM;const MM=class MM{constructor(){this.type=1}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!0}serialize(){return"true"}keys(){return[]}negate(){return ko.INSTANCE}};MM.INSTANCE=new MM;let ia=MM;class jw{static create(e,t=null){const i=Ir.get(e);return typeof i=="boolean"?i?ia.INSTANCE:ko.INSTANCE:new jw(e,t)}constructor(e,t){this.key=e,this.negated=t,this.type=2}cmp(e){return e.type!==this.type?this.type-e.type:dhe(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){const e=Ir.get(this.key);return typeof e=="boolean"?e?ia.INSTANCE:ko.INSTANCE:this}evaluate(e){return!!e.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}negate(){return this.negated||(this.negated=$w.create(this.key,this)),this.negated}}class dS{static create(e,t,i=null){if(typeof t=="boolean")return t?jw.create(e,i):$w.create(e,i);const n=Ir.get(e);return typeof n=="boolean"?t===(n?"true":"false")?ia.INSTANCE:ko.INSTANCE:new dS(e,t,i)}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=4}cmp(e){return e.type!==this.type?this.type-e.type:qw(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){const e=Ir.get(this.key);if(typeof e=="boolean"){const t=e?"true":"false";return this.value===t?ia.INSTANCE:ko.INSTANCE}return this}evaluate(e){return e.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}negate(){return this.negated||(this.negated=lF.create(this.key,this.value,this)),this.negated}}class oF{static create(e,t){return new oF(e,t)}constructor(e,t){this.key=e,this.valueKey=t,this.type=10,this.negated=null}cmp(e){return e.type!==this.type?this.type-e.type:qw(this.key,this.valueKey,e.key,e.valueKey)}equals(e){return e.type===this.type?this.key===e.key&&this.valueKey===e.valueKey:!1}substituteConstants(){return this}evaluate(e){const t=e.getValue(this.valueKey),i=e.getValue(this.key);return Array.isArray(t)?t.includes(i):typeof i=="string"&&typeof t=="object"&&t!==null?SAe.call(t,i):!1}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}negate(){return this.negated||(this.negated=aF.create(this.key,this.valueKey)),this.negated}}class aF{static create(e,t){return new aF(e,t)}constructor(e,t){this.key=e,this.valueKey=t,this.type=11,this._negated=oF.create(e,t)}cmp(e){return e.type!==this.type?this.type-e.type:this._negated.cmp(e._negated)}equals(e){return e.type===this.type?this._negated.equals(e._negated):!1}substituteConstants(){return this}evaluate(e){return!this._negated.evaluate(e)}serialize(){return`${this.key} not in '${this.valueKey}'`}keys(){return this._negated.keys()}negate(){return this._negated}}class lF{static create(e,t,i=null){if(typeof t=="boolean")return t?$w.create(e,i):jw.create(e,i);const n=Ir.get(e);return typeof n=="boolean"?t===(n?"true":"false")?ko.INSTANCE:ia.INSTANCE:new lF(e,t,i)}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=5}cmp(e){return e.type!==this.type?this.type-e.type:qw(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){const e=Ir.get(this.key);if(typeof e=="boolean"){const t=e?"true":"false";return this.value===t?ko.INSTANCE:ia.INSTANCE}return this}evaluate(e){return e.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}negate(){return this.negated||(this.negated=dS.create(this.key,this.value,this)),this.negated}}class $w{static create(e,t=null){const i=Ir.get(e);return typeof i=="boolean"?i?ko.INSTANCE:ia.INSTANCE:new $w(e,t)}constructor(e,t){this.key=e,this.negated=t,this.type=3}cmp(e){return e.type!==this.type?this.type-e.type:dhe(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){const e=Ir.get(this.key);return typeof e=="boolean"?e?ko.INSTANCE:ia.INSTANCE:this}evaluate(e){return!e.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=jw.create(this.key,this)),this.negated}}function cF(s,e){if(typeof s=="string"){const t=parseFloat(s);isNaN(t)||(s=t)}return typeof s=="string"||typeof s=="number"?e(s):ko.INSTANCE}class dF{static create(e,t,i=null){return cF(t,n=>new dF(e,n,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=12}cmp(e){return e.type!==this.type?this.type-e.type:qw(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=fF.create(this.key,this.value,this)),this.negated}}class uF{static create(e,t,i=null){return cF(t,n=>new uF(e,n,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=13}cmp(e){return e.type!==this.type?this.type-e.type:qw(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=hF.create(this.key,this.value,this)),this.negated}}class hF{static create(e,t,i=null){return cF(t,n=>new hF(e,n,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=14}cmp(e){return e.type!==this.type?this.type-e.type:qw(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=uF.create(this.key,this.value,this)),this.negated}}class fF{static create(e,t,i=null){return cF(t,n=>new fF(e,n,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=15}cmp(e){return e.type!==this.type?this.type-e.type:qw(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=dF.create(this.key,this.value,this)),this.negated}}class sI{static create(e,t){return new sI(e,t)}constructor(e,t){this.key=e,this.regexp=t,this.type=7,this.negated=null}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.key<e.key)return-1;if(this.key>e.key)return 1;const t=this.regexp?this.regexp.source:"",i=e.regexp?e.regexp.source:"";return t<i?-1:t>i?1:0}equals(e){if(e.type===this.type){const t=this.regexp?this.regexp.source:"",i=e.regexp?e.regexp.source:"";return this.key===e.key&&t===i}return!1}substituteConstants(){return this}evaluate(e){const t=e.getValue(this.key);return this.regexp?this.regexp.test(t):!1}serialize(){const e=this.regexp?`/${this.regexp.source}/${this.regexp.flags}`:"/invalid/";return`${this.key} =~ ${e}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=jq.create(this)),this.negated}}class jq{static create(e){return new jq(e)}constructor(e){this._actual=e,this.type=8}cmp(e){return e.type!==this.type?this.type-e.type:this._actual.cmp(e._actual)}equals(e){return e.type===this.type?this._actual.equals(e._actual):!1}substituteConstants(){return this}evaluate(e){return!this._actual.evaluate(e)}serialize(){return`!(${this._actual.serialize()})`}keys(){return this._actual.keys()}negate(){return this._actual}}function che(s){let e=null;for(let t=0,i=s.length;t<i;t++){const n=s[t].substituteConstants();if(s[t]!==n&&e===null){e=[];for(let r=0;r<t;r++)e[r]=s[r]}e!==null&&(e[t]=n)}return e===null?s:e}class Fb{static create(e,t,i){return Fb._normalizeArr(e,t,i)}constructor(e,t){this.expr=e,this.negated=t,this.type=6}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,i=this.expr.length;t<i;t++){const n=NL(this.expr[t],e.expr[t]);if(n!==0)return n}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){const e=che(this.expr);return e===this.expr?this:Fb.create(e,this.negated,!1)}evaluate(e){for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].evaluate(e))return!1;return!0}static _normalizeArr(e,t,i){const n=[];let r=!1;for(const o of e)if(o){if(o.type===1){r=!0;continue}if(o.type===0)return ko.INSTANCE;if(o.type===6){n.push(...o.expr);continue}n.push(o)}if(n.length===0&&r)return ia.INSTANCE;if(n.length!==0){if(n.length===1)return n[0];n.sort(NL);for(let o=1;o<n.length;o++)n[o-1].equals(n[o])&&(n.splice(o,1),o--);if(n.length===1)return n[0];for(;n.length>1;){const o=n[n.length-1];if(o.type!==9)break;n.pop();const a=n.pop(),l=n.length===0,c=Ff.create(o.expr.map(d=>Fb.create([d,a],null,i)),null,l);c&&(n.push(c),n.sort(NL))}if(n.length===1)return n[0];if(i){for(let o=0;o<n.length;o++)for(let a=o+1;a<n.length;a++)if(n[o].negate().equals(n[a]))return ko.INSTANCE;if(n.length===1)return n[0]}return new Fb(n,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" && ")}keys(){const e=[];for(const t of this.expr)e.push(...t.keys());return e}negate(){if(!this.negated){const e=[];for(const t of this.expr)e.push(t.negate());this.negated=Ff.create(e,this,!0)}return this.negated}}class Ff{static create(e,t,i){return Ff._normalizeArr(e,t,i)}constructor(e,t){this.expr=e,this.negated=t,this.type=9}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,i=this.expr.length;t<i;t++){const n=NL(this.expr[t],e.expr[t]);if(n!==0)return n}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){const e=che(this.expr);return e===this.expr?this:Ff.create(e,this.negated,!1)}evaluate(e){for(let t=0,i=this.expr.length;t<i;t++)if(this.expr[t].evaluate(e))return!0;return!1}static _normalizeArr(e,t,i){let n=[],r=!1;if(e){for(let o=0,a=e.length;o<a;o++){const l=e[o];if(l){if(l.type===0){r=!0;continue}if(l.type===1)return ia.INSTANCE;if(l.type===9){n=n.concat(l.expr);continue}n.push(l)}}if(n.length===0&&r)return ko.INSTANCE;n.sort(NL)}if(n.length!==0){if(n.length===1)return n[0];for(let o=1;o<n.length;o++)n[o-1].equals(n[o])&&(n.splice(o,1),o--);if(n.length===1)return n[0];if(i){for(let o=0;o<n.length;o++)for(let a=o+1;a<n.length;a++)if(n[o].negate().equals(n[a]))return ia.INSTANCE;if(n.length===1)return n[0]}return new Ff(n,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" || ")}keys(){const e=[];for(const t of this.expr)e.push(...t.keys());return e}negate(){if(!this.negated){const e=[];for(const t of this.expr)e.push(t.negate());for(;e.length>1;){const t=e.shift(),i=e.shift(),n=[];for(const r of pte(t))for(const o of pte(i))n.push(Fb.create([r,o],null,!1));e.unshift(Ff.create(n,null,!1))}this.negated=Ff.create(e,this,!0)}return this.negated}}const QC=class QC extends jw{static all(){return QC._info.values()}constructor(e,t,i){super(e,null),this._defaultValue=t,typeof i=="object"?QC._info.push({...i,key:e}):i!==!0&&QC._info.push({key:e,description:i,type:t!=null?typeof t:void 0})}bindTo(e){return e.createKey(this.key,this._defaultValue)}getValue(e){return e.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(e){return dS.create(this.key,e)}};QC._info=[];let Oe=QC;const ct=Ht("contextKeyService");function dhe(s,e){return s<e?-1:s>e?1:0}function qw(s,e,t,i){return s<t?-1:s>t?1:e<i?-1:e>i?1:0}function t6(s,e){if(s.type===0||e.type===1)return!0;if(s.type===9)return e.type===9?gte(s.expr,e.expr):!1;if(e.type===9){for(const t of e.expr)if(t6(s,t))return!0;return!1}if(s.type===6){if(e.type===6)return gte(e.expr,s.expr);for(const t of s.expr)if(t6(t,e))return!0;return!1}return s.equals(e)}function gte(s,e){let t=0,i=0;for(;t<s.length&&i<e.length;){const n=s[t].cmp(e[i]);if(n<0)return!1;n===0&&t++,i++}return t===s.length}function pte(s){return s.type===9?s.expr:[s]}function cV(s,e){if(!s)throw new Error(e?`Assertion failed (${e})`:"Assertion Failed")}function gF(s,e="Unreachable"){throw new Error(e)}function mte(s){s||ft(new di("Soft Assertion Failed"))}function fw(s){if(!s()){debugger;s(),ft(new di("Assertion Failed"))}}function $q(s,e){let t=0;for(;t<s.length-1;){const i=s[t],n=s[t+1];if(!e(i,n))return!1;t++}return!0}class PAe{constructor(){this.data=new Map}add(e,t){cV(Zo(e)),cV(Ms(t)),cV(!this.data.has(e),"There is already an extension with this id"),this.data.set(e,t)}as(e){return this.data.get(e)||null}}const _n=new PAe;class qq{constructor(){this._coreKeybindings=new _o,this._extensionKeybindings=[],this._cachedMergedKeybindings=null}static bindToCurrentPlatform(e){if(Da===1){if(e&&e.win)return e.win}else if(Da===2){if(e&&e.mac)return e.mac}else if(e&&e.linux)return e.linux;return e}registerKeybindingRule(e){const t=qq.bindToCurrentPlatform(e),i=new ce;if(t&&t.primary){const n=HW(t.primary,Da);n&&i.add(this._registerDefaultKeybinding(n,e.id,e.args,e.weight,0,e.when))}if(t&&Array.isArray(t.secondary))for(let n=0,r=t.secondary.length;n<r;n++){const o=t.secondary[n],a=HW(o,Da);a&&i.add(this._registerDefaultKeybinding(a,e.id,e.args,e.weight,-n-1,e.when))}return i}registerCommandAndKeybindingRule(e){return id(this.registerKeybindingRule(e),Gt.registerCommand(e))}_registerDefaultKeybinding(e,t,i,n,r,o){const a=this._coreKeybindings.push({keybinding:e,command:t,commandArgs:i,when:o,weight1:n,weight2:r,extensionId:null,isBuiltinExtension:!1});return this._cachedMergedKeybindings=null,Ye(()=>{a(),this._cachedMergedKeybindings=null})}getDefaultKeybindings(){return this._cachedMergedKeybindings||(this._cachedMergedKeybindings=Array.from(this._coreKeybindings).concat(this._extensionKeybindings),this._cachedMergedKeybindings.sort(OAe)),this._cachedMergedKeybindings.slice(0)}}const Io=new qq,MAe={EditorModes:"platform.keybindingsRegistry"};_n.add(MAe.EditorModes,Io);function OAe(s,e){if(s.weight1!==e.weight1)return s.weight1-e.weight1;if(s.command&&e.command){if(s.command<e.command)return-1;if(s.command>e.command)return 1}return s.weight2-e.weight2}var FAe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},_te=function(s,e){return function(t,i){e(t,i,s)}},SR;function my(s){return s.command!==void 0}function VAe(s){return s.submenu!==void 0}const q=class q{constructor(e){if(q._instances.has(e))throw new TypeError(`MenuId with identifier '${e}' already exists. Use MenuId.for(ident) or a unique identifier`);q._instances.set(e,this),this.id=e}};q._instances=new Map,q.CommandPalette=new q("CommandPalette"),q.DebugBreakpointsContext=new q("DebugBreakpointsContext"),q.DebugCallStackContext=new q("DebugCallStackContext"),q.DebugConsoleContext=new q("DebugConsoleContext"),q.DebugVariablesContext=new q("DebugVariablesContext"),q.NotebookVariablesContext=new q("NotebookVariablesContext"),q.DebugHoverContext=new q("DebugHoverContext"),q.DebugWatchContext=new q("DebugWatchContext"),q.DebugToolBar=new q("DebugToolBar"),q.DebugToolBarStop=new q("DebugToolBarStop"),q.DebugCallStackToolbar=new q("DebugCallStackToolbar"),q.DebugCreateConfiguration=new q("DebugCreateConfiguration"),q.EditorContext=new q("EditorContext"),q.SimpleEditorContext=new q("SimpleEditorContext"),q.EditorContent=new q("EditorContent"),q.EditorLineNumberContext=new q("EditorLineNumberContext"),q.EditorContextCopy=new q("EditorContextCopy"),q.EditorContextPeek=new q("EditorContextPeek"),q.EditorContextShare=new q("EditorContextShare"),q.EditorTitle=new q("EditorTitle"),q.EditorTitleRun=new q("EditorTitleRun"),q.EditorTitleContext=new q("EditorTitleContext"),q.EditorTitleContextShare=new q("EditorTitleContextShare"),q.EmptyEditorGroup=new q("EmptyEditorGroup"),q.EmptyEditorGroupContext=new q("EmptyEditorGroupContext"),q.EditorTabsBarContext=new q("EditorTabsBarContext"),q.EditorTabsBarShowTabsSubmenu=new q("EditorTabsBarShowTabsSubmenu"),q.EditorTabsBarShowTabsZenModeSubmenu=new q("EditorTabsBarShowTabsZenModeSubmenu"),q.EditorActionsPositionSubmenu=new q("EditorActionsPositionSubmenu"),q.ExplorerContext=new q("ExplorerContext"),q.ExplorerContextShare=new q("ExplorerContextShare"),q.ExtensionContext=new q("ExtensionContext"),q.GlobalActivity=new q("GlobalActivity"),q.CommandCenter=new q("CommandCenter"),q.CommandCenterCenter=new q("CommandCenterCenter"),q.LayoutControlMenuSubmenu=new q("LayoutControlMenuSubmenu"),q.LayoutControlMenu=new q("LayoutControlMenu"),q.MenubarMainMenu=new q("MenubarMainMenu"),q.MenubarAppearanceMenu=new q("MenubarAppearanceMenu"),q.MenubarDebugMenu=new q("MenubarDebugMenu"),q.MenubarEditMenu=new q("MenubarEditMenu"),q.MenubarCopy=new q("MenubarCopy"),q.MenubarFileMenu=new q("MenubarFileMenu"),q.MenubarGoMenu=new q("MenubarGoMenu"),q.MenubarHelpMenu=new q("MenubarHelpMenu"),q.MenubarLayoutMenu=new q("MenubarLayoutMenu"),q.MenubarNewBreakpointMenu=new q("MenubarNewBreakpointMenu"),q.PanelAlignmentMenu=new q("PanelAlignmentMenu"),q.PanelPositionMenu=new q("PanelPositionMenu"),q.ActivityBarPositionMenu=new q("ActivityBarPositionMenu"),q.MenubarPreferencesMenu=new q("MenubarPreferencesMenu"),q.MenubarRecentMenu=new q("MenubarRecentMenu"),q.MenubarSelectionMenu=new q("MenubarSelectionMenu"),q.MenubarShare=new q("MenubarShare"),q.MenubarSwitchEditorMenu=new q("MenubarSwitchEditorMenu"),q.MenubarSwitchGroupMenu=new q("MenubarSwitchGroupMenu"),q.MenubarTerminalMenu=new q("MenubarTerminalMenu"),q.MenubarViewMenu=new q("MenubarViewMenu"),q.MenubarHomeMenu=new q("MenubarHomeMenu"),q.OpenEditorsContext=new q("OpenEditorsContext"),q.OpenEditorsContextShare=new q("OpenEditorsContextShare"),q.ProblemsPanelContext=new q("ProblemsPanelContext"),q.SCMInputBox=new q("SCMInputBox"),q.SCMChangesSeparator=new q("SCMChangesSeparator"),q.SCMChangesContext=new q("SCMChangesContext"),q.SCMIncomingChanges=new q("SCMIncomingChanges"),q.SCMIncomingChangesContext=new q("SCMIncomingChangesContext"),q.SCMIncomingChangesSetting=new q("SCMIncomingChangesSetting"),q.SCMOutgoingChanges=new q("SCMOutgoingChanges"),q.SCMOutgoingChangesContext=new q("SCMOutgoingChangesContext"),q.SCMOutgoingChangesSetting=new q("SCMOutgoingChangesSetting"),q.SCMIncomingChangesAllChangesContext=new q("SCMIncomingChangesAllChangesContext"),q.SCMIncomingChangesHistoryItemContext=new q("SCMIncomingChangesHistoryItemContext"),q.SCMOutgoingChangesAllChangesContext=new q("SCMOutgoingChangesAllChangesContext"),q.SCMOutgoingChangesHistoryItemContext=new q("SCMOutgoingChangesHistoryItemContext"),q.SCMChangeContext=new q("SCMChangeContext"),q.SCMResourceContext=new q("SCMResourceContext"),q.SCMResourceContextShare=new q("SCMResourceContextShare"),q.SCMResourceFolderContext=new q("SCMResourceFolderContext"),q.SCMResourceGroupContext=new q("SCMResourceGroupContext"),q.SCMSourceControl=new q("SCMSourceControl"),q.SCMSourceControlInline=new q("SCMSourceControlInline"),q.SCMSourceControlTitle=new q("SCMSourceControlTitle"),q.SCMHistoryTitle=new q("SCMHistoryTitle"),q.SCMTitle=new q("SCMTitle"),q.SearchContext=new q("SearchContext"),q.SearchActionMenu=new q("SearchActionContext"),q.StatusBarWindowIndicatorMenu=new q("StatusBarWindowIndicatorMenu"),q.StatusBarRemoteIndicatorMenu=new q("StatusBarRemoteIndicatorMenu"),q.StickyScrollContext=new q("StickyScrollContext"),q.TestItem=new q("TestItem"),q.TestItemGutter=new q("TestItemGutter"),q.TestProfilesContext=new q("TestProfilesContext"),q.TestMessageContext=new q("TestMessageContext"),q.TestMessageContent=new q("TestMessageContent"),q.TestPeekElement=new q("TestPeekElement"),q.TestPeekTitle=new q("TestPeekTitle"),q.TestCallStack=new q("TestCallStack"),q.TouchBarContext=new q("TouchBarContext"),q.TitleBarContext=new q("TitleBarContext"),q.TitleBarTitleContext=new q("TitleBarTitleContext"),q.TunnelContext=new q("TunnelContext"),q.TunnelPrivacy=new q("TunnelPrivacy"),q.TunnelProtocol=new q("TunnelProtocol"),q.TunnelPortInline=new q("TunnelInline"),q.TunnelTitle=new q("TunnelTitle"),q.TunnelLocalAddressInline=new q("TunnelLocalAddressInline"),q.TunnelOriginInline=new q("TunnelOriginInline"),q.ViewItemContext=new q("ViewItemContext"),q.ViewContainerTitle=new q("ViewContainerTitle"),q.ViewContainerTitleContext=new q("ViewContainerTitleContext"),q.ViewTitle=new q("ViewTitle"),q.ViewTitleContext=new q("ViewTitleContext"),q.CommentEditorActions=new q("CommentEditorActions"),q.CommentThreadTitle=new q("CommentThreadTitle"),q.CommentThreadActions=new q("CommentThreadActions"),q.CommentThreadAdditionalActions=new q("CommentThreadAdditionalActions"),q.CommentThreadTitleContext=new q("CommentThreadTitleContext"),q.CommentThreadCommentContext=new q("CommentThreadCommentContext"),q.CommentTitle=new q("CommentTitle"),q.CommentActions=new q("CommentActions"),q.CommentsViewThreadActions=new q("CommentsViewThreadActions"),q.InteractiveToolbar=new q("InteractiveToolbar"),q.InteractiveCellTitle=new q("InteractiveCellTitle"),q.InteractiveCellDelete=new q("InteractiveCellDelete"),q.InteractiveCellExecute=new q("InteractiveCellExecute"),q.InteractiveInputExecute=new q("InteractiveInputExecute"),q.InteractiveInputConfig=new q("InteractiveInputConfig"),q.ReplInputExecute=new q("ReplInputExecute"),q.IssueReporter=new q("IssueReporter"),q.NotebookToolbar=new q("NotebookToolbar"),q.NotebookStickyScrollContext=new q("NotebookStickyScrollContext"),q.NotebookCellTitle=new q("NotebookCellTitle"),q.NotebookCellDelete=new q("NotebookCellDelete"),q.NotebookCellInsert=new q("NotebookCellInsert"),q.NotebookCellBetween=new q("NotebookCellBetween"),q.NotebookCellListTop=new q("NotebookCellTop"),q.NotebookCellExecute=new q("NotebookCellExecute"),q.NotebookCellExecuteGoTo=new q("NotebookCellExecuteGoTo"),q.NotebookCellExecutePrimary=new q("NotebookCellExecutePrimary"),q.NotebookDiffCellInputTitle=new q("NotebookDiffCellInputTitle"),q.NotebookDiffCellMetadataTitle=new q("NotebookDiffCellMetadataTitle"),q.NotebookDiffCellOutputsTitle=new q("NotebookDiffCellOutputsTitle"),q.NotebookOutputToolbar=new q("NotebookOutputToolbar"),q.NotebookOutlineFilter=new q("NotebookOutlineFilter"),q.NotebookOutlineActionMenu=new q("NotebookOutlineActionMenu"),q.NotebookEditorLayoutConfigure=new q("NotebookEditorLayoutConfigure"),q.NotebookKernelSource=new q("NotebookKernelSource"),q.BulkEditTitle=new q("BulkEditTitle"),q.BulkEditContext=new q("BulkEditContext"),q.TimelineItemContext=new q("TimelineItemContext"),q.TimelineTitle=new q("TimelineTitle"),q.TimelineTitleContext=new q("TimelineTitleContext"),q.TimelineFilterSubMenu=new q("TimelineFilterSubMenu"),q.AccountsContext=new q("AccountsContext"),q.SidebarTitle=new q("SidebarTitle"),q.PanelTitle=new q("PanelTitle"),q.AuxiliaryBarTitle=new q("AuxiliaryBarTitle"),q.AuxiliaryBarHeader=new q("AuxiliaryBarHeader"),q.TerminalInstanceContext=new q("TerminalInstanceContext"),q.TerminalEditorInstanceContext=new q("TerminalEditorInstanceContext"),q.TerminalNewDropdownContext=new q("TerminalNewDropdownContext"),q.TerminalTabContext=new q("TerminalTabContext"),q.TerminalTabEmptyAreaContext=new q("TerminalTabEmptyAreaContext"),q.TerminalStickyScrollContext=new q("TerminalStickyScrollContext"),q.WebviewContext=new q("WebviewContext"),q.InlineCompletionsActions=new q("InlineCompletionsActions"),q.InlineEditsActions=new q("InlineEditsActions"),q.InlineEditActions=new q("InlineEditActions"),q.NewFile=new q("NewFile"),q.MergeInput1Toolbar=new q("MergeToolbar1Toolbar"),q.MergeInput2Toolbar=new q("MergeToolbar2Toolbar"),q.MergeBaseToolbar=new q("MergeBaseToolbar"),q.MergeInputResultToolbar=new q("MergeToolbarResultToolbar"),q.InlineSuggestionToolbar=new q("InlineSuggestionToolbar"),q.InlineEditToolbar=new q("InlineEditToolbar"),q.ChatContext=new q("ChatContext"),q.ChatCodeBlock=new q("ChatCodeblock"),q.ChatCompareBlock=new q("ChatCompareBlock"),q.ChatMessageTitle=new q("ChatMessageTitle"),q.ChatExecute=new q("ChatExecute"),q.ChatExecuteSecondary=new q("ChatExecuteSecondary"),q.ChatInputSide=new q("ChatInputSide"),q.AccessibleView=new q("AccessibleView"),q.MultiDiffEditorFileToolbar=new q("MultiDiffEditorFileToolbar"),q.DiffEditorHunkToolbar=new q("DiffEditorHunkToolbar"),q.DiffEditorSelectionToolbar=new q("DiffEditorSelectionToolbar");let ze=q;const Ol=Ht("menuService"),_k=class _k{static for(e){let t=this._all.get(e);return t||(t=new _k(e),this._all.set(e,t)),t}static merge(e){const t=new Set;for(const i of e)i instanceof _k&&t.add(i.id);return t}constructor(e){this.id=e,this.has=t=>t===e}};_k._all=new Map;let pb=_k;const Os=new class{constructor(){this._commands=new Map,this._menuItems=new Map,this._onDidChangeMenu=new eRe({merge:pb.merge}),this.onDidChangeMenu=this._onDidChangeMenu.event}addCommand(s){return this._commands.set(s.id,s),this._onDidChangeMenu.fire(pb.for(ze.CommandPalette)),Ye(()=>{this._commands.delete(s.id)&&this._onDidChangeMenu.fire(pb.for(ze.CommandPalette))})}getCommand(s){return this._commands.get(s)}getCommands(){const s=new Map;return this._commands.forEach((e,t)=>s.set(t,e)),s}appendMenuItem(s,e){let t=this._menuItems.get(s);t||(t=new _o,this._menuItems.set(s,t));const i=t.push(e);return this._onDidChangeMenu.fire(pb.for(s)),Ye(()=>{i(),this._onDidChangeMenu.fire(pb.for(s))})}appendMenuItems(s){const e=new ce;for(const{id:t,item:i}of s)e.add(this.appendMenuItem(t,i));return e}getMenuItems(s){let e;return this._menuItems.has(s)?e=[...this._menuItems.get(s)]:e=[],s===ze.CommandPalette&&this._appendImplicitItems(e),e}_appendImplicitItems(s){const e=new Set;for(const t of s)my(t)&&(e.add(t.command.id),t.alt&&e.add(t.alt.id));this._commands.forEach((t,i)=>{e.has(i)||s.push({command:t})})}};class _y extends f1{constructor(e,t,i){super(`submenuitem.${e.submenu.id}`,typeof e.title=="string"?e.title:e.title.value,i,"submenu"),this.item=e,this.hideActions=t}}let Ra=SR=class{static label(e,t){return t!=null&&t.renderShortTitle&&e.shortTitle?typeof e.shortTitle=="string"?e.shortTitle:e.shortTitle.value:typeof e.title=="string"?e.title:e.title.value}constructor(e,t,i,n,r,o,a){var c;this.hideActions=n,this.menuKeybinding=r,this._commandService=a,this.id=e.id,this.label=SR.label(e,i),this.tooltip=(typeof e.tooltip=="string"?e.tooltip:(c=e.tooltip)==null?void 0:c.value)??"",this.enabled=!e.precondition||o.contextMatchesRules(e.precondition),this.checked=void 0;let l;if(e.toggled){const d=e.toggled.condition?e.toggled:{condition:e.toggled};this.checked=o.contextMatchesRules(d.condition),this.checked&&d.tooltip&&(this.tooltip=typeof d.tooltip=="string"?d.tooltip:d.tooltip.value),this.checked&&at.isThemeIcon(d.icon)&&(l=d.icon),this.checked&&d.title&&(this.label=typeof d.title=="string"?d.title:d.title.value)}l||(l=at.isThemeIcon(e.icon)?e.icon:void 0),this.item=e,this.alt=t?new SR(t,void 0,i,n,void 0,o,a):void 0,this._options=i,this.class=l&&at.asClassName(l)}run(...e){var i,n;let t=[];return(i=this._options)!=null&&i.arg&&(t=[...t,this._options.arg]),(n=this._options)!=null&&n.shouldForwardArgs&&(t=[...t,...e]),this._commandService.executeCommand(this.id,...t)}};Ra=SR=FAe([_te(5,ct),_te(6,Hi)],Ra);class To{constructor(e){this.desc=e}}function Oi(s){const e=[],t=new s,{f1:i,menu:n,keybinding:r,...o}=t.desc;if(Gt.getCommand(o.id))throw new Error(`Cannot register two commands with the same id: ${o.id}`);if(e.push(Gt.registerCommand({id:o.id,handler:(a,...l)=>t.run(a,...l),metadata:o.metadata})),Array.isArray(n))for(const a of n)e.push(Os.appendMenuItem(a.id,{command:{...o,precondition:a.precondition===null?void 0:o.precondition},...a}));else n&&e.push(Os.appendMenuItem(n.id,{command:{...o,precondition:n.precondition===null?void 0:o.precondition},...n}));if(i&&(e.push(Os.appendMenuItem(ze.CommandPalette,{command:o,when:o.precondition})),e.push(Os.addCommand(o))),Array.isArray(r))for(const a of r)e.push(Io.registerKeybindingRule({...a,id:o.id,when:o.precondition?he.and(o.precondition,a.when):a.when}));else r&&e.push(Io.registerKeybindingRule({...r,id:o.id,when:o.precondition?he.and(o.precondition,r.when):r.when}));return{dispose(){Ni(e)}}}const Tr=Ht("telemetryService"),pr=Ht("logService");var Ko;(function(s){s[s.Off=0]="Off",s[s.Trace=1]="Trace",s[s.Debug=2]="Debug",s[s.Info=3]="Info",s[s.Warning=4]="Warning",s[s.Error=5]="Error"})(Ko||(Ko={}));const uhe=Ko.Info;class hhe extends te{constructor(){super(...arguments),this.level=uhe,this._onDidChangeLogLevel=this._register(new Z),this.onDidChangeLogLevel=this._onDidChangeLogLevel.event}setLevel(e){this.level!==e&&(this.level=e,this._onDidChangeLogLevel.fire(this.level))}getLevel(){return this.level}checkLogLevel(e){return this.level!==Ko.Off&&this.level<=e}}class BAe extends hhe{constructor(e=uhe,t=!0){super(),this.useColors=t,this.setLevel(e)}trace(e,...t){this.checkLogLevel(Ko.Trace)&&(this.useColors?console.log("%cTRACE","color: #888",e,...t):console.log(e,...t))}debug(e,...t){this.checkLogLevel(Ko.Debug)&&(this.useColors?console.log("%cDEBUG","background: #eee; color: #888",e,...t):console.log(e,...t))}info(e,...t){this.checkLogLevel(Ko.Info)&&(this.useColors?console.log("%c INFO","color: #33f",e,...t):console.log(e,...t))}warn(e,...t){this.checkLogLevel(Ko.Warning)&&(this.useColors?console.log("%c WARN","color: #993",e,...t):console.log(e,...t))}error(e,...t){this.checkLogLevel(Ko.Error)&&(this.useColors?console.log("%c  ERR","color: #f33",e,...t):console.error(e,...t))}}class WAe extends hhe{constructor(e){super(),this.loggers=e,e.length&&this.setLevel(e[0].getLevel())}setLevel(e){for(const t of this.loggers)t.setLevel(e);super.setLevel(e)}trace(e,...t){for(const i of this.loggers)i.trace(e,...t)}debug(e,...t){for(const i of this.loggers)i.debug(e,...t)}info(e,...t){for(const i of this.loggers)i.info(e,...t)}warn(e,...t){for(const i of this.loggers)i.warn(e,...t)}error(e,...t){for(const i of this.loggers)i.error(e,...t)}dispose(){for(const e of this.loggers)e.dispose();super.dispose()}}function HAe(s){switch(s){case Ko.Trace:return"trace";case Ko.Debug:return"debug";case Ko.Info:return"info";case Ko.Warning:return"warn";case Ko.Error:return"error";case Ko.Off:return"off"}}new Oe("logLevel",HAe(Ko.Info));class pF{constructor(e){this.id=e.id,this.precondition=e.precondition,this._kbOpts=e.kbOpts,this._menuOpts=e.menuOpts,this.metadata=e.metadata}register(){if(Array.isArray(this._menuOpts)?this._menuOpts.forEach(this._registerMenuItem,this):this._menuOpts&&this._registerMenuItem(this._menuOpts),this._kbOpts){const e=Array.isArray(this._kbOpts)?this._kbOpts:[this._kbOpts];for(const t of e){let i=t.kbExpr;this.precondition&&(i?i=he.and(i,this.precondition):i=this.precondition);const n={id:this.id,weight:t.weight,args:t.args,when:i,primary:t.primary,secondary:t.secondary,win:t.win,linux:t.linux,mac:t.mac};Io.registerKeybindingRule(n)}}Gt.registerCommand({id:this.id,handler:(e,t)=>this.runCommand(e,t),metadata:this.metadata})}_registerMenuItem(e){Os.appendMenuItem(e.menuId,{group:e.group,command:{id:this.id,title:e.title,icon:e.icon,precondition:this.precondition},when:e.when,order:e.order})}}class uS extends pF{constructor(){super(...arguments),this._implementations=[]}addImplementation(e,t,i,n){return this._implementations.push({priority:e,name:t,implementation:i,when:n}),this._implementations.sort((r,o)=>o.priority-r.priority),{dispose:()=>{for(let r=0;r<this._implementations.length;r++)if(this._implementations[r].implementation===i){this._implementations.splice(r,1);return}}}}runCommand(e,t){const i=e.get(pr),n=e.get(ct);i.trace(`Executing Command '${this.id}' which has ${this._implementations.length} bound.`);for(const r of this._implementations){if(r.when){const a=n.getContext(hr());if(!r.when.evaluate(a))continue}const o=r.implementation(e,t);if(o)return i.trace(`Command '${this.id}' was handled by '${r.name}'.`),typeof o=="boolean"?void 0:o}i.trace(`The Command '${this.id}' was not handled by any implementation.`)}}class fhe extends pF{constructor(e,t){super(t),this.command=e}runCommand(e,t){return this.command.runCommand(e,t)}}class fs extends pF{static bindToContribution(e){return class extends fs{constructor(i){super(i),this._callback=i.handler}runEditorCommand(i,n,r){const o=e(n);o&&this._callback(o,r)}}}static runEditorCommand(e,t,i,n){const r=e.get(ni),o=r.getFocusedCodeEditor()||r.getActiveCodeEditor();if(o)return o.invokeWithinContext(a=>{if(a.get(ct).contextMatchesRules(i??void 0))return n(a,o,t)})}runCommand(e,t){return fs.runEditorCommand(e,t,this.precondition,(i,n,r)=>this.runEditorCommand(i,n,r))}}class Ve extends fs{static convertOptions(e){let t;Array.isArray(e.menuOpts)?t=e.menuOpts:e.menuOpts?t=[e.menuOpts]:t=[];function i(n){return n.menuId||(n.menuId=ze.EditorContext),n.title||(n.title=e.label),n.when=he.and(e.precondition,n.when),n}return Array.isArray(e.contextMenuOpts)?t.push(...e.contextMenuOpts.map(i)):e.contextMenuOpts&&t.push(i(e.contextMenuOpts)),e.menuOpts=t,e}constructor(e){super(Ve.convertOptions(e)),this.label=e.label,this.alias=e.alias}runEditorCommand(e,t,i){return this.reportTelemetry(e,t),this.run(e,t,i||{})}reportTelemetry(e,t){e.get(Tr).publicLog2("editorActionInvoked",{name:this.label,id:this.id})}}class ghe extends Ve{constructor(){super(...arguments),this._implementations=[]}addImplementation(e,t){return this._implementations.push([e,t]),this._implementations.sort((i,n)=>n[0]-i[0]),{dispose:()=>{for(let i=0;i<this._implementations.length;i++)if(this._implementations[i][1]===t){this._implementations.splice(i,1);return}}}}run(e,t,i){for(const n of this._implementations){const r=n[1](e,t,i);if(r)return typeof r=="boolean"?void 0:r}}}class vu extends To{run(e,...t){const i=e.get(ni),n=i.getFocusedCodeEditor()||i.getActiveCodeEditor();if(n)return n.invokeWithinContext(r=>{var c;const o=r.get(ct),a=r.get(pr);if(!o.contextMatchesRules(this.desc.precondition??void 0)){a.debug("[EditorAction2] NOT running command because its precondition is FALSE",this.desc.id,(c=this.desc.precondition)==null?void 0:c.serialize());return}return this.runEditorCommand(r,n,...t)})}}function aa(s,e){Gt.registerCommand(s,function(t,...i){const n=t.get(Xe),[r,o]=i;ii(Je.isUri(r)),ii(X.isIPosition(o));const a=t.get(Gi).getModel(r);if(a){const l=X.lift(o);return n.invokeFunction(e,a,l,...i.slice(2))}return t.get(oa).createModelReference(r).then(l=>new Promise((c,d)=>{try{const u=n.invokeFunction(e,l.object.textEditorModel,X.lift(o),i.slice(2));c(u)}catch(u){d(u)}}).finally(()=>{l.dispose()}))})}function Me(s){return ac.INSTANCE.registerEditorCommand(s),s}function ye(s){const e=new s;return ac.INSTANCE.registerEditorAction(e),e}function phe(s){return ac.INSTANCE.registerEditorAction(s),s}function zAe(s){ac.INSTANCE.registerEditorAction(s)}function Zt(s,e,t){ac.INSTANCE.registerEditorContribution(s,e,t)}var Xb;(function(s){function e(o){return ac.INSTANCE.getEditorCommand(o)}s.getEditorCommand=e;function t(){return ac.INSTANCE.getEditorActions()}s.getEditorActions=t;function i(){return ac.INSTANCE.getEditorContributions()}s.getEditorContributions=i;function n(o){return ac.INSTANCE.getEditorContributions().filter(a=>o.indexOf(a.id)>=0)}s.getSomeEditorContributions=n;function r(){return ac.INSTANCE.getDiffEditorContributions()}s.getDiffEditorContributions=r})(Xb||(Xb={}));const UAe={EditorCommonContributions:"editor.contributions"},OM=class OM{constructor(){this.editorContributions=[],this.diffEditorContributions=[],this.editorActions=[],this.editorCommands=Object.create(null)}registerEditorContribution(e,t,i){this.editorContributions.push({id:e,ctor:t,instantiation:i})}getEditorContributions(){return this.editorContributions.slice(0)}getDiffEditorContributions(){return this.diffEditorContributions.slice(0)}registerEditorAction(e){e.register(),this.editorActions.push(e)}getEditorActions(){return this.editorActions}registerEditorCommand(e){e.register(),this.editorCommands[e.id]=e}getEditorCommand(e){return this.editorCommands[e]||null}};OM.INSTANCE=new OM;let ac=OM;_n.add(UAe.EditorCommonContributions,ac.INSTANCE);function $E(s){return s.register(),s}const mhe=$E(new uS({id:"undo",precondition:void 0,kbOpts:{weight:0,primary:2104},menuOpts:[{menuId:ze.MenubarEditMenu,group:"1_do",title:b({key:"miUndo",comment:["&& denotes a mnemonic"]},"&&Undo"),order:1},{menuId:ze.CommandPalette,group:"",title:b("undo","Undo"),order:1}]}));$E(new fhe(mhe,{id:"default:undo",precondition:void 0}));const _he=$E(new uS({id:"redo",precondition:void 0,kbOpts:{weight:0,primary:2103,secondary:[3128],mac:{primary:3128}},menuOpts:[{menuId:ze.MenubarEditMenu,group:"1_do",title:b({key:"miRedo",comment:["&& denotes a mnemonic"]},"&&Redo"),order:2},{menuId:ze.CommandPalette,group:"",title:b("redo","Redo"),order:1}]}));$E(new fhe(_he,{id:"default:redo",precondition:void 0}));const jAe=$E(new uS({id:"editor.action.selectAll",precondition:void 0,kbOpts:{weight:0,kbExpr:null,primary:2079},menuOpts:[{menuId:ze.MenubarSelectionMenu,group:"1_basic",title:b({key:"miSelectAll",comment:["&& denotes a mnemonic"]},"&&Select All"),order:1},{menuId:ze.CommandPalette,group:"",title:b("selectAll","Select All"),order:1}]})),$Ae="modulepreload",qAe=function(s){return"/"+s},bte={},et=function(e,t,i){let n=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));n=Promise.allSettled(t.map(l=>{if(l=qAe(l),l in bte)return;bte[l]=!0;const c=l.endsWith(".css"),d=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const u=document.createElement("link");if(u.rel=c?"stylesheet":$Ae,c||(u.as="script"),u.crossOrigin="",u.href=l,a&&u.setAttribute("nonce",a),document.head.appendChild(u),c)return new Promise((h,g)=>{u.addEventListener("load",h),u.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${l}`)))})}))}function r(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return n.then(o=>{for(const a of o||[])a.status==="rejected"&&r(a.reason);return e().catch(r)})},vte="default",KAe="$initialize";let wte=!1;function i6(s){Uw&&(wte||(wte=!0,console.warn("Could not create web worker(s). Falling back to loading web worker code in main thread, which might cause UI freezes. Please see https://github.com/microsoft/monaco-editor#faq")),console.warn(s.message))}class GAe{constructor(e,t,i,n,r){this.vsWorker=e,this.req=t,this.channel=i,this.method=n,this.args=r,this.type=0}}class Cte{constructor(e,t,i,n){this.vsWorker=e,this.seq=t,this.res=i,this.err=n,this.type=1}}class QAe{constructor(e,t,i,n,r){this.vsWorker=e,this.req=t,this.channel=i,this.eventName=n,this.arg=r,this.type=2}}class YAe{constructor(e,t,i){this.vsWorker=e,this.req=t,this.event=i,this.type=3}}class XAe{constructor(e,t){this.vsWorker=e,this.req=t,this.type=4}}class ZAe{constructor(e){this._workerId=-1,this._handler=e,this._lastSentReq=0,this._pendingReplies=Object.create(null),this._pendingEmitters=new Map,this._pendingEvents=new Map}setWorkerId(e){this._workerId=e}sendMessage(e,t,i){const n=String(++this._lastSentReq);return new Promise((r,o)=>{this._pendingReplies[n]={resolve:r,reject:o},this._send(new GAe(this._workerId,n,e,t,i))})}listen(e,t,i){let n=null;const r=new Z({onWillAddFirstListener:()=>{n=String(++this._lastSentReq),this._pendingEmitters.set(n,r),this._send(new QAe(this._workerId,n,e,t,i))},onDidRemoveLastListener:()=>{this._pendingEmitters.delete(n),this._send(new XAe(this._workerId,n)),n=null}});return r.event}handleMessage(e){!e||!e.vsWorker||this._workerId!==-1&&e.vsWorker!==this._workerId||this._handleMessage(e)}createProxyToRemoteChannel(e,t){const i={get:(n,r)=>(typeof r=="string"&&!n[r]&&(vhe(r)?n[r]=o=>this.listen(e,r,o):bhe(r)?n[r]=this.listen(e,r,void 0):r.charCodeAt(0)===36&&(n[r]=async(...o)=>(await(t==null?void 0:t()),this.sendMessage(e,r,o)))),n[r])};return new Proxy(Object.create(null),i)}_handleMessage(e){switch(e.type){case 1:return this._handleReplyMessage(e);case 0:return this._handleRequestMessage(e);case 2:return this._handleSubscribeEventMessage(e);case 3:return this._handleEventMessage(e);case 4:return this._handleUnsubscribeEventMessage(e)}}_handleReplyMessage(e){if(!this._pendingReplies[e.seq]){console.warn("Got reply to unknown seq");return}const t=this._pendingReplies[e.seq];if(delete this._pendingReplies[e.seq],e.err){let i=e.err;e.err.$isError&&(i=new Error,i.name=e.err.name,i.message=e.err.message,i.stack=e.err.stack),t.reject(i);return}t.resolve(e.res)}_handleRequestMessage(e){const t=e.req;this._handler.handleMessage(e.channel,e.method,e.args).then(n=>{this._send(new Cte(this._workerId,t,n,void 0))},n=>{n.detail instanceof Error&&(n.detail=qee(n.detail)),this._send(new Cte(this._workerId,t,void 0,qee(n)))})}_handleSubscribeEventMessage(e){const t=e.req,i=this._handler.handleEvent(e.channel,e.eventName,e.arg)(n=>{this._send(new YAe(this._workerId,t,n))});this._pendingEvents.set(t,i)}_handleEventMessage(e){if(!this._pendingEmitters.has(e.req)){console.warn("Got event for unknown req");return}this._pendingEmitters.get(e.req).fire(e.event)}_handleUnsubscribeEventMessage(e){if(!this._pendingEvents.has(e.req)){console.warn("Got unsubscribe for unknown req");return}this._pendingEvents.get(e.req).dispose(),this._pendingEvents.delete(e.req)}_send(e){const t=[];if(e.type===0)for(let i=0;i<e.args.length;i++)e.args[i]instanceof ArrayBuffer&&t.push(e.args[i]);else e.type===1&&e.res instanceof ArrayBuffer&&t.push(e.res);this._handler.sendMessage(e,t)}}class JAe extends te{constructor(e,t){super(),this._localChannels=new Map,this._worker=this._register(e.create({amdModuleId:"vs/base/common/worker/simpleWorker",esmModuleLocation:t.esmModuleLocation,label:t.label},r=>{this._protocol.handleMessage(r)},r=>{ft(r)})),this._protocol=new ZAe({sendMessage:(r,o)=>{this._worker.postMessage(r,o)},handleMessage:(r,o,a)=>this._handleMessage(r,o,a),handleEvent:(r,o,a)=>this._handleEvent(r,o,a)}),this._protocol.setWorkerId(this._worker.getId());let i=null;const n=globalThis.require;typeof n<"u"&&typeof n.getConfig=="function"?i=n.getConfig():typeof globalThis.requirejs<"u"&&(i=globalThis.requirejs.s.contexts._.config),this._onModuleLoaded=this._protocol.sendMessage(vte,KAe,[this._worker.getId(),JSON.parse(JSON.stringify(i)),t.amdModuleId]),this.proxy=this._protocol.createProxyToRemoteChannel(vte,async()=>{await this._onModuleLoaded}),this._onModuleLoaded.catch(r=>{this._onError("Worker failed to load "+t.amdModuleId,r)})}_handleMessage(e,t,i){const n=this._localChannels.get(e);if(!n)return Promise.reject(new Error(`Missing channel ${e} on main thread`));if(typeof n[t]!="function")return Promise.reject(new Error(`Missing method ${t} on main thread channel ${e}`));try{return Promise.resolve(n[t].apply(n,i))}catch(r){return Promise.reject(r)}}_handleEvent(e,t,i){const n=this._localChannels.get(e);if(!n)throw new Error(`Missing channel ${e} on main thread`);if(vhe(t)){const r=n[t].call(n,i);if(typeof r!="function")throw new Error(`Missing dynamic event ${t} on main thread channel ${e}.`);return r}if(bhe(t)){const r=n[t];if(typeof r!="function")throw new Error(`Missing event ${t} on main thread channel ${e}.`);return r}throw new Error(`Malformed event name ${t}`)}setChannel(e,t){this._localChannels.set(e,t)}_onError(e,t){console.error(e),console.info(t)}}function bhe(s){return s[0]==="o"&&s[1]==="n"&&sh(s.charCodeAt(2))}function vhe(s){return/^onDynamic/.test(s)&&sh(s.charCodeAt(9))}function Og(s,e){var i;const t=globalThis.MonacoEnvironment;if(t!=null&&t.createTrustedTypesPolicy)try{return t.createTrustedTypesPolicy(s,e)}catch(n){ft(n);return}try{return(i=globalThis.trustedTypes)==null?void 0:i.createPolicy(s,e)}catch(n){ft(n);return}}let xC;typeof self=="object"&&self.constructor&&self.constructor.name==="DedicatedWorkerGlobalScope"&&globalThis.workerttPolicy!==void 0?xC=globalThis.workerttPolicy:xC=Og("defaultWorkerFactory",{createScriptURL:s=>s});function ePe(s,e){const t=globalThis.MonacoEnvironment;if(t){if(typeof t.getWorker=="function")return t.getWorker("workerMain.js",e);if(typeof t.getWorkerUrl=="function"){const i=t.getWorkerUrl("workerMain.js",e);return new Worker(xC?xC.createScriptURL(i):i,{name:e,type:"module"})}}if(s){const i=tPe(e,s.toString(!0)),n=new Worker(xC?xC.createScriptURL(i):i,{name:e,type:"module"});return iPe(n)}throw new Error("You must define a function MonacoEnvironment.getWorkerUrl or MonacoEnvironment.getWorker")}function tPe(s,e,t){if(!(/^((http:)|(https:)|(file:)|(vscode-file:))/.test(e)&&e.substring(0,globalThis.origin.length)!==globalThis.origin)){const r=e.lastIndexOf("?"),o=e.lastIndexOf("#",r),a=r>0?new URLSearchParams(e.substring(r+1,~o?o:void 0)):new URLSearchParams;GW.addSearchParam(a,!0,!0),a.toString()?e=`${e}?${a.toString()}#${s}`:e=`${e}#${s}`}const n=new Blob([rd([`/*${s}*/`,void 0,`globalThis._VSCODE_NLS_MESSAGES = ${JSON.stringify(Jde())};`,`globalThis._VSCODE_NLS_LANGUAGE = ${JSON.stringify(_q())};`,`globalThis._VSCODE_FILE_ROOT = '${globalThis._VSCODE_FILE_ROOT}';`,"const ttPolicy = globalThis.trustedTypes?.createPolicy('defaultWorkerFactory', { createScriptURL: value => value });","globalThis.workerttPolicy = ttPolicy;",`await import(ttPolicy?.createScriptURL('${e}') ?? '${e}');`,"globalThis.postMessage({ type: 'vscode-worker-ready' });",`/*${s}*/`]).join("")],{type:"application/javascript"});return URL.createObjectURL(n)}function iPe(s){return new Promise((e,t)=>{s.onmessage=function(i){i.data.type==="vscode-worker-ready"&&(s.onmessage=null,e(s))},s.onerror=t})}function nPe(s){return typeof s.then=="function"}class sPe extends te{constructor(e,t,i,n,r,o){super(),this.id=i,this.label=n;const a=ePe(e,n);nPe(a)?this.worker=a:this.worker=Promise.resolve(a),this.postMessage(t,[]),this.worker.then(l=>{l.onmessage=function(c){r(c.data)},l.onmessageerror=o,typeof l.addEventListener=="function"&&l.addEventListener("error",o)}),this._register(Ye(()=>{var l;(l=this.worker)==null||l.then(c=>{c.onmessage=null,c.onmessageerror=null,c.removeEventListener("error",o),c.terminate()}),this.worker=null}))}getId(){return this.id}postMessage(e,t){var i;(i=this.worker)==null||i.then(n=>{try{n.postMessage(e,t)}catch(r){ft(r),ft(new Error(`FAILED to post message to '${this.label}'-worker`,{cause:r}))}})}}class rPe{constructor(e,t){this.amdModuleId=e,this.label=t,this.esmModuleLocation=eF.asBrowserUri(`${e}.esm.js`)}}const FM=class FM{constructor(){this._webWorkerFailedBeforeError=!1}create(e,t,i){const n=++FM.LAST_WORKER_ID;if(this._webWorkerFailedBeforeError)throw this._webWorkerFailedBeforeError;return new sPe(e.esmModuleLocation,e.amdModuleId,n,e.label||"anonymous"+n,t,r=>{i6(r),this._webWorkerFailedBeforeError=r,i(r)})}};FM.LAST_WORKER_ID=0;let n6=FM;function oPe(s,e){const t=typeof s=="string"?new rPe(s,e):s;return new JAe(new n6,t)}var is;(function(s){s[s.None=0]="None",s[s.Indent=1]="Indent",s[s.IndentOutdent=2]="IndentOutdent",s[s.Outdent=3]="Outdent"})(is||(is={}));class dV{constructor(e){if(this._neutralCharacter=null,this._neutralCharacterSearched=!1,this.open=e.open,this.close=e.close,this._inString=!0,this._inComment=!0,this._inRegEx=!0,Array.isArray(e.notIn))for(let t=0,i=e.notIn.length;t<i;t++)switch(e.notIn[t]){case"string":this._inString=!1;break;case"comment":this._inComment=!1;break;case"regex":this._inRegEx=!1;break}}isOK(e){switch(e){case 0:return!0;case 1:return this._inComment;case 2:return this._inString;case 3:return this._inRegEx}}shouldAutoClose(e,t){if(e.getTokenCount()===0)return!0;const i=e.findTokenIndexAtOffset(t-2),n=e.getStandardTokenType(i);return this.isOK(n)}_findNeutralCharacterInRange(e,t){for(let i=e;i<=t;i++){const n=String.fromCharCode(i);if(!this.open.includes(n)&&!this.close.includes(n))return n}return null}findNeutralCharacter(){return this._neutralCharacterSearched||(this._neutralCharacterSearched=!0,this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(48,57)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(97,122)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(65,90))),this._neutralCharacter}}class aPe{constructor(e){this.autoClosingPairsOpenByStart=new Map,this.autoClosingPairsOpenByEnd=new Map,this.autoClosingPairsCloseByStart=new Map,this.autoClosingPairsCloseByEnd=new Map,this.autoClosingPairsCloseSingleChar=new Map;for(const t of e)yx(this.autoClosingPairsOpenByStart,t.open.charAt(0),t),yx(this.autoClosingPairsOpenByEnd,t.open.charAt(t.open.length-1),t),yx(this.autoClosingPairsCloseByStart,t.close.charAt(0),t),yx(this.autoClosingPairsCloseByEnd,t.close.charAt(t.close.length-1),t),t.close.length===1&&t.open.length===1&&yx(this.autoClosingPairsCloseSingleChar,t.close,t)}}function yx(s,e,t){s.has(e)?s.get(e).push(t):s.set(e,[t])}const YC=class YC{constructor(e){if(e.autoClosingPairs?this._autoClosingPairs=e.autoClosingPairs.map(t=>new dV(t)):e.brackets?this._autoClosingPairs=e.brackets.map(t=>new dV({open:t[0],close:t[1]})):this._autoClosingPairs=[],e.__electricCharacterSupport&&e.__electricCharacterSupport.docComment){const t=e.__electricCharacterSupport.docComment;this._autoClosingPairs.push(new dV({open:t.open,close:t.close||""}))}this._autoCloseBeforeForQuotes=typeof e.autoCloseBefore=="string"?e.autoCloseBefore:YC.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES,this._autoCloseBeforeForBrackets=typeof e.autoCloseBefore=="string"?e.autoCloseBefore:YC.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS,this._surroundingPairs=e.surroundingPairs||this._autoClosingPairs}getAutoClosingPairs(){return this._autoClosingPairs}getAutoCloseBeforeSet(e){return e?this._autoCloseBeforeForQuotes:this._autoCloseBeforeForBrackets}getSurroundingPairs(){return this._surroundingPairs}};YC.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES=`;:.,=}])> 
	`,YC.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS=`'"\`;:.,=}])> 
	`;let s6=YC;function Vb(s,e){const t=s.getCount(),i=s.findTokenIndexAtOffset(e),n=s.getLanguageId(i);let r=i;for(;r+1<t&&s.getLanguageId(r+1)===n;)r++;let o=i;for(;o>0&&s.getLanguageId(o-1)===n;)o--;return new lPe(s,n,o,r+1,s.getStartOffset(o),s.getEndOffset(r))}class lPe{constructor(e,t,i,n,r,o){this._scopedLineTokensBrand=void 0,this._actual=e,this.languageId=t,this._firstTokenIndex=i,this._lastTokenIndex=n,this.firstCharOffset=r,this._lastCharOffset=o,this.languageIdCodec=e.languageIdCodec}getLineContent(){return this._actual.getLineContent().substring(this.firstCharOffset,this._lastCharOffset)}getLineLength(){return this._lastCharOffset-this.firstCharOffset}getActualLineContentBefore(e){return this._actual.getLineContent().substring(0,this.firstCharOffset+e)}getTokenCount(){return this._lastTokenIndex-this._firstTokenIndex}findTokenIndexAtOffset(e){return this._actual.findTokenIndexAtOffset(e+this.firstCharOffset)-this._firstTokenIndex}getStandardTokenType(e){return this._actual.getStandardTokenType(e+this._firstTokenIndex)}toIViewLineTokens(){return this._actual.sliceAndInflate(this.firstCharOffset,this._lastCharOffset,0)}}function ju(s){return(s&3)!==0}const yte=typeof Buffer<"u";let uV;class mF{static wrap(e){return yte&&!Buffer.isBuffer(e)&&(e=Buffer.from(e.buffer,e.byteOffset,e.byteLength)),new mF(e)}constructor(e){this.buffer=e,this.byteLength=this.buffer.byteLength}toString(){return yte?this.buffer.toString():(uV||(uV=new TextDecoder),uV.decode(this.buffer))}}function cPe(s,e){return s[e+0]<<0>>>0|s[e+1]<<8>>>0}function dPe(s,e,t){s[t+0]=e&255,e=e>>>8,s[t+1]=e&255}function Wd(s,e){return s[e]*2**24+s[e+1]*2**16+s[e+2]*2**8+s[e+3]}function Hd(s,e,t){s[t+3]=e,e=e>>>8,s[t+2]=e,e=e>>>8,s[t+1]=e,e=e>>>8,s[t]=e}function Ste(s,e){return s[e]}function xte(s,e,t){s[t]=e}let hV;function whe(){return hV||(hV=new TextDecoder("UTF-16LE")),hV}let fV;function uPe(){return fV||(fV=new TextDecoder("UTF-16BE")),fV}let gV;function Che(){return gV||(gV=rue()?whe():uPe()),gV}function hPe(s,e,t){const i=new Uint16Array(s.buffer,e,t);return t>0&&(i[0]===65279||i[0]===65534)?fPe(s,e,t):whe().decode(i)}function fPe(s,e,t){const i=[];let n=0;for(let r=0;r<t;r++){const o=cPe(s,e);e+=2,i[n++]=String.fromCharCode(o)}return i.join("")}class hS{constructor(e){this._capacity=e|0,this._buffer=new Uint16Array(this._capacity),this._completedStrings=null,this._bufferLength=0}reset(){this._completedStrings=null,this._bufferLength=0}build(){return this._completedStrings!==null?(this._flushBuffer(),this._completedStrings.join("")):this._buildBuffer()}_buildBuffer(){if(this._bufferLength===0)return"";const e=new Uint16Array(this._buffer.buffer,0,this._bufferLength);return Che().decode(e)}_flushBuffer(){const e=this._buildBuffer();this._bufferLength=0,this._completedStrings===null?this._completedStrings=[e]:this._completedStrings[this._completedStrings.length]=e}appendCharCode(e){const t=this._capacity-this._bufferLength;t<=1&&(t===0||ws(e))&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendASCIICharCode(e){this._bufferLength===this._capacity&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendString(e){const t=e.length;if(this._bufferLength+t>=this._capacity){this._flushBuffer(),this._completedStrings[this._completedStrings.length]=e;return}for(let i=0;i<t;i++)this._buffer[this._bufferLength++]=e.charCodeAt(i)}}class Q2{constructor(e,t,i,n,r,o){this._richEditBracketBrand=void 0,this.languageId=e,this.index=t,this.open=i,this.close=n,this.forwardRegex=r,this.reversedRegex=o,this._openSet=Q2._toSet(this.open),this._closeSet=Q2._toSet(this.close)}isOpen(e){return this._openSet.has(e)}isClose(e){return this._closeSet.has(e)}static _toSet(e){const t=new Set;for(const i of e)t.add(i);return t}}function gPe(s){const e=s.length;s=s.map(o=>[o[0].toLowerCase(),o[1].toLowerCase()]);const t=[];for(let o=0;o<e;o++)t[o]=o;const i=(o,a)=>{const[l,c]=o,[d,u]=a;return l===d||l===u||c===d||c===u},n=(o,a)=>{const l=Math.min(o,a),c=Math.max(o,a);for(let d=0;d<e;d++)t[d]===c&&(t[d]=l)};for(let o=0;o<e;o++){const a=s[o];for(let l=o+1;l<e;l++){const c=s[l];i(a,c)&&n(t[o],t[l])}}const r=[];for(let o=0;o<e;o++){const a=[],l=[];for(let c=0;c<e;c++)if(t[c]===o){const[d,u]=s[c];a.push(d),l.push(u)}a.length>0&&r.push({open:a,close:l})}return r}class pPe{constructor(e,t){this._richEditBracketsBrand=void 0;const i=gPe(t);this.brackets=i.map((n,r)=>new Q2(e,r,n.open,n.close,mPe(n.open,n.close,i,r),_Pe(n.open,n.close,i,r))),this.forwardRegex=bPe(this.brackets),this.reversedRegex=vPe(this.brackets),this.textIsBracket={},this.textIsOpenBracket={},this.maxBracketLength=0;for(const n of this.brackets){for(const r of n.open)this.textIsBracket[r]=n,this.textIsOpenBracket[r]=!0,this.maxBracketLength=Math.max(this.maxBracketLength,r.length);for(const r of n.close)this.textIsBracket[r]=n,this.textIsOpenBracket[r]=!1,this.maxBracketLength=Math.max(this.maxBracketLength,r.length)}}}function yhe(s,e,t,i){for(let n=0,r=e.length;n<r;n++){if(n===t)continue;const o=e[n];for(const a of o.open)a.indexOf(s)>=0&&i.push(a);for(const a of o.close)a.indexOf(s)>=0&&i.push(a)}}function She(s,e){return s.length-e.length}function _F(s){if(s.length<=1)return s;const e=[],t=new Set;for(const i of s)t.has(i)||(e.push(i),t.add(i));return e}function mPe(s,e,t,i){let n=[];n=n.concat(s),n=n.concat(e);for(let r=0,o=n.length;r<o;r++)yhe(n[r],t,i,n);return n=_F(n),n.sort(She),n.reverse(),qE(n)}function _Pe(s,e,t,i){let n=[];n=n.concat(s),n=n.concat(e);for(let r=0,o=n.length;r<o;r++)yhe(n[r],t,i,n);return n=_F(n),n.sort(She),n.reverse(),qE(n.map(Kq))}function bPe(s){let e=[];for(const t of s){for(const i of t.open)e.push(i);for(const i of t.close)e.push(i)}return e=_F(e),qE(e)}function vPe(s){let e=[];for(const t of s){for(const i of t.open)e.push(i);for(const i of t.close)e.push(i)}return e=_F(e),qE(e.map(Kq))}function wPe(s){const e=/^[\w ]+$/.test(s);return s=Nl(s),e?`\\b${s}\\b`:s}function qE(s,e){const t=`(${s.map(wPe).join(")|(")})`;return Due(t,!0,e)}const Kq=function(){function s(i){const n=new Uint16Array(i.length);let r=0;for(let o=i.length-1;o>=0;o--)n[r++]=i.charCodeAt(o);return Che().decode(n)}let e=null,t=null;return function(n){return e!==n&&(e=n,t=s(e)),t}}();class Hc{static _findPrevBracketInText(e,t,i,n){const r=i.match(e);if(!r)return null;const o=i.length-(r.index||0),a=r[0].length,l=n+o;return new F(t,l-a+1,t,l+1)}static findPrevBracketInRange(e,t,i,n,r){const a=Kq(i).substring(i.length-r,i.length-n);return this._findPrevBracketInText(e,t,a,n)}static findNextBracketInText(e,t,i,n){const r=i.match(e);if(!r)return null;const o=r.index||0,a=r[0].length;if(a===0)return null;const l=n+o;return new F(t,l+1,t,l+1+a)}static findNextBracketInRange(e,t,i,n,r){const o=i.substring(n,r);return this.findNextBracketInText(e,t,o,n)}}class CPe{constructor(e){this._richEditBrackets=e}getElectricCharacters(){const e=[];if(this._richEditBrackets)for(const t of this._richEditBrackets.brackets)for(const i of t.close){const n=i.charAt(i.length-1);e.push(n)}return wg(e)}onElectricCharacter(e,t,i){if(!this._richEditBrackets||this._richEditBrackets.brackets.length===0)return null;const n=t.findTokenIndexAtOffset(i-1);if(ju(t.getStandardTokenType(n)))return null;const r=this._richEditBrackets.reversedRegex,o=t.getLineContent().substring(0,i-1)+e,a=Hc.findPrevBracketInRange(r,1,o,0,o.length);if(!a)return null;const l=o.substring(a.startColumn-1,a.endColumn-1).toLowerCase();if(this._richEditBrackets.textIsOpenBracket[l])return null;const d=t.getActualLineContentBefore(a.startColumn-1);return/^\s*$/.test(d)?{matchOpenBracket:l}:null}}function tN(s){return s.global&&(s.lastIndex=0),!0}class yPe{constructor(e){this._indentationRules=e}shouldIncrease(e){return!!(this._indentationRules&&this._indentationRules.increaseIndentPattern&&tN(this._indentationRules.increaseIndentPattern)&&this._indentationRules.increaseIndentPattern.test(e))}shouldDecrease(e){return!!(this._indentationRules&&this._indentationRules.decreaseIndentPattern&&tN(this._indentationRules.decreaseIndentPattern)&&this._indentationRules.decreaseIndentPattern.test(e))}shouldIndentNextLine(e){return!!(this._indentationRules&&this._indentationRules.indentNextLinePattern&&tN(this._indentationRules.indentNextLinePattern)&&this._indentationRules.indentNextLinePattern.test(e))}shouldIgnore(e){return!!(this._indentationRules&&this._indentationRules.unIndentedLinePattern&&tN(this._indentationRules.unIndentedLinePattern)&&this._indentationRules.unIndentedLinePattern.test(e))}getIndentMetadata(e){let t=0;return this.shouldIncrease(e)&&(t+=1),this.shouldDecrease(e)&&(t+=2),this.shouldIndentNextLine(e)&&(t+=4),this.shouldIgnore(e)&&(t+=8),t}}class LC{constructor(e){e=e||{},e.brackets=e.brackets||[["(",")"],["{","}"],["[","]"]],this._brackets=[],e.brackets.forEach(t=>{const i=LC._createOpenBracketRegExp(t[0]),n=LC._createCloseBracketRegExp(t[1]);i&&n&&this._brackets.push({open:t[0],openRegExp:i,close:t[1],closeRegExp:n})}),this._regExpRules=e.onEnterRules||[]}onEnter(e,t,i,n){if(e>=3)for(let r=0,o=this._regExpRules.length;r<o;r++){const a=this._regExpRules[r];if([{reg:a.beforeText,text:i},{reg:a.afterText,text:n},{reg:a.previousLineText,text:t}].every(c=>c.reg?(c.reg.lastIndex=0,c.reg.test(c.text)):!0))return a.action}if(e>=2&&i.length>0&&n.length>0)for(let r=0,o=this._brackets.length;r<o;r++){const a=this._brackets[r];if(a.openRegExp.test(i)&&a.closeRegExp.test(n))return{indentAction:is.IndentOutdent}}if(e>=2&&i.length>0){for(let r=0,o=this._brackets.length;r<o;r++)if(this._brackets[r].openRegExp.test(i))return{indentAction:is.Indent}}return null}static _createOpenBracketRegExp(e){let t=Nl(e);return/\B/.test(t.charAt(0))||(t="\\b"+t),t+="\\s*$",LC._safeRegExp(t)}static _createCloseBracketRegExp(e){let t=Nl(e);return/\B/.test(t.charAt(t.length-1))||(t=t+"\\b"),t="^\\s*"+t,LC._safeRegExp(t)}static _safeRegExp(e){try{return new RegExp(e)}catch(t){return ft(t),null}}}const At=Ht("configurationService");function r6(s,e){const t=Object.create(null);for(const i in s)xhe(t,i,s[i],e);return t}function xhe(s,e,t,i){const n=e.split("."),r=n.pop();let o=s;for(let a=0;a<n.length;a++){const l=n[a];let c=o[l];switch(typeof c){case"undefined":c=o[l]=Object.create(null);break;case"object":if(c===null){i(`Ignoring ${e} as ${n.slice(0,a+1).join(".")} is null`);return}break;default:i(`Ignoring ${e} as ${n.slice(0,a+1).join(".")} is ${JSON.stringify(c)}`);return}o=c}if(typeof o=="object"&&o!==null)try{o[r]=t}catch{i(`Ignoring ${e} as ${n.join(".")} is ${JSON.stringify(o)}`)}else i(`Ignoring ${e} as ${n.join(".")} is ${JSON.stringify(o)}`)}function SPe(s,e){const t=e.split(".");Lhe(s,t)}function Lhe(s,e){const t=e.shift();if(e.length===0){delete s[t];return}if(Object.keys(s).indexOf(t)!==-1){const i=s[t];typeof i=="object"&&!Array.isArray(i)&&(Lhe(i,e),Object.keys(i).length===0&&delete s[t])}}function Lte(s,e,t){function i(o,a){let l=o;for(const c of a){if(typeof l!="object"||l===null)return;l=l[c]}return l}const n=e.split("."),r=i(s,n);return typeof r>"u"?t:r}function xPe(s){return s.replace(/[\[\]]/g,"")}const un=Ht("languageService");class rh{constructor(e,t=[],i=!1){this.ctor=e,this.staticArguments=t,this.supportsDelayedInstantiation=i}}const khe=[];function qt(s,e,t){e instanceof rh||(e=new rh(e,[],!!t)),khe.push([s,e])}function kte(){return khe}const An=Object.freeze({text:"text/plain",binary:"application/octet-stream",unknown:"application/unknown",markdown:"text/markdown",latex:"text/latex",uriList:"text/uri-list"}),bF={JSONContribution:"base.contributions.json"};function LPe(s){return s.length>0&&s.charAt(s.length-1)==="#"?s.substring(0,s.length-1):s}class kPe{constructor(){this._onDidChangeSchema=new Z,this.schemasById={}}registerSchema(e,t){this.schemasById[LPe(e)]=t,this._onDidChangeSchema.fire(e)}notifySchemaChanged(e){this._onDidChangeSchema.fire(e)}}const IPe=new kPe;_n.add(bF.JSONContribution,IPe);const pd={Configuration:"base.contributions.configuration"},iN="vscode://schemas/settings/resourceLanguage",Ite=_n.as(bF.JSONContribution);class EPe{constructor(){this.registeredConfigurationDefaults=[],this.overrideIdentifiers=new Set,this._onDidSchemaChange=new Z,this._onDidUpdateConfiguration=new Z,this.configurationDefaultsOverrides=new Map,this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:b("defaultLanguageConfigurationOverrides.title","Default Language Configuration Overrides"),properties:{}},this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode],this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},this.configurationProperties={},this.policyConfigurations=new Map,this.excludedConfigurationProperties={},Ite.registerSchema(iN,this.resourceLanguageSettingsSchema),this.registerOverridePropertyPatternKey()}registerConfiguration(e,t=!0){this.registerConfigurations([e],t)}registerConfigurations(e,t=!0){const i=new Set;this.doRegisterConfigurations(e,t,i),Ite.registerSchema(iN,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:i})}registerDefaultConfigurations(e){const t=new Set;this.doRegisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doRegisterDefaultConfigurations(e,t){this.registeredConfigurationDefaults.push(...e);const i=[];for(const{overrides:n,source:r}of e)for(const o in n){t.add(o);const a=this.configurationDefaultsOverrides.get(o)??this.configurationDefaultsOverrides.set(o,{configurationDefaultOverrides:[]}).get(o),l=n[o];if(a.configurationDefaultOverrides.push({value:l,source:r}),Km.test(o)){const c=this.mergeDefaultConfigurationsForOverrideIdentifier(o,l,r,a.configurationDefaultOverrideValue);if(!c)continue;a.configurationDefaultOverrideValue=c,this.updateDefaultOverrideProperty(o,c,r),i.push(...Y2(o))}else{const c=this.mergeDefaultConfigurationsForConfigurationProperty(o,l,r,a.configurationDefaultOverrideValue);if(!c)continue;a.configurationDefaultOverrideValue=c;const d=this.configurationProperties[o];d&&(this.updatePropertyDefaultValue(o,d),this.updateSchema(o,d))}}this.doRegisterOverrideIdentifiers(i)}updateDefaultOverrideProperty(e,t,i){const n={type:"object",default:t.value,description:b("defaultLanguageConfiguration.description","Configure settings to be overridden for the {0} language.",xPe(e)),$ref:iN,defaultDefaultValue:t.value,source:i,defaultValueSource:i};this.configurationProperties[e]=n,this.defaultLanguageConfigurationOverridesNode.properties[e]=n}mergeDefaultConfigurationsForOverrideIdentifier(e,t,i,n){const r=(n==null?void 0:n.value)||{},o=(n==null?void 0:n.source)??new Map;if(!(o instanceof Map)){console.error("objectConfigurationSources is not a Map");return}for(const a of Object.keys(t)){const l=t[a];if(Ms(l)&&(Yr(r[a])||Ms(r[a]))){if(r[a]={...r[a]??{},...l},i)for(const d in l)o.set(`${a}.${d}`,i)}else r[a]=l,i?o.set(a,i):o.delete(a)}return{value:r,source:o}}mergeDefaultConfigurationsForConfigurationProperty(e,t,i,n){const r=this.configurationProperties[e],o=(n==null?void 0:n.value)??(r==null?void 0:r.defaultDefaultValue);let a=i;if(Ms(t)&&(r!==void 0&&r.type==="object"||r===void 0&&(Yr(o)||Ms(o)))){if(a=(n==null?void 0:n.source)??new Map,!(a instanceof Map)){console.error("defaultValueSource is not a Map");return}for(const c in t)i&&a.set(`${e}.${c}`,i);t={...Ms(o)?o:{},...t}}return{value:t,source:a}}registerOverrideIdentifiers(e){this.doRegisterOverrideIdentifiers(e),this._onDidSchemaChange.fire()}doRegisterOverrideIdentifiers(e){for(const t of e)this.overrideIdentifiers.add(t);this.updateOverridePropertyPatternKey()}doRegisterConfigurations(e,t,i){e.forEach(n=>{this.validateAndRegisterProperties(n,t,n.extensionInfo,n.restrictedProperties,void 0,i),this.configurationContributors.push(n),this.registerJSONConfiguration(n)})}validateAndRegisterProperties(e,t=!0,i,n,r=3,o){var c;r=ml(e.scope)?r:e.scope;const a=e.properties;if(a)for(const d in a){const u=a[d];if(t&&NPe(d,u)){delete a[d];continue}if(u.source=i,u.defaultDefaultValue=a[d].default,this.updatePropertyDefaultValue(d,u),Km.test(d)?u.scope=void 0:(u.scope=ml(u.scope)?r:u.scope,u.restricted=ml(u.restricted)?!!(n!=null&&n.includes(d)):u.restricted),a[d].hasOwnProperty("included")&&!a[d].included){this.excludedConfigurationProperties[d]=a[d],delete a[d];continue}else this.configurationProperties[d]=a[d],(c=a[d].policy)!=null&&c.name&&this.policyConfigurations.set(a[d].policy.name,d);!a[d].deprecationMessage&&a[d].markdownDeprecationMessage&&(a[d].deprecationMessage=a[d].markdownDeprecationMessage),o.add(d)}const l=e.allOf;if(l)for(const d of l)this.validateAndRegisterProperties(d,t,i,n,r,o)}getConfigurationProperties(){return this.configurationProperties}getPolicyConfigurations(){return this.policyConfigurations}registerJSONConfiguration(e){const t=i=>{const n=i.properties;if(n)for(const o in n)this.updateSchema(o,n[o]);const r=i.allOf;r==null||r.forEach(t)};t(e)}updateSchema(e,t){switch(t.scope){case 1:break;case 2:break;case 6:break;case 3:break;case 4:break;case 5:this.resourceLanguageSettingsSchema.properties[e]=t;break}}updateOverridePropertyPatternKey(){for(const e of this.overrideIdentifiers.values()){const t=`[${e}]`,i={type:"object",description:b("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),errorMessage:b("overrideSettings.errorMessage","This setting does not support per-language configuration."),$ref:iN};this.updatePropertyDefaultValue(t,i)}}registerOverridePropertyPatternKey(){b("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),b("overrideSettings.errorMessage","This setting does not support per-language configuration."),this._onDidSchemaChange.fire()}updatePropertyDefaultValue(e,t){var o;const i=(o=this.configurationDefaultsOverrides.get(e))==null?void 0:o.configurationDefaultOverrideValue;let n,r;i&&(!t.disallowConfigurationDefault||!i.source)&&(n=i.value,r=i.source),Yr(n)&&(n=t.defaultDefaultValue,r=void 0),Yr(n)&&(n=TPe(t.type)),t.default=n,t.defaultValueSource=r}}const Ihe="\\[([^\\]]+)\\]",Ete=new RegExp(Ihe,"g"),DPe=`^(${Ihe})+$`,Km=new RegExp(DPe);function Y2(s){const e=[];if(Km.test(s)){let t=Ete.exec(s);for(;t!=null&&t.length;){const i=t[1].trim();i&&e.push(i),t=Ete.exec(s)}}return wg(e)}function TPe(s){switch(Array.isArray(s)?s[0]:s){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}const xR=new EPe;_n.add(pd.Configuration,xR);function NPe(s,e){var t,i,n,r;return s.trim()?Km.test(s)?b("config.property.languageDefault","Cannot register '{0}'. This matches property pattern '\\\\[.*\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.",s):xR.getConfigurationProperties()[s]!==void 0?b("config.property.duplicate","Cannot register '{0}'. This property is already registered.",s):(t=e.policy)!=null&&t.name&&xR.getPolicyConfigurations().get((i=e.policy)==null?void 0:i.name)!==void 0?b("config.policy.duplicate","Cannot register '{0}'. The associated policy {1} is already registered with {2}.",s,(n=e.policy)==null?void 0:n.name,xR.getPolicyConfigurations().get((r=e.policy)==null?void 0:r.name)):null:b("config.property.empty","Cannot register an empty property")}const RPe={ModesRegistry:"editor.modesRegistry"};class APe{constructor(){this._onDidChangeLanguages=new Z,this.onDidChangeLanguages=this._onDidChangeLanguages.event,this._languages=[]}registerLanguage(e){return this._languages.push(e),this._onDidChangeLanguages.fire(void 0),{dispose:()=>{for(let t=0,i=this._languages.length;t<i;t++)if(this._languages[t]===e){this._languages.splice(t,1);return}}}}getLanguages(){return this._languages}}const g1=new APe;_n.add(RPe.ModesRegistry,g1);const So="plaintext",PPe=".txt";g1.registerLanguage({id:So,extensions:[PPe],aliases:[b("plainText.alias","Plain Text"),"text"],mimetypes:[An.text]});_n.as(pd.Configuration).registerDefaultConfigurations([{overrides:{"[plaintext]":{"editor.unicodeHighlight.ambiguousCharacters":!1,"editor.unicodeHighlight.invisibleCharacters":!1}}}]);class MPe{constructor(e,t){this.languageId=e;const i=t.brackets?Dte(t.brackets):[],n=new Xee(a=>{const l=new Set;return{info:new OPe(this,a,l),closing:l}}),r=new Xee(a=>{const l=new Set,c=new Set;return{info:new FPe(this,a,l,c),opening:l,openingColorized:c}});for(const[a,l]of i){const c=n.get(a),d=r.get(l);c.closing.add(d.info),d.opening.add(c.info)}const o=t.colorizedBracketPairs?Dte(t.colorizedBracketPairs):i.filter(a=>!(a[0]==="<"&&a[1]===">"));for(const[a,l]of o){const c=n.get(a),d=r.get(l);c.closing.add(d.info),d.openingColorized.add(c.info),d.opening.add(c.info)}this._openingBrackets=new Map([...n.cachedValues].map(([a,l])=>[a,l.info])),this._closingBrackets=new Map([...r.cachedValues].map(([a,l])=>[a,l.info]))}get openingBrackets(){return[...this._openingBrackets.values()]}get closingBrackets(){return[...this._closingBrackets.values()]}getOpeningBracketInfo(e){return this._openingBrackets.get(e)}getClosingBracketInfo(e){return this._closingBrackets.get(e)}getBracketInfo(e){return this.getOpeningBracketInfo(e)||this.getClosingBracketInfo(e)}getBracketRegExp(e){const t=Array.from([...this._openingBrackets.keys(),...this._closingBrackets.keys()]);return qE(t,e)}}function Dte(s){return s.filter(([e,t])=>e!==""&&t!=="")}class Ehe{constructor(e,t){this.config=e,this.bracketText=t}get languageId(){return this.config.languageId}}class OPe extends Ehe{constructor(e,t,i){super(e,t),this.openedBrackets=i,this.isOpeningBracket=!0}}class FPe extends Ehe{constructor(e,t,i,n){super(e,t),this.openingBrackets=i,this.openingColorizedBrackets=n,this.isOpeningBracket=!1}closes(e){return e.config!==this.config?!1:this.openingBrackets.has(e)}closesColorized(e){return e.config!==this.config?!1:this.openingColorizedBrackets.has(e)}getOpeningBrackets(){return[...this.openingBrackets]}}var VPe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Tte=function(s,e){return function(t,i){e(t,i,s)}};class pV{constructor(e){this.languageId=e}affects(e){return this.languageId?this.languageId===e:!0}}const bn=Ht("languageConfigurationService");let o6=class extends te{constructor(e,t){super(),this.configurationService=e,this.languageService=t,this._registry=this._register(new zPe),this.onDidChangeEmitter=this._register(new Z),this.onDidChange=this.onDidChangeEmitter.event,this.configurations=new Map;const i=new Set(Object.values(a6));this._register(this.configurationService.onDidChangeConfiguration(n=>{const r=n.change.keys.some(a=>i.has(a)),o=n.change.overrides.filter(([a,l])=>l.some(c=>i.has(c))).map(([a])=>a);if(r)this.configurations.clear(),this.onDidChangeEmitter.fire(new pV(void 0));else for(const a of o)this.languageService.isRegisteredLanguageId(a)&&(this.configurations.delete(a),this.onDidChangeEmitter.fire(new pV(a)))})),this._register(this._registry.onDidChange(n=>{this.configurations.delete(n.languageId),this.onDidChangeEmitter.fire(new pV(n.languageId))}))}register(e,t,i){return this._registry.register(e,t,i)}getLanguageConfiguration(e){let t=this.configurations.get(e);return t||(t=BPe(e,this._registry,this.configurationService,this.languageService),this.configurations.set(e,t)),t}};o6=VPe([Tte(0,At),Tte(1,un)],o6);function BPe(s,e,t,i){let n=e.getLanguageConfiguration(s);if(!n){if(!i.isRegisteredLanguageId(s))return new by(s,{});n=new by(s,{})}const r=WPe(n.languageId,t),o=The([n.underlyingConfig,r]);return new by(n.languageId,o)}const a6={brackets:"editor.language.brackets",colorizedBracketPairs:"editor.language.colorizedBracketPairs"};function WPe(s,e){const t=e.getValue(a6.brackets,{overrideIdentifier:s}),i=e.getValue(a6.colorizedBracketPairs,{overrideIdentifier:s});return{brackets:Nte(t),colorizedBracketPairs:Nte(i)}}function Nte(s){if(Array.isArray(s))return s.map(e=>{if(!(!Array.isArray(e)||e.length!==2))return[e[0],e[1]]}).filter(e=>!!e)}function Dhe(s,e,t){const i=s.getLineContent(e);let n=Ti(i);return n.length>t-1&&(n=n.substring(0,t-1)),n}class HPe{constructor(e){this.languageId=e,this._resolved=null,this._entries=[],this._order=0,this._resolved=null}register(e,t){const i=new Rte(e,t,++this._order);return this._entries.push(i),this._resolved=null,Ye(()=>{for(let n=0;n<this._entries.length;n++)if(this._entries[n]===i){this._entries.splice(n,1),this._resolved=null;break}})}getResolvedConfiguration(){if(!this._resolved){const e=this._resolve();e&&(this._resolved=new by(this.languageId,e))}return this._resolved}_resolve(){return this._entries.length===0?null:(this._entries.sort(Rte.cmp),The(this._entries.map(e=>e.configuration)))}}function The(s){let e={comments:void 0,brackets:void 0,wordPattern:void 0,indentationRules:void 0,onEnterRules:void 0,autoClosingPairs:void 0,surroundingPairs:void 0,autoCloseBefore:void 0,folding:void 0,colorizedBracketPairs:void 0,__electricCharacterSupport:void 0};for(const t of s)e={comments:t.comments||e.comments,brackets:t.brackets||e.brackets,wordPattern:t.wordPattern||e.wordPattern,indentationRules:t.indentationRules||e.indentationRules,onEnterRules:t.onEnterRules||e.onEnterRules,autoClosingPairs:t.autoClosingPairs||e.autoClosingPairs,surroundingPairs:t.surroundingPairs||e.surroundingPairs,autoCloseBefore:t.autoCloseBefore||e.autoCloseBefore,folding:t.folding||e.folding,colorizedBracketPairs:t.colorizedBracketPairs||e.colorizedBracketPairs,__electricCharacterSupport:t.__electricCharacterSupport||e.__electricCharacterSupport};return e}class Rte{constructor(e,t,i){this.configuration=e,this.priority=t,this.order=i}static cmp(e,t){return e.priority===t.priority?e.order-t.order:e.priority-t.priority}}class Ate{constructor(e){this.languageId=e}}class zPe extends te{constructor(){super(),this._entries=new Map,this._onDidChange=this._register(new Z),this.onDidChange=this._onDidChange.event,this._register(this.register(So,{brackets:[["(",")"],["[","]"],["{","}"]],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:"<",close:">"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"`",close:"`"}],colorizedBracketPairs:[],folding:{offSide:!0}},0))}register(e,t,i=0){let n=this._entries.get(e);n||(n=new HPe(e),this._entries.set(e,n));const r=n.register(t,i);return this._onDidChange.fire(new Ate(e)),Ye(()=>{r.dispose(),this._onDidChange.fire(new Ate(e))})}getLanguageConfiguration(e){const t=this._entries.get(e);return(t==null?void 0:t.getResolvedConfiguration())||null}}class by{constructor(e,t){this.languageId=e,this.underlyingConfig=t,this._brackets=null,this._electricCharacter=null,this._onEnterSupport=this.underlyingConfig.brackets||this.underlyingConfig.indentationRules||this.underlyingConfig.onEnterRules?new LC(this.underlyingConfig):null,this.comments=by._handleComments(this.underlyingConfig),this.characterPair=new s6(this.underlyingConfig),this.wordDefinition=this.underlyingConfig.wordPattern||wq,this.indentationRules=this.underlyingConfig.indentationRules,this.underlyingConfig.indentationRules?this.indentRulesSupport=new yPe(this.underlyingConfig.indentationRules):this.indentRulesSupport=null,this.foldingRules=this.underlyingConfig.folding||{},this.bracketsNew=new MPe(e,this.underlyingConfig)}getWordDefinition(){return Cq(this.wordDefinition)}get brackets(){return!this._brackets&&this.underlyingConfig.brackets&&(this._brackets=new pPe(this.languageId,this.underlyingConfig.brackets)),this._brackets}get electricCharacter(){return this._electricCharacter||(this._electricCharacter=new CPe(this.brackets)),this._electricCharacter}onEnter(e,t,i,n){return this._onEnterSupport?this._onEnterSupport.onEnter(e,t,i,n):null}getAutoClosingPairs(){return new aPe(this.characterPair.getAutoClosingPairs())}getAutoCloseBeforeSet(e){return this.characterPair.getAutoCloseBeforeSet(e)}getSurroundingPairs(){return this.characterPair.getSurroundingPairs()}static _handleComments(e){const t=e.comments;if(!t)return null;const i={};if(t.lineComment&&(i.lineCommentToken=t.lineComment),t.blockComment){const[n,r]=t.blockComment;i.blockCommentStartToken=n,i.blockCommentEndToken=r}return i}}qt(bn,o6,1);class bp{constructor(e,t,i,n){this.originalStart=e,this.originalLength=t,this.modifiedStart=i,this.modifiedLength=n}getOriginalEnd(){return this.originalStart+this.originalLength}getModifiedEnd(){return this.modifiedStart+this.modifiedLength}}class Pte{constructor(e){this.source=e}getElements(){const e=this.source,t=new Int32Array(e.length);for(let i=0,n=e.length;i<n;i++)t[i]=e.charCodeAt(i);return t}}function UPe(s,e,t){return new ch(new Pte(s),new Pte(e)).ComputeDiff(t).changes}class z0{static Assert(e,t){if(!e)throw new Error(t)}}class U0{static Copy(e,t,i,n,r){for(let o=0;o<r;o++)i[n+o]=e[t+o]}static Copy2(e,t,i,n,r){for(let o=0;o<r;o++)i[n+o]=e[t+o]}}class Mte{constructor(){this.m_changes=[],this.m_originalStart=1073741824,this.m_modifiedStart=1073741824,this.m_originalCount=0,this.m_modifiedCount=0}MarkNextChange(){(this.m_originalCount>0||this.m_modifiedCount>0)&&this.m_changes.push(new bp(this.m_originalStart,this.m_originalCount,this.m_modifiedStart,this.m_modifiedCount)),this.m_originalCount=0,this.m_modifiedCount=0,this.m_originalStart=1073741824,this.m_modifiedStart=1073741824}AddOriginalElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,t),this.m_originalCount++}AddModifiedElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,t),this.m_modifiedCount++}getChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes}getReverseChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes.reverse(),this.m_changes}}class ch{constructor(e,t,i=null){this.ContinueProcessingPredicate=i,this._originalSequence=e,this._modifiedSequence=t;const[n,r,o]=ch._getElements(e),[a,l,c]=ch._getElements(t);this._hasStrings=o&&c,this._originalStringElements=n,this._originalElementsOrHash=r,this._modifiedStringElements=a,this._modifiedElementsOrHash=l,this.m_forwardHistory=[],this.m_reverseHistory=[]}static _isStringArray(e){return e.length>0&&typeof e[0]=="string"}static _getElements(e){const t=e.getElements();if(ch._isStringArray(t)){const i=new Int32Array(t.length);for(let n=0,r=t.length;n<r;n++)i[n]=Vq(t[n],0);return[t,i,!0]}return t instanceof Int32Array?[[],t,!1]:[[],new Int32Array(t),!1]}ElementsAreEqual(e,t){return this._originalElementsOrHash[e]!==this._modifiedElementsOrHash[t]?!1:this._hasStrings?this._originalStringElements[e]===this._modifiedStringElements[t]:!0}ElementsAreStrictEqual(e,t){if(!this.ElementsAreEqual(e,t))return!1;const i=ch._getStrictElement(this._originalSequence,e),n=ch._getStrictElement(this._modifiedSequence,t);return i===n}static _getStrictElement(e,t){return typeof e.getStrictElement=="function"?e.getStrictElement(t):null}OriginalElementsAreEqual(e,t){return this._originalElementsOrHash[e]!==this._originalElementsOrHash[t]?!1:this._hasStrings?this._originalStringElements[e]===this._originalStringElements[t]:!0}ModifiedElementsAreEqual(e,t){return this._modifiedElementsOrHash[e]!==this._modifiedElementsOrHash[t]?!1:this._hasStrings?this._modifiedStringElements[e]===this._modifiedStringElements[t]:!0}ComputeDiff(e){return this._ComputeDiff(0,this._originalElementsOrHash.length-1,0,this._modifiedElementsOrHash.length-1,e)}_ComputeDiff(e,t,i,n,r){const o=[!1];let a=this.ComputeDiffRecursive(e,t,i,n,o);return r&&(a=this.PrettifyChanges(a)),{quitEarly:o[0],changes:a}}ComputeDiffRecursive(e,t,i,n,r){for(r[0]=!1;e<=t&&i<=n&&this.ElementsAreEqual(e,i);)e++,i++;for(;t>=e&&n>=i&&this.ElementsAreEqual(t,n);)t--,n--;if(e>t||i>n){let u;return i<=n?(z0.Assert(e===t+1,"originalStart should only be one more than originalEnd"),u=[new bp(e,0,i,n-i+1)]):e<=t?(z0.Assert(i===n+1,"modifiedStart should only be one more than modifiedEnd"),u=[new bp(e,t-e+1,i,0)]):(z0.Assert(e===t+1,"originalStart should only be one more than originalEnd"),z0.Assert(i===n+1,"modifiedStart should only be one more than modifiedEnd"),u=[]),u}const o=[0],a=[0],l=this.ComputeRecursionPoint(e,t,i,n,o,a,r),c=o[0],d=a[0];if(l!==null)return l;if(!r[0]){const u=this.ComputeDiffRecursive(e,c,i,d,r);let h=[];return r[0]?h=[new bp(c+1,t-(c+1)+1,d+1,n-(d+1)+1)]:h=this.ComputeDiffRecursive(c+1,t,d+1,n,r),this.ConcatenateChanges(u,h)}return[new bp(e,t-e+1,i,n-i+1)]}WALKTRACE(e,t,i,n,r,o,a,l,c,d,u,h,g,p,_,v,C,y){let x=null,L=null,I=new Mte,A=t,D=i,N=g[0]-v[0]-n,R=-1073741824,W=this.m_forwardHistory.length-1;do{const H=N+e;H===A||H<D&&c[H-1]<c[H+1]?(u=c[H+1],p=u-N-n,u<R&&I.MarkNextChange(),R=u,I.AddModifiedElement(u+1,p),N=H+1-e):(u=c[H-1]+1,p=u-N-n,u<R&&I.MarkNextChange(),R=u-1,I.AddOriginalElement(u,p+1),N=H-1-e),W>=0&&(c=this.m_forwardHistory[W],e=c[0],A=1,D=c.length-1)}while(--W>=-1);if(x=I.getReverseChanges(),y[0]){let H=g[0]+1,U=v[0]+1;if(x!==null&&x.length>0){const B=x[x.length-1];H=Math.max(H,B.getOriginalEnd()),U=Math.max(U,B.getModifiedEnd())}L=[new bp(H,h-H+1,U,_-U+1)]}else{I=new Mte,A=o,D=a,N=g[0]-v[0]-l,R=1073741824,W=C?this.m_reverseHistory.length-1:this.m_reverseHistory.length-2;do{const H=N+r;H===A||H<D&&d[H-1]>=d[H+1]?(u=d[H+1]-1,p=u-N-l,u>R&&I.MarkNextChange(),R=u+1,I.AddOriginalElement(u+1,p+1),N=H+1-r):(u=d[H-1],p=u-N-l,u>R&&I.MarkNextChange(),R=u,I.AddModifiedElement(u+1,p+1),N=H-1-r),W>=0&&(d=this.m_reverseHistory[W],r=d[0],A=1,D=d.length-1)}while(--W>=-1);L=I.getChanges()}return this.ConcatenateChanges(x,L)}ComputeRecursionPoint(e,t,i,n,r,o,a){let l=0,c=0,d=0,u=0,h=0,g=0;e--,i--,r[0]=0,o[0]=0,this.m_forwardHistory=[],this.m_reverseHistory=[];const p=t-e+(n-i),_=p+1,v=new Int32Array(_),C=new Int32Array(_),y=n-i,x=t-e,L=e-i,I=t-n,D=(x-y)%2===0;v[y]=e,C[x]=t,a[0]=!1;for(let N=1;N<=p/2+1;N++){let R=0,W=0;d=this.ClipDiagonalBound(y-N,N,y,_),u=this.ClipDiagonalBound(y+N,N,y,_);for(let U=d;U<=u;U+=2){U===d||U<u&&v[U-1]<v[U+1]?l=v[U+1]:l=v[U-1]+1,c=l-(U-y)-L;const B=l;for(;l<t&&c<n&&this.ElementsAreEqual(l+1,c+1);)l++,c++;if(v[U]=l,l+c>R+W&&(R=l,W=c),!D&&Math.abs(U-x)<=N-1&&l>=C[U])return r[0]=l,o[0]=c,B<=C[U]&&N<=1448?this.WALKTRACE(y,d,u,L,x,h,g,I,v,C,l,t,r,c,n,o,D,a):null}const H=(R-e+(W-i)-N)/2;if(this.ContinueProcessingPredicate!==null&&!this.ContinueProcessingPredicate(R,H))return a[0]=!0,r[0]=R,o[0]=W,H>0&&N<=1448?this.WALKTRACE(y,d,u,L,x,h,g,I,v,C,l,t,r,c,n,o,D,a):(e++,i++,[new bp(e,t-e+1,i,n-i+1)]);h=this.ClipDiagonalBound(x-N,N,x,_),g=this.ClipDiagonalBound(x+N,N,x,_);for(let U=h;U<=g;U+=2){U===h||U<g&&C[U-1]>=C[U+1]?l=C[U+1]-1:l=C[U-1],c=l-(U-x)-I;const B=l;for(;l>e&&c>i&&this.ElementsAreEqual(l,c);)l--,c--;if(C[U]=l,D&&Math.abs(U-y)<=N&&l<=v[U])return r[0]=l,o[0]=c,B>=v[U]&&N<=1448?this.WALKTRACE(y,d,u,L,x,h,g,I,v,C,l,t,r,c,n,o,D,a):null}if(N<=1447){let U=new Int32Array(u-d+2);U[0]=y-d+1,U0.Copy2(v,d,U,1,u-d+1),this.m_forwardHistory.push(U),U=new Int32Array(g-h+2),U[0]=x-h+1,U0.Copy2(C,h,U,1,g-h+1),this.m_reverseHistory.push(U)}}return this.WALKTRACE(y,d,u,L,x,h,g,I,v,C,l,t,r,c,n,o,D,a)}PrettifyChanges(e){for(let t=0;t<e.length;t++){const i=e[t],n=t<e.length-1?e[t+1].originalStart:this._originalElementsOrHash.length,r=t<e.length-1?e[t+1].modifiedStart:this._modifiedElementsOrHash.length,o=i.originalLength>0,a=i.modifiedLength>0;for(;i.originalStart+i.originalLength<n&&i.modifiedStart+i.modifiedLength<r&&(!o||this.OriginalElementsAreEqual(i.originalStart,i.originalStart+i.originalLength))&&(!a||this.ModifiedElementsAreEqual(i.modifiedStart,i.modifiedStart+i.modifiedLength));){const c=this.ElementsAreStrictEqual(i.originalStart,i.modifiedStart);if(this.ElementsAreStrictEqual(i.originalStart+i.originalLength,i.modifiedStart+i.modifiedLength)&&!c)break;i.originalStart++,i.modifiedStart++}const l=[null];if(t<e.length-1&&this.ChangesOverlap(e[t],e[t+1],l)){e[t]=l[0],e.splice(t+1,1),t--;continue}}for(let t=e.length-1;t>=0;t--){const i=e[t];let n=0,r=0;if(t>0){const u=e[t-1];n=u.originalStart+u.originalLength,r=u.modifiedStart+u.modifiedLength}const o=i.originalLength>0,a=i.modifiedLength>0;let l=0,c=this._boundaryScore(i.originalStart,i.originalLength,i.modifiedStart,i.modifiedLength);for(let u=1;;u++){const h=i.originalStart-u,g=i.modifiedStart-u;if(h<n||g<r||o&&!this.OriginalElementsAreEqual(h,h+i.originalLength)||a&&!this.ModifiedElementsAreEqual(g,g+i.modifiedLength))break;const _=(h===n&&g===r?5:0)+this._boundaryScore(h,i.originalLength,g,i.modifiedLength);_>c&&(c=_,l=u)}i.originalStart-=l,i.modifiedStart-=l;const d=[null];if(t>0&&this.ChangesOverlap(e[t-1],e[t],d)){e[t-1]=d[0],e.splice(t,1),t++;continue}}if(this._hasStrings)for(let t=1,i=e.length;t<i;t++){const n=e[t-1],r=e[t],o=r.originalStart-n.originalStart-n.originalLength,a=n.originalStart,l=r.originalStart+r.originalLength,c=l-a,d=n.modifiedStart,u=r.modifiedStart+r.modifiedLength,h=u-d;if(o<5&&c<20&&h<20){const g=this._findBetterContiguousSequence(a,c,d,h,o);if(g){const[p,_]=g;(p!==n.originalStart+n.originalLength||_!==n.modifiedStart+n.modifiedLength)&&(n.originalLength=p-n.originalStart,n.modifiedLength=_-n.modifiedStart,r.originalStart=p+o,r.modifiedStart=_+o,r.originalLength=l-r.originalStart,r.modifiedLength=u-r.modifiedStart)}}}return e}_findBetterContiguousSequence(e,t,i,n,r){if(t<r||n<r)return null;const o=e+t-r+1,a=i+n-r+1;let l=0,c=0,d=0;for(let u=e;u<o;u++)for(let h=i;h<a;h++){const g=this._contiguousSequenceScore(u,h,r);g>0&&g>l&&(l=g,c=u,d=h)}return l>0?[c,d]:null}_contiguousSequenceScore(e,t,i){let n=0;for(let r=0;r<i;r++){if(!this.ElementsAreEqual(e+r,t+r))return 0;n+=this._originalStringElements[e+r].length}return n}_OriginalIsBoundary(e){return e<=0||e>=this._originalElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._originalStringElements[e])}_OriginalRegionIsBoundary(e,t){if(this._OriginalIsBoundary(e)||this._OriginalIsBoundary(e-1))return!0;if(t>0){const i=e+t;if(this._OriginalIsBoundary(i-1)||this._OriginalIsBoundary(i))return!0}return!1}_ModifiedIsBoundary(e){return e<=0||e>=this._modifiedElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._modifiedStringElements[e])}_ModifiedRegionIsBoundary(e,t){if(this._ModifiedIsBoundary(e)||this._ModifiedIsBoundary(e-1))return!0;if(t>0){const i=e+t;if(this._ModifiedIsBoundary(i-1)||this._ModifiedIsBoundary(i))return!0}return!1}_boundaryScore(e,t,i,n){const r=this._OriginalRegionIsBoundary(e,t)?1:0,o=this._ModifiedRegionIsBoundary(i,n)?1:0;return r+o}ConcatenateChanges(e,t){const i=[];if(e.length===0||t.length===0)return t.length>0?t:e;if(this.ChangesOverlap(e[e.length-1],t[0],i)){const n=new Array(e.length+t.length-1);return U0.Copy(e,0,n,0,e.length-1),n[e.length-1]=i[0],U0.Copy(t,1,n,e.length,t.length-1),n}else{const n=new Array(e.length+t.length);return U0.Copy(e,0,n,0,e.length),U0.Copy(t,0,n,e.length,t.length),n}}ChangesOverlap(e,t,i){if(z0.Assert(e.originalStart<=t.originalStart,"Left change is not less than or equal to right change"),z0.Assert(e.modifiedStart<=t.modifiedStart,"Left change is not less than or equal to right change"),e.originalStart+e.originalLength>=t.originalStart||e.modifiedStart+e.modifiedLength>=t.modifiedStart){const n=e.originalStart;let r=e.originalLength;const o=e.modifiedStart;let a=e.modifiedLength;return e.originalStart+e.originalLength>=t.originalStart&&(r=t.originalStart+t.originalLength-e.originalStart),e.modifiedStart+e.modifiedLength>=t.modifiedStart&&(a=t.modifiedStart+t.modifiedLength-e.modifiedStart),i[0]=new bp(n,r,o,a),!0}else return i[0]=null,!1}ClipDiagonalBound(e,t,i,n){if(e>=0&&e<n)return e;const r=i,o=n-i-1,a=t%2===0;if(e<0){const l=r%2===0;return a===l?0:1}else{const l=o%2===0;return a===l?n-1:n-2}}}function X2(s){return s<0?0:s>255?255:s|0}function j0(s){return s<0?0:s>4294967295?4294967295:s|0}class fS{constructor(e){const t=X2(e);this._defaultValue=t,this._asciiMap=fS._createAsciiMap(t),this._map=new Map}static _createAsciiMap(e){const t=new Uint8Array(256);return t.fill(e),t}set(e,t){const i=X2(t);e>=0&&e<256?this._asciiMap[e]=i:this._map.set(e,i)}get(e){return e>=0&&e<256?this._asciiMap[e]:this._map.get(e)||this._defaultValue}clear(){this._asciiMap.fill(this._defaultValue),this._map.clear()}}class Z2{constructor(){this._actual=new fS(0)}add(e){this._actual.set(e,1)}has(e){return this._actual.get(e)===1}clear(){return this._actual.clear()}}class jPe{constructor(e,t,i){const n=new Uint8Array(e*t);for(let r=0,o=e*t;r<o;r++)n[r]=i;this._data=n,this.rows=e,this.cols=t}get(e,t){return this._data[e*this.cols+t]}set(e,t,i){this._data[e*this.cols+t]=i}}class $Pe{constructor(e){let t=0,i=0;for(let r=0,o=e.length;r<o;r++){const[a,l,c]=e[r];l>t&&(t=l),a>i&&(i=a),c>i&&(i=c)}t++,i++;const n=new jPe(i,t,0);for(let r=0,o=e.length;r<o;r++){const[a,l,c]=e[r];n.set(a,l,c)}this._states=n,this._maxCharCode=t}nextState(e,t){return t<0||t>=this._maxCharCode?0:this._states.get(e,t)}}let mV=null;function qPe(){return mV===null&&(mV=new $Pe([[1,104,2],[1,72,2],[1,102,6],[1,70,6],[2,116,3],[2,84,3],[3,116,4],[3,84,4],[4,112,5],[4,80,5],[5,115,9],[5,83,9],[5,58,10],[6,105,7],[6,73,7],[7,108,8],[7,76,8],[8,101,9],[8,69,9],[9,58,10],[10,47,11],[11,47,12]])),mV}let Sx=null;function KPe(){if(Sx===null){Sx=new fS(0);const s=` 	<>'"、。｡､，．：；‘〈「『〔（［｛｢｣｝］）〕』」〉’｀～…`;for(let t=0;t<s.length;t++)Sx.set(s.charCodeAt(t),1);const e=".,;:";for(let t=0;t<e.length;t++)Sx.set(e.charCodeAt(t),2)}return Sx}class J2{static _createLink(e,t,i,n,r){let o=r-1;do{const a=t.charCodeAt(o);if(e.get(a)!==2)break;o--}while(o>n);if(n>0){const a=t.charCodeAt(n-1),l=t.charCodeAt(o);(a===40&&l===41||a===91&&l===93||a===123&&l===125)&&o--}return{range:{startLineNumber:i,startColumn:n+1,endLineNumber:i,endColumn:o+2},url:t.substring(n,o+1)}}static computeLinks(e,t=qPe()){const i=KPe(),n=[];for(let r=1,o=e.getLineCount();r<=o;r++){const a=e.getLineContent(r),l=a.length;let c=0,d=0,u=0,h=1,g=!1,p=!1,_=!1,v=!1;for(;c<l;){let C=!1;const y=a.charCodeAt(c);if(h===13){let x;switch(y){case 40:g=!0,x=0;break;case 41:x=g?0:1;break;case 91:_=!0,p=!0,x=0;break;case 93:_=!1,x=p?0:1;break;case 123:v=!0,x=0;break;case 125:x=v?0:1;break;case 39:case 34:case 96:u===y?x=1:u===39||u===34||u===96?x=0:x=1;break;case 42:x=u===42?1:0;break;case 124:x=u===124?1:0;break;case 32:x=_?0:1;break;default:x=i.get(y)}x===1&&(n.push(J2._createLink(i,a,r,d,c)),C=!0)}else if(h===12){let x;y===91?(p=!0,x=0):x=i.get(y),x===1?C=!0:h=13}else h=t.nextState(h,y),h===0&&(C=!0);C&&(h=1,g=!1,p=!1,v=!1,d=c+1,u=y),c++}h===13&&n.push(J2._createLink(i,a,r,d,l))}return n}}function GPe(s){return!s||typeof s.getLineCount!="function"||typeof s.getLineContent!="function"?[]:J2.computeLinks(s)}const VM=class VM{constructor(){this._defaultValueSet=[["true","false"],["True","False"],["Private","Public","Friend","ReadOnly","Partial","Protected","WriteOnly"],["public","protected","private"]]}navigateValueSet(e,t,i,n,r){if(e&&t){const o=this.doNavigateValueSet(t,r);if(o)return{range:e,value:o}}if(i&&n){const o=this.doNavigateValueSet(n,r);if(o)return{range:i,value:o}}return null}doNavigateValueSet(e,t){const i=this.numberReplace(e,t);return i!==null?i:this.textReplace(e,t)}numberReplace(e,t){const i=Math.pow(10,e.length-(e.lastIndexOf(".")+1));let n=Number(e);const r=parseFloat(e);return!isNaN(n)&&!isNaN(r)&&n===r?n===0&&!t?null:(n=Math.floor(n*i),n+=t?i:-i,String(n/i)):null}textReplace(e,t){return this.valueSetsReplace(this._defaultValueSet,e,t)}valueSetsReplace(e,t,i){let n=null;for(let r=0,o=e.length;n===null&&r<o;r++)n=this.valueSetReplace(e[r],t,i);return n}valueSetReplace(e,t,i){let n=e.indexOf(t);return n>=0?(n+=i?1:-1,n<0?n=e.length-1:n%=e.length,e[n]):null}};VM.INSTANCE=new VM;let l6=VM;const bk=class bk{static getChannel(e){return e.getChannel(bk.CHANNEL_NAME)}static setChannel(e,t){e.setChannel(bk.CHANNEL_NAME,t)}};bk.CHANNEL_NAME="editorWorkerHost";let c6=bk;var Ote,Fte;class QPe{constructor(e,t){this.uri=e,this.value=t}}function YPe(s){return Array.isArray(s)}const Tb=class Tb{constructor(e,t){if(this[Ote]="ResourceMap",e instanceof Tb)this.map=new Map(e.map),this.toKey=t??Tb.defaultToKey;else if(YPe(e)){this.map=new Map,this.toKey=t??Tb.defaultToKey;for(const[i,n]of e)this.set(i,n)}else this.map=new Map,this.toKey=e??Tb.defaultToKey}set(e,t){return this.map.set(this.toKey(e),new QPe(e,t)),this}get(e){var t;return(t=this.map.get(this.toKey(e)))==null?void 0:t.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,t){typeof t<"u"&&(e=e.bind(t));for(const[i,n]of this.map)e(n.value,n.uri,this)}*values(){for(const e of this.map.values())yield e.value}*keys(){for(const e of this.map.values())yield e.uri}*entries(){for(const e of this.map.values())yield[e.uri,e.value]}*[(Ote=Symbol.toStringTag,Symbol.iterator)](){for(const[,e]of this.map)yield[e.uri,e.value]}};Tb.defaultToKey=e=>e.toString();let Fs=Tb;class XPe{constructor(){this[Fte]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return(e=this._head)==null?void 0:e.value}get last(){var e;return(e=this._tail)==null?void 0:e.value}has(e){return this._map.has(e)}get(e,t=0){const i=this._map.get(e);if(i)return t!==0&&this.touch(i,t),i.value}set(e,t,i=0){let n=this._map.get(e);if(n)n.value=t,i!==0&&this.touch(n,i);else{switch(n={key:e,value:t,next:void 0,previous:void 0},i){case 0:this.addItemLast(n);break;case 1:this.addItemFirst(n);break;case 2:this.addItemLast(n);break;default:this.addItemLast(n);break}this._map.set(e,n),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){const i=this._state;let n=this._head;for(;n;){if(t?e.bind(t)(n.value,n.key,this):e(n.value,n.key,this),this._state!==i)throw new Error("LinkedMap got modified during iteration.");n=n.next}}keys(){const e=this,t=this._state;let i=this._head;const n={[Symbol.iterator](){return n},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const r={value:i.key,done:!1};return i=i.next,r}else return{value:void 0,done:!0}}};return n}values(){const e=this,t=this._state;let i=this._head;const n={[Symbol.iterator](){return n},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const r={value:i.value,done:!1};return i=i.next,r}else return{value:void 0,done:!0}}};return n}entries(){const e=this,t=this._state;let i=this._head;const n={[Symbol.iterator](){return n},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const r={value:[i.key,i.value],done:!1};return i=i.next,r}else return{value:void 0,done:!0}}};return n}[(Fte=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,i=this.size;for(;t&&i>e;)this._map.delete(t.key),t=t.next,i--;this._head=t,this._size=i,t&&(t.previous=void 0),this._state++}trimNew(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._tail,i=this.size;for(;t&&i>e;)this._map.delete(t.key),t=t.previous,i--;this._tail=t,this._size=i,t&&(t.next=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const t=e.next,i=e.previous;if(!t||!i)throw new Error("Invalid list");t.previous=i,i.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==1&&t!==2)){if(t===1){if(e===this._head)return;const i=e.next,n=e.previous;e===this._tail?(n.next=void 0,this._tail=n):(i.previous=n,n.next=i),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===2){if(e===this._tail)return;const i=e.next,n=e.previous;e===this._head?(i.previous=void 0,this._head=i):(i.previous=n,n.next=i),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){const e=[];return this.forEach((t,i)=>{e.push([i,t])}),e}fromJSON(e){this.clear();for(const[t,i]of e)this.set(t,i)}}class ZPe extends XPe{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get(e,t=2){return super.get(e,t)}peek(e){return super.get(e,0)}set(e,t){return super.set(e,t,2),this}checkTrim(){this.size>this._limit&&this.trim(Math.round(this._limit*this._ratio))}}class $h extends ZPe{constructor(e,t=1){super(e,t)}trim(e){this.trimOld(e)}set(e,t){return super.set(e,t),this.checkTrim(),this}}class JPe{constructor(e){if(this._m1=new Map,this._m2=new Map,e)for(const[t,i]of e)this.set(t,i)}clear(){this._m1.clear(),this._m2.clear()}set(e,t){this._m1.set(e,t),this._m2.set(t,e)}get(e){return this._m1.get(e)}getKey(e){return this._m2.get(e)}delete(e){const t=this._m1.get(e);return t===void 0?!1:(this._m1.delete(e),this._m2.delete(t),!0)}keys(){return this._m1.keys()}values(){return this._m1.values()}}class Gq{constructor(){this.map=new Map}add(e,t){let i=this.map.get(e);i||(i=new Set,this.map.set(e,i)),i.add(t)}delete(e,t){const i=this.map.get(e);i&&(i.delete(t),i.size===0&&this.map.delete(e))}forEach(e,t){const i=this.map.get(e);i&&i.forEach(t)}get(e){const t=this.map.get(e);return t||new Set}}class eMe extends fS{constructor(e,t){super(0),this._segmenter=null,this._cachedLine=null,this._cachedSegments=[],this.intlSegmenterLocales=t,this.intlSegmenterLocales.length>0?this._segmenter=new Intl.Segmenter(this.intlSegmenterLocales,{granularity:"word"}):this._segmenter=null;for(let i=0,n=e.length;i<n;i++)this.set(e.charCodeAt(i),2);this.set(32,1),this.set(9,1)}findPrevIntlWordBeforeOrAtOffset(e,t){let i=null;for(const n of this._getIntlSegmenterWordsOnLine(e)){if(n.index>t)break;i=n}return i}findNextIntlWordAtOrAfterOffset(e,t){for(const i of this._getIntlSegmenterWordsOnLine(e))if(!(i.index<t))return i;return null}_getIntlSegmenterWordsOnLine(e){return this._segmenter?this._cachedLine===e?this._cachedSegments:(this._cachedLine=e,this._cachedSegments=this._filterWordSegments(this._segmenter.segment(e)),this._cachedSegments):[]}_filterWordSegments(e){const t=[];for(const i of e)this._isWordLike(i)&&t.push(i);return t}_isWordLike(e){return!!e.isWordLike}}const Vte=new $h(10);function wc(s,e){const t=`${s}/${e.join(",")}`;let i=Vte.get(t);return i||(i=new eMe(s,e),Vte.set(t,i)),i}var Il;(function(s){s[s.Left=1]="Left",s[s.Center=2]="Center",s[s.Right=4]="Right",s[s.Full=7]="Full"})(Il||(Il={}));var ld;(function(s){s[s.Left=1]="Left",s[s.Center=2]="Center",s[s.Right=3]="Right"})(ld||(ld={}));var Zc;(function(s){s[s.Both=0]="Both",s[s.Right=1]="Right",s[s.Left=2]="Left",s[s.None=3]="None"})(Zc||(Zc={}));class LR{get originalIndentSize(){return this._indentSizeIsTabSize?"tabSize":this.indentSize}constructor(e){this._textModelResolvedOptionsBrand=void 0,this.tabSize=Math.max(1,e.tabSize|0),e.indentSize==="tabSize"?(this.indentSize=this.tabSize,this._indentSizeIsTabSize=!0):(this.indentSize=Math.max(1,e.indentSize|0),this._indentSizeIsTabSize=!1),this.insertSpaces=!!e.insertSpaces,this.defaultEOL=e.defaultEOL|0,this.trimAutoWhitespace=!!e.trimAutoWhitespace,this.bracketPairColorizationOptions=e.bracketPairColorizationOptions}equals(e){return this.tabSize===e.tabSize&&this._indentSizeIsTabSize===e._indentSizeIsTabSize&&this.indentSize===e.indentSize&&this.insertSpaces===e.insertSpaces&&this.defaultEOL===e.defaultEOL&&this.trimAutoWhitespace===e.trimAutoWhitespace&&Ta(this.bracketPairColorizationOptions,e.bracketPairColorizationOptions)}createChangeEvent(e){return{tabSize:this.tabSize!==e.tabSize,indentSize:this.indentSize!==e.indentSize,insertSpaces:this.insertSpaces!==e.insertSpaces,trimAutoWhitespace:this.trimAutoWhitespace!==e.trimAutoWhitespace}}}class rI{constructor(e,t){this._findMatchBrand=void 0,this.range=e,this.matches=t}}function tMe(s){return s&&typeof s.read=="function"}class _V{constructor(e,t,i,n,r,o){this.identifier=e,this.range=t,this.text=i,this.forceMoveMarkers=n,this.isAutoWhitespaceEdit=r,this._isTracked=o}}class iMe{constructor(e,t,i){this.regex=e,this.wordSeparators=t,this.simpleSearch=i}}class nMe{constructor(e,t,i){this.reverseEdits=e,this.changes=t,this.trimAutoWhitespaceLineNumbers=i}}function Nhe(s){return!s.isTooLargeForSyncing()&&!s.isForSimpleWidget}const sMe=999;class ob{constructor(e,t,i,n){this.searchString=e,this.isRegex=t,this.matchCase=i,this.wordSeparators=n}parseSearchRequest(){if(this.searchString==="")return null;let e;this.isRegex?e=rMe(this.searchString):e=this.searchString.indexOf(`
`)>=0;let t=null;try{t=Due(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:e,global:!0,unicode:!0})}catch{return null}if(!t)return null;let i=!this.isRegex&&!e;return i&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(i=this.matchCase),new iMe(t,this.wordSeparators?wc(this.wordSeparators,[]):null,i?this.searchString:null)}}function rMe(s){if(!s||s.length===0)return!1;for(let e=0,t=s.length;e<t;e++){const i=s.charCodeAt(e);if(i===10)return!0;if(i===92){if(e++,e>=t)break;const n=s.charCodeAt(e);if(n===110||n===114||n===87)return!0}}return!1}function mb(s,e,t){if(!t)return new rI(s,null);const i=[];for(let n=0,r=e.length;n<r;n++)i[n]=e[n];return new rI(s,i)}class Bte{constructor(e){const t=[];let i=0;for(let n=0,r=e.length;n<r;n++)e.charCodeAt(n)===10&&(t[i++]=n);this._lineFeedsOffsets=t}findLineFeedCountBeforeOffset(e){const t=this._lineFeedsOffsets;let i=0,n=t.length-1;if(n===-1||e<=t[0])return 0;for(;i<n;){const r=i+((n-i)/2>>0);t[r]>=e?n=r-1:t[r+1]>=e?(i=r,n=r):i=r+1}return i+1}}class nN{static findMatches(e,t,i,n,r){const o=t.parseSearchRequest();return o?o.regex.multiline?this._doFindMatchesMultiline(e,i,new kC(o.wordSeparators,o.regex),n,r):this._doFindMatchesLineByLine(e,i,o,n,r):[]}static _getMultilineMatchRange(e,t,i,n,r,o){let a,l=0;n?(l=n.findLineFeedCountBeforeOffset(r),a=t+r+l):a=t+r;let c;if(n){const g=n.findLineFeedCountBeforeOffset(r+o.length)-l;c=a+o.length+g}else c=a+o.length;const d=e.getPositionAt(a),u=e.getPositionAt(c);return new F(d.lineNumber,d.column,u.lineNumber,u.column)}static _doFindMatchesMultiline(e,t,i,n,r){const o=e.getOffsetAt(t.getStartPosition()),a=e.getValueInRange(t,1),l=e.getEOL()===`\r
`?new Bte(a):null,c=[];let d=0,u;for(i.reset(0);u=i.next(a);)if(c[d++]=mb(this._getMultilineMatchRange(e,o,a,l,u.index,u[0]),u,n),d>=r)return c;return c}static _doFindMatchesLineByLine(e,t,i,n,r){const o=[];let a=0;if(t.startLineNumber===t.endLineNumber){const c=e.getLineContent(t.startLineNumber).substring(t.startColumn-1,t.endColumn-1);return a=this._findMatchesInLine(i,c,t.startLineNumber,t.startColumn-1,a,o,n,r),o}const l=e.getLineContent(t.startLineNumber).substring(t.startColumn-1);a=this._findMatchesInLine(i,l,t.startLineNumber,t.startColumn-1,a,o,n,r);for(let c=t.startLineNumber+1;c<t.endLineNumber&&a<r;c++)a=this._findMatchesInLine(i,e.getLineContent(c),c,0,a,o,n,r);if(a<r){const c=e.getLineContent(t.endLineNumber).substring(0,t.endColumn-1);a=this._findMatchesInLine(i,c,t.endLineNumber,0,a,o,n,r)}return o}static _findMatchesInLine(e,t,i,n,r,o,a,l){const c=e.wordSeparators;if(!a&&e.simpleSearch){const h=e.simpleSearch,g=h.length,p=t.length;let _=-g;for(;(_=t.indexOf(h,_+g))!==-1;)if((!c||Qq(c,t,p,_,g))&&(o[r++]=new rI(new F(i,_+1+n,i,_+1+g+n),null),r>=l))return r;return r}const d=new kC(e.wordSeparators,e.regex);let u;d.reset(0);do if(u=d.next(t),u&&(o[r++]=mb(new F(i,u.index+1+n,i,u.index+1+u[0].length+n),u,a),r>=l))return r;while(u);return r}static findNextMatch(e,t,i,n){const r=t.parseSearchRequest();if(!r)return null;const o=new kC(r.wordSeparators,r.regex);return r.regex.multiline?this._doFindNextMatchMultiline(e,i,o,n):this._doFindNextMatchLineByLine(e,i,o,n)}static _doFindNextMatchMultiline(e,t,i,n){const r=new X(t.lineNumber,1),o=e.getOffsetAt(r),a=e.getLineCount(),l=e.getValueInRange(new F(r.lineNumber,r.column,a,e.getLineMaxColumn(a)),1),c=e.getEOL()===`\r
`?new Bte(l):null;i.reset(t.column-1);const d=i.next(l);return d?mb(this._getMultilineMatchRange(e,o,l,c,d.index,d[0]),d,n):t.lineNumber!==1||t.column!==1?this._doFindNextMatchMultiline(e,new X(1,1),i,n):null}static _doFindNextMatchLineByLine(e,t,i,n){const r=e.getLineCount(),o=t.lineNumber,a=e.getLineContent(o),l=this._findFirstMatchInLine(i,a,o,t.column,n);if(l)return l;for(let c=1;c<=r;c++){const d=(o+c-1)%r,u=e.getLineContent(d+1),h=this._findFirstMatchInLine(i,u,d+1,1,n);if(h)return h}return null}static _findFirstMatchInLine(e,t,i,n,r){e.reset(n-1);const o=e.next(t);return o?mb(new F(i,o.index+1,i,o.index+1+o[0].length),o,r):null}static findPreviousMatch(e,t,i,n){const r=t.parseSearchRequest();if(!r)return null;const o=new kC(r.wordSeparators,r.regex);return r.regex.multiline?this._doFindPreviousMatchMultiline(e,i,o,n):this._doFindPreviousMatchLineByLine(e,i,o,n)}static _doFindPreviousMatchMultiline(e,t,i,n){const r=this._doFindMatchesMultiline(e,new F(1,1,t.lineNumber,t.column),i,n,10*sMe);if(r.length>0)return r[r.length-1];const o=e.getLineCount();return t.lineNumber!==o||t.column!==e.getLineMaxColumn(o)?this._doFindPreviousMatchMultiline(e,new X(o,e.getLineMaxColumn(o)),i,n):null}static _doFindPreviousMatchLineByLine(e,t,i,n){const r=e.getLineCount(),o=t.lineNumber,a=e.getLineContent(o).substring(0,t.column-1),l=this._findLastMatchInLine(i,a,o,n);if(l)return l;for(let c=1;c<=r;c++){const d=(r+o-c-1)%r,u=e.getLineContent(d+1),h=this._findLastMatchInLine(i,u,d+1,n);if(h)return h}return null}static _findLastMatchInLine(e,t,i,n){let r=null,o;for(e.reset(0);o=e.next(t);)r=mb(new F(i,o.index+1,i,o.index+1+o[0].length),o,n);return r}}function oMe(s,e,t,i,n){if(i===0)return!0;const r=e.charCodeAt(i-1);if(s.get(r)!==0||r===13||r===10)return!0;if(n>0){const o=e.charCodeAt(i);if(s.get(o)!==0)return!0}return!1}function aMe(s,e,t,i,n){if(i+n===t)return!0;const r=e.charCodeAt(i+n);if(s.get(r)!==0||r===13||r===10)return!0;if(n>0){const o=e.charCodeAt(i+n-1);if(s.get(o)!==0)return!0}return!1}function Qq(s,e,t,i,n){return oMe(s,e,t,i,n)&&aMe(s,e,t,i,n)}class kC{constructor(e,t){this._wordSeparators=e,this._searchRegex=t,this._prevMatchStartIndex=-1,this._prevMatchLength=0}reset(e){this._searchRegex.lastIndex=e,this._prevMatchStartIndex=-1,this._prevMatchLength=0}next(e){const t=e.length;let i;do{if(this._prevMatchStartIndex+this._prevMatchLength===t||(i=this._searchRegex.exec(e),!i))return null;const n=i.index,r=i[0].length;if(n===this._prevMatchStartIndex&&r===this._prevMatchLength){if(r===0){W2(e,t,this._searchRegex.lastIndex)>65535?this._searchRegex.lastIndex+=2:this._searchRegex.lastIndex+=1;continue}return null}if(this._prevMatchStartIndex=n,this._prevMatchLength=r,!this._wordSeparators||Qq(this._wordSeparators,e,t,n,r))return i}while(i);return null}}class Yq{static computeUnicodeHighlights(e,t,i){const n=i?i.startLineNumber:1,r=i?i.endLineNumber:e.getLineCount(),o=new Wte(t),a=o.getCandidateCodePoints();let l;a==="allNonBasicAscii"?l=new RegExp("[^\\t\\n\\r\\x20-\\x7E]","g"):l=new RegExp(`${lMe(Array.from(a))}`,"g");const c=new kC(null,l),d=[];let u=!1,h,g=0,p=0,_=0;e:for(let v=n,C=r;v<=C;v++){const y=e.getLineContent(v),x=y.length;c.reset(0);do if(h=c.next(y),h){let L=h.index,I=h.index+h[0].length;if(L>0){const R=y.charCodeAt(L-1);ws(R)&&L--}if(I+1<x){const R=y.charCodeAt(I-1);ws(R)&&I++}const A=y.substring(L,I);let D=Gk(L+1,wq,y,0);D&&D.endColumn<=L+1&&(D=null);const N=o.shouldHighlightNonBasicASCII(A,D?D.word:null);if(N!==0){if(N===3?g++:N===2?p++:N===1?_++:gF(),d.length>=1e3){u=!0;break e}d.push(new F(v,L+1,v,I+1))}}while(h)}return{ranges:d,hasMore:u,ambiguousCharacterCount:g,invisibleCharacterCount:p,nonBasicAsciiCharacterCount:_}}static computeUnicodeHighlightReason(e,t){const i=new Wte(t);switch(i.shouldHighlightNonBasicASCII(e,null)){case 0:return null;case 2:return{kind:1};case 3:{const r=e.codePointAt(0),o=i.ambiguousCharacters.getPrimaryConfusable(r),a=tI.getLocales().filter(l=>!tI.getInstance(new Set([...t.allowedLocales,l])).isAmbiguous(r));return{kind:0,confusableWith:String.fromCodePoint(o),notAmbiguousInLocales:a}}case 1:return{kind:2}}}}function lMe(s,e){return`[${Nl(s.map(i=>String.fromCodePoint(i)).join(""))}]`}class Wte{constructor(e){this.options=e,this.allowedCodePoints=new Set(e.allowedCodePoints),this.ambiguousCharacters=tI.getInstance(new Set(e.allowedLocales))}getCandidateCodePoints(){if(this.options.nonBasicASCII)return"allNonBasicAscii";const e=new Set;if(this.options.invisibleCharacters)for(const t of Gb.codePoints)Hte(String.fromCodePoint(t))||e.add(t);if(this.options.ambiguousCharacters)for(const t of this.ambiguousCharacters.getConfusableCodePoints())e.add(t);for(const t of this.allowedCodePoints)e.delete(t);return e}shouldHighlightNonBasicASCII(e,t){const i=e.codePointAt(0);if(this.allowedCodePoints.has(i))return 0;if(this.options.nonBasicASCII)return 1;let n=!1,r=!1;if(t)for(const o of t){const a=o.codePointAt(0),l=zE(o);n=n||l,!l&&!this.ambiguousCharacters.isAmbiguous(a)&&!Gb.isInvisibleCharacter(a)&&(r=!0)}return!n&&r?0:this.options.invisibleCharacters&&!Hte(e)&&Gb.isInvisibleCharacter(i)?2:this.options.ambiguousCharacters&&this.ambiguousCharacters.isAmbiguous(i)?3:0}}function Hte(s){return s===" "||s===`
`||s==="	"}class kR{constructor(e,t,i){this.changes=e,this.moves=t,this.hitTimeout=i}}class Rhe{constructor(e,t){this.lineRangeMapping=e,this.changes=t}}class Mt{static addRange(e,t){let i=0;for(;i<t.length&&t[i].endExclusive<e.start;)i++;let n=i;for(;n<t.length&&t[n].start<=e.endExclusive;)n++;if(i===n)t.splice(i,0,e);else{const r=Math.min(e.start,t[i].start),o=Math.max(e.endExclusive,t[n-1].endExclusive);t.splice(i,n-i,new Mt(r,o))}}static tryCreate(e,t){if(!(e>t))return new Mt(e,t)}static ofLength(e){return new Mt(0,e)}static ofStartAndLength(e,t){return new Mt(e,e+t)}constructor(e,t){if(this.start=e,this.endExclusive=t,e>t)throw new di(`Invalid range: ${this.toString()}`)}get isEmpty(){return this.start===this.endExclusive}delta(e){return new Mt(this.start+e,this.endExclusive+e)}deltaStart(e){return new Mt(this.start+e,this.endExclusive)}deltaEnd(e){return new Mt(this.start,this.endExclusive+e)}get length(){return this.endExclusive-this.start}toString(){return`[${this.start}, ${this.endExclusive})`}contains(e){return this.start<=e&&e<this.endExclusive}join(e){return new Mt(Math.min(this.start,e.start),Math.max(this.endExclusive,e.endExclusive))}intersect(e){const t=Math.max(this.start,e.start),i=Math.min(this.endExclusive,e.endExclusive);if(t<=i)return new Mt(t,i)}intersects(e){const t=Math.max(this.start,e.start),i=Math.min(this.endExclusive,e.endExclusive);return t<i}isBefore(e){return this.endExclusive<=e.start}isAfter(e){return this.start>=e.endExclusive}slice(e){return e.slice(this.start,this.endExclusive)}substring(e){return e.substring(this.start,this.endExclusive)}clip(e){if(this.isEmpty)throw new di(`Invalid clipping range: ${this.toString()}`);return Math.max(this.start,Math.min(this.endExclusive-1,e))}clipCyclic(e){if(this.isEmpty)throw new di(`Invalid clipping range: ${this.toString()}`);return e<this.start?this.endExclusive-(this.start-e)%this.length:e>=this.endExclusive?this.start+(e-this.start)%this.length:e}forEach(e){for(let t=this.start;t<this.endExclusive;t++)e(t)}}class Xq{constructor(){this._sortedRanges=[]}addRange(e){let t=0;for(;t<this._sortedRanges.length&&this._sortedRanges[t].endExclusive<e.start;)t++;let i=t;for(;i<this._sortedRanges.length&&this._sortedRanges[i].start<=e.endExclusive;)i++;if(t===i)this._sortedRanges.splice(t,0,e);else{const n=Math.min(e.start,this._sortedRanges[t].start),r=Math.max(e.endExclusive,this._sortedRanges[i-1].endExclusive);this._sortedRanges.splice(t,i-t,new Mt(n,r))}}toString(){return this._sortedRanges.map(e=>e.toString()).join(", ")}intersectsStrict(e){let t=0;for(;t<this._sortedRanges.length&&this._sortedRanges[t].endExclusive<=e.start;)t++;return t<this._sortedRanges.length&&this._sortedRanges[t].start<e.endExclusive}intersectWithRange(e){const t=new Xq;for(const i of this._sortedRanges){const n=i.intersect(e);n&&t.addRange(n)}return t}intersectWithRangeLength(e){return this.intersectWithRange(e).length}get length(){return this._sortedRanges.reduce((e,t)=>e+t.length,0)}}function oI(s,e){const t=cMe(s,e);if(t!==-1)return s[t]}function cMe(s,e,t=s.length-1){for(let i=t;i>=0;i--){const n=s[i];if(e(n))return i}return-1}function p1(s,e){const t=aI(s,e);return t===-1?void 0:s[t]}function aI(s,e,t=0,i=s.length){let n=t,r=i;for(;n<r;){const o=Math.floor((n+r)/2);e(s[o])?n=o+1:r=o}return n-1}function dMe(s,e){const t=lI(s,e);return t===s.length?void 0:s[t]}function lI(s,e,t=0,i=s.length){let n=t,r=i;for(;n<r;){const o=Math.floor((n+r)/2);e(s[o])?r=o:n=o+1}return n}const BM=class BM{constructor(e){this._array=e,this._findLastMonotonousLastIdx=0}findLastMonotonous(e){if(BM.assertInvariants){if(this._prevFindLastPredicate){for(const i of this._array)if(this._prevFindLastPredicate(i)&&!e(i))throw new Error("MonotonousArray: current predicate must be weaker than (or equal to) the previous predicate.")}this._prevFindLastPredicate=e}const t=aI(this._array,e,this._findLastMonotonousLastIdx);return this._findLastMonotonousLastIdx=t+1,t===-1?void 0:this._array[t]}};BM.assertInvariants=!1;let eA=BM;function Zq(s,e){if(s.length===0)return;let t=s[0];for(let i=1;i<s.length;i++){const n=s[i];e(n,t)>0&&(t=n)}return t}function uMe(s,e){if(s.length===0)return;let t=s[0];for(let i=1;i<s.length;i++){const n=s[i];e(n,t)>=0&&(t=n)}return t}function hMe(s,e){return Zq(s,(t,i)=>-e(t,i))}function fMe(s,e){if(s.length===0)return-1;let t=0;for(let i=1;i<s.length;i++){const n=s[i];e(n,s[t])>0&&(t=i)}return t}function gMe(s,e){for(const t of s){const i=e(t);if(i!==void 0)return i}}let Ct=class mf{static fromRangeInclusive(e){return new mf(e.startLineNumber,e.endLineNumber+1)}static joinMany(e){if(e.length===0)return[];let t=new lc(e[0].slice());for(let i=1;i<e.length;i++)t=t.getUnion(new lc(e[i].slice()));return t.ranges}static join(e){if(e.length===0)throw new di("lineRanges cannot be empty");let t=e[0].startLineNumber,i=e[0].endLineNumberExclusive;for(let n=1;n<e.length;n++)t=Math.min(t,e[n].startLineNumber),i=Math.max(i,e[n].endLineNumberExclusive);return new mf(t,i)}static ofLength(e,t){return new mf(e,e+t)}static deserialize(e){return new mf(e[0],e[1])}constructor(e,t){if(e>t)throw new di(`startLineNumber ${e} cannot be after endLineNumberExclusive ${t}`);this.startLineNumber=e,this.endLineNumberExclusive=t}contains(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}get isEmpty(){return this.startLineNumber===this.endLineNumberExclusive}delta(e){return new mf(this.startLineNumber+e,this.endLineNumberExclusive+e)}deltaLength(e){return new mf(this.startLineNumber,this.endLineNumberExclusive+e)}get length(){return this.endLineNumberExclusive-this.startLineNumber}join(e){return new mf(Math.min(this.startLineNumber,e.startLineNumber),Math.max(this.endLineNumberExclusive,e.endLineNumberExclusive))}toString(){return`[${this.startLineNumber},${this.endLineNumberExclusive})`}intersect(e){const t=Math.max(this.startLineNumber,e.startLineNumber),i=Math.min(this.endLineNumberExclusive,e.endLineNumberExclusive);if(t<=i)return new mf(t,i)}intersectsStrict(e){return this.startLineNumber<e.endLineNumberExclusive&&e.startLineNumber<this.endLineNumberExclusive}overlapOrTouch(e){return this.startLineNumber<=e.endLineNumberExclusive&&e.startLineNumber<=this.endLineNumberExclusive}equals(e){return this.startLineNumber===e.startLineNumber&&this.endLineNumberExclusive===e.endLineNumberExclusive}toInclusiveRange(){return this.isEmpty?null:new F(this.startLineNumber,1,this.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER)}toExclusiveRange(){return new F(this.startLineNumber,1,this.endLineNumberExclusive,1)}mapToLineArray(e){const t=[];for(let i=this.startLineNumber;i<this.endLineNumberExclusive;i++)t.push(e(i));return t}forEach(e){for(let t=this.startLineNumber;t<this.endLineNumberExclusive;t++)e(t)}serialize(){return[this.startLineNumber,this.endLineNumberExclusive]}includes(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}toOffsetRange(){return new Mt(this.startLineNumber-1,this.endLineNumberExclusive-1)}};class lc{constructor(e=[]){this._normalizedRanges=e}get ranges(){return this._normalizedRanges}addRange(e){if(e.length===0)return;const t=lI(this._normalizedRanges,n=>n.endLineNumberExclusive>=e.startLineNumber),i=aI(this._normalizedRanges,n=>n.startLineNumber<=e.endLineNumberExclusive)+1;if(t===i)this._normalizedRanges.splice(t,0,e);else if(t===i-1){const n=this._normalizedRanges[t];this._normalizedRanges[t]=n.join(e)}else{const n=this._normalizedRanges[t].join(this._normalizedRanges[i-1]).join(e);this._normalizedRanges.splice(t,i-t,n)}}contains(e){const t=p1(this._normalizedRanges,i=>i.startLineNumber<=e);return!!t&&t.endLineNumberExclusive>e}intersects(e){const t=p1(this._normalizedRanges,i=>i.startLineNumber<e.endLineNumberExclusive);return!!t&&t.endLineNumberExclusive>e.startLineNumber}getUnion(e){if(this._normalizedRanges.length===0)return e;if(e._normalizedRanges.length===0)return this;const t=[];let i=0,n=0,r=null;for(;i<this._normalizedRanges.length||n<e._normalizedRanges.length;){let o=null;if(i<this._normalizedRanges.length&&n<e._normalizedRanges.length){const a=this._normalizedRanges[i],l=e._normalizedRanges[n];a.startLineNumber<l.startLineNumber?(o=a,i++):(o=l,n++)}else i<this._normalizedRanges.length?(o=this._normalizedRanges[i],i++):(o=e._normalizedRanges[n],n++);r===null?r=o:r.endLineNumberExclusive>=o.startLineNumber?r=new Ct(r.startLineNumber,Math.max(r.endLineNumberExclusive,o.endLineNumberExclusive)):(t.push(r),r=o)}return r!==null&&t.push(r),new lc(t)}subtractFrom(e){const t=lI(this._normalizedRanges,o=>o.endLineNumberExclusive>=e.startLineNumber),i=aI(this._normalizedRanges,o=>o.startLineNumber<=e.endLineNumberExclusive)+1;if(t===i)return new lc([e]);const n=[];let r=e.startLineNumber;for(let o=t;o<i;o++){const a=this._normalizedRanges[o];a.startLineNumber>r&&n.push(new Ct(r,a.startLineNumber)),r=a.endLineNumberExclusive}return r<e.endLineNumberExclusive&&n.push(new Ct(r,e.endLineNumberExclusive)),new lc(n)}toString(){return this._normalizedRanges.map(e=>e.toString()).join(", ")}getIntersection(e){const t=[];let i=0,n=0;for(;i<this._normalizedRanges.length&&n<e._normalizedRanges.length;){const r=this._normalizedRanges[i],o=e._normalizedRanges[n],a=r.intersect(o);a&&!a.isEmpty&&t.push(a),r.endLineNumberExclusive<o.endLineNumberExclusive?i++:n++}return new lc(t)}getWithDelta(e){return new lc(this._normalizedRanges.map(t=>t.delta(e)))}}const xp=class xp{static betweenPositions(e,t){return e.lineNumber===t.lineNumber?new xp(0,t.column-e.column):new xp(t.lineNumber-e.lineNumber,t.column-1)}static ofRange(e){return xp.betweenPositions(e.getStartPosition(),e.getEndPosition())}static ofText(e){let t=0,i=0;for(const n of e)n===`
`?(t++,i=0):i++;return new xp(t,i)}constructor(e,t){this.lineCount=e,this.columnCount=t}isGreaterThanOrEqualTo(e){return this.lineCount!==e.lineCount?this.lineCount>e.lineCount:this.columnCount>=e.columnCount}createRange(e){return this.lineCount===0?new F(e.lineNumber,e.column,e.lineNumber,e.column+this.columnCount):new F(e.lineNumber,e.column,e.lineNumber+this.lineCount,this.columnCount+1)}addToPosition(e){return this.lineCount===0?new X(e.lineNumber,e.column+this.columnCount):new X(e.lineNumber+this.lineCount,this.columnCount+1)}toString(){return`${this.lineCount},${this.columnCount}`}};xp.zero=new xp(0,0);let cd=xp;class pMe{constructor(e){this.text=e,this.lineStartOffsetByLineIdx=[],this.lineStartOffsetByLineIdx.push(0);for(let t=0;t<e.length;t++)e.charAt(t)===`
`&&this.lineStartOffsetByLineIdx.push(t+1)}getOffset(e){return this.lineStartOffsetByLineIdx[e.lineNumber-1]+e.column-1}getOffsetRange(e){return new Mt(this.getOffset(e.getStartPosition()),this.getOffset(e.getEndPosition()))}get textLength(){const e=this.lineStartOffsetByLineIdx.length-1;return new cd(e,this.text.length-this.lineStartOffsetByLineIdx[e])}}class Jq{constructor(e){this.edits=e,fw(()=>$q(e,(t,i)=>t.range.getEndPosition().isBeforeOrEqual(i.range.getStartPosition())))}apply(e){let t="",i=new X(1,1);for(const r of this.edits){const o=r.range,a=o.getStartPosition(),l=o.getEndPosition(),c=zte(i,a);c.isEmpty()||(t+=e.getValueOfRange(c)),t+=r.text,i=l}const n=zte(i,e.endPositionExclusive);return n.isEmpty()||(t+=e.getValueOfRange(n)),t}applyToString(e){const t=new mMe(e);return this.apply(t)}getNewRanges(){const e=[];let t=0,i=0,n=0;for(const r of this.edits){const o=cd.ofText(r.text),a=X.lift({lineNumber:r.range.startLineNumber+i,column:r.range.startColumn+(r.range.startLineNumber===t?n:0)}),l=o.createRange(a);e.push(l),i=l.endLineNumber-r.range.endLineNumber,n=l.endColumn-r.range.endColumn,t=r.range.endLineNumber}return e}}class Rh{constructor(e,t){this.range=e,this.text=t}toSingleEditOperation(){return{range:this.range,text:this.text}}}function zte(s,e){if(s.lineNumber===e.lineNumber&&s.column===Number.MAX_SAFE_INTEGER)return F.fromPositions(e,e);if(!s.isBeforeOrEqual(e))throw new di("start must be before end");return new F(s.lineNumber,s.column,e.lineNumber,e.column)}class Ahe{get endPositionExclusive(){return this.length.addToPosition(new X(1,1))}}class mMe extends Ahe{constructor(e){super(),this.value=e,this._t=new pMe(this.value)}getValueOfRange(e){return this._t.getOffsetRange(e).substring(this.value)}get length(){return this._t.textLength}}class Qr{static inverse(e,t,i){const n=[];let r=1,o=1;for(const l of e){const c=new Qr(new Ct(r,l.original.startLineNumber),new Ct(o,l.modified.startLineNumber));c.modified.isEmpty||n.push(c),r=l.original.endLineNumberExclusive,o=l.modified.endLineNumberExclusive}const a=new Qr(new Ct(r,t+1),new Ct(o,i+1));return a.modified.isEmpty||n.push(a),n}static clip(e,t,i){const n=[];for(const r of e){const o=r.original.intersect(t),a=r.modified.intersect(i);o&&!o.isEmpty&&a&&!a.isEmpty&&n.push(new Qr(o,a))}return n}constructor(e,t){this.original=e,this.modified=t}toString(){return`{${this.original.toString()}->${this.modified.toString()}}`}flip(){return new Qr(this.modified,this.original)}join(e){return new Qr(this.original.join(e.original),this.modified.join(e.modified))}toRangeMapping(){const e=this.original.toInclusiveRange(),t=this.modified.toInclusiveRange();if(e&&t)return new hl(e,t);if(this.original.startLineNumber===1||this.modified.startLineNumber===1){if(!(this.modified.startLineNumber===1&&this.original.startLineNumber===1))throw new di("not a valid diff");return new hl(new F(this.original.startLineNumber,1,this.original.endLineNumberExclusive,1),new F(this.modified.startLineNumber,1,this.modified.endLineNumberExclusive,1))}else return new hl(new F(this.original.startLineNumber-1,Number.MAX_SAFE_INTEGER,this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),new F(this.modified.startLineNumber-1,Number.MAX_SAFE_INTEGER,this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER))}toRangeMapping2(e,t){if(Ute(this.original.endLineNumberExclusive,e)&&Ute(this.modified.endLineNumberExclusive,t))return new hl(new F(this.original.startLineNumber,1,this.original.endLineNumberExclusive,1),new F(this.modified.startLineNumber,1,this.modified.endLineNumberExclusive,1));if(!this.original.isEmpty&&!this.modified.isEmpty)return new hl(F.fromPositions(new X(this.original.startLineNumber,1),$0(new X(this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),e)),F.fromPositions(new X(this.modified.startLineNumber,1),$0(new X(this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),t)));if(this.original.startLineNumber>1&&this.modified.startLineNumber>1)return new hl(F.fromPositions($0(new X(this.original.startLineNumber-1,Number.MAX_SAFE_INTEGER),e),$0(new X(this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),e)),F.fromPositions($0(new X(this.modified.startLineNumber-1,Number.MAX_SAFE_INTEGER),t),$0(new X(this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),t)));throw new di}}function $0(s,e){if(s.lineNumber<1)return new X(1,1);if(s.lineNumber>e.length)return new X(e.length,e[e.length-1].length+1);const t=e[s.lineNumber-1];return s.column>t.length+1?new X(s.lineNumber,t.length+1):s}function Ute(s,e){return s>=1&&s<=e.length}class El extends Qr{static fromRangeMappings(e){const t=Ct.join(e.map(n=>Ct.fromRangeInclusive(n.originalRange))),i=Ct.join(e.map(n=>Ct.fromRangeInclusive(n.modifiedRange)));return new El(t,i,e)}constructor(e,t,i){super(e,t),this.innerChanges=i}flip(){var e;return new El(this.modified,this.original,(e=this.innerChanges)==null?void 0:e.map(t=>t.flip()))}withInnerChangesFromLineRanges(){return new El(this.original,this.modified,[this.toRangeMapping()])}}class hl{static assertSorted(e){for(let t=1;t<e.length;t++){const i=e[t-1],n=e[t];if(!(i.originalRange.getEndPosition().isBeforeOrEqual(n.originalRange.getStartPosition())&&i.modifiedRange.getEndPosition().isBeforeOrEqual(n.modifiedRange.getStartPosition())))throw new di("Range mappings must be sorted")}}constructor(e,t){this.originalRange=e,this.modifiedRange=t}toString(){return`{${this.originalRange.toString()}->${this.modifiedRange.toString()}}`}flip(){return new hl(this.modifiedRange,this.originalRange)}toTextEdit(e){const t=e.getValueOfRange(this.modifiedRange);return new Rh(this.originalRange,t)}}const _Me=3;class bMe{computeDiff(e,t,i){var l;const r=new CMe(e,t,{maxComputationTime:i.maxComputationTimeMs,shouldIgnoreTrimWhitespace:i.ignoreTrimWhitespace,shouldComputeCharChanges:!0,shouldMakePrettyDiff:!0,shouldPostProcessCharChanges:!0}).computeDiff(),o=[];let a=null;for(const c of r.changes){let d;c.originalEndLineNumber===0?d=new Ct(c.originalStartLineNumber+1,c.originalStartLineNumber+1):d=new Ct(c.originalStartLineNumber,c.originalEndLineNumber+1);let u;c.modifiedEndLineNumber===0?u=new Ct(c.modifiedStartLineNumber+1,c.modifiedStartLineNumber+1):u=new Ct(c.modifiedStartLineNumber,c.modifiedEndLineNumber+1);let h=new El(d,u,(l=c.charChanges)==null?void 0:l.map(g=>new hl(new F(g.originalStartLineNumber,g.originalStartColumn,g.originalEndLineNumber,g.originalEndColumn),new F(g.modifiedStartLineNumber,g.modifiedStartColumn,g.modifiedEndLineNumber,g.modifiedEndColumn))));a&&(a.modified.endLineNumberExclusive===h.modified.startLineNumber||a.original.endLineNumberExclusive===h.original.startLineNumber)&&(h=new El(a.original.join(h.original),a.modified.join(h.modified),a.innerChanges&&h.innerChanges?a.innerChanges.concat(h.innerChanges):void 0),o.pop()),o.push(h),a=h}return fw(()=>$q(o,(c,d)=>d.original.startLineNumber-c.original.endLineNumberExclusive===d.modified.startLineNumber-c.modified.endLineNumberExclusive&&c.original.endLineNumberExclusive<d.original.startLineNumber&&c.modified.endLineNumberExclusive<d.modified.startLineNumber)),new kR(o,[],r.quitEarly)}}function Phe(s,e,t,i){return new ch(s,e,t).ComputeDiff(i)}let jte=class{constructor(e){const t=[],i=[];for(let n=0,r=e.length;n<r;n++)t[n]=d6(e[n],1),i[n]=u6(e[n],1);this.lines=e,this._startColumns=t,this._endColumns=i}getElements(){const e=[];for(let t=0,i=this.lines.length;t<i;t++)e[t]=this.lines[t].substring(this._startColumns[t]-1,this._endColumns[t]-1);return e}getStrictElement(e){return this.lines[e]}getStartLineNumber(e){return e+1}getEndLineNumber(e){return e+1}createCharSequence(e,t,i){const n=[],r=[],o=[];let a=0;for(let l=t;l<=i;l++){const c=this.lines[l],d=e?this._startColumns[l]:1,u=e?this._endColumns[l]:c.length+1;for(let h=d;h<u;h++)n[a]=c.charCodeAt(h-1),r[a]=l+1,o[a]=h,a++;!e&&l<i&&(n[a]=10,r[a]=l+1,o[a]=c.length+1,a++)}return new vMe(n,r,o)}};class vMe{constructor(e,t,i){this._charCodes=e,this._lineNumbers=t,this._columns=i}toString(){return"["+this._charCodes.map((e,t)=>(e===10?"\\n":String.fromCharCode(e))+`-(${this._lineNumbers[t]},${this._columns[t]})`).join(", ")+"]"}_assertIndex(e,t){if(e<0||e>=t.length)throw new Error("Illegal index")}getElements(){return this._charCodes}getStartLineNumber(e){return e>0&&e===this._lineNumbers.length?this.getEndLineNumber(e-1):(this._assertIndex(e,this._lineNumbers),this._lineNumbers[e])}getEndLineNumber(e){return e===-1?this.getStartLineNumber(e+1):(this._assertIndex(e,this._lineNumbers),this._charCodes[e]===10?this._lineNumbers[e]+1:this._lineNumbers[e])}getStartColumn(e){return e>0&&e===this._columns.length?this.getEndColumn(e-1):(this._assertIndex(e,this._columns),this._columns[e])}getEndColumn(e){return e===-1?this.getStartColumn(e+1):(this._assertIndex(e,this._columns),this._charCodes[e]===10?1:this._columns[e]+1)}}class vy{constructor(e,t,i,n,r,o,a,l){this.originalStartLineNumber=e,this.originalStartColumn=t,this.originalEndLineNumber=i,this.originalEndColumn=n,this.modifiedStartLineNumber=r,this.modifiedStartColumn=o,this.modifiedEndLineNumber=a,this.modifiedEndColumn=l}static createFromDiffChange(e,t,i){const n=t.getStartLineNumber(e.originalStart),r=t.getStartColumn(e.originalStart),o=t.getEndLineNumber(e.originalStart+e.originalLength-1),a=t.getEndColumn(e.originalStart+e.originalLength-1),l=i.getStartLineNumber(e.modifiedStart),c=i.getStartColumn(e.modifiedStart),d=i.getEndLineNumber(e.modifiedStart+e.modifiedLength-1),u=i.getEndColumn(e.modifiedStart+e.modifiedLength-1);return new vy(n,r,o,a,l,c,d,u)}}function wMe(s){if(s.length<=1)return s;const e=[s[0]];let t=e[0];for(let i=1,n=s.length;i<n;i++){const r=s[i],o=r.originalStart-(t.originalStart+t.originalLength),a=r.modifiedStart-(t.modifiedStart+t.modifiedLength);Math.min(o,a)<_Me?(t.originalLength=r.originalStart+r.originalLength-t.originalStart,t.modifiedLength=r.modifiedStart+r.modifiedLength-t.modifiedStart):(e.push(r),t=r)}return e}class RL{constructor(e,t,i,n,r){this.originalStartLineNumber=e,this.originalEndLineNumber=t,this.modifiedStartLineNumber=i,this.modifiedEndLineNumber=n,this.charChanges=r}static createFromDiffResult(e,t,i,n,r,o,a){let l,c,d,u,h;if(t.originalLength===0?(l=i.getStartLineNumber(t.originalStart)-1,c=0):(l=i.getStartLineNumber(t.originalStart),c=i.getEndLineNumber(t.originalStart+t.originalLength-1)),t.modifiedLength===0?(d=n.getStartLineNumber(t.modifiedStart)-1,u=0):(d=n.getStartLineNumber(t.modifiedStart),u=n.getEndLineNumber(t.modifiedStart+t.modifiedLength-1)),o&&t.originalLength>0&&t.originalLength<20&&t.modifiedLength>0&&t.modifiedLength<20&&r()){const g=i.createCharSequence(e,t.originalStart,t.originalStart+t.originalLength-1),p=n.createCharSequence(e,t.modifiedStart,t.modifiedStart+t.modifiedLength-1);if(g.getElements().length>0&&p.getElements().length>0){let _=Phe(g,p,r,!0).changes;a&&(_=wMe(_)),h=[];for(let v=0,C=_.length;v<C;v++)h.push(vy.createFromDiffChange(_[v],g,p))}}return new RL(l,c,d,u,h)}}class CMe{constructor(e,t,i){this.shouldComputeCharChanges=i.shouldComputeCharChanges,this.shouldPostProcessCharChanges=i.shouldPostProcessCharChanges,this.shouldIgnoreTrimWhitespace=i.shouldIgnoreTrimWhitespace,this.shouldMakePrettyDiff=i.shouldMakePrettyDiff,this.originalLines=e,this.modifiedLines=t,this.original=new jte(e),this.modified=new jte(t),this.continueLineDiff=$te(i.maxComputationTime),this.continueCharDiff=$te(i.maxComputationTime===0?0:Math.min(i.maxComputationTime,5e3))}computeDiff(){if(this.original.lines.length===1&&this.original.lines[0].length===0)return this.modified.lines.length===1&&this.modified.lines[0].length===0?{quitEarly:!1,changes:[]}:{quitEarly:!1,changes:[{originalStartLineNumber:1,originalEndLineNumber:1,modifiedStartLineNumber:1,modifiedEndLineNumber:this.modified.lines.length,charChanges:void 0}]};if(this.modified.lines.length===1&&this.modified.lines[0].length===0)return{quitEarly:!1,changes:[{originalStartLineNumber:1,originalEndLineNumber:this.original.lines.length,modifiedStartLineNumber:1,modifiedEndLineNumber:1,charChanges:void 0}]};const e=Phe(this.original,this.modified,this.continueLineDiff,this.shouldMakePrettyDiff),t=e.changes,i=e.quitEarly;if(this.shouldIgnoreTrimWhitespace){const a=[];for(let l=0,c=t.length;l<c;l++)a.push(RL.createFromDiffResult(this.shouldIgnoreTrimWhitespace,t[l],this.original,this.modified,this.continueCharDiff,this.shouldComputeCharChanges,this.shouldPostProcessCharChanges));return{quitEarly:i,changes:a}}const n=[];let r=0,o=0;for(let a=-1,l=t.length;a<l;a++){const c=a+1<l?t[a+1]:null,d=c?c.originalStart:this.originalLines.length,u=c?c.modifiedStart:this.modifiedLines.length;for(;r<d&&o<u;){const h=this.originalLines[r],g=this.modifiedLines[o];if(h!==g){{let p=d6(h,1),_=d6(g,1);for(;p>1&&_>1;){const v=h.charCodeAt(p-2),C=g.charCodeAt(_-2);if(v!==C)break;p--,_--}(p>1||_>1)&&this._pushTrimWhitespaceCharChange(n,r+1,1,p,o+1,1,_)}{let p=u6(h,1),_=u6(g,1);const v=h.length+1,C=g.length+1;for(;p<v&&_<C;){const y=h.charCodeAt(p-1),x=h.charCodeAt(_-1);if(y!==x)break;p++,_++}(p<v||_<C)&&this._pushTrimWhitespaceCharChange(n,r+1,p,v,o+1,_,C)}}r++,o++}c&&(n.push(RL.createFromDiffResult(this.shouldIgnoreTrimWhitespace,c,this.original,this.modified,this.continueCharDiff,this.shouldComputeCharChanges,this.shouldPostProcessCharChanges)),r+=c.originalLength,o+=c.modifiedLength)}return{quitEarly:i,changes:n}}_pushTrimWhitespaceCharChange(e,t,i,n,r,o,a){if(this._mergeTrimWhitespaceCharChange(e,t,i,n,r,o,a))return;let l;this.shouldComputeCharChanges&&(l=[new vy(t,i,t,n,r,o,r,a)]),e.push(new RL(t,t,r,r,l))}_mergeTrimWhitespaceCharChange(e,t,i,n,r,o,a){const l=e.length;if(l===0)return!1;const c=e[l-1];return c.originalEndLineNumber===0||c.modifiedEndLineNumber===0?!1:c.originalEndLineNumber===t&&c.modifiedEndLineNumber===r?(this.shouldComputeCharChanges&&c.charChanges&&c.charChanges.push(new vy(t,i,t,n,r,o,r,a)),!0):c.originalEndLineNumber+1===t&&c.modifiedEndLineNumber+1===r?(c.originalEndLineNumber=t,c.modifiedEndLineNumber=r,this.shouldComputeCharChanges&&c.charChanges&&c.charChanges.push(new vy(t,i,t,n,r,o,r,a)),!0):!1}}function d6(s,e){const t=Zr(s);return t===-1?e:t+1}function u6(s,e){const t=nu(s);return t===-1?e:t+2}function $te(s){if(s===0)return()=>!0;const e=Date.now();return()=>Date.now()-e<s}class cg{static trivial(e,t){return new cg([new vs(Mt.ofLength(e.length),Mt.ofLength(t.length))],!1)}static trivialTimedOut(e,t){return new cg([new vs(Mt.ofLength(e.length),Mt.ofLength(t.length))],!0)}constructor(e,t){this.diffs=e,this.hitTimeout=t}}class vs{static invert(e,t){const i=[];return qde(e,(n,r)=>{i.push(vs.fromOffsetPairs(n?n.getEndExclusives():Kf.zero,r?r.getStarts():new Kf(t,(n?n.seq2Range.endExclusive-n.seq1Range.endExclusive:0)+t)))}),i}static fromOffsetPairs(e,t){return new vs(new Mt(e.offset1,t.offset1),new Mt(e.offset2,t.offset2))}static assertSorted(e){let t;for(const i of e){if(t&&!(t.seq1Range.endExclusive<=i.seq1Range.start&&t.seq2Range.endExclusive<=i.seq2Range.start))throw new di("Sequence diffs must be sorted");t=i}}constructor(e,t){this.seq1Range=e,this.seq2Range=t}swap(){return new vs(this.seq2Range,this.seq1Range)}toString(){return`${this.seq1Range} <-> ${this.seq2Range}`}join(e){return new vs(this.seq1Range.join(e.seq1Range),this.seq2Range.join(e.seq2Range))}delta(e){return e===0?this:new vs(this.seq1Range.delta(e),this.seq2Range.delta(e))}deltaStart(e){return e===0?this:new vs(this.seq1Range.deltaStart(e),this.seq2Range.deltaStart(e))}deltaEnd(e){return e===0?this:new vs(this.seq1Range.deltaEnd(e),this.seq2Range.deltaEnd(e))}intersect(e){const t=this.seq1Range.intersect(e.seq1Range),i=this.seq2Range.intersect(e.seq2Range);if(!(!t||!i))return new vs(t,i)}getStarts(){return new Kf(this.seq1Range.start,this.seq2Range.start)}getEndExclusives(){return new Kf(this.seq1Range.endExclusive,this.seq2Range.endExclusive)}}const Nb=class Nb{constructor(e,t){this.offset1=e,this.offset2=t}toString(){return`${this.offset1} <-> ${this.offset2}`}delta(e){return e===0?this:new Nb(this.offset1+e,this.offset2+e)}equals(e){return this.offset1===e.offset1&&this.offset2===e.offset2}};Nb.zero=new Nb(0,0),Nb.max=new Nb(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER);let Kf=Nb;const WM=class WM{isValid(){return!0}};WM.instance=new WM;let cI=WM;class yMe{constructor(e){if(this.timeout=e,this.startTime=Date.now(),this.valid=!0,e<=0)throw new di("timeout must be positive")}isValid(){if(!(Date.now()-this.startTime<this.timeout)&&this.valid){this.valid=!1;debugger}return this.valid}}class bV{constructor(e,t){this.width=e,this.height=t,this.array=[],this.array=new Array(e*t)}get(e,t){return this.array[e+t*this.width]}set(e,t,i){this.array[e+t*this.width]=i}}function h6(s){return s===32||s===9}const vk=class vk{static getKey(e){let t=this.chrKeys.get(e);return t===void 0&&(t=this.chrKeys.size,this.chrKeys.set(e,t)),t}constructor(e,t,i){this.range=e,this.lines=t,this.source=i,this.histogram=[];let n=0;for(let r=e.startLineNumber-1;r<e.endLineNumberExclusive-1;r++){const o=t[r];for(let l=0;l<o.length;l++){n++;const c=o[l],d=vk.getKey(c);this.histogram[d]=(this.histogram[d]||0)+1}n++;const a=vk.getKey(`
`);this.histogram[a]=(this.histogram[a]||0)+1}this.totalCount=n}computeSimilarity(e){let t=0;const i=Math.max(this.histogram.length,e.histogram.length);for(let n=0;n<i;n++)t+=Math.abs((this.histogram[n]??0)-(e.histogram[n]??0));return 1-t/(this.totalCount+e.totalCount)}};vk.chrKeys=new Map;let tA=vk;class SMe{compute(e,t,i=cI.instance,n){if(e.length===0||t.length===0)return cg.trivial(e,t);const r=new bV(e.length,t.length),o=new bV(e.length,t.length),a=new bV(e.length,t.length);for(let p=0;p<e.length;p++)for(let _=0;_<t.length;_++){if(!i.isValid())return cg.trivialTimedOut(e,t);const v=p===0?0:r.get(p-1,_),C=_===0?0:r.get(p,_-1);let y;e.getElement(p)===t.getElement(_)?(p===0||_===0?y=0:y=r.get(p-1,_-1),p>0&&_>0&&o.get(p-1,_-1)===3&&(y+=a.get(p-1,_-1)),y+=n?n(p,_):1):y=-1;const x=Math.max(v,C,y);if(x===y){const L=p>0&&_>0?a.get(p-1,_-1):0;a.set(p,_,L+1),o.set(p,_,3)}else x===v?(a.set(p,_,0),o.set(p,_,1)):x===C&&(a.set(p,_,0),o.set(p,_,2));r.set(p,_,x)}const l=[];let c=e.length,d=t.length;function u(p,_){(p+1!==c||_+1!==d)&&l.push(new vs(new Mt(p+1,c),new Mt(_+1,d))),c=p,d=_}let h=e.length-1,g=t.length-1;for(;h>=0&&g>=0;)o.get(h,g)===3?(u(h,g),h--,g--):o.get(h,g)===1?h--:g--;return u(-1,-1),l.reverse(),new cg(l,!1)}}class Mhe{compute(e,t,i=cI.instance){if(e.length===0||t.length===0)return cg.trivial(e,t);const n=e,r=t;function o(_,v){for(;_<n.length&&v<r.length&&n.getElement(_)===r.getElement(v);)_++,v++;return _}let a=0;const l=new xMe;l.set(0,o(0,0));const c=new LMe;c.set(0,l.get(0)===0?null:new qte(null,0,0,l.get(0)));let d=0;e:for(;;){if(a++,!i.isValid())return cg.trivialTimedOut(n,r);const _=-Math.min(a,r.length+a%2),v=Math.min(a,n.length+a%2);for(d=_;d<=v;d+=2){const C=d===v?-1:l.get(d+1),y=d===_?-1:l.get(d-1)+1,x=Math.min(Math.max(C,y),n.length),L=x-d;if(x>n.length||L>r.length)continue;const I=o(x,L);l.set(d,I);const A=x===C?c.get(d+1):c.get(d-1);if(c.set(d,I!==x?new qte(A,x,L,I-x):A),l.get(d)===n.length&&l.get(d)-d===r.length)break e}}let u=c.get(d);const h=[];let g=n.length,p=r.length;for(;;){const _=u?u.x+u.length:0,v=u?u.y+u.length:0;if((_!==g||v!==p)&&h.push(new vs(new Mt(_,g),new Mt(v,p))),!u)break;g=u.x,p=u.y,u=u.prev}return h.reverse(),new cg(h,!1)}}class qte{constructor(e,t,i,n){this.prev=e,this.x=t,this.y=i,this.length=n}}class xMe{constructor(){this.positiveArr=new Int32Array(10),this.negativeArr=new Int32Array(10)}get(e){return e<0?(e=-e-1,this.negativeArr[e]):this.positiveArr[e]}set(e,t){if(e<0){if(e=-e-1,e>=this.negativeArr.length){const i=this.negativeArr;this.negativeArr=new Int32Array(i.length*2),this.negativeArr.set(i)}this.negativeArr[e]=t}else{if(e>=this.positiveArr.length){const i=this.positiveArr;this.positiveArr=new Int32Array(i.length*2),this.positiveArr.set(i)}this.positiveArr[e]=t}}}class LMe{constructor(){this.positiveArr=[],this.negativeArr=[]}get(e){return e<0?(e=-e-1,this.negativeArr[e]):this.positiveArr[e]}set(e,t){e<0?(e=-e-1,this.negativeArr[e]=t):this.positiveArr[e]=t}}class iA{constructor(e,t,i){this.lines=e,this.range=t,this.considerWhitespaceChanges=i,this.elements=[],this.firstElementOffsetByLineIdx=[],this.lineStartOffsets=[],this.trimmedWsLengthsByLineIdx=[],this.firstElementOffsetByLineIdx.push(0);for(let n=this.range.startLineNumber;n<=this.range.endLineNumber;n++){let r=e[n-1],o=0;n===this.range.startLineNumber&&this.range.startColumn>1&&(o=this.range.startColumn-1,r=r.substring(o)),this.lineStartOffsets.push(o);let a=0;if(!i){const c=r.trimStart();a=r.length-c.length,r=c.trimEnd()}this.trimmedWsLengthsByLineIdx.push(a);const l=n===this.range.endLineNumber?Math.min(this.range.endColumn-1-o-a,r.length):r.length;for(let c=0;c<l;c++)this.elements.push(r.charCodeAt(c));n<this.range.endLineNumber&&(this.elements.push(10),this.firstElementOffsetByLineIdx.push(this.elements.length))}}toString(){return`Slice: "${this.text}"`}get text(){return this.getText(new Mt(0,this.length))}getText(e){return this.elements.slice(e.start,e.endExclusive).map(t=>String.fromCharCode(t)).join("")}getElement(e){return this.elements[e]}get length(){return this.elements.length}getBoundaryScore(e){const t=Gte(e>0?this.elements[e-1]:-1),i=Gte(e<this.elements.length?this.elements[e]:-1);if(t===7&&i===8)return 0;if(t===8)return 150;let n=0;return t!==i&&(n+=10,t===0&&i===1&&(n+=1)),n+=Kte(t),n+=Kte(i),n}translateOffset(e,t="right"){const i=aI(this.firstElementOffsetByLineIdx,r=>r<=e),n=e-this.firstElementOffsetByLineIdx[i];return new X(this.range.startLineNumber+i,1+this.lineStartOffsets[i]+n+(n===0&&t==="left"?0:this.trimmedWsLengthsByLineIdx[i]))}translateRange(e){const t=this.translateOffset(e.start,"right"),i=this.translateOffset(e.endExclusive,"left");return i.isBefore(t)?F.fromPositions(i,i):F.fromPositions(t,i)}findWordContaining(e){if(e<0||e>=this.elements.length||!vV(this.elements[e]))return;let t=e;for(;t>0&&vV(this.elements[t-1]);)t--;let i=e;for(;i<this.elements.length&&vV(this.elements[i]);)i++;return new Mt(t,i)}countLinesIn(e){return this.translateOffset(e.endExclusive).lineNumber-this.translateOffset(e.start).lineNumber}isStronglyEqual(e,t){return this.elements[e]===this.elements[t]}extendToFullLines(e){const t=p1(this.firstElementOffsetByLineIdx,n=>n<=e.start)??0,i=dMe(this.firstElementOffsetByLineIdx,n=>e.endExclusive<=n)??this.elements.length;return new Mt(t,i)}}function vV(s){return s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57}const kMe={0:0,1:0,2:0,3:10,4:2,5:30,6:3,7:10,8:10};function Kte(s){return kMe[s]}function Gte(s){return s===10?8:s===13?7:h6(s)?6:s>=97&&s<=122?0:s>=65&&s<=90?1:s>=48&&s<=57?2:s===-1?3:s===44||s===59?5:4}function IMe(s,e,t,i,n,r){let{moves:o,excludedChanges:a}=DMe(s,e,t,r);if(!r.isValid())return[];const l=s.filter(d=>!a.has(d)),c=TMe(l,i,n,e,t,r);return N7(o,c),o=NMe(o),o=o.filter(d=>{const u=d.original.toOffsetRange().slice(e).map(g=>g.trim());return u.join(`
`).length>=15&&EMe(u,g=>g.length>=2)>=2}),o=RMe(s,o),o}function EMe(s,e){let t=0;for(const i of s)e(i)&&t++;return t}function DMe(s,e,t,i){const n=[],r=s.filter(l=>l.modified.isEmpty&&l.original.length>=3).map(l=>new tA(l.original,e,l)),o=new Set(s.filter(l=>l.original.isEmpty&&l.modified.length>=3).map(l=>new tA(l.modified,t,l))),a=new Set;for(const l of r){let c=-1,d;for(const u of o){const h=l.computeSimilarity(u);h>c&&(c=h,d=u)}if(c>.9&&d&&(o.delete(d),n.push(new Qr(l.range,d.range)),a.add(l.source),a.add(d.source)),!i.isValid())return{moves:n,excludedChanges:a}}return{moves:n,excludedChanges:a}}function TMe(s,e,t,i,n,r){const o=[],a=new Gq;for(const h of s)for(let g=h.original.startLineNumber;g<h.original.endLineNumberExclusive-2;g++){const p=`${e[g-1]}:${e[g+1-1]}:${e[g+2-1]}`;a.add(p,{range:new Ct(g,g+3)})}const l=[];s.sort(Co(h=>h.modified.startLineNumber,td));for(const h of s){let g=[];for(let p=h.modified.startLineNumber;p<h.modified.endLineNumberExclusive-2;p++){const _=`${t[p-1]}:${t[p+1-1]}:${t[p+2-1]}`,v=new Ct(p,p+3),C=[];a.forEach(_,({range:y})=>{for(const L of g)if(L.originalLineRange.endLineNumberExclusive+1===y.endLineNumberExclusive&&L.modifiedLineRange.endLineNumberExclusive+1===v.endLineNumberExclusive){L.originalLineRange=new Ct(L.originalLineRange.startLineNumber,y.endLineNumberExclusive),L.modifiedLineRange=new Ct(L.modifiedLineRange.startLineNumber,v.endLineNumberExclusive),C.push(L);return}const x={modifiedLineRange:v,originalLineRange:y};l.push(x),C.push(x)}),g=C}if(!r.isValid())return[]}l.sort(Qde(Co(h=>h.modifiedLineRange.length,td)));const c=new lc,d=new lc;for(const h of l){const g=h.modifiedLineRange.startLineNumber-h.originalLineRange.startLineNumber,p=c.subtractFrom(h.modifiedLineRange),_=d.subtractFrom(h.originalLineRange).getWithDelta(g),v=p.getIntersection(_);for(const C of v.ranges){if(C.length<3)continue;const y=C,x=C.delta(-g);o.push(new Qr(x,y)),c.addRange(y),d.addRange(x)}}o.sort(Co(h=>h.original.startLineNumber,td));const u=new eA(s);for(let h=0;h<o.length;h++){const g=o[h],p=u.findLastMonotonous(A=>A.original.startLineNumber<=g.original.startLineNumber),_=p1(s,A=>A.modified.startLineNumber<=g.modified.startLineNumber),v=Math.max(g.original.startLineNumber-p.original.startLineNumber,g.modified.startLineNumber-_.modified.startLineNumber),C=u.findLastMonotonous(A=>A.original.startLineNumber<g.original.endLineNumberExclusive),y=p1(s,A=>A.modified.startLineNumber<g.modified.endLineNumberExclusive),x=Math.max(C.original.endLineNumberExclusive-g.original.endLineNumberExclusive,y.modified.endLineNumberExclusive-g.modified.endLineNumberExclusive);let L;for(L=0;L<v;L++){const A=g.original.startLineNumber-L-1,D=g.modified.startLineNumber-L-1;if(A>i.length||D>n.length||c.contains(D)||d.contains(A)||!Qte(i[A-1],n[D-1],r))break}L>0&&(d.addRange(new Ct(g.original.startLineNumber-L,g.original.startLineNumber)),c.addRange(new Ct(g.modified.startLineNumber-L,g.modified.startLineNumber)));let I;for(I=0;I<x;I++){const A=g.original.endLineNumberExclusive+I,D=g.modified.endLineNumberExclusive+I;if(A>i.length||D>n.length||c.contains(D)||d.contains(A)||!Qte(i[A-1],n[D-1],r))break}I>0&&(d.addRange(new Ct(g.original.endLineNumberExclusive,g.original.endLineNumberExclusive+I)),c.addRange(new Ct(g.modified.endLineNumberExclusive,g.modified.endLineNumberExclusive+I))),(L>0||I>0)&&(o[h]=new Qr(new Ct(g.original.startLineNumber-L,g.original.endLineNumberExclusive+I),new Ct(g.modified.startLineNumber-L,g.modified.endLineNumberExclusive+I)))}return o}function Qte(s,e,t){if(s.trim()===e.trim())return!0;if(s.length>300&&e.length>300)return!1;const n=new Mhe().compute(new iA([s],new F(1,1,1,s.length),!1),new iA([e],new F(1,1,1,e.length),!1),t);let r=0;const o=vs.invert(n.diffs,s.length);for(const d of o)d.seq1Range.forEach(u=>{h6(s.charCodeAt(u))||r++});function a(d){let u=0;for(let h=0;h<s.length;h++)h6(d.charCodeAt(h))||u++;return u}const l=a(s.length>e.length?s:e);return r/l>.6&&l>10}function NMe(s){if(s.length===0)return s;s.sort(Co(t=>t.original.startLineNumber,td));const e=[s[0]];for(let t=1;t<s.length;t++){const i=e[e.length-1],n=s[t],r=n.original.startLineNumber-i.original.endLineNumberExclusive,o=n.modified.startLineNumber-i.modified.endLineNumberExclusive;if(r>=0&&o>=0&&r+o<=2){e[e.length-1]=i.join(n);continue}e.push(n)}return e}function RMe(s,e){const t=new eA(s);return e=e.filter(i=>{const n=t.findLastMonotonous(a=>a.original.startLineNumber<i.original.endLineNumberExclusive)||new Qr(new Ct(1,1),new Ct(1,1)),r=p1(s,a=>a.modified.startLineNumber<i.modified.endLineNumberExclusive);return n!==r}),e}function f6(s,e,t){let i=t;return i=Yte(s,e,i),i=Yte(s,e,i),i=AMe(s,e,i),i}function Yte(s,e,t){if(t.length===0)return t;const i=[];i.push(t[0]);for(let r=1;r<t.length;r++){const o=i[i.length-1];let a=t[r];if(a.seq1Range.isEmpty||a.seq2Range.isEmpty){const l=a.seq1Range.start-o.seq1Range.endExclusive;let c;for(c=1;c<=l&&!(s.getElement(a.seq1Range.start-c)!==s.getElement(a.seq1Range.endExclusive-c)||e.getElement(a.seq2Range.start-c)!==e.getElement(a.seq2Range.endExclusive-c));c++);if(c--,c===l){i[i.length-1]=new vs(new Mt(o.seq1Range.start,a.seq1Range.endExclusive-l),new Mt(o.seq2Range.start,a.seq2Range.endExclusive-l));continue}a=a.delta(-c)}i.push(a)}const n=[];for(let r=0;r<i.length-1;r++){const o=i[r+1];let a=i[r];if(a.seq1Range.isEmpty||a.seq2Range.isEmpty){const l=o.seq1Range.start-a.seq1Range.endExclusive;let c;for(c=0;c<l&&!(!s.isStronglyEqual(a.seq1Range.start+c,a.seq1Range.endExclusive+c)||!e.isStronglyEqual(a.seq2Range.start+c,a.seq2Range.endExclusive+c));c++);if(c===l){i[r+1]=new vs(new Mt(a.seq1Range.start+l,o.seq1Range.endExclusive),new Mt(a.seq2Range.start+l,o.seq2Range.endExclusive));continue}c>0&&(a=a.delta(c))}n.push(a)}return i.length>0&&n.push(i[i.length-1]),n}function AMe(s,e,t){if(!s.getBoundaryScore||!e.getBoundaryScore)return t;for(let i=0;i<t.length;i++){const n=i>0?t[i-1]:void 0,r=t[i],o=i+1<t.length?t[i+1]:void 0,a=new Mt(n?n.seq1Range.endExclusive+1:0,o?o.seq1Range.start-1:s.length),l=new Mt(n?n.seq2Range.endExclusive+1:0,o?o.seq2Range.start-1:e.length);r.seq1Range.isEmpty?t[i]=Xte(r,s,e,a,l):r.seq2Range.isEmpty&&(t[i]=Xte(r.swap(),e,s,l,a).swap())}return t}function Xte(s,e,t,i,n){let o=1;for(;s.seq1Range.start-o>=i.start&&s.seq2Range.start-o>=n.start&&t.isStronglyEqual(s.seq2Range.start-o,s.seq2Range.endExclusive-o)&&o<100;)o++;o--;let a=0;for(;s.seq1Range.start+a<i.endExclusive&&s.seq2Range.endExclusive+a<n.endExclusive&&t.isStronglyEqual(s.seq2Range.start+a,s.seq2Range.endExclusive+a)&&a<100;)a++;if(o===0&&a===0)return s;let l=0,c=-1;for(let d=-o;d<=a;d++){const u=s.seq2Range.start+d,h=s.seq2Range.endExclusive+d,g=s.seq1Range.start+d,p=e.getBoundaryScore(g)+t.getBoundaryScore(u)+t.getBoundaryScore(h);p>c&&(c=p,l=d)}return s.delta(l)}function PMe(s,e,t){const i=[];for(const n of t){const r=i[i.length-1];if(!r){i.push(n);continue}n.seq1Range.start-r.seq1Range.endExclusive<=2||n.seq2Range.start-r.seq2Range.endExclusive<=2?i[i.length-1]=new vs(r.seq1Range.join(n.seq1Range),r.seq2Range.join(n.seq2Range)):i.push(n)}return i}function MMe(s,e,t){const i=vs.invert(t,s.length),n=[];let r=new Kf(0,0);function o(l,c){if(l.offset1<r.offset1||l.offset2<r.offset2)return;const d=s.findWordContaining(l.offset1),u=e.findWordContaining(l.offset2);if(!d||!u)return;let h=new vs(d,u);const g=h.intersect(c);let p=g.seq1Range.length,_=g.seq2Range.length;for(;i.length>0;){const v=i[0];if(!(v.seq1Range.intersects(h.seq1Range)||v.seq2Range.intersects(h.seq2Range)))break;const y=s.findWordContaining(v.seq1Range.start),x=e.findWordContaining(v.seq2Range.start),L=new vs(y,x),I=L.intersect(v);if(p+=I.seq1Range.length,_+=I.seq2Range.length,h=h.join(L),h.seq1Range.endExclusive>=v.seq1Range.endExclusive)i.shift();else break}p+_<(h.seq1Range.length+h.seq2Range.length)*2/3&&n.push(h),r=h.getEndExclusives()}for(;i.length>0;){const l=i.shift();l.seq1Range.isEmpty||(o(l.getStarts(),l),o(l.getEndExclusives().delta(-1),l))}return OMe(t,n)}function OMe(s,e){const t=[];for(;s.length>0||e.length>0;){const i=s[0],n=e[0];let r;i&&(!n||i.seq1Range.start<n.seq1Range.start)?r=s.shift():r=e.shift(),t.length>0&&t[t.length-1].seq1Range.endExclusive>=r.seq1Range.start?t[t.length-1]=t[t.length-1].join(r):t.push(r)}return t}function FMe(s,e,t){let i=t;if(i.length===0)return i;let n=0,r;do{r=!1;const o=[i[0]];for(let a=1;a<i.length;a++){let d=function(h,g){const p=new Mt(c.seq1Range.endExclusive,l.seq1Range.start);return s.getText(p).replace(/\s/g,"").length<=4&&(h.seq1Range.length+h.seq2Range.length>5||g.seq1Range.length+g.seq2Range.length>5)};const l=i[a],c=o[o.length-1];d(c,l)?(r=!0,o[o.length-1]=o[o.length-1].join(l)):o.push(l)}i=o}while(n++<10&&r);return i}function VMe(s,e,t){let i=t;if(i.length===0)return i;let n=0,r;do{r=!1;const a=[i[0]];for(let l=1;l<i.length;l++){let u=function(g,p){const _=new Mt(d.seq1Range.endExclusive,c.seq1Range.start);if(s.countLinesIn(_)>5||_.length>500)return!1;const C=s.getText(_).trim();if(C.length>20||C.split(/\r\n|\r|\n/).length>1)return!1;const y=s.countLinesIn(g.seq1Range),x=g.seq1Range.length,L=e.countLinesIn(g.seq2Range),I=g.seq2Range.length,A=s.countLinesIn(p.seq1Range),D=p.seq1Range.length,N=e.countLinesIn(p.seq2Range),R=p.seq2Range.length,W=2*40+50;function H(U){return Math.min(U,W)}return Math.pow(Math.pow(H(y*40+x),1.5)+Math.pow(H(L*40+I),1.5),1.5)+Math.pow(Math.pow(H(A*40+D),1.5)+Math.pow(H(N*40+R),1.5),1.5)>(W**1.5)**1.5*1.3};const c=i[l],d=a[a.length-1];u(d,c)?(r=!0,a[a.length-1]=a[a.length-1].join(c)):a.push(c)}i=a}while(n++<10&&r);const o=[];return ETe(i,(a,l,c)=>{let d=l;function u(C){return C.length>0&&C.trim().length<=3&&l.seq1Range.length+l.seq2Range.length>100}const h=s.extendToFullLines(l.seq1Range),g=s.getText(new Mt(h.start,l.seq1Range.start));u(g)&&(d=d.deltaStart(-g.length));const p=s.getText(new Mt(l.seq1Range.endExclusive,h.endExclusive));u(p)&&(d=d.deltaEnd(p.length));const _=vs.fromOffsetPairs(a?a.getEndExclusives():Kf.zero,c?c.getStarts():Kf.max),v=d.intersect(_);o.length>0&&v.getStarts().equals(o[o.length-1].getEndExclusives())?o[o.length-1]=o[o.length-1].join(v):o.push(v)}),o}class Zte{constructor(e,t){this.trimmedHash=e,this.lines=t}getElement(e){return this.trimmedHash[e]}get length(){return this.trimmedHash.length}getBoundaryScore(e){const t=e===0?0:Jte(this.lines[e-1]),i=e===this.lines.length?0:Jte(this.lines[e]);return 1e3-(t+i)}getText(e){return this.lines.slice(e.start,e.endExclusive).join(`
`)}isStronglyEqual(e,t){return this.lines[e]===this.lines[t]}}function Jte(s){let e=0;for(;e<s.length&&(s.charCodeAt(e)===32||s.charCodeAt(e)===9);)e++;return e}class Ohe{constructor(){this.dynamicProgrammingDiffing=new SMe,this.myersDiffingAlgorithm=new Mhe}computeDiff(e,t,i){if(e.length<=1&&dn(e,t,(I,A)=>I===A))return new kR([],[],!1);if(e.length===1&&e[0].length===0||t.length===1&&t[0].length===0)return new kR([new El(new Ct(1,e.length+1),new Ct(1,t.length+1),[new hl(new F(1,1,e.length,e[e.length-1].length+1),new F(1,1,t.length,t[t.length-1].length+1))])],[],!1);const n=i.maxComputationTimeMs===0?cI.instance:new yMe(i.maxComputationTimeMs),r=!i.ignoreTrimWhitespace,o=new Map;function a(I){let A=o.get(I);return A===void 0&&(A=o.size,o.set(I,A)),A}const l=e.map(I=>a(I.trim())),c=t.map(I=>a(I.trim())),d=new Zte(l,e),u=new Zte(c,t),h=d.length+u.length<1700?this.dynamicProgrammingDiffing.compute(d,u,n,(I,A)=>e[I]===t[A]?t[A].length===0?.1:1+Math.log(1+t[A].length):.99):this.myersDiffingAlgorithm.compute(d,u,n);let g=h.diffs,p=h.hitTimeout;g=f6(d,u,g),g=FMe(d,u,g);const _=[],v=I=>{if(r)for(let A=0;A<I;A++){const D=C+A,N=y+A;if(e[D]!==t[N]){const R=this.refineDiff(e,t,new vs(new Mt(D,D+1),new Mt(N,N+1)),n,r);for(const W of R.mappings)_.push(W);R.hitTimeout&&(p=!0)}}};let C=0,y=0;for(const I of g){fw(()=>I.seq1Range.start-C===I.seq2Range.start-y);const A=I.seq1Range.start-C;v(A),C=I.seq1Range.endExclusive,y=I.seq2Range.endExclusive;const D=this.refineDiff(e,t,I,n,r);D.hitTimeout&&(p=!0);for(const N of D.mappings)_.push(N)}v(e.length-C);const x=eie(_,e,t);let L=[];return i.computeMoves&&(L=this.computeMoves(x,e,t,l,c,n,r)),fw(()=>{function I(D,N){if(D.lineNumber<1||D.lineNumber>N.length)return!1;const R=N[D.lineNumber-1];return!(D.column<1||D.column>R.length+1)}function A(D,N){return!(D.startLineNumber<1||D.startLineNumber>N.length+1||D.endLineNumberExclusive<1||D.endLineNumberExclusive>N.length+1)}for(const D of x){if(!D.innerChanges)return!1;for(const N of D.innerChanges)if(!(I(N.modifiedRange.getStartPosition(),t)&&I(N.modifiedRange.getEndPosition(),t)&&I(N.originalRange.getStartPosition(),e)&&I(N.originalRange.getEndPosition(),e)))return!1;if(!A(D.modified,t)||!A(D.original,e))return!1}return!0}),new kR(x,L,p)}computeMoves(e,t,i,n,r,o,a){return IMe(e,t,i,n,r,o).map(d=>{const u=this.refineDiff(t,i,new vs(d.original.toOffsetRange(),d.modified.toOffsetRange()),o,a),h=eie(u.mappings,t,i,!0);return new Rhe(d,h)})}refineDiff(e,t,i,n,r){const a=WMe(i).toRangeMapping2(e,t),l=new iA(e,a.originalRange,r),c=new iA(t,a.modifiedRange,r),d=l.length+c.length<500?this.dynamicProgrammingDiffing.compute(l,c,n):this.myersDiffingAlgorithm.compute(l,c,n);let u=d.diffs;return u=f6(l,c,u),u=MMe(l,c,u),u=PMe(l,c,u),u=VMe(l,c,u),{mappings:u.map(g=>new hl(l.translateRange(g.seq1Range),c.translateRange(g.seq2Range))),hitTimeout:d.hitTimeout}}}function eie(s,e,t,i=!1){const n=[];for(const r of gq(s.map(o=>BMe(o,e,t)),(o,a)=>o.original.overlapOrTouch(a.original)||o.modified.overlapOrTouch(a.modified))){const o=r[0],a=r[r.length-1];n.push(new El(o.original.join(a.original),o.modified.join(a.modified),r.map(l=>l.innerChanges[0])))}return fw(()=>!i&&n.length>0&&(n[0].modified.startLineNumber!==n[0].original.startLineNumber||t.length-n[n.length-1].modified.endLineNumberExclusive!==e.length-n[n.length-1].original.endLineNumberExclusive)?!1:$q(n,(r,o)=>o.original.startLineNumber-r.original.endLineNumberExclusive===o.modified.startLineNumber-r.modified.endLineNumberExclusive&&r.original.endLineNumberExclusive<o.original.startLineNumber&&r.modified.endLineNumberExclusive<o.modified.startLineNumber)),n}function BMe(s,e,t){let i=0,n=0;s.modifiedRange.endColumn===1&&s.originalRange.endColumn===1&&s.originalRange.startLineNumber+i<=s.originalRange.endLineNumber&&s.modifiedRange.startLineNumber+i<=s.modifiedRange.endLineNumber&&(n=-1),s.modifiedRange.startColumn-1>=t[s.modifiedRange.startLineNumber-1].length&&s.originalRange.startColumn-1>=e[s.originalRange.startLineNumber-1].length&&s.originalRange.startLineNumber<=s.originalRange.endLineNumber+n&&s.modifiedRange.startLineNumber<=s.modifiedRange.endLineNumber+n&&(i=1);const r=new Ct(s.originalRange.startLineNumber+i,s.originalRange.endLineNumber+1+n),o=new Ct(s.modifiedRange.startLineNumber+i,s.modifiedRange.endLineNumber+1+n);return new El(r,o,[s])}function WMe(s){return new Qr(new Ct(s.seq1Range.start+1,s.seq1Range.endExclusive+1),new Ct(s.seq2Range.start+1,s.seq2Range.endExclusive+1))}const tie={getLegacy:()=>new bMe,getDefault:()=>new Ohe};function cm(s,e){const t=Math.pow(10,e);return Math.round(s*t)/t}class Jt{constructor(e,t,i,n=1){this._rgbaBrand=void 0,this.r=Math.min(255,Math.max(0,e))|0,this.g=Math.min(255,Math.max(0,t))|0,this.b=Math.min(255,Math.max(0,i))|0,this.a=cm(Math.max(Math.min(1,n),0),3)}static equals(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a}}class Kc{constructor(e,t,i,n){this._hslaBrand=void 0,this.h=Math.max(Math.min(360,e),0)|0,this.s=cm(Math.max(Math.min(1,t),0),3),this.l=cm(Math.max(Math.min(1,i),0),3),this.a=cm(Math.max(Math.min(1,n),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.l===t.l&&e.a===t.a}static fromRGBA(e){const t=e.r/255,i=e.g/255,n=e.b/255,r=e.a,o=Math.max(t,i,n),a=Math.min(t,i,n);let l=0,c=0;const d=(a+o)/2,u=o-a;if(u>0){switch(c=Math.min(d<=.5?u/(2*d):u/(2-2*d),1),o){case t:l=(i-n)/u+(i<n?6:0);break;case i:l=(n-t)/u+2;break;case n:l=(t-i)/u+4;break}l*=60,l=Math.round(l)}return new Kc(l,c,d,r)}static _hue2rgb(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+(t-e)*6*i:i<1/2?t:i<2/3?e+(t-e)*(2/3-i)*6:e}static toRGBA(e){const t=e.h/360,{s:i,l:n,a:r}=e;let o,a,l;if(i===0)o=a=l=n;else{const c=n<.5?n*(1+i):n+i-n*i,d=2*n-c;o=Kc._hue2rgb(d,c,t+1/3),a=Kc._hue2rgb(d,c,t),l=Kc._hue2rgb(d,c,t-1/3)}return new Jt(Math.round(o*255),Math.round(a*255),Math.round(l*255),r)}}class mh{constructor(e,t,i,n){this._hsvaBrand=void 0,this.h=Math.max(Math.min(360,e),0)|0,this.s=cm(Math.max(Math.min(1,t),0),3),this.v=cm(Math.max(Math.min(1,i),0),3),this.a=cm(Math.max(Math.min(1,n),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.v===t.v&&e.a===t.a}static fromRGBA(e){const t=e.r/255,i=e.g/255,n=e.b/255,r=Math.max(t,i,n),o=Math.min(t,i,n),a=r-o,l=r===0?0:a/r;let c;return a===0?c=0:r===t?c=((i-n)/a%6+6)%6:r===i?c=(n-t)/a+2:c=(t-i)/a+4,new mh(Math.round(c*60),l,r,e.a)}static toRGBA(e){const{h:t,s:i,v:n,a:r}=e,o=n*i,a=o*(1-Math.abs(t/60%2-1)),l=n-o;let[c,d,u]=[0,0,0];return t<60?(c=o,d=a):t<120?(c=a,d=o):t<180?(d=o,u=a):t<240?(d=a,u=o):t<300?(c=a,u=o):t<=360&&(c=o,u=a),c=Math.round((c+l)*255),d=Math.round((d+l)*255),u=Math.round((u+l)*255),new Jt(c,d,u,r)}}const Rn=class Rn{static fromHex(e){return Rn.Format.CSS.parseHex(e)||Rn.red}static equals(e,t){return!e&&!t?!0:!e||!t?!1:e.equals(t)}get hsla(){return this._hsla?this._hsla:Kc.fromRGBA(this.rgba)}get hsva(){return this._hsva?this._hsva:mh.fromRGBA(this.rgba)}constructor(e){if(e)if(e instanceof Jt)this.rgba=e;else if(e instanceof Kc)this._hsla=e,this.rgba=Kc.toRGBA(e);else if(e instanceof mh)this._hsva=e,this.rgba=mh.toRGBA(e);else throw new Error("Invalid color ctor argument");else throw new Error("Color needs a value")}equals(e){return!!e&&Jt.equals(this.rgba,e.rgba)&&Kc.equals(this.hsla,e.hsla)&&mh.equals(this.hsva,e.hsva)}getRelativeLuminance(){const e=Rn._relativeLuminanceForComponent(this.rgba.r),t=Rn._relativeLuminanceForComponent(this.rgba.g),i=Rn._relativeLuminanceForComponent(this.rgba.b),n=.2126*e+.7152*t+.0722*i;return cm(n,4)}static _relativeLuminanceForComponent(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}isLighter(){return(this.rgba.r*299+this.rgba.g*587+this.rgba.b*114)/1e3>=128}isLighterThan(e){const t=this.getRelativeLuminance(),i=e.getRelativeLuminance();return t>i}isDarkerThan(e){const t=this.getRelativeLuminance(),i=e.getRelativeLuminance();return t<i}lighten(e){return new Rn(new Kc(this.hsla.h,this.hsla.s,this.hsla.l+this.hsla.l*e,this.hsla.a))}darken(e){return new Rn(new Kc(this.hsla.h,this.hsla.s,this.hsla.l-this.hsla.l*e,this.hsla.a))}transparent(e){const{r:t,g:i,b:n,a:r}=this.rgba;return new Rn(new Jt(t,i,n,r*e))}isTransparent(){return this.rgba.a===0}isOpaque(){return this.rgba.a===1}opposite(){return new Rn(new Jt(255-this.rgba.r,255-this.rgba.g,255-this.rgba.b,this.rgba.a))}makeOpaque(e){if(this.isOpaque()||e.rgba.a!==1)return this;const{r:t,g:i,b:n,a:r}=this.rgba;return new Rn(new Jt(e.rgba.r-r*(e.rgba.r-t),e.rgba.g-r*(e.rgba.g-i),e.rgba.b-r*(e.rgba.b-n),1))}toString(){return this._toString||(this._toString=Rn.Format.CSS.format(this)),this._toString}static getLighterColor(e,t,i){if(e.isLighterThan(t))return e;i=i||.5;const n=e.getRelativeLuminance(),r=t.getRelativeLuminance();return i=i*(r-n)/r,e.lighten(i)}static getDarkerColor(e,t,i){if(e.isDarkerThan(t))return e;i=i||.5;const n=e.getRelativeLuminance(),r=t.getRelativeLuminance();return i=i*(n-r)/n,e.darken(i)}};Rn.white=new Rn(new Jt(255,255,255,1)),Rn.black=new Rn(new Jt(0,0,0,1)),Rn.red=new Rn(new Jt(255,0,0,1)),Rn.blue=new Rn(new Jt(0,0,255,1)),Rn.green=new Rn(new Jt(0,255,0,1)),Rn.cyan=new Rn(new Jt(0,255,255,1)),Rn.lightgrey=new Rn(new Jt(211,211,211,1)),Rn.transparent=new Rn(new Jt(0,0,0,0));let fe=Rn;(function(s){(function(e){(function(t){function i(g){return g.rgba.a===1?`rgb(${g.rgba.r}, ${g.rgba.g}, ${g.rgba.b})`:s.Format.CSS.formatRGBA(g)}t.formatRGB=i;function n(g){return`rgba(${g.rgba.r}, ${g.rgba.g}, ${g.rgba.b}, ${+g.rgba.a.toFixed(2)})`}t.formatRGBA=n;function r(g){return g.hsla.a===1?`hsl(${g.hsla.h}, ${(g.hsla.s*100).toFixed(2)}%, ${(g.hsla.l*100).toFixed(2)}%)`:s.Format.CSS.formatHSLA(g)}t.formatHSL=r;function o(g){return`hsla(${g.hsla.h}, ${(g.hsla.s*100).toFixed(2)}%, ${(g.hsla.l*100).toFixed(2)}%, ${g.hsla.a.toFixed(2)})`}t.formatHSLA=o;function a(g){const p=g.toString(16);return p.length!==2?"0"+p:p}function l(g){return`#${a(g.rgba.r)}${a(g.rgba.g)}${a(g.rgba.b)}`}t.formatHex=l;function c(g,p=!1){return p&&g.rgba.a===1?s.Format.CSS.formatHex(g):`#${a(g.rgba.r)}${a(g.rgba.g)}${a(g.rgba.b)}${a(Math.round(g.rgba.a*255))}`}t.formatHexA=c;function d(g){return g.isOpaque()?s.Format.CSS.formatHex(g):s.Format.CSS.formatRGBA(g)}t.format=d;function u(g){const p=g.length;if(p===0||g.charCodeAt(0)!==35)return null;if(p===7){const _=16*h(g.charCodeAt(1))+h(g.charCodeAt(2)),v=16*h(g.charCodeAt(3))+h(g.charCodeAt(4)),C=16*h(g.charCodeAt(5))+h(g.charCodeAt(6));return new s(new Jt(_,v,C,1))}if(p===9){const _=16*h(g.charCodeAt(1))+h(g.charCodeAt(2)),v=16*h(g.charCodeAt(3))+h(g.charCodeAt(4)),C=16*h(g.charCodeAt(5))+h(g.charCodeAt(6)),y=16*h(g.charCodeAt(7))+h(g.charCodeAt(8));return new s(new Jt(_,v,C,y/255))}if(p===4){const _=h(g.charCodeAt(1)),v=h(g.charCodeAt(2)),C=h(g.charCodeAt(3));return new s(new Jt(16*_+_,16*v+v,16*C+C))}if(p===5){const _=h(g.charCodeAt(1)),v=h(g.charCodeAt(2)),C=h(g.charCodeAt(3)),y=h(g.charCodeAt(4));return new s(new Jt(16*_+_,16*v+v,16*C+C,(16*y+y)/255))}return null}t.parseHex=u;function h(g){switch(g){case 48:return 0;case 49:return 1;case 50:return 2;case 51:return 3;case 52:return 4;case 53:return 5;case 54:return 6;case 55:return 7;case 56:return 8;case 57:return 9;case 97:return 10;case 65:return 10;case 98:return 11;case 66:return 11;case 99:return 12;case 67:return 12;case 100:return 13;case 68:return 13;case 101:return 14;case 69:return 14;case 102:return 15;case 70:return 15}return 0}})(e.CSS||(e.CSS={}))})(s.Format||(s.Format={}))})(fe||(fe={}));function Fhe(s){const e=[];for(const t of s){const i=Number(t);(i||i===0&&t.replace(/\s/g,"")!=="")&&e.push(i)}return e}function eK(s,e,t,i){return{red:s/255,blue:t/255,green:e/255,alpha:i}}function xx(s,e){const t=e.index,i=e[0].length;if(!t)return;const n=s.positionAt(t);return{startLineNumber:n.lineNumber,startColumn:n.column,endLineNumber:n.lineNumber,endColumn:n.column+i}}function HMe(s,e){if(!s)return;const t=fe.Format.CSS.parseHex(e);if(t)return{range:s,color:eK(t.rgba.r,t.rgba.g,t.rgba.b,t.rgba.a)}}function iie(s,e,t){if(!s||e.length!==1)return;const n=e[0].values(),r=Fhe(n);return{range:s,color:eK(r[0],r[1],r[2],t?r[3]:1)}}function nie(s,e,t){if(!s||e.length!==1)return;const n=e[0].values(),r=Fhe(n),o=new fe(new Kc(r[0],r[1]/100,r[2]/100,t?r[3]:1));return{range:s,color:eK(o.rgba.r,o.rgba.g,o.rgba.b,o.rgba.a)}}function Lx(s,e){return typeof s=="string"?[...s.matchAll(e)]:s.findMatches(e)}function zMe(s){const e=[],i=Lx(s,/\b(rgb|rgba|hsl|hsla)(\([0-9\s,.\%]*\))|(#)([A-Fa-f0-9]{3})\b|(#)([A-Fa-f0-9]{4})\b|(#)([A-Fa-f0-9]{6})\b|(#)([A-Fa-f0-9]{8})\b/gm);if(i.length>0)for(const n of i){const r=n.filter(c=>c!==void 0),o=r[1],a=r[2];if(!a)continue;let l;if(o==="rgb"){const c=/^\(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*\)$/gm;l=iie(xx(s,n),Lx(a,c),!1)}else if(o==="rgba"){const c=/^\(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(0[.][0-9]+|[.][0-9]+|[01][.]|[01])\s*\)$/gm;l=iie(xx(s,n),Lx(a,c),!0)}else if(o==="hsl"){const c=/^\(\s*(36[0]|3[0-5][0-9]|[12][0-9][0-9]|[1-9]?[0-9])\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*\)$/gm;l=nie(xx(s,n),Lx(a,c),!1)}else if(o==="hsla"){const c=/^\(\s*(36[0]|3[0-5][0-9]|[12][0-9][0-9]|[1-9]?[0-9])\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*,\s*(0[.][0-9]+|[.][0-9]+|[01][.]|[01])\s*\)$/gm;l=nie(xx(s,n),Lx(a,c),!0)}else o==="#"&&(l=HMe(xx(s,n),o+a));l&&e.push(l)}return e}function UMe(s){return!s||typeof s.getValue!="function"||typeof s.positionAt!="function"?[]:zMe(s)}const sie=new RegExp("\\bMARK:\\s*(.*)$","d"),jMe=/^-+|-+$/g;function $Me(s,e){var i;let t=[];if(e.findRegionSectionHeaders&&((i=e.foldingRules)!=null&&i.markers)){const n=qMe(s,e);t=t.concat(n)}if(e.findMarkSectionHeaders){const n=KMe(s);t=t.concat(n)}return t}function qMe(s,e){const t=[],i=s.getLineCount();for(let n=1;n<=i;n++){const r=s.getLineContent(n),o=r.match(e.foldingRules.markers.start);if(o){const a={startLineNumber:n,startColumn:o[0].length+1,endLineNumber:n,endColumn:r.length+1};if(a.endColumn>a.startColumn){const l={range:a,...Vhe(r.substring(o[0].length)),shouldBeInComments:!1};(l.text||l.hasSeparatorLine)&&t.push(l)}}}return t}function KMe(s){const e=[],t=s.getLineCount();for(let i=1;i<=t;i++){const n=s.getLineContent(i);GMe(n,i,e)}return e}function GMe(s,e,t){sie.lastIndex=0;const i=sie.exec(s);if(i){const n=i.indices[1][0]+1,r=i.indices[1][1]+1,o={startLineNumber:e,startColumn:n,endLineNumber:e,endColumn:r};if(o.endColumn>o.startColumn){const a={range:o,...Vhe(i[1]),shouldBeInComments:!0};(a.text||a.hasSeparatorLine)&&t.push(a)}}}function Vhe(s){s=s.trim();const e=s.startsWith("-");return s=s.replace(jMe,""),{text:s,hasSeparatorLine:e}}class QMe{constructor(e){this.values=e,this.prefixSum=new Uint32Array(e.length),this.prefixSumValidIndex=new Int32Array(1),this.prefixSumValidIndex[0]=-1}insertValues(e,t){e=j0(e);const i=this.values,n=this.prefixSum,r=t.length;return r===0?!1:(this.values=new Uint32Array(i.length+r),this.values.set(i.subarray(0,e),0),this.values.set(i.subarray(e),e+r),this.values.set(t,e),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSum=new Uint32Array(this.values.length),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(n.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}setValue(e,t){return e=j0(e),t=j0(t),this.values[e]===t?!1:(this.values[e]=t,e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),!0)}removeValues(e,t){e=j0(e),t=j0(t);const i=this.values,n=this.prefixSum;if(e>=i.length)return!1;const r=i.length-e;return t>=r&&(t=r),t===0?!1:(this.values=new Uint32Array(i.length-t),this.values.set(i.subarray(0,e),0),this.values.set(i.subarray(e+t),e),this.prefixSum=new Uint32Array(this.values.length),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(n.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}getTotalSum(){return this.values.length===0?0:this._getPrefixSum(this.values.length-1)}getPrefixSum(e){return e<0?0:(e=j0(e),this._getPrefixSum(e))}_getPrefixSum(e){if(e<=this.prefixSumValidIndex[0])return this.prefixSum[e];let t=this.prefixSumValidIndex[0]+1;t===0&&(this.prefixSum[0]=this.values[0],t++),e>=this.values.length&&(e=this.values.length-1);for(let i=t;i<=e;i++)this.prefixSum[i]=this.prefixSum[i-1]+this.values[i];return this.prefixSumValidIndex[0]=Math.max(this.prefixSumValidIndex[0],e),this.prefixSum[e]}getIndexOf(e){e=Math.floor(e),this.getTotalSum();let t=0,i=this.values.length-1,n=0,r=0,o=0;for(;t<=i;)if(n=t+(i-t)/2|0,r=this.prefixSum[n],o=r-this.values[n],e<o)i=n-1;else if(e>=r)t=n+1;else break;return new Bhe(n,e-o)}}class YMe{constructor(e){this._values=e,this._isValid=!1,this._validEndIndex=-1,this._prefixSum=[],this._indexBySum=[]}getTotalSum(){return this._ensureValid(),this._indexBySum.length}getPrefixSum(e){return this._ensureValid(),e===0?0:this._prefixSum[e-1]}getIndexOf(e){this._ensureValid();const t=this._indexBySum[e],i=t>0?this._prefixSum[t-1]:0;return new Bhe(t,e-i)}removeValues(e,t){this._values.splice(e,t),this._invalidate(e)}insertValues(e,t){this._values=K4(this._values,e,t),this._invalidate(e)}_invalidate(e){this._isValid=!1,this._validEndIndex=Math.min(this._validEndIndex,e-1)}_ensureValid(){if(!this._isValid){for(let e=this._validEndIndex+1,t=this._values.length;e<t;e++){const i=this._values[e],n=e>0?this._prefixSum[e-1]:0;this._prefixSum[e]=n+i;for(let r=0;r<i;r++)this._indexBySum[n+r]=e}this._prefixSum.length=this._values.length,this._indexBySum.length=this._prefixSum[this._prefixSum.length-1],this._isValid=!0,this._validEndIndex=this._values.length-1}}setValue(e,t){this._values[e]!==t&&(this._values[e]=t,this._invalidate(e))}}class Bhe{constructor(e,t){this.index=e,this.remainder=t,this._prefixSumIndexOfResultBrand=void 0,this.index=e,this.remainder=t}}class XMe{constructor(e,t,i,n){this._uri=e,this._lines=t,this._eol=i,this._versionId=n,this._lineStarts=null,this._cachedTextValue=null}dispose(){this._lines.length=0}get version(){return this._versionId}getText(){return this._cachedTextValue===null&&(this._cachedTextValue=this._lines.join(this._eol)),this._cachedTextValue}onEvents(e){e.eol&&e.eol!==this._eol&&(this._eol=e.eol,this._lineStarts=null);const t=e.changes;for(const i of t)this._acceptDeleteRange(i.range),this._acceptInsertText(new X(i.range.startLineNumber,i.range.startColumn),i.text);this._versionId=e.versionId,this._cachedTextValue=null}_ensureLineStarts(){if(!this._lineStarts){const e=this._eol.length,t=this._lines.length,i=new Uint32Array(t);for(let n=0;n<t;n++)i[n]=this._lines[n].length+e;this._lineStarts=new QMe(i)}}_setLineText(e,t){this._lines[e]=t,this._lineStarts&&this._lineStarts.setValue(e,this._lines[e].length+this._eol.length)}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.startLineNumber-1].substring(e.endColumn-1));return}this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.endLineNumber-1].substring(e.endColumn-1)),this._lines.splice(e.startLineNumber,e.endLineNumber-e.startLineNumber),this._lineStarts&&this._lineStarts.removeValues(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t){if(t.length===0)return;const i=Uh(t);if(i.length===1){this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]+this._lines[e.lineNumber-1].substring(e.column-1));return}i[i.length-1]+=this._lines[e.lineNumber-1].substring(e.column-1),this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]);const n=new Uint32Array(i.length-1);for(let r=1;r<i.length;r++)this._lines.splice(e.lineNumber+r-1,0,i[r]),n[r-1]=i[r].length+this._eol.length;this._lineStarts&&this._lineStarts.insertValues(e.lineNumber,n)}}const rie=60*1e3;class ZMe extends te{constructor(e,t,i=!1){if(super(),this._syncedModels=Object.create(null),this._syncedModelsLastUsedTime=Object.create(null),this._proxy=e,this._modelService=t,!i){const n=new Fq;n.cancelAndSet(()=>this._checkStopModelSync(),Math.round(rie/2)),this._register(n)}}dispose(){for(const e in this._syncedModels)Ni(this._syncedModels[e]);this._syncedModels=Object.create(null),this._syncedModelsLastUsedTime=Object.create(null),super.dispose()}ensureSyncedResources(e,t=!1){for(const i of e){const n=i.toString();this._syncedModels[n]||this._beginModelSync(i,t),this._syncedModels[n]&&(this._syncedModelsLastUsedTime[n]=new Date().getTime())}}_checkStopModelSync(){const e=new Date().getTime(),t=[];for(const i in this._syncedModelsLastUsedTime)e-this._syncedModelsLastUsedTime[i]>rie&&t.push(i);for(const i of t)this._stopModelSync(i)}_beginModelSync(e,t){const i=this._modelService.getModel(e);if(!i||!t&&i.isTooLargeForSyncing())return;const n=e.toString();this._proxy.$acceptNewModel({url:i.uri.toString(),lines:i.getLinesContent(),EOL:i.getEOL(),versionId:i.getVersionId()});const r=new ce;r.add(i.onDidChangeContent(o=>{this._proxy.$acceptModelChanged(n.toString(),o)})),r.add(i.onWillDispose(()=>{this._stopModelSync(n)})),r.add(Ye(()=>{this._proxy.$acceptRemovedModel(n)})),this._syncedModels[n]=r}_stopModelSync(e){const t=this._syncedModels[e];delete this._syncedModels[e],delete this._syncedModelsLastUsedTime[e],Ni(t)}}class JMe{constructor(){this._models=Object.create(null)}getModel(e){return this._models[e]}getModels(){const e=[];return Object.keys(this._models).forEach(t=>e.push(this._models[t])),e}$acceptNewModel(e){this._models[e.url]=new eOe(Je.parse(e.url),e.lines,e.EOL,e.versionId)}$acceptModelChanged(e,t){if(!this._models[e])return;this._models[e].onEvents(t)}$acceptRemovedModel(e){this._models[e]&&delete this._models[e]}}class eOe extends XMe{get uri(){return this._uri}get eol(){return this._eol}getValue(){return this.getText()}findMatches(e){const t=[];for(let i=0;i<this._lines.length;i++){const n=this._lines[i],r=this.offsetAt(new X(i+1,1)),o=n.matchAll(e);for(const a of o)(a.index||a.index===0)&&(a.index=a.index+r),t.push(a)}return t}getLinesContent(){return this._lines.slice(0)}getLineCount(){return this._lines.length}getLineContent(e){return this._lines[e-1]}getWordAtPosition(e,t){const i=Gk(e.column,Cq(t),this._lines[e.lineNumber-1],0);return i?new F(e.lineNumber,i.startColumn,e.lineNumber,i.endColumn):null}words(e){const t=this._lines,i=this._wordenize.bind(this);let n=0,r="",o=0,a=[];return{*[Symbol.iterator](){for(;;)if(o<a.length){const l=r.substring(a[o].start,a[o].end);o+=1,yield l}else if(n<t.length)r=t[n],a=i(r,e),o=0,n+=1;else break}}}getLineWords(e,t){const i=this._lines[e-1],n=this._wordenize(i,t),r=[];for(const o of n)r.push({word:i.substring(o.start,o.end),startColumn:o.start+1,endColumn:o.end+1});return r}_wordenize(e,t){const i=[];let n;for(t.lastIndex=0;(n=t.exec(e))&&n[0].length!==0;)i.push({start:n.index,end:n.index+n[0].length});return i}getValueInRange(e){if(e=this._validateRange(e),e.startLineNumber===e.endLineNumber)return this._lines[e.startLineNumber-1].substring(e.startColumn-1,e.endColumn-1);const t=this._eol,i=e.startLineNumber-1,n=e.endLineNumber-1,r=[];r.push(this._lines[i].substring(e.startColumn-1));for(let o=i+1;o<n;o++)r.push(this._lines[o]);return r.push(this._lines[n].substring(0,e.endColumn-1)),r.join(t)}offsetAt(e){return e=this._validatePosition(e),this._ensureLineStarts(),this._lineStarts.getPrefixSum(e.lineNumber-2)+(e.column-1)}positionAt(e){e=Math.floor(e),e=Math.max(0,e),this._ensureLineStarts();const t=this._lineStarts.getIndexOf(e),i=this._lines[t.index].length;return{lineNumber:1+t.index,column:1+Math.min(t.remainder,i)}}_validateRange(e){const t=this._validatePosition({lineNumber:e.startLineNumber,column:e.startColumn}),i=this._validatePosition({lineNumber:e.endLineNumber,column:e.endColumn});return t.lineNumber!==e.startLineNumber||t.column!==e.startColumn||i.lineNumber!==e.endLineNumber||i.column!==e.endColumn?{startLineNumber:t.lineNumber,startColumn:t.column,endLineNumber:i.lineNumber,endColumn:i.column}:e}_validatePosition(e){if(!X.isIPosition(e))throw new Error("bad position");let{lineNumber:t,column:i}=e,n=!1;if(t<1)t=1,i=1,n=!0;else if(t>this._lines.length)t=this._lines.length,i=this._lines[t-1].length+1,n=!0;else{const r=this._lines[t-1].length+1;i<1?(i=1,n=!0):i>r&&(i=r,n=!0)}return n?{lineNumber:t,column:i}:e}}const HM=class HM{constructor(){this._workerTextModelSyncServer=new JMe}dispose(){}_getModel(e){return this._workerTextModelSyncServer.getModel(e)}_getModels(){return this._workerTextModelSyncServer.getModels()}$acceptNewModel(e){this._workerTextModelSyncServer.$acceptNewModel(e)}$acceptModelChanged(e,t){this._workerTextModelSyncServer.$acceptModelChanged(e,t)}$acceptRemovedModel(e){this._workerTextModelSyncServer.$acceptRemovedModel(e)}async $computeUnicodeHighlights(e,t,i){const n=this._getModel(e);return n?Yq.computeUnicodeHighlights(n,t,i):{ranges:[],hasMore:!1,ambiguousCharacterCount:0,invisibleCharacterCount:0,nonBasicAsciiCharacterCount:0}}async $findSectionHeaders(e,t){const i=this._getModel(e);return i?$Me(i,t):[]}async $computeDiff(e,t,i,n){const r=this._getModel(e),o=this._getModel(t);return!r||!o?null:IR.computeDiff(r,o,i,n)}static computeDiff(e,t,i,n){const r=n==="advanced"?tie.getDefault():tie.getLegacy(),o=e.getLinesContent(),a=t.getLinesContent(),l=r.computeDiff(o,a,i),c=l.changes.length>0?!1:this._modelsAreIdentical(e,t);function d(u){return u.map(h=>{var g;return[h.original.startLineNumber,h.original.endLineNumberExclusive,h.modified.startLineNumber,h.modified.endLineNumberExclusive,(g=h.innerChanges)==null?void 0:g.map(p=>[p.originalRange.startLineNumber,p.originalRange.startColumn,p.originalRange.endLineNumber,p.originalRange.endColumn,p.modifiedRange.startLineNumber,p.modifiedRange.startColumn,p.modifiedRange.endLineNumber,p.modifiedRange.endColumn])]})}return{identical:c,quitEarly:l.hitTimeout,changes:d(l.changes),moves:l.moves.map(u=>[u.lineRangeMapping.original.startLineNumber,u.lineRangeMapping.original.endLineNumberExclusive,u.lineRangeMapping.modified.startLineNumber,u.lineRangeMapping.modified.endLineNumberExclusive,d(u.changes)])}}static _modelsAreIdentical(e,t){const i=e.getLineCount(),n=t.getLineCount();if(i!==n)return!1;for(let r=1;r<=i;r++){const o=e.getLineContent(r),a=t.getLineContent(r);if(o!==a)return!1}return!0}async $computeMoreMinimalEdits(e,t,i){const n=this._getModel(e);if(!n)return t;const r=[];let o;t=t.slice(0).sort((l,c)=>{if(l.range&&c.range)return F.compareRangesUsingStarts(l.range,c.range);const d=l.range?0:1,u=c.range?0:1;return d-u});let a=0;for(let l=1;l<t.length;l++)F.getEndPosition(t[a].range).equals(F.getStartPosition(t[l].range))?(t[a].range=F.fromPositions(F.getStartPosition(t[a].range),F.getEndPosition(t[l].range)),t[a].text+=t[l].text):(a++,t[a]=t[l]);t.length=a+1;for(let{range:l,text:c,eol:d}of t){if(typeof d=="number"&&(o=d),F.isEmpty(l)&&!c)continue;const u=n.getValueInRange(l);if(c=c.replace(/\r\n|\n|\r/g,n.eol),u===c)continue;if(Math.max(c.length,u.length)>IR._diffLimit){r.push({range:l,text:c});continue}const h=UPe(u,c,i),g=n.offsetAt(F.lift(l).getStartPosition());for(const p of h){const _=n.positionAt(g+p.originalStart),v=n.positionAt(g+p.originalStart+p.originalLength),C={text:c.substr(p.modifiedStart,p.modifiedLength),range:{startLineNumber:_.lineNumber,startColumn:_.column,endLineNumber:v.lineNumber,endColumn:v.column}};n.getValueInRange(C.range)!==C.text&&r.push(C)}}return typeof o=="number"&&r.push({eol:o,text:"",range:{startLineNumber:0,startColumn:0,endLineNumber:0,endColumn:0}}),r}async $computeLinks(e){const t=this._getModel(e);return t?GPe(t):null}async $computeDefaultDocumentColors(e){const t=this._getModel(e);return t?UMe(t):null}async $textualSuggest(e,t,i,n){const r=new Bs,o=new RegExp(i,n),a=new Set;e:for(const l of e){const c=this._getModel(l);if(c){for(const d of c.words(o))if(!(d===t||!isNaN(Number(d)))&&(a.add(d),a.size>IR._suggestionsLimit))break e}}return{words:Array.from(a),duration:r.elapsed()}}async $computeWordRanges(e,t,i,n){const r=this._getModel(e);if(!r)return Object.create(null);const o=new RegExp(i,n),a=Object.create(null);for(let l=t.startLineNumber;l<t.endLineNumber;l++){const c=r.getLineWords(l,o);for(const d of c){if(!isNaN(Number(d.word)))continue;let u=a[d.word];u||(u=[],a[d.word]=u),u.push({startLineNumber:l,startColumn:d.startColumn,endLineNumber:l,endColumn:d.endColumn})}}return a}async $navigateValueSet(e,t,i,n,r){const o=this._getModel(e);if(!o)return null;const a=new RegExp(n,r);t.startColumn===t.endColumn&&(t={startLineNumber:t.startLineNumber,startColumn:t.startColumn,endLineNumber:t.endLineNumber,endColumn:t.endColumn+1});const l=o.getValueInRange(t),c=o.getWordAtPosition({lineNumber:t.startLineNumber,column:t.startColumn},a);if(!c)return null;const d=o.getValueInRange(c);return l6.INSTANCE.navigateValueSet(t,l,c,d,i)}};HM._diffLimit=1e5,HM._suggestionsLimit=1e4;let g6=HM;class IR extends g6{constructor(e,t){super(),this._host=e,this._foreignModuleFactory=t,this._foreignModule=null}async $ping(){return"pong"}$loadForeignModule(e,t,i){const o={host:FTe(i,(a,l)=>this._host.$fhr(a,l)),getMirrorModels:()=>this._getModels()};return this._foreignModuleFactory?(this._foreignModule=this._foreignModuleFactory(o,t),Promise.resolve(A7(this._foreignModule))):new Promise((a,l)=>{const c=d=>{this._foreignModule=d.create(o,t),a(A7(this._foreignModule))};{const d=eF.asBrowserUri(`${e}.js`).toString(!0);et(()=>import(`${d}`),[]).then(c).catch(l)}})}$fmr(e,t){if(!this._foreignModule||typeof this._foreignModule[e]!="function")return Promise.reject(new Error("Missing requestHandler or method: "+e));try{return Promise.resolve(this._foreignModule[e].apply(this._foreignModule,t))}catch(i){return Promise.reject(i)}}}typeof importScripts=="function"&&(globalThis.monaco=Lue());const vF=Ht("textResourceConfigurationService"),Whe=Ht("textResourcePropertiesService"),Be=Ht("ILanguageFeaturesService");var tK=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},_b=function(s,e){return function(t,i){e(t,i,s)}};const oie=5*60*1e3;function bb(s,e){const t=s.getModel(e);return!(!t||t.isTooLargeForSyncing())}let p6=class extends te{constructor(e,t,i,n,r,o){super(),this._languageConfigurationService=r,this._modelService=t,this._workerManager=this._register(new m6(e,this._modelService)),this._logService=n,this._register(o.linkProvider.register({language:"*",hasAccessToAllModels:!0},{provideLinks:async(a,l)=>{if(!bb(this._modelService,a.uri))return Promise.resolve({links:[]});const d=await(await this._workerWithResources([a.uri])).$computeLinks(a.uri.toString());return d&&{links:d}}})),this._register(o.completionProvider.register("*",new tOe(this._workerManager,i,this._modelService,this._languageConfigurationService)))}dispose(){super.dispose()}canComputeUnicodeHighlights(e){return bb(this._modelService,e)}async computedUnicodeHighlights(e,t,i){return(await this._workerWithResources([e])).$computeUnicodeHighlights(e.toString(),t,i)}async computeDiff(e,t,i,n){const o=await(await this._workerWithResources([e,t],!0)).$computeDiff(e.toString(),t.toString(),i,n);if(!o)return null;return{identical:o.identical,quitEarly:o.quitEarly,changes:l(o.changes),moves:o.moves.map(c=>new Rhe(new Qr(new Ct(c[0],c[1]),new Ct(c[2],c[3])),l(c[4])))};function l(c){return c.map(d=>{var u;return new El(new Ct(d[0],d[1]),new Ct(d[2],d[3]),(u=d[4])==null?void 0:u.map(h=>new hl(new F(h[0],h[1],h[2],h[3]),new F(h[4],h[5],h[6],h[7]))))})}}async computeMoreMinimalEdits(e,t,i=!1){if(Xr(t)){if(!bb(this._modelService,e))return Promise.resolve(t);const n=Bs.create(),r=this._workerWithResources([e]).then(o=>o.$computeMoreMinimalEdits(e.toString(),t,i));return r.finally(()=>this._logService.trace("FORMAT#computeMoreMinimalEdits",e.toString(!0),n.elapsed())),Promise.race([r,Sg(1e3).then(()=>t)])}else return Promise.resolve(void 0)}canNavigateValueSet(e){return bb(this._modelService,e)}async navigateValueSet(e,t,i){const n=this._modelService.getModel(e);if(!n)return null;const r=this._languageConfigurationService.getLanguageConfiguration(n.getLanguageId()).getWordDefinition(),o=r.source,a=r.flags;return(await this._workerWithResources([e])).$navigateValueSet(e.toString(),t,i,o,a)}canComputeWordRanges(e){return bb(this._modelService,e)}async computeWordRanges(e,t){const i=this._modelService.getModel(e);if(!i)return Promise.resolve(null);const n=this._languageConfigurationService.getLanguageConfiguration(i.getLanguageId()).getWordDefinition(),r=n.source,o=n.flags;return(await this._workerWithResources([e])).$computeWordRanges(e.toString(),t,r,o)}async findSectionHeaders(e,t){return(await this._workerWithResources([e])).$findSectionHeaders(e.toString(),t)}async computeDefaultDocumentColors(e){return(await this._workerWithResources([e])).$computeDefaultDocumentColors(e.toString())}async _workerWithResources(e,t=!1){return await(await this._workerManager.withWorker()).workerWithSyncedResources(e,t)}};p6=tK([_b(1,Gi),_b(2,vF),_b(3,pr),_b(4,bn),_b(5,Be)],p6);class tOe{constructor(e,t,i,n){this.languageConfigurationService=n,this._debugDisplayName="wordbasedCompletions",this._workerManager=e,this._configurationService=t,this._modelService=i}async provideCompletionItems(e,t){const i=this._configurationService.getValue(e.uri,t,"editor");if(i.wordBasedSuggestions==="off")return;const n=[];if(i.wordBasedSuggestions==="currentDocument")bb(this._modelService,e.uri)&&n.push(e.uri);else for(const u of this._modelService.getModels())bb(this._modelService,u.uri)&&(u===e?n.unshift(u.uri):(i.wordBasedSuggestions==="allDocuments"||u.getLanguageId()===e.getLanguageId())&&n.push(u.uri));if(n.length===0)return;const r=this.languageConfigurationService.getLanguageConfiguration(e.getLanguageId()).getWordDefinition(),o=e.getWordAtPosition(t),a=o?new F(t.lineNumber,o.startColumn,t.lineNumber,o.endColumn):F.fromPositions(t),l=a.setEndPosition(t.lineNumber,t.column),d=await(await this._workerManager.withWorker()).textualSuggest(n,o==null?void 0:o.word,r);if(d)return{duration:d.duration,suggestions:d.words.map(u=>({kind:18,label:u,insertText:u,range:{insert:l,replace:a}}))}}}let m6=class extends te{constructor(e,t){super(),this._workerDescriptor=e,this._modelService=t,this._editorWorkerClient=null,this._lastWorkerUsedTime=new Date().getTime(),this._register(new Bq).cancelAndSet(()=>this._checkStopIdleWorker(),Math.round(oie/2),Ri),this._register(this._modelService.onModelRemoved(n=>this._checkStopEmptyWorker()))}dispose(){this._editorWorkerClient&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null),super.dispose()}_checkStopEmptyWorker(){if(!this._editorWorkerClient)return;this._modelService.getModels().length===0&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null)}_checkStopIdleWorker(){if(!this._editorWorkerClient)return;new Date().getTime()-this._lastWorkerUsedTime>oie&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null)}withWorker(){return this._lastWorkerUsedTime=new Date().getTime(),this._editorWorkerClient||(this._editorWorkerClient=new nA(this._workerDescriptor,!1,this._modelService)),Promise.resolve(this._editorWorkerClient)}};m6=tK([_b(1,Gi)],m6);class iOe{constructor(e){this._instance=e,this.proxy=this._instance}dispose(){this._instance.dispose()}setChannel(e,t){throw new Error("Not supported")}}let nA=class extends te{constructor(e,t,i){super(),this._workerDescriptor=e,this._disposed=!1,this._modelService=i,this._keepIdleModels=t,this._worker=null,this._modelManager=null}fhr(e,t){throw new Error("Not implemented!")}_getOrCreateWorker(){if(!this._worker)try{this._worker=this._register(oPe(this._workerDescriptor)),c6.setChannel(this._worker,this._createEditorWorkerHost())}catch(e){i6(e),this._worker=this._createFallbackLocalWorker()}return this._worker}async _getProxy(){try{const e=this._getOrCreateWorker().proxy;return await e.$ping(),e}catch(e){return i6(e),this._worker=this._createFallbackLocalWorker(),this._worker.proxy}}_createFallbackLocalWorker(){return new iOe(new IR(this._createEditorWorkerHost(),null))}_createEditorWorkerHost(){return{$fhr:(e,t)=>this.fhr(e,t)}}_getOrCreateModelManager(e){return this._modelManager||(this._modelManager=this._register(new ZMe(e,this._modelService,this._keepIdleModels))),this._modelManager}async workerWithSyncedResources(e,t=!1){if(this._disposed)return Promise.reject(jNe());const i=await this._getProxy();return this._getOrCreateModelManager(i).ensureSyncedResources(e,t),i}async textualSuggest(e,t,i){const n=await this.workerWithSyncedResources(e),r=i.source,o=i.flags;return n.$textualSuggest(e.map(a=>a.toString()),t,r,o)}dispose(){super.dispose(),this._disposed=!0}};nA=tK([_b(2,Gi)],nA);var uc;(function(s){s.DARK="dark",s.LIGHT="light",s.HIGH_CONTRAST_DARK="hcDark",s.HIGH_CONTRAST_LIGHT="hcLight"})(uc||(uc={}));function su(s){return s===uc.HIGH_CONTRAST_DARK||s===uc.HIGH_CONTRAST_LIGHT}function m1(s){return s===uc.DARK||s===uc.HIGH_CONTRAST_DARK}const gs=Ht("themeService");function kn(s){return{id:s}}function _6(s){switch(s){case uc.DARK:return"vs-dark";case uc.HIGH_CONTRAST_DARK:return"hc-black";case uc.HIGH_CONTRAST_LIGHT:return"hc-light";default:return"vs"}}const Hhe={ThemingContribution:"base.contributions.theming"};class nOe{constructor(){this.themingParticipants=[],this.themingParticipants=[],this.onThemingParticipantAddedEmitter=new Z}onColorThemeChange(e){return this.themingParticipants.push(e),this.onThemingParticipantAddedEmitter.fire(e),Ye(()=>{const t=this.themingParticipants.indexOf(e);this.themingParticipants.splice(t,1)})}getThemingParticipants(){return this.themingParticipants}}const zhe=new nOe;_n.add(Hhe.ThemingContribution,zhe);function Lc(s){return zhe.onColorThemeChange(s)}class sOe extends te{constructor(e){super(),this.themeService=e,this.theme=e.getColorTheme(),this._register(this.themeService.onDidColorThemeChange(t=>this.onThemeChange(t)))}onThemeChange(e){this.theme=e,this.updateStyles()}updateStyles(){}}var rOe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},oOe=function(s,e){return function(t,i){e(t,i,s)}};let b6=class extends te{constructor(e){super(),this._themeService=e,this._onWillCreateCodeEditor=this._register(new Z),this._onCodeEditorAdd=this._register(new Z),this.onCodeEditorAdd=this._onCodeEditorAdd.event,this._onCodeEditorRemove=this._register(new Z),this.onCodeEditorRemove=this._onCodeEditorRemove.event,this._onWillCreateDiffEditor=this._register(new Z),this._onDiffEditorAdd=this._register(new Z),this.onDiffEditorAdd=this._onDiffEditorAdd.event,this._onDiffEditorRemove=this._register(new Z),this.onDiffEditorRemove=this._onDiffEditorRemove.event,this._decorationOptionProviders=new Map,this._codeEditorOpenHandlers=new _o,this._modelProperties=new Map,this._codeEditors=Object.create(null),this._diffEditors=Object.create(null),this._globalStyleSheet=null}willCreateCodeEditor(){this._onWillCreateCodeEditor.fire()}addCodeEditor(e){this._codeEditors[e.getId()]=e,this._onCodeEditorAdd.fire(e)}removeCodeEditor(e){delete this._codeEditors[e.getId()]&&this._onCodeEditorRemove.fire(e)}listCodeEditors(){return Object.keys(this._codeEditors).map(e=>this._codeEditors[e])}willCreateDiffEditor(){this._onWillCreateDiffEditor.fire()}addDiffEditor(e){this._diffEditors[e.getId()]=e,this._onDiffEditorAdd.fire(e)}listDiffEditors(){return Object.keys(this._diffEditors).map(e=>this._diffEditors[e])}getFocusedCodeEditor(){let e=null;const t=this.listCodeEditors();for(const i of t){if(i.hasTextFocus())return i;i.hasWidgetFocus()&&(e=i)}return e}removeDecorationType(e){const t=this._decorationOptionProviders.get(e);t&&(t.refCount--,t.refCount<=0&&(this._decorationOptionProviders.delete(e),t.dispose(),this.listCodeEditors().forEach(i=>i.removeDecorationsByType(e))))}setModelProperty(e,t,i){const n=e.toString();let r;this._modelProperties.has(n)?r=this._modelProperties.get(n):(r=new Map,this._modelProperties.set(n,r)),r.set(t,i)}getModelProperty(e,t){const i=e.toString();if(this._modelProperties.has(i))return this._modelProperties.get(i).get(t)}async openCodeEditor(e,t,i){for(const n of this._codeEditorOpenHandlers){const r=await n(e,t,i);if(r!==null)return r}return null}registerCodeEditorOpenHandler(e){const t=this._codeEditorOpenHandlers.unshift(e);return Ye(t)}};b6=rOe([oOe(0,gs)],b6);var aOe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},aie=function(s,e){return function(t,i){e(t,i,s)}};let sA=class extends b6{constructor(e,t){super(t),this._register(this.onCodeEditorAdd(()=>this._checkContextKey())),this._register(this.onCodeEditorRemove(()=>this._checkContextKey())),this._editorIsOpen=e.createKey("editorIsOpen",!1),this._activeCodeEditor=null,this._register(this.registerCodeEditorOpenHandler(async(i,n,r)=>n?this.doOpenEditor(n,i):null))}_checkContextKey(){let e=!1;for(const t of this.listCodeEditors())if(!t.isSimpleWidget){e=!0;break}this._editorIsOpen.set(e)}setActiveCodeEditor(e){this._activeCodeEditor=e}getActiveCodeEditor(){return this._activeCodeEditor}doOpenEditor(e,t){if(!this.findModel(e,t.resource)){if(t.resource){const r=t.resource.scheme;if(r===gt.http||r===gt.https)return ohe(t.resource.toString()),e}return null}const n=t.options?t.options.selection:null;if(n)if(typeof n.endLineNumber=="number"&&typeof n.endColumn=="number")e.setSelection(n),e.revealRangeInCenter(n,1);else{const r={lineNumber:n.startLineNumber,column:n.startColumn};e.setPosition(r),e.revealPositionInCenter(r,1)}return e}findModel(e,t){const i=e.getModel();return i&&i.uri.toString()!==t.toString()?null:i}};sA=aOe([aie(0,ct),aie(1,gs)],sA);qt(ni,sA,0);const g_=Ht("layoutService");var Uhe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},jhe=function(s,e){return function(t,i){e(t,i,s)}};let rA=class{get mainContainer(){var e;return((e=pq(this._codeEditorService.listCodeEditors()))==null?void 0:e.getContainerDomNode())??Ri.document.body}get activeContainer(){const e=this._codeEditorService.getFocusedCodeEditor()??this._codeEditorService.getActiveCodeEditor();return(e==null?void 0:e.getContainerDomNode())??this.mainContainer}get mainContainerDimension(){return qm(this.mainContainer)}get activeContainerDimension(){return qm(this.activeContainer)}get containers(){return rd(this._codeEditorService.listCodeEditors().map(e=>e.getContainerDomNode()))}getContainer(){return this.activeContainer}whenContainerStylesLoaded(){}focus(){var e;(e=this._codeEditorService.getFocusedCodeEditor())==null||e.focus()}constructor(e){this._codeEditorService=e,this.onDidLayoutMainContainer=De.None,this.onDidLayoutActiveContainer=De.None,this.onDidLayoutContainer=De.None,this.onDidChangeActiveContainer=De.None,this.onDidAddContainer=De.None,this.mainContainerOffset={top:0,quickPickTop:0},this.activeContainerOffset={top:0,quickPickTop:0}}};rA=Uhe([jhe(0,ni)],rA);let v6=class extends rA{get mainContainer(){return this._container}constructor(e,t){super(t),this._container=e}};v6=Uhe([jhe(1,ni)],v6);qt(g_,rA,1);var dI;(function(s){s[s.Ignore=0]="Ignore",s[s.Info=1]="Info",s[s.Warning=2]="Warning",s[s.Error=3]="Error"})(dI||(dI={}));(function(s){const e="error",t="warning",i="warn",n="info",r="ignore";function o(l){return l?SC(e,l)?s.Error:SC(t,l)||SC(i,l)?s.Warning:SC(n,l)?s.Info:s.Ignore:s.Ignore}s.fromValue=o;function a(l){switch(l){case s.Error:return e;case s.Warning:return t;case s.Info:return n;default:return r}}s.toString=a})(dI||(dI={}));const Hn=dI,KE=Ht("dialogService");var wF=Hn;const jn=Ht("notificationService");class lOe{}const iK=Ht("undoRedoService");class $he{constructor(e,t){this.resource=e,this.elements=t}}const XC=class XC{constructor(){this.id=XC._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}};XC._ID=0,XC.None=new XC;let w6=XC;const ZC=class ZC{constructor(){this.id=ZC._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}};ZC._ID=0,ZC.None=new ZC;let vb=ZC;var cOe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},lie=function(s,e){return function(t,i){e(t,i,s)}};function sN(s){return s.scheme===gt.file?s.fsPath:s.path}let qhe=0;class rN{constructor(e,t,i,n,r,o,a){this.id=++qhe,this.type=0,this.actual=e,this.label=e.label,this.confirmBeforeUndo=e.confirmBeforeUndo||!1,this.resourceLabel=t,this.strResource=i,this.resourceLabels=[this.resourceLabel],this.strResources=[this.strResource],this.groupId=n,this.groupOrder=r,this.sourceId=o,this.sourceOrder=a,this.isValid=!0}setValid(e){this.isValid=e}toString(){return`[id:${this.id}] [group:${this.groupId}] [${this.isValid?"  VALID":"INVALID"}] ${this.actual.constructor.name} - ${this.actual}`}}class cie{constructor(e,t){this.resourceLabel=e,this.reason=t}}class die{constructor(){this.elements=new Map}createMessage(){const e=[],t=[];for(const[,n]of this.elements)(n.reason===0?e:t).push(n.resourceLabel);const i=[];return e.length>0&&i.push(b({key:"externalRemoval",comment:["{0} is a list of filenames"]},"The following files have been closed and modified on disk: {0}.",e.join(", "))),t.length>0&&i.push(b({key:"noParallelUniverses",comment:["{0} is a list of filenames"]},"The following files have been modified in an incompatible way: {0}.",t.join(", "))),i.join(`
`)}get size(){return this.elements.size}has(e){return this.elements.has(e)}set(e,t){this.elements.set(e,t)}delete(e){return this.elements.delete(e)}}class dOe{constructor(e,t,i,n,r,o,a){this.id=++qhe,this.type=1,this.actual=e,this.label=e.label,this.confirmBeforeUndo=e.confirmBeforeUndo||!1,this.resourceLabels=t,this.strResources=i,this.groupId=n,this.groupOrder=r,this.sourceId=o,this.sourceOrder=a,this.removedResources=null,this.invalidatedResources=null}canSplit(){return typeof this.actual.split=="function"}removeResource(e,t,i){this.removedResources||(this.removedResources=new die),this.removedResources.has(t)||this.removedResources.set(t,new cie(e,i))}setValid(e,t,i){i?this.invalidatedResources&&(this.invalidatedResources.delete(t),this.invalidatedResources.size===0&&(this.invalidatedResources=null)):(this.invalidatedResources||(this.invalidatedResources=new die),this.invalidatedResources.has(t)||this.invalidatedResources.set(t,new cie(e,0)))}toString(){return`[id:${this.id}] [group:${this.groupId}] [${this.invalidatedResources?"INVALID":"  VALID"}] ${this.actual.constructor.name} - ${this.actual}`}}class Khe{constructor(e,t){this.resourceLabel=e,this.strResource=t,this._past=[],this._future=[],this.locked=!1,this.versionId=1}dispose(){for(const e of this._past)e.type===1&&e.removeResource(this.resourceLabel,this.strResource,0);for(const e of this._future)e.type===1&&e.removeResource(this.resourceLabel,this.strResource,0);this.versionId++}toString(){const e=[];e.push(`* ${this.strResource}:`);for(let t=0;t<this._past.length;t++)e.push(`   * [UNDO] ${this._past[t]}`);for(let t=this._future.length-1;t>=0;t--)e.push(`   * [REDO] ${this._future[t]}`);return e.join(`
`)}flushAllElements(){this._past=[],this._future=[],this.versionId++}_setElementValidFlag(e,t){e.type===1?e.setValid(this.resourceLabel,this.strResource,t):e.setValid(t)}setElementsValidFlag(e,t){for(const i of this._past)t(i.actual)&&this._setElementValidFlag(i,e);for(const i of this._future)t(i.actual)&&this._setElementValidFlag(i,e)}pushElement(e){for(const t of this._future)t.type===1&&t.removeResource(this.resourceLabel,this.strResource,1);this._future=[],this._past.push(e),this.versionId++}createSnapshot(e){const t=[];for(let i=0,n=this._past.length;i<n;i++)t.push(this._past[i].id);for(let i=this._future.length-1;i>=0;i--)t.push(this._future[i].id);return new $he(e,t)}restoreSnapshot(e){const t=e.elements.length;let i=!0,n=0,r=-1;for(let a=0,l=this._past.length;a<l;a++,n++){const c=this._past[a];i&&(n>=t||c.id!==e.elements[n])&&(i=!1,r=0),!i&&c.type===1&&c.removeResource(this.resourceLabel,this.strResource,0)}let o=-1;for(let a=this._future.length-1;a>=0;a--,n++){const l=this._future[a];i&&(n>=t||l.id!==e.elements[n])&&(i=!1,o=a),!i&&l.type===1&&l.removeResource(this.resourceLabel,this.strResource,0)}r!==-1&&(this._past=this._past.slice(0,r)),o!==-1&&(this._future=this._future.slice(o+1)),this.versionId++}getElements(){const e=[],t=[];for(const i of this._past)e.push(i.actual);for(const i of this._future)t.push(i.actual);return{past:e,future:t}}getClosestPastElement(){return this._past.length===0?null:this._past[this._past.length-1]}getSecondClosestPastElement(){return this._past.length<2?null:this._past[this._past.length-2]}getClosestFutureElement(){return this._future.length===0?null:this._future[this._future.length-1]}hasPastElements(){return this._past.length>0}hasFutureElements(){return this._future.length>0}splitPastWorkspaceElement(e,t){for(let i=this._past.length-1;i>=0;i--)if(this._past[i]===e){t.has(this.strResource)?this._past[i]=t.get(this.strResource):this._past.splice(i,1);break}this.versionId++}splitFutureWorkspaceElement(e,t){for(let i=this._future.length-1;i>=0;i--)if(this._future[i]===e){t.has(this.strResource)?this._future[i]=t.get(this.strResource):this._future.splice(i,1);break}this.versionId++}moveBackward(e){this._past.pop(),this._future.push(e),this.versionId++}moveForward(e){this._future.pop(),this._past.push(e),this.versionId++}}class wV{constructor(e){this.editStacks=e,this._versionIds=[];for(let t=0,i=this.editStacks.length;t<i;t++)this._versionIds[t]=this.editStacks[t].versionId}isValid(){for(let e=0,t=this.editStacks.length;e<t;e++)if(this._versionIds[e]!==this.editStacks[e].versionId)return!1;return!0}}const Ghe=new Khe("","");Ghe.locked=!0;let C6=class{constructor(e,t){this._dialogService=e,this._notificationService=t,this._editStacks=new Map,this._uriComparisonKeyComputers=[]}getUriComparisonKey(e){for(const t of this._uriComparisonKeyComputers)if(t[0]===e.scheme)return t[1].getComparisonKey(e);return e.toString()}_print(e){console.log("------------------------------------"),console.log(`AFTER ${e}: `);const t=[];for(const i of this._editStacks)t.push(i[1].toString());console.log(t.join(`
`))}pushElement(e,t=w6.None,i=vb.None){if(e.type===0){const n=sN(e.resource),r=this.getUriComparisonKey(e.resource);this._pushElement(new rN(e,n,r,t.id,t.nextOrder(),i.id,i.nextOrder()))}else{const n=new Set,r=[],o=[];for(const a of e.resources){const l=sN(a),c=this.getUriComparisonKey(a);n.has(c)||(n.add(c),r.push(l),o.push(c))}r.length===1?this._pushElement(new rN(e,r[0],o[0],t.id,t.nextOrder(),i.id,i.nextOrder())):this._pushElement(new dOe(e,r,o,t.id,t.nextOrder(),i.id,i.nextOrder()))}}_pushElement(e){for(let t=0,i=e.strResources.length;t<i;t++){const n=e.resourceLabels[t],r=e.strResources[t];let o;this._editStacks.has(r)?o=this._editStacks.get(r):(o=new Khe(n,r),this._editStacks.set(r,o)),o.pushElement(e)}}getLastElement(e){const t=this.getUriComparisonKey(e);if(this._editStacks.has(t)){const i=this._editStacks.get(t);if(i.hasFutureElements())return null;const n=i.getClosestPastElement();return n?n.actual:null}return null}_splitPastWorkspaceElement(e,t){const i=e.actual.split(),n=new Map;for(const r of i){const o=sN(r.resource),a=this.getUriComparisonKey(r.resource),l=new rN(r,o,a,0,0,0,0);n.set(l.strResource,l)}for(const r of e.strResources){if(t&&t.has(r))continue;this._editStacks.get(r).splitPastWorkspaceElement(e,n)}}_splitFutureWorkspaceElement(e,t){const i=e.actual.split(),n=new Map;for(const r of i){const o=sN(r.resource),a=this.getUriComparisonKey(r.resource),l=new rN(r,o,a,0,0,0,0);n.set(l.strResource,l)}for(const r of e.strResources){if(t&&t.has(r))continue;this._editStacks.get(r).splitFutureWorkspaceElement(e,n)}}removeElements(e){const t=typeof e=="string"?e:this.getUriComparisonKey(e);this._editStacks.has(t)&&(this._editStacks.get(t).dispose(),this._editStacks.delete(t))}setElementsValidFlag(e,t,i){const n=this.getUriComparisonKey(e);this._editStacks.has(n)&&this._editStacks.get(n).setElementsValidFlag(t,i)}createSnapshot(e){const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).createSnapshot(e):new $he(e,[])}restoreSnapshot(e){const t=this.getUriComparisonKey(e.resource);if(this._editStacks.has(t)){const i=this._editStacks.get(t);i.restoreSnapshot(e),!i.hasPastElements()&&!i.hasFutureElements()&&(i.dispose(),this._editStacks.delete(t))}}getElements(e){const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).getElements():{past:[],future:[]}}_findClosestUndoElementWithSource(e){if(!e)return[null,null];let t=null,i=null;for(const[n,r]of this._editStacks){const o=r.getClosestPastElement();o&&o.sourceId===e&&(!t||o.sourceOrder>t.sourceOrder)&&(t=o,i=n)}return[t,i]}canUndo(e){if(e instanceof vb){const[,i]=this._findClosestUndoElementWithSource(e.id);return!!i}const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).hasPastElements():!1}_onError(e,t){ft(e);for(const i of t.strResources)this.removeElements(i);this._notificationService.error(e)}_acquireLocks(e){for(const t of e.editStacks)if(t.locked)throw new Error("Cannot acquire edit stack lock");for(const t of e.editStacks)t.locked=!0;return()=>{for(const t of e.editStacks)t.locked=!1}}_safeInvokeWithLocks(e,t,i,n,r){const o=this._acquireLocks(i);let a;try{a=t()}catch(l){return o(),n.dispose(),this._onError(l,e)}return a?a.then(()=>(o(),n.dispose(),r()),l=>(o(),n.dispose(),this._onError(l,e))):(o(),n.dispose(),r())}async _invokeWorkspacePrepare(e){if(typeof e.actual.prepareUndoRedo>"u")return te.None;const t=e.actual.prepareUndoRedo();return typeof t>"u"?te.None:t}_invokeResourcePrepare(e,t){if(e.actual.type!==1||typeof e.actual.prepareUndoRedo>"u")return t(te.None);const i=e.actual.prepareUndoRedo();return i?Y4(i)?t(i):i.then(n=>t(n)):t(te.None)}_getAffectedEditStacks(e){const t=[];for(const i of e.strResources)t.push(this._editStacks.get(i)||Ghe);return new wV(t)}_tryToSplitAndUndo(e,t,i,n){if(t.canSplit())return this._splitPastWorkspaceElement(t,i),this._notificationService.warn(n),new oN(this._undo(e,0,!0));for(const r of t.strResources)this.removeElements(r);return this._notificationService.warn(n),new oN}_checkWorkspaceUndo(e,t,i,n){if(t.removedResources)return this._tryToSplitAndUndo(e,t,t.removedResources,b({key:"cannotWorkspaceUndo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not undo '{0}' across all files. {1}",t.label,t.removedResources.createMessage()));if(n&&t.invalidatedResources)return this._tryToSplitAndUndo(e,t,t.invalidatedResources,b({key:"cannotWorkspaceUndo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not undo '{0}' across all files. {1}",t.label,t.invalidatedResources.createMessage()));const r=[];for(const a of i.editStacks)a.getClosestPastElement()!==t&&r.push(a.resourceLabel);if(r.length>0)return this._tryToSplitAndUndo(e,t,null,b({key:"cannotWorkspaceUndoDueToChanges",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not undo '{0}' across all files because changes were made to {1}",t.label,r.join(", ")));const o=[];for(const a of i.editStacks)a.locked&&o.push(a.resourceLabel);return o.length>0?this._tryToSplitAndUndo(e,t,null,b({key:"cannotWorkspaceUndoDueToInProgressUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not undo '{0}' across all files because there is already an undo or redo operation running on {1}",t.label,o.join(", "))):i.isValid()?null:this._tryToSplitAndUndo(e,t,null,b({key:"cannotWorkspaceUndoDueToInMeantimeUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not undo '{0}' across all files because an undo or redo operation occurred in the meantime",t.label))}_workspaceUndo(e,t,i){const n=this._getAffectedEditStacks(t),r=this._checkWorkspaceUndo(e,t,n,!1);return r?r.returnValue:this._confirmAndExecuteWorkspaceUndo(e,t,n,i)}_isPartOfUndoGroup(e){if(!e.groupId)return!1;for(const[,t]of this._editStacks){const i=t.getClosestPastElement();if(i){if(i===e){const n=t.getSecondClosestPastElement();if(n&&n.groupId===e.groupId)return!0}if(i.groupId===e.groupId)return!0}}return!1}async _confirmAndExecuteWorkspaceUndo(e,t,i,n){if(t.canSplit()&&!this._isPartOfUndoGroup(t)){let a;(function(d){d[d.All=0]="All",d[d.This=1]="This",d[d.Cancel=2]="Cancel"})(a||(a={}));const{result:l}=await this._dialogService.prompt({type:Hn.Info,message:b("confirmWorkspace","Would you like to undo '{0}' across all files?",t.label),buttons:[{label:b({key:"ok",comment:["{0} denotes a number that is > 1, && denotes a mnemonic"]},"&&Undo in {0} Files",i.editStacks.length),run:()=>a.All},{label:b({key:"nok",comment:["&& denotes a mnemonic"]},"Undo this &&File"),run:()=>a.This}],cancelButton:{run:()=>a.Cancel}});if(l===a.Cancel)return;if(l===a.This)return this._splitPastWorkspaceElement(t,null),this._undo(e,0,!0);const c=this._checkWorkspaceUndo(e,t,i,!1);if(c)return c.returnValue;n=!0}let r;try{r=await this._invokeWorkspacePrepare(t)}catch(a){return this._onError(a,t)}const o=this._checkWorkspaceUndo(e,t,i,!0);if(o)return r.dispose(),o.returnValue;for(const a of i.editStacks)a.moveBackward(t);return this._safeInvokeWithLocks(t,()=>t.actual.undo(),i,r,()=>this._continueUndoInGroup(t.groupId,n))}_resourceUndo(e,t,i){if(!t.isValid){e.flushAllElements();return}if(e.locked){const n=b({key:"cannotResourceUndoDueToInProgressUndoRedo",comment:["{0} is a label for an operation."]},"Could not undo '{0}' because there is already an undo or redo operation running.",t.label);this._notificationService.warn(n);return}return this._invokeResourcePrepare(t,n=>(e.moveBackward(t),this._safeInvokeWithLocks(t,()=>t.actual.undo(),new wV([e]),n,()=>this._continueUndoInGroup(t.groupId,i))))}_findClosestUndoElementInGroup(e){if(!e)return[null,null];let t=null,i=null;for(const[n,r]of this._editStacks){const o=r.getClosestPastElement();o&&o.groupId===e&&(!t||o.groupOrder>t.groupOrder)&&(t=o,i=n)}return[t,i]}_continueUndoInGroup(e,t){if(!e)return;const[,i]=this._findClosestUndoElementInGroup(e);if(i)return this._undo(i,0,t)}undo(e){if(e instanceof vb){const[,t]=this._findClosestUndoElementWithSource(e.id);return t?this._undo(t,e.id,!1):void 0}return typeof e=="string"?this._undo(e,0,!1):this._undo(this.getUriComparisonKey(e),0,!1)}_undo(e,t=0,i){if(!this._editStacks.has(e))return;const n=this._editStacks.get(e),r=n.getClosestPastElement();if(!r)return;if(r.groupId){const[a,l]=this._findClosestUndoElementInGroup(r.groupId);if(r!==a&&l)return this._undo(l,t,i)}if((r.sourceId!==t||r.confirmBeforeUndo)&&!i)return this._confirmAndContinueUndo(e,t,r);try{return r.type===1?this._workspaceUndo(e,r,i):this._resourceUndo(n,r,i)}finally{}}async _confirmAndContinueUndo(e,t,i){if((await this._dialogService.confirm({message:b("confirmDifferentSource","Would you like to undo '{0}'?",i.label),primaryButton:b({key:"confirmDifferentSource.yes",comment:["&& denotes a mnemonic"]},"&&Yes"),cancelButton:b("confirmDifferentSource.no","No")})).confirmed)return this._undo(e,t,!0)}_findClosestRedoElementWithSource(e){if(!e)return[null,null];let t=null,i=null;for(const[n,r]of this._editStacks){const o=r.getClosestFutureElement();o&&o.sourceId===e&&(!t||o.sourceOrder<t.sourceOrder)&&(t=o,i=n)}return[t,i]}canRedo(e){if(e instanceof vb){const[,i]=this._findClosestRedoElementWithSource(e.id);return!!i}const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).hasFutureElements():!1}_tryToSplitAndRedo(e,t,i,n){if(t.canSplit())return this._splitFutureWorkspaceElement(t,i),this._notificationService.warn(n),new oN(this._redo(e));for(const r of t.strResources)this.removeElements(r);return this._notificationService.warn(n),new oN}_checkWorkspaceRedo(e,t,i,n){if(t.removedResources)return this._tryToSplitAndRedo(e,t,t.removedResources,b({key:"cannotWorkspaceRedo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not redo '{0}' across all files. {1}",t.label,t.removedResources.createMessage()));if(n&&t.invalidatedResources)return this._tryToSplitAndRedo(e,t,t.invalidatedResources,b({key:"cannotWorkspaceRedo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not redo '{0}' across all files. {1}",t.label,t.invalidatedResources.createMessage()));const r=[];for(const a of i.editStacks)a.getClosestFutureElement()!==t&&r.push(a.resourceLabel);if(r.length>0)return this._tryToSplitAndRedo(e,t,null,b({key:"cannotWorkspaceRedoDueToChanges",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not redo '{0}' across all files because changes were made to {1}",t.label,r.join(", ")));const o=[];for(const a of i.editStacks)a.locked&&o.push(a.resourceLabel);return o.length>0?this._tryToSplitAndRedo(e,t,null,b({key:"cannotWorkspaceRedoDueToInProgressUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not redo '{0}' across all files because there is already an undo or redo operation running on {1}",t.label,o.join(", "))):i.isValid()?null:this._tryToSplitAndRedo(e,t,null,b({key:"cannotWorkspaceRedoDueToInMeantimeUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not redo '{0}' across all files because an undo or redo operation occurred in the meantime",t.label))}_workspaceRedo(e,t){const i=this._getAffectedEditStacks(t),n=this._checkWorkspaceRedo(e,t,i,!1);return n?n.returnValue:this._executeWorkspaceRedo(e,t,i)}async _executeWorkspaceRedo(e,t,i){let n;try{n=await this._invokeWorkspacePrepare(t)}catch(o){return this._onError(o,t)}const r=this._checkWorkspaceRedo(e,t,i,!0);if(r)return n.dispose(),r.returnValue;for(const o of i.editStacks)o.moveForward(t);return this._safeInvokeWithLocks(t,()=>t.actual.redo(),i,n,()=>this._continueRedoInGroup(t.groupId))}_resourceRedo(e,t){if(!t.isValid){e.flushAllElements();return}if(e.locked){const i=b({key:"cannotResourceRedoDueToInProgressUndoRedo",comment:["{0} is a label for an operation."]},"Could not redo '{0}' because there is already an undo or redo operation running.",t.label);this._notificationService.warn(i);return}return this._invokeResourcePrepare(t,i=>(e.moveForward(t),this._safeInvokeWithLocks(t,()=>t.actual.redo(),new wV([e]),i,()=>this._continueRedoInGroup(t.groupId))))}_findClosestRedoElementInGroup(e){if(!e)return[null,null];let t=null,i=null;for(const[n,r]of this._editStacks){const o=r.getClosestFutureElement();o&&o.groupId===e&&(!t||o.groupOrder<t.groupOrder)&&(t=o,i=n)}return[t,i]}_continueRedoInGroup(e){if(!e)return;const[,t]=this._findClosestRedoElementInGroup(e);if(t)return this._redo(t)}redo(e){if(e instanceof vb){const[,t]=this._findClosestRedoElementWithSource(e.id);return t?this._redo(t):void 0}return typeof e=="string"?this._redo(e):this._redo(this.getUriComparisonKey(e))}_redo(e){if(!this._editStacks.has(e))return;const t=this._editStacks.get(e),i=t.getClosestFutureElement();if(i){if(i.groupId){const[n,r]=this._findClosestRedoElementInGroup(i.groupId);if(i!==n&&r)return this._redo(r)}try{return i.type===1?this._workspaceRedo(e,i):this._resourceRedo(t,i)}finally{}}}};C6=cOe([lie(0,KE),lie(1,jn)],C6);class oN{constructor(e){this.returnValue=e}}qt(iK,C6,1);function ho(s,e,t){return Math.min(Math.max(s,e),t)}class Qhe{constructor(){this._n=1,this._val=0}update(e){return this._val=this._val+(e-this._val)/this._n,this._n+=1,this._val}get value(){return this._val}}class uOe{constructor(e){this._n=0,this._val=0,this._values=[],this._index=0,this._sum=0,this._values=new Array(e),this._values.fill(0,0,e)}update(e){const t=this._values[this._index];return this._values[this._index]=e,this._index=(this._index+1)%this._values.length,this._sum-=t,this._sum+=e,this._n<this._values.length&&(this._n+=1),this._val=this._sum/this._n,this._val}get value(){return this._val}}const nK=Ht("environmentService");var hOe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},uie=function(s,e){return function(t,i){e(t,i,s)}};const Fl=Ht("ILanguageFeatureDebounceService");var oA;(function(s){const e=new WeakMap;let t=0;function i(n){let r=e.get(n);return r===void 0&&(r=++t,e.set(n,r)),r}s.of=i})(oA||(oA={}));class fOe{constructor(e){this._default=e}get(e){return this._default}update(e,t){return this._default}default(){return this._default}}class gOe{constructor(e,t,i,n,r,o){this._logService=e,this._name=t,this._registry=i,this._default=n,this._min=r,this._max=o,this._cache=new $h(50,.7)}_key(e){return e.id+this._registry.all(e).reduce((t,i)=>iF(oA.of(i),t),0)}get(e){const t=this._key(e),i=this._cache.get(t);return i?ho(i.value,this._min,this._max):this.default()}update(e,t){const i=this._key(e);let n=this._cache.get(i);n||(n=new uOe(6),this._cache.set(i,n));const r=ho(n.update(t),this._min,this._max);return J4(e.uri,"output")||this._logService.trace(`[DEBOUNCE: ${this._name}] for ${e.uri.toString()} is ${r}ms`),r}_overall(){const e=new Qhe;for(const[,t]of this._cache)e.update(t.value);return e.value}default(){const e=this._overall()|0||this._default;return ho(e,this._min,this._max)}}let y6=class{constructor(e,t){this._logService=e,this._data=new Map,this._isDev=t.isExtensionDevelopment||!t.isBuilt}for(e,t,i){const n=(i==null?void 0:i.min)??50,r=(i==null?void 0:i.max)??n**2,o=(i==null?void 0:i.key)??void 0,a=`${oA.of(e)},${n}${o?","+o:""}`;let l=this._data.get(a);return l||(this._isDev?(this._logService.debug(`[DEBOUNCE: ${t}] is disabled in developed mode`),l=new fOe(n*1.5)):l=new gOe(this._logService,t,e,this._overallAverage()|0||n*1.5,n,r),this._data.set(a,l)),l}_overallAverage(){const e=new Qhe;for(const t of this._data.values())e.update(t.default());return e.value}};y6=hOe([uie(0,pr),uie(1,nK)],y6);qt(Fl,y6,1);class Go{static getLanguageId(e){return(e&255)>>>0}static getTokenType(e){return(e&768)>>>8}static containsBalancedBrackets(e){return(e&1024)!==0}static getFontStyle(e){return(e&30720)>>>11}static getForeground(e){return(e&16744448)>>>15}static getBackground(e){return(e&4278190080)>>>24}static getClassNameFromMetadata(e){let i="mtk"+this.getForeground(e);const n=this.getFontStyle(e);return n&1&&(i+=" mtki"),n&2&&(i+=" mtkb"),n&4&&(i+=" mtku"),n&8&&(i+=" mtks"),i}static getInlineStyleFromMetadata(e,t){const i=this.getForeground(e),n=this.getFontStyle(e);let r=`color: ${t[i]};`;n&1&&(r+="font-style: italic;"),n&2&&(r+="font-weight: bold;");let o="";return n&4&&(o+=" underline"),n&8&&(o+=" line-through"),o&&(r+=`text-decoration:${o};`),r}static getPresentationFromMetadata(e){const t=this.getForeground(e),i=this.getFontStyle(e);return{foreground:t,italic:!!(i&1),bold:!!(i&2),underline:!!(i&4),strikethrough:!!(i&8)}}}function Gm(s){let e=0,t=0,i=0,n=0;for(let r=0,o=s.length;r<o;r++){const a=s.charCodeAt(r);a===13?(e===0&&(t=r),e++,r+1<o&&s.charCodeAt(r+1)===10?(n|=2,r++):n|=3,i=r+1):a===10&&(n|=1,e===0&&(t=r),e++,i=r+1)}return e===0&&(t=s.length),[e,t,s.length-i,n]}class AL{static create(e,t){return new AL(e,new aA(t))}get startLineNumber(){return this._startLineNumber}get endLineNumber(){return this._endLineNumber}constructor(e,t){this._startLineNumber=e,this._tokens=t,this._endLineNumber=this._startLineNumber+this._tokens.getMaxDeltaLine()}toString(){return this._tokens.toString(this._startLineNumber)}_updateEndLineNumber(){this._endLineNumber=this._startLineNumber+this._tokens.getMaxDeltaLine()}isEmpty(){return this._tokens.isEmpty()}getLineTokens(e){return this._startLineNumber<=e&&e<=this._endLineNumber?this._tokens.getLineTokens(e-this._startLineNumber):null}getRange(){const e=this._tokens.getRange();return e&&new F(this._startLineNumber+e.startLineNumber,e.startColumn,this._startLineNumber+e.endLineNumber,e.endColumn)}removeTokens(e){const t=e.startLineNumber-this._startLineNumber,i=e.endLineNumber-this._startLineNumber;this._startLineNumber+=this._tokens.removeTokens(t,e.startColumn-1,i,e.endColumn-1),this._updateEndLineNumber()}split(e){const t=e.startLineNumber-this._startLineNumber,i=e.endLineNumber-this._startLineNumber,[n,r,o]=this._tokens.split(t,e.startColumn-1,i,e.endColumn-1);return[new AL(this._startLineNumber,n),new AL(this._startLineNumber+o,r)]}applyEdit(e,t){const[i,n,r]=Gm(t);this.acceptEdit(e,i,n,r,t.length>0?t.charCodeAt(0):0)}acceptEdit(e,t,i,n,r){this._acceptDeleteRange(e),this._acceptInsertText(new X(e.startLineNumber,e.startColumn),t,i,n,r),this._updateEndLineNumber()}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return;const t=e.startLineNumber-this._startLineNumber,i=e.endLineNumber-this._startLineNumber;if(i<0){const r=i-t;this._startLineNumber-=r;return}const n=this._tokens.getMaxDeltaLine();if(!(t>=n+1)){if(t<0&&i>=n+1){this._startLineNumber=0,this._tokens.clear();return}if(t<0){const r=-t;this._startLineNumber-=r,this._tokens.acceptDeleteRange(e.startColumn-1,0,0,i,e.endColumn-1)}else this._tokens.acceptDeleteRange(0,t,e.startColumn-1,i,e.endColumn-1)}}_acceptInsertText(e,t,i,n,r){if(t===0&&i===0)return;const o=e.lineNumber-this._startLineNumber;if(o<0){this._startLineNumber+=t;return}const a=this._tokens.getMaxDeltaLine();o>=a+1||this._tokens.acceptInsertText(o,e.column-1,t,i,n,r)}}class aA{constructor(e){this._tokens=e,this._tokenCount=e.length/4}toString(e){const t=[];for(let i=0;i<this._tokenCount;i++)t.push(`(${this._getDeltaLine(i)+e},${this._getStartCharacter(i)}-${this._getEndCharacter(i)})`);return`[${t.join(",")}]`}getMaxDeltaLine(){const e=this._getTokenCount();return e===0?-1:this._getDeltaLine(e-1)}getRange(){const e=this._getTokenCount();if(e===0)return null;const t=this._getStartCharacter(0),i=this._getDeltaLine(e-1),n=this._getEndCharacter(e-1);return new F(0,t+1,i,n+1)}_getTokenCount(){return this._tokenCount}_getDeltaLine(e){return this._tokens[4*e]}_getStartCharacter(e){return this._tokens[4*e+1]}_getEndCharacter(e){return this._tokens[4*e+2]}isEmpty(){return this._getTokenCount()===0}getLineTokens(e){let t=0,i=this._getTokenCount()-1;for(;t<i;){const n=t+Math.floor((i-t)/2),r=this._getDeltaLine(n);if(r<e)t=n+1;else if(r>e)i=n-1;else{let o=n;for(;o>t&&this._getDeltaLine(o-1)===e;)o--;let a=n;for(;a<i&&this._getDeltaLine(a+1)===e;)a++;return new hie(this._tokens.subarray(4*o,4*a+4))}}return this._getDeltaLine(t)===e?new hie(this._tokens.subarray(4*t,4*t+4)):null}clear(){this._tokenCount=0}removeTokens(e,t,i,n){const r=this._tokens,o=this._tokenCount;let a=0,l=!1,c=0;for(let d=0;d<o;d++){const u=4*d,h=r[u],g=r[u+1],p=r[u+2],_=r[u+3];if((h>e||h===e&&p>=t)&&(h<i||h===i&&g<=n))l=!0;else{if(a===0&&(c=h),l){const v=4*a;r[v]=h-c,r[v+1]=g,r[v+2]=p,r[v+3]=_}a++}}return this._tokenCount=a,c}split(e,t,i,n){const r=this._tokens,o=this._tokenCount,a=[],l=[];let c=a,d=0,u=0;for(let h=0;h<o;h++){const g=4*h,p=r[g],_=r[g+1],v=r[g+2],C=r[g+3];if(p>e||p===e&&v>=t){if(p<i||p===i&&_<=n)continue;c!==l&&(c=l,d=0,u=p)}c[d++]=p-u,c[d++]=_,c[d++]=v,c[d++]=C}return[new aA(new Uint32Array(a)),new aA(new Uint32Array(l)),u]}acceptDeleteRange(e,t,i,n,r){const o=this._tokens,a=this._tokenCount,l=n-t;let c=0,d=!1;for(let u=0;u<a;u++){const h=4*u;let g=o[h],p=o[h+1],_=o[h+2];const v=o[h+3];if(g<t||g===t&&_<=i){c++;continue}else if(g===t&&p<i)g===n&&_>r?_-=r-i:_=i;else if(g===t&&p===i)if(g===n&&_>r)_-=r-i;else{d=!0;continue}else if(g<n||g===n&&p<r)if(g===n&&_>r)g=t,p=i,_=p+(_-r);else{d=!0;continue}else if(g>n){if(l===0&&!d){c=a;break}g-=l}else if(g===n&&p>=r)e&&g===0&&(p+=e,_+=e),g-=l,p-=r-i,_-=r-i;else throw new Error("Not possible!");const C=4*c;o[C]=g,o[C+1]=p,o[C+2]=_,o[C+3]=v,c++}this._tokenCount=c}acceptInsertText(e,t,i,n,r,o){const a=i===0&&n===1&&(o>=48&&o<=57||o>=65&&o<=90||o>=97&&o<=122),l=this._tokens,c=this._tokenCount;for(let d=0;d<c;d++){const u=4*d;let h=l[u],g=l[u+1],p=l[u+2];if(!(h<e||h===e&&p<t)){if(h===e&&p===t)if(a)p+=1;else continue;else if(h===e&&g<t&&t<p)i===0?p+=n:p=t;else{if(h===e&&g===t&&a)continue;if(h===e)if(h+=i,i===0)g+=n,p+=n;else{const _=p-g;g=r+(g-t),p=g+_}else h+=i}l[u]=h,l[u+1]=g,l[u+2]=p}}}}class hie{constructor(e){this._tokens=e}getCount(){return this._tokens.length/4}getStartCharacter(e){return this._tokens[4*e+1]}getEndCharacter(e){return this._tokens[4*e+2]}getMetadata(e){return this._tokens[4*e+3]}}var pOe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},CV=function(s,e){return function(t,i){e(t,i,s)}};let S6=class{constructor(e,t,i,n){this._legend=e,this._themeService=t,this._languageService=i,this._logService=n,this._hasWarnedOverlappingTokens=!1,this._hasWarnedInvalidLengthTokens=!1,this._hasWarnedInvalidEditStart=!1,this._hashTable=new x6}getMetadata(e,t,i){const n=this._languageService.languageIdCodec.encodeLanguageId(i),r=this._hashTable.get(e,t,n);let o;if(r)o=r.metadata;else{let a=this._legend.tokenTypes[e];const l=[];if(a){let c=t;for(let u=0;c>0&&u<this._legend.tokenModifiers.length;u++)c&1&&l.push(this._legend.tokenModifiers[u]),c=c>>1;const d=this._themeService.getColorTheme().getTokenStyleMetadata(a,l,i);if(typeof d>"u")o=2147483647;else{if(o=0,typeof d.italic<"u"){const u=(d.italic?1:0)<<11;o|=u|1}if(typeof d.bold<"u"){const u=(d.bold?2:0)<<11;o|=u|2}if(typeof d.underline<"u"){const u=(d.underline?4:0)<<11;o|=u|4}if(typeof d.strikethrough<"u"){const u=(d.strikethrough?8:0)<<11;o|=u|8}if(d.foreground){const u=d.foreground<<15;o|=u|16}o===0&&(o=2147483647)}}else o=2147483647,a="not-in-legend";this._hashTable.add(e,t,n,o)}return o}warnOverlappingSemanticTokens(e,t){this._hasWarnedOverlappingTokens||(this._hasWarnedOverlappingTokens=!0,this._logService.warn(`Overlapping semantic tokens detected at lineNumber ${e}, column ${t}`))}warnInvalidLengthSemanticTokens(e,t){this._hasWarnedInvalidLengthTokens||(this._hasWarnedInvalidLengthTokens=!0,this._logService.warn(`Semantic token with invalid length detected at lineNumber ${e}, column ${t}`))}warnInvalidEditStart(e,t,i,n,r){this._hasWarnedInvalidEditStart||(this._hasWarnedInvalidEditStart=!0,this._logService.warn(`Invalid semantic tokens edit detected (previousResultId: ${e}, resultId: ${t}) at edit #${i}: The provided start offset ${n} is outside the previous data (length ${r}).`))}};S6=pOe([CV(1,gs),CV(2,un),CV(3,pr)],S6);function Yhe(s,e,t){const i=s.data,n=s.data.length/5|0,r=Math.max(Math.ceil(n/1024),400),o=[];let a=0,l=1,c=0;for(;a<n;){const d=a;let u=Math.min(d+r,n);if(u<n){let y=u;for(;y-1>d&&i[5*y]===0;)y--;if(y-1===d){let x=u;for(;x+1<n&&i[5*x]===0;)x++;u=x}else u=y}let h=new Uint32Array((u-d)*4),g=0,p=0,_=0,v=0;for(;a<u;){const y=5*a,x=i[y],L=i[y+1],I=l+x|0,A=x===0?c+L|0:L,D=i[y+2],N=A+D|0,R=i[y+3],W=i[y+4];if(N<=A)e.warnInvalidLengthSemanticTokens(I,A+1);else if(_===I&&v>A)e.warnOverlappingSemanticTokens(I,A+1);else{const H=e.getMetadata(R,W,t);H!==2147483647&&(p===0&&(p=I),h[g]=I-p,h[g+1]=A,h[g+2]=N,h[g+3]=H,g+=4,_=I,v=N)}l=I,c=A,a++}g!==h.length&&(h=h.subarray(0,g));const C=AL.create(p,h);o.push(C)}return o}class mOe{constructor(e,t,i,n){this.tokenTypeIndex=e,this.tokenModifierSet=t,this.languageId=i,this.metadata=n,this.next=null}}const Lf=class Lf{constructor(){this._elementsCount=0,this._currentLengthIndex=0,this._currentLength=Lf._SIZES[this._currentLengthIndex],this._growCount=Math.round(this._currentLengthIndex+1<Lf._SIZES.length?2/3*this._currentLength:0),this._elements=[],Lf._nullOutEntries(this._elements,this._currentLength)}static _nullOutEntries(e,t){for(let i=0;i<t;i++)e[i]=null}_hash2(e,t){return(e<<5)-e+t|0}_hashFunc(e,t,i){return this._hash2(this._hash2(e,t),i)%this._currentLength}get(e,t,i){const n=this._hashFunc(e,t,i);let r=this._elements[n];for(;r;){if(r.tokenTypeIndex===e&&r.tokenModifierSet===t&&r.languageId===i)return r;r=r.next}return null}add(e,t,i,n){if(this._elementsCount++,this._growCount!==0&&this._elementsCount>=this._growCount){const r=this._elements;this._currentLengthIndex++,this._currentLength=Lf._SIZES[this._currentLengthIndex],this._growCount=Math.round(this._currentLengthIndex+1<Lf._SIZES.length?2/3*this._currentLength:0),this._elements=[],Lf._nullOutEntries(this._elements,this._currentLength);for(const o of r){let a=o;for(;a;){const l=a.next;a.next=null,this._add(a),a=l}}}this._add(new mOe(e,t,i,n))}_add(e){const t=this._hashFunc(e.tokenTypeIndex,e.tokenModifierSet,e.languageId);e.next=this._elements[t],this._elements[t]=e}};Lf._SIZES=[3,7,13,31,61,127,251,509,1021,2039,4093,8191,16381,32749,65521,131071,262139,524287,1048573,2097143];let x6=Lf;const CF=Ht("semanticTokensStylingService");var _Oe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},yV=function(s,e){return function(t,i){e(t,i,s)}};let L6=class extends te{constructor(e,t,i){super(),this._themeService=e,this._logService=t,this._languageService=i,this._caches=new WeakMap,this._register(this._themeService.onDidColorThemeChange(()=>{this._caches=new WeakMap}))}getStyling(e){return this._caches.has(e)||this._caches.set(e,new S6(e.getLegend(),this._themeService,this._languageService,this._logService)),this._caches.get(e)}};L6=_Oe([yV(0,gs),yV(1,pr),yV(2,un)],L6);qt(CF,L6,1);function gp(s){return s===47||s===92}function Xhe(s){return s.replace(/[\\/]/g,Yn.sep)}function bOe(s){return s.indexOf("/")===-1&&(s=Xhe(s)),/^[a-zA-Z]:(\/|$)/.test(s)&&(s="/"+s),s}function fie(s,e=Yn.sep){if(!s)return"";const t=s.length,i=s.charCodeAt(0);if(gp(i)){if(gp(s.charCodeAt(1))&&!gp(s.charCodeAt(2))){let r=3;const o=r;for(;r<t&&!gp(s.charCodeAt(r));r++);if(o!==r&&!gp(s.charCodeAt(r+1))){for(r+=1;r<t;r++)if(gp(s.charCodeAt(r)))return s.slice(0,r+1).replace(/[\\/]/g,e)}}return e}else if(Zhe(i)&&s.charCodeAt(1)===58)return gp(s.charCodeAt(2))?s.slice(0,2)+e:s.slice(0,2);let n=s.indexOf("://");if(n!==-1){for(n+=3;n<t;n++)if(gp(s.charCodeAt(n)))return s.slice(0,n+1)}return""}function k6(s,e,t,i=tu){if(s===e)return!0;if(!s||!e||e.length>s.length)return!1;if(t){if(!Dq(s,e))return!1;if(e.length===s.length)return!0;let r=e.length;return e.charAt(e.length-1)===i&&r--,s.charAt(r)===i}return e.charAt(e.length-1)!==i&&(e+=i),s.indexOf(e)===0}function Zhe(s){return s>=65&&s<=90||s>=97&&s<=122}function vOe(s,e=gr){return e?Zhe(s.charCodeAt(0))&&s.charCodeAt(1)===58:!1}const aN="**",gie="/",ER="[/\\\\]",DR="[^/\\\\]",wOe=/\//g;function pie(s,e){switch(s){case 0:return"";case 1:return`${DR}*?`;default:return`(?:${ER}|${DR}+${ER}${e?`|${ER}${DR}+`:""})*?`}}function mie(s,e){if(!s)return[];const t=[];let i=!1,n=!1,r="";for(const o of s){switch(o){case e:if(!i&&!n){t.push(r),r="";continue}break;case"{":i=!0;break;case"}":i=!1;break;case"[":n=!0;break;case"]":n=!1;break}r+=o}return r&&t.push(r),t}function Jhe(s){if(!s)return"";let e="";const t=mie(s,gie);if(t.every(i=>i===aN))e=".*";else{let i=!1;t.forEach((n,r)=>{if(n===aN){if(i)return;e+=pie(2,r===t.length-1)}else{let o=!1,a="",l=!1,c="";for(const d of n){if(d!=="}"&&o){a+=d;continue}if(l&&(d!=="]"||!c)){let u;d==="-"?u=d:(d==="^"||d==="!")&&!c?u="^":d===gie?u="":u=Nl(d),c+=u;continue}switch(d){case"{":o=!0;continue;case"[":l=!0;continue;case"}":{const h=`(?:${mie(a,",").map(g=>Jhe(g)).join("|")})`;e+=h,o=!1,a="";break}case"]":{e+="["+c+"]",l=!1,c="";break}case"?":e+=DR;continue;case"*":e+=pie(1);continue;default:e+=Nl(d)}}r<t.length-1&&(t[r+1]!==aN||r+2<t.length)&&(e+=ER)}i=n===aN})}return e}const COe=/^\*\*\/\*\.[\w\.-]+$/,yOe=/^\*\*\/([\w\.-]+)\/?$/,SOe=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,xOe=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,LOe=/^\*\*((\/[\w\.-]+)+)\/?$/,kOe=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,_ie=new $h(1e4),bie=function(){return!1},Sh=function(){return null};function sK(s,e){if(!s)return Sh;let t;typeof s!="string"?t=s.pattern:t=s,t=t.trim();const i=`${t}_${!!e.trimForExclusions}`;let n=_ie.get(i);if(n)return vie(n,s);let r;return COe.test(t)?n=IOe(t.substr(4),t):(r=yOe.exec(SV(t,e)))?n=EOe(r[1],t):(e.trimForExclusions?xOe:SOe).test(t)?n=DOe(t,e):(r=LOe.exec(SV(t,e)))?n=wie(r[1].substr(1),t,!0):(r=kOe.exec(SV(t,e)))?n=wie(r[1],t,!1):n=TOe(t),_ie.set(i,n),vie(n,s)}function vie(s,e){if(typeof e=="string")return s;const t=function(i,n){return k6(i,e.base,!Lo)?s(WE(i.substr(e.base.length),tu),n):null};return t.allBasenames=s.allBasenames,t.allPaths=s.allPaths,t.basenames=s.basenames,t.patterns=s.patterns,t}function SV(s,e){return e.trimForExclusions&&s.endsWith("/**")?s.substr(0,s.length-2):s}function IOe(s,e){return function(t,i){return typeof t=="string"&&t.endsWith(s)?e:null}}function EOe(s,e){const t=`/${s}`,i=`\\${s}`,n=function(o,a){return typeof o!="string"?null:a?a===s?e:null:o===s||o.endsWith(t)||o.endsWith(i)?e:null},r=[s];return n.basenames=r,n.patterns=[e],n.allBasenames=r,n}function DOe(s,e){const t=tfe(s.slice(1,-1).split(",").map(a=>sK(a,e)).filter(a=>a!==Sh),s),i=t.length;if(!i)return Sh;if(i===1)return t[0];const n=function(a,l){for(let c=0,d=t.length;c<d;c++)if(t[c](a,l))return s;return null},r=t.find(a=>!!a.allBasenames);r&&(n.allBasenames=r.allBasenames);const o=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return o.length&&(n.allPaths=o),n}function wie(s,e,t){const i=tu===Yn.sep,n=i?s:s.replace(wOe,tu),r=tu+n,o=Yn.sep+s;let a;return t?a=function(l,c){return typeof l=="string"&&(l===n||l.endsWith(r)||!i&&(l===s||l.endsWith(o)))?e:null}:a=function(l,c){return typeof l=="string"&&(l===n||!i&&l===s)?e:null},a.allPaths=[(t?"*/":"./")+s],a}function TOe(s){try{const e=new RegExp(`^${Jhe(s)}$`);return function(t){return e.lastIndex=0,typeof t=="string"&&e.test(t)?s:null}}catch{return Sh}}function NOe(s,e,t){return!s||typeof e!="string"?!1:efe(s)(e,void 0,t)}function efe(s,e={}){if(!s)return bie;if(typeof s=="string"||ROe(s)){const t=sK(s,e);if(t===Sh)return bie;const i=function(n,r){return!!t(n,r)};return t.allBasenames&&(i.allBasenames=t.allBasenames),t.allPaths&&(i.allPaths=t.allPaths),i}return AOe(s,e)}function ROe(s){const e=s;return e?typeof e.base=="string"&&typeof e.pattern=="string":!1}function AOe(s,e){const t=tfe(Object.getOwnPropertyNames(s).map(a=>POe(a,s[a],e)).filter(a=>a!==Sh)),i=t.length;if(!i)return Sh;if(!t.some(a=>!!a.requiresSiblings)){if(i===1)return t[0];const a=function(d,u){let h;for(let g=0,p=t.length;g<p;g++){const _=t[g](d,u);if(typeof _=="string")return _;zW(_)&&(h||(h=[]),h.push(_))}return h?(async()=>{for(const g of h){const p=await g;if(typeof p=="string")return p}return null})():null},l=t.find(d=>!!d.allBasenames);l&&(a.allBasenames=l.allBasenames);const c=t.reduce((d,u)=>u.allPaths?d.concat(u.allPaths):d,[]);return c.length&&(a.allPaths=c),a}const n=function(a,l,c){let d,u;for(let h=0,g=t.length;h<g;h++){const p=t[h];p.requiresSiblings&&c&&(l||(l=lm(a)),d||(d=l.substr(0,l.length-mRe(a).length)));const _=p(a,l,d,c);if(typeof _=="string")return _;zW(_)&&(u||(u=[]),u.push(_))}return u?(async()=>{for(const h of u){const g=await h;if(typeof g=="string")return g}return null})():null},r=t.find(a=>!!a.allBasenames);r&&(n.allBasenames=r.allBasenames);const o=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return o.length&&(n.allPaths=o),n}function POe(s,e,t){if(e===!1)return Sh;const i=sK(s,t);if(i===Sh)return Sh;if(typeof e=="boolean")return i;if(e){const n=e.when;if(typeof n=="string"){const r=(o,a,l,c)=>{if(!c||!i(o,a))return null;const d=n.replace("$(basename)",()=>l),u=c(d);return zW(u)?u.then(h=>h?s:null):u?s:null};return r.requiresSiblings=!0,r}}return i}function tfe(s,e){const t=s.filter(a=>!!a.basenames);if(t.length<2)return s;const i=t.reduce((a,l)=>{const c=l.basenames;return c?a.concat(c):a},[]);let n;if(e){n=[];for(let a=0,l=i.length;a<l;a++)n.push(e)}else n=t.reduce((a,l)=>{const c=l.patterns;return c?a.concat(c):a},[]);const r=function(a,l){if(typeof a!="string")return null;if(!l){let d;for(d=a.length;d>0;d--){const u=a.charCodeAt(d-1);if(u===47||u===92)break}l=a.substr(d)}const c=i.indexOf(l);return c!==-1?n[c]:null};r.basenames=i,r.patterns=n,r.allBasenames=i;const o=s.filter(a=>!a.basenames);return o.push(r),o}function rK(s,e,t,i,n,r){if(Array.isArray(s)){let o=0;for(const a of s){const l=rK(a,e,t,i,n,r);if(l===10)return l;l>o&&(o=l)}return o}else{if(typeof s=="string")return i?s==="*"?5:s===t?10:0:0;if(s){const{language:o,pattern:a,scheme:l,hasAccessToAllModels:c,notebookType:d}=s;if(!i&&!c)return 0;d&&n&&(e=n);let u=0;if(l)if(l===e.scheme)u=10;else if(l==="*")u=5;else return 0;if(o)if(o===t)u=10;else if(o==="*")u=Math.max(u,5);else return 0;if(d)if(d===r)u=10;else if(d==="*"&&r!==void 0)u=Math.max(u,5);else return 0;if(a){let h;if(typeof a=="string"?h=a:h={...a,base:_ue(a.base)},h===e.fsPath||NOe(h,e.fsPath))u=10;else return 0}return u}else return 0}}function ife(s){return typeof s=="string"?!1:Array.isArray(s)?s.every(ife):!!s.exclusive}class Cie{constructor(e,t,i,n,r){this.uri=e,this.languageId=t,this.notebookUri=i,this.notebookType=n,this.recursive=r}equals(e){var t,i;return this.notebookType===e.notebookType&&this.languageId===e.languageId&&this.uri.toString()===e.uri.toString()&&((t=this.notebookUri)==null?void 0:t.toString())===((i=e.notebookUri)==null?void 0:i.toString())&&this.recursive===e.recursive}}class fn{constructor(e){this._notebookInfoResolver=e,this._clock=0,this._entries=[],this._onDidChange=new Z,this.onDidChange=this._onDidChange.event}register(e,t){let i={selector:e,provider:t,_score:-1,_time:this._clock++};return this._entries.push(i),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),Ye(()=>{if(i){const n=this._entries.indexOf(i);n>=0&&(this._entries.splice(n,1),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),i=void 0)}})}has(e){return this.all(e).length>0}all(e){if(!e)return[];this._updateScores(e,!1);const t=[];for(const i of this._entries)i._score>0&&t.push(i.provider);return t}ordered(e,t=!1){const i=[];return this._orderedForEach(e,t,n=>i.push(n.provider)),i}orderedGroups(e){const t=[];let i,n;return this._orderedForEach(e,!1,r=>{i&&n===r._score?i.push(r.provider):(n=r._score,i=[r.provider],t.push(i))}),t}_orderedForEach(e,t,i){this._updateScores(e,t);for(const n of this._entries)n._score>0&&i(n)}_updateScores(e,t){var r,o;const i=(r=this._notebookInfoResolver)==null?void 0:r.call(this,e.uri),n=i?new Cie(e.uri,e.getLanguageId(),i.uri,i.type,t):new Cie(e.uri,e.getLanguageId(),void 0,void 0,t);if(!((o=this._lastCandidate)!=null&&o.equals(n))){this._lastCandidate=n;for(const a of this._entries)if(a._score=rK(a.selector,n.uri,n.languageId,Nhe(e),n.notebookUri,n.notebookType),ife(a.selector)&&a._score>0)if(t)a._score=0;else{for(const l of this._entries)l._score=0;a._score=1e3;break}this._entries.sort(fn._compareByScoreAndTime)}}static _compareByScoreAndTime(e,t){return e._score<t._score?1:e._score>t._score?-1:Jx(e.selector)&&!Jx(t.selector)?1:!Jx(e.selector)&&Jx(t.selector)?-1:e._time<t._time?1:e._time>t._time?-1:0}}function Jx(s){return typeof s=="string"?!1:Array.isArray(s)?s.some(Jx):!!s.isBuiltin}class MOe{constructor(){this.referenceProvider=new fn(this._score.bind(this)),this.renameProvider=new fn(this._score.bind(this)),this.newSymbolNamesProvider=new fn(this._score.bind(this)),this.codeActionProvider=new fn(this._score.bind(this)),this.definitionProvider=new fn(this._score.bind(this)),this.typeDefinitionProvider=new fn(this._score.bind(this)),this.declarationProvider=new fn(this._score.bind(this)),this.implementationProvider=new fn(this._score.bind(this)),this.documentSymbolProvider=new fn(this._score.bind(this)),this.inlayHintsProvider=new fn(this._score.bind(this)),this.colorProvider=new fn(this._score.bind(this)),this.codeLensProvider=new fn(this._score.bind(this)),this.documentFormattingEditProvider=new fn(this._score.bind(this)),this.documentRangeFormattingEditProvider=new fn(this._score.bind(this)),this.onTypeFormattingEditProvider=new fn(this._score.bind(this)),this.signatureHelpProvider=new fn(this._score.bind(this)),this.hoverProvider=new fn(this._score.bind(this)),this.documentHighlightProvider=new fn(this._score.bind(this)),this.multiDocumentHighlightProvider=new fn(this._score.bind(this)),this.selectionRangeProvider=new fn(this._score.bind(this)),this.foldingRangeProvider=new fn(this._score.bind(this)),this.linkProvider=new fn(this._score.bind(this)),this.inlineCompletionsProvider=new fn(this._score.bind(this)),this.inlineEditProvider=new fn(this._score.bind(this)),this.completionProvider=new fn(this._score.bind(this)),this.linkedEditingRangeProvider=new fn(this._score.bind(this)),this.documentRangeSemanticTokensProvider=new fn(this._score.bind(this)),this.documentSemanticTokensProvider=new fn(this._score.bind(this)),this.documentDropEditProvider=new fn(this._score.bind(this)),this.documentPasteEditProvider=new fn(this._score.bind(this))}_score(e){var t;return(t=this._notebookTypeResolver)==null?void 0:t.call(this,e)}}qt(Be,MOe,1);function oK(s){return`--vscode-${s.replace(/\./g,"-")}`}function Fe(s){return`var(${oK(s)})`}function OOe(s,e){return`var(${oK(s)}, ${e})`}function FOe(s){return s!==null&&typeof s=="object"&&"light"in s&&"dark"in s}const nfe={ColorContribution:"base.contributions.colors"},VOe="default";class BOe{constructor(){this._onDidChangeSchema=new Z,this.onDidChangeSchema=this._onDidChangeSchema.event,this.colorSchema={type:"object",properties:{}},this.colorReferenceSchema={type:"string",enum:[],enumDescriptions:[]},this.colorsById={}}registerColor(e,t,i,n=!1,r){const o={id:e,description:i,defaults:t,needsTransparency:n,deprecationMessage:r};this.colorsById[e]=o;const a={type:"string",format:"color-hex",defaultSnippets:[{body:"${1:#ff0000}"}]};return r&&(a.deprecationMessage=r),n&&(a.pattern="^#(?:(?<rgba>[0-9a-fA-f]{3}[0-9a-eA-E])|(?:[0-9a-fA-F]{6}(?:(?![fF]{2})(?:[0-9a-fA-F]{2}))))?$",a.patternErrorMessage=b("transparecyRequired","This color must be transparent or it will obscure content")),this.colorSchema.properties[e]={description:i,oneOf:[a,{type:"string",const:VOe,description:b("useDefault","Use the default color.")}]},this.colorReferenceSchema.enum.push(e),this.colorReferenceSchema.enumDescriptions.push(i),this._onDidChangeSchema.fire(),e}getColors(){return Object.keys(this.colorsById).map(e=>this.colorsById[e])}resolveDefaultColor(e,t){const i=this.colorsById[e];if(i!=null&&i.defaults){const n=FOe(i.defaults)?i.defaults[t.type]:i.defaults;return Rd(n,t)}}getColorSchema(){return this.colorSchema}toString(){const e=(t,i)=>{const n=t.indexOf(".")===-1?0:1,r=i.indexOf(".")===-1?0:1;return n!==r?n-r:t.localeCompare(i)};return Object.keys(this.colorsById).sort(e).map(t=>`- \`${t}\`: ${this.colorsById[t].description}`).join(`
`)}}const yF=new BOe;_n.add(nfe.ColorContribution,yF);function j(s,e,t,i,n){return yF.registerColor(s,e,t,i,n)}function WOe(s,e){var t,i,n,r;switch(s.op){case 0:return(t=Rd(s.value,e))==null?void 0:t.darken(s.factor);case 1:return(i=Rd(s.value,e))==null?void 0:i.lighten(s.factor);case 2:return(n=Rd(s.value,e))==null?void 0:n.transparent(s.factor);case 3:{const o=Rd(s.background,e);return o?(r=Rd(s.value,e))==null?void 0:r.makeOpaque(o):Rd(s.value,e)}case 4:for(const o of s.values){const a=Rd(o,e);if(a)return a}return;case 6:return Rd(e.defines(s.if)?s.then:s.else,e);case 5:{const o=Rd(s.value,e);if(!o)return;const a=Rd(s.background,e);return a?o.isDarkerThan(a)?fe.getLighterColor(o,a,s.factor).transparent(s.transparency):fe.getDarkerColor(o,a,s.factor).transparent(s.transparency):o.transparent(s.factor*s.transparency)}default:throw gF()}}function Kw(s,e){return{op:0,value:s,factor:e}}function ru(s,e){return{op:1,value:s,factor:e}}function Tt(s,e){return{op:2,value:s,factor:e}}function uI(...s){return{op:4,values:s}}function HOe(s,e,t){return{op:6,if:s,then:e,else:t}}function yie(s,e,t,i){return{op:5,value:s,background:e,factor:t,transparency:i}}function Rd(s,e){if(s!==null){if(typeof s=="string")return s[0]==="#"?fe.fromHex(s):e.getColor(s);if(s instanceof fe)return s;if(typeof s=="object")return WOe(s,e)}}const sfe="vscode://schemas/workbench-colors",rfe=_n.as(bF.JSONContribution);rfe.registerSchema(sfe,yF.getColorSchema());const Sie=new xi(()=>rfe.notifySchemaChanged(sfe),200);yF.onDidChangeSchema(()=>{Sie.isScheduled()||Sie.schedule()});const Ot=j("foreground",{dark:"#CCCCCC",light:"#616161",hcDark:"#FFFFFF",hcLight:"#292929"},b("foreground","Overall foreground color. This color is only used if not overridden by a component."));j("disabledForeground",{dark:"#CCCCCC80",light:"#61616180",hcDark:"#A5A5A5",hcLight:"#7F7F7F"},b("disabledForeground","Overall foreground for disabled elements. This color is only used if not overridden by a component."));j("errorForeground",{dark:"#F48771",light:"#A1260D",hcDark:"#F48771",hcLight:"#B5200D"},b("errorForeground","Overall foreground color for error messages. This color is only used if not overridden by a component."));j("descriptionForeground",{light:"#717171",dark:Tt(Ot,.7),hcDark:Tt(Ot,.7),hcLight:Tt(Ot,.7)},b("descriptionForeground","Foreground color for description text providing additional information, for example for a label."));const lA=j("icon.foreground",{dark:"#C5C5C5",light:"#424242",hcDark:"#FFFFFF",hcLight:"#292929"},b("iconForeground","The default color for icons in the workbench.")),Ah=j("focusBorder",{dark:"#007FD4",light:"#0090F1",hcDark:"#F38518",hcLight:"#006BBD"},b("focusBorder","Overall border color for focused elements. This color is only used if not overridden by a component.")),Xt=j("contrastBorder",{light:null,dark:null,hcDark:"#6FC3DF",hcLight:"#0F4A85"},b("contrastBorder","An extra border around elements to separate them from others for greater contrast.")),tn=j("contrastActiveBorder",{light:null,dark:null,hcDark:Ah,hcLight:Ah},b("activeContrastBorder","An extra border around active elements to separate them from others for greater contrast."));j("selection.background",null,b("selectionBackground","The background color of text selections in the workbench (e.g. for input fields or text areas). Note that this does not apply to selections within the editor."));const zOe=j("textLink.foreground",{light:"#006AB1",dark:"#3794FF",hcDark:"#21A6FF",hcLight:"#0F4A85"},b("textLinkForeground","Foreground color for links in text."));j("textLink.activeForeground",{light:"#006AB1",dark:"#3794FF",hcDark:"#21A6FF",hcLight:"#0F4A85"},b("textLinkActiveForeground","Foreground color for links in text when clicked on and on mouse hover."));j("textSeparator.foreground",{light:"#0000002e",dark:"#ffffff2e",hcDark:fe.black,hcLight:"#292929"},b("textSeparatorForeground","Color for text separators."));j("textPreformat.foreground",{light:"#A31515",dark:"#D7BA7D",hcDark:"#000000",hcLight:"#FFFFFF"},b("textPreformatForeground","Foreground color for preformatted text segments."));j("textPreformat.background",{light:"#0000001A",dark:"#FFFFFF1A",hcDark:"#FFFFFF",hcLight:"#09345f"},b("textPreformatBackground","Background color for preformatted text segments."));j("textBlockQuote.background",{light:"#f2f2f2",dark:"#222222",hcDark:null,hcLight:"#F2F2F2"},b("textBlockQuoteBackground","Background color for block quotes in text."));j("textBlockQuote.border",{light:"#007acc80",dark:"#007acc80",hcDark:fe.white,hcLight:"#292929"},b("textBlockQuoteBorder","Border color for block quotes in text."));j("textCodeBlock.background",{light:"#dcdcdc66",dark:"#0a0a0a66",hcDark:fe.black,hcLight:"#F2F2F2"},b("textCodeBlockBackground","Background color for code blocks in text."));j("sash.hoverBorder",Ah,b("sashActiveBorder","Border color of active sashes."));const TR=j("badge.background",{dark:"#4D4D4D",light:"#C4C4C4",hcDark:fe.black,hcLight:"#0F4A85"},b("badgeBackground","Badge background color. Badges are small information labels, e.g. for search results count.")),UOe=j("badge.foreground",{dark:fe.white,light:"#333",hcDark:fe.white,hcLight:fe.white},b("badgeForeground","Badge foreground color. Badges are small information labels, e.g. for search results count.")),aK=j("scrollbar.shadow",{dark:"#000000",light:"#DDDDDD",hcDark:null,hcLight:null},b("scrollbarShadow","Scrollbar shadow to indicate that the view is scrolled.")),ofe=j("scrollbarSlider.background",{dark:fe.fromHex("#797979").transparent(.4),light:fe.fromHex("#646464").transparent(.4),hcDark:Tt(Xt,.6),hcLight:Tt(Xt,.4)},b("scrollbarSliderBackground","Scrollbar slider background color.")),afe=j("scrollbarSlider.hoverBackground",{dark:fe.fromHex("#646464").transparent(.7),light:fe.fromHex("#646464").transparent(.7),hcDark:Tt(Xt,.8),hcLight:Tt(Xt,.8)},b("scrollbarSliderHoverBackground","Scrollbar slider background color when hovering.")),lfe=j("scrollbarSlider.activeBackground",{dark:fe.fromHex("#BFBFBF").transparent(.4),light:fe.fromHex("#000000").transparent(.6),hcDark:Xt,hcLight:Xt},b("scrollbarSliderActiveBackground","Scrollbar slider background color when clicked on.")),jOe=j("progressBar.background",{dark:fe.fromHex("#0E70C0"),light:fe.fromHex("#0E70C0"),hcDark:Xt,hcLight:Xt},b("progressBarBackground","Background color of the progress bar that can show for long running operations.")),dd=j("editor.background",{light:"#ffffff",dark:"#1E1E1E",hcDark:fe.black,hcLight:fe.white},b("editorBackground","Editor background color.")),qh=j("editor.foreground",{light:"#333333",dark:"#BBBBBB",hcDark:fe.white,hcLight:Ot},b("editorForeground","Editor default foreground color."));j("editorStickyScroll.background",dd,b("editorStickyScrollBackground","Background color of sticky scroll in the editor"));j("editorStickyScrollHover.background",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:null,hcLight:fe.fromHex("#0F4A85").transparent(.1)},b("editorStickyScrollHoverBackground","Background color of sticky scroll on hover in the editor"));j("editorStickyScroll.border",{dark:null,light:null,hcDark:Xt,hcLight:Xt},b("editorStickyScrollBorder","Border color of sticky scroll in the editor"));j("editorStickyScroll.shadow",aK,b("editorStickyScrollShadow"," Shadow color of sticky scroll in the editor"));const yl=j("editorWidget.background",{dark:"#252526",light:"#F3F3F3",hcDark:"#0C141F",hcLight:fe.white},b("editorWidgetBackground","Background color of editor widgets, such as find/replace.")),SF=j("editorWidget.foreground",Ot,b("editorWidgetForeground","Foreground color of editor widgets, such as find/replace.")),lK=j("editorWidget.border",{dark:"#454545",light:"#C8C8C8",hcDark:Xt,hcLight:Xt},b("editorWidgetBorder","Border color of editor widgets. The color is only used if the widget chooses to have a border and if the color is not overridden by a widget."));j("editorWidget.resizeBorder",null,b("editorWidgetResizeBorder","Border color of the resize bar of editor widgets. The color is only used if the widget chooses to have a resize border and if the color is not overridden by a widget."));j("editorError.background",null,b("editorError.background","Background color of error text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0);const xF=j("editorError.foreground",{dark:"#F14C4C",light:"#E51400",hcDark:"#F48771",hcLight:"#B5200D"},b("editorError.foreground","Foreground color of error squigglies in the editor.")),$Oe=j("editorError.border",{dark:null,light:null,hcDark:fe.fromHex("#E47777").transparent(.8),hcLight:"#B5200D"},b("errorBorder","If set, color of double underlines for errors in the editor.")),qOe=j("editorWarning.background",null,b("editorWarning.background","Background color of warning text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),Lg=j("editorWarning.foreground",{dark:"#CCA700",light:"#BF8803",hcDark:"#FFD370",hcLight:"#895503"},b("editorWarning.foreground","Foreground color of warning squigglies in the editor.")),hI=j("editorWarning.border",{dark:null,light:null,hcDark:fe.fromHex("#FFCC00").transparent(.8),hcLight:fe.fromHex("#FFCC00").transparent(.8)},b("warningBorder","If set, color of double underlines for warnings in the editor."));j("editorInfo.background",null,b("editorInfo.background","Background color of info text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0);const Ph=j("editorInfo.foreground",{dark:"#3794FF",light:"#1a85ff",hcDark:"#3794FF",hcLight:"#1a85ff"},b("editorInfo.foreground","Foreground color of info squigglies in the editor.")),fI=j("editorInfo.border",{dark:null,light:null,hcDark:fe.fromHex("#3794FF").transparent(.8),hcLight:"#292929"},b("infoBorder","If set, color of double underlines for infos in the editor.")),KOe=j("editorHint.foreground",{dark:fe.fromHex("#eeeeee").transparent(.7),light:"#6c6c6c",hcDark:null,hcLight:null},b("editorHint.foreground","Foreground color of hint squigglies in the editor."));j("editorHint.border",{dark:null,light:null,hcDark:fe.fromHex("#eeeeee").transparent(.8),hcLight:"#292929"},b("hintBorder","If set, color of double underlines for hints in the editor."));const GOe=j("editorLink.activeForeground",{dark:"#4E94CE",light:fe.blue,hcDark:fe.cyan,hcLight:"#292929"},b("activeLinkForeground","Color of active links.")),Up=j("editor.selectionBackground",{light:"#ADD6FF",dark:"#264F78",hcDark:"#f3f518",hcLight:"#0F4A85"},b("editorSelectionBackground","Color of the editor selection.")),QOe=j("editor.selectionForeground",{light:null,dark:null,hcDark:"#000000",hcLight:fe.white},b("editorSelectionForeground","Color of the selected text for high contrast.")),cfe=j("editor.inactiveSelectionBackground",{light:Tt(Up,.5),dark:Tt(Up,.5),hcDark:Tt(Up,.7),hcLight:Tt(Up,.5)},b("editorInactiveSelection","Color of the selection in an inactive editor. The color must not be opaque so as not to hide underlying decorations."),!0),cK=j("editor.selectionHighlightBackground",{light:yie(Up,dd,.3,.6),dark:yie(Up,dd,.3,.6),hcDark:null,hcLight:null},b("editorSelectionHighlight","Color for regions with the same content as the selection. The color must not be opaque so as not to hide underlying decorations."),!0);j("editor.selectionHighlightBorder",{light:null,dark:null,hcDark:tn,hcLight:tn},b("editorSelectionHighlightBorder","Border color for regions with the same content as the selection."));j("editor.findMatchBackground",{light:"#A8AC94",dark:"#515C6A",hcDark:null,hcLight:null},b("editorFindMatch","Color of the current search match."));const YOe=j("editor.findMatchForeground",null,b("editorFindMatchForeground","Text color of the current search match.")),Gf=j("editor.findMatchHighlightBackground",{light:"#EA5C0055",dark:"#EA5C0055",hcDark:null,hcLight:null},b("findMatchHighlight","Color of the other search matches. The color must not be opaque so as not to hide underlying decorations."),!0),XOe=j("editor.findMatchHighlightForeground",null,b("findMatchHighlightForeground","Foreground color of the other search matches."),!0);j("editor.findRangeHighlightBackground",{dark:"#3a3d4166",light:"#b4b4b44d",hcDark:null,hcLight:null},b("findRangeHighlight","Color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0);j("editor.findMatchBorder",{light:null,dark:null,hcDark:tn,hcLight:tn},b("editorFindMatchBorder","Border color of the current search match."));const jp=j("editor.findMatchHighlightBorder",{light:null,dark:null,hcDark:tn,hcLight:tn},b("findMatchHighlightBorder","Border color of the other search matches.")),ZOe=j("editor.findRangeHighlightBorder",{dark:null,light:null,hcDark:Tt(tn,.4),hcLight:Tt(tn,.4)},b("findRangeHighlightBorder","Border color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0);j("editor.hoverHighlightBackground",{light:"#ADD6FF26",dark:"#264f7840",hcDark:"#ADD6FF26",hcLight:null},b("hoverHighlight","Highlight below the word for which a hover is shown. The color must not be opaque so as not to hide underlying decorations."),!0);const cA=j("editorHoverWidget.background",yl,b("hoverBackground","Background color of the editor hover."));j("editorHoverWidget.foreground",SF,b("hoverForeground","Foreground color of the editor hover."));const dfe=j("editorHoverWidget.border",lK,b("hoverBorder","Border color of the editor hover."));j("editorHoverWidget.statusBarBackground",{dark:ru(cA,.2),light:Kw(cA,.05),hcDark:yl,hcLight:yl},b("statusBarBackground","Background color of the editor hover status bar."));const dK=j("editorInlayHint.foreground",{dark:"#969696",light:"#969696",hcDark:fe.white,hcLight:fe.black},b("editorInlayHintForeground","Foreground color of inline hints")),uK=j("editorInlayHint.background",{dark:Tt(TR,.1),light:Tt(TR,.1),hcDark:Tt(fe.white,.1),hcLight:Tt(TR,.1)},b("editorInlayHintBackground","Background color of inline hints")),JOe=j("editorInlayHint.typeForeground",dK,b("editorInlayHintForegroundTypes","Foreground color of inline hints for types")),e4e=j("editorInlayHint.typeBackground",uK,b("editorInlayHintBackgroundTypes","Background color of inline hints for types")),t4e=j("editorInlayHint.parameterForeground",dK,b("editorInlayHintForegroundParameter","Foreground color of inline hints for parameters")),i4e=j("editorInlayHint.parameterBackground",uK,b("editorInlayHintBackgroundParameter","Background color of inline hints for parameters")),n4e=j("editorLightBulb.foreground",{dark:"#FFCC00",light:"#DDB100",hcDark:"#FFCC00",hcLight:"#007ACC"},b("editorLightBulbForeground","The color used for the lightbulb actions icon."));j("editorLightBulbAutoFix.foreground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},b("editorLightBulbAutoFixForeground","The color used for the lightbulb auto fix actions icon."));j("editorLightBulbAi.foreground",n4e,b("editorLightBulbAiForeground","The color used for the lightbulb AI icon."));j("editor.snippetTabstopHighlightBackground",{dark:new fe(new Jt(124,124,124,.3)),light:new fe(new Jt(10,50,100,.2)),hcDark:new fe(new Jt(124,124,124,.3)),hcLight:new fe(new Jt(10,50,100,.2))},b("snippetTabstopHighlightBackground","Highlight background color of a snippet tabstop."));j("editor.snippetTabstopHighlightBorder",null,b("snippetTabstopHighlightBorder","Highlight border color of a snippet tabstop."));j("editor.snippetFinalTabstopHighlightBackground",null,b("snippetFinalTabstopHighlightBackground","Highlight background color of the final tabstop of a snippet."));j("editor.snippetFinalTabstopHighlightBorder",{dark:"#525252",light:new fe(new Jt(10,50,100,.5)),hcDark:"#525252",hcLight:"#292929"},b("snippetFinalTabstopHighlightBorder","Highlight border color of the final tabstop of a snippet."));const I6=new fe(new Jt(155,185,85,.2)),E6=new fe(new Jt(255,0,0,.2)),s4e=j("diffEditor.insertedTextBackground",{dark:"#9ccc2c33",light:"#9ccc2c40",hcDark:null,hcLight:null},b("diffEditorInserted","Background color for text that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0),r4e=j("diffEditor.removedTextBackground",{dark:"#ff000033",light:"#ff000033",hcDark:null,hcLight:null},b("diffEditorRemoved","Background color for text that got removed. The color must not be opaque so as not to hide underlying decorations."),!0);j("diffEditor.insertedLineBackground",{dark:I6,light:I6,hcDark:null,hcLight:null},b("diffEditorInsertedLines","Background color for lines that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0);j("diffEditor.removedLineBackground",{dark:E6,light:E6,hcDark:null,hcLight:null},b("diffEditorRemovedLines","Background color for lines that got removed. The color must not be opaque so as not to hide underlying decorations."),!0);j("diffEditorGutter.insertedLineBackground",null,b("diffEditorInsertedLineGutter","Background color for the margin where lines got inserted."));j("diffEditorGutter.removedLineBackground",null,b("diffEditorRemovedLineGutter","Background color for the margin where lines got removed."));const o4e=j("diffEditorOverview.insertedForeground",null,b("diffEditorOverviewInserted","Diff overview ruler foreground for inserted content.")),a4e=j("diffEditorOverview.removedForeground",null,b("diffEditorOverviewRemoved","Diff overview ruler foreground for removed content."));j("diffEditor.insertedTextBorder",{dark:null,light:null,hcDark:"#33ff2eff",hcLight:"#374E06"},b("diffEditorInsertedOutline","Outline color for the text that got inserted."));j("diffEditor.removedTextBorder",{dark:null,light:null,hcDark:"#FF008F",hcLight:"#AD0707"},b("diffEditorRemovedOutline","Outline color for text that got removed."));j("diffEditor.border",{dark:null,light:null,hcDark:Xt,hcLight:Xt},b("diffEditorBorder","Border color between the two text editors."));j("diffEditor.diagonalFill",{dark:"#cccccc33",light:"#22222233",hcDark:null,hcLight:null},b("diffDiagonalFill","Color of the diff editor's diagonal fill. The diagonal fill is used in side-by-side diff views."));j("diffEditor.unchangedRegionBackground","sideBar.background",b("diffEditor.unchangedRegionBackground","The background color of unchanged blocks in the diff editor."));j("diffEditor.unchangedRegionForeground","foreground",b("diffEditor.unchangedRegionForeground","The foreground color of unchanged blocks in the diff editor."));j("diffEditor.unchangedCodeBackground",{dark:"#74747429",light:"#b8b8b829",hcDark:null,hcLight:null},b("diffEditor.unchangedCodeBackground","The background color of unchanged code in the diff editor."));const gS=j("widget.shadow",{dark:Tt(fe.black,.36),light:Tt(fe.black,.16),hcDark:null,hcLight:null},b("widgetShadow","Shadow color of widgets such as find/replace inside the editor.")),ufe=j("widget.border",{dark:null,light:null,hcDark:Xt,hcLight:Xt},b("widgetBorder","Border color of widgets such as find/replace inside the editor.")),xie=j("toolbar.hoverBackground",{dark:"#5a5d5e50",light:"#b8b8b850",hcDark:null,hcLight:null},b("toolbarHoverBackground","Toolbar background when hovering over actions using the mouse"));j("toolbar.hoverOutline",{dark:null,light:null,hcDark:tn,hcLight:tn},b("toolbarHoverOutline","Toolbar outline when hovering over actions using the mouse"));j("toolbar.activeBackground",{dark:ru(xie,.1),light:Kw(xie,.1),hcDark:null,hcLight:null},b("toolbarActiveBackground","Toolbar background when holding the mouse over actions"));const l4e=j("breadcrumb.foreground",Tt(Ot,.8),b("breadcrumbsFocusForeground","Color of focused breadcrumb items.")),c4e=j("breadcrumb.background",dd,b("breadcrumbsBackground","Background color of breadcrumb items.")),Lie=j("breadcrumb.focusForeground",{light:Kw(Ot,.2),dark:ru(Ot,.1),hcDark:ru(Ot,.1),hcLight:ru(Ot,.1)},b("breadcrumbsFocusForeground","Color of focused breadcrumb items.")),d4e=j("breadcrumb.activeSelectionForeground",{light:Kw(Ot,.2),dark:ru(Ot,.1),hcDark:ru(Ot,.1),hcLight:ru(Ot,.1)},b("breadcrumbsSelectedForeground","Color of selected breadcrumb items."));j("breadcrumbPicker.background",yl,b("breadcrumbsSelectedBackground","Background color of breadcrumb item picker."));const hfe=.5,kie=fe.fromHex("#40C8AE").transparent(hfe),Iie=fe.fromHex("#40A6FF").transparent(hfe),Eie=fe.fromHex("#606060").transparent(.4),hK=.4,_1=1,D6=j("merge.currentHeaderBackground",{dark:kie,light:kie,hcDark:null,hcLight:null},b("mergeCurrentHeaderBackground","Current header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);j("merge.currentContentBackground",Tt(D6,hK),b("mergeCurrentContentBackground","Current content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);const T6=j("merge.incomingHeaderBackground",{dark:Iie,light:Iie,hcDark:null,hcLight:null},b("mergeIncomingHeaderBackground","Incoming header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);j("merge.incomingContentBackground",Tt(T6,hK),b("mergeIncomingContentBackground","Incoming content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);const N6=j("merge.commonHeaderBackground",{dark:Eie,light:Eie,hcDark:null,hcLight:null},b("mergeCommonHeaderBackground","Common ancestor header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);j("merge.commonContentBackground",Tt(N6,hK),b("mergeCommonContentBackground","Common ancestor content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);const b1=j("merge.border",{dark:null,light:null,hcDark:"#C3DF6F",hcLight:"#007ACC"},b("mergeBorder","Border color on headers and the splitter in inline merge-conflicts."));j("editorOverviewRuler.currentContentForeground",{dark:Tt(D6,_1),light:Tt(D6,_1),hcDark:b1,hcLight:b1},b("overviewRulerCurrentContentForeground","Current overview ruler foreground for inline merge-conflicts."));j("editorOverviewRuler.incomingContentForeground",{dark:Tt(T6,_1),light:Tt(T6,_1),hcDark:b1,hcLight:b1},b("overviewRulerIncomingContentForeground","Incoming overview ruler foreground for inline merge-conflicts."));j("editorOverviewRuler.commonContentForeground",{dark:Tt(N6,_1),light:Tt(N6,_1),hcDark:b1,hcLight:b1},b("overviewRulerCommonContentForeground","Common ancestor overview ruler foreground for inline merge-conflicts."));const xV=j("editorOverviewRuler.findMatchForeground",{dark:"#d186167e",light:"#d186167e",hcDark:"#AB5A00",hcLight:"#AB5A00"},b("overviewRulerFindMatchForeground","Overview ruler marker color for find matches. The color must not be opaque so as not to hide underlying decorations."),!0),ffe=j("editorOverviewRuler.selectionHighlightForeground","#A0A0A0CC",b("overviewRulerSelectionHighlightForeground","Overview ruler marker color for selection highlights. The color must not be opaque so as not to hide underlying decorations."),!0),u4e=j("problemsErrorIcon.foreground",xF,b("problemsErrorIconForeground","The color used for the problems error icon.")),h4e=j("problemsWarningIcon.foreground",Lg,b("problemsWarningIconForeground","The color used for the problems warning icon.")),f4e=j("problemsInfoIcon.foreground",Ph,b("problemsInfoIconForeground","The color used for the problems info icon.")),R6=j("minimap.findMatchHighlight",{light:"#d18616",dark:"#d18616",hcDark:"#AB5A00",hcLight:"#0F4A85"},b("minimapFindMatchHighlight","Minimap marker color for find matches."),!0),LF=j("minimap.selectionOccurrenceHighlight",{light:"#c9c9c9",dark:"#676767",hcDark:"#ffffff",hcLight:"#0F4A85"},b("minimapSelectionOccurrenceHighlight","Minimap marker color for repeating editor selections."),!0),Die=j("minimap.selectionHighlight",{light:"#ADD6FF",dark:"#264F78",hcDark:"#ffffff",hcLight:"#0F4A85"},b("minimapSelectionHighlight","Minimap marker color for the editor selection."),!0),g4e=j("minimap.infoHighlight",{dark:Ph,light:Ph,hcDark:fI,hcLight:fI},b("minimapInfo","Minimap marker color for infos.")),p4e=j("minimap.warningHighlight",{dark:Lg,light:Lg,hcDark:hI,hcLight:hI},b("overviewRuleWarning","Minimap marker color for warnings.")),m4e=j("minimap.errorHighlight",{dark:new fe(new Jt(255,18,18,.7)),light:new fe(new Jt(255,18,18,.7)),hcDark:new fe(new Jt(255,50,50,1)),hcLight:"#B5200D"},b("minimapError","Minimap marker color for errors.")),_4e=j("minimap.background",null,b("minimapBackground","Minimap background color.")),b4e=j("minimap.foregroundOpacity",fe.fromHex("#000f"),b("minimapForegroundOpacity",'Opacity of foreground elements rendered in the minimap. For example, "#000000c0" will render the elements with 75% opacity.'));j("minimapSlider.background",Tt(ofe,.5),b("minimapSliderBackground","Minimap slider background color."));j("minimapSlider.hoverBackground",Tt(afe,.5),b("minimapSliderHoverBackground","Minimap slider background color when hovering."));j("minimapSlider.activeBackground",Tt(lfe,.5),b("minimapSliderActiveBackground","Minimap slider background color when clicked on."));j("charts.foreground",Ot,b("chartsForeground","The foreground color used in charts."));j("charts.lines",Tt(Ot,.5),b("chartsLines","The color used for horizontal lines in charts."));j("charts.red",xF,b("chartsRed","The red color used in chart visualizations."));j("charts.blue",Ph,b("chartsBlue","The blue color used in chart visualizations."));j("charts.yellow",Lg,b("chartsYellow","The yellow color used in chart visualizations."));j("charts.orange",R6,b("chartsOrange","The orange color used in chart visualizations."));j("charts.green",{dark:"#89D185",light:"#388A34",hcDark:"#89D185",hcLight:"#374e06"},b("chartsGreen","The green color used in chart visualizations."));j("charts.purple",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},b("chartsPurple","The purple color used in chart visualizations."));const A6=j("input.background",{dark:"#3C3C3C",light:fe.white,hcDark:fe.black,hcLight:fe.white},b("inputBoxBackground","Input box background.")),gfe=j("input.foreground",Ot,b("inputBoxForeground","Input box foreground.")),pfe=j("input.border",{dark:null,light:null,hcDark:Xt,hcLight:Xt},b("inputBoxBorder","Input box border.")),kF=j("inputOption.activeBorder",{dark:"#007ACC",light:"#007ACC",hcDark:Xt,hcLight:Xt},b("inputBoxActiveOptionBorder","Border color of activated options in input fields.")),v4e=j("inputOption.hoverBackground",{dark:"#5a5d5e80",light:"#b8b8b850",hcDark:null,hcLight:null},b("inputOption.hoverBackground","Background color of activated options in input fields.")),GE=j("inputOption.activeBackground",{dark:Tt(Ah,.4),light:Tt(Ah,.2),hcDark:fe.transparent,hcLight:fe.transparent},b("inputOption.activeBackground","Background hover color of options in input fields.")),IF=j("inputOption.activeForeground",{dark:fe.white,light:fe.black,hcDark:Ot,hcLight:Ot},b("inputOption.activeForeground","Foreground color of activated options in input fields."));j("input.placeholderForeground",{light:Tt(Ot,.5),dark:Tt(Ot,.5),hcDark:Tt(Ot,.7),hcLight:Tt(Ot,.7)},b("inputPlaceholderForeground","Input box foreground color for placeholder text."));const w4e=j("inputValidation.infoBackground",{dark:"#063B49",light:"#D6ECF2",hcDark:fe.black,hcLight:fe.white},b("inputValidationInfoBackground","Input validation background color for information severity.")),C4e=j("inputValidation.infoForeground",{dark:null,light:null,hcDark:null,hcLight:Ot},b("inputValidationInfoForeground","Input validation foreground color for information severity.")),y4e=j("inputValidation.infoBorder",{dark:"#007acc",light:"#007acc",hcDark:Xt,hcLight:Xt},b("inputValidationInfoBorder","Input validation border color for information severity.")),S4e=j("inputValidation.warningBackground",{dark:"#352A05",light:"#F6F5D2",hcDark:fe.black,hcLight:fe.white},b("inputValidationWarningBackground","Input validation background color for warning severity.")),x4e=j("inputValidation.warningForeground",{dark:null,light:null,hcDark:null,hcLight:Ot},b("inputValidationWarningForeground","Input validation foreground color for warning severity.")),L4e=j("inputValidation.warningBorder",{dark:"#B89500",light:"#B89500",hcDark:Xt,hcLight:Xt},b("inputValidationWarningBorder","Input validation border color for warning severity.")),k4e=j("inputValidation.errorBackground",{dark:"#5A1D1D",light:"#F2DEDE",hcDark:fe.black,hcLight:fe.white},b("inputValidationErrorBackground","Input validation background color for error severity.")),I4e=j("inputValidation.errorForeground",{dark:null,light:null,hcDark:null,hcLight:Ot},b("inputValidationErrorForeground","Input validation foreground color for error severity.")),E4e=j("inputValidation.errorBorder",{dark:"#BE1100",light:"#BE1100",hcDark:Xt,hcLight:Xt},b("inputValidationErrorBorder","Input validation border color for error severity.")),EF=j("dropdown.background",{dark:"#3C3C3C",light:fe.white,hcDark:fe.black,hcLight:fe.white},b("dropdownBackground","Dropdown background.")),D4e=j("dropdown.listBackground",{dark:null,light:null,hcDark:fe.black,hcLight:fe.white},b("dropdownListBackground","Dropdown list background.")),fK=j("dropdown.foreground",{dark:"#F0F0F0",light:Ot,hcDark:fe.white,hcLight:Ot},b("dropdownForeground","Dropdown foreground.")),gK=j("dropdown.border",{dark:EF,light:"#CECECE",hcDark:Xt,hcLight:Xt},b("dropdownBorder","Dropdown border.")),mfe=j("button.foreground",fe.white,b("buttonForeground","Button foreground color.")),T4e=j("button.separator",Tt(mfe,.4),b("buttonSeparator","Button separator color.")),eL=j("button.background",{dark:"#0E639C",light:"#007ACC",hcDark:null,hcLight:"#0F4A85"},b("buttonBackground","Button background color.")),N4e=j("button.hoverBackground",{dark:ru(eL,.2),light:Kw(eL,.2),hcDark:eL,hcLight:eL},b("buttonHoverBackground","Button background color when hovering.")),R4e=j("button.border",Xt,b("buttonBorder","Button border color.")),A4e=j("button.secondaryForeground",{dark:fe.white,light:fe.white,hcDark:fe.white,hcLight:Ot},b("buttonSecondaryForeground","Secondary button foreground color.")),P6=j("button.secondaryBackground",{dark:"#3A3D41",light:"#5F6A79",hcDark:null,hcLight:fe.white},b("buttonSecondaryBackground","Secondary button background color.")),P4e=j("button.secondaryHoverBackground",{dark:ru(P6,.2),light:Kw(P6,.2),hcDark:null,hcLight:null},b("buttonSecondaryHoverBackground","Secondary button background color when hovering.")),tL=j("radio.activeForeground",IF,b("radioActiveForeground","Foreground color of active radio option.")),M4e=j("radio.activeBackground",GE,b("radioBackground","Background color of active radio option.")),O4e=j("radio.activeBorder",kF,b("radioActiveBorder","Border color of the active radio option.")),F4e=j("radio.inactiveForeground",null,b("radioInactiveForeground","Foreground color of inactive radio option.")),V4e=j("radio.inactiveBackground",null,b("radioInactiveBackground","Background color of inactive radio option.")),B4e=j("radio.inactiveBorder",{light:Tt(tL,.2),dark:Tt(tL,.2),hcDark:Tt(tL,.4),hcLight:Tt(tL,.2)},b("radioInactiveBorder","Border color of the inactive radio option.")),W4e=j("radio.inactiveHoverBackground",v4e,b("radioHoverBackground","Background color of inactive active radio option when hovering.")),H4e=j("checkbox.background",EF,b("checkbox.background","Background color of checkbox widget."));j("checkbox.selectBackground",yl,b("checkbox.select.background","Background color of checkbox widget when the element it's in is selected."));const z4e=j("checkbox.foreground",fK,b("checkbox.foreground","Foreground color of checkbox widget.")),U4e=j("checkbox.border",gK,b("checkbox.border","Border color of checkbox widget."));j("checkbox.selectBorder",lA,b("checkbox.select.border","Border color of checkbox widget when the element it's in is selected."));const j4e=j("keybindingLabel.background",{dark:new fe(new Jt(128,128,128,.17)),light:new fe(new Jt(221,221,221,.4)),hcDark:fe.transparent,hcLight:fe.transparent},b("keybindingLabelBackground","Keybinding label background color. The keybinding label is used to represent a keyboard shortcut.")),$4e=j("keybindingLabel.foreground",{dark:fe.fromHex("#CCCCCC"),light:fe.fromHex("#555555"),hcDark:fe.white,hcLight:Ot},b("keybindingLabelForeground","Keybinding label foreground color. The keybinding label is used to represent a keyboard shortcut.")),q4e=j("keybindingLabel.border",{dark:new fe(new Jt(51,51,51,.6)),light:new fe(new Jt(204,204,204,.4)),hcDark:new fe(new Jt(111,195,223)),hcLight:Xt},b("keybindingLabelBorder","Keybinding label border color. The keybinding label is used to represent a keyboard shortcut.")),K4e=j("keybindingLabel.bottomBorder",{dark:new fe(new Jt(68,68,68,.6)),light:new fe(new Jt(187,187,187,.4)),hcDark:new fe(new Jt(111,195,223)),hcLight:Ot},b("keybindingLabelBottomBorder","Keybinding label border bottom color. The keybinding label is used to represent a keyboard shortcut.")),G4e=j("list.focusBackground",null,b("listFocusBackground","List/Tree background color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),Q4e=j("list.focusForeground",null,b("listFocusForeground","List/Tree foreground color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),Y4e=j("list.focusOutline",{dark:Ah,light:Ah,hcDark:tn,hcLight:tn},b("listFocusOutline","List/Tree outline color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),X4e=j("list.focusAndSelectionOutline",null,b("listFocusAndSelectionOutline","List/Tree outline color for the focused item when the list/tree is active and selected. An active list/tree has keyboard focus, an inactive does not.")),gw=j("list.activeSelectionBackground",{dark:"#04395E",light:"#0060C0",hcDark:null,hcLight:fe.fromHex("#0F4A85").transparent(.1)},b("listActiveSelectionBackground","List/Tree background color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),gI=j("list.activeSelectionForeground",{dark:fe.white,light:fe.white,hcDark:null,hcLight:null},b("listActiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),_fe=j("list.activeSelectionIconForeground",null,b("listActiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),Z4e=j("list.inactiveSelectionBackground",{dark:"#37373D",light:"#E4E6F1",hcDark:null,hcLight:fe.fromHex("#0F4A85").transparent(.1)},b("listInactiveSelectionBackground","List/Tree background color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),J4e=j("list.inactiveSelectionForeground",null,b("listInactiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),eFe=j("list.inactiveSelectionIconForeground",null,b("listInactiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),tFe=j("list.inactiveFocusBackground",null,b("listInactiveFocusBackground","List/Tree background color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),iFe=j("list.inactiveFocusOutline",null,b("listInactiveFocusOutline","List/Tree outline color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),bfe=j("list.hoverBackground",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:fe.white.transparent(.1),hcLight:fe.fromHex("#0F4A85").transparent(.1)},b("listHoverBackground","List/Tree background when hovering over items using the mouse.")),vfe=j("list.hoverForeground",null,b("listHoverForeground","List/Tree foreground when hovering over items using the mouse.")),nFe=j("list.dropBackground",{dark:"#062F4A",light:"#D6EBFF",hcDark:null,hcLight:null},b("listDropBackground","List/Tree drag and drop background when moving items over other items when using the mouse.")),sFe=j("list.dropBetweenBackground",{dark:lA,light:lA,hcDark:null,hcLight:null},b("listDropBetweenBackground","List/Tree drag and drop border color when moving items between items when using the mouse.")),IC=j("list.highlightForeground",{dark:"#2AAAFF",light:"#0066BF",hcDark:Ah,hcLight:Ah},b("highlight","List/Tree foreground color of the match highlights when searching inside the list/tree.")),rFe=j("list.focusHighlightForeground",{dark:IC,light:HOe(gw,IC,"#BBE7FF"),hcDark:IC,hcLight:IC},b("listFocusHighlightForeground","List/Tree foreground color of the match highlights on actively focused items when searching inside the list/tree."));j("list.invalidItemForeground",{dark:"#B89500",light:"#B89500",hcDark:"#B89500",hcLight:"#B5200D"},b("invalidItemForeground","List/Tree foreground color for invalid items, for example an unresolved root in explorer."));j("list.errorForeground",{dark:"#F88070",light:"#B01011",hcDark:null,hcLight:null},b("listErrorForeground","Foreground color of list items containing errors."));j("list.warningForeground",{dark:"#CCA700",light:"#855F00",hcDark:null,hcLight:null},b("listWarningForeground","Foreground color of list items containing warnings."));const oFe=j("listFilterWidget.background",{light:Kw(yl,0),dark:ru(yl,0),hcDark:yl,hcLight:yl},b("listFilterWidgetBackground","Background color of the type filter widget in lists and trees.")),aFe=j("listFilterWidget.outline",{dark:fe.transparent,light:fe.transparent,hcDark:"#f38518",hcLight:"#007ACC"},b("listFilterWidgetOutline","Outline color of the type filter widget in lists and trees.")),lFe=j("listFilterWidget.noMatchesOutline",{dark:"#BE1100",light:"#BE1100",hcDark:Xt,hcLight:Xt},b("listFilterWidgetNoMatchesOutline","Outline color of the type filter widget in lists and trees, when there are no matches.")),cFe=j("listFilterWidget.shadow",gS,b("listFilterWidgetShadow","Shadow color of the type filter widget in lists and trees."));j("list.filterMatchBackground",{dark:Gf,light:Gf,hcDark:null,hcLight:null},b("listFilterMatchHighlight","Background color of the filtered match."));j("list.filterMatchBorder",{dark:jp,light:jp,hcDark:Xt,hcLight:tn},b("listFilterMatchHighlightBorder","Border color of the filtered match."));j("list.deemphasizedForeground",{dark:"#8C8C8C",light:"#8E8E90",hcDark:"#A7A8A9",hcLight:"#666666"},b("listDeemphasizedForeground","List/Tree foreground color for items that are deemphasized."));const wfe=j("tree.indentGuidesStroke",{dark:"#585858",light:"#a9a9a9",hcDark:"#a9a9a9",hcLight:"#a5a5a5"},b("treeIndentGuidesStroke","Tree stroke color for the indentation guides.")),dFe=j("tree.inactiveIndentGuidesStroke",Tt(wfe,.4),b("treeInactiveIndentGuidesStroke","Tree stroke color for the indentation guides that are not active.")),uFe=j("tree.tableColumnsBorder",{dark:"#CCCCCC20",light:"#61616120",hcDark:null,hcLight:null},b("tableColumnsBorder","Table border color between columns.")),hFe=j("tree.tableOddRowsBackground",{dark:Tt(Ot,.04),light:Tt(Ot,.04),hcDark:null,hcLight:null},b("tableOddRowsBackgroundColor","Background color for odd table rows."));j("editorActionList.background",yl,b("editorActionListBackground","Action List background color."));j("editorActionList.foreground",SF,b("editorActionListForeground","Action List foreground color."));j("editorActionList.focusForeground",gI,b("editorActionListFocusForeground","Action List foreground color for the focused item."));j("editorActionList.focusBackground",gw,b("editorActionListFocusBackground","Action List background color for the focused item."));const fFe=j("menu.border",{dark:null,light:null,hcDark:Xt,hcLight:Xt},b("menuBorder","Border color of menus.")),gFe=j("menu.foreground",fK,b("menuForeground","Foreground color of menu items.")),pFe=j("menu.background",EF,b("menuBackground","Background color of menu items.")),mFe=j("menu.selectionForeground",gI,b("menuSelectionForeground","Foreground color of the selected menu item in menus.")),_Fe=j("menu.selectionBackground",gw,b("menuSelectionBackground","Background color of the selected menu item in menus.")),bFe=j("menu.selectionBorder",{dark:null,light:null,hcDark:tn,hcLight:tn},b("menuSelectionBorder","Border color of the selected menu item in menus.")),vFe=j("menu.separatorBackground",{dark:"#606060",light:"#D4D4D4",hcDark:Xt,hcLight:Xt},b("menuSeparatorBackground","Color of a separator menu item in menus.")),Tie=j("quickInput.background",yl,b("pickerBackground","Quick picker background color. The quick picker widget is the container for pickers like the command palette.")),wFe=j("quickInput.foreground",SF,b("pickerForeground","Quick picker foreground color. The quick picker widget is the container for pickers like the command palette.")),CFe=j("quickInputTitle.background",{dark:new fe(new Jt(255,255,255,.105)),light:new fe(new Jt(0,0,0,.06)),hcDark:"#000000",hcLight:fe.white},b("pickerTitleBackground","Quick picker title background color. The quick picker widget is the container for pickers like the command palette.")),Cfe=j("pickerGroup.foreground",{dark:"#3794FF",light:"#0066BF",hcDark:fe.white,hcLight:"#0F4A85"},b("pickerGroupForeground","Quick picker color for grouping labels.")),yFe=j("pickerGroup.border",{dark:"#3F3F46",light:"#CCCEDB",hcDark:fe.white,hcLight:"#0F4A85"},b("pickerGroupBorder","Quick picker color for grouping borders.")),Nie=j("quickInput.list.focusBackground",null,"",void 0,b("quickInput.list.focusBackground deprecation","Please use quickInputList.focusBackground instead")),pI=j("quickInputList.focusForeground",gI,b("quickInput.listFocusForeground","Quick picker foreground color for the focused item.")),pK=j("quickInputList.focusIconForeground",_fe,b("quickInput.listFocusIconForeground","Quick picker icon foreground color for the focused item.")),mI=j("quickInputList.focusBackground",{dark:uI(Nie,gw),light:uI(Nie,gw),hcDark:null,hcLight:null},b("quickInput.listFocusBackground","Quick picker background color for the focused item."));j("search.resultsInfoForeground",{light:Ot,dark:Tt(Ot,.65),hcDark:Ot,hcLight:Ot},b("search.resultsInfoForeground","Color of the text in the search viewlet's completion message."));j("searchEditor.findMatchBackground",{light:Tt(Gf,.66),dark:Tt(Gf,.66),hcDark:Gf,hcLight:Gf},b("searchEditor.queryMatch","Color of the Search Editor query matches."));j("searchEditor.findMatchBorder",{light:Tt(jp,.66),dark:Tt(jp,.66),hcDark:jp,hcLight:jp},b("searchEditor.editorFindMatchBorder","Border color of the Search Editor query matches."));var SFe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Rie=function(s,e){return function(t,i){e(t,i,s)}};const Kh=Ht("hoverService");let v1=class extends te{get delay(){return this.isInstantlyHovering()?0:this._delay}constructor(e,t,i={},n,r){super(),this.placement=e,this.instantHover=t,this.overrideOptions=i,this.configurationService=n,this.hoverService=r,this.lastHoverHideTime=0,this.timeLimit=200,this.hoverDisposables=this._register(new ce),this._delay=this.configurationService.getValue("workbench.hover.delay"),this._register(this.configurationService.onDidChangeConfiguration(o=>{o.affectsConfiguration("workbench.hover.delay")&&(this._delay=this.configurationService.getValue("workbench.hover.delay"))}))}showHover(e,t){const i=typeof this.overrideOptions=="function"?this.overrideOptions(e,t):this.overrideOptions;this.hoverDisposables.clear();const n=Ls(e.target)?[e.target]:e.target.targetElements;for(const o of n)this.hoverDisposables.add(yn(o,"keydown",a=>{a.equals(9)&&this.hoverService.hideHover()}));const r=Ls(e.content)?void 0:e.content.toString();return this.hoverService.showHover({...e,...i,persistence:{hideOnKeyDown:!0,...i.persistence},id:r,appearance:{...e.appearance,compact:!0,skipFadeInAnimation:this.isInstantlyHovering(),...i.appearance}},t)}isInstantlyHovering(){return this.instantHover&&Date.now()-this.lastHoverHideTime<this.timeLimit}onDidHideHover(){this.hoverDisposables.clear(),this.instantHover&&(this.lastHoverHideTime=Date.now())}};v1=SFe([Rie(3,At),Rie(4,Kh)],v1);const Fg=Ht("contextViewService"),Ba=Ht("contextMenuService"),pi=Ht("keybindingService");class pS{constructor(){this._hooks=new ce,this._pointerMoveCallback=null,this._onStopCallback=null}dispose(){this.stopMonitoring(!1),this._hooks.dispose()}stopMonitoring(e,t){if(!this.isMonitoring())return;this._hooks.clear(),this._pointerMoveCallback=null;const i=this._onStopCallback;this._onStopCallback=null,e&&i&&i(t)}isMonitoring(){return!!this._pointerMoveCallback}startMonitoring(e,t,i,n,r){this.isMonitoring()&&this.stopMonitoring(!1),this._pointerMoveCallback=n,this._onStopCallback=r;let o=e;try{e.setPointerCapture(t),this._hooks.add(Ye(()=>{try{e.releasePointerCapture(t)}catch{}}))}catch{o=nt(e)}this._hooks.add(oe(o,Le.POINTER_MOVE,a=>{if(a.buttons!==i){this.stopMonitoring(!0);return}a.preventDefault(),this._pointerMoveCallback(a)})),this._hooks.add(oe(o,Le.POINTER_UP,a=>this.stopMonitoring(!0)))}}function $n(s,e,t){let i=null,n=null;if(typeof t.value=="function"?(i="value",n=t.value,n.length!==0&&console.warn("Memoize should only be used in functions with zero parameters")):typeof t.get=="function"&&(i="get",n=t.get),!n)throw new Error("not supported");const r=`$memoize$${e}`;t[i]=function(...o){return this.hasOwnProperty(r)||Object.defineProperty(this,r,{configurable:!1,enumerable:!1,writable:!1,value:n.apply(this,o)}),this[r]}}var xFe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Vi;(function(s){s.Tap="-monaco-gesturetap",s.Change="-monaco-gesturechange",s.Start="-monaco-gesturestart",s.End="-monaco-gesturesend",s.Contextmenu="-monaco-gesturecontextmenu"})(Vi||(Vi={}));const rr=class rr extends te{constructor(){super(),this.dispatched=!1,this.targets=new _o,this.ignoreTargets=new _o,this.activeTouches={},this.handle=null,this._lastSetTapCountTime=0,this._register(De.runAndSubscribe(nF,({window:e,disposables:t})=>{t.add(oe(e.document,"touchstart",i=>this.onTouchStart(i),{passive:!1})),t.add(oe(e.document,"touchend",i=>this.onTouchEnd(e,i))),t.add(oe(e.document,"touchmove",i=>this.onTouchMove(i),{passive:!1}))},{window:Ri,disposables:this._store}))}static addTarget(e){if(!rr.isTouchDevice())return te.None;rr.INSTANCE||(rr.INSTANCE=new rr);const t=rr.INSTANCE.targets.push(e);return Ye(t)}static ignoreTarget(e){if(!rr.isTouchDevice())return te.None;rr.INSTANCE||(rr.INSTANCE=new rr);const t=rr.INSTANCE.ignoreTargets.push(e);return Ye(t)}static isTouchDevice(){return"ontouchstart"in Ri||navigator.maxTouchPoints>0}dispose(){this.handle&&(this.handle.dispose(),this.handle=null),super.dispose()}onTouchStart(e){const t=Date.now();this.handle&&(this.handle.dispose(),this.handle=null);for(let i=0,n=e.targetTouches.length;i<n;i++){const r=e.targetTouches.item(i);this.activeTouches[r.identifier]={id:r.identifier,initialTarget:r.target,initialTimeStamp:t,initialPageX:r.pageX,initialPageY:r.pageY,rollingTimestamps:[t],rollingPageX:[r.pageX],rollingPageY:[r.pageY]};const o=this.newGestureEvent(Vi.Start,r.target);o.pageX=r.pageX,o.pageY=r.pageY,this.dispatchEvent(o)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}onTouchEnd(e,t){const i=Date.now(),n=Object.keys(this.activeTouches).length;for(let r=0,o=t.changedTouches.length;r<o;r++){const a=t.changedTouches.item(r);if(!this.activeTouches.hasOwnProperty(String(a.identifier))){console.warn("move of an UNKNOWN touch",a);continue}const l=this.activeTouches[a.identifier],c=Date.now()-l.initialTimeStamp;if(c<rr.HOLD_DELAY&&Math.abs(l.initialPageX-Zl(l.rollingPageX))<30&&Math.abs(l.initialPageY-Zl(l.rollingPageY))<30){const d=this.newGestureEvent(Vi.Tap,l.initialTarget);d.pageX=Zl(l.rollingPageX),d.pageY=Zl(l.rollingPageY),this.dispatchEvent(d)}else if(c>=rr.HOLD_DELAY&&Math.abs(l.initialPageX-Zl(l.rollingPageX))<30&&Math.abs(l.initialPageY-Zl(l.rollingPageY))<30){const d=this.newGestureEvent(Vi.Contextmenu,l.initialTarget);d.pageX=Zl(l.rollingPageX),d.pageY=Zl(l.rollingPageY),this.dispatchEvent(d)}else if(n===1){const d=Zl(l.rollingPageX),u=Zl(l.rollingPageY),h=Zl(l.rollingTimestamps)-l.rollingTimestamps[0],g=d-l.rollingPageX[0],p=u-l.rollingPageY[0],_=[...this.targets].filter(v=>l.initialTarget instanceof Node&&v.contains(l.initialTarget));this.inertia(e,_,i,Math.abs(g)/h,g>0?1:-1,d,Math.abs(p)/h,p>0?1:-1,u)}this.dispatchEvent(this.newGestureEvent(Vi.End,l.initialTarget)),delete this.activeTouches[a.identifier]}this.dispatched&&(t.preventDefault(),t.stopPropagation(),this.dispatched=!1)}newGestureEvent(e,t){const i=document.createEvent("CustomEvent");return i.initEvent(e,!1,!0),i.initialTarget=t,i.tapCount=0,i}dispatchEvent(e){if(e.type===Vi.Tap){const t=new Date().getTime();let i=0;t-this._lastSetTapCountTime>rr.CLEAR_TAP_COUNT_TIME?i=1:i=2,this._lastSetTapCountTime=t,e.tapCount=i}else(e.type===Vi.Change||e.type===Vi.Contextmenu)&&(this._lastSetTapCountTime=0);if(e.initialTarget instanceof Node){for(const i of this.ignoreTargets)if(i.contains(e.initialTarget))return;const t=[];for(const i of this.targets)if(i.contains(e.initialTarget)){let n=0,r=e.initialTarget;for(;r&&r!==i;)n++,r=r.parentElement;t.push([n,i])}t.sort((i,n)=>i[0]-n[0]);for(const[i,n]of t)n.dispatchEvent(e),this.dispatched=!0}}inertia(e,t,i,n,r,o,a,l,c){this.handle=Fa(e,()=>{const d=Date.now(),u=d-i;let h=0,g=0,p=!0;n+=rr.SCROLL_FRICTION*u,a+=rr.SCROLL_FRICTION*u,n>0&&(p=!1,h=r*n*u),a>0&&(p=!1,g=l*a*u);const _=this.newGestureEvent(Vi.Change);_.translationX=h,_.translationY=g,t.forEach(v=>v.dispatchEvent(_)),p||this.inertia(e,t,d,n,r,o+h,a,l,c+g)})}onTouchMove(e){const t=Date.now();for(let i=0,n=e.changedTouches.length;i<n;i++){const r=e.changedTouches.item(i);if(!this.activeTouches.hasOwnProperty(String(r.identifier))){console.warn("end of an UNKNOWN touch",r);continue}const o=this.activeTouches[r.identifier],a=this.newGestureEvent(Vi.Change,o.initialTarget);a.translationX=r.pageX-Zl(o.rollingPageX),a.translationY=r.pageY-Zl(o.rollingPageY),a.pageX=r.pageX,a.pageY=r.pageY,this.dispatchEvent(a),o.rollingPageX.length>3&&(o.rollingPageX.shift(),o.rollingPageY.shift(),o.rollingTimestamps.shift()),o.rollingPageX.push(r.pageX),o.rollingPageY.push(r.pageY),o.rollingTimestamps.push(t)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}};rr.SCROLL_FRICTION=-.005,rr.HOLD_DELAY=700,rr.CLEAR_TAP_COUNT_TIME=400;let Er=rr;xFe([$n],Er,"isTouchDevice",null);let Vl=class extends te{onclick(e,t){this._register(oe(e,Le.CLICK,i=>t(new Xc(nt(e),i))))}onmousedown(e,t){this._register(oe(e,Le.MOUSE_DOWN,i=>t(new Xc(nt(e),i))))}onmouseover(e,t){this._register(oe(e,Le.MOUSE_OVER,i=>t(new Xc(nt(e),i))))}onmouseleave(e,t){this._register(oe(e,Le.MOUSE_LEAVE,i=>t(new Xc(nt(e),i))))}onkeydown(e,t){this._register(oe(e,Le.KEY_DOWN,i=>t(new Mi(i))))}onkeyup(e,t){this._register(oe(e,Le.KEY_UP,i=>t(new Mi(i))))}oninput(e,t){this._register(oe(e,Le.INPUT,t))}onblur(e,t){this._register(oe(e,Le.BLUR,t))}onfocus(e,t){this._register(oe(e,Le.FOCUS,t))}ignoreGesture(e){return Er.ignoreTarget(e)}};const w1=11;class LFe extends Vl{constructor(e){super(),this._onActivate=e.onActivate,this.bgDomNode=document.createElement("div"),this.bgDomNode.className="arrow-background",this.bgDomNode.style.position="absolute",this.bgDomNode.style.width=e.bgWidth+"px",this.bgDomNode.style.height=e.bgHeight+"px",typeof e.top<"u"&&(this.bgDomNode.style.top="0px"),typeof e.left<"u"&&(this.bgDomNode.style.left="0px"),typeof e.bottom<"u"&&(this.bgDomNode.style.bottom="0px"),typeof e.right<"u"&&(this.bgDomNode.style.right="0px"),this.domNode=document.createElement("div"),this.domNode.className=e.className,this.domNode.classList.add(...at.asClassNameArray(e.icon)),this.domNode.style.position="absolute",this.domNode.style.width=w1+"px",this.domNode.style.height=w1+"px",typeof e.top<"u"&&(this.domNode.style.top=e.top+"px"),typeof e.left<"u"&&(this.domNode.style.left=e.left+"px"),typeof e.bottom<"u"&&(this.domNode.style.bottom=e.bottom+"px"),typeof e.right<"u"&&(this.domNode.style.right=e.right+"px"),this._pointerMoveMonitor=this._register(new pS),this._register(yn(this.bgDomNode,Le.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._register(yn(this.domNode,Le.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._pointerdownRepeatTimer=this._register(new Bq),this._pointerdownScheduleRepeatTimer=this._register(new gd)}_arrowPointerDown(e){if(!e.target||!(e.target instanceof Element))return;const t=()=>{this._pointerdownRepeatTimer.cancelAndSet(()=>this._onActivate(),1e3/24,nt(e))};this._onActivate(),this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancelAndSet(t,200),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,i=>{},()=>{this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancel()}),e.preventDefault()}}class kFe extends te{constructor(e,t,i){super(),this._visibility=e,this._visibleClassName=t,this._invisibleClassName=i,this._domNode=null,this._isVisible=!1,this._isNeeded=!1,this._rawShouldBeVisible=!1,this._shouldBeVisible=!1,this._revealTimer=this._register(new gd)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this._updateShouldBeVisible())}setShouldBeVisible(e){this._rawShouldBeVisible=e,this._updateShouldBeVisible()}_applyVisibilitySetting(){return this._visibility===2?!1:this._visibility===3?!0:this._rawShouldBeVisible}_updateShouldBeVisible(){const e=this._applyVisibilitySetting();this._shouldBeVisible!==e&&(this._shouldBeVisible=e,this.ensureVisibility())}setIsNeeded(e){this._isNeeded!==e&&(this._isNeeded=e,this.ensureVisibility())}setDomNode(e){this._domNode=e,this._domNode.setClassName(this._invisibleClassName),this.setShouldBeVisible(!1)}ensureVisibility(){if(!this._isNeeded){this._hide(!1);return}this._shouldBeVisible?this._reveal():this._hide(!0)}_reveal(){this._isVisible||(this._isVisible=!0,this._revealTimer.setIfNotSet(()=>{var e;(e=this._domNode)==null||e.setClassName(this._visibleClassName)},0))}_hide(e){var t;this._revealTimer.cancel(),this._isVisible&&(this._isVisible=!1,(t=this._domNode)==null||t.setClassName(this._invisibleClassName+(e?" fade":"")))}}const IFe=140;class yfe extends Vl{constructor(e){super(),this._lazyRender=e.lazyRender,this._host=e.host,this._scrollable=e.scrollable,this._scrollByPage=e.scrollByPage,this._scrollbarState=e.scrollbarState,this._visibilityController=this._register(new kFe(e.visibility,"visible scrollbar "+e.extraScrollbarClassName,"invisible scrollbar "+e.extraScrollbarClassName)),this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._pointerMoveMonitor=this._register(new pS),this._shouldRender=!0,this.domNode=gi(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this._visibilityController.setDomNode(this.domNode),this.domNode.setPosition("absolute"),this._register(oe(this.domNode.domNode,Le.POINTER_DOWN,t=>this._domNodePointerDown(t)))}_createArrow(e){const t=this._register(new LFe(e));this.domNode.domNode.appendChild(t.bgDomNode),this.domNode.domNode.appendChild(t.domNode)}_createSlider(e,t,i,n){this.slider=gi(document.createElement("div")),this.slider.setClassName("slider"),this.slider.setPosition("absolute"),this.slider.setTop(e),this.slider.setLeft(t),typeof i=="number"&&this.slider.setWidth(i),typeof n=="number"&&this.slider.setHeight(n),this.slider.setLayerHinting(!0),this.slider.setContain("strict"),this.domNode.domNode.appendChild(this.slider.domNode),this._register(oe(this.slider.domNode,Le.POINTER_DOWN,r=>{r.button===0&&(r.preventDefault(),this._sliderPointerDown(r))})),this.onclick(this.slider.domNode,r=>{r.leftButton&&r.stopPropagation()})}_onElementSize(e){return this._scrollbarState.setVisibleSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollSize(e){return this._scrollbarState.setScrollSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollPosition(e){return this._scrollbarState.setScrollPosition(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}beginReveal(){this._visibilityController.setShouldBeVisible(!0)}beginHide(){this._visibilityController.setShouldBeVisible(!1)}render(){this._shouldRender&&(this._shouldRender=!1,this._renderDomNode(this._scrollbarState.getRectangleLargeSize(),this._scrollbarState.getRectangleSmallSize()),this._updateSlider(this._scrollbarState.getSliderSize(),this._scrollbarState.getArrowSize()+this._scrollbarState.getSliderPosition()))}_domNodePointerDown(e){e.target===this.domNode.domNode&&this._onPointerDown(e)}delegatePointerDown(e){const t=this.domNode.domNode.getClientRects()[0].top,i=t+this._scrollbarState.getSliderPosition(),n=t+this._scrollbarState.getSliderPosition()+this._scrollbarState.getSliderSize(),r=this._sliderPointerPosition(e);i<=r&&r<=n?e.button===0&&(e.preventDefault(),this._sliderPointerDown(e)):this._onPointerDown(e)}_onPointerDown(e){let t,i;if(e.target===this.domNode.domNode&&typeof e.offsetX=="number"&&typeof e.offsetY=="number")t=e.offsetX,i=e.offsetY;else{const r=Pn(this.domNode.domNode);t=e.pageX-r.left,i=e.pageY-r.top}const n=this._pointerDownRelativePosition(t,i);this._setDesiredScrollPositionNow(this._scrollByPage?this._scrollbarState.getDesiredScrollPositionFromOffsetPaged(n):this._scrollbarState.getDesiredScrollPositionFromOffset(n)),e.button===0&&(e.preventDefault(),this._sliderPointerDown(e))}_sliderPointerDown(e){if(!e.target||!(e.target instanceof Element))return;const t=this._sliderPointerPosition(e),i=this._sliderOrthogonalPointerPosition(e),n=this._scrollbarState.clone();this.slider.toggleClassName("active",!0),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,r=>{const o=this._sliderOrthogonalPointerPosition(r),a=Math.abs(o-i);if(gr&&a>IFe){this._setDesiredScrollPositionNow(n.getScrollPosition());return}const c=this._sliderPointerPosition(r)-t;this._setDesiredScrollPositionNow(n.getDesiredScrollPositionFromDelta(c))},()=>{this.slider.toggleClassName("active",!1),this._host.onDragEnd()}),this._host.onDragStart()}_setDesiredScrollPositionNow(e){const t={};this.writeScrollPosition(t,e),this._scrollable.setScrollPositionNow(t)}updateScrollbarSize(e){this._updateScrollbarSize(e),this._scrollbarState.setScrollbarSize(e),this._shouldRender=!0,this._lazyRender||this.render()}isNeeded(){return this._scrollbarState.isNeeded()}}const EFe=20;class C1{constructor(e,t,i,n,r,o){this._scrollbarSize=Math.round(t),this._oppositeScrollbarSize=Math.round(i),this._arrowSize=Math.round(e),this._visibleSize=n,this._scrollSize=r,this._scrollPosition=o,this._computedAvailableSize=0,this._computedIsNeeded=!1,this._computedSliderSize=0,this._computedSliderRatio=0,this._computedSliderPosition=0,this._refreshComputedValues()}clone(){return new C1(this._arrowSize,this._scrollbarSize,this._oppositeScrollbarSize,this._visibleSize,this._scrollSize,this._scrollPosition)}setVisibleSize(e){const t=Math.round(e);return this._visibleSize!==t?(this._visibleSize=t,this._refreshComputedValues(),!0):!1}setScrollSize(e){const t=Math.round(e);return this._scrollSize!==t?(this._scrollSize=t,this._refreshComputedValues(),!0):!1}setScrollPosition(e){const t=Math.round(e);return this._scrollPosition!==t?(this._scrollPosition=t,this._refreshComputedValues(),!0):!1}setScrollbarSize(e){this._scrollbarSize=Math.round(e)}setOppositeScrollbarSize(e){this._oppositeScrollbarSize=Math.round(e)}static _computeValues(e,t,i,n,r){const o=Math.max(0,i-e),a=Math.max(0,o-2*t),l=n>0&&n>i;if(!l)return{computedAvailableSize:Math.round(o),computedIsNeeded:l,computedSliderSize:Math.round(a),computedSliderRatio:0,computedSliderPosition:0};const c=Math.round(Math.max(EFe,Math.floor(i*a/n))),d=(a-c)/(n-i),u=r*d;return{computedAvailableSize:Math.round(o),computedIsNeeded:l,computedSliderSize:Math.round(c),computedSliderRatio:d,computedSliderPosition:Math.round(u)}}_refreshComputedValues(){const e=C1._computeValues(this._oppositeScrollbarSize,this._arrowSize,this._visibleSize,this._scrollSize,this._scrollPosition);this._computedAvailableSize=e.computedAvailableSize,this._computedIsNeeded=e.computedIsNeeded,this._computedSliderSize=e.computedSliderSize,this._computedSliderRatio=e.computedSliderRatio,this._computedSliderPosition=e.computedSliderPosition}getArrowSize(){return this._arrowSize}getScrollPosition(){return this._scrollPosition}getRectangleLargeSize(){return this._computedAvailableSize}getRectangleSmallSize(){return this._scrollbarSize}isNeeded(){return this._computedIsNeeded}getSliderSize(){return this._computedSliderSize}getSliderPosition(){return this._computedSliderPosition}getDesiredScrollPositionFromOffset(e){if(!this._computedIsNeeded)return 0;const t=e-this._arrowSize-this._computedSliderSize/2;return Math.round(t/this._computedSliderRatio)}getDesiredScrollPositionFromOffsetPaged(e){if(!this._computedIsNeeded)return 0;const t=e-this._arrowSize;let i=this._scrollPosition;return t<this._computedSliderPosition?i-=this._visibleSize:i+=this._visibleSize,i}getDesiredScrollPositionFromDelta(e){if(!this._computedIsNeeded)return 0;const t=this._computedSliderPosition+e;return Math.round(t/this._computedSliderRatio)}}class DFe extends yfe{constructor(e,t,i){const n=e.getScrollDimensions(),r=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:i,scrollbarState:new C1(t.horizontalHasArrows?t.arrowSize:0,t.horizontal===2?0:t.horizontalScrollbarSize,t.vertical===2?0:t.verticalScrollbarSize,n.width,n.scrollWidth,r.scrollLeft),visibility:t.horizontal,extraScrollbarClassName:"horizontal",scrollable:e,scrollByPage:t.scrollByPage}),t.horizontalHasArrows){const o=(t.arrowSize-w1)/2,a=(t.horizontalScrollbarSize-w1)/2;this._createArrow({className:"scra",icon:xe.scrollbarButtonLeft,top:a,left:o,bottom:void 0,right:void 0,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new dw(null,1,0))}),this._createArrow({className:"scra",icon:xe.scrollbarButtonRight,top:a,left:void 0,bottom:void 0,right:o,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new dw(null,-1,0))})}this._createSlider(Math.floor((t.horizontalScrollbarSize-t.horizontalSliderSize)/2),0,void 0,t.horizontalSliderSize)}_updateSlider(e,t){this.slider.setWidth(e),this.slider.setLeft(t)}_renderDomNode(e,t){this.domNode.setWidth(e),this.domNode.setHeight(t),this.domNode.setLeft(0),this.domNode.setBottom(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollWidth)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollLeft)||this._shouldRender,this._shouldRender=this._onElementSize(e.width)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return e}_sliderPointerPosition(e){return e.pageX}_sliderOrthogonalPointerPosition(e){return e.pageY}_updateScrollbarSize(e){this.slider.setHeight(e)}writeScrollPosition(e,t){e.scrollLeft=t}updateOptions(e){this.updateScrollbarSize(e.horizontal===2?0:e.horizontalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._visibilityController.setVisibility(e.horizontal),this._scrollByPage=e.scrollByPage}}class TFe extends yfe{constructor(e,t,i){const n=e.getScrollDimensions(),r=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:i,scrollbarState:new C1(t.verticalHasArrows?t.arrowSize:0,t.vertical===2?0:t.verticalScrollbarSize,0,n.height,n.scrollHeight,r.scrollTop),visibility:t.vertical,extraScrollbarClassName:"vertical",scrollable:e,scrollByPage:t.scrollByPage}),t.verticalHasArrows){const o=(t.arrowSize-w1)/2,a=(t.verticalScrollbarSize-w1)/2;this._createArrow({className:"scra",icon:xe.scrollbarButtonUp,top:o,left:a,bottom:void 0,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new dw(null,0,1))}),this._createArrow({className:"scra",icon:xe.scrollbarButtonDown,top:void 0,left:a,bottom:o,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new dw(null,0,-1))})}this._createSlider(0,Math.floor((t.verticalScrollbarSize-t.verticalSliderSize)/2),t.verticalSliderSize,void 0)}_updateSlider(e,t){this.slider.setHeight(e),this.slider.setTop(t)}_renderDomNode(e,t){this.domNode.setWidth(t),this.domNode.setHeight(e),this.domNode.setRight(0),this.domNode.setTop(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollHeight)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollTop)||this._shouldRender,this._shouldRender=this._onElementSize(e.height)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return t}_sliderPointerPosition(e){return e.pageY}_sliderOrthogonalPointerPosition(e){return e.pageX}_updateScrollbarSize(e){this.slider.setWidth(e)}writeScrollPosition(e,t){e.scrollTop=t}updateOptions(e){this.updateScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(0),this._visibilityController.setVisibility(e.vertical),this._scrollByPage=e.scrollByPage}}class dA{constructor(e,t,i,n,r,o,a){this._forceIntegerValues=e,this._scrollStateBrand=void 0,this._forceIntegerValues&&(t=t|0,i=i|0,n=n|0,r=r|0,o=o|0,a=a|0),this.rawScrollLeft=n,this.rawScrollTop=a,t<0&&(t=0),n+t>i&&(n=i-t),n<0&&(n=0),r<0&&(r=0),a+r>o&&(a=o-r),a<0&&(a=0),this.width=t,this.scrollWidth=i,this.scrollLeft=n,this.height=r,this.scrollHeight=o,this.scrollTop=a}equals(e){return this.rawScrollLeft===e.rawScrollLeft&&this.rawScrollTop===e.rawScrollTop&&this.width===e.width&&this.scrollWidth===e.scrollWidth&&this.scrollLeft===e.scrollLeft&&this.height===e.height&&this.scrollHeight===e.scrollHeight&&this.scrollTop===e.scrollTop}withScrollDimensions(e,t){return new dA(this._forceIntegerValues,typeof e.width<"u"?e.width:this.width,typeof e.scrollWidth<"u"?e.scrollWidth:this.scrollWidth,t?this.rawScrollLeft:this.scrollLeft,typeof e.height<"u"?e.height:this.height,typeof e.scrollHeight<"u"?e.scrollHeight:this.scrollHeight,t?this.rawScrollTop:this.scrollTop)}withScrollPosition(e){return new dA(this._forceIntegerValues,this.width,this.scrollWidth,typeof e.scrollLeft<"u"?e.scrollLeft:this.rawScrollLeft,this.height,this.scrollHeight,typeof e.scrollTop<"u"?e.scrollTop:this.rawScrollTop)}createScrollEvent(e,t){const i=this.width!==e.width,n=this.scrollWidth!==e.scrollWidth,r=this.scrollLeft!==e.scrollLeft,o=this.height!==e.height,a=this.scrollHeight!==e.scrollHeight,l=this.scrollTop!==e.scrollTop;return{inSmoothScrolling:t,oldWidth:e.width,oldScrollWidth:e.scrollWidth,oldScrollLeft:e.scrollLeft,width:this.width,scrollWidth:this.scrollWidth,scrollLeft:this.scrollLeft,oldHeight:e.height,oldScrollHeight:e.scrollHeight,oldScrollTop:e.scrollTop,height:this.height,scrollHeight:this.scrollHeight,scrollTop:this.scrollTop,widthChanged:i,scrollWidthChanged:n,scrollLeftChanged:r,heightChanged:o,scrollHeightChanged:a,scrollTopChanged:l}}}class mS extends te{constructor(e){super(),this._scrollableBrand=void 0,this._onScroll=this._register(new Z),this.onScroll=this._onScroll.event,this._smoothScrollDuration=e.smoothScrollDuration,this._scheduleAtNextAnimationFrame=e.scheduleAtNextAnimationFrame,this._state=new dA(e.forceIntegerValues,0,0,0,0,0,0),this._smoothScrolling=null}dispose(){this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),super.dispose()}setSmoothScrollDuration(e){this._smoothScrollDuration=e}validateScrollPosition(e){return this._state.withScrollPosition(e)}getScrollDimensions(){return this._state}setScrollDimensions(e,t){var n;const i=this._state.withScrollDimensions(e,t);this._setState(i,!!this._smoothScrolling),(n=this._smoothScrolling)==null||n.acceptScrollDimensions(this._state)}getFutureScrollPosition(){return this._smoothScrolling?this._smoothScrolling.to:this._state}getCurrentScrollPosition(){return this._state}setScrollPositionNow(e){const t=this._state.withScrollPosition(e);this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),this._setState(t,!1)}setScrollPositionSmooth(e,t){if(this._smoothScrollDuration===0)return this.setScrollPositionNow(e);if(this._smoothScrolling){e={scrollLeft:typeof e.scrollLeft>"u"?this._smoothScrolling.to.scrollLeft:e.scrollLeft,scrollTop:typeof e.scrollTop>"u"?this._smoothScrolling.to.scrollTop:e.scrollTop};const i=this._state.withScrollPosition(e);if(this._smoothScrolling.to.scrollLeft===i.scrollLeft&&this._smoothScrolling.to.scrollTop===i.scrollTop)return;let n;t?n=new _I(this._smoothScrolling.from,i,this._smoothScrolling.startTime,this._smoothScrolling.duration):n=this._smoothScrolling.combine(this._state,i,this._smoothScrollDuration),this._smoothScrolling.dispose(),this._smoothScrolling=n}else{const i=this._state.withScrollPosition(e);this._smoothScrolling=_I.start(this._state,i,this._smoothScrollDuration)}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}hasPendingScrollAnimation(){return!!this._smoothScrolling}_performSmoothScrolling(){if(!this._smoothScrolling)return;const e=this._smoothScrolling.tick(),t=this._state.withScrollPosition(e);if(this._setState(t,!0),!!this._smoothScrolling){if(e.isDone){this._smoothScrolling.dispose(),this._smoothScrolling=null;return}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}}_setState(e,t){const i=this._state;i.equals(e)||(this._state=e,this._onScroll.fire(this._state.createScrollEvent(i,t)))}}class Aie{constructor(e,t,i){this.scrollLeft=e,this.scrollTop=t,this.isDone=i}}function LV(s,e){const t=e-s;return function(i){return s+t*AFe(i)}}function NFe(s,e,t){return function(i){return i<t?s(i/t):e((i-t)/(1-t))}}class _I{constructor(e,t,i,n){this.from=e,this.to=t,this.duration=n,this.startTime=i,this.animationFrameDisposable=null,this._initAnimations()}_initAnimations(){this.scrollLeft=this._initAnimation(this.from.scrollLeft,this.to.scrollLeft,this.to.width),this.scrollTop=this._initAnimation(this.from.scrollTop,this.to.scrollTop,this.to.height)}_initAnimation(e,t,i){if(Math.abs(e-t)>2.5*i){let r,o;return e<t?(r=e+.75*i,o=t-.75*i):(r=e-.75*i,o=t+.75*i),NFe(LV(e,r),LV(o,t),.33)}return LV(e,t)}dispose(){this.animationFrameDisposable!==null&&(this.animationFrameDisposable.dispose(),this.animationFrameDisposable=null)}acceptScrollDimensions(e){this.to=e.withScrollPosition(this.to),this._initAnimations()}tick(){return this._tick(Date.now())}_tick(e){const t=(e-this.startTime)/this.duration;if(t<1){const i=this.scrollLeft(t),n=this.scrollTop(t);return new Aie(i,n,!1)}return new Aie(this.to.scrollLeft,this.to.scrollTop,!0)}combine(e,t,i){return _I.start(e,t,i)}static start(e,t,i){i=i+10;const n=Date.now()-10;return new _I(e,t,n,i)}}function RFe(s){return Math.pow(s,3)}function AFe(s){return 1-RFe(1-s)}const PFe=500,Pie=50;class MFe{constructor(e,t,i){this.timestamp=e,this.deltaX=t,this.deltaY=i,this.score=0}}const zM=class zM{constructor(){this._capacity=5,this._memory=[],this._front=-1,this._rear=-1}isPhysicalMouseWheel(){if(this._front===-1&&this._rear===-1)return!1;let e=1,t=0,i=1,n=this._rear;do{const r=n===this._front?e:Math.pow(2,-i);if(e-=r,t+=this._memory[n].score*r,n===this._front)break;n=(this._capacity+n-1)%this._capacity,i++}while(!0);return t<=.5}acceptStandardWheelEvent(e){if(UE){const t=nt(e.browserEvent),i=ZRe(t);this.accept(Date.now(),e.deltaX*i,e.deltaY*i)}else this.accept(Date.now(),e.deltaX,e.deltaY)}accept(e,t,i){let n=null;const r=new MFe(e,t,i);this._front===-1&&this._rear===-1?(this._memory[0]=r,this._front=0,this._rear=0):(n=this._memory[this._rear],this._rear=(this._rear+1)%this._capacity,this._rear===this._front&&(this._front=(this._front+1)%this._capacity),this._memory[this._rear]=r),r.score=this._computeScore(r,n)}_computeScore(e,t){if(Math.abs(e.deltaX)>0&&Math.abs(e.deltaY)>0)return 1;let i=.5;if((!this._isAlmostInt(e.deltaX)||!this._isAlmostInt(e.deltaY))&&(i+=.25),t){const n=Math.abs(e.deltaX),r=Math.abs(e.deltaY),o=Math.abs(t.deltaX),a=Math.abs(t.deltaY),l=Math.max(Math.min(n,o),1),c=Math.max(Math.min(r,a),1),d=Math.max(n,o),u=Math.max(r,a);d%l===0&&u%c===0&&(i-=.5)}return Math.min(Math.max(i,0),1)}_isAlmostInt(e){return Math.abs(Math.round(e)-e)<.01}};zM.INSTANCE=new zM;let uA=zM;class mK extends Vl{get options(){return this._options}constructor(e,t,i){super(),this._onScroll=this._register(new Z),this.onScroll=this._onScroll.event,this._onWillScroll=this._register(new Z),e.style.overflow="hidden",this._options=OFe(t),this._scrollable=i,this._register(this._scrollable.onScroll(r=>{this._onWillScroll.fire(r),this._onDidScroll(r),this._onScroll.fire(r)}));const n={onMouseWheel:r=>this._onMouseWheel(r),onDragStart:()=>this._onDragStart(),onDragEnd:()=>this._onDragEnd()};this._verticalScrollbar=this._register(new TFe(this._scrollable,this._options,n)),this._horizontalScrollbar=this._register(new DFe(this._scrollable,this._options,n)),this._domNode=document.createElement("div"),this._domNode.className="monaco-scrollable-element "+this._options.className,this._domNode.setAttribute("role","presentation"),this._domNode.style.position="relative",this._domNode.style.overflow="hidden",this._domNode.appendChild(e),this._domNode.appendChild(this._horizontalScrollbar.domNode.domNode),this._domNode.appendChild(this._verticalScrollbar.domNode.domNode),this._options.useShadows?(this._leftShadowDomNode=gi(document.createElement("div")),this._leftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._leftShadowDomNode.domNode),this._topShadowDomNode=gi(document.createElement("div")),this._topShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topShadowDomNode.domNode),this._topLeftShadowDomNode=gi(document.createElement("div")),this._topLeftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topLeftShadowDomNode.domNode)):(this._leftShadowDomNode=null,this._topShadowDomNode=null,this._topLeftShadowDomNode=null),this._listenOnDomNode=this._options.listenOnDomNode||this._domNode,this._mouseWheelToDispose=[],this._setListeningToMouseWheel(this._options.handleMouseWheel),this.onmouseover(this._listenOnDomNode,r=>this._onMouseOver(r)),this.onmouseleave(this._listenOnDomNode,r=>this._onMouseLeave(r)),this._hideTimeout=this._register(new gd),this._isDragging=!1,this._mouseIsOver=!1,this._shouldRender=!0,this._revealOnScroll=!0}dispose(){this._mouseWheelToDispose=Ni(this._mouseWheelToDispose),super.dispose()}getDomNode(){return this._domNode}getOverviewRulerLayoutInfo(){return{parent:this._domNode,insertBefore:this._verticalScrollbar.domNode.domNode}}delegateVerticalScrollbarPointerDown(e){this._verticalScrollbar.delegatePointerDown(e)}getScrollDimensions(){return this._scrollable.getScrollDimensions()}setScrollDimensions(e){this._scrollable.setScrollDimensions(e,!1)}updateClassName(e){this._options.className=e,Wt&&(this._options.className+=" mac"),this._domNode.className="monaco-scrollable-element "+this._options.className}updateOptions(e){typeof e.handleMouseWheel<"u"&&(this._options.handleMouseWheel=e.handleMouseWheel,this._setListeningToMouseWheel(this._options.handleMouseWheel)),typeof e.mouseWheelScrollSensitivity<"u"&&(this._options.mouseWheelScrollSensitivity=e.mouseWheelScrollSensitivity),typeof e.fastScrollSensitivity<"u"&&(this._options.fastScrollSensitivity=e.fastScrollSensitivity),typeof e.scrollPredominantAxis<"u"&&(this._options.scrollPredominantAxis=e.scrollPredominantAxis),typeof e.horizontal<"u"&&(this._options.horizontal=e.horizontal),typeof e.vertical<"u"&&(this._options.vertical=e.vertical),typeof e.horizontalScrollbarSize<"u"&&(this._options.horizontalScrollbarSize=e.horizontalScrollbarSize),typeof e.verticalScrollbarSize<"u"&&(this._options.verticalScrollbarSize=e.verticalScrollbarSize),typeof e.scrollByPage<"u"&&(this._options.scrollByPage=e.scrollByPage),this._horizontalScrollbar.updateOptions(this._options),this._verticalScrollbar.updateOptions(this._options),this._options.lazyRender||this._render()}delegateScrollFromMouseWheelEvent(e){this._onMouseWheel(new dw(e))}_setListeningToMouseWheel(e){if(this._mouseWheelToDispose.length>0!==e&&(this._mouseWheelToDispose=Ni(this._mouseWheelToDispose),e)){const i=n=>{this._onMouseWheel(new dw(n))};this._mouseWheelToDispose.push(oe(this._listenOnDomNode,Le.MOUSE_WHEEL,i,{passive:!1}))}}_onMouseWheel(e){var r;if((r=e.browserEvent)!=null&&r.defaultPrevented)return;const t=uA.INSTANCE;t.acceptStandardWheelEvent(e);let i=!1;if(e.deltaY||e.deltaX){let o=e.deltaY*this._options.mouseWheelScrollSensitivity,a=e.deltaX*this._options.mouseWheelScrollSensitivity;this._options.scrollPredominantAxis&&(this._options.scrollYToX&&a+o===0?a=o=0:Math.abs(o)>=Math.abs(a)?a=0:o=0),this._options.flipAxes&&([o,a]=[a,o]);const l=!Wt&&e.browserEvent&&e.browserEvent.shiftKey;(this._options.scrollYToX||l)&&!a&&(a=o,o=0),e.browserEvent&&e.browserEvent.altKey&&(a=a*this._options.fastScrollSensitivity,o=o*this._options.fastScrollSensitivity);const c=this._scrollable.getFutureScrollPosition();let d={};if(o){const u=Pie*o,h=c.scrollTop-(u<0?Math.floor(u):Math.ceil(u));this._verticalScrollbar.writeScrollPosition(d,h)}if(a){const u=Pie*a,h=c.scrollLeft-(u<0?Math.floor(u):Math.ceil(u));this._horizontalScrollbar.writeScrollPosition(d,h)}d=this._scrollable.validateScrollPosition(d),(c.scrollLeft!==d.scrollLeft||c.scrollTop!==d.scrollTop)&&(this._options.mouseWheelSmoothScroll&&t.isPhysicalMouseWheel()?this._scrollable.setScrollPositionSmooth(d):this._scrollable.setScrollPositionNow(d),i=!0)}let n=i;!n&&this._options.alwaysConsumeMouseWheel&&(n=!0),!n&&this._options.consumeMouseWheelIfScrollbarIsNeeded&&(this._verticalScrollbar.isNeeded()||this._horizontalScrollbar.isNeeded())&&(n=!0),n&&(e.preventDefault(),e.stopPropagation())}_onDidScroll(e){this._shouldRender=this._horizontalScrollbar.onDidScroll(e)||this._shouldRender,this._shouldRender=this._verticalScrollbar.onDidScroll(e)||this._shouldRender,this._options.useShadows&&(this._shouldRender=!0),this._revealOnScroll&&this._reveal(),this._options.lazyRender||this._render()}renderNow(){if(!this._options.lazyRender)throw new Error("Please use `lazyRender` together with `renderNow`!");this._render()}_render(){if(this._shouldRender&&(this._shouldRender=!1,this._horizontalScrollbar.render(),this._verticalScrollbar.render(),this._options.useShadows)){const e=this._scrollable.getCurrentScrollPosition(),t=e.scrollTop>0,i=e.scrollLeft>0,n=i?" left":"",r=t?" top":"",o=i||t?" top-left-corner":"";this._leftShadowDomNode.setClassName(`shadow${n}`),this._topShadowDomNode.setClassName(`shadow${r}`),this._topLeftShadowDomNode.setClassName(`shadow${o}${r}${n}`)}}_onDragStart(){this._isDragging=!0,this._reveal()}_onDragEnd(){this._isDragging=!1,this._hide()}_onMouseLeave(e){this._mouseIsOver=!1,this._hide()}_onMouseOver(e){this._mouseIsOver=!0,this._reveal()}_reveal(){this._verticalScrollbar.beginReveal(),this._horizontalScrollbar.beginReveal(),this._scheduleHide()}_hide(){!this._mouseIsOver&&!this._isDragging&&(this._verticalScrollbar.beginHide(),this._horizontalScrollbar.beginHide())}_scheduleHide(){!this._mouseIsOver&&!this._isDragging&&this._hideTimeout.cancelAndSet(()=>this._hide(),PFe)}}class Sfe extends mK{constructor(e,t){t=t||{},t.mouseWheelSmoothScroll=!1;const i=new mS({forceIntegerValues:!0,smoothScrollDuration:0,scheduleAtNextAnimationFrame:n=>Fa(nt(e),n)});super(e,t,i),this._register(i)}setScrollPosition(e){this._scrollable.setScrollPositionNow(e)}}class DF extends mK{constructor(e,t,i){super(e,t,i)}setScrollPosition(e){e.reuseAnimation?this._scrollable.setScrollPositionSmooth(e,e.reuseAnimation):this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}}class QE extends mK{constructor(e,t){t=t||{},t.mouseWheelSmoothScroll=!1;const i=new mS({forceIntegerValues:!1,smoothScrollDuration:0,scheduleAtNextAnimationFrame:n=>Fa(nt(e),n)});super(e,t,i),this._register(i),this._element=e,this._register(this.onScroll(n=>{n.scrollTopChanged&&(this._element.scrollTop=n.scrollTop),n.scrollLeftChanged&&(this._element.scrollLeft=n.scrollLeft)})),this.scanDomNode()}setScrollPosition(e){this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}scanDomNode(){this.setScrollDimensions({width:this._element.clientWidth,scrollWidth:this._element.scrollWidth,height:this._element.clientHeight,scrollHeight:this._element.scrollHeight}),this.setScrollPosition({scrollLeft:this._element.scrollLeft,scrollTop:this._element.scrollTop})}}function OFe(s){const e={lazyRender:typeof s.lazyRender<"u"?s.lazyRender:!1,className:typeof s.className<"u"?s.className:"",useShadows:typeof s.useShadows<"u"?s.useShadows:!0,handleMouseWheel:typeof s.handleMouseWheel<"u"?s.handleMouseWheel:!0,flipAxes:typeof s.flipAxes<"u"?s.flipAxes:!1,consumeMouseWheelIfScrollbarIsNeeded:typeof s.consumeMouseWheelIfScrollbarIsNeeded<"u"?s.consumeMouseWheelIfScrollbarIsNeeded:!1,alwaysConsumeMouseWheel:typeof s.alwaysConsumeMouseWheel<"u"?s.alwaysConsumeMouseWheel:!1,scrollYToX:typeof s.scrollYToX<"u"?s.scrollYToX:!1,mouseWheelScrollSensitivity:typeof s.mouseWheelScrollSensitivity<"u"?s.mouseWheelScrollSensitivity:1,fastScrollSensitivity:typeof s.fastScrollSensitivity<"u"?s.fastScrollSensitivity:5,scrollPredominantAxis:typeof s.scrollPredominantAxis<"u"?s.scrollPredominantAxis:!0,mouseWheelSmoothScroll:typeof s.mouseWheelSmoothScroll<"u"?s.mouseWheelSmoothScroll:!0,arrowSize:typeof s.arrowSize<"u"?s.arrowSize:11,listenOnDomNode:typeof s.listenOnDomNode<"u"?s.listenOnDomNode:null,horizontal:typeof s.horizontal<"u"?s.horizontal:1,horizontalScrollbarSize:typeof s.horizontalScrollbarSize<"u"?s.horizontalScrollbarSize:10,horizontalSliderSize:typeof s.horizontalSliderSize<"u"?s.horizontalSliderSize:0,horizontalHasArrows:typeof s.horizontalHasArrows<"u"?s.horizontalHasArrows:!1,vertical:typeof s.vertical<"u"?s.vertical:1,verticalScrollbarSize:typeof s.verticalScrollbarSize<"u"?s.verticalScrollbarSize:10,verticalHasArrows:typeof s.verticalHasArrows<"u"?s.verticalHasArrows:!1,verticalSliderSize:typeof s.verticalSliderSize<"u"?s.verticalSliderSize:0,scrollByPage:typeof s.scrollByPage<"u"?s.scrollByPage:!1};return e.horizontalSliderSize=typeof s.horizontalSliderSize<"u"?s.horizontalSliderSize:e.horizontalScrollbarSize,e.verticalSliderSize=typeof s.verticalSliderSize<"u"?s.verticalSliderSize:e.verticalScrollbarSize,Wt&&(e.className+=" mac"),e}const lN=ke;let _K=class extends te{constructor(){super(),this.containerDomNode=document.createElement("div"),this.containerDomNode.className="monaco-hover",this.containerDomNode.tabIndex=0,this.containerDomNode.setAttribute("role","tooltip"),this.contentsDomNode=document.createElement("div"),this.contentsDomNode.className="monaco-hover-content",this.scrollbar=this._register(new QE(this.contentsDomNode,{consumeMouseWheelIfScrollbarIsNeeded:!0})),this.containerDomNode.appendChild(this.scrollbar.getDomNode())}onContentsChanged(){this.scrollbar.scanDomNode()}};class TF extends te{static render(e,t,i){return new TF(e,t,i)}constructor(e,t,i){super(),this.actionLabel=t.label,this.actionKeybindingLabel=i,this.actionContainer=me(e,lN("div.action-container")),this.actionContainer.setAttribute("tabindex","0"),this.action=me(this.actionContainer,lN("a.action")),this.action.setAttribute("role","button"),t.iconClass&&me(this.action,lN(`span.icon.${t.iconClass}`));const n=me(this.action,lN("span"));n.textContent=i?`${t.label} (${i})`:t.label,this._store.add(new Lfe(this.actionContainer,t.run)),this._store.add(new kfe(this.actionContainer,t.run,[3,10])),this.setEnabled(!0)}setEnabled(e){e?(this.actionContainer.classList.remove("disabled"),this.actionContainer.removeAttribute("aria-disabled")):(this.actionContainer.classList.add("disabled"),this.actionContainer.setAttribute("aria-disabled","true"))}}function xfe(s,e){return s&&e?b("acessibleViewHint","Inspect this in the accessible view with {0}.",e):s?b("acessibleViewHintNoKbOpen","Inspect this in the accessible view via the command Open Accessible View which is currently not triggerable via keybinding."):""}class Lfe extends te{constructor(e,t){super(),this._register(oe(e,Le.CLICK,i=>{i.stopPropagation(),i.preventDefault(),t(e)}))}}class kfe extends te{constructor(e,t,i){super(),this._register(oe(e,Le.KEY_DOWN,n=>{const r=new Mi(n);i.some(o=>r.equals(o))&&(n.stopPropagation(),n.preventDefault(),t(e))}))}}const la=Ht("openerService");function FFe(s){let e;const t=/^L?(\d+)(?:,(\d+))?(-L?(\d+)(?:,(\d+))?)?/.exec(s.fragment);return t&&(e={startLineNumber:parseInt(t[1]),startColumn:t[2]?parseInt(t[2]):1,endLineNumber:t[4]?parseInt(t[4]):void 0,endColumn:t[4]?t[5]?parseInt(t[5]):1:void 0},s=s.with({fragment:""})),{selection:e,uri:s}}class Ut{get event(){return this.emitter.event}constructor(e,t,i){const n=r=>this.emitter.fire(r);this.emitter=new Z({onWillAddFirstListener:()=>e.addEventListener(t,n,i),onDidRemoveLastListener:()=>e.removeEventListener(t,n,i)})}dispose(){this.emitter.dispose()}}function VFe(s,e={}){const t=bK(e);return t.textContent=s,t}function BFe(s,e={}){const t=bK(e);return Ife(t,HFe(s,!!e.renderCodeSegments),e.actionHandler,e.renderCodeSegments),t}function bK(s){const e=s.inline?"span":"div",t=document.createElement(e);return s.className&&(t.className=s.className),t}class WFe{constructor(e){this.source=e,this.index=0}eos(){return this.index>=this.source.length}next(){const e=this.peek();return this.advance(),e}peek(){return this.source[this.index]}advance(){this.index++}}function Ife(s,e,t,i){let n;if(e.type===2)n=document.createTextNode(e.content||"");else if(e.type===3)n=document.createElement("b");else if(e.type===4)n=document.createElement("i");else if(e.type===7&&i)n=document.createElement("code");else if(e.type===5&&t){const r=document.createElement("a");t.disposables.add(yn(r,"click",o=>{t.callback(String(e.index),o)})),n=r}else e.type===8?n=document.createElement("br"):e.type===1&&(n=s);n&&s!==n&&s.appendChild(n),n&&Array.isArray(e.children)&&e.children.forEach(r=>{Ife(n,r,t,i)})}function HFe(s,e){const t={type:1,children:[]};let i=0,n=t;const r=[],o=new WFe(s);for(;!o.eos();){let a=o.next();const l=a==="\\"&&M6(o.peek(),e)!==0;if(l&&(a=o.next()),!l&&zFe(a,e)&&a===o.peek()){o.advance(),n.type===2&&(n=r.pop());const c=M6(a,e);if(n.type===c||n.type===5&&c===6)n=r.pop();else{const d={type:c,children:[]};c===5&&(d.index=i,i++),n.children.push(d),r.push(n),n=d}}else if(a===`
`)n.type===2&&(n=r.pop()),n.children.push({type:8});else if(n.type!==2){const c={type:2,content:a};n.children.push(c),r.push(n),n=c}else n.content+=a}return n.type===2&&(n=r.pop()),t}function zFe(s,e){return M6(s,e)!==0}function M6(s,e){switch(s){case"*":return 3;case"_":return 4;case"[":return 5;case"]":return 6;case"`":return e?7:0;default:return 0}}const UFe=new RegExp(`(\\\\)?\\$\\((${at.iconNameExpression}(?:${at.iconModifierExpression})?)\\)`,"g");function dm(s){const e=new Array;let t,i=0,n=0;for(;(t=UFe.exec(s))!==null;){n=t.index||0,i<n&&e.push(s.substring(i,n)),i=(t.index||0)+t[0].length;const[,r,o]=t;e.push(r?`$(${o})`:pw({id:o}))}return i<s.length&&e.push(s.substring(i)),e}function pw(s){const e=ke("span");return e.classList.add(...at.asClassNameArray(s)),e}function jFe(s){const e=$Fe(s);if(e&&e.length>0)return new Uint32Array(e)}let ll=0;const Rp=new Uint32Array(10);function $Fe(s){if(ll=0,Ou(s,kV,4352),ll>0||(Ou(s,IV,4449),ll>0)||(Ou(s,EV,4520),ll>0)||(Ou(s,j_,12593),ll))return Rp.subarray(0,ll);if(s>=44032&&s<=55203){const e=s-44032,t=e%588,i=Math.floor(e/588),n=Math.floor(t/28),r=t%28-1;if(i<kV.length?Ou(i,kV,0):4352+i-12593<j_.length&&Ou(4352+i,j_,12593),n<IV.length?Ou(n,IV,0):4449+n-12593<j_.length&&Ou(4449+n-12593,j_,12593),r>=0&&(r<EV.length?Ou(r,EV,0):4520+r-12593<j_.length&&Ou(4520+r-12593,j_,12593)),ll>0)return Rp.subarray(0,ll)}}function Ou(s,e,t){s>=t&&s<t+e.length&&qFe(e[s-t])}function qFe(s){s!==0&&(Rp[ll++]=s&255,s>>8&&(Rp[ll++]=s>>8&255),s>>16&&(Rp[ll++]=s>>16&255))}const kV=new Uint8Array([114,82,115,101,69,102,97,113,81,116,84,100,119,87,99,122,120,118,103]),IV=new Uint16Array([107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]),EV=new Uint16Array([114,82,29810,115,30579,26483,101,102,29286,24934,29030,29798,30822,30310,26470,97,113,29809,116,84,100,119,99,122,120,118,103]),j_=new Uint16Array([114,82,29810,115,30579,26483,101,69,102,29286,24934,29030,29798,30822,30310,26470,97,113,81,29809,116,84,100,119,87,99,122,120,118,103,107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]);function vK(...s){return function(e,t){for(let i=0,n=s.length;i<n;i++){const r=s[i](e,t);if(r)return r}return null}}Efe.bind(void 0,!1);const bI=Efe.bind(void 0,!0);function Efe(s,e,t){if(!t||t.length<e.length)return null;let i;return s?i=Dq(t,e):i=t.indexOf(e)===0,i?e.length>0?[{start:0,end:e.length}]:[]:null}function Dfe(s,e){const t=e.toLowerCase().indexOf(s.toLowerCase());return t===-1?null:[{start:t,end:t+s.length}]}function Tfe(s,e){return O6(s.toLowerCase(),e.toLowerCase(),0,0)}function O6(s,e,t,i){if(t===s.length)return[];if(i===e.length)return null;if(s[t]===e[i]){let n=null;return(n=O6(s,e,t+1,i+1))?yK({start:i,end:i+1},n):null}return O6(s,e,t,i+1)}function wK(s){return 97<=s&&s<=122}function NF(s){return 65<=s&&s<=90}function CK(s){return 48<=s&&s<=57}function Nfe(s){return s===32||s===9||s===10||s===13}const Rfe=new Set;"()[]{}<>`'\"-/;:,.?!".split("").forEach(s=>Rfe.add(s.charCodeAt(0)));function hA(s){return Nfe(s)||Rfe.has(s)}function Mie(s,e){return s===e||hA(s)&&hA(e)}const DV=new Map;function Oie(s){if(DV.has(s))return DV.get(s);let e;const t=jFe(s);return t&&(e=t),DV.set(s,e),e}function Afe(s){return wK(s)||NF(s)||CK(s)}function yK(s,e){return e.length===0?e=[s]:s.end===e[0].start?e[0].start=s.start:e.unshift(s),e}function Pfe(s,e){for(let t=e;t<s.length;t++){const i=s.charCodeAt(t);if(NF(i)||CK(i)||t>0&&!Afe(s.charCodeAt(t-1)))return t}return s.length}function F6(s,e,t,i){if(t===s.length)return[];if(i===e.length)return null;if(s[t]!==e[i].toLowerCase())return null;{let n=null,r=i+1;for(n=F6(s,e,t+1,i+1);!n&&(r=Pfe(e,r))<e.length;)n=F6(s,e,t+1,r),r++;return n===null?null:yK({start:i,end:i+1},n)}}function KFe(s){let e=0,t=0,i=0,n=0,r=0;for(let d=0;d<s.length;d++)r=s.charCodeAt(d),NF(r)&&e++,wK(r)&&t++,Afe(r)&&i++,CK(r)&&n++;const o=e/s.length,a=t/s.length,l=i/s.length,c=n/s.length;return{upperPercent:o,lowerPercent:a,alphaPercent:l,numericPercent:c}}function GFe(s){const{upperPercent:e,lowerPercent:t}=s;return t===0&&e>.6}function QFe(s){const{upperPercent:e,lowerPercent:t,alphaPercent:i,numericPercent:n}=s;return t>.2&&e<.8&&i>.6&&n<.2}function YFe(s){let e=0,t=0,i=0,n=0;for(let r=0;r<s.length;r++)i=s.charCodeAt(r),NF(i)&&e++,wK(i)&&t++,Nfe(i)&&n++;return(e===0||t===0)&&n===0?s.length<=30:e<=5}function Mfe(s,e){if(!e||(e=e.trim(),e.length===0)||!YFe(s))return null;e.length>60&&(e=e.substring(0,60));const t=KFe(e);if(!QFe(t)){if(!GFe(t))return null;e=e.toLowerCase()}let i=null,n=0;for(s=s.toLowerCase();n<e.length&&(i=F6(s,e,0,n))===null;)n=Pfe(e,n+1);return i}function XFe(s,e,t=!1){if(!e||e.length===0)return null;let i=null,n=0;for(s=s.toLowerCase(),e=e.toLowerCase();n<e.length&&(i=V6(s,e,0,n,t),i===null);)n=Ofe(e,n+1);return i}function V6(s,e,t,i,n){let r=0;if(t===s.length)return[];if(i===e.length)return null;if(!Mie(s.charCodeAt(t),e.charCodeAt(i))){const l=Oie(s.charCodeAt(t));if(!l)return null;for(let c=0;c<l.length;c++)if(!Mie(l[c],e.charCodeAt(i+c)))return null;r+=l.length-1}let o=null,a=i+r+1;if(o=V6(s,e,t+1,a,n),!n)for(;!o&&(a=Ofe(e,a))<e.length;)o=V6(s,e,t+1,a,n),a++;if(!o)return null;if(s.charCodeAt(t)!==e.charCodeAt(i)){const l=Oie(s.charCodeAt(t));if(!l)return o;for(let c=0;c<l.length;c++)if(l[c]!==e.charCodeAt(i+c))return o}return yK({start:i,end:i+r+1},o)}function Ofe(s,e){for(let t=e;t<s.length;t++)if(hA(s.charCodeAt(t))||t>0&&hA(s.charCodeAt(t-1)))return t;return s.length}const ZFe=vK(bI,Mfe,Dfe),JFe=vK(bI,Mfe,Tfe),Fie=new $h(1e4);function Vie(s,e,t=!1){if(typeof s!="string"||typeof e!="string")return null;let i=Fie.get(s);i||(i=new RegExp(VRe(s),"i"),Fie.set(s,i));const n=i.exec(e);return n?[{start:n.index,end:n.index+n[0].length}]:t?JFe(s,e):ZFe(s,e)}function e5e(s,e){const t=mw(s,s.toLowerCase(),0,e,e.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0});return t?YE(t):null}function t5e(s,e,t,i,n,r){const o=Math.min(13,s.length);for(;t<o;t++){const a=mw(s,e,t,i,n,r,{firstMatchCanBeWeak:!0,boostFullMatch:!0});if(a)return a}return[0,r]}function YE(s){if(typeof s>"u")return[];const e=[],t=s[1];for(let i=s.length-1;i>1;i--){const n=s[i]+t,r=e[e.length-1];r&&r.end===n?r.end=n+1:e.push({start:n,end:n+1})}return e}const $p=128;function SK(){const s=[],e=[];for(let t=0;t<=$p;t++)e[t]=0;for(let t=0;t<=$p;t++)s.push(e.slice(0));return s}function Ffe(s){const e=[];for(let t=0;t<=s;t++)e[t]=0;return e}const Vfe=Ffe(2*$p),B6=Ffe(2*$p),uf=SK(),$_=SK(),cN=SK();function dN(s,e){if(e<0||e>=s.length)return!1;const t=s.codePointAt(e);switch(t){case 95:case 45:case 46:case 32:case 47:case 92:case 39:case 34:case 58:case 36:case 60:case 62:case 40:case 41:case 91:case 93:case 123:case 125:return!0;case void 0:return!1;default:return!!Aq(t)}}function Bie(s,e){if(e<0||e>=s.length)return!1;switch(s.charCodeAt(e)){case 32:case 9:return!0;default:return!1}}function NR(s,e,t){return e[s]!==t[s]}function i5e(s,e,t,i,n,r,o=!1){for(;e<t&&n<r;)s[e]===i[n]&&(o&&(Vfe[e]=n),e+=1),n+=1;return e===t}var ou;(function(s){s.Default=[-100,0];function e(t){return!t||t.length===2&&t[0]===-100&&t[1]===0}s.isDefault=e})(ou||(ou={}));const oY=class oY{constructor(e,t){this.firstMatchCanBeWeak=e,this.boostFullMatch=t}};oY.default={boostFullMatch:!0,firstMatchCanBeWeak:!1};let vI=oY;function mw(s,e,t,i,n,r,o=vI.default){const a=s.length>$p?$p:s.length,l=i.length>$p?$p:i.length;if(t>=a||r>=l||a-t>l-r||!i5e(e,t,a,n,r,l,!0))return;n5e(a,l,t,r,e,n);let c=1,d=1,u=t,h=r;const g=[!1];for(c=1,u=t;u<a;c++,u++){const y=Vfe[u],x=B6[u],L=u+1<a?B6[u+1]:l;for(d=y-r+1,h=y;h<L;d++,h++){let I=Number.MIN_SAFE_INTEGER,A=!1;h<=x&&(I=s5e(s,e,u,t,i,n,h,l,r,uf[c-1][d-1]===0,g));let D=0;I!==Number.MAX_SAFE_INTEGER&&(A=!0,D=I+$_[c-1][d-1]);const N=h>y,R=N?$_[c][d-1]+(uf[c][d-1]>0?-5:0):0,W=h>y+1&&uf[c][d-1]>0,H=W?$_[c][d-2]+(uf[c][d-2]>0?-5:0):0;if(W&&(!N||H>=R)&&(!A||H>=D))$_[c][d]=H,cN[c][d]=3,uf[c][d]=0;else if(N&&(!A||R>=D))$_[c][d]=R,cN[c][d]=2,uf[c][d]=0;else if(A)$_[c][d]=D,cN[c][d]=1,uf[c][d]=uf[c-1][d-1]+1;else throw new Error("not possible")}}if(!g[0]&&!o.firstMatchCanBeWeak)return;c--,d--;const p=[$_[c][d],r];let _=0,v=0;for(;c>=1;){let y=d;do{const x=cN[c][y];if(x===3)y=y-2;else if(x===2)y=y-1;else break}while(y>=1);_>1&&e[t+c-1]===n[r+d-1]&&!NR(y+r-1,i,n)&&_+1>uf[c][y]&&(y=d),y===d?_++:_=1,v||(v=y),c--,d=y-1,p.push(d)}l-r===a&&o.boostFullMatch&&(p[0]+=2);const C=v-a;return p[0]-=C,p}function n5e(s,e,t,i,n,r){let o=s-1,a=e-1;for(;o>=t&&a>=i;)n[o]===r[a]&&(B6[o]=a,o--),a--}function s5e(s,e,t,i,n,r,o,a,l,c,d){if(e[t]!==r[o])return Number.MIN_SAFE_INTEGER;let u=1,h=!1;return o===t-i?u=s[t]===n[o]?7:5:NR(o,n,r)&&(o===0||!NR(o-1,n,r))?(u=s[t]===n[o]?7:5,h=!0):dN(r,o)&&(o===0||!dN(r,o-1))?u=5:(dN(r,o-1)||Bie(r,o-1))&&(u=5,h=!0),u>1&&t===i&&(d[0]=!0),h||(h=NR(o,n,r)||dN(r,o-1)||Bie(r,o-1)),t===i?o>l&&(u-=h?3:5):c?u+=h?2:0:u+=h?0:1,o+1===a&&(u-=h?3:5),u}function r5e(s,e,t,i,n,r,o){return o5e(s,e,t,i,n,r,!0,o)}function o5e(s,e,t,i,n,r,o,a){let l=mw(s,e,t,i,n,r,a);if(s.length>=3){const c=Math.min(7,s.length-1);for(let d=t+1;d<c;d++){const u=a5e(s,d);if(u){const h=mw(u,u.toLowerCase(),t,i,n,r,a);h&&(h[0]-=3,(!l||h[0]>l[0])&&(l=h))}}}return l}function a5e(s,e){if(e+1>=s.length)return;const t=s[e],i=s[e+1];if(t!==i)return s.slice(0,e)+i+t+s.slice(e+2)}const l5e="$(",xK=new RegExp(`\\$\\(${at.iconNameExpression}(?:${at.iconModifierExpression})?\\)`,"g"),c5e=new RegExp(`(\\\\)?${xK.source}`,"g");function d5e(s){return s.replace(c5e,(e,t)=>t?e:`\\${e}`)}const u5e=new RegExp(`\\\\${xK.source}`,"g");function h5e(s){return s.replace(u5e,e=>`\\${e}`)}const f5e=new RegExp(`(\\s)?(\\\\)?${xK.source}(\\s)?`,"g");function LK(s){return s.indexOf(l5e)===-1?s:s.replace(f5e,(e,t,i,n)=>i?e:t||n||"")}function g5e(s){return s?s.replace(/\$\((.*?)\)/g,(e,t)=>` ${t} `).trim():""}const TV=new RegExp(`\\$\\(${at.iconNameCharacter}+\\)`,"g");function iL(s){TV.lastIndex=0;let e="";const t=[];let i=0;for(;;){const n=TV.lastIndex,r=TV.exec(s),o=s.substring(n,r==null?void 0:r.index);if(o.length>0){e+=o;for(let a=0;a<o.length;a++)t.push(i)}if(!r)break;i+=r[0].length}return{text:e,iconOffsets:t}}function NV(s,e,t=!1){const{text:i,iconOffsets:n}=e;if(!n||n.length===0)return Vie(s,i,t);const r=WE(i," "),o=i.length-r.length,a=Vie(s,r,t);if(a)for(const l of a){const c=n[l.start+o]+o;l.start+=c,l.end+=c}return a}function $u(s){return M2(s,!0)}class p5e{constructor(e){this._ignorePathCasing=e}compare(e,t,i=!1){return e===t?0:eI(this.getComparisonKey(e,i),this.getComparisonKey(t,i))}isEqual(e,t,i=!1){return e===t?!0:!e||!t?!1:this.getComparisonKey(e,i)===this.getComparisonKey(t,i)}getComparisonKey(e,t=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:t?null:void 0}).toString()}isEqualOrParent(e,t,i=!1){if(e.scheme===t.scheme){if(e.scheme===gt.file)return k6($u(e),$u(t),this._ignorePathCasing(e))&&e.query===t.query&&(i||e.fragment===t.fragment);if(Hie(e.authority,t.authority))return k6(e.path,t.path,this._ignorePathCasing(e),"/")&&e.query===t.query&&(i||e.fragment===t.fragment)}return!1}joinPath(e,...t){return Je.joinPath(e,...t)}basenameOrAuthority(e){return Cc(e)||e.authority}basename(e){return Yn.basename(e.path)}extname(e){return Yn.extname(e.path)}dirname(e){if(e.path.length===0)return e;let t;return e.scheme===gt.file?t=Je.file(bue($u(e))).path:(t=Yn.dirname(e.path),e.authority&&t.length&&t.charCodeAt(0)!==47&&(console.error(`dirname("${e.toString})) resulted in a relative path`),t="/")),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return e.scheme===gt.file?t=Je.file(_ue($u(e))).path:t=Yn.normalize(e.path),e.with({path:t})}relativePath(e,t){if(e.scheme!==t.scheme||!Hie(e.authority,t.authority))return;if(e.scheme===gt.file){const r=pRe($u(e),$u(t));return gr?Xhe(r):r}let i=e.path||"/";const n=t.path||"/";if(this._ignorePathCasing(e)){let r=0;for(const o=Math.min(i.length,n.length);r<o&&!(i.charCodeAt(r)!==n.charCodeAt(r)&&i.charAt(r).toLowerCase()!==n.charAt(r).toLowerCase());r++);i=n.substr(0,r)+i.substr(r)}return Yn.relative(i,n)}resolvePath(e,t){if(e.scheme===gt.file){const i=Je.file(gRe($u(e),t));return e.with({authority:i.authority,path:i.path})}return t=bOe(t),e.with({path:Yn.resolve(e.path,t)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,t){return e===t||e!==void 0&&t!==void 0&&SC(e,t)}hasTrailingPathSeparator(e,t=tu){if(e.scheme===gt.file){const i=$u(e);return i.length>fie(i).length&&i[i.length-1]===t}else{const i=e.path;return i.length>1&&i.charCodeAt(i.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,t=tu){return zie(e,t)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,t=tu){let i=!1;if(e.scheme===gt.file){const n=$u(e);i=n!==void 0&&n.length===fie(n).length&&n[n.length-1]===t}else{t="/";const n=e.path;i=n.length===1&&n.charCodeAt(n.length-1)===47}return!i&&!zie(e,t)?e.with({path:e.path+"/"}):e}}const nn=new p5e(()=>!1),wI=nn.isEqual.bind(nn);nn.isEqualOrParent.bind(nn);nn.getComparisonKey.bind(nn);const m5e=nn.basenameOrAuthority.bind(nn),Cc=nn.basename.bind(nn),_5e=nn.extname.bind(nn),RF=nn.dirname.bind(nn),b5e=nn.joinPath.bind(nn),v5e=nn.normalizePath.bind(nn),w5e=nn.relativePath.bind(nn),Wie=nn.resolvePath.bind(nn);nn.isAbsolutePath.bind(nn);const Hie=nn.isEqualAuthority.bind(nn),zie=nn.hasTrailingPathSeparator.bind(nn);nn.removeTrailingPathSeparator.bind(nn);nn.addTrailingPathSeparator.bind(nn);var Qm;(function(s){s.META_DATA_LABEL="label",s.META_DATA_DESCRIPTION="description",s.META_DATA_SIZE="size",s.META_DATA_MIME="mime";function e(t){const i=new Map;t.path.substring(t.path.indexOf(";")+1,t.path.lastIndexOf(";")).split(";").forEach(o=>{const[a,l]=o.split(":");a&&l&&i.set(a,l)});const r=t.path.substring(0,t.path.indexOf(";"));return r&&i.set(s.META_DATA_MIME,r),i}s.parseMetaData=e})(Qm||(Qm={}));class Lr{constructor(e="",t=!1){if(this.value=e,typeof this.value!="string")throw fc("value");typeof t=="boolean"?(this.isTrusted=t,this.supportThemeIcons=!1,this.supportHtml=!1):(this.isTrusted=t.isTrusted??void 0,this.supportThemeIcons=t.supportThemeIcons??!1,this.supportHtml=t.supportHtml??!1)}appendText(e,t=0){return this.value+=y5e(this.supportThemeIcons?d5e(e):e).replace(/([ \t]+)/g,(i,n)=>"&nbsp;".repeat(n.length)).replace(/\>/gm,"\\>").replace(/\n/g,t===1?`\\
`:`

`),this}appendMarkdown(e){return this.value+=e,this}appendCodeblock(e,t){return this.value+=`
${S5e(t,e)}
`,this}appendLink(e,t,i){return this.value+="[",this.value+=this._escape(t,"]"),this.value+="](",this.value+=this._escape(String(e),")"),i&&(this.value+=` "${this._escape(this._escape(i,'"'),")")}"`),this.value+=")",this}_escape(e,t){const i=new RegExp(Nl(t),"g");return e.replace(i,(n,r)=>e.charAt(r-1)!=="\\"?`\\${n}`:n)}}function y1(s){return au(s)?!s.value:Array.isArray(s)?s.every(y1):!0}function au(s){return s instanceof Lr?!0:s&&typeof s=="object"?typeof s.value=="string"&&(typeof s.isTrusted=="boolean"||typeof s.isTrusted=="object"||s.isTrusted===void 0)&&(typeof s.supportThemeIcons=="boolean"||s.supportThemeIcons===void 0):!1}function C5e(s,e){return s===e?!0:!s||!e?!1:s.value===e.value&&s.isTrusted===e.isTrusted&&s.supportThemeIcons===e.supportThemeIcons&&s.supportHtml===e.supportHtml&&(s.baseUri===e.baseUri||!!s.baseUri&&!!e.baseUri&&wI(Je.from(s.baseUri),Je.from(e.baseUri)))}function y5e(s){return s.replace(/[\\`*_{}[\]()#+\-!~]/g,"\\$&")}function S5e(s,e){var n;const t=((n=s.match(/^`+/gm))==null?void 0:n.reduce((r,o)=>r.length>o.length?r:o).length)??0,i=t>=3?t+1:3;return[`${"`".repeat(i)}${e}`,s,`${"`".repeat(i)}`].join(`
`)}function uN(s){return s.replace(/"/g,"&quot;")}function RV(s){return s&&s.replace(/\\([\\`*_{}[\]()#+\-.!~])/g,"$1")}function x5e(s){const e=[],t=s.split("|").map(n=>n.trim());s=t[0];const i=t[1];if(i){const n=/height=(\d+)/.exec(i),r=/width=(\d+)/.exec(i),o=n?n[1]:"",a=r?r[1]:"",l=isFinite(parseInt(a)),c=isFinite(parseInt(o));l&&e.push(`width="${a}"`),c&&e.push(`height="${o}"`)}return{href:s,dimensions:e}}class kK{constructor(e){this._prefix=e,this._lastId=0}nextId(){return this._prefix+ ++this._lastId}}const W6=new kK("id#");let Nr={};(function(){function s(e,t){t(Nr)}s.amd=!0,function(e,t){typeof s=="function"&&s.amd?s(["exports"],t):typeof exports=="object"&&typeof module<"u"?t(exports):(e=typeof globalThis<"u"?globalThis:e||self,t(e.marked={}))}(this,function(e){function t(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}e.defaults=t();function i(zt){e.defaults=zt}const n=/[&<>"']/,r=new RegExp(n.source,"g"),o=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,a=new RegExp(o.source,"g"),l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},c=zt=>l[zt];function d(zt,K){if(K){if(n.test(zt))return zt.replace(r,c)}else if(o.test(zt))return zt.replace(a,c);return zt}const u=/(^|[^\[])\^/g;function h(zt,K){let Q=typeof zt=="string"?zt:zt.source;K=K||"";const Y={replace:(se,le)=>{let be=typeof le=="string"?le:le.source;return be=be.replace(u,"$1"),Q=Q.replace(se,be),Y},getRegex:()=>new RegExp(Q,K)};return Y}function g(zt){try{zt=encodeURI(zt).replace(/%25/g,"%")}catch{return null}return zt}const p={exec:()=>null};function _(zt,K){const Q=zt.replace(/\|/g,(le,be,Ne)=>{let Ze=!1,rt=be;for(;--rt>=0&&Ne[rt]==="\\";)Ze=!Ze;return Ze?"|":" |"}),Y=Q.split(/ \|/);let se=0;if(Y[0].trim()||Y.shift(),Y.length>0&&!Y[Y.length-1].trim()&&Y.pop(),K)if(Y.length>K)Y.splice(K);else for(;Y.length<K;)Y.push("");for(;se<Y.length;se++)Y[se]=Y[se].trim().replace(/\\\|/g,"|");return Y}function v(zt,K,Q){const Y=zt.length;if(Y===0)return"";let se=0;for(;se<Y&&zt.charAt(Y-se-1)===K;)se++;return zt.slice(0,Y-se)}function C(zt,K){if(zt.indexOf(K[1])===-1)return-1;let Q=0;for(let Y=0;Y<zt.length;Y++)if(zt[Y]==="\\")Y++;else if(zt[Y]===K[0])Q++;else if(zt[Y]===K[1]&&(Q--,Q<0))return Y;return-1}function y(zt,K,Q,Y){const se=K.href,le=K.title?d(K.title):null,be=zt[1].replace(/\\([\[\]])/g,"$1");if(zt[0].charAt(0)!=="!"){Y.state.inLink=!0;const Ne={type:"link",raw:Q,href:se,title:le,text:be,tokens:Y.inlineTokens(be)};return Y.state.inLink=!1,Ne}return{type:"image",raw:Q,href:se,title:le,text:d(be)}}function x(zt,K){const Q=zt.match(/^(\s+)(?:```)/);if(Q===null)return K;const Y=Q[1];return K.split(`
`).map(se=>{const le=se.match(/^\s+/);if(le===null)return se;const[be]=le;return be.length>=Y.length?se.slice(Y.length):se}).join(`
`)}class L{constructor(K){es(this,"options");es(this,"rules");es(this,"lexer");this.options=K||e.defaults}space(K){const Q=this.rules.block.newline.exec(K);if(Q&&Q[0].length>0)return{type:"space",raw:Q[0]}}code(K){const Q=this.rules.block.code.exec(K);if(Q){const Y=Q[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:Q[0],codeBlockStyle:"indented",text:this.options.pedantic?Y:v(Y,`
`)}}}fences(K){const Q=this.rules.block.fences.exec(K);if(Q){const Y=Q[0],se=x(Y,Q[3]||"");return{type:"code",raw:Y,lang:Q[2]?Q[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):Q[2],text:se}}}heading(K){const Q=this.rules.block.heading.exec(K);if(Q){let Y=Q[2].trim();if(/#$/.test(Y)){const se=v(Y,"#");(this.options.pedantic||!se||/ $/.test(se))&&(Y=se.trim())}return{type:"heading",raw:Q[0],depth:Q[1].length,text:Y,tokens:this.lexer.inline(Y)}}}hr(K){const Q=this.rules.block.hr.exec(K);if(Q)return{type:"hr",raw:v(Q[0],`
`)}}blockquote(K){const Q=this.rules.block.blockquote.exec(K);if(Q){let Y=v(Q[0],`
`).split(`
`),se="",le="";const be=[];for(;Y.length>0;){let Ne=!1;const Ze=[];let rt;for(rt=0;rt<Y.length;rt++)if(/^ {0,3}>/.test(Y[rt]))Ze.push(Y[rt]),Ne=!0;else if(!Ne)Ze.push(Y[rt]);else break;Y=Y.slice(rt);const Ft=Ze.join(`
`),yi=Ft.replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`).replace(/^ {0,3}>[ \t]?/gm,"");se=se?`${se}
${Ft}`:Ft,le=le?`${le}
${yi}`:yi;const bi=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(yi,be,!0),this.lexer.state.top=bi,Y.length===0)break;const on=be[be.length-1];if((on==null?void 0:on.type)==="code")break;if((on==null?void 0:on.type)==="blockquote"){const ki=on,ps=ki.raw+`
`+Y.join(`
`),ss=this.blockquote(ps);be[be.length-1]=ss,se=se.substring(0,se.length-ki.raw.length)+ss.raw,le=le.substring(0,le.length-ki.text.length)+ss.text;break}else if((on==null?void 0:on.type)==="list"){const ki=on,ps=ki.raw+`
`+Y.join(`
`),ss=this.list(ps);be[be.length-1]=ss,se=se.substring(0,se.length-on.raw.length)+ss.raw,le=le.substring(0,le.length-ki.raw.length)+ss.raw,Y=ps.substring(be[be.length-1].raw.length).split(`
`);continue}}return{type:"blockquote",raw:se,tokens:be,text:le}}}list(K){let Q=this.rules.block.list.exec(K);if(Q){let Y=Q[1].trim();const se=Y.length>1,le={type:"list",raw:"",ordered:se,start:se?+Y.slice(0,-1):"",loose:!1,items:[]};Y=se?`\\d{1,9}\\${Y.slice(-1)}`:`\\${Y}`,this.options.pedantic&&(Y=se?Y:"[*+-]");const be=new RegExp(`^( {0,3}${Y})((?:[	 ][^\\n]*)?(?:\\n|$))`);let Ne=!1;for(;K;){let Ze=!1,rt="",Ft="";if(!(Q=be.exec(K))||this.rules.block.hr.test(K))break;rt=Q[0],K=K.substring(rt.length);let yi=Q[2].split(`
`,1)[0].replace(/^\t+/,ku=>" ".repeat(3*ku.length)),bi=K.split(`
`,1)[0],on=!yi.trim(),ki=0;if(this.options.pedantic?(ki=2,Ft=yi.trimStart()):on?ki=Q[1].length+1:(ki=Q[2].search(/[^ ]/),ki=ki>4?1:ki,Ft=yi.slice(ki),ki+=Q[1].length),on&&/^ *$/.test(bi)&&(rt+=bi+`
`,K=K.substring(bi.length+1),Ze=!0),!Ze){const ku=new RegExp(`^ {0,${Math.min(3,ki-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),xt=new RegExp(`^ {0,${Math.min(3,ki-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),de=new RegExp(`^ {0,${Math.min(3,ki-1)}}(?:\`\`\`|~~~)`),Ge=new RegExp(`^ {0,${Math.min(3,ki-1)}}#`);for(;K;){const pt=K.split(`
`,1)[0];if(bi=pt,this.options.pedantic&&(bi=bi.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),de.test(bi)||Ge.test(bi)||ku.test(bi)||xt.test(K))break;if(bi.search(/[^ ]/)>=ki||!bi.trim())Ft+=`
`+bi.slice(ki);else{if(on||yi.search(/[^ ]/)>=4||de.test(yi)||Ge.test(yi)||xt.test(yi))break;Ft+=`
`+bi}!on&&!bi.trim()&&(on=!0),rt+=pt+`
`,K=K.substring(pt.length+1),yi=bi.slice(ki)}}le.loose||(Ne?le.loose=!0:/\n *\n *$/.test(rt)&&(Ne=!0));let ps=null,ss;this.options.gfm&&(ps=/^\[[ xX]\] /.exec(Ft),ps&&(ss=ps[0]!=="[ ] ",Ft=Ft.replace(/^\[[ xX]\] +/,""))),le.items.push({type:"list_item",raw:rt,task:!!ps,checked:ss,loose:!1,text:Ft,tokens:[]}),le.raw+=rt}le.items[le.items.length-1].raw=le.items[le.items.length-1].raw.trimEnd(),le.items[le.items.length-1].text=le.items[le.items.length-1].text.trimEnd(),le.raw=le.raw.trimEnd();for(let Ze=0;Ze<le.items.length;Ze++)if(this.lexer.state.top=!1,le.items[Ze].tokens=this.lexer.blockTokens(le.items[Ze].text,[]),!le.loose){const rt=le.items[Ze].tokens.filter(yi=>yi.type==="space"),Ft=rt.length>0&&rt.some(yi=>/\n.*\n/.test(yi.raw));le.loose=Ft}if(le.loose)for(let Ze=0;Ze<le.items.length;Ze++)le.items[Ze].loose=!0;return le}}html(K){const Q=this.rules.block.html.exec(K);if(Q)return{type:"html",block:!0,raw:Q[0],pre:Q[1]==="pre"||Q[1]==="script"||Q[1]==="style",text:Q[0]}}def(K){const Q=this.rules.block.def.exec(K);if(Q){const Y=Q[1].toLowerCase().replace(/\s+/g," "),se=Q[2]?Q[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",le=Q[3]?Q[3].substring(1,Q[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):Q[3];return{type:"def",tag:Y,raw:Q[0],href:se,title:le}}}table(K){const Q=this.rules.block.table.exec(K);if(!Q||!/[:|]/.test(Q[2]))return;const Y=_(Q[1]),se=Q[2].replace(/^\||\| *$/g,"").split("|"),le=Q[3]&&Q[3].trim()?Q[3].replace(/\n[ \t]*$/,"").split(`
`):[],be={type:"table",raw:Q[0],header:[],align:[],rows:[]};if(Y.length===se.length){for(const Ne of se)/^ *-+: *$/.test(Ne)?be.align.push("right"):/^ *:-+: *$/.test(Ne)?be.align.push("center"):/^ *:-+ *$/.test(Ne)?be.align.push("left"):be.align.push(null);for(let Ne=0;Ne<Y.length;Ne++)be.header.push({text:Y[Ne],tokens:this.lexer.inline(Y[Ne]),header:!0,align:be.align[Ne]});for(const Ne of le)be.rows.push(_(Ne,be.header.length).map((Ze,rt)=>({text:Ze,tokens:this.lexer.inline(Ze),header:!1,align:be.align[rt]})));return be}}lheading(K){const Q=this.rules.block.lheading.exec(K);if(Q)return{type:"heading",raw:Q[0],depth:Q[2].charAt(0)==="="?1:2,text:Q[1],tokens:this.lexer.inline(Q[1])}}paragraph(K){const Q=this.rules.block.paragraph.exec(K);if(Q){const Y=Q[1].charAt(Q[1].length-1)===`
`?Q[1].slice(0,-1):Q[1];return{type:"paragraph",raw:Q[0],text:Y,tokens:this.lexer.inline(Y)}}}text(K){const Q=this.rules.block.text.exec(K);if(Q)return{type:"text",raw:Q[0],text:Q[0],tokens:this.lexer.inline(Q[0])}}escape(K){const Q=this.rules.inline.escape.exec(K);if(Q)return{type:"escape",raw:Q[0],text:d(Q[1])}}tag(K){const Q=this.rules.inline.tag.exec(K);if(Q)return!this.lexer.state.inLink&&/^<a /i.test(Q[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(Q[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(Q[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(Q[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:Q[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:Q[0]}}link(K){const Q=this.rules.inline.link.exec(K);if(Q){const Y=Q[2].trim();if(!this.options.pedantic&&/^</.test(Y)){if(!/>$/.test(Y))return;const be=v(Y.slice(0,-1),"\\");if((Y.length-be.length)%2===0)return}else{const be=C(Q[2],"()");if(be>-1){const Ze=(Q[0].indexOf("!")===0?5:4)+Q[1].length+be;Q[2]=Q[2].substring(0,be),Q[0]=Q[0].substring(0,Ze).trim(),Q[3]=""}}let se=Q[2],le="";if(this.options.pedantic){const be=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(se);be&&(se=be[1],le=be[3])}else le=Q[3]?Q[3].slice(1,-1):"";return se=se.trim(),/^</.test(se)&&(this.options.pedantic&&!/>$/.test(Y)?se=se.slice(1):se=se.slice(1,-1)),y(Q,{href:se&&se.replace(this.rules.inline.anyPunctuation,"$1"),title:le&&le.replace(this.rules.inline.anyPunctuation,"$1")},Q[0],this.lexer)}}reflink(K,Q){let Y;if((Y=this.rules.inline.reflink.exec(K))||(Y=this.rules.inline.nolink.exec(K))){const se=(Y[2]||Y[1]).replace(/\s+/g," "),le=Q[se.toLowerCase()];if(!le){const be=Y[0].charAt(0);return{type:"text",raw:be,text:be}}return y(Y,le,Y[0],this.lexer)}}emStrong(K,Q,Y=""){let se=this.rules.inline.emStrongLDelim.exec(K);if(!se||se[3]&&Y.match(/[\p{L}\p{N}]/u))return;if(!(se[1]||se[2]||"")||!Y||this.rules.inline.punctuation.exec(Y)){const be=[...se[0]].length-1;let Ne,Ze,rt=be,Ft=0;const yi=se[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(yi.lastIndex=0,Q=Q.slice(-1*K.length+be);(se=yi.exec(Q))!=null;){if(Ne=se[1]||se[2]||se[3]||se[4]||se[5]||se[6],!Ne)continue;if(Ze=[...Ne].length,se[3]||se[4]){rt+=Ze;continue}else if((se[5]||se[6])&&be%3&&!((be+Ze)%3)){Ft+=Ze;continue}if(rt-=Ze,rt>0)continue;Ze=Math.min(Ze,Ze+rt+Ft);const bi=[...se[0]][0].length,on=K.slice(0,be+se.index+bi+Ze);if(Math.min(be,Ze)%2){const ps=on.slice(1,-1);return{type:"em",raw:on,text:ps,tokens:this.lexer.inlineTokens(ps)}}const ki=on.slice(2,-2);return{type:"strong",raw:on,text:ki,tokens:this.lexer.inlineTokens(ki)}}}}codespan(K){const Q=this.rules.inline.code.exec(K);if(Q){let Y=Q[2].replace(/\n/g," ");const se=/[^ ]/.test(Y),le=/^ /.test(Y)&&/ $/.test(Y);return se&&le&&(Y=Y.substring(1,Y.length-1)),Y=d(Y,!0),{type:"codespan",raw:Q[0],text:Y}}}br(K){const Q=this.rules.inline.br.exec(K);if(Q)return{type:"br",raw:Q[0]}}del(K){const Q=this.rules.inline.del.exec(K);if(Q)return{type:"del",raw:Q[0],text:Q[2],tokens:this.lexer.inlineTokens(Q[2])}}autolink(K){const Q=this.rules.inline.autolink.exec(K);if(Q){let Y,se;return Q[2]==="@"?(Y=d(Q[1]),se="mailto:"+Y):(Y=d(Q[1]),se=Y),{type:"link",raw:Q[0],text:Y,href:se,tokens:[{type:"text",raw:Y,text:Y}]}}}url(K){var Y;let Q;if(Q=this.rules.inline.url.exec(K)){let se,le;if(Q[2]==="@")se=d(Q[0]),le="mailto:"+se;else{let be;do be=Q[0],Q[0]=((Y=this.rules.inline._backpedal.exec(Q[0]))==null?void 0:Y[0])??"";while(be!==Q[0]);se=d(Q[0]),Q[1]==="www."?le="http://"+Q[0]:le=Q[0]}return{type:"link",raw:Q[0],text:se,href:le,tokens:[{type:"text",raw:se,text:se}]}}}inlineText(K){const Q=this.rules.inline.text.exec(K);if(Q){let Y;return this.lexer.state.inRawBlock?Y=Q[0]:Y=d(Q[0]),{type:"text",raw:Q[0],text:Y}}}}const I=/^(?: *(?:\n|$))+/,A=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,D=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,N=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,R=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,W=/(?:[*+-]|\d{1,9}[.)])/,H=h(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,W).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),U=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,B=/^[^\n]+/,ee=/(?!\s*\])(?:\\.|[^\[\]\\])+/,re=h(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",ee).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),pe=h(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,W).getRegex(),Ie="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",ge=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,_e=h("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",ge).replace("tag",Ie).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Re=h(U).replace("hr",N).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ie).getRegex(),we={blockquote:h(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Re).getRegex(),code:A,def:re,fences:D,heading:R,hr:N,html:_e,lheading:H,list:pe,newline:I,paragraph:Re,table:p,text:B},Ae=h("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",N).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ie).getRegex(),ot={...we,table:Ae,paragraph:h(U).replace("hr",N).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Ae).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ie).getRegex()},tt={...we,html:h(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",ge).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:p,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:h(U).replace("hr",N).replace("heading",` *#{1,6} *[^
]`).replace("lheading",H).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},It=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,si=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,ai=/^( {2,}|\\)\n(?!\s*$)/,Ii=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,rn="\\p{P}\\p{S}",eo=h(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,rn).getRegex(),vn=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,zs=h(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,rn).getRegex(),to=h("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,rn).getRegex(),Ec=h("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,rn).getRegex(),_d=h(/\\([punct])/,"gu").replace(/punct/g,rn).getRegex(),Ua=h(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),bd=h(ge).replace("(?:-->|$)","-->").getRegex(),Hl=h("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",bd).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),io=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,ja=h(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",io).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Su=h(/^!?\[(label)\]\[(ref)\]/).replace("label",io).replace("ref",ee).getRegex(),zl=h(/^!?\[(ref)\](?:\[\])?/).replace("ref",ee).getRegex(),$a=h("reflink|nolink(?!\\()","g").replace("reflink",Su).replace("nolink",zl).getRegex(),Po={_backpedal:p,anyPunctuation:_d,autolink:Ua,blockSkip:vn,br:ai,code:si,del:p,emStrongLDelim:zs,emStrongRDelimAst:to,emStrongRDelimUnd:Ec,escape:It,link:ja,nolink:zl,punctuation:eo,reflink:Su,reflinkSearch:$a,tag:Hl,text:Ii,url:p},On={...Po,link:h(/^!?\[(label)\]\((.*?)\)/).replace("label",io).getRegex(),reflink:h(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",io).getRegex()},Zn={...Po,escape:h(It).replace("])","~|])").getRegex(),url:h(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},qa={...Zn,br:h(ai).replace("{2,}","*").getRegex(),text:h(Zn.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Ul={normal:we,gfm:ot,pedantic:tt},Ar={normal:Po,gfm:Zn,breaks:qa,pedantic:On};class Ds{constructor(K){es(this,"tokens");es(this,"options");es(this,"state");es(this,"tokenizer");es(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=K||e.defaults,this.options.tokenizer=this.options.tokenizer||new L,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const Q={block:Ul.normal,inline:Ar.normal};this.options.pedantic?(Q.block=Ul.pedantic,Q.inline=Ar.pedantic):this.options.gfm&&(Q.block=Ul.gfm,this.options.breaks?Q.inline=Ar.breaks:Q.inline=Ar.gfm),this.tokenizer.rules=Q}static get rules(){return{block:Ul,inline:Ar}}static lex(K,Q){return new Ds(Q).lex(K)}static lexInline(K,Q){return new Ds(Q).inlineTokens(K)}lex(K){K=K.replace(/\r\n|\r/g,`
`),this.blockTokens(K,this.tokens);for(let Q=0;Q<this.inlineQueue.length;Q++){const Y=this.inlineQueue[Q];this.inlineTokens(Y.src,Y.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(K,Q=[],Y=!1){this.options.pedantic?K=K.replace(/\t/g,"    ").replace(/^ +$/gm,""):K=K.replace(/^( *)(\t+)/gm,(Ne,Ze,rt)=>Ze+"    ".repeat(rt.length));let se,le,be;for(;K;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(Ne=>(se=Ne.call({lexer:this},K,Q))?(K=K.substring(se.raw.length),Q.push(se),!0):!1))){if(se=this.tokenizer.space(K)){K=K.substring(se.raw.length),se.raw.length===1&&Q.length>0?Q[Q.length-1].raw+=`
`:Q.push(se);continue}if(se=this.tokenizer.code(K)){K=K.substring(se.raw.length),le=Q[Q.length-1],le&&(le.type==="paragraph"||le.type==="text")?(le.raw+=`
`+se.raw,le.text+=`
`+se.text,this.inlineQueue[this.inlineQueue.length-1].src=le.text):Q.push(se);continue}if(se=this.tokenizer.fences(K)){K=K.substring(se.raw.length),Q.push(se);continue}if(se=this.tokenizer.heading(K)){K=K.substring(se.raw.length),Q.push(se);continue}if(se=this.tokenizer.hr(K)){K=K.substring(se.raw.length),Q.push(se);continue}if(se=this.tokenizer.blockquote(K)){K=K.substring(se.raw.length),Q.push(se);continue}if(se=this.tokenizer.list(K)){K=K.substring(se.raw.length),Q.push(se);continue}if(se=this.tokenizer.html(K)){K=K.substring(se.raw.length),Q.push(se);continue}if(se=this.tokenizer.def(K)){K=K.substring(se.raw.length),le=Q[Q.length-1],le&&(le.type==="paragraph"||le.type==="text")?(le.raw+=`
`+se.raw,le.text+=`
`+se.raw,this.inlineQueue[this.inlineQueue.length-1].src=le.text):this.tokens.links[se.tag]||(this.tokens.links[se.tag]={href:se.href,title:se.title});continue}if(se=this.tokenizer.table(K)){K=K.substring(se.raw.length),Q.push(se);continue}if(se=this.tokenizer.lheading(K)){K=K.substring(se.raw.length),Q.push(se);continue}if(be=K,this.options.extensions&&this.options.extensions.startBlock){let Ne=1/0;const Ze=K.slice(1);let rt;this.options.extensions.startBlock.forEach(Ft=>{rt=Ft.call({lexer:this},Ze),typeof rt=="number"&&rt>=0&&(Ne=Math.min(Ne,rt))}),Ne<1/0&&Ne>=0&&(be=K.substring(0,Ne+1))}if(this.state.top&&(se=this.tokenizer.paragraph(be))){le=Q[Q.length-1],Y&&(le==null?void 0:le.type)==="paragraph"?(le.raw+=`
`+se.raw,le.text+=`
`+se.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=le.text):Q.push(se),Y=be.length!==K.length,K=K.substring(se.raw.length);continue}if(se=this.tokenizer.text(K)){K=K.substring(se.raw.length),le=Q[Q.length-1],le&&le.type==="text"?(le.raw+=`
`+se.raw,le.text+=`
`+se.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=le.text):Q.push(se);continue}if(K){const Ne="Infinite loop on byte: "+K.charCodeAt(0);if(this.options.silent){console.error(Ne);break}else throw new Error(Ne)}}return this.state.top=!0,Q}inline(K,Q=[]){return this.inlineQueue.push({src:K,tokens:Q}),Q}inlineTokens(K,Q=[]){let Y,se,le,be=K,Ne,Ze,rt;if(this.tokens.links){const Ft=Object.keys(this.tokens.links);if(Ft.length>0)for(;(Ne=this.tokenizer.rules.inline.reflinkSearch.exec(be))!=null;)Ft.includes(Ne[0].slice(Ne[0].lastIndexOf("[")+1,-1))&&(be=be.slice(0,Ne.index)+"["+"a".repeat(Ne[0].length-2)+"]"+be.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(Ne=this.tokenizer.rules.inline.blockSkip.exec(be))!=null;)be=be.slice(0,Ne.index)+"["+"a".repeat(Ne[0].length-2)+"]"+be.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(Ne=this.tokenizer.rules.inline.anyPunctuation.exec(be))!=null;)be=be.slice(0,Ne.index)+"++"+be.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;K;)if(Ze||(rt=""),Ze=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(Ft=>(Y=Ft.call({lexer:this},K,Q))?(K=K.substring(Y.raw.length),Q.push(Y),!0):!1))){if(Y=this.tokenizer.escape(K)){K=K.substring(Y.raw.length),Q.push(Y);continue}if(Y=this.tokenizer.tag(K)){K=K.substring(Y.raw.length),se=Q[Q.length-1],se&&Y.type==="text"&&se.type==="text"?(se.raw+=Y.raw,se.text+=Y.text):Q.push(Y);continue}if(Y=this.tokenizer.link(K)){K=K.substring(Y.raw.length),Q.push(Y);continue}if(Y=this.tokenizer.reflink(K,this.tokens.links)){K=K.substring(Y.raw.length),se=Q[Q.length-1],se&&Y.type==="text"&&se.type==="text"?(se.raw+=Y.raw,se.text+=Y.text):Q.push(Y);continue}if(Y=this.tokenizer.emStrong(K,be,rt)){K=K.substring(Y.raw.length),Q.push(Y);continue}if(Y=this.tokenizer.codespan(K)){K=K.substring(Y.raw.length),Q.push(Y);continue}if(Y=this.tokenizer.br(K)){K=K.substring(Y.raw.length),Q.push(Y);continue}if(Y=this.tokenizer.del(K)){K=K.substring(Y.raw.length),Q.push(Y);continue}if(Y=this.tokenizer.autolink(K)){K=K.substring(Y.raw.length),Q.push(Y);continue}if(!this.state.inLink&&(Y=this.tokenizer.url(K))){K=K.substring(Y.raw.length),Q.push(Y);continue}if(le=K,this.options.extensions&&this.options.extensions.startInline){let Ft=1/0;const yi=K.slice(1);let bi;this.options.extensions.startInline.forEach(on=>{bi=on.call({lexer:this},yi),typeof bi=="number"&&bi>=0&&(Ft=Math.min(Ft,bi))}),Ft<1/0&&Ft>=0&&(le=K.substring(0,Ft+1))}if(Y=this.tokenizer.inlineText(le)){K=K.substring(Y.raw.length),Y.raw.slice(-1)!=="_"&&(rt=Y.raw.slice(-1)),Ze=!0,se=Q[Q.length-1],se&&se.type==="text"?(se.raw+=Y.raw,se.text+=Y.text):Q.push(Y);continue}if(K){const Ft="Infinite loop on byte: "+K.charCodeAt(0);if(this.options.silent){console.error(Ft);break}else throw new Error(Ft)}}return Q}}class Pr{constructor(K){es(this,"options");es(this,"parser");this.options=K||e.defaults}space(K){return""}code({text:K,lang:Q,escaped:Y}){var be;const se=(be=(Q||"").match(/^\S*/))==null?void 0:be[0],le=K.replace(/\n$/,"")+`
`;return se?'<pre><code class="language-'+d(se)+'">'+(Y?le:d(le,!0))+`</code></pre>
`:"<pre><code>"+(Y?le:d(le,!0))+`</code></pre>
`}blockquote({tokens:K}){return`<blockquote>
${this.parser.parse(K)}</blockquote>
`}html({text:K}){return K}heading({tokens:K,depth:Q}){return`<h${Q}>${this.parser.parseInline(K)}</h${Q}>
`}hr(K){return`<hr>
`}list(K){const Q=K.ordered,Y=K.start;let se="";for(let Ne=0;Ne<K.items.length;Ne++){const Ze=K.items[Ne];se+=this.listitem(Ze)}const le=Q?"ol":"ul",be=Q&&Y!==1?' start="'+Y+'"':"";return"<"+le+be+`>
`+se+"</"+le+`>
`}listitem(K){let Q="";if(K.task){const Y=this.checkbox({checked:!!K.checked});K.loose?K.tokens.length>0&&K.tokens[0].type==="paragraph"?(K.tokens[0].text=Y+" "+K.tokens[0].text,K.tokens[0].tokens&&K.tokens[0].tokens.length>0&&K.tokens[0].tokens[0].type==="text"&&(K.tokens[0].tokens[0].text=Y+" "+K.tokens[0].tokens[0].text)):K.tokens.unshift({type:"text",raw:Y+" ",text:Y+" "}):Q+=Y+" "}return Q+=this.parser.parse(K.tokens,!!K.loose),`<li>${Q}</li>
`}checkbox({checked:K}){return"<input "+(K?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:K}){return`<p>${this.parser.parseInline(K)}</p>
`}table(K){let Q="",Y="";for(let le=0;le<K.header.length;le++)Y+=this.tablecell(K.header[le]);Q+=this.tablerow({text:Y});let se="";for(let le=0;le<K.rows.length;le++){const be=K.rows[le];Y="";for(let Ne=0;Ne<be.length;Ne++)Y+=this.tablecell(be[Ne]);se+=this.tablerow({text:Y})}return se&&(se=`<tbody>${se}</tbody>`),`<table>
<thead>
`+Q+`</thead>
`+se+`</table>
`}tablerow({text:K}){return`<tr>
${K}</tr>
`}tablecell(K){const Q=this.parser.parseInline(K.tokens),Y=K.header?"th":"td";return(K.align?`<${Y} align="${K.align}">`:`<${Y}>`)+Q+`</${Y}>
`}strong({tokens:K}){return`<strong>${this.parser.parseInline(K)}</strong>`}em({tokens:K}){return`<em>${this.parser.parseInline(K)}</em>`}codespan({text:K}){return`<code>${K}</code>`}br(K){return"<br>"}del({tokens:K}){return`<del>${this.parser.parseInline(K)}</del>`}link({href:K,title:Q,tokens:Y}){const se=this.parser.parseInline(Y),le=g(K);if(le===null)return se;K=le;let be='<a href="'+K+'"';return Q&&(be+=' title="'+Q+'"'),be+=">"+se+"</a>",be}image({href:K,title:Q,text:Y}){const se=g(K);if(se===null)return Y;K=se;let le=`<img src="${K}" alt="${Y}"`;return Q&&(le+=` title="${Q}"`),le+=">",le}text(K){return"tokens"in K&&K.tokens?this.parser.parseInline(K.tokens):K.text}}class da{strong({text:K}){return K}em({text:K}){return K}codespan({text:K}){return K}del({text:K}){return K}html({text:K}){return K}text({text:K}){return K}link({text:K}){return""+K}image({text:K}){return""+K}br(){return""}}class qn{constructor(K){es(this,"options");es(this,"renderer");es(this,"textRenderer");this.options=K||e.defaults,this.options.renderer=this.options.renderer||new Pr,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new da}static parse(K,Q){return new qn(Q).parse(K)}static parseInline(K,Q){return new qn(Q).parseInline(K)}parse(K,Q=!0){let Y="";for(let se=0;se<K.length;se++){const le=K[se];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[le.type]){const Ne=le,Ze=this.options.extensions.renderers[Ne.type].call({parser:this},Ne);if(Ze!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(Ne.type)){Y+=Ze||"";continue}}const be=le;switch(be.type){case"space":{Y+=this.renderer.space(be);continue}case"hr":{Y+=this.renderer.hr(be);continue}case"heading":{Y+=this.renderer.heading(be);continue}case"code":{Y+=this.renderer.code(be);continue}case"table":{Y+=this.renderer.table(be);continue}case"blockquote":{Y+=this.renderer.blockquote(be);continue}case"list":{Y+=this.renderer.list(be);continue}case"html":{Y+=this.renderer.html(be);continue}case"paragraph":{Y+=this.renderer.paragraph(be);continue}case"text":{let Ne=be,Ze=this.renderer.text(Ne);for(;se+1<K.length&&K[se+1].type==="text";)Ne=K[++se],Ze+=`
`+this.renderer.text(Ne);Q?Y+=this.renderer.paragraph({type:"paragraph",raw:Ze,text:Ze,tokens:[{type:"text",raw:Ze,text:Ze}]}):Y+=Ze;continue}default:{const Ne='Token with "'+be.type+'" type was not found.';if(this.options.silent)return console.error(Ne),"";throw new Error(Ne)}}}return Y}parseInline(K,Q){Q=Q||this.renderer;let Y="";for(let se=0;se<K.length;se++){const le=K[se];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[le.type]){const Ne=this.options.extensions.renderers[le.type].call({parser:this},le);if(Ne!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(le.type)){Y+=Ne||"";continue}}const be=le;switch(be.type){case"escape":{Y+=Q.text(be);break}case"html":{Y+=Q.html(be);break}case"link":{Y+=Q.link(be);break}case"image":{Y+=Q.image(be);break}case"strong":{Y+=Q.strong(be);break}case"em":{Y+=Q.em(be);break}case"codespan":{Y+=Q.codespan(be);break}case"br":{Y+=Q.br(be);break}case"del":{Y+=Q.del(be);break}case"text":{Y+=Q.text(be);break}default:{const Ne='Token with "'+be.type+'" type was not found.';if(this.options.silent)return console.error(Ne),"";throw new Error(Ne)}}}return Y}}class _r{constructor(K){es(this,"options");this.options=K||e.defaults}preprocess(K){return K}postprocess(K){return K}processAllTokens(K){return K}}es(_r,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));class Dc{constructor(...K){es(this,"defaults",t());es(this,"options",this.setOptions);es(this,"parse",this.parseMarkdown(Ds.lex,qn.parse));es(this,"parseInline",this.parseMarkdown(Ds.lexInline,qn.parseInline));es(this,"Parser",qn);es(this,"Renderer",Pr);es(this,"TextRenderer",da);es(this,"Lexer",Ds);es(this,"Tokenizer",L);es(this,"Hooks",_r);this.use(...K)}walkTokens(K,Q){var se,le;let Y=[];for(const be of K)switch(Y=Y.concat(Q.call(this,be)),be.type){case"table":{const Ne=be;for(const Ze of Ne.header)Y=Y.concat(this.walkTokens(Ze.tokens,Q));for(const Ze of Ne.rows)for(const rt of Ze)Y=Y.concat(this.walkTokens(rt.tokens,Q));break}case"list":{const Ne=be;Y=Y.concat(this.walkTokens(Ne.items,Q));break}default:{const Ne=be;(le=(se=this.defaults.extensions)==null?void 0:se.childTokens)!=null&&le[Ne.type]?this.defaults.extensions.childTokens[Ne.type].forEach(Ze=>{const rt=Ne[Ze].flat(1/0);Y=Y.concat(this.walkTokens(rt,Q))}):Ne.tokens&&(Y=Y.concat(this.walkTokens(Ne.tokens,Q)))}}return Y}use(...K){const Q=this.defaults.extensions||{renderers:{},childTokens:{}};return K.forEach(Y=>{const se={...Y};if(se.async=this.defaults.async||se.async||!1,Y.extensions&&(Y.extensions.forEach(le=>{if(!le.name)throw new Error("extension name required");if("renderer"in le){const be=Q.renderers[le.name];be?Q.renderers[le.name]=function(...Ne){let Ze=le.renderer.apply(this,Ne);return Ze===!1&&(Ze=be.apply(this,Ne)),Ze}:Q.renderers[le.name]=le.renderer}if("tokenizer"in le){if(!le.level||le.level!=="block"&&le.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const be=Q[le.level];be?be.unshift(le.tokenizer):Q[le.level]=[le.tokenizer],le.start&&(le.level==="block"?Q.startBlock?Q.startBlock.push(le.start):Q.startBlock=[le.start]:le.level==="inline"&&(Q.startInline?Q.startInline.push(le.start):Q.startInline=[le.start]))}"childTokens"in le&&le.childTokens&&(Q.childTokens[le.name]=le.childTokens)}),se.extensions=Q),Y.renderer){const le=this.defaults.renderer||new Pr(this.defaults);for(const be in Y.renderer){if(!(be in le))throw new Error(`renderer '${be}' does not exist`);if(["options","parser"].includes(be))continue;const Ne=be,Ze=Y.renderer[Ne],rt=le[Ne];le[Ne]=(...Ft)=>{let yi=Ze.apply(le,Ft);return yi===!1&&(yi=rt.apply(le,Ft)),yi||""}}se.renderer=le}if(Y.tokenizer){const le=this.defaults.tokenizer||new L(this.defaults);for(const be in Y.tokenizer){if(!(be in le))throw new Error(`tokenizer '${be}' does not exist`);if(["options","rules","lexer"].includes(be))continue;const Ne=be,Ze=Y.tokenizer[Ne],rt=le[Ne];le[Ne]=(...Ft)=>{let yi=Ze.apply(le,Ft);return yi===!1&&(yi=rt.apply(le,Ft)),yi}}se.tokenizer=le}if(Y.hooks){const le=this.defaults.hooks||new _r;for(const be in Y.hooks){if(!(be in le))throw new Error(`hook '${be}' does not exist`);if(be==="options")continue;const Ne=be,Ze=Y.hooks[Ne],rt=le[Ne];_r.passThroughHooks.has(be)?le[Ne]=Ft=>{if(this.defaults.async)return Promise.resolve(Ze.call(le,Ft)).then(bi=>rt.call(le,bi));const yi=Ze.call(le,Ft);return rt.call(le,yi)}:le[Ne]=(...Ft)=>{let yi=Ze.apply(le,Ft);return yi===!1&&(yi=rt.apply(le,Ft)),yi}}se.hooks=le}if(Y.walkTokens){const le=this.defaults.walkTokens,be=Y.walkTokens;se.walkTokens=function(Ne){let Ze=[];return Ze.push(be.call(this,Ne)),le&&(Ze=Ze.concat(le.call(this,Ne))),Ze}}this.defaults={...this.defaults,...se}}),this}setOptions(K){return this.defaults={...this.defaults,...K},this}lexer(K,Q){return Ds.lex(K,Q??this.defaults)}parser(K,Q){return qn.parse(K,Q??this.defaults)}parseMarkdown(K,Q){return(se,le)=>{const be={...le},Ne={...this.defaults,...be},Ze=this.onError(!!Ne.silent,!!Ne.async);if(this.defaults.async===!0&&be.async===!1)return Ze(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof se>"u"||se===null)return Ze(new Error("marked(): input parameter is undefined or null"));if(typeof se!="string")return Ze(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(se)+", string expected"));if(Ne.hooks&&(Ne.hooks.options=Ne),Ne.async)return Promise.resolve(Ne.hooks?Ne.hooks.preprocess(se):se).then(rt=>K(rt,Ne)).then(rt=>Ne.hooks?Ne.hooks.processAllTokens(rt):rt).then(rt=>Ne.walkTokens?Promise.all(this.walkTokens(rt,Ne.walkTokens)).then(()=>rt):rt).then(rt=>Q(rt,Ne)).then(rt=>Ne.hooks?Ne.hooks.postprocess(rt):rt).catch(Ze);try{Ne.hooks&&(se=Ne.hooks.preprocess(se));let rt=K(se,Ne);Ne.hooks&&(rt=Ne.hooks.processAllTokens(rt)),Ne.walkTokens&&this.walkTokens(rt,Ne.walkTokens);let Ft=Q(rt,Ne);return Ne.hooks&&(Ft=Ne.hooks.postprocess(Ft)),Ft}catch(rt){return Ze(rt)}}}onError(K,Q){return Y=>{if(Y.message+=`
Please report this to https://github.com/markedjs/marked.`,K){const se="<p>An error occurred:</p><pre>"+d(Y.message+"",!0)+"</pre>";return Q?Promise.resolve(se):se}if(Q)return Promise.reject(Y);throw Y}}}const no=new Dc;function Li(zt,K){return no.parse(zt,K)}Li.options=Li.setOptions=function(zt){return no.setOptions(zt),Li.defaults=no.defaults,i(Li.defaults),Li},Li.getDefaults=t,Li.defaults=e.defaults,Li.use=function(...zt){return no.use(...zt),Li.defaults=no.defaults,i(Li.defaults),Li},Li.walkTokens=function(zt,K){return no.walkTokens(zt,K)},Li.parseInline=no.parseInline,Li.Parser=qn,Li.parser=qn.parse,Li.Renderer=Pr,Li.TextRenderer=da,Li.Lexer=Ds,Li.lexer=Ds.lex,Li.Tokenizer=L,Li.Hooks=_r,Li.parse=Li;const Ka=Li.options,xu=Li.setOptions,Mo=Li.use,wn=Li.walkTokens,ua=Li.parseInline,Ga=Li,Lu=qn.parse,jl=Ds.lex;e.Hooks=_r,e.Lexer=Ds,e.Marked=Dc,e.Parser=qn,e.Renderer=Pr,e.TextRenderer=da,e.Tokenizer=L,e.getDefaults=t,e.lexer=jl,e.marked=Li,e.options=Ka,e.parse=Ga,e.parseInline=ua,e.parser=Lu,e.setOptions=xu,e.use=Mo,e.walkTokens=wn})})();Nr.Hooks||exports.Hooks;Nr.Lexer||exports.Lexer;Nr.Marked||exports.Marked;Nr.Parser||exports.Parser;var Bfe=Nr.Renderer||exports.Renderer;Nr.TextRenderer||exports.TextRenderer;Nr.Tokenizer||exports.Tokenizer;var L5e=Nr.defaults||exports.defaults;Nr.getDefaults||exports.getDefaults;var AF=Nr.lexer||exports.lexer;Nr.marked||exports.marked;Nr.options||exports.options;var Wfe=Nr.parse||exports.parse;Nr.parseInline||exports.parseInline;var k5e=Nr.parser||exports.parser;Nr.setOptions||exports.setOptions;Nr.use||exports.use;Nr.walkTokens||exports.walkTokens;function I5e(s){return JSON.stringify(s,E5e)}function H6(s){let e=JSON.parse(s);return e=z6(e),e}function E5e(s,e){return e instanceof RegExp?{$mid:2,source:e.source,flags:e.flags}:e}function z6(s,e=0){if(!s||e>200)return s;if(typeof s=="object"){switch(s.$mid){case 1:return Je.revive(s);case 2:return new RegExp(s.source,s.flags);case 17:return new Date(s.source)}if(s instanceof mF||s instanceof Uint8Array)return s;if(Array.isArray(s))for(let t=0;t<s.length;++t)s[t]=z6(s[t],e+1);else for(const t in s)Object.hasOwnProperty.call(s,t)&&(s[t]=z6(s[t],e+1))}return s}const AV=Object.freeze({image:({href:s,title:e,text:t})=>{let i=[],n=[];return s&&({href:s,dimensions:i}=x5e(s),n.push(`src="${uN(s)}"`)),t&&n.push(`alt="${uN(t)}"`),e&&n.push(`title="${uN(e)}"`),i.length&&(n=n.concat(i)),"<img "+n.join(" ")+">"},paragraph({tokens:s}){return`<p>${this.parser.parseInline(s)}</p>`},link({href:s,title:e,tokens:t}){let i=this.parser.parseInline(t);return typeof s!="string"?"":(s===i&&(i=RV(i)),e=typeof e=="string"?uN(RV(e)):"",s=RV(s),s=s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),`<a href="${s}" title="${e||s}" draggable="false">${i}</a>`)}});function PF(s,e={},t={}){const i=new ce;let n=!1;const r=bK(e),o=function(_){let v;try{v=H6(decodeURIComponent(_))}catch{}return v?(v=Zde(v,C=>{if(s.uris&&s.uris[C])return Je.revive(s.uris[C])}),encodeURIComponent(JSON.stringify(v))):_},a=function(_,v){const C=s.uris&&s.uris[_];let y=Je.revive(C);return v?_.startsWith(gt.data+":")?_:(y||(y=Je.parse(_)),eF.uriToBrowserUri(y).toString(!0)):!y||Je.parse(_).toString()===y.toString()?_:(y.query&&(y=y.with({query:o(y.query)})),y.toString())},l=new Bfe;l.image=AV.image,l.link=AV.link,l.paragraph=AV.paragraph;const c=[],d=[];if(e.codeBlockRendererSync?l.code=({text:_,lang:v})=>{const C=W6.nextId(),y=e.codeBlockRendererSync(Uie(v),_);return d.push([C,y]),`<div class="code" data-code="${C}">${DL(_)}</div>`}:e.codeBlockRenderer&&(l.code=({text:_,lang:v})=>{const C=W6.nextId(),y=e.codeBlockRenderer(Uie(v),_);return c.push(y.then(x=>[C,x])),`<div class="code" data-code="${C}">${DL(_)}</div>`}),e.actionHandler){const _=function(y){let x=y.target;if(!(x.tagName!=="A"&&(x=x.parentElement,!x||x.tagName!=="A")))try{let L=x.dataset.href;L&&(s.baseUri&&(L=PV(Je.from(s.baseUri),L)),e.actionHandler.callback(L,y))}catch(L){ft(L)}finally{y.preventDefault()}},v=e.actionHandler.disposables.add(new Ut(r,"click")),C=e.actionHandler.disposables.add(new Ut(r,"auxclick"));e.actionHandler.disposables.add(De.any(v.event,C.event)(y=>{const x=new Xc(nt(r),y);!x.leftButton&&!x.middleButton||_(x)})),e.actionHandler.disposables.add(oe(r,"keydown",y=>{const x=new Mi(y);!x.equals(10)&&!x.equals(3)||_(x)}))}s.supportHtml||(l.html=({text:_})=>{var C;return(C=e.sanitizerOptions)!=null&&C.replaceWithPlaintext?DL(_):(s.isTrusted?_.match(/^(<span[^>]+>)|(<\/\s*span>)$/):void 0)?_:""}),t.renderer=l;let u=s.value??"";u.length>1e5&&(u=`${u.substr(0,1e5)}…`),s.supportThemeIcons&&(u=h5e(u));let h;if(e.fillInIncompleteTokens){const _={...L5e,...t},v=AF(u,_),C=H5e(v);h=k5e(C,_)}else h=Wfe(u,{...t,async:!1});s.supportThemeIcons&&(h=dm(h).map(v=>typeof v=="string"?v:v.outerHTML).join(""));const p=new DOMParser().parseFromString(U6({isTrusted:s.isTrusted,...e.sanitizerOptions},h),"text/html");if(p.body.querySelectorAll("img, audio, video, source").forEach(_=>{const v=_.getAttribute("src");if(v){let C=v;try{s.baseUri&&(C=PV(Je.from(s.baseUri),C))}catch{}if(_.setAttribute("src",a(C,!0)),e.remoteImageIsAllowed){const y=Je.parse(C);y.scheme!==gt.file&&y.scheme!==gt.data&&!e.remoteImageIsAllowed(y)&&_.replaceWith(ke("",void 0,_.outerHTML))}}}),p.body.querySelectorAll("a").forEach(_=>{const v=_.getAttribute("href");if(_.setAttribute("href",""),!v||/^data:|javascript:/i.test(v)||/^command:/i.test(v)&&!s.isTrusted||/^command:(\/\/\/)?_workbench\.downloadResource/i.test(v))_.replaceWith(..._.childNodes);else{let C=a(v,!1);s.baseUri&&(C=PV(Je.from(s.baseUri),v)),_.dataset.href=C}}),r.innerHTML=U6({isTrusted:s.isTrusted,...e.sanitizerOptions},p.body.innerHTML),c.length>0)Promise.all(c).then(_=>{var y;if(n)return;const v=new Map(_),C=r.querySelectorAll("div[data-code]");for(const x of C){const L=v.get(x.dataset.code??"");L&&Xs(x,L)}(y=e.asyncRenderCallback)==null||y.call(e)});else if(d.length>0){const _=new Map(d),v=r.querySelectorAll("div[data-code]");for(const C of v){const y=_.get(C.dataset.code??"");y&&Xs(C,y)}}if(e.asyncRenderCallback)for(const _ of r.getElementsByTagName("img")){const v=i.add(oe(_,"load",()=>{v.dispose(),e.asyncRenderCallback()}))}return{element:r,dispose:()=>{n=!0,i.dispose()}}}function Uie(s){if(!s)return"";const e=s.split(/[\s+|:|,|\{|\?]/,1);return e.length?e[0]:s}function PV(s,e){return/^\w[\w\d+.-]*:/.test(e)?e:s.path.endsWith("/")?Wie(s,e).toString():Wie(RF(s),e).toString()}const D5e=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];function U6(s,e){const{config:t,allowedSchemes:i}=N5e(s),n=new ce;n.add(jie("uponSanitizeAttribute",(r,o)=>{var a;if(o.attrName==="style"||o.attrName==="class"){if(r.tagName==="SPAN"){if(o.attrName==="style"){o.keepAttr=/^(color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z]+)+\));)?(background-color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z]+)+\));)?(border-radius:[0-9]+px;)?$/.test(o.attrValue);return}else if(o.attrName==="class"){o.keepAttr=/^codicon codicon-[a-z\-]+( codicon-modifier-[a-z\-]+)?$/.test(o.attrValue);return}}o.keepAttr=!1;return}else if(r.tagName==="INPUT"&&((a=r.attributes.getNamedItem("type"))==null?void 0:a.value)==="checkbox"){if(o.attrName==="type"&&o.attrValue==="checkbox"||o.attrName==="disabled"||o.attrName==="checked"){o.keepAttr=!0;return}o.keepAttr=!1}})),n.add(jie("uponSanitizeElement",(r,o)=>{var a;if(o.tagName==="input"&&(((a=r.attributes.getNamedItem("type"))==null?void 0:a.value)==="checkbox"?r.setAttribute("disabled",""):s.replaceWithPlaintext||r.remove()),s.replaceWithPlaintext&&!o.allowedTags[o.tagName]&&o.tagName!=="body"&&r.parentElement){let l,c;if(o.tagName==="#comment")l=`<!--${r.textContent}-->`;else{const g=D5e.includes(o.tagName),p=r.attributes.length?" "+Array.from(r.attributes).map(_=>`${_.name}="${_.value}"`).join(" "):"";l=`<${o.tagName}${p}>`,g||(c=`</${o.tagName}>`)}const d=document.createDocumentFragment(),u=r.parentElement.ownerDocument.createTextNode(l);d.appendChild(u);const h=c?r.parentElement.ownerDocument.createTextNode(c):void 0;for(;r.firstChild;)d.appendChild(r.firstChild);h&&d.appendChild(h),r.nodeType===Node.COMMENT_NODE?r.parentElement.insertBefore(d,r):r.parentElement.replaceChild(d,r)}})),n.add(lAe(i));try{return que(e,{...t,RETURN_TRUSTED_TYPE:!0})}finally{n.dispose()}}const T5e=["align","autoplay","alt","checked","class","colspan","controls","data-code","data-href","disabled","draggable","height","href","loop","muted","playsinline","poster","rowspan","src","style","target","title","type","width","start"];function N5e(s){const e=[gt.http,gt.https,gt.mailto,gt.data,gt.file,gt.vscodeFileResource,gt.vscodeRemote,gt.vscodeRemoteResource];return s.isTrusted&&e.push(gt.command),{config:{ALLOWED_TAGS:s.allowedTags??[...cAe],ALLOWED_ATTR:T5e,ALLOW_UNKNOWN_PROTOCOLS:!0},allowedSchemes:e}}function R5e(s){return typeof s=="string"?s:A5e(s)}function A5e(s,e){let t=s.value??"";t.length>1e5&&(t=`${t.substr(0,1e5)}…`);const i=Wfe(t,{async:!1,renderer:O5e.value}).replace(/&(#\d+|[a-zA-Z]+);/g,n=>P5e.get(n)??n);return U6({isTrusted:!1},i).toString()}const P5e=new Map([["&quot;",'"'],["&nbsp;"," "],["&amp;","&"],["&#39;","'"],["&lt;","<"],["&gt;",">"]]);function M5e(){const s=new Bfe;return s.code=({text:e})=>e,s.blockquote=({text:e})=>e+`
`,s.html=e=>"",s.heading=function({tokens:e}){return this.parser.parseInline(e)+`
`},s.hr=()=>"",s.list=function({items:e}){return e.map(t=>this.listitem(t)).join(`
`)+`
`},s.listitem=({text:e})=>e+`
`,s.paragraph=function({tokens:e}){return this.parser.parseInline(e)+`
`},s.table=function({header:e,rows:t}){return e.map(i=>this.tablecell(i)).join(" ")+`
`+t.map(i=>i.map(n=>this.tablecell(n)).join(" ")).join(`
`)+`
`},s.tablerow=({text:e})=>e,s.tablecell=function({tokens:e}){return this.parser.parseInline(e)},s.strong=({text:e})=>e,s.em=({text:e})=>e,s.codespan=({text:e})=>e,s.br=e=>`
`,s.del=({text:e})=>e,s.image=e=>"",s.text=({text:e})=>e,s.link=({text:e})=>e,s}const O5e=new uu(s=>M5e());function fA(s){let e="";return s.forEach(t=>{e+=t.raw}),e}function Hfe(s){var e,t;if(s.tokens)for(let i=s.tokens.length-1;i>=0;i--){const n=s.tokens[i];if(n.type==="text"){const r=n.raw.split(`
`),o=r[r.length-1];if(o.includes("`"))return U5e(s);if(o.includes("**"))return Q5e(s);if(o.match(/\*\w/))return j5e(s);if(o.match(/(^|\s)__\w/))return Y5e(s);if(o.match(/(^|\s)_\w/))return $5e(s);if(F5e(o)||V5e(o)&&s.tokens.slice(0,i).some(a=>a.type==="text"&&a.raw.match(/\[[^\]]*$/))){const a=s.tokens.slice(i+1);return((e=a[0])==null?void 0:e.type)==="link"&&((t=a[1])==null?void 0:t.type)==="text"&&a[1].raw.match(/^ *"[^"]*$/)||o.match(/^[^"]* +"[^"]*$/)?K5e(s):q5e(s)}else if(o.match(/(^|\s)\[\w*/))return G5e(s)}}}function F5e(s){return!!s.match(/(^|\s)\[.*\]\(\w*/)}function V5e(s){return!!s.match(/^[^\[]*\]\([^\)]*$/)}function B5e(s){var l;const e=s.items[s.items.length-1],t=e.tokens?e.tokens[e.tokens.length-1]:void 0;let i;if((t==null?void 0:t.type)==="text"&&!("inRawBlock"in e)&&(i=Hfe(t)),!i||i.type!=="paragraph")return;const n=fA(s.items.slice(0,-1)),r=(l=e.raw.match(/^(\s*(-|\d+\.|\*) +)/))==null?void 0:l[0];if(!r)return;const o=r+fA(e.tokens.slice(0,-1))+i.raw,a=AF(n+o)[0];if(a.type==="list")return a}const W5e=3;function H5e(s){for(let e=0;e<W5e;e++){const t=z5e(s);if(t)s=t;else break}return s}function z5e(s){let e,t;for(e=0;e<s.length;e++){const i=s[e];if(i.type==="paragraph"&&i.raw.match(/(\n|^)\|/)){t=X5e(s.slice(e));break}if(e===s.length-1&&i.type==="list"){const n=B5e(i);if(n){t=[n];break}}if(e===s.length-1&&i.type==="paragraph"){const n=Hfe(i);if(n){t=[n];break}}}if(t){const i=[...s.slice(0,e),...t];return i.links=s.links,i}return null}function U5e(s){return p_(s,"`")}function j5e(s){return p_(s,"*")}function $5e(s){return p_(s,"_")}function q5e(s){return p_(s,")")}function K5e(s){return p_(s,'")')}function G5e(s){return p_(s,"](https://microsoft.com)")}function Q5e(s){return p_(s,"**")}function Y5e(s){return p_(s,"__")}function p_(s,e){const t=fA(Array.isArray(s)?s:[s]);return AF(t+e)[0]}function X5e(s){const e=fA(s),t=e.split(`
`);let i,n=!1;for(let r=0;r<t.length;r++){const o=t[r].trim();if(typeof i>"u"&&o.match(/^\s*\|/)){const a=o.match(/(\|[^\|]+)(?=\||$)/g);a&&(i=a.length)}else if(typeof i=="number")if(o.match(/^\s*\|/)){if(r!==t.length-1)return;n=!0}else return}if(typeof i=="number"&&i>0){const r=n?t.slice(0,-1).join(`
`):e,o=!!r.match(/\|\s*$/),a=r+(o?"":"|")+`
|${" --- |".repeat(i)}`;return AF(a)}}function jie(s,e){return Kue(s,e),Ye(()=>Gue(s))}const kf=class kf{static createEmpty(e,t){const i=kf.defaultTokenMetadata,n=new Uint32Array(2);return n[0]=e.length,n[1]=i,new kf(n,e,t)}static createFromTextAndMetadata(e,t){let i=0,n="";const r=new Array;for(const{text:o,metadata:a}of e)r.push(i+o.length,a),i+=o.length,n+=o;return new kf(new Uint32Array(r),n,t)}constructor(e,t,i){this._lineTokensBrand=void 0,this._tokens=e,this._tokensCount=this._tokens.length>>>1,this._text=t,this.languageIdCodec=i}equals(e){return e instanceof kf?this.slicedEquals(e,0,this._tokensCount):!1}slicedEquals(e,t,i){if(this._text!==e._text||this._tokensCount!==e._tokensCount)return!1;const n=t<<1,r=n+(i<<1);for(let o=n;o<r;o++)if(this._tokens[o]!==e._tokens[o])return!1;return!0}getLineContent(){return this._text}getCount(){return this._tokensCount}getStartOffset(e){return e>0?this._tokens[e-1<<1]:0}getMetadata(e){return this._tokens[(e<<1)+1]}getLanguageId(e){const t=this._tokens[(e<<1)+1],i=Go.getLanguageId(t);return this.languageIdCodec.decodeLanguageId(i)}getStandardTokenType(e){const t=this._tokens[(e<<1)+1];return Go.getTokenType(t)}getForeground(e){const t=this._tokens[(e<<1)+1];return Go.getForeground(t)}getClassName(e){const t=this._tokens[(e<<1)+1];return Go.getClassNameFromMetadata(t)}getInlineStyle(e,t){const i=this._tokens[(e<<1)+1];return Go.getInlineStyleFromMetadata(i,t)}getPresentation(e){const t=this._tokens[(e<<1)+1];return Go.getPresentationFromMetadata(t)}getEndOffset(e){return this._tokens[e<<1]}findTokenIndexAtOffset(e){return kf.findIndexInTokensArray(this._tokens,e)}inflate(){return this}sliceAndInflate(e,t,i){return new IK(this,e,t,i)}static convertToEndOffset(e,t){const n=(e.length>>>1)-1;for(let r=0;r<n;r++)e[r<<1]=e[r+1<<1];e[n<<1]=t}static findIndexInTokensArray(e,t){if(e.length<=2)return 0;let i=0,n=(e.length>>>1)-1;for(;i<n;){const r=i+Math.floor((n-i)/2),o=e[r<<1];if(o===t)return r+1;o<t?i=r+1:o>t&&(n=r)}return i}withInserted(e){if(e.length===0)return this;let t=0,i=0,n="";const r=new Array;let o=0;for(;;){const a=t<this._tokensCount?this._tokens[t<<1]:-1,l=i<e.length?e[i]:null;if(a!==-1&&(l===null||a<=l.offset)){n+=this._text.substring(o,a);const c=this._tokens[(t<<1)+1];r.push(n.length,c),t++,o=a}else if(l){if(l.offset>o){n+=this._text.substring(o,l.offset);const c=this._tokens[(t<<1)+1];r.push(n.length,c),o=l.offset}n+=l.text,r.push(n.length,l.tokenMetadata),i++}else break}return new kf(new Uint32Array(r),n,this.languageIdCodec)}getTokenText(e){const t=this.getStartOffset(e),i=this.getEndOffset(e);return this._text.substring(t,i)}forEach(e){const t=this.getCount();for(let i=0;i<t;i++)e(i)}};kf.defaultTokenMetadata=(32768|2<<24)>>>0;let Ws=kf;class IK{constructor(e,t,i,n){this._source=e,this._startOffset=t,this._endOffset=i,this._deltaOffset=n,this._firstTokenIndex=e.findTokenIndexAtOffset(t),this.languageIdCodec=e.languageIdCodec,this._tokensCount=0;for(let r=this._firstTokenIndex,o=e.getCount();r<o&&!(e.getStartOffset(r)>=i);r++)this._tokensCount++}getMetadata(e){return this._source.getMetadata(this._firstTokenIndex+e)}getLanguageId(e){return this._source.getLanguageId(this._firstTokenIndex+e)}getLineContent(){return this._source.getLineContent().substring(this._startOffset,this._endOffset)}equals(e){return e instanceof IK?this._startOffset===e._startOffset&&this._endOffset===e._endOffset&&this._deltaOffset===e._deltaOffset&&this._source.slicedEquals(e._source,this._firstTokenIndex,this._tokensCount):!1}getCount(){return this._tokensCount}getStandardTokenType(e){return this._source.getStandardTokenType(this._firstTokenIndex+e)}getForeground(e){return this._source.getForeground(this._firstTokenIndex+e)}getEndOffset(e){const t=this._source.getEndOffset(this._firstTokenIndex+e);return Math.min(this._endOffset,t)-this._startOffset+this._deltaOffset}getClassName(e){return this._source.getClassName(this._firstTokenIndex+e)}getInlineStyle(e,t){return this._source.getInlineStyle(this._firstTokenIndex+e,t)}getPresentation(e){return this._source.getPresentation(this._firstTokenIndex+e)}findTokenIndexAtOffset(e){return this._source.findTokenIndexAtOffset(e+this._startOffset-this._deltaOffset)-this._firstTokenIndex}getTokenText(e){const t=this._firstTokenIndex+e,i=this._source.getStartOffset(t),n=this._source.getEndOffset(t);let r=this._source.getTokenText(t);return i<this._startOffset&&(r=r.substring(this._startOffset-i)),n>this._endOffset&&(r=r.substring(0,r.length-(n-this._endOffset))),r}forEach(e){for(let t=0;t<this.getCount();t++)e(t)}}function Z5e(s,e){const t=e.lineNumber;if(!s.tokenization.isCheapToTokenize(t))return;s.tokenization.forceTokenization(t);const i=s.tokenization.getLineTokens(t),n=i.findTokenIndexAtOffset(e.column-1);return i.getStandardTokenType(n)}const S1=new class{clone(){return this}equals(s){return this===s}};function EK(s,e){return new Iq([new Yk(0,"",s)],e)}function MF(s,e){const t=new Uint32Array(2);return t[0]=0,t[1]=(s<<0|0|0|32768|2<<24)>>>0,new X4(t,e===null?S1:e)}const $ie={getInitialState:()=>S1,tokenizeEncoded:(s,e,t)=>MF(0,t)};async function J5e(s,e,t){if(!t)return qie(e,s.languageIdCodec,$ie);const i=await Ln.getOrCreate(t);return qie(e,s.languageIdCodec,i||$ie)}function e3e(s,e,t,i,n,r,o){let a="<div>",l=i,c=0,d=!0;for(let u=0,h=e.getCount();u<h;u++){const g=e.getEndOffset(u);if(g<=i)continue;let p="";for(;l<g&&l<n;l++){const _=s.charCodeAt(l);switch(_){case 9:{let v=r-(l+c)%r;for(c+=v-1;v>0;)o&&d?(p+="&#160;",d=!1):(p+=" ",d=!0),v--;break}case 60:p+="&lt;",d=!1;break;case 62:p+="&gt;",d=!1;break;case 38:p+="&amp;",d=!1;break;case 0:p+="&#00;",d=!1;break;case 65279:case 8232:case 8233:case 133:p+="�",d=!1;break;case 13:p+="&#8203",d=!1;break;case 32:o&&d?(p+="&#160;",d=!1):(p+=" ",d=!0);break;default:p+=String.fromCharCode(_),d=!1}}if(a+=`<span style="${e.getInlineStyle(u,t)}">${p}</span>`,g>n||l>=n)break}return a+="</div>",a}function qie(s,e,t){let i='<div class="monaco-tokenized-source">';const n=Uh(s);let r=t.getInitialState();for(let o=0,a=n.length;o<a;o++){const l=n[o];o>0&&(i+="<br/>");const c=t.tokenizeEncoded(l,!0,r);Ws.convertToEndOffset(c.tokens,l.length);const u=new Ws(c.tokens,l,e).inflate();let h=0;for(let g=0,p=u.getCount();g<p;g++){const _=u.getClassName(g),v=u.getEndOffset(g);i+=`<span class="${_}">${DL(l.substring(h,v))}</span>`,h=v}r=c.endState}return i+="</div>",i}var t3e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Kie=function(s,e){return function(t,i){e(t,i,s)}},j6,av;let kg=(av=class{constructor(e,t,i){this._options=e,this._languageService=t,this._openerService=i,this._onDidRenderAsync=new Z,this.onDidRenderAsync=this._onDidRenderAsync.event}dispose(){this._onDidRenderAsync.dispose()}render(e,t,i){if(!e)return{element:document.createElement("span"),dispose:()=>{}};const n=new ce,r=n.add(PF(e,{...this._getRenderOptions(e,n),...t},i));return r.element.classList.add("rendered-markdown"),{element:r.element,dispose:()=>n.dispose()}}_getRenderOptions(e,t){return{codeBlockRenderer:async(i,n)=>{var l,c;let r;i?r=this._languageService.getLanguageIdByLanguageName(i):this._options.editor&&(r=(l=this._options.editor.getModel())==null?void 0:l.getLanguageId()),r||(r=So);const o=await J5e(this._languageService,n,r),a=document.createElement("span");if(a.innerHTML=((c=j6._ttpTokenizer)==null?void 0:c.createHTML(o))??o,this._options.editor){const d=this._options.editor.getOption(50);Zs(a,d)}else this._options.codeBlockFontFamily&&(a.style.fontFamily=this._options.codeBlockFontFamily);return this._options.codeBlockFontSize!==void 0&&(a.style.fontSize=this._options.codeBlockFontSize),a},asyncRenderCallback:()=>this._onDidRenderAsync.fire(),actionHandler:{callback:i=>DK(this._openerService,i,e.isTrusted),disposables:t}}}},j6=av,av._ttpTokenizer=Og("tokenizeToString",{createHTML(e){return e}}),av);kg=j6=t3e([Kie(1,un),Kie(2,la)],kg);async function DK(s,e,t){try{return await s.open(e,{fromUserGesture:!0,allowContributedOpeners:!0,allowCommands:i3e(t)})}catch(i){return ft(i),!1}}function i3e(s){return s===!0?!0:s&&Array.isArray(s.enabledCommands)?s.enabledCommands:!1}const Wa=Ht("accessibilityService"),XE=new Oe("accessibilityModeEnabled",!1),Gie=2e4;let wb,RR,$6,AR,q6;function n3e(s){wb=document.createElement("div"),wb.className="monaco-aria-container";const e=()=>{const i=document.createElement("div");return i.className="monaco-alert",i.setAttribute("role","alert"),i.setAttribute("aria-atomic","true"),wb.appendChild(i),i};RR=e(),$6=e();const t=()=>{const i=document.createElement("div");return i.className="monaco-status",i.setAttribute("aria-live","polite"),i.setAttribute("aria-atomic","true"),wb.appendChild(i),i};AR=t(),q6=t(),s.appendChild(wb)}function Eo(s){wb&&(RR.textContent!==s?(Ys($6),gA(RR,s)):(Ys(RR),gA($6,s)))}function Mh(s){wb&&(AR.textContent!==s?(Ys(q6),gA(AR,s)):(Ys(AR),gA(q6,s)))}function gA(s,e){Ys(s),e.length>Gie&&(e=e.substr(0,Gie)),s.textContent=e,s.style.visibility="hidden",s.style.visibility="visible"}var s3e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},kx=function(s,e){return function(t,i){e(t,i,s)}};const Fu=ke;let K6=class extends Vl{get _targetWindow(){return nt(this._target.targetElements[0])}get _targetDocumentElement(){return nt(this._target.targetElements[0]).document.documentElement}get isDisposed(){return this._isDisposed}get isMouseIn(){return this._lockMouseTracker.isMouseIn}get domNode(){return this._hover.containerDomNode}get onDispose(){return this._onDispose.event}get onRequestLayout(){return this._onRequestLayout.event}get anchor(){return this._hoverPosition===2?0:1}get x(){return this._x}get y(){return this._y}get isLocked(){return this._isLocked}set isLocked(e){this._isLocked!==e&&(this._isLocked=e,this._hoverContainer.classList.toggle("locked",this._isLocked))}constructor(e,t,i,n,r,o){var h,g,p,_,v,C,y;super(),this._keybindingService=t,this._configurationService=i,this._openerService=n,this._instantiationService=r,this._accessibilityService=o,this._messageListeners=new ce,this._isDisposed=!1,this._forcePosition=!1,this._x=0,this._y=0,this._isLocked=!1,this._enableFocusTraps=!1,this._addedFocusTrap=!1,this._onDispose=this._register(new Z),this._onRequestLayout=this._register(new Z),this._linkHandler=e.linkHandler||(x=>DK(this._openerService,x,au(e.content)?e.content.isTrusted:void 0)),this._target="targetElements"in e.target?e.target:new r3e(e.target),this._hoverPointer=(h=e.appearance)!=null&&h.showPointer?Fu("div.workbench-hover-pointer"):void 0,this._hover=this._register(new _K),this._hover.containerDomNode.classList.add("workbench-hover","fadeIn"),(g=e.appearance)!=null&&g.compact&&this._hover.containerDomNode.classList.add("workbench-hover","compact"),(p=e.appearance)!=null&&p.skipFadeInAnimation&&this._hover.containerDomNode.classList.add("skip-fade-in"),e.additionalClasses&&this._hover.containerDomNode.classList.add(...e.additionalClasses),(_=e.position)!=null&&_.forcePosition&&(this._forcePosition=!0),e.trapFocus&&(this._enableFocusTraps=!0),this._hoverPosition=((v=e.position)==null?void 0:v.hoverPosition)??3,this.onmousedown(this._hover.containerDomNode,x=>x.stopPropagation()),this.onkeydown(this._hover.containerDomNode,x=>{x.equals(9)&&this.dispose()}),this._register(oe(this._targetWindow,"blur",()=>this.dispose()));const a=Fu("div.hover-row.markdown-hover"),l=Fu("div.hover-contents");if(typeof e.content=="string")l.textContent=e.content,l.style.whiteSpace="pre-wrap";else if(Ls(e.content))l.appendChild(e.content),l.classList.add("html-hover-contents");else{const x=e.content,L=this._instantiationService.createInstance(kg,{codeBlockFontFamily:this._configurationService.getValue("editor").fontFamily||yo.fontFamily}),{element:I}=L.render(x,{actionHandler:{callback:A=>this._linkHandler(A),disposables:this._messageListeners},asyncRenderCallback:()=>{l.classList.add("code-hover-contents"),this.layout(),this._onRequestLayout.fire()}});l.appendChild(I)}if(a.appendChild(l),this._hover.contentsDomNode.appendChild(a),e.actions&&e.actions.length>0){const x=Fu("div.hover-row.status-bar"),L=Fu("div.actions");e.actions.forEach(I=>{const A=this._keybindingService.lookupKeybinding(I.commandId),D=A?A.getLabel():null;TF.render(L,{label:I.label,commandId:I.commandId,run:N=>{I.run(N),this.dispose()},iconClass:I.iconClass},D)}),x.appendChild(L),this._hover.containerDomNode.appendChild(x)}this._hoverContainer=Fu("div.workbench-hover-container"),this._hoverPointer&&this._hoverContainer.appendChild(this._hoverPointer),this._hoverContainer.appendChild(this._hover.containerDomNode);let c;if(e.actions&&e.actions.length>0?c=!1:((C=e.persistence)==null?void 0:C.hideOnHover)===void 0?c=typeof e.content=="string"||au(e.content)&&!e.content.value.includes("](")&&!e.content.value.includes("</a>"):c=e.persistence.hideOnHover,(y=e.appearance)!=null&&y.showHoverHint){const x=Fu("div.hover-row.status-bar"),L=Fu("div.info");L.textContent=b("hoverhint","Hold {0} key to mouse over",Wt?"Option":"Alt"),x.appendChild(L),this._hover.containerDomNode.appendChild(x)}const d=[...this._target.targetElements];c||d.push(this._hoverContainer);const u=this._register(new Qie(d));if(this._register(u.onMouseOut(()=>{this._isLocked||this.dispose()})),c){const x=[...this._target.targetElements,this._hoverContainer];this._lockMouseTracker=this._register(new Qie(x)),this._register(this._lockMouseTracker.onMouseOut(()=>{this._isLocked||this.dispose()}))}else this._lockMouseTracker=u}addFocusTrap(){if(!this._enableFocusTraps||this._addedFocusTrap)return;this._addedFocusTrap=!0;const e=this._hover.containerDomNode,t=this.findLastFocusableChild(this._hover.containerDomNode);if(t){const i=zq(this._hoverContainer,Fu("div")),n=me(this._hoverContainer,Fu("div"));i.tabIndex=0,n.tabIndex=0,this._register(oe(n,"focus",r=>{e.focus(),r.preventDefault()})),this._register(oe(i,"focus",r=>{t.focus(),r.preventDefault()}))}}findLastFocusableChild(e){if(e.hasChildNodes())for(let t=0;t<e.childNodes.length;t++){const i=e.childNodes.item(e.childNodes.length-t-1);if(i.nodeType===i.ELEMENT_NODE){const r=i;if(typeof r.tabIndex=="number"&&r.tabIndex>=0)return r}const n=this.findLastFocusableChild(i);if(n)return n}}render(e){var n;e.appendChild(this._hoverContainer);const i=this._hoverContainer.contains(this._hoverContainer.ownerDocument.activeElement)&&xfe(this._configurationService.getValue("accessibility.verbosity.hover")===!0&&this._accessibilityService.isScreenReaderOptimized(),(n=this._keybindingService.lookupKeybinding("editor.action.accessibleView"))==null?void 0:n.getAriaLabel());i&&Mh(i),this.layout(),this.addFocusTrap()}layout(){this._hover.containerDomNode.classList.remove("right-aligned"),this._hover.contentsDomNode.style.maxHeight="";const e=d=>{const u=Jue(d),h=d.getBoundingClientRect();return{top:h.top*u,bottom:h.bottom*u,right:h.right*u,left:h.left*u}},t=this._target.targetElements.map(d=>e(d)),{top:i,right:n,bottom:r,left:o}=t[0],a=n-o,l=r-i,c={top:i,right:n,bottom:r,left:o,width:a,height:l,center:{x:o+a/2,y:i+l/2}};if(this.adjustHorizontalHoverPosition(c),this.adjustVerticalHoverPosition(c),this.adjustHoverMaxHeight(c),this._hoverContainer.style.padding="",this._hoverContainer.style.margin="",this._hoverPointer){switch(this._hoverPosition){case 1:c.left+=3,c.right+=3,this._hoverContainer.style.paddingLeft="3px",this._hoverContainer.style.marginLeft="-3px";break;case 0:c.left-=3,c.right-=3,this._hoverContainer.style.paddingRight="3px",this._hoverContainer.style.marginRight="-3px";break;case 2:c.top+=3,c.bottom+=3,this._hoverContainer.style.paddingTop="3px",this._hoverContainer.style.marginTop="-3px";break;case 3:c.top-=3,c.bottom-=3,this._hoverContainer.style.paddingBottom="3px",this._hoverContainer.style.marginBottom="-3px";break}c.center.x=c.left+a/2,c.center.y=c.top+l/2}this.computeXCordinate(c),this.computeYCordinate(c),this._hoverPointer&&(this._hoverPointer.classList.remove("top"),this._hoverPointer.classList.remove("left"),this._hoverPointer.classList.remove("right"),this._hoverPointer.classList.remove("bottom"),this.setHoverPointerPosition(c)),this._hover.onContentsChanged()}computeXCordinate(e){const t=this._hover.containerDomNode.clientWidth+2;this._target.x!==void 0?this._x=this._target.x:this._hoverPosition===1?this._x=e.right:this._hoverPosition===0?this._x=e.left-t:(this._hoverPointer?this._x=e.center.x-this._hover.containerDomNode.clientWidth/2:this._x=e.left,this._x+t>=this._targetDocumentElement.clientWidth&&(this._hover.containerDomNode.classList.add("right-aligned"),this._x=Math.max(this._targetDocumentElement.clientWidth-t-2,this._targetDocumentElement.clientLeft))),this._x<this._targetDocumentElement.clientLeft&&(this._x=e.left+2)}computeYCordinate(e){this._target.y!==void 0?this._y=this._target.y:this._hoverPosition===3?this._y=e.top:this._hoverPosition===2?this._y=e.bottom-2:this._hoverPointer?this._y=e.center.y+this._hover.containerDomNode.clientHeight/2:this._y=e.bottom,this._y>this._targetWindow.innerHeight&&(this._y=e.bottom)}adjustHorizontalHoverPosition(e){if(this._target.x!==void 0)return;const t=this._hoverPointer?3:0;if(this._forcePosition){const i=t+2;this._hoverPosition===1?this._hover.containerDomNode.style.maxWidth=`${this._targetDocumentElement.clientWidth-e.right-i}px`:this._hoverPosition===0&&(this._hover.containerDomNode.style.maxWidth=`${e.left-i}px`);return}this._hoverPosition===1?this._targetDocumentElement.clientWidth-e.right<this._hover.containerDomNode.clientWidth+t&&(e.left>=this._hover.containerDomNode.clientWidth+t?this._hoverPosition=0:this._hoverPosition=2):this._hoverPosition===0&&(e.left<this._hover.containerDomNode.clientWidth+t&&(this._targetDocumentElement.clientWidth-e.right>=this._hover.containerDomNode.clientWidth+t?this._hoverPosition=1:this._hoverPosition=2),e.left-this._hover.containerDomNode.clientWidth-t<=this._targetDocumentElement.clientLeft&&(this._hoverPosition=1))}adjustVerticalHoverPosition(e){if(this._target.y!==void 0||this._forcePosition)return;const t=this._hoverPointer?3:0;this._hoverPosition===3?e.top-this._hover.containerDomNode.clientHeight-t<0&&(this._hoverPosition=2):this._hoverPosition===2&&e.bottom+this._hover.containerDomNode.clientHeight+t>this._targetWindow.innerHeight&&(this._hoverPosition=3)}adjustHoverMaxHeight(e){let t=this._targetWindow.innerHeight/2;if(this._forcePosition){const i=(this._hoverPointer?3:0)+2;this._hoverPosition===3?t=Math.min(t,e.top-i):this._hoverPosition===2&&(t=Math.min(t,this._targetWindow.innerHeight-e.bottom-i))}if(this._hover.containerDomNode.style.maxHeight=`${t}px`,this._hover.contentsDomNode.clientHeight<this._hover.contentsDomNode.scrollHeight){const i=`${this._hover.scrollbar.options.verticalScrollbarSize}px`;this._hover.contentsDomNode.style.paddingRight!==i&&(this._hover.contentsDomNode.style.paddingRight=i)}}setHoverPointerPosition(e){if(this._hoverPointer)switch(this._hoverPosition){case 0:case 1:{this._hoverPointer.classList.add(this._hoverPosition===0?"right":"left");const t=this._hover.containerDomNode.clientHeight;t>e.height?this._hoverPointer.style.top=`${e.center.y-(this._y-t)-3}px`:this._hoverPointer.style.top=`${Math.round(t/2)-3}px`;break}case 3:case 2:{this._hoverPointer.classList.add(this._hoverPosition===3?"bottom":"top");const t=this._hover.containerDomNode.clientWidth;let i=Math.round(t/2)-3;const n=this._x+i;(n<e.left||n>e.right)&&(i=e.center.x-this._x-3),this._hoverPointer.style.left=`${i}px`;break}}}focus(){this._hover.containerDomNode.focus()}dispose(){this._isDisposed||(this._onDispose.fire(),this._hoverContainer.remove(),this._messageListeners.dispose(),this._target.dispose(),super.dispose()),this._isDisposed=!0}};K6=s3e([kx(1,pi),kx(2,At),kx(3,la),kx(4,Xe),kx(5,Wa)],K6);class Qie extends Vl{get onMouseOut(){return this._onMouseOut.event}get isMouseIn(){return this._isMouseIn}constructor(e){super(),this._elements=e,this._isMouseIn=!0,this._onMouseOut=this._register(new Z),this._elements.forEach(t=>this.onmouseover(t,()=>this._onTargetMouseOver(t))),this._elements.forEach(t=>this.onmouseleave(t,()=>this._onTargetMouseLeave(t)))}_onTargetMouseOver(e){this._isMouseIn=!0,this._clearEvaluateMouseStateTimeout(e)}_onTargetMouseLeave(e){this._isMouseIn=!1,this._evaluateMouseState(e)}_evaluateMouseState(e){this._clearEvaluateMouseStateTimeout(e),this._mouseTimeout=nt(e).setTimeout(()=>this._fireIfMouseOutside(),0)}_clearEvaluateMouseStateTimeout(e){this._mouseTimeout&&(nt(e).clearTimeout(this._mouseTimeout),this._mouseTimeout=void 0)}_fireIfMouseOutside(){this._isMouseIn||this._onMouseOut.fire()}}class r3e{constructor(e){this._element=e,this.targetElements=[this._element]}dispose(){}}var yr;(function(s){function e(r,o){if(r.start>=o.end||o.start>=r.end)return{start:0,end:0};const a=Math.max(r.start,o.start),l=Math.min(r.end,o.end);return l-a<=0?{start:0,end:0}:{start:a,end:l}}s.intersect=e;function t(r){return r.end-r.start<=0}s.isEmpty=t;function i(r,o){return!t(e(r,o))}s.intersects=i;function n(r,o){const a=[],l={start:r.start,end:Math.min(o.start,r.end)},c={start:Math.max(o.end,r.start),end:r.end};return t(l)||a.push(l),t(c)||a.push(c),a}s.relativeComplement=n})(yr||(yr={}));function o3e(s){const e=s;return!!e&&typeof e.x=="number"&&typeof e.y=="number"}var qp;(function(s){s[s.AVOID=0]="AVOID",s[s.ALIGN=1]="ALIGN"})(qp||(qp={}));function EC(s,e,t){const i=t.mode===qp.ALIGN?t.offset:t.offset+t.size,n=t.mode===qp.ALIGN?t.offset+t.size:t.offset;return t.position===0?e<=s-i?i:e<=n?n-e:Math.max(s-e,0):e<=n?n-e:e<=s-i?i:0}const JC=class JC extends te{constructor(e,t){super(),this.container=null,this.useFixedPosition=!1,this.useShadowDOM=!1,this.delegate=null,this.toDisposeOnClean=te.None,this.toDisposeOnSetContainer=te.None,this.shadowRoot=null,this.shadowRootHostElement=null,this.view=ke(".context-view"),fo(this.view),this.setContainer(e,t),this._register(Ye(()=>this.setContainer(null,1)))}setContainer(e,t){var n;this.useFixedPosition=t!==1;const i=this.useShadowDOM;if(this.useShadowDOM=t===3,!(e===this.container&&i===this.useShadowDOM)&&(this.container&&(this.toDisposeOnSetContainer.dispose(),this.view.remove(),this.shadowRoot&&(this.shadowRoot=null,(n=this.shadowRootHostElement)==null||n.remove(),this.shadowRootHostElement=null),this.container=null),e)){if(this.container=e,this.useShadowDOM){this.shadowRootHostElement=ke(".shadow-root-host"),this.container.appendChild(this.shadowRootHostElement),this.shadowRoot=this.shadowRootHostElement.attachShadow({mode:"open"});const o=document.createElement("style");o.textContent=a3e,this.shadowRoot.appendChild(o),this.shadowRoot.appendChild(this.view),this.shadowRoot.appendChild(ke("slot"))}else this.container.appendChild(this.view);const r=new ce;JC.BUBBLE_UP_EVENTS.forEach(o=>{r.add(yn(this.container,o,a=>{this.onDOMEvent(a,!1)}))}),JC.BUBBLE_DOWN_EVENTS.forEach(o=>{r.add(yn(this.container,o,a=>{this.onDOMEvent(a,!0)},!0))}),this.toDisposeOnSetContainer=r}}show(e){var t,i;this.isVisible()&&this.hide(),Ys(this.view),this.view.className="context-view monaco-component",this.view.style.top="0px",this.view.style.left="0px",this.view.style.zIndex=`${2575+(e.layer??0)}`,this.view.style.position=this.useFixedPosition?"fixed":"absolute",ka(this.view),this.toDisposeOnClean=e.render(this.view)||te.None,this.delegate=e,this.doLayout(),(i=(t=this.delegate).focus)==null||i.call(t)}getViewElement(){return this.view}layout(){var e,t;if(this.isVisible()){if(this.delegate.canRelayout===!1&&!(du&&Mq.pointerEvents)){this.hide();return}(t=(e=this.delegate)==null?void 0:e.layout)==null||t.call(e),this.doLayout()}}doLayout(){if(!this.isVisible())return;const e=this.delegate.getAnchor();let t;if(Ls(e)){const h=Pn(e),g=Jue(e);t={top:h.top*g,left:h.left*g,width:h.width*g,height:h.height*g}}else o3e(e)?t={top:e.y,left:e.x,width:e.width||1,height:e.height||2}:t={top:e.posy,left:e.posx,width:2,height:2};const i=ya(this.view),n=$f(this.view),r=this.delegate.anchorPosition||0,o=this.delegate.anchorAlignment||0,a=this.delegate.anchorAxisAlignment||0;let l,c;const d=Zx();if(a===0){const h={offset:t.top-d.pageYOffset,size:t.height,position:r===0?0:1},g={offset:t.left,size:t.width,position:o===0?0:1,mode:qp.ALIGN};l=EC(d.innerHeight,n,h)+d.pageYOffset,yr.intersects({start:l,end:l+n},{start:h.offset,end:h.offset+h.size})&&(g.mode=qp.AVOID),c=EC(d.innerWidth,i,g)}else{const h={offset:t.left,size:t.width,position:o===0?0:1},g={offset:t.top,size:t.height,position:r===0?0:1,mode:qp.ALIGN};c=EC(d.innerWidth,i,h),yr.intersects({start:c,end:c+i},{start:h.offset,end:h.offset+h.size})&&(g.mode=qp.AVOID),l=EC(d.innerHeight,n,g)+d.pageYOffset}this.view.classList.remove("top","bottom","left","right"),this.view.classList.add(r===0?"bottom":"top"),this.view.classList.add(o===0?"left":"right"),this.view.classList.toggle("fixed",this.useFixedPosition);const u=Pn(this.container);this.view.style.top=`${l-(this.useFixedPosition?Pn(this.view).top:u.top)}px`,this.view.style.left=`${c-(this.useFixedPosition?Pn(this.view).left:u.left)}px`,this.view.style.width="initial"}hide(e){const t=this.delegate;this.delegate=null,t!=null&&t.onHide&&t.onHide(e),this.toDisposeOnClean.dispose(),fo(this.view)}isVisible(){return!!this.delegate}onDOMEvent(e,t){this.delegate&&(this.delegate.onDOMEvent?this.delegate.onDOMEvent(e,nt(e).document.activeElement):t&&!ys(e.target,this.container)&&this.hide())}dispose(){this.hide(),super.dispose()}};JC.BUBBLE_UP_EVENTS=["click","keydown","focus","blur"],JC.BUBBLE_DOWN_EVENTS=["click"];let G6=JC;const a3e=`
	:host {
		all: initial; /* 1st rule so subsequent properties are reset. */
	}

	.codicon[class*='codicon-'] {
		font: normal normal normal 16px/1 codicon;
		display: inline-block;
		text-decoration: none;
		text-rendering: auto;
		text-align: center;
		-webkit-font-smoothing: antialiased;
		-moz-osx-font-smoothing: grayscale;
		user-select: none;
		-webkit-user-select: none;
		-ms-user-select: none;
	}

	:host {
		font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "HelveticaNeue-Light", system-ui, "Ubuntu", "Droid Sans", sans-serif;
	}

	:host-context(.mac) { font-family: -apple-system, BlinkMacSystemFont, sans-serif; }
	:host-context(.mac:lang(zh-Hans)) { font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", "Hiragino Sans GB", sans-serif; }
	:host-context(.mac:lang(zh-Hant)) { font-family: -apple-system, BlinkMacSystemFont, "PingFang TC", sans-serif; }
	:host-context(.mac:lang(ja)) { font-family: -apple-system, BlinkMacSystemFont, "Hiragino Kaku Gothic Pro", sans-serif; }
	:host-context(.mac:lang(ko)) { font-family: -apple-system, BlinkMacSystemFont, "Nanum Gothic", "Apple SD Gothic Neo", "AppleGothic", sans-serif; }

	:host-context(.windows) { font-family: "Segoe WPC", "Segoe UI", sans-serif; }
	:host-context(.windows:lang(zh-Hans)) { font-family: "Segoe WPC", "Segoe UI", "Microsoft YaHei", sans-serif; }
	:host-context(.windows:lang(zh-Hant)) { font-family: "Segoe WPC", "Segoe UI", "Microsoft Jhenghei", sans-serif; }
	:host-context(.windows:lang(ja)) { font-family: "Segoe WPC", "Segoe UI", "Yu Gothic UI", "Meiryo UI", sans-serif; }
	:host-context(.windows:lang(ko)) { font-family: "Segoe WPC", "Segoe UI", "Malgun Gothic", "Dotom", sans-serif; }

	:host-context(.linux) { font-family: system-ui, "Ubuntu", "Droid Sans", sans-serif; }
	:host-context(.linux:lang(zh-Hans)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans SC", "Source Han Sans CN", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(zh-Hant)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans TC", "Source Han Sans TW", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(ja)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans J", "Source Han Sans JP", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(ko)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans K", "Source Han Sans JR", "Source Han Sans", "UnDotum", "FBaekmuk Gulim", sans-serif; }
`;var l3e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},c3e=function(s,e){return function(t,i){e(t,i,s)}};let pA=class extends te{constructor(e){super(),this.layoutService=e,this.contextView=this._register(new G6(this.layoutService.mainContainer,1)),this.layout(),this._register(e.onDidLayoutContainer(()=>this.layout()))}showContextView(e,t,i){let n;t?t===this.layoutService.getContainer(nt(t))?n=1:i?n=3:n=2:n=1,this.contextView.setContainer(t??this.layoutService.activeContainer,n),this.contextView.show(e);const r={close:()=>{this.openContextView===r&&this.hideContextView()}};return this.openContextView=r,r}layout(){this.contextView.layout()}hideContextView(e){this.contextView.hide(e),this.openContextView=void 0}};pA=l3e([c3e(0,g_)],pA);class d3e extends pA{getContextViewElement(){return this.contextView.getViewElement()}}class u3e{constructor(e,t,i){this.hoverDelegate=e,this.target=t,this.fadeInAnimation=i}async update(e,t,i){if(this._cancellationTokenSource&&(this._cancellationTokenSource.dispose(!0),this._cancellationTokenSource=void 0),this.isDisposed)return;let n;if(e===void 0||Zo(e)||Ls(e))n=e;else if(!Kk(e.markdown))n=e.markdown??e.markdownNotSupportedFallback;else{this._hoverWidget||this.show(b("iconLabel.loading","Loading..."),t,i),this._cancellationTokenSource=new mn;const r=this._cancellationTokenSource.token;if(n=await e.markdown(r),n===void 0&&(n=e.markdownNotSupportedFallback),this.isDisposed||r.isCancellationRequested)return}this.show(n,t,i)}show(e,t,i){var r;const n=this._hoverWidget;if(this.hasContent(e)){const o={content:e,target:this.target,actions:i==null?void 0:i.actions,linkHandler:i==null?void 0:i.linkHandler,trapFocus:i==null?void 0:i.trapFocus,appearance:{showPointer:this.hoverDelegate.placement==="element",skipFadeInAnimation:!this.fadeInAnimation||!!n,showHoverHint:(r=i==null?void 0:i.appearance)==null?void 0:r.showHoverHint},position:{hoverPosition:2}};this._hoverWidget=this.hoverDelegate.showHover(o,t)}n==null||n.dispose()}hasContent(e){return e?au(e)?!!e.value:!0:!1}get isDisposed(){var e;return(e=this._hoverWidget)==null?void 0:e.isDisposed}dispose(){var e,t;(e=this._hoverWidget)==null||e.dispose(),(t=this._cancellationTokenSource)==null||t.dispose(!0),this._cancellationTokenSource=void 0}}var h3e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Ix=function(s,e){return function(t,i){e(t,i,s)}};let Q6=class extends te{constructor(e,t,i,n,r){super(),this._instantiationService=e,this._keybindingService=i,this._layoutService=n,this._accessibilityService=r,this._managedHovers=new Map,t.onDidShowContextMenu(()=>this.hideHover()),this._contextViewHandler=this._register(new pA(this._layoutService))}showHover(e,t,i){var l,c,d,u;if(Yie(this._currentHoverOptions)===Yie(e)||this._currentHover&&((c=(l=this._currentHoverOptions)==null?void 0:l.persistence)!=null&&c.sticky))return;this._currentHoverOptions=e,this._lastHoverOptions=e;const n=e.trapFocus||this._accessibilityService.isScreenReaderOptimized(),r=hr();i||(n&&r?r.classList.contains("monaco-hover")||(this._lastFocusedElementBeforeOpen=r):this._lastFocusedElementBeforeOpen=void 0);const o=new ce,a=this._instantiationService.createInstance(K6,e);if((d=e.persistence)!=null&&d.sticky&&(a.isLocked=!0),a.onDispose(()=>{var g,p;((g=this._currentHover)==null?void 0:g.domNode)&&the(this._currentHover.domNode)&&((p=this._lastFocusedElementBeforeOpen)==null||p.focus()),this._currentHoverOptions===e&&(this._currentHoverOptions=void 0),o.dispose()},void 0,o),!e.container){const h=Ls(e.target)?e.target:e.target.targetElements[0];e.container=this._layoutService.getContainer(nt(h))}if(this._contextViewHandler.showContextView(new f3e(a,t),e.container),a.onRequestLayout(()=>this._contextViewHandler.layout(),void 0,o),(u=e.persistence)!=null&&u.sticky)o.add(oe(nt(e.container).document,Le.MOUSE_DOWN,h=>{ys(h.target,a.domNode)||this.doHideHover()}));else{if("targetElements"in e.target)for(const g of e.target.targetElements)o.add(oe(g,Le.CLICK,()=>this.hideHover()));else o.add(oe(e.target,Le.CLICK,()=>this.hideHover()));const h=hr();if(h){const g=nt(h).document;o.add(oe(h,Le.KEY_DOWN,p=>{var _;return this._keyDown(p,a,!!((_=e.persistence)!=null&&_.hideOnKeyDown))})),o.add(oe(g,Le.KEY_DOWN,p=>{var _;return this._keyDown(p,a,!!((_=e.persistence)!=null&&_.hideOnKeyDown))})),o.add(oe(h,Le.KEY_UP,p=>this._keyUp(p,a))),o.add(oe(g,Le.KEY_UP,p=>this._keyUp(p,a)))}}if("IntersectionObserver"in Ri){const h=new IntersectionObserver(p=>this._intersectionChange(p,a),{threshold:0}),g="targetElements"in e.target?e.target.targetElements[0]:e.target;h.observe(g),o.add(Ye(()=>h.disconnect()))}return this._currentHover=a,a}hideHover(){var e;(e=this._currentHover)!=null&&e.isLocked||!this._currentHoverOptions||this.doHideHover()}doHideHover(){this._currentHover=void 0,this._currentHoverOptions=void 0,this._contextViewHandler.hideContextView()}_intersectionChange(e,t){e[e.length-1].isIntersecting||t.dispose()}showAndFocusLastHover(){this._lastHoverOptions&&this.showHover(this._lastHoverOptions,!0,!0)}_keyDown(e,t,i){var o,a;if(e.key==="Alt"){t.isLocked=!0;return}const n=new Mi(e);this._keybindingService.resolveKeyboardEvent(n).getSingleModifierDispatchChords().some(l=>!!l)||this._keybindingService.softDispatch(n,n.target).kind!==0||i&&(!((o=this._currentHoverOptions)!=null&&o.trapFocus)||e.key!=="Tab")&&(this.hideHover(),(a=this._lastFocusedElementBeforeOpen)==null||a.focus())}_keyUp(e,t){var i;e.key==="Alt"&&(t.isLocked=!1,t.isMouseIn||(this.hideHover(),(i=this._lastFocusedElementBeforeOpen)==null||i.focus()))}setupManagedHover(e,t,i,n){t.setAttribute("custom-hover","true"),t.title!==""&&(console.warn("HTML element already has a title attribute, which will conflict with the custom hover. Please remove the title attribute."),console.trace("Stack trace:",t.title),t.title="");let r,o;const a=(x,L)=>{var A;const I=o!==void 0;x&&(o==null||o.dispose(),o=void 0),L&&(r==null||r.dispose(),r=void 0),I&&((A=e.onDidHideHover)==null||A.call(e),o=void 0)},l=(x,L,I,A)=>new gd(async()=>{(!o||o.isDisposed)&&(o=new u3e(e,I||t,x>0),await o.update(typeof i=="function"?i():i,L,{...n,trapFocus:A}))},x);let c=!1;const d=oe(t,Le.MOUSE_DOWN,()=>{c=!0,a(!0,!0)},!0),u=oe(t,Le.MOUSE_UP,()=>{c=!1},!0),h=oe(t,Le.MOUSE_LEAVE,x=>{c=!1,a(!1,x.fromElement===t)},!0),g=x=>{if(r)return;const L=new ce,I={targetElements:[t],dispose:()=>{}};if(e.placement===void 0||e.placement==="mouse"){const A=D=>{I.x=D.x+10,Ls(D.target)&&Xie(D.target,t)!==t&&a(!0,!0)};L.add(oe(t,Le.MOUSE_MOVE,A,!0))}r=L,!(Ls(x.target)&&Xie(x.target,t)!==t)&&L.add(l(e.delay,!1,I))},p=oe(t,Le.MOUSE_OVER,g,!0),_=()=>{if(c||r)return;const x={targetElements:[t],dispose:()=>{}},L=new ce,I=()=>a(!0,!0);L.add(oe(t,Le.BLUR,I,!0)),L.add(l(e.delay,!1,x)),r=L};let v;const C=t.tagName.toLowerCase();C!=="input"&&C!=="textarea"&&(v=oe(t,Le.FOCUS,_,!0));const y={show:x=>{a(!1,!0),l(0,x,void 0,x)},hide:()=>{a(!0,!0)},update:async(x,L)=>{i=x,await(o==null?void 0:o.update(i,void 0,L))},dispose:()=>{this._managedHovers.delete(t),p.dispose(),h.dispose(),d.dispose(),u.dispose(),v==null||v.dispose(),a(!0,!0)}};return this._managedHovers.set(t,y),y}showManagedHover(e){const t=this._managedHovers.get(e);t&&t.show(!0)}dispose(){this._managedHovers.forEach(e=>e.dispose()),super.dispose()}};Q6=h3e([Ix(0,Xe),Ix(1,Ba),Ix(2,pi),Ix(3,g_),Ix(4,Wa)],Q6);function Yie(s){if(s!==void 0)return(s==null?void 0:s.id)??s}class f3e{get anchorPosition(){return this._hover.anchor}constructor(e,t=!1){this._hover=e,this._focus=t,this.layer=1}render(e){return this._hover.render(e),this._focus&&this._hover.focus(),this._hover}getAnchor(){return{x:this._hover.x,y:this._hover.y}}layout(){this._hover.layout()}}function Xie(s,e){for(e=e??nt(s).document.body;!s.hasAttribute("custom-hover")&&s!==e;)s=s.parentElement;return s}qt(Kh,Q6,1);Lc((s,e)=>{const t=s.getColor(dfe);t&&(e.addRule(`.monaco-workbench .workbench-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${t.transparent(.5)}; }`),e.addRule(`.monaco-workbench .workbench-hover hr { border-top: 1px solid ${t.transparent(.5)}; }`))});const ZE=Ht("IWorkspaceEditService");class TK{constructor(e){this.metadata=e}static convert(e){return e.edits.map(t=>{if(um.is(t))return um.lift(t);if(wy.is(t))return wy.lift(t);throw new Error("Unsupported edit")})}}class um extends TK{static is(e){return e instanceof um?!0:Ms(e)&&Je.isUri(e.resource)&&Ms(e.textEdit)}static lift(e){return e instanceof um?e:new um(e.resource,e.textEdit,e.versionId,e.metadata)}constructor(e,t,i=void 0,n){super(n),this.resource=e,this.textEdit=t,this.versionId=i}}class wy extends TK{static is(e){return e instanceof wy?!0:Ms(e)&&(!!e.newResource||!!e.oldResource)}static lift(e){return e instanceof wy?e:new wy(e.oldResource,e.newResource,e.options,e.metadata)}constructor(e,t,i={},n){super(n),this.oldResource=e,this.newResource=t,this.options=i}}const ir={enableSplitViewResizing:!0,renderSideBySide:!0,renderMarginRevertIcon:!0,renderGutterMenu:!0,maxComputationTime:5e3,maxFileSize:50,ignoreTrimWhitespace:!0,renderIndicators:!0,originalEditable:!1,diffCodeLens:!1,renderOverviewRuler:!0,diffWordWrap:"inherit",diffAlgorithm:"advanced",accessibilityVerbose:!1,experimental:{showMoves:!1,showEmptyDecorations:!0,useTrueInlineView:!1},hideUnchangedRegions:{enabled:!1,contextLineCount:3,minimumLineCount:3,revealLineCount:20},isInEmbeddedEditor:!1,onlyShowAccessibleDiffViewer:!1,renderSideBySideInlineBreakpoint:900,useInlineViewWhenSpaceIsLimited:!0,compactMode:!1},JE=Object.freeze({id:"editor",order:5,type:"object",title:b("editorConfigurationTitle","Editor"),scope:5}),mA={...JE,properties:{"editor.tabSize":{type:"number",default:xr.tabSize,minimum:1,markdownDescription:b("tabSize","The number of spaces a tab is equal to. This setting is overridden based on the file contents when {0} is on.","`#editor.detectIndentation#`")},"editor.indentSize":{anyOf:[{type:"string",enum:["tabSize"]},{type:"number",minimum:1}],default:"tabSize",markdownDescription:b("indentSize",'The number of spaces used for indentation or `"tabSize"` to use the value from `#editor.tabSize#`. This setting is overridden based on the file contents when `#editor.detectIndentation#` is on.')},"editor.insertSpaces":{type:"boolean",default:xr.insertSpaces,markdownDescription:b("insertSpaces","Insert spaces when pressing `Tab`. This setting is overridden based on the file contents when {0} is on.","`#editor.detectIndentation#`")},"editor.detectIndentation":{type:"boolean",default:xr.detectIndentation,markdownDescription:b("detectIndentation","Controls whether {0} and {1} will be automatically detected when a file is opened based on the file contents.","`#editor.tabSize#`","`#editor.insertSpaces#`")},"editor.trimAutoWhitespace":{type:"boolean",default:xr.trimAutoWhitespace,description:b("trimAutoWhitespace","Remove trailing auto inserted whitespace.")},"editor.largeFileOptimizations":{type:"boolean",default:xr.largeFileOptimizations,description:b("largeFileOptimizations","Special handling for large files to disable certain memory intensive features.")},"editor.wordBasedSuggestions":{enum:["off","currentDocument","matchingDocuments","allDocuments"],default:"matchingDocuments",enumDescriptions:[b("wordBasedSuggestions.off","Turn off Word Based Suggestions."),b("wordBasedSuggestions.currentDocument","Only suggest words from the active document."),b("wordBasedSuggestions.matchingDocuments","Suggest words from all open documents of the same language."),b("wordBasedSuggestions.allDocuments","Suggest words from all open documents.")],description:b("wordBasedSuggestions","Controls whether completions should be computed based on words in the document and from which documents they are computed.")},"editor.semanticHighlighting.enabled":{enum:[!0,!1,"configuredByTheme"],enumDescriptions:[b("semanticHighlighting.true","Semantic highlighting enabled for all color themes."),b("semanticHighlighting.false","Semantic highlighting disabled for all color themes."),b("semanticHighlighting.configuredByTheme","Semantic highlighting is configured by the current color theme's `semanticHighlighting` setting.")],default:"configuredByTheme",description:b("semanticHighlighting.enabled","Controls whether the semanticHighlighting is shown for the languages that support it.")},"editor.stablePeek":{type:"boolean",default:!1,markdownDescription:b("stablePeek","Keep peek editors open even when double-clicking their content or when hitting `Escape`.")},"editor.maxTokenizationLineLength":{type:"integer",default:2e4,description:b("maxTokenizationLineLength","Lines above this length will not be tokenized for performance reasons")},"editor.experimental.asyncTokenization":{type:"boolean",default:!0,description:b("editor.experimental.asyncTokenization","Controls whether the tokenization should happen asynchronously on a web worker."),tags:["experimental"]},"editor.experimental.asyncTokenizationLogging":{type:"boolean",default:!1,description:b("editor.experimental.asyncTokenizationLogging","Controls whether async tokenization should be logged. For debugging only.")},"editor.experimental.asyncTokenizationVerification":{type:"boolean",default:!1,description:b("editor.experimental.asyncTokenizationVerification","Controls whether async tokenization should be verified against legacy background tokenization. Might slow down tokenization. For debugging only."),tags:["experimental"]},"editor.experimental.treeSitterTelemetry":{type:"boolean",default:!1,markdownDescription:b("editor.experimental.treeSitterTelemetry","Controls whether tree sitter parsing should be turned on and telemetry collected. Setting `editor.experimental.preferTreeSitter` for specific languages will take precedence."),tags:["experimental"]},"editor.language.brackets":{type:["array","null"],default:null,description:b("schema.brackets","Defines the bracket symbols that increase or decrease the indentation."),items:{type:"array",items:[{type:"string",description:b("schema.openBracket","The opening bracket character or string sequence.")},{type:"string",description:b("schema.closeBracket","The closing bracket character or string sequence.")}]}},"editor.language.colorizedBracketPairs":{type:["array","null"],default:null,description:b("schema.colorizedBracketPairs","Defines the bracket pairs that are colorized by their nesting level if bracket pair colorization is enabled."),items:{type:"array",items:[{type:"string",description:b("schema.openBracket","The opening bracket character or string sequence.")},{type:"string",description:b("schema.closeBracket","The closing bracket character or string sequence.")}]}},"diffEditor.maxComputationTime":{type:"number",default:ir.maxComputationTime,description:b("maxComputationTime","Timeout in milliseconds after which diff computation is cancelled. Use 0 for no timeout.")},"diffEditor.maxFileSize":{type:"number",default:ir.maxFileSize,description:b("maxFileSize","Maximum file size in MB for which to compute diffs. Use 0 for no limit.")},"diffEditor.renderSideBySide":{type:"boolean",default:ir.renderSideBySide,description:b("sideBySide","Controls whether the diff editor shows the diff side by side or inline.")},"diffEditor.renderSideBySideInlineBreakpoint":{type:"number",default:ir.renderSideBySideInlineBreakpoint,description:b("renderSideBySideInlineBreakpoint","If the diff editor width is smaller than this value, the inline view is used.")},"diffEditor.useInlineViewWhenSpaceIsLimited":{type:"boolean",default:ir.useInlineViewWhenSpaceIsLimited,description:b("useInlineViewWhenSpaceIsLimited","If enabled and the editor width is too small, the inline view is used.")},"diffEditor.renderMarginRevertIcon":{type:"boolean",default:ir.renderMarginRevertIcon,description:b("renderMarginRevertIcon","When enabled, the diff editor shows arrows in its glyph margin to revert changes.")},"diffEditor.renderGutterMenu":{type:"boolean",default:ir.renderGutterMenu,description:b("renderGutterMenu","When enabled, the diff editor shows a special gutter for revert and stage actions.")},"diffEditor.ignoreTrimWhitespace":{type:"boolean",default:ir.ignoreTrimWhitespace,description:b("ignoreTrimWhitespace","When enabled, the diff editor ignores changes in leading or trailing whitespace.")},"diffEditor.renderIndicators":{type:"boolean",default:ir.renderIndicators,description:b("renderIndicators","Controls whether the diff editor shows +/- indicators for added/removed changes.")},"diffEditor.codeLens":{type:"boolean",default:ir.diffCodeLens,description:b("codeLens","Controls whether the editor shows CodeLens.")},"diffEditor.wordWrap":{type:"string",enum:["off","on","inherit"],default:ir.diffWordWrap,markdownEnumDescriptions:[b("wordWrap.off","Lines will never wrap."),b("wordWrap.on","Lines will wrap at the viewport width."),b("wordWrap.inherit","Lines will wrap according to the {0} setting.","`#editor.wordWrap#`")]},"diffEditor.diffAlgorithm":{type:"string",enum:["legacy","advanced"],default:ir.diffAlgorithm,markdownEnumDescriptions:[b("diffAlgorithm.legacy","Uses the legacy diffing algorithm."),b("diffAlgorithm.advanced","Uses the advanced diffing algorithm.")],tags:["experimental"]},"diffEditor.hideUnchangedRegions.enabled":{type:"boolean",default:ir.hideUnchangedRegions.enabled,markdownDescription:b("hideUnchangedRegions.enabled","Controls whether the diff editor shows unchanged regions.")},"diffEditor.hideUnchangedRegions.revealLineCount":{type:"integer",default:ir.hideUnchangedRegions.revealLineCount,markdownDescription:b("hideUnchangedRegions.revealLineCount","Controls how many lines are used for unchanged regions."),minimum:1},"diffEditor.hideUnchangedRegions.minimumLineCount":{type:"integer",default:ir.hideUnchangedRegions.minimumLineCount,markdownDescription:b("hideUnchangedRegions.minimumLineCount","Controls how many lines are used as a minimum for unchanged regions."),minimum:1},"diffEditor.hideUnchangedRegions.contextLineCount":{type:"integer",default:ir.hideUnchangedRegions.contextLineCount,markdownDescription:b("hideUnchangedRegions.contextLineCount","Controls how many lines are used as context when comparing unchanged regions."),minimum:1},"diffEditor.experimental.showMoves":{type:"boolean",default:ir.experimental.showMoves,markdownDescription:b("showMoves","Controls whether the diff editor should show detected code moves.")},"diffEditor.experimental.showEmptyDecorations":{type:"boolean",default:ir.experimental.showEmptyDecorations,description:b("showEmptyDecorations","Controls whether the diff editor shows empty decorations to see where characters got inserted or deleted.")},"diffEditor.experimental.useTrueInlineView":{type:"boolean",default:ir.experimental.useTrueInlineView,description:b("useTrueInlineView","If enabled and the editor uses the inline view, word changes are rendered inline.")}}};function g3e(s){return typeof s.type<"u"||typeof s.anyOf<"u"}for(const s of yC){const e=s.schema;if(typeof e<"u")if(g3e(e))mA.properties[`editor.${s.name}`]=e;else for(const t in e)Object.hasOwnProperty.call(e,t)&&(mA.properties[t]=e[t])}let hN=null;function zfe(){return hN===null&&(hN=Object.create(null),Object.keys(mA.properties).forEach(s=>{hN[s]=!0})),hN}function p3e(s){return zfe()[`editor.${s}`]||!1}function m3e(s){return zfe()[`diffEditor.${s}`]||!1}const _3e=_n.as(pd.Configuration);_3e.registerConfiguration(mA);class gn{static insert(e,t){return{range:new F(e.lineNumber,e.column,e.lineNumber,e.column),text:t,forceMoveMarkers:!0}}static delete(e){return{range:e,text:null}}static replace(e,t){return{range:e,text:t}}static replaceMove(e,t){return{range:e,text:t,forceMoveMarkers:!0}}}function fN(s){return Object.isFrozen(s)?s:MTe(s)}class Qs{static createEmptyModel(e){return new Qs({},[],[],void 0,e)}constructor(e,t,i,n,r){this._contents=e,this._keys=t,this._overrides=i,this.raw=n,this.logService=r,this.overrideConfigurations=new Map}get rawConfiguration(){var e;if(!this._rawConfiguration)if((e=this.raw)!=null&&e.length){const t=this.raw.map(i=>{if(i instanceof Qs)return i;const n=new b3e("",this.logService);return n.parseRaw(i),n.configurationModel});this._rawConfiguration=t.reduce((i,n)=>n===i?n:i.merge(n),t[0])}else this._rawConfiguration=this;return this._rawConfiguration}get contents(){return this._contents}get overrides(){return this._overrides}get keys(){return this._keys}isEmpty(){return this._keys.length===0&&Object.keys(this._contents).length===0&&this._overrides.length===0}getValue(e){return e?Lte(this.contents,e):this.contents}inspect(e,t){const i=this;return{get value(){return fN(i.rawConfiguration.getValue(e))},get override(){return t?fN(i.rawConfiguration.getOverrideValue(e,t)):void 0},get merged(){return fN(t?i.rawConfiguration.override(t).getValue(e):i.rawConfiguration.getValue(e))},get overrides(){const n=[];for(const{contents:r,identifiers:o,keys:a}of i.rawConfiguration.overrides){const l=new Qs(r,a,[],void 0,i.logService).getValue(e);l!==void 0&&n.push({identifiers:o,value:l})}return n.length?fN(n):void 0}}}getOverrideValue(e,t){const i=this.getContentsForOverrideIdentifer(t);return i?e?Lte(i,e):i:void 0}override(e){let t=this.overrideConfigurations.get(e);return t||(t=this.createOverrideConfigurationModel(e),this.overrideConfigurations.set(e,t)),t}merge(...e){var o,a;const t=Ef(this.contents),i=Ef(this.overrides),n=[...this.keys],r=(o=this.raw)!=null&&o.length?[...this.raw]:[this];for(const l of e)if(r.push(...(a=l.raw)!=null&&a.length?l.raw:[l]),!l.isEmpty()){this.mergeContents(t,l.contents);for(const c of l.overrides){const[d]=i.filter(u=>dn(u.identifiers,c.identifiers));d?(this.mergeContents(d.contents,c.contents),d.keys.push(...c.keys),d.keys=wg(d.keys)):i.push(Ef(c))}for(const c of l.keys)n.indexOf(c)===-1&&n.push(c)}return new Qs(t,n,i,r.every(l=>l instanceof Qs)?void 0:r,this.logService)}createOverrideConfigurationModel(e){const t=this.getContentsForOverrideIdentifer(e);if(!t||typeof t!="object"||!Object.keys(t).length)return this;const i={};for(const n of wg([...Object.keys(this.contents),...Object.keys(t)])){let r=this.contents[n];const o=t[n];o&&(typeof r=="object"&&typeof o=="object"?(r=Ef(r),this.mergeContents(r,o)):r=o),i[n]=r}return new Qs(i,this.keys,this.overrides,void 0,this.logService)}mergeContents(e,t){for(const i of Object.keys(t)){if(i in e&&Ms(e[i])&&Ms(t[i])){this.mergeContents(e[i],t[i]);continue}e[i]=Ef(t[i])}}getContentsForOverrideIdentifer(e){let t=null,i=null;const n=r=>{r&&(i?this.mergeContents(i,r):i=Ef(r))};for(const r of this.overrides)r.identifiers.length===1&&r.identifiers[0]===e?t=r.contents:r.identifiers.includes(e)&&n(r.contents);return n(t),i}toJSON(){return{contents:this.contents,overrides:this.overrides,keys:this.keys}}setValue(e,t){this.updateValue(e,t,!1)}removeValue(e){const t=this.keys.indexOf(e);t!==-1&&(this.keys.splice(t,1),SPe(this.contents,e),Km.test(e)&&this.overrides.splice(this.overrides.findIndex(i=>dn(i.identifiers,Y2(e))),1))}updateValue(e,t,i){if(xhe(this.contents,e,t,n=>this.logService.error(n)),i=i||this.keys.indexOf(e)===-1,i&&this.keys.push(e),Km.test(e)){const n=Y2(e),r={identifiers:n,keys:Object.keys(this.contents[e]),contents:r6(this.contents[e],a=>this.logService.error(a))},o=this.overrides.findIndex(a=>dn(a.identifiers,n));o!==-1?this.overrides[o]=r:this.overrides.push(r)}}}class b3e{constructor(e,t){this._name=e,this.logService=t,this._raw=null,this._configurationModel=null,this._restrictedConfigurations=[]}get configurationModel(){return this._configurationModel||Qs.createEmptyModel(this.logService)}parseRaw(e,t){this._raw=e;const{contents:i,keys:n,overrides:r,restricted:o,hasExcludedProperties:a}=this.doParseRaw(e,t);this._configurationModel=new Qs(i,n,r,a?[e]:void 0,this.logService),this._restrictedConfigurations=o||[]}doParseRaw(e,t){const i=_n.as(pd.Configuration).getConfigurationProperties(),n=this.filter(e,i,!0,t);e=n.raw;const r=r6(e,l=>this.logService.error(`Conflict in settings file ${this._name}: ${l}`)),o=Object.keys(e),a=this.toOverrides(e,l=>this.logService.error(`Conflict in settings file ${this._name}: ${l}`));return{contents:r,keys:o,overrides:a,restricted:n.restricted,hasExcludedProperties:n.hasExcludedProperties}}filter(e,t,i,n){var l,c,d;let r=!1;if(!(n!=null&&n.scopes)&&!(n!=null&&n.skipRestricted)&&!((l=n==null?void 0:n.exclude)!=null&&l.length))return{raw:e,restricted:[],hasExcludedProperties:r};const o={},a=[];for(const u in e)if(Km.test(u)&&i){const h=this.filter(e[u],t,!1,n);o[u]=h.raw,r=r||h.hasExcludedProperties,a.push(...h.restricted)}else{const h=t[u],g=h?typeof h.scope<"u"?h.scope:3:void 0;h!=null&&h.restricted&&a.push(u),!((c=n.exclude)!=null&&c.includes(u))&&((d=n.include)!=null&&d.includes(u)||(g===void 0||n.scopes===void 0||n.scopes.includes(g))&&!(n.skipRestricted&&(h!=null&&h.restricted)))?o[u]=e[u]:r=!0}return{raw:o,restricted:a,hasExcludedProperties:r}}toOverrides(e,t){const i=[];for(const n of Object.keys(e))if(Km.test(n)){const r={};for(const o in e[n])r[o]=e[n][o];i.push({identifiers:Y2(n),keys:Object.keys(r),contents:r6(r,t)})}return i}}class v3e{constructor(e,t,i,n,r,o,a,l,c,d,u,h,g){this.key=e,this.overrides=t,this._value=i,this.overrideIdentifiers=n,this.defaultConfiguration=r,this.policyConfiguration=o,this.applicationConfiguration=a,this.userConfiguration=l,this.localUserConfiguration=c,this.remoteUserConfiguration=d,this.workspaceConfiguration=u,this.folderConfigurationModel=h,this.memoryConfigurationModel=g}toInspectValue(e){return(e==null?void 0:e.value)!==void 0||(e==null?void 0:e.override)!==void 0||(e==null?void 0:e.overrides)!==void 0?e:void 0}get userInspectValue(){return this._userInspectValue||(this._userInspectValue=this.userConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._userInspectValue}get user(){return this.toInspectValue(this.userInspectValue)}}class OF{constructor(e,t,i,n,r,o,a,l,c,d){this._defaultConfiguration=e,this._policyConfiguration=t,this._applicationConfiguration=i,this._localUserConfiguration=n,this._remoteUserConfiguration=r,this._workspaceConfiguration=o,this._folderConfigurations=a,this._memoryConfiguration=l,this._memoryConfigurationByResource=c,this.logService=d,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations=new Fs,this._userConfiguration=null}getValue(e,t,i){return this.getConsolidatedConfigurationModel(e,t,i).getValue(e)}updateValue(e,t,i={}){let n;i.resource?(n=this._memoryConfigurationByResource.get(i.resource),n||(n=Qs.createEmptyModel(this.logService),this._memoryConfigurationByResource.set(i.resource,n))):n=this._memoryConfiguration,t===void 0?n.removeValue(e):n.setValue(e,t),i.resource||(this._workspaceConsolidatedConfiguration=null)}inspect(e,t,i){const n=this.getConsolidatedConfigurationModel(e,t,i),r=this.getFolderConfigurationModelForResource(t.resource,i),o=t.resource?this._memoryConfigurationByResource.get(t.resource)||this._memoryConfiguration:this._memoryConfiguration,a=new Set;for(const l of n.overrides)for(const c of l.identifiers)n.getOverrideValue(e,c)!==void 0&&a.add(c);return new v3e(e,t,n.getValue(e),a.size?[...a]:void 0,this._defaultConfiguration,this._policyConfiguration.isEmpty()?void 0:this._policyConfiguration,this.applicationConfiguration.isEmpty()?void 0:this.applicationConfiguration,this.userConfiguration,this.localUserConfiguration,this.remoteUserConfiguration,i?this._workspaceConfiguration:void 0,r||void 0,o)}get applicationConfiguration(){return this._applicationConfiguration}get userConfiguration(){return this._userConfiguration||(this._userConfiguration=this._remoteUserConfiguration.isEmpty()?this._localUserConfiguration:this._localUserConfiguration.merge(this._remoteUserConfiguration)),this._userConfiguration}get localUserConfiguration(){return this._localUserConfiguration}get remoteUserConfiguration(){return this._remoteUserConfiguration}getConsolidatedConfigurationModel(e,t,i){let n=this.getConsolidatedConfigurationModelForResource(t,i);return t.overrideIdentifier&&(n=n.override(t.overrideIdentifier)),!this._policyConfiguration.isEmpty()&&this._policyConfiguration.getValue(e)!==void 0&&(n=n.merge(this._policyConfiguration)),n}getConsolidatedConfigurationModelForResource({resource:e},t){let i=this.getWorkspaceConsolidatedConfiguration();if(t&&e){const n=t.getFolder(e);n&&(i=this.getFolderConsolidatedConfiguration(n.uri)||i);const r=this._memoryConfigurationByResource.get(e);r&&(i=i.merge(r))}return i}getWorkspaceConsolidatedConfiguration(){return this._workspaceConsolidatedConfiguration||(this._workspaceConsolidatedConfiguration=this._defaultConfiguration.merge(this.applicationConfiguration,this.userConfiguration,this._workspaceConfiguration,this._memoryConfiguration)),this._workspaceConsolidatedConfiguration}getFolderConsolidatedConfiguration(e){let t=this._foldersConsolidatedConfigurations.get(e);if(!t){const i=this.getWorkspaceConsolidatedConfiguration(),n=this._folderConfigurations.get(e);n?(t=i.merge(n),this._foldersConsolidatedConfigurations.set(e,t)):t=i}return t}getFolderConfigurationModelForResource(e,t){if(t&&e){const i=t.getFolder(e);if(i)return this._folderConfigurations.get(i.uri)}}toData(){return{defaults:{contents:this._defaultConfiguration.contents,overrides:this._defaultConfiguration.overrides,keys:this._defaultConfiguration.keys},policy:{contents:this._policyConfiguration.contents,overrides:this._policyConfiguration.overrides,keys:this._policyConfiguration.keys},application:{contents:this.applicationConfiguration.contents,overrides:this.applicationConfiguration.overrides,keys:this.applicationConfiguration.keys},user:{contents:this.userConfiguration.contents,overrides:this.userConfiguration.overrides,keys:this.userConfiguration.keys},workspace:{contents:this._workspaceConfiguration.contents,overrides:this._workspaceConfiguration.overrides,keys:this._workspaceConfiguration.keys},folders:[...this._folderConfigurations.keys()].reduce((e,t)=>{const{contents:i,overrides:n,keys:r}=this._folderConfigurations.get(t);return e.push([t,{contents:i,overrides:n,keys:r}]),e},[])}}static parse(e,t){const i=this.parseConfigurationModel(e.defaults,t),n=this.parseConfigurationModel(e.policy,t),r=this.parseConfigurationModel(e.application,t),o=this.parseConfigurationModel(e.user,t),a=this.parseConfigurationModel(e.workspace,t),l=e.folders.reduce((c,d)=>(c.set(Je.revive(d[0]),this.parseConfigurationModel(d[1],t)),c),new Fs);return new OF(i,n,r,o,Qs.createEmptyModel(t),a,l,Qs.createEmptyModel(t),new Fs,t)}static parseConfigurationModel(e,t){return new Qs(e.contents,e.keys,e.overrides,void 0,t)}}class w3e{constructor(e,t,i,n,r){this.change=e,this.previous=t,this.currentConfiguraiton=i,this.currentWorkspace=n,this.logService=r,this._marker=`
`,this._markerCode1=this._marker.charCodeAt(0),this._markerCode2=46,this.affectedKeys=new Set,this._previousConfiguration=void 0;for(const o of e.keys)this.affectedKeys.add(o);for(const[,o]of e.overrides)for(const a of o)this.affectedKeys.add(a);this._affectsConfigStr=this._marker;for(const o of this.affectedKeys)this._affectsConfigStr+=o+this._marker}get previousConfiguration(){return!this._previousConfiguration&&this.previous&&(this._previousConfiguration=OF.parse(this.previous.data,this.logService)),this._previousConfiguration}affectsConfiguration(e,t){var a;const i=this._marker+e,n=this._affectsConfigStr.indexOf(i);if(n<0)return!1;const r=n+i.length;if(r>=this._affectsConfigStr.length)return!1;const o=this._affectsConfigStr.charCodeAt(r);if(o!==this._markerCode1&&o!==this._markerCode2)return!1;if(t){const l=this.previousConfiguration?this.previousConfiguration.getValue(e,t,(a=this.previous)==null?void 0:a.workspace):void 0,c=this.currentConfiguraiton.getValue(e,t,this.currentWorkspace);return!Ta(l,c)}return!0}}class C3e{constructor(){this._onDidChange=new Z,this.onDidChange=this._onDidChange.event,this._enabled=!0}get enabled(){return this._enabled}enable(){this._enabled=!0,this._onDidChange.fire()}disable(){this._enabled=!1,this._onDidChange.fire()}}const PL=new C3e,_A={kind:0},y3e={kind:1};function S3e(s,e,t){return{kind:2,commandId:s,commandArgs:e,isBubble:t}}class ML{constructor(e,t,i){var n;this._log=i,this._defaultKeybindings=e,this._defaultBoundCommands=new Map;for(const r of e){const o=r.command;o&&o.charAt(0)!=="-"&&this._defaultBoundCommands.set(o,!0)}this._map=new Map,this._lookupMap=new Map,this._keybindings=ML.handleRemovals([].concat(e).concat(t));for(let r=0,o=this._keybindings.length;r<o;r++){const a=this._keybindings[r];if(a.chords.length===0)continue;const l=(n=a.when)==null?void 0:n.substituteConstants();l&&l.type===0||this._addKeyPress(a.chords[0],a)}}static _isTargetedForRemoval(e,t,i){if(t){for(let n=0;n<t.length;n++)if(t[n]!==e.chords[n])return!1}return!(i&&i.type!==1&&(!e.when||!AAe(i,e.when)))}static handleRemovals(e){const t=new Map;for(let n=0,r=e.length;n<r;n++){const o=e[n];if(o.command&&o.command.charAt(0)==="-"){const a=o.command.substring(1);t.has(a)?t.get(a).push(o):t.set(a,[o])}}if(t.size===0)return e;const i=[];for(let n=0,r=e.length;n<r;n++){const o=e[n];if(!o.command||o.command.length===0){i.push(o);continue}if(o.command.charAt(0)==="-")continue;const a=t.get(o.command);if(!a||!o.isDefault){i.push(o);continue}let l=!1;for(const c of a){const d=c.when;if(this._isTargetedForRemoval(o,c.chords,d)){l=!0;break}}if(!l){i.push(o);continue}}return i}_addKeyPress(e,t){const i=this._map.get(e);if(typeof i>"u"){this._map.set(e,[t]),this._addToLookupMap(t);return}for(let n=i.length-1;n>=0;n--){const r=i[n];if(r.command===t.command)continue;let o=!0;for(let a=1;a<r.chords.length&&a<t.chords.length;a++)if(r.chords[a]!==t.chords[a]){o=!1;break}o&&ML.whenIsEntirelyIncluded(r.when,t.when)&&this._removeFromLookupMap(r)}i.push(t),this._addToLookupMap(t)}_addToLookupMap(e){if(!e.command)return;let t=this._lookupMap.get(e.command);typeof t>"u"?(t=[e],this._lookupMap.set(e.command,t)):t.push(e)}_removeFromLookupMap(e){if(!e.command)return;const t=this._lookupMap.get(e.command);if(!(typeof t>"u")){for(let i=0,n=t.length;i<n;i++)if(t[i]===e){t.splice(i,1);return}}}static whenIsEntirelyIncluded(e,t){return!t||t.type===1?!0:!e||e.type===1?!1:t6(e,t)}getKeybindings(){return this._keybindings}lookupPrimaryKeybinding(e,t){const i=this._lookupMap.get(e);if(typeof i>"u"||i.length===0)return null;if(i.length===1)return i[0];for(let n=i.length-1;n>=0;n--){const r=i[n];if(t.contextMatchesRules(r.when))return r}return i[i.length-1]}resolve(e,t,i){const n=[...t,i];this._log(`| Resolving ${n}`);const r=this._map.get(n[0]);if(r===void 0)return this._log("\\ No keybinding entries."),_A;let o=null;if(n.length<2)o=r;else{o=[];for(let l=0,c=r.length;l<c;l++){const d=r[l];if(n.length>d.chords.length)continue;let u=!0;for(let h=1;h<n.length;h++)if(d.chords[h]!==n[h]){u=!1;break}u&&o.push(d)}}const a=this._findCommand(e,o);return a?n.length<a.chords.length?(this._log(`\\ From ${o.length} keybinding entries, awaiting ${a.chords.length-n.length} more chord(s), when: ${Zie(a.when)}, source: ${Jie(a)}.`),y3e):(this._log(`\\ From ${o.length} keybinding entries, matched ${a.command}, when: ${Zie(a.when)}, source: ${Jie(a)}.`),S3e(a.command,a.commandArgs,a.bubble)):(this._log(`\\ From ${o.length} keybinding entries, no when clauses matched the context.`),_A)}_findCommand(e,t){for(let i=t.length-1;i>=0;i--){const n=t[i];if(ML._contextMatchesRules(e,n.when))return n}return null}static _contextMatchesRules(e,t){return t?t.evaluate(e):!0}}function Zie(s){return s?`${s.serialize()}`:"no when condition"}function Jie(s){return s.extensionId?s.isBuiltinExtension?`built-in extension ${s.extensionId}`:`user extension ${s.extensionId}`:s.isDefault?"built-in":"user"}const x3e=/^(cursor|delete|undo|redo|tab|editor\.action\.clipboard)/;class L3e extends te{get onDidUpdateKeybindings(){return this._onDidUpdateKeybindings?this._onDidUpdateKeybindings.event:De.None}get inChordMode(){return this._currentChords.length>0}constructor(e,t,i,n,r){super(),this._contextKeyService=e,this._commandService=t,this._telemetryService=i,this._notificationService=n,this._logService=r,this._onDidUpdateKeybindings=this._register(new Z),this._currentChords=[],this._currentChordChecker=new Fq,this._currentChordStatusMessage=null,this._ignoreSingleModifiers=DC.EMPTY,this._currentSingleModifier=null,this._currentSingleModifierClearTimeout=new gd,this._currentlyDispatchingCommandId=null,this._logging=!1}dispose(){super.dispose()}_log(e){this._logging&&this._logService.info(`[KeybindingService]: ${e}`)}getKeybindings(){return this._getResolver().getKeybindings()}lookupKeybinding(e,t){const i=this._getResolver().lookupPrimaryKeybinding(e,t||this._contextKeyService);if(i)return i.resolvedKeybinding}dispatchEvent(e,t){return this._dispatch(e,t)}softDispatch(e,t){this._log("/ Soft dispatching keyboard event");const i=this.resolveKeyboardEvent(e);if(i.hasMultipleChords())return console.warn("keyboard event should not be mapped to multiple chords"),_A;const[n]=i.getDispatchChords();if(n===null)return this._log("\\ Keyboard event cannot be dispatched"),_A;const r=this._contextKeyService.getContext(t),o=this._currentChords.map(({keypress:a})=>a);return this._getResolver().resolve(r,o,n)}_scheduleLeaveChordMode(){const e=Date.now();this._currentChordChecker.cancelAndSet(()=>{if(!this._documentHasFocus()){this._leaveChordMode();return}Date.now()-e>5e3&&this._leaveChordMode()},500)}_expectAnotherChord(e,t){switch(this._currentChords.push({keypress:e,label:t}),this._currentChords.length){case 0:throw yq("impossible");case 1:this._currentChordStatusMessage=this._notificationService.status(b("first.chord","({0}) was pressed. Waiting for second key of chord...",t));break;default:{const i=this._currentChords.map(({label:n})=>n).join(", ");this._currentChordStatusMessage=this._notificationService.status(b("next.chord","({0}) was pressed. Waiting for next key of chord...",i))}}this._scheduleLeaveChordMode(),PL.enabled&&PL.disable()}_leaveChordMode(){this._currentChordStatusMessage&&(this._currentChordStatusMessage.dispose(),this._currentChordStatusMessage=null),this._currentChordChecker.cancel(),this._currentChords=[],PL.enable()}_dispatch(e,t){return this._doDispatch(this.resolveKeyboardEvent(e),t,!1)}_singleModifierDispatch(e,t){const i=this.resolveKeyboardEvent(e),[n]=i.getSingleModifierDispatchChords();if(n)return this._ignoreSingleModifiers.has(n)?(this._log(`+ Ignoring single modifier ${n} due to it being pressed together with other keys.`),this._ignoreSingleModifiers=DC.EMPTY,this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1):(this._ignoreSingleModifiers=DC.EMPTY,this._currentSingleModifier===null?(this._log(`+ Storing single modifier for possible chord ${n}.`),this._currentSingleModifier=n,this._currentSingleModifierClearTimeout.cancelAndSet(()=>{this._log("+ Clearing single modifier due to 300ms elapsed."),this._currentSingleModifier=null},300),!1):n===this._currentSingleModifier?(this._log(`/ Dispatching single modifier chord ${n} ${n}`),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,this._doDispatch(i,t,!0)):(this._log(`+ Clearing single modifier due to modifier mismatch: ${this._currentSingleModifier} ${n}`),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1));const[r]=i.getChords();return this._ignoreSingleModifiers=new DC(r),this._currentSingleModifier!==null&&this._log("+ Clearing single modifier due to other key up."),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1}_doDispatch(e,t,i=!1){let n=!1;if(e.hasMultipleChords())return console.warn("Unexpected keyboard event mapped to multiple chords"),!1;let r=null,o=null;if(i){const[d]=e.getSingleModifierDispatchChords();r=d,o=d?[d]:[]}else[r]=e.getDispatchChords(),o=this._currentChords.map(({keypress:d})=>d);if(r===null)return this._log("\\ Keyboard event cannot be dispatched in keydown phase."),n;const a=this._contextKeyService.getContext(t),l=e.getLabel(),c=this._getResolver().resolve(a,o,r);switch(c.kind){case 0:{if(this._logService.trace("KeybindingService#dispatch",l,"[ No matching keybinding ]"),this.inChordMode){const d=this._currentChords.map(({label:u})=>u).join(", ");this._log(`+ Leaving multi-chord mode: Nothing bound to "${d}, ${l}".`),this._notificationService.status(b("missing.chord","The key combination ({0}, {1}) is not a command.",d,l),{hideAfter:10*1e3}),this._leaveChordMode(),n=!0}return n}case 1:return this._logService.trace("KeybindingService#dispatch",l,"[ Several keybindings match - more chords needed ]"),n=!0,this._expectAnotherChord(r,l),this._log(this._currentChords.length===1?"+ Entering multi-chord mode...":"+ Continuing multi-chord mode..."),n;case 2:{if(this._logService.trace("KeybindingService#dispatch",l,`[ Will dispatch command ${c.commandId} ]`),c.commandId===null||c.commandId===""){if(this.inChordMode){const d=this._currentChords.map(({label:u})=>u).join(", ");this._log(`+ Leaving chord mode: Nothing bound to "${d}, ${l}".`),this._notificationService.status(b("missing.chord","The key combination ({0}, {1}) is not a command.",d,l),{hideAfter:10*1e3}),this._leaveChordMode(),n=!0}}else{this.inChordMode&&this._leaveChordMode(),c.isBubble||(n=!0),this._log(`+ Invoking command ${c.commandId}.`),this._currentlyDispatchingCommandId=c.commandId;try{typeof c.commandArgs>"u"?this._commandService.executeCommand(c.commandId).then(void 0,d=>this._notificationService.warn(d)):this._commandService.executeCommand(c.commandId,c.commandArgs).then(void 0,d=>this._notificationService.warn(d))}finally{this._currentlyDispatchingCommandId=null}x3e.test(c.commandId)||this._telemetryService.publicLog2("workbenchActionExecuted",{id:c.commandId,from:"keybinding",detail:e.getUserSettingsLabel()??void 0})}return n}}}mightProducePrintableCharacter(e){return e.ctrlKey||e.metaKey?!1:e.keyCode>=31&&e.keyCode<=56||e.keyCode>=21&&e.keyCode<=30}}const UM=class UM{constructor(e){this._ctrlKey=e?e.ctrlKey:!1,this._shiftKey=e?e.shiftKey:!1,this._altKey=e?e.altKey:!1,this._metaKey=e?e.metaKey:!1}has(e){switch(e){case"ctrl":return this._ctrlKey;case"shift":return this._shiftKey;case"alt":return this._altKey;case"meta":return this._metaKey}}};UM.EMPTY=new UM(null);let DC=UM;class ene{constructor(e,t,i,n,r,o,a){this._resolvedKeybindingItemBrand=void 0,this.resolvedKeybinding=e,this.chords=e?Y6(e.getDispatchChords()):[],e&&this.chords.length===0&&(this.chords=Y6(e.getSingleModifierDispatchChords())),this.bubble=t?t.charCodeAt(0)===94:!1,this.command=this.bubble?t.substr(1):t,this.commandArgs=i,this.when=n,this.isDefault=r,this.extensionId=o,this.isBuiltinExtension=a}}function Y6(s){const e=[];for(let t=0,i=s.length;t<i;t++){const n=s[t];if(!n)return[];e.push(n)}return e}class FF{constructor(e,t,i=t){this.modifierLabels=[null],this.modifierLabels[2]=e,this.modifierLabels[1]=t,this.modifierLabels[3]=i}toLabel(e,t,i){if(t.length===0)return null;const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=i(a);if(l===null)return null;n[r]=D3e(a,l,this.modifierLabels[e])}return n.join(" ")}}const NK=new FF({ctrlKey:"⌃",shiftKey:"⇧",altKey:"⌥",metaKey:"⌘",separator:""},{ctrlKey:b({key:"ctrlKey",comment:["This is the short form for the Control key on the keyboard"]},"Ctrl"),shiftKey:b({key:"shiftKey",comment:["This is the short form for the Shift key on the keyboard"]},"Shift"),altKey:b({key:"altKey",comment:["This is the short form for the Alt key on the keyboard"]},"Alt"),metaKey:b({key:"windowsKey",comment:["This is the short form for the Windows key on the keyboard"]},"Windows"),separator:"+"},{ctrlKey:b({key:"ctrlKey",comment:["This is the short form for the Control key on the keyboard"]},"Ctrl"),shiftKey:b({key:"shiftKey",comment:["This is the short form for the Shift key on the keyboard"]},"Shift"),altKey:b({key:"altKey",comment:["This is the short form for the Alt key on the keyboard"]},"Alt"),metaKey:b({key:"superKey",comment:["This is the short form for the Super key on the keyboard"]},"Super"),separator:"+"}),k3e=new FF({ctrlKey:b({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:b({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:b({key:"optKey.long",comment:["This is the long form for the Alt/Option key on the keyboard"]},"Option"),metaKey:b({key:"cmdKey.long",comment:["This is the long form for the Command key on the keyboard"]},"Command"),separator:"+"},{ctrlKey:b({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:b({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:b({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:b({key:"windowsKey.long",comment:["This is the long form for the Windows key on the keyboard"]},"Windows"),separator:"+"},{ctrlKey:b({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:b({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:b({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:b({key:"superKey.long",comment:["This is the long form for the Super key on the keyboard"]},"Super"),separator:"+"}),I3e=new FF({ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Cmd",separator:"+"},{ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Super",separator:"+"}),E3e=new FF({ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"cmd",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"win",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"meta",separator:"+"});function D3e(s,e,t){if(e===null)return"";const i=[];return s.ctrlKey&&i.push(t.ctrlKey),s.shiftKey&&i.push(t.shiftKey),s.altKey&&i.push(t.altKey),s.metaKey&&i.push(t.metaKey),e!==""&&i.push(e),i.join(t.separator)}class T3e extends e2e{constructor(e,t){if(super(),t.length===0)throw fc("chords");this._os=e,this._chords=t}getLabel(){return NK.toLabel(this._os,this._chords,e=>this._getLabel(e))}getAriaLabel(){return k3e.toLabel(this._os,this._chords,e=>this._getAriaLabel(e))}getElectronAccelerator(){return this._chords.length>1||this._chords[0].isDuplicateModifierCase()?null:I3e.toLabel(this._os,this._chords,e=>this._getElectronAccelerator(e))}getUserSettingsLabel(){return E3e.toLabel(this._os,this._chords,e=>this._getUserSettingsLabel(e))}hasMultipleChords(){return this._chords.length>1}getChords(){return this._chords.map(e=>this._getChord(e))}_getChord(e){return new JRe(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,this._getLabel(e),this._getAriaLabel(e))}getDispatchChords(){return this._chords.map(e=>this._getChordDispatch(e))}getSingleModifierDispatchChords(){return this._chords.map(e=>this._getSingleModifierChordDispatch(e))}}class CI extends T3e{constructor(e,t){super(t,e)}_keyCodeToUILabel(e){if(this._os===2)switch(e){case 15:return"←";case 16:return"↑";case 17:return"→";case 18:return"↓"}return Of.toString(e)}_getLabel(e){return e.isDuplicateModifierCase()?"":this._keyCodeToUILabel(e.keyCode)}_getAriaLabel(e){return e.isDuplicateModifierCase()?"":Of.toString(e.keyCode)}_getElectronAccelerator(e){return Of.toElectronAccelerator(e.keyCode)}_getUserSettingsLabel(e){if(e.isDuplicateModifierCase())return"";const t=Of.toUserSettingsUS(e.keyCode);return t&&t.toLowerCase()}_getChordDispatch(e){return CI.getDispatchStr(e)}static getDispatchStr(e){if(e.isModifierKey())return null;let t="";return e.ctrlKey&&(t+="ctrl+"),e.shiftKey&&(t+="shift+"),e.altKey&&(t+="alt+"),e.metaKey&&(t+="meta+"),t+=Of.toString(e.keyCode),t}_getSingleModifierChordDispatch(e){return e.keyCode===5&&!e.shiftKey&&!e.altKey&&!e.metaKey?"ctrl":e.keyCode===4&&!e.ctrlKey&&!e.altKey&&!e.metaKey?"shift":e.keyCode===6&&!e.ctrlKey&&!e.shiftKey&&!e.metaKey?"alt":e.keyCode===57&&!e.ctrlKey&&!e.shiftKey&&!e.altKey?"meta":null}static _scanCodeToKeyCode(e){const t=kq[e];if(t!==-1)return t;switch(e){case 10:return 31;case 11:return 32;case 12:return 33;case 13:return 34;case 14:return 35;case 15:return 36;case 16:return 37;case 17:return 38;case 18:return 39;case 19:return 40;case 20:return 41;case 21:return 42;case 22:return 43;case 23:return 44;case 24:return 45;case 25:return 46;case 26:return 47;case 27:return 48;case 28:return 49;case 29:return 50;case 30:return 51;case 31:return 52;case 32:return 53;case 33:return 54;case 34:return 55;case 35:return 56;case 36:return 22;case 37:return 23;case 38:return 24;case 39:return 25;case 40:return 26;case 41:return 27;case 42:return 28;case 43:return 29;case 44:return 30;case 45:return 21;case 51:return 88;case 52:return 86;case 53:return 92;case 54:return 94;case 55:return 93;case 56:return 0;case 57:return 85;case 58:return 95;case 59:return 91;case 60:return 87;case 61:return 89;case 62:return 90;case 106:return 97}return 0}static _toKeyCodeChord(e){if(!e)return null;if(e instanceof yg)return e;const t=this._scanCodeToKeyCode(e.scanCode);return t===0?null:new yg(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,t)}static resolveKeybinding(e,t){const i=Y6(e.chords.map(n=>this._toKeyCodeChord(n)));return i.length>0?[new CI(i,t)]:[]}}const x1=Ht("labelService"),Ufe=Ht("progressService"),aY=class aY{constructor(e){this.callback=e}report(e){this._value=e,this.callback(this._value)}};aY.None=Object.freeze({report(){}});let Zd=aY;const m_=Ht("editorProgressService");class N3e{constructor(){this._value="",this._pos=0}reset(e){return this._value=e,this._pos=0,this}next(){return this._pos+=1,this}hasNext(){return this._pos<this._value.length-1}cmp(e){const t=e.charCodeAt(0),i=this._value.charCodeAt(this._pos);return t-i}value(){return this._value[this._pos]}}class R3e{constructor(e=!0){this._caseSensitive=e}reset(e){return this._value=e,this._from=0,this._to=0,this.next()}hasNext(){return this._to<this._value.length}next(){this._from=this._to;let e=!0;for(;this._to<this._value.length;this._to++)if(this._value.charCodeAt(this._to)===46)if(e)this._from++;else break;else e=!1;return this}cmp(e){return this._caseSensitive?Eq(e,this._value,0,e.length,this._from,this._to):HE(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class A3e{constructor(e=!0,t=!0){this._splitOnBackslash=e,this._caseSensitive=t}reset(e){this._from=0,this._to=0,this._value=e,this._valueLen=e.length;for(let t=e.length-1;t>=0;t--,this._valueLen--){const i=this._value.charCodeAt(t);if(!(i===47||this._splitOnBackslash&&i===92))break}return this.next()}hasNext(){return this._to<this._valueLen}next(){this._from=this._to;let e=!0;for(;this._to<this._valueLen;this._to++){const t=this._value.charCodeAt(this._to);if(t===47||this._splitOnBackslash&&t===92)if(e)this._from++;else break;else e=!1}return this}cmp(e){return this._caseSensitive?Eq(e,this._value,0,e.length,this._from,this._to):HE(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class P3e{constructor(e,t){this._ignorePathCasing=e,this._ignoreQueryAndFragment=t,this._states=[],this._stateIdx=0}reset(e){return this._value=e,this._states=[],this._value.scheme&&this._states.push(1),this._value.authority&&this._states.push(2),this._value.path&&(this._pathIterator=new A3e(!1,!this._ignorePathCasing(e)),this._pathIterator.reset(e.path),this._pathIterator.value()&&this._states.push(3)),this._ignoreQueryAndFragment(e)||(this._value.query&&this._states.push(4),this._value.fragment&&this._states.push(5)),this._stateIdx=0,this}next(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()?this._pathIterator.next():this._stateIdx+=1,this}hasNext(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()||this._stateIdx<this._states.length-1}cmp(e){if(this._states[this._stateIdx]===1)return BW(e,this._value.scheme);if(this._states[this._stateIdx]===2)return BW(e,this._value.authority);if(this._states[this._stateIdx]===3)return this._pathIterator.cmp(e);if(this._states[this._stateIdx]===4)return eI(e,this._value.query);if(this._states[this._stateIdx]===5)return eI(e,this._value.fragment);throw new Error}value(){if(this._states[this._stateIdx]===1)return this._value.scheme;if(this._states[this._stateIdx]===2)return this._value.authority;if(this._states[this._stateIdx]===3)return this._pathIterator.value();if(this._states[this._stateIdx]===4)return this._value.query;if(this._states[this._stateIdx]===5)return this._value.fragment;throw new Error}}class gN{constructor(){this.height=1}rotateLeft(){const e=this.right;return this.right=e.left,e.left=this,this.updateHeight(),e.updateHeight(),e}rotateRight(){const e=this.left;return this.left=e.right,e.right=this,this.updateHeight(),e.updateHeight(),e}updateHeight(){this.height=1+Math.max(this.heightLeft,this.heightRight)}balanceFactor(){return this.heightRight-this.heightLeft}get heightLeft(){var e;return((e=this.left)==null?void 0:e.height)??0}get heightRight(){var e;return((e=this.right)==null?void 0:e.height)??0}}class Cy{static forUris(e=()=>!1,t=()=>!1){return new Cy(new P3e(e,t))}static forStrings(){return new Cy(new N3e)}static forConfigKeys(){return new Cy(new R3e)}constructor(e){this._iter=e}clear(){this._root=void 0}set(e,t){const i=this._iter.reset(e);let n;this._root||(this._root=new gN,this._root.segment=i.value());const r=[];for(n=this._root;;){const a=i.cmp(n.segment);if(a>0)n.left||(n.left=new gN,n.left.segment=i.value()),r.push([-1,n]),n=n.left;else if(a<0)n.right||(n.right=new gN,n.right.segment=i.value()),r.push([1,n]),n=n.right;else if(i.hasNext())i.next(),n.mid||(n.mid=new gN,n.mid.segment=i.value()),r.push([0,n]),n=n.mid;else break}const o=n.value;n.value=t,n.key=e;for(let a=r.length-1;a>=0;a--){const l=r[a][1];l.updateHeight();const c=l.balanceFactor();if(c<-1||c>1){const d=r[a][0],u=r[a+1][0];if(d===1&&u===1)r[a][1]=l.rotateLeft();else if(d===-1&&u===-1)r[a][1]=l.rotateRight();else if(d===1&&u===-1)l.right=r[a+1][1]=r[a+1][1].rotateRight(),r[a][1]=l.rotateLeft();else if(d===-1&&u===1)l.left=r[a+1][1]=r[a+1][1].rotateLeft(),r[a][1]=l.rotateRight();else throw new Error;if(a>0)switch(r[a-1][0]){case-1:r[a-1][1].left=r[a][1];break;case 1:r[a-1][1].right=r[a][1];break;case 0:r[a-1][1].mid=r[a][1];break}else this._root=r[0][1]}}return o}get(e){var t;return(t=this._getNode(e))==null?void 0:t.value}_getNode(e){const t=this._iter.reset(e);let i=this._root;for(;i;){const n=t.cmp(i.segment);if(n>0)i=i.left;else if(n<0)i=i.right;else if(t.hasNext())t.next(),i=i.mid;else break}return i}has(e){const t=this._getNode(e);return!((t==null?void 0:t.value)===void 0&&(t==null?void 0:t.mid)===void 0)}delete(e){return this._delete(e,!1)}deleteSuperstr(e){return this._delete(e,!0)}_delete(e,t){const i=this._iter.reset(e),n=[];let r=this._root;for(;r;){const o=i.cmp(r.segment);if(o>0)n.push([-1,r]),r=r.left;else if(o<0)n.push([1,r]),r=r.right;else if(i.hasNext())i.next(),n.push([0,r]),r=r.mid;else break}if(r){if(t?(r.left=void 0,r.mid=void 0,r.right=void 0,r.height=1):(r.key=void 0,r.value=void 0),!r.mid&&!r.value)if(r.left&&r.right){const o=this._min(r.right);if(o.key){const{key:a,value:l,segment:c}=o;this._delete(o.key,!1),r.key=a,r.value=l,r.segment=c}}else{const o=r.left??r.right;if(n.length>0){const[a,l]=n[n.length-1];switch(a){case-1:l.left=o;break;case 0:l.mid=o;break;case 1:l.right=o;break}}else this._root=o}for(let o=n.length-1;o>=0;o--){const a=n[o][1];a.updateHeight();const l=a.balanceFactor();if(l>1?(a.right.balanceFactor()>=0||(a.right=a.right.rotateRight()),n[o][1]=a.rotateLeft()):l<-1&&(a.left.balanceFactor()<=0||(a.left=a.left.rotateLeft()),n[o][1]=a.rotateRight()),o>0)switch(n[o-1][0]){case-1:n[o-1][1].left=n[o][1];break;case 1:n[o-1][1].right=n[o][1];break;case 0:n[o-1][1].mid=n[o][1];break}else this._root=n[0][1]}}}_min(e){for(;e.left;)e=e.left;return e}findSubstr(e){const t=this._iter.reset(e);let i=this._root,n;for(;i;){const r=t.cmp(i.segment);if(r>0)i=i.left;else if(r<0)i=i.right;else if(t.hasNext())t.next(),n=i.value||n,i=i.mid;else break}return i&&i.value||n}findSuperstr(e){return this._findSuperstrOrElement(e,!1)}_findSuperstrOrElement(e,t){const i=this._iter.reset(e);let n=this._root;for(;n;){const r=i.cmp(n.segment);if(r>0)n=n.left;else if(r<0)n=n.right;else if(i.hasNext())i.next(),n=n.mid;else return n.mid?this._entries(n.mid):t?n.value:void 0}}forEach(e){for(const[t,i]of this)e(i,t)}*[Symbol.iterator](){yield*this._entries(this._root)}_entries(e){const t=[];return this._dfsEntries(e,t),t[Symbol.iterator]()}_dfsEntries(e,t){e&&(e.left&&this._dfsEntries(e.left,t),e.value&&t.push([e.key,e.value]),e.mid&&this._dfsEntries(e.mid,t),e.right&&this._dfsEntries(e.right,t))}}const _w=Ht("contextService");function X6(s){const e=s;return typeof(e==null?void 0:e.id)=="string"&&Je.isUri(e.uri)}function M3e(s){const e=s;return typeof(e==null?void 0:e.id)=="string"&&!X6(s)&&!V3e(s)}const O3e={id:"empty-window"};function F3e(s,e){if(typeof s=="string"||typeof s>"u")return typeof s=="string"?{id:lm(s)}:O3e;const t=s;return t.configuration?{id:t.id,configPath:t.configuration}:t.folders.length===1?{id:t.id,uri:t.folders[0].uri}:{id:t.id}}function V3e(s){const e=s;return typeof(e==null?void 0:e.id)=="string"&&Je.isUri(e.configPath)}class B3e{constructor(e,t){this.raw=t,this.uri=e.uri,this.index=e.index,this.name=e.name}toJSON(){return{uri:this.uri,name:this.name,index:this.index}}}const Z6="code-workspace";b("codeWorkspace","Code Workspace");const jfe="4064f6ec-cb38-4ad0-af64-ee6467e63c82";function W3e(s){return s.id===jfe}var J6;(function(s){s.inspectTokensAction=b("inspectTokens","Developer: Inspect Tokens")})(J6||(J6={}));var bA;(function(s){s.gotoLineActionLabel=b("gotoLineActionLabel","Go to Line/Column...")})(bA||(bA={}));var e8;(function(s){s.helpQuickAccessActionLabel=b("helpQuickAccess","Show all Quick Access Providers")})(e8||(e8={}));var vA;(function(s){s.quickCommandActionLabel=b("quickCommandActionLabel","Command Palette"),s.quickCommandHelp=b("quickCommandActionHelp","Show And Run Commands")})(vA||(vA={}));var yI;(function(s){s.quickOutlineActionLabel=b("quickOutlineActionLabel","Go to Symbol..."),s.quickOutlineByCategoryActionLabel=b("quickOutlineByCategoryActionLabel","Go to Symbol by Category...")})(yI||(yI={}));var t8;(function(s){s.editorViewAccessibleLabel=b("editorViewAccessibleLabel","Editor content")})(t8||(t8={}));var i8;(function(s){s.toggleHighContrast=b("toggleHighContrast","Toggle High Contrast Theme")})(i8||(i8={}));var n8;(function(s){s.bulkEditServiceSummary=b("bulkEditServiceSummary","Made {0} edits in {1} files")})(n8||(n8={}));const $fe=Ht("workspaceTrustManagementService");let L1=[],RK=[],qfe=[];function pN(s,e=!1){H3e(s,!1,e)}function H3e(s,e,t){const i=z3e(s,e);L1.push(i),i.userConfigured?qfe.push(i):RK.push(i),t&&!i.userConfigured&&L1.forEach(n=>{n.mime===i.mime||n.userConfigured||(i.extension&&n.extension===i.extension&&console.warn(`Overwriting extension <<${i.extension}>> to now point to mime <<${i.mime}>>`),i.filename&&n.filename===i.filename&&console.warn(`Overwriting filename <<${i.filename}>> to now point to mime <<${i.mime}>>`),i.filepattern&&n.filepattern===i.filepattern&&console.warn(`Overwriting filepattern <<${i.filepattern}>> to now point to mime <<${i.mime}>>`),i.firstline&&n.firstline===i.firstline&&console.warn(`Overwriting firstline <<${i.firstline}>> to now point to mime <<${i.mime}>>`))})}function z3e(s,e){return{id:s.id,mime:s.mime,filename:s.filename,extension:s.extension,filepattern:s.filepattern,firstline:s.firstline,userConfigured:e,filenameLowercase:s.filename?s.filename.toLowerCase():void 0,extensionLowercase:s.extension?s.extension.toLowerCase():void 0,filepatternLowercase:s.filepattern?efe(s.filepattern.toLowerCase()):void 0,filepatternOnPath:s.filepattern?s.filepattern.indexOf(Yn.sep)>=0:!1}}function U3e(){L1=L1.filter(s=>s.userConfigured),RK=[]}function j3e(s,e){return $3e(s,e).map(t=>t.id)}function $3e(s,e){let t;if(s)switch(s.scheme){case gt.file:t=s.fsPath;break;case gt.data:{t=Qm.parseMetaData(s).get(Qm.META_DATA_LABEL);break}case gt.vscodeNotebookCell:t=void 0;break;default:t=s.path}if(!t)return[{id:"unknown",mime:An.unknown}];t=t.toLowerCase();const i=lm(t),n=tne(t,i,qfe);if(n)return[n,{id:So,mime:An.text}];const r=tne(t,i,RK);if(r)return[r,{id:So,mime:An.text}];if(e){const o=q3e(e);if(o)return[o,{id:So,mime:An.text}]}return[{id:"unknown",mime:An.unknown}]}function tne(s,e,t){var o;let i,n,r;for(let a=t.length-1;a>=0;a--){const l=t[a];if(e===l.filenameLowercase){i=l;break}if(l.filepattern&&(!n||l.filepattern.length>n.filepattern.length)){const c=l.filepatternOnPath?s:e;(o=l.filepatternLowercase)!=null&&o.call(l,c)&&(n=l)}l.extension&&(!r||l.extension.length>r.extension.length)&&e.endsWith(l.extensionLowercase)&&(r=l)}if(i)return i;if(n)return n;if(r)return r}function q3e(s){if(Pq(s)&&(s=s.substr(1)),s.length>0)for(let e=L1.length-1;e>=0;e--){const t=L1[e];if(!t.firstline)continue;const i=s.match(t.firstline);if(i&&i.length>0)return t}}const mN=Object.prototype.hasOwnProperty,ine="vs.editor.nullLanguage";class K3e{constructor(){this._languageIdToLanguage=[],this._languageToLanguageId=new Map,this._register(ine,0),this._register(So,1),this._nextLanguageId=2}_register(e,t){this._languageIdToLanguage[t]=e,this._languageToLanguageId.set(e,t)}register(e){if(this._languageToLanguageId.has(e))return;const t=this._nextLanguageId++;this._register(e,t)}encodeLanguageId(e){return this._languageToLanguageId.get(e)||0}decodeLanguageId(e){return this._languageIdToLanguage[e]||ine}}const wk=class wk extends te{constructor(e=!0,t=!1){super(),this._onDidChange=this._register(new Z),this.onDidChange=this._onDidChange.event,wk.instanceCount++,this._warnOnOverwrite=t,this.languageIdCodec=new K3e,this._dynamicLanguages=[],this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},e&&(this._initializeFromRegistry(),this._register(g1.onDidChangeLanguages(i=>{this._initializeFromRegistry()})))}dispose(){wk.instanceCount--,super.dispose()}_initializeFromRegistry(){this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},U3e();const e=[].concat(g1.getLanguages()).concat(this._dynamicLanguages);this._registerLanguages(e)}_registerLanguages(e){for(const t of e)this._registerLanguage(t);this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},Object.keys(this._languages).forEach(t=>{const i=this._languages[t];i.name&&(this._nameMap[i.name]=i.identifier),i.aliases.forEach(n=>{this._lowercaseNameMap[n.toLowerCase()]=i.identifier}),i.mimetypes.forEach(n=>{this._mimeTypesMap[n]=i.identifier})}),_n.as(pd.Configuration).registerOverrideIdentifiers(this.getRegisteredLanguageIds()),this._onDidChange.fire()}_registerLanguage(e){const t=e.id;let i;mN.call(this._languages,t)?i=this._languages[t]:(this.languageIdCodec.register(t),i={identifier:t,name:null,mimetypes:[],aliases:[],extensions:[],filenames:[],configurationFiles:[],icons:[]},this._languages[t]=i),this._mergeLanguage(i,e)}_mergeLanguage(e,t){const i=t.id;let n=null;if(Array.isArray(t.mimetypes)&&t.mimetypes.length>0&&(e.mimetypes.push(...t.mimetypes),n=t.mimetypes[0]),n||(n=`text/x-${i}`,e.mimetypes.push(n)),Array.isArray(t.extensions)){t.configuration?e.extensions=t.extensions.concat(e.extensions):e.extensions=e.extensions.concat(t.extensions);for(const a of t.extensions)pN({id:i,mime:n,extension:a},this._warnOnOverwrite)}if(Array.isArray(t.filenames))for(const a of t.filenames)pN({id:i,mime:n,filename:a},this._warnOnOverwrite),e.filenames.push(a);if(Array.isArray(t.filenamePatterns))for(const a of t.filenamePatterns)pN({id:i,mime:n,filepattern:a},this._warnOnOverwrite);if(typeof t.firstLine=="string"&&t.firstLine.length>0){let a=t.firstLine;a.charAt(0)!=="^"&&(a="^"+a);try{const l=new RegExp(a);WRe(l)||pN({id:i,mime:n,firstline:l},this._warnOnOverwrite)}catch(l){console.warn(`[${t.id}]: Invalid regular expression \`${a}\`: `,l)}}e.aliases.push(i);let r=null;if(typeof t.aliases<"u"&&Array.isArray(t.aliases)&&(t.aliases.length===0?r=[null]:r=t.aliases),r!==null)for(const a of r)!a||a.length===0||e.aliases.push(a);const o=r!==null&&r.length>0;if(!(o&&r[0]===null)){const a=(o?r[0]:null)||i;(o||!e.name)&&(e.name=a)}t.configuration&&e.configurationFiles.push(t.configuration),t.icon&&e.icons.push(t.icon)}isRegisteredLanguageId(e){return e?mN.call(this._languages,e):!1}getRegisteredLanguageIds(){return Object.keys(this._languages)}getLanguageIdByLanguageName(e){const t=e.toLowerCase();return mN.call(this._lowercaseNameMap,t)?this._lowercaseNameMap[t]:null}getLanguageIdByMimeType(e){return e&&mN.call(this._mimeTypesMap,e)?this._mimeTypesMap[e]:null}guessLanguageIdByFilepathOrFirstLine(e,t){return!e&&!t?[]:j3e(e,t)}};wk.instanceCount=0;let s8=wk;const Al=(s,e)=>s===e;function wA(s=Al){return(e,t)=>dn(e,t,s)}function G3e(){return(s,e)=>s.equals(e)}function r8(s,e,t){if(t!==void 0){const i=s;return i==null||e===void 0||e===null?e===i:t(i,e)}else{const i=s;return(n,r)=>n==null||r===void 0||r===null?r===n:i(n,r)}}function CA(s,e){if(s===e)return!0;if(Array.isArray(s)&&Array.isArray(e)){if(s.length!==e.length)return!1;for(let t=0;t<s.length;t++)if(!CA(s[t],e[t]))return!1;return!0}if(s&&typeof s=="object"&&e&&typeof e=="object"&&Object.getPrototypeOf(s)===Object.prototype&&Object.getPrototypeOf(e)===Object.prototype){const t=s,i=e,n=Object.keys(t),r=Object.keys(i),o=new Set(r);if(n.length!==r.length)return!1;for(const a of n)if(!o.has(a)||!CA(t[a],i[a]))return!1;return!0}return!1}class Dr{constructor(e,t,i){this.owner=e,this.debugNameSource=t,this.referenceFn=i}getDebugName(e){return Q3e(e,this)}}const nne=new Map,o8=new WeakMap;function Q3e(s,e){const t=o8.get(s);if(t)return t;const i=Y3e(s,e);if(i){let n=nne.get(i)??0;n++,nne.set(i,n);const r=n===1?i:`${i}#${n}`;return o8.set(s,r),r}}function Y3e(s,e){const t=o8.get(s);if(t)return t;const i=e.owner?Z3e(e.owner)+".":"";let n;const r=e.debugNameSource;if(r!==void 0)if(typeof r=="function"){if(n=r(),n!==void 0)return i+n}else return i+r;const o=e.referenceFn;if(o!==void 0&&(n=AK(o),n!==void 0))return i+n;if(e.owner!==void 0){const a=X3e(e.owner,s);if(a!==void 0)return i+a}}function X3e(s,e){for(const t in s)if(s[t]===e)return t}const sne=new Map,rne=new WeakMap;function Z3e(s){const e=rne.get(s);if(e)return e;const t=J3e(s);let i=sne.get(t)??0;i++,sne.set(t,i);const n=i===1?t:`${t}#${i}`;return rne.set(s,n),n}function J3e(s){const e=s.constructor;return e?e.name:"Object"}function AK(s){const e=s.toString(),i=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(e),n=i?i[1]:void 0;return n==null?void 0:n.trim()}let e9e;function Kfe(){return e9e}let Gfe;function t9e(s){Gfe=s}let Qfe;function i9e(s){Qfe=s}let a8;function n9e(s){a8=s}class Yfe{get TChange(){return null}reportChanges(){this.get()}read(e){return e?e.readObservable(this):this.get()}map(e,t){const i=t===void 0?void 0:e,n=t===void 0?e:t;return a8({owner:i,debugName:()=>{const r=AK(n);if(r!==void 0)return r;const a=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1(?:\??)\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/.exec(n.toString());if(a)return`${this.debugName}.${a[2]}`;if(!i)return`${this.debugName} (mapped)`},debugReferenceFn:n},r=>n(this.read(r),r))}flatten(){return a8({owner:void 0,debugName:()=>`${this.debugName} (flattened)`},e=>this.read(e).read(e))}recomputeInitiallyAndOnChange(e,t){return e.add(Gfe(this,t)),this}keepObserved(e){return e.add(Qfe(this)),this}}class _S extends Yfe{constructor(){super(...arguments),this.observers=new Set}addObserver(e){const t=this.observers.size;this.observers.add(e),t===0&&this.onFirstObserverAdded()}removeObserver(e){this.observers.delete(e)&&this.observers.size===0&&this.onLastObserverRemoved()}onFirstObserverAdded(){}onLastObserverRemoved(){}}function pn(s,e){const t=new bS(s,e);try{s(t)}finally{t.finish()}}let _N;function nL(s){if(_N)s(_N);else{const e=new bS(s,void 0);_N=e;try{s(e)}finally{e.finish(),_N=void 0}}}async function Xfe(s,e){const t=new bS(s,e);try{await s(t)}finally{t.finish()}}function bw(s,e,t){s?e(s):pn(e,t)}class bS{constructor(e,t){this._fn=e,this._getDebugName=t,this.updatingObservers=[]}getDebugName(){return this._getDebugName?this._getDebugName():AK(this._fn)}updateObserver(e,t){this.updatingObservers.push({observer:e,observable:t}),e.beginUpdate(t)}finish(){const e=this.updatingObservers;for(let t=0;t<e.length;t++){const{observer:i,observable:n}=e[t];i.endUpdate(n)}this.updatingObservers=null}}function Rt(s,e){let t;return typeof s=="string"?t=new Dr(void 0,s,void 0):t=new Dr(s,void 0,void 0),new PK(t,e,Al)}class PK extends _S{get debugName(){return this._debugNameData.getDebugName(this)??"ObservableValue"}constructor(e,t,i){super(),this._debugNameData=e,this._equalityComparator=i,this._value=t}get(){return this._value}set(e,t,i){var r;if(i===void 0&&this._equalityComparator(this._value,e))return;let n;t||(t=n=new bS(()=>{},()=>`Setting ${this.debugName}`));try{const o=this._value;this._setValue(e),(r=Kfe())==null||r.handleObservableChanged(this,{oldValue:o,newValue:e,change:i,didChange:!0,hadValue:!0});for(const a of this.observers)t.updateObserver(a,this),a.handleChange(this,i)}finally{n&&n.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(e){this._value=e}}function SI(s,e){let t;return typeof s=="string"?t=new Dr(void 0,s,void 0):t=new Dr(s,void 0,void 0),new s9e(t,e,Al)}class s9e extends PK{_setValue(e){this._value!==e&&(this._value&&this._value.dispose(),this._value=e)}dispose(){var e;(e=this._value)==null||e.dispose()}}function qe(s,e){return e!==void 0?new vw(new Dr(s,void 0,e),e,void 0,void 0,void 0,Al):new vw(new Dr(void 0,void 0,s),s,void 0,void 0,void 0,Al)}function eD(s,e,t){return new r9e(new Dr(s,void 0,e),e,void 0,void 0,void 0,Al,t)}function _l(s,e){return new vw(new Dr(s.owner,s.debugName,s.debugReferenceFn),e,void 0,void 0,s.onLastObserverRemoved,s.equalsFn??Al)}n9e(_l);function Zfe(s,e){return new vw(new Dr(s.owner,s.debugName,void 0),e,s.createEmptyChangeSummary,s.handleChange,void 0,s.equalityComparer??Al)}function __(s,e){let t,i;e===void 0?(t=s,i=void 0):(i=s,t=e);const n=new ce;return new vw(new Dr(i,void 0,t),r=>(n.clear(),t(r,n)),void 0,void 0,()=>n.dispose(),Al)}function Kr(s,e){let t,i;e===void 0?(t=s,i=void 0):(i=s,t=e);let n;return new vw(new Dr(i,void 0,t),r=>{n?n.clear():n=new ce;const o=t(r);return o&&n.add(o),o},void 0,void 0,()=>{n&&(n.dispose(),n=void 0)},Al)}class vw extends _S{get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}constructor(e,t,i,n,r=void 0,o){var a;super(),this._debugNameData=e,this._computeFn=t,this.createChangeSummary=i,this._handleChange=n,this._handleLastObserverRemoved=r,this._equalityComparator=o,this.state=0,this.value=void 0,this.updateCount=0,this.dependencies=new Set,this.dependenciesToBeRemoved=new Set,this.changeSummary=void 0,this.changeSummary=(a=this.createChangeSummary)==null?void 0:a.call(this)}onLastObserverRemoved(){var e;this.state=0,this.value=void 0;for(const t of this.dependencies)t.removeObserver(this);this.dependencies.clear(),(e=this._handleLastObserverRemoved)==null||e.call(this)}get(){var e;if(this.observers.size===0){const t=this._computeFn(this,(e=this.createChangeSummary)==null?void 0:e.call(this));return this.onLastObserverRemoved(),t}else{do{if(this.state===1){for(const t of this.dependencies)if(t.reportChanges(),this.state===2)break}this.state===1&&(this.state=3),this._recomputeIfNeeded()}while(this.state!==3);return this.value}}_recomputeIfNeeded(){var o;if(this.state===3)return;const e=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=e;const t=this.state!==0,i=this.value;this.state=3;const n=this.changeSummary;this.changeSummary=(o=this.createChangeSummary)==null?void 0:o.call(this);try{this.value=this._computeFn(this,n)}finally{for(const a of this.dependenciesToBeRemoved)a.removeObserver(this);this.dependenciesToBeRemoved.clear()}if(t&&!this._equalityComparator(i,this.value))for(const a of this.observers)a.handleChange(this,void 0)}toString(){return`LazyDerived<${this.debugName}>`}beginUpdate(e){this.updateCount++;const t=this.updateCount===1;if(this.state===3&&(this.state=1,!t))for(const i of this.observers)i.handlePossibleChange(this);if(t)for(const i of this.observers)i.beginUpdate(this)}endUpdate(e){if(this.updateCount--,this.updateCount===0){const t=[...this.observers];for(const i of t)i.endUpdate(this)}fw(()=>this.updateCount>=0)}handlePossibleChange(e){if(this.state===3&&this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)){this.state=1;for(const t of this.observers)t.handlePossibleChange(this)}}handleChange(e,t){if(this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)){const i=this._handleChange?this._handleChange({changedObservable:e,change:t,didChange:r=>r===e},this.changeSummary):!0,n=this.state===3;if(i&&(this.state===1||n)&&(this.state=2,n))for(const r of this.observers)r.handlePossibleChange(this)}}readObservable(e){e.addObserver(this);const t=e.get();return this.dependencies.add(e),this.dependenciesToBeRemoved.delete(e),t}addObserver(e){const t=!this.observers.has(e)&&this.updateCount>0;super.addObserver(e),t&&e.beginUpdate(this)}removeObserver(e){const t=this.observers.has(e)&&this.updateCount>0;super.removeObserver(e),t&&e.endUpdate(this)}}class r9e extends vw{constructor(e,t,i,n,r=void 0,o,a){super(e,t,i,n,r,o),this.set=a}}function ht(s){return new VF(new Dr(void 0,void 0,s),s,void 0,void 0)}function tD(s,e){return new VF(new Dr(s.owner,s.debugName,s.debugReferenceFn??e),e,void 0,void 0)}function iD(s,e){return new VF(new Dr(s.owner,s.debugName,s.debugReferenceFn??e),e,s.createEmptyChangeSummary,s.handleChange)}function o9e(s,e){const t=new ce,i=iD({owner:s.owner,debugName:s.debugName,debugReferenceFn:s.debugReferenceFn??e,createEmptyChangeSummary:s.createEmptyChangeSummary,handleChange:s.handleChange},(n,r)=>{t.clear(),e(n,r,t)});return Ye(()=>{i.dispose(),t.dispose()})}function Jo(s){const e=new ce,t=tD({owner:void 0,debugName:void 0,debugReferenceFn:s},i=>{e.clear(),s(i,e)});return Ye(()=>{t.dispose(),e.dispose()})}class VF{get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}constructor(e,t,i,n){var r;this._debugNameData=e,this._runFn=t,this.createChangeSummary=i,this._handleChange=n,this.state=2,this.updateCount=0,this.disposed=!1,this.dependencies=new Set,this.dependenciesToBeRemoved=new Set,this.changeSummary=(r=this.createChangeSummary)==null?void 0:r.call(this),this._runIfNeeded()}dispose(){this.disposed=!0;for(const e of this.dependencies)e.removeObserver(this);this.dependencies.clear()}_runIfNeeded(){var i,n;if(this.state===3)return;const e=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=e,this.state=3;const t=this.disposed;try{if(!t){(i=Kfe())==null||i.handleAutorunTriggered(this);const r=this.changeSummary;this.changeSummary=(n=this.createChangeSummary)==null?void 0:n.call(this),this._runFn(this,r)}}finally{for(const r of this.dependenciesToBeRemoved)r.removeObserver(this);this.dependenciesToBeRemoved.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(){this.state===3&&(this.state=1),this.updateCount++}endUpdate(){if(this.updateCount===1)do{if(this.state===1){this.state=3;for(const e of this.dependencies)if(e.reportChanges(),this.state===2)break}this._runIfNeeded()}while(this.state!==3);this.updateCount--,fw(()=>this.updateCount>=0)}handlePossibleChange(e){this.state===3&&this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)&&(this.state=1)}handleChange(e,t){this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)&&(!this._handleChange||this._handleChange({changedObservable:e,change:t,didChange:n=>n===e},this.changeSummary))&&(this.state=2)}readObservable(e){if(this.disposed)return e.get();e.addObserver(this);const t=e.get();return this.dependencies.add(e),this.dependenciesToBeRemoved.delete(e),t}}(function(s){s.Observer=VF})(ht||(ht={}));function hc(s){return new a9e(s)}class a9e extends Yfe{constructor(e){super(),this.value=e}get debugName(){return this.toString()}get(){return this.value}addObserver(e){}removeObserver(e){}toString(){return`Const: ${this.value}`}}function wi(...s){let e,t,i;return s.length===3?[e,t,i]=s:[t,i]=s,new Kp(new Dr(e,void 0,i),t,i,()=>Kp.globalTransaction,Al)}function l9e(s,e,t){return new Kp(new Dr(s.owner,s.debugName,s.debugReferenceFn??t),e,t,()=>Kp.globalTransaction,s.equalsFn??Al)}class Kp extends _S{constructor(e,t,i,n,r){super(),this._debugNameData=e,this.event=t,this._getValue=i,this._getTransaction=n,this._equalityComparator=r,this.hasValue=!1,this.handleEvent=o=>{const a=this._getValue(o),l=this.value;(!this.hasValue||!this._equalityComparator(l,a))&&(this.value=a,this.hasValue&&bw(this._getTransaction(),d=>{for(const u of this.observers)d.updateObserver(u,this),u.handleChange(this,void 0)},()=>{const d=this.getDebugName();return"Event fired"+(d?`: ${d}`:"")}),this.hasValue=!0)}}getDebugName(){return this._debugNameData.getDebugName(this)}get debugName(){const e=this.getDebugName();return"From Event"+(e?`: ${e}`:"")}onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0,this.hasValue=!1,this.value=void 0}get(){return this.subscription?(this.hasValue||this.handleEvent(void 0),this.value):this._getValue(void 0)}}(function(s){s.Observer=Kp;function e(t,i){let n=!1;Kp.globalTransaction===void 0&&(Kp.globalTransaction=t,n=!0);try{i()}finally{n&&(Kp.globalTransaction=void 0)}}s.batchEventsGlobally=e})(wi||(wi={}));function cr(s,e){return new c9e(s,e)}class c9e extends _S{constructor(e,t){super(),this.debugName=e,this.event=t,this.handleEvent=()=>{pn(i=>{for(const n of this.observers)i.updateObserver(n,this),n.handleChange(this,void 0)},()=>this.debugName)}}onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0}get(){}}function vS(s){return typeof s=="string"?new one(s):new one(void 0,s)}class one extends _S{get debugName(){return new Dr(this._owner,this._debugName,void 0).getDebugName(this)??"Observable Signal"}toString(){return this.debugName}constructor(e,t){super(),this._debugName=e,this._owner=t}trigger(e,t){if(!e){pn(i=>{this.trigger(i,t)},()=>`Trigger signal ${this.debugName}`);return}for(const i of this.observers)e.updateObserver(i,this),i.handleChange(this,t)}get(){}}function d9e(s){const e=new Jfe(!1,void 0);return s.addObserver(e),Ye(()=>{s.removeObserver(e)})}i9e(d9e);function wS(s,e){const t=new Jfe(!0,e);return s.addObserver(t),e?e(s.get()):s.reportChanges(),Ye(()=>{s.removeObserver(t)})}t9e(wS);class Jfe{constructor(e,t){this._forceRecompute=e,this._handleValue=t,this._counter=0}beginUpdate(e){this._counter++}endUpdate(e){this._counter--,this._counter===0&&this._forceRecompute&&(this._handleValue?this._handleValue(e.get()):e.reportChanges())}handlePossibleChange(e){}handleChange(e,t){}}function nD(s,e){let t;return _l({owner:s,debugReferenceFn:e},n=>(t=e(n,t),t))}function u9e(s,e,t,i){let n=new ane(t,i);return _l({debugReferenceFn:t,owner:s,onLastObserverRemoved:()=>{n.dispose(),n=new ane(t)}},o=>(n.setItems(e.read(o)),n.getItems()))}class ane{constructor(e,t){this._map=e,this._keySelector=t,this._cache=new Map,this._items=[]}dispose(){this._cache.forEach(e=>e.store.dispose()),this._cache.clear()}setItems(e){const t=[],i=new Set(this._cache.keys());for(const n of e){const r=this._keySelector?this._keySelector(n):n;let o=this._cache.get(r);if(o)i.delete(r);else{const a=new ce;o={out:this._map(n,a),store:a},this._cache.set(r,o)}t.push(o.out)}for(const n of i)this._cache.get(n).store.dispose(),this._cache.delete(n);this._items=t}getItems(){return this._items}}function h9e(s,e){return nD(s,(t,i)=>i??e(t))}class BF{static fromFn(e){return new BF(e())}constructor(e){this._value=Rt(this,void 0),this.promiseResult=this._value,this.promise=e.then(t=>(pn(i=>{this._value.set(new lne(t,void 0),i)}),t),t=>{throw pn(i=>{this._value.set(new lne(void 0,t),i)}),t})}}class lne{constructor(e,t){this.data=e,this.error=t}}function ege(s,e,t,i){return e||(e=n=>n!=null),new Promise((n,r)=>{let o=!0,a=!1;const l=s.map(d=>({isFinished:e(d),error:t?t(d):!1,state:d})),c=ht(d=>{const{isFinished:u,error:h,state:g}=l.read(d);(u||h)&&(o?a=!0:c.dispose(),h?r(h===!0?g:h):n(g))});if(i){const d=i.onCancellationRequested(()=>{c.dispose(),d.dispose(),r(new od)});if(i.isCancellationRequested){c.dispose(),d.dispose(),r(new od);return}}o=!1,a&&c.dispose()})}class f9e extends _S{get debugName(){return this._debugNameData.getDebugName(this)??"LazyObservableValue"}constructor(e,t,i){super(),this._debugNameData=e,this._equalityComparator=i,this._isUpToDate=!0,this._deltas=[],this._updateCounter=0,this._value=t}get(){return this._update(),this._value}_update(){if(!this._isUpToDate)if(this._isUpToDate=!0,this._deltas.length>0){for(const e of this.observers)for(const t of this._deltas)e.handleChange(this,t);this._deltas.length=0}else for(const e of this.observers)e.handleChange(this,void 0)}_beginUpdate(){if(this._updateCounter++,this._updateCounter===1)for(const e of this.observers)e.beginUpdate(this)}_endUpdate(){if(this._updateCounter--,this._updateCounter===0){this._update();const e=[...this.observers];for(const t of e)t.endUpdate(this)}}addObserver(e){const t=!this.observers.has(e)&&this._updateCounter>0;super.addObserver(e),t&&e.beginUpdate(this)}removeObserver(e){const t=this.observers.has(e)&&this._updateCounter>0;super.removeObserver(e),t&&e.endUpdate(this)}set(e,t,i){if(i===void 0&&this._equalityComparator(this._value,e))return;let n;t||(t=n=new bS(()=>{},()=>`Setting ${this.debugName}`));try{if(this._isUpToDate=!1,this._setValue(e),i!==void 0&&this._deltas.push(i),t.updateObserver({beginUpdate:()=>this._beginUpdate(),endUpdate:()=>this._endUpdate(),handleChange:(r,o)=>{},handlePossibleChange:r=>{}},this),this._updateCounter>1)for(const r of this.observers)r.handlePossibleChange(this)}finally{n&&n.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(e){this._value=e}}function l8(s,e){return s.lazy?new f9e(new Dr(s.owner,s.debugName,void 0),e,s.equalsFn??Al):new PK(new Dr(s.owner,s.debugName,void 0),e,s.equalsFn??Al)}const Ck=class Ck extends te{constructor(e=!1){super(),this._onDidRequestBasicLanguageFeatures=this._register(new Z),this.onDidRequestBasicLanguageFeatures=this._onDidRequestBasicLanguageFeatures.event,this._onDidRequestRichLanguageFeatures=this._register(new Z),this.onDidRequestRichLanguageFeatures=this._onDidRequestRichLanguageFeatures.event,this._onDidChange=this._register(new Z({leakWarningThreshold:200})),this.onDidChange=this._onDidChange.event,this._requestedBasicLanguages=new Set,this._requestedRichLanguages=new Set,Ck.instanceCount++,this._registry=this._register(new s8(!0,e)),this.languageIdCodec=this._registry.languageIdCodec,this._register(this._registry.onDidChange(()=>this._onDidChange.fire()))}dispose(){Ck.instanceCount--,super.dispose()}isRegisteredLanguageId(e){return this._registry.isRegisteredLanguageId(e)}getLanguageIdByLanguageName(e){return this._registry.getLanguageIdByLanguageName(e)}getLanguageIdByMimeType(e){return this._registry.getLanguageIdByMimeType(e)}guessLanguageIdByFilepathOrFirstLine(e,t){const i=this._registry.guessLanguageIdByFilepathOrFirstLine(e,t);return pq(i,null)}createById(e){return new cne(this.onDidChange,()=>this._createAndGetLanguageIdentifier(e))}createByFilepathOrFirstLine(e,t){return new cne(this.onDidChange,()=>{const i=this.guessLanguageIdByFilepathOrFirstLine(e,t);return this._createAndGetLanguageIdentifier(i)})}_createAndGetLanguageIdentifier(e){return(!e||!this.isRegisteredLanguageId(e))&&(e=So),e}requestBasicLanguageFeatures(e){this._requestedBasicLanguages.has(e)||(this._requestedBasicLanguages.add(e),this._onDidRequestBasicLanguageFeatures.fire(e))}requestRichLanguageFeatures(e){this._requestedRichLanguages.has(e)||(this._requestedRichLanguages.add(e),this.requestBasicLanguageFeatures(e),Ln.getOrCreate(e),this._onDidRequestRichLanguageFeatures.fire(e))}};Ck.instanceCount=0;let c8=Ck;class cne{constructor(e,t){this._value=wi(this,e,()=>t()),this.onDidChange=De.fromObservable(this._value)}get languageId(){return this._value.get()}}const xI={RESOURCES:"ResourceURLs",TEXT:An.text,INTERNAL_URI_LIST:"application/vnd.code.uri-list"},g9e=()=>({get delay(){return-1},dispose:()=>{},showHover:()=>{}});let WF=g9e;const p9e=new uu(()=>WF("mouse",!1)),m9e=new uu(()=>WF("element",!1));function _9e(s){WF=s}function No(s){return s==="element"?m9e.value:p9e.value}function k1(){return WF("element",!0)}let tge={showHover:()=>{},hideHover:()=>{},showAndFocusLastHover:()=>{},setupManagedHover:()=>null,showManagedHover:()=>{}};function b9e(s){tge=s}function wu(){return tge}class v9e{constructor(e){this.spliceables=e}splice(e,t,i){this.spliceables.forEach(n=>n.splice(e,t,i))}}class q_ extends Error{constructor(e,t){super(`ListError [${e}] ${t}`)}}function dne(s,e){const t=[];for(const i of e){if(s.start>=i.range.end)continue;if(s.end<i.range.start)break;const n=yr.intersect(s,i.range);yr.isEmpty(n)||t.push({range:n,size:i.size})}return t}function d8({start:s,end:e},t){return{start:s+t,end:e+t}}function w9e(s){const e=[];let t=null;for(const i of s){const n=i.range.start,r=i.range.end,o=i.size;if(t&&o===t.size){t.range.end=r;continue}t={range:{start:n,end:r},size:o},e.push(t)}return e}function C9e(...s){return w9e(s.reduce((e,t)=>e.concat(t),[]))}class y9e{get paddingTop(){return this._paddingTop}set paddingTop(e){this._size=this._size+e-this._paddingTop,this._paddingTop=e}constructor(e){this.groups=[],this._size=0,this._paddingTop=0,this._paddingTop=e??0,this._size=this._paddingTop}splice(e,t,i=[]){const n=i.length-t,r=dne({start:0,end:e},this.groups),o=dne({start:e+t,end:Number.POSITIVE_INFINITY},this.groups).map(l=>({range:d8(l.range,n),size:l.size})),a=i.map((l,c)=>({range:{start:e+c,end:e+c+1},size:l.size}));this.groups=C9e(r,a,o),this._size=this._paddingTop+this.groups.reduce((l,c)=>l+c.size*(c.range.end-c.range.start),0)}get count(){const e=this.groups.length;return e?this.groups[e-1].range.end:0}get size(){return this._size}indexAt(e){if(e<0)return-1;if(e<this._paddingTop)return 0;let t=0,i=this._paddingTop;for(const n of this.groups){const r=n.range.end-n.range.start,o=i+r*n.size;if(e<o)return t+Math.floor((e-i)/n.size);t+=r,i=o}return t}indexAfter(e){return Math.min(this.indexAt(e)+1,this.count)}positionAt(e){if(e<0)return-1;let t=0,i=0;for(const n of this.groups){const r=n.range.end-n.range.start,o=i+r;if(e<o)return this._paddingTop+t+(e-i)*n.size;t+=r*n.size,i=o}return-1}}class S9e{constructor(e){this.renderers=e,this.cache=new Map,this.transactionNodesPendingRemoval=new Set,this.inTransaction=!1}alloc(e){let t=this.getTemplateCache(e).pop(),i=!1;if(t)i=this.transactionNodesPendingRemoval.has(t.domNode),i&&this.transactionNodesPendingRemoval.delete(t.domNode);else{const n=ke(".monaco-list-row"),o=this.getRenderer(e).renderTemplate(n);t={domNode:n,templateId:e,templateData:o}}return{row:t,isReusingConnectedDomNode:i}}release(e){e&&this.releaseRow(e)}transact(e){if(this.inTransaction)throw new Error("Already in transaction");this.inTransaction=!0;try{e()}finally{for(const t of this.transactionNodesPendingRemoval)this.doRemoveNode(t);this.transactionNodesPendingRemoval.clear(),this.inTransaction=!1}}releaseRow(e){const{domNode:t,templateId:i}=e;t&&(this.inTransaction?this.transactionNodesPendingRemoval.add(t):this.doRemoveNode(t)),this.getTemplateCache(i).push(e)}doRemoveNode(e){e.classList.remove("scrolling"),e.remove()}getTemplateCache(e){let t=this.cache.get(e);return t||(t=[],this.cache.set(e,t)),t}dispose(){this.cache.forEach((e,t)=>{for(const i of e)this.getRenderer(t).disposeTemplate(i.templateData),i.templateData=null}),this.cache.clear(),this.transactionNodesPendingRemoval.clear()}getRenderer(e){const t=this.renderers.get(e);if(!t)throw new Error(`No renderer found for ${e}`);return t}}var Vg=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r};const K_={CurrentDragAndDropData:void 0},Vu={useShadows:!0,verticalScrollMode:1,setRowLineHeight:!0,setRowHeight:!0,supportDynamicHeights:!1,dnd:{getDragElements(s){return[s]},getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){},dispose(){}},horizontalScrolling:!1,transformOptimization:!0,alwaysConsumeMouseWheel:!0};class sD{constructor(e){this.elements=e}update(){}getData(){return this.elements}}class x9e{constructor(e){this.elements=e}update(){}getData(){return this.elements}}class L9e{constructor(){this.types=[],this.files=[]}update(e){if(e.types&&this.types.splice(0,this.types.length,...e.types),e.files){this.files.splice(0,this.files.length);for(let t=0;t<e.files.length;t++){const i=e.files.item(t);i&&(i.size||i.type)&&this.files.push(i)}}}getData(){return{types:this.types,files:this.files}}}function k9e(s,e){return Array.isArray(s)&&Array.isArray(e)?dn(s,e):s===e}class I9e{constructor(e){e!=null&&e.getSetSize?this.getSetSize=e.getSetSize.bind(e):this.getSetSize=(t,i,n)=>n,e!=null&&e.getPosInSet?this.getPosInSet=e.getPosInSet.bind(e):this.getPosInSet=(t,i)=>i+1,e!=null&&e.getRole?this.getRole=e.getRole.bind(e):this.getRole=t=>"listitem",e!=null&&e.isChecked?this.isChecked=e.isChecked.bind(e):this.isChecked=t=>{}}}const jM=class jM{get contentHeight(){return this.rangeMap.size}get onDidScroll(){return this.scrollableElement.onScroll}get scrollableElementDomNode(){return this.scrollableElement.getDomNode()}get horizontalScrolling(){return this._horizontalScrolling}set horizontalScrolling(e){if(e!==this._horizontalScrolling){if(e&&this.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");if(this._horizontalScrolling=e,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this._horizontalScrolling){for(const t of this.items)this.measureItemWidth(t);this.updateScrollWidth(),this.scrollableElement.setScrollDimensions({width:nV(this.domNode)}),this.rowsContainer.style.width=`${Math.max(this.scrollWidth||0,this.renderWidth)}px`}else this.scrollableElementWidthDelayer.cancel(),this.scrollableElement.setScrollDimensions({width:this.renderWidth,scrollWidth:this.renderWidth}),this.rowsContainer.style.width=""}}constructor(e,t,i,n=Vu){var o,a;if(this.virtualDelegate=t,this.domId=`list_id_${++jM.InstanceCount}`,this.renderers=new Map,this.renderWidth=0,this._scrollHeight=0,this.scrollableElementUpdateDisposable=null,this.scrollableElementWidthDelayer=new bc(50),this.splicing=!1,this.dragOverAnimationStopDisposable=te.None,this.dragOverMouseY=0,this.canDrop=!1,this.currentDragFeedbackDisposable=te.None,this.onDragLeaveTimeout=te.None,this.disposables=new ce,this._onDidChangeContentHeight=new Z,this._onDidChangeContentWidth=new Z,this.onDidChangeContentHeight=De.latch(this._onDidChangeContentHeight.event,void 0,this.disposables),this._horizontalScrolling=!1,n.horizontalScrolling&&n.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");this.items=[],this.itemId=0,this.rangeMap=this.createRangeMap(n.paddingTop??0);for(const l of i)this.renderers.set(l.templateId,l);this.cache=this.disposables.add(new S9e(this.renderers)),this.lastRenderTop=0,this.lastRenderHeight=0,this.domNode=document.createElement("div"),this.domNode.className="monaco-list",this.domNode.classList.add(this.domId),this.domNode.tabIndex=0,this.domNode.classList.toggle("mouse-support",typeof n.mouseSupport=="boolean"?n.mouseSupport:!0),this._horizontalScrolling=n.horizontalScrolling??Vu.horizontalScrolling,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this.paddingBottom=typeof n.paddingBottom>"u"?0:n.paddingBottom,this.accessibilityProvider=new I9e(n.accessibilityProvider),this.rowsContainer=document.createElement("div"),this.rowsContainer.className="monaco-list-rows",(n.transformOptimization??Vu.transformOptimization)&&(this.rowsContainer.style.transform="translate3d(0px, 0px, 0px)",this.rowsContainer.style.overflow="hidden",this.rowsContainer.style.contain="strict"),this.disposables.add(Er.addTarget(this.rowsContainer)),this.scrollable=this.disposables.add(new mS({forceIntegerValues:!0,smoothScrollDuration:n.smoothScrolling??!1?125:0,scheduleAtNextAnimationFrame:l=>Fa(nt(this.domNode),l)})),this.scrollableElement=this.disposables.add(new DF(this.rowsContainer,{alwaysConsumeMouseWheel:n.alwaysConsumeMouseWheel??Vu.alwaysConsumeMouseWheel,horizontal:1,vertical:n.verticalScrollMode??Vu.verticalScrollMode,useShadows:n.useShadows??Vu.useShadows,mouseWheelScrollSensitivity:n.mouseWheelScrollSensitivity,fastScrollSensitivity:n.fastScrollSensitivity,scrollByPage:n.scrollByPage},this.scrollable)),this.domNode.appendChild(this.scrollableElement.getDomNode()),e.appendChild(this.domNode),this.scrollableElement.onScroll(this.onScroll,this,this.disposables),this.disposables.add(oe(this.rowsContainer,Vi.Change,l=>this.onTouchChange(l))),this.disposables.add(oe(this.scrollableElement.getDomNode(),"scroll",l=>l.target.scrollTop=0)),this.disposables.add(oe(this.domNode,"dragover",l=>this.onDragOver(this.toDragEvent(l)))),this.disposables.add(oe(this.domNode,"drop",l=>this.onDrop(this.toDragEvent(l)))),this.disposables.add(oe(this.domNode,"dragleave",l=>this.onDragLeave(this.toDragEvent(l)))),this.disposables.add(oe(this.domNode,"dragend",l=>this.onDragEnd(l))),this.setRowLineHeight=n.setRowLineHeight??Vu.setRowLineHeight,this.setRowHeight=n.setRowHeight??Vu.setRowHeight,this.supportDynamicHeights=n.supportDynamicHeights??Vu.supportDynamicHeights,this.dnd=n.dnd??this.disposables.add(Vu.dnd),this.layout((o=n.initialSize)==null?void 0:o.height,(a=n.initialSize)==null?void 0:a.width)}updateOptions(e){e.paddingBottom!==void 0&&(this.paddingBottom=e.paddingBottom,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),e.smoothScrolling!==void 0&&this.scrollable.setSmoothScrollDuration(e.smoothScrolling?125:0),e.horizontalScrolling!==void 0&&(this.horizontalScrolling=e.horizontalScrolling);let t;if(e.scrollByPage!==void 0&&(t={...t??{},scrollByPage:e.scrollByPage}),e.mouseWheelScrollSensitivity!==void 0&&(t={...t??{},mouseWheelScrollSensitivity:e.mouseWheelScrollSensitivity}),e.fastScrollSensitivity!==void 0&&(t={...t??{},fastScrollSensitivity:e.fastScrollSensitivity}),t&&this.scrollableElement.updateOptions(t),e.paddingTop!==void 0&&e.paddingTop!==this.rangeMap.paddingTop){const i=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),n=e.paddingTop-this.rangeMap.paddingTop;this.rangeMap.paddingTop=e.paddingTop,this.render(i,Math.max(0,this.lastRenderTop+n),this.lastRenderHeight,void 0,void 0,!0),this.setScrollTop(this.lastRenderTop),this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.lastRenderTop,this.lastRenderHeight)}}createRangeMap(e){return new y9e(e)}splice(e,t,i=[]){if(this.splicing)throw new Error("Can't run recursive splices.");this.splicing=!0;try{return this._splice(e,t,i)}finally{this.splicing=!1,this._onDidChangeContentHeight.fire(this.contentHeight)}}_splice(e,t,i=[]){const n=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),r={start:e,end:e+t},o=yr.intersect(n,r),a=new Map;for(let I=o.end-1;I>=o.start;I--){const A=this.items[I];if(A.dragStartDisposable.dispose(),A.checkedDisposable.dispose(),A.row){let D=a.get(A.templateId);D||(D=[],a.set(A.templateId,D));const N=this.renderers.get(A.templateId);N&&N.disposeElement&&N.disposeElement(A.element,I,A.row.templateData,A.size),D.unshift(A.row)}A.row=null,A.stale=!0}const l={start:e+t,end:this.items.length},c=yr.intersect(l,n),d=yr.relativeComplement(l,n),u=i.map(I=>({id:String(this.itemId++),element:I,templateId:this.virtualDelegate.getTemplateId(I),size:this.virtualDelegate.getHeight(I),width:void 0,hasDynamicHeight:!!this.virtualDelegate.hasDynamicHeight&&this.virtualDelegate.hasDynamicHeight(I),lastDynamicHeightWidth:void 0,row:null,uri:void 0,dropTarget:!1,dragStartDisposable:te.None,checkedDisposable:te.None,stale:!1}));let h;e===0&&t>=this.items.length?(this.rangeMap=this.createRangeMap(this.rangeMap.paddingTop),this.rangeMap.splice(0,0,u),h=this.items,this.items=u):(this.rangeMap.splice(e,t,u),h=this.items.splice(e,t,...u));const g=i.length-t,p=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),_=d8(c,g),v=yr.intersect(p,_);for(let I=v.start;I<v.end;I++)this.updateItemInDOM(this.items[I],I);const C=yr.relativeComplement(_,p);for(const I of C)for(let A=I.start;A<I.end;A++)this.removeItemFromDOM(A);const y=d.map(I=>d8(I,g)),L=[{start:e,end:e+i.length},...y].map(I=>yr.intersect(p,I)).reverse();for(const I of L)for(let A=I.end-1;A>=I.start;A--){const D=this.items[A],N=a.get(D.templateId),R=N==null?void 0:N.pop();this.insertItemInDOM(A,R)}for(const I of a.values())for(const A of I)this.cache.release(A);return this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight),h.map(I=>I.element)}eventuallyUpdateScrollDimensions(){this._scrollHeight=this.contentHeight,this.rowsContainer.style.height=`${this._scrollHeight}px`,this.scrollableElementUpdateDisposable||(this.scrollableElementUpdateDisposable=Fa(nt(this.domNode),()=>{this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight}),this.updateScrollWidth(),this.scrollableElementUpdateDisposable=null}))}eventuallyUpdateScrollWidth(){if(!this.horizontalScrolling){this.scrollableElementWidthDelayer.cancel();return}this.scrollableElementWidthDelayer.trigger(()=>this.updateScrollWidth())}updateScrollWidth(){if(!this.horizontalScrolling)return;let e=0;for(const t of this.items)typeof t.width<"u"&&(e=Math.max(e,t.width));this.scrollWidth=e,this.scrollableElement.setScrollDimensions({scrollWidth:e===0?0:e+10}),this._onDidChangeContentWidth.fire(this.scrollWidth)}rerender(){if(this.supportDynamicHeights){for(const e of this.items)e.lastDynamicHeightWidth=void 0;this._rerender(this.lastRenderTop,this.lastRenderHeight)}}get length(){return this.items.length}get renderHeight(){return this.scrollableElement.getScrollDimensions().height}get firstVisibleIndex(){return this.getRenderRange(this.lastRenderTop,this.lastRenderHeight).start}element(e){return this.items[e].element}indexOf(e){return this.items.findIndex(t=>t.element===e)}domElement(e){const t=this.items[e].row;return t&&t.domNode}elementHeight(e){return this.items[e].size}elementTop(e){return this.rangeMap.positionAt(e)}indexAt(e){return this.rangeMap.indexAt(e)}indexAfter(e){return this.rangeMap.indexAfter(e)}layout(e,t){const i={height:typeof e=="number"?e:G2e(this.domNode)};this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,i.scrollHeight=this.scrollHeight),this.scrollableElement.setScrollDimensions(i),typeof t<"u"&&(this.renderWidth=t,this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight)),this.horizontalScrolling&&this.scrollableElement.setScrollDimensions({width:typeof t=="number"?t:nV(this.domNode)})}render(e,t,i,n,r,o=!1){const a=this.getRenderRange(t,i),l=yr.relativeComplement(a,e).reverse(),c=yr.relativeComplement(e,a);if(o){const d=yr.intersect(e,a);for(let u=d.start;u<d.end;u++)this.updateItemInDOM(this.items[u],u)}this.cache.transact(()=>{for(const d of c)for(let u=d.start;u<d.end;u++)this.removeItemFromDOM(u);for(const d of l)for(let u=d.end-1;u>=d.start;u--)this.insertItemInDOM(u)}),n!==void 0&&(this.rowsContainer.style.left=`-${n}px`),this.rowsContainer.style.top=`-${t}px`,this.horizontalScrolling&&r!==void 0&&(this.rowsContainer.style.width=`${Math.max(r,this.renderWidth)}px`),this.lastRenderTop=t,this.lastRenderHeight=i}insertItemInDOM(e,t){var l,c;const i=this.items[e];if(!i.row)if(t)i.row=t,i.stale=!0;else{const d=this.cache.alloc(i.templateId);i.row=d.row,i.stale||(i.stale=d.isReusingConnectedDomNode)}const n=this.accessibilityProvider.getRole(i.element)||"listitem";i.row.domNode.setAttribute("role",n);const r=this.accessibilityProvider.isChecked(i.element);if(typeof r=="boolean")i.row.domNode.setAttribute("aria-checked",String(!!r));else if(r){const d=u=>i.row.domNode.setAttribute("aria-checked",String(!!u));d(r.value),i.checkedDisposable=r.onDidChange(()=>d(r.value))}if(i.stale||!i.row.domNode.parentElement){const d=((c=(l=this.items.at(e+1))==null?void 0:l.row)==null?void 0:c.domNode)??null;(i.row.domNode.parentElement!==this.rowsContainer||i.row.domNode.nextElementSibling!==d)&&this.rowsContainer.insertBefore(i.row.domNode,d),i.stale=!1}this.updateItemInDOM(i,e);const o=this.renderers.get(i.templateId);if(!o)throw new Error(`No renderer found for template id ${i.templateId}`);o==null||o.renderElement(i.element,e,i.row.templateData,i.size);const a=this.dnd.getDragURI(i.element);i.dragStartDisposable.dispose(),i.row.domNode.draggable=!!a,a&&(i.dragStartDisposable=oe(i.row.domNode,"dragstart",d=>this.onDragStart(i.element,a,d))),this.horizontalScrolling&&(this.measureItemWidth(i),this.eventuallyUpdateScrollWidth())}measureItemWidth(e){if(!e.row||!e.row.domNode)return;e.row.domNode.style.width="fit-content",e.width=nV(e.row.domNode);const t=nt(e.row.domNode).getComputedStyle(e.row.domNode);t.paddingLeft&&(e.width+=parseFloat(t.paddingLeft)),t.paddingRight&&(e.width+=parseFloat(t.paddingRight)),e.row.domNode.style.width=""}updateItemInDOM(e,t){e.row.domNode.style.top=`${this.elementTop(t)}px`,this.setRowHeight&&(e.row.domNode.style.height=`${e.size}px`),this.setRowLineHeight&&(e.row.domNode.style.lineHeight=`${e.size}px`),e.row.domNode.setAttribute("data-index",`${t}`),e.row.domNode.setAttribute("data-last-element",t===this.length-1?"true":"false"),e.row.domNode.setAttribute("data-parity",t%2===0?"even":"odd"),e.row.domNode.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(e.element,t,this.length))),e.row.domNode.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(e.element,t))),e.row.domNode.setAttribute("id",this.getElementDomId(t)),e.row.domNode.classList.toggle("drop-target",e.dropTarget)}removeItemFromDOM(e){const t=this.items[e];if(t.dragStartDisposable.dispose(),t.checkedDisposable.dispose(),t.row){const i=this.renderers.get(t.templateId);i&&i.disposeElement&&i.disposeElement(t.element,e,t.row.templateData,t.size),this.cache.release(t.row),t.row=null}this.horizontalScrolling&&this.eventuallyUpdateScrollWidth()}getScrollTop(){return this.scrollableElement.getScrollPosition().scrollTop}setScrollTop(e,t){this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),this.scrollableElement.setScrollPosition({scrollTop:e,reuseAnimation:t})}get scrollTop(){return this.getScrollTop()}set scrollTop(e){this.setScrollTop(e)}get scrollHeight(){return this._scrollHeight+(this.horizontalScrolling?10:0)+this.paddingBottom}get onMouseClick(){return De.map(this.disposables.add(new Ut(this.domNode,"click")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseDblClick(){return De.map(this.disposables.add(new Ut(this.domNode,"dblclick")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseMiddleClick(){return De.filter(De.map(this.disposables.add(new Ut(this.domNode,"auxclick")).event,e=>this.toMouseEvent(e),this.disposables),e=>e.browserEvent.button===1,this.disposables)}get onMouseDown(){return De.map(this.disposables.add(new Ut(this.domNode,"mousedown")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseOver(){return De.map(this.disposables.add(new Ut(this.domNode,"mouseover")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseOut(){return De.map(this.disposables.add(new Ut(this.domNode,"mouseout")).event,e=>this.toMouseEvent(e),this.disposables)}get onContextMenu(){return De.any(De.map(this.disposables.add(new Ut(this.domNode,"contextmenu")).event,e=>this.toMouseEvent(e),this.disposables),De.map(this.disposables.add(new Ut(this.domNode,Vi.Contextmenu)).event,e=>this.toGestureEvent(e),this.disposables))}get onTouchStart(){return De.map(this.disposables.add(new Ut(this.domNode,"touchstart")).event,e=>this.toTouchEvent(e),this.disposables)}get onTap(){return De.map(this.disposables.add(new Ut(this.rowsContainer,Vi.Tap)).event,e=>this.toGestureEvent(e),this.disposables)}toMouseEvent(e){const t=this.getItemIndexFromEventTarget(e.target||null),i=typeof t>"u"?void 0:this.items[t],n=i&&i.element;return{browserEvent:e,index:t,element:n}}toTouchEvent(e){const t=this.getItemIndexFromEventTarget(e.target||null),i=typeof t>"u"?void 0:this.items[t],n=i&&i.element;return{browserEvent:e,index:t,element:n}}toGestureEvent(e){const t=this.getItemIndexFromEventTarget(e.initialTarget||null),i=typeof t>"u"?void 0:this.items[t],n=i&&i.element;return{browserEvent:e,index:t,element:n}}toDragEvent(e){const t=this.getItemIndexFromEventTarget(e.target||null),i=typeof t>"u"?void 0:this.items[t],n=i&&i.element,r=this.getTargetSector(e,t);return{browserEvent:e,index:t,element:n,sector:r}}onScroll(e){try{const t=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight);this.render(t,e.scrollTop,e.height,e.scrollLeft,e.scrollWidth),this.supportDynamicHeights&&this._rerender(e.scrollTop,e.height,e.inSmoothScrolling)}catch(t){throw console.error("Got bad scroll event:",e),t}}onTouchChange(e){e.preventDefault(),e.stopPropagation(),this.scrollTop-=e.translationY}onDragStart(e,t,i){var r,o;if(!i.dataTransfer)return;const n=this.dnd.getDragElements(e);if(i.dataTransfer.effectAllowed="copyMove",i.dataTransfer.setData(xI.TEXT,t),i.dataTransfer.setDragImage){let a;this.dnd.getDragLabel&&(a=this.dnd.getDragLabel(n,i)),typeof a>"u"&&(a=String(n.length));const l=ke(".monaco-drag-image");l.textContent=a,(u=>{for(;u&&!u.classList.contains("monaco-workbench");)u=u.parentElement;return u||this.domNode.ownerDocument})(this.domNode).appendChild(l),i.dataTransfer.setDragImage(l,-10,-10),setTimeout(()=>l.remove(),0)}this.domNode.classList.add("dragging"),this.currentDragData=new sD(n),K_.CurrentDragAndDropData=new x9e(n),(o=(r=this.dnd).onDragStart)==null||o.call(r,this.currentDragData,i)}onDragOver(e){var r,o;if(e.browserEvent.preventDefault(),this.onDragLeaveTimeout.dispose(),K_.CurrentDragAndDropData&&K_.CurrentDragAndDropData.getData()==="vscode-ui"||(this.setupDragAndDropScrollTopAnimation(e.browserEvent),!e.browserEvent.dataTransfer))return!1;if(!this.currentDragData)if(K_.CurrentDragAndDropData)this.currentDragData=K_.CurrentDragAndDropData;else{if(!e.browserEvent.dataTransfer.types)return!1;this.currentDragData=new L9e}const t=this.dnd.onDragOver(this.currentDragData,e.element,e.index,e.sector,e.browserEvent);if(this.canDrop=typeof t=="boolean"?t:t.accept,!this.canDrop)return this.currentDragFeedback=void 0,this.currentDragFeedbackDisposable.dispose(),!1;e.browserEvent.dataTransfer.dropEffect=typeof t!="boolean"&&((r=t.effect)==null?void 0:r.type)===0?"copy":"move";let i;typeof t!="boolean"&&t.feedback?i=t.feedback:typeof e.index>"u"?i=[-1]:i=[e.index],i=wg(i).filter(a=>a>=-1&&a<this.length).sort((a,l)=>a-l),i=i[0]===-1?[-1]:i;let n=typeof t!="boolean"&&t.effect&&t.effect.position?t.effect.position:"drop-target";if(k9e(this.currentDragFeedback,i)&&this.currentDragFeedbackPosition===n)return!0;if(this.currentDragFeedback=i,this.currentDragFeedbackPosition=n,this.currentDragFeedbackDisposable.dispose(),i[0]===-1)this.domNode.classList.add(n),this.rowsContainer.classList.add(n),this.currentDragFeedbackDisposable=Ye(()=>{this.domNode.classList.remove(n),this.rowsContainer.classList.remove(n)});else{if(i.length>1&&n!=="drop-target")throw new Error("Can't use multiple feedbacks with position different than 'over'");n==="drop-target-after"&&i[0]<this.length-1&&(i[0]+=1,n="drop-target-before");for(const a of i){const l=this.items[a];l.dropTarget=!0,(o=l.row)==null||o.domNode.classList.add(n)}this.currentDragFeedbackDisposable=Ye(()=>{var a;for(const l of i){const c=this.items[l];c.dropTarget=!1,(a=c.row)==null||a.domNode.classList.remove(n)}})}return!0}onDragLeave(e){var t,i;this.onDragLeaveTimeout.dispose(),this.onDragLeaveTimeout=$m(()=>this.clearDragOverFeedback(),100,this.disposables),this.currentDragData&&((i=(t=this.dnd).onDragLeave)==null||i.call(t,this.currentDragData,e.element,e.index,e.browserEvent))}onDrop(e){if(!this.canDrop)return;const t=this.currentDragData;this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,K_.CurrentDragAndDropData=void 0,!(!t||!e.browserEvent.dataTransfer)&&(e.browserEvent.preventDefault(),t.update(e.browserEvent.dataTransfer),this.dnd.drop(t,e.element,e.index,e.sector,e.browserEvent))}onDragEnd(e){var t,i;this.canDrop=!1,this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,K_.CurrentDragAndDropData=void 0,(i=(t=this.dnd).onDragEnd)==null||i.call(t,e)}clearDragOverFeedback(){this.currentDragFeedback=void 0,this.currentDragFeedbackPosition=void 0,this.currentDragFeedbackDisposable.dispose(),this.currentDragFeedbackDisposable=te.None}setupDragAndDropScrollTopAnimation(e){if(!this.dragOverAnimationDisposable){const t=Zue(this.domNode).top;this.dragOverAnimationDisposable=aAe(nt(this.domNode),this.animateDragAndDropScrollTop.bind(this,t))}this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationStopDisposable=$m(()=>{this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)},1e3,this.disposables),this.dragOverMouseY=e.pageY}animateDragAndDropScrollTop(e){if(this.dragOverMouseY===void 0)return;const t=this.dragOverMouseY-e,i=this.renderHeight-35;t<35?this.scrollTop+=Math.max(-14,Math.floor(.3*(t-35))):t>i&&(this.scrollTop+=Math.min(14,Math.floor(.3*(t-i))))}teardownDragAndDropScrollTopAnimation(){this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)}getTargetSector(e,t){if(t===void 0)return;const i=e.offsetY/this.items[t].size,n=Math.floor(i/.25);return ho(n,0,3)}getItemIndexFromEventTarget(e){const t=this.scrollableElement.getDomNode();let i=e;for(;(Ls(i)||eAe(i))&&i!==this.rowsContainer&&t.contains(i);){const n=i.getAttribute("data-index");if(n){const r=Number(n);if(!isNaN(r))return r}i=i.parentElement}}getRenderRange(e,t){return{start:this.rangeMap.indexAt(e),end:this.rangeMap.indexAfter(e+t-1)}}_rerender(e,t,i){const n=this.getRenderRange(e,t);let r,o;e===this.elementTop(n.start)?(r=n.start,o=0):n.end-n.start>1&&(r=n.start+1,o=this.elementTop(r)-e);let a=0;for(;;){const l=this.getRenderRange(e,t);let c=!1;for(let d=l.start;d<l.end;d++){const u=this.probeDynamicHeight(d);u!==0&&this.rangeMap.splice(d,1,[this.items[d]]),a+=u,c=c||u!==0}if(!c){a!==0&&this.eventuallyUpdateScrollDimensions();const d=yr.relativeComplement(n,l);for(const h of d)for(let g=h.start;g<h.end;g++)this.items[g].row&&this.removeItemFromDOM(g);const u=yr.relativeComplement(l,n).reverse();for(const h of u)for(let g=h.end-1;g>=h.start;g--)this.insertItemInDOM(g);for(let h=l.start;h<l.end;h++)this.items[h].row&&this.updateItemInDOM(this.items[h],h);if(typeof r=="number"){const h=this.scrollable.getFutureScrollPosition().scrollTop-e,g=this.elementTop(r)-o+h;this.setScrollTop(g,i)}this._onDidChangeContentHeight.fire(this.contentHeight);return}}}probeDynamicHeight(e){var o,a,l;const t=this.items[e];if(this.virtualDelegate.getDynamicHeight){const c=this.virtualDelegate.getDynamicHeight(t.element);if(c!==null){const d=t.size;return t.size=c,t.lastDynamicHeightWidth=this.renderWidth,c-d}}if(!t.hasDynamicHeight||t.lastDynamicHeightWidth===this.renderWidth||this.virtualDelegate.hasDynamicHeight&&!this.virtualDelegate.hasDynamicHeight(t.element))return 0;const i=t.size;if(t.row)return t.row.domNode.style.height="",t.size=t.row.domNode.offsetHeight,t.size===0&&!ys(t.row.domNode,nt(t.row.domNode).document.body)&&console.warn("Measuring item node that is not in DOM! Add ListView to the DOM before measuring row height!",new Error().stack),t.lastDynamicHeightWidth=this.renderWidth,t.size-i;const{row:n}=this.cache.alloc(t.templateId);n.domNode.style.height="",this.rowsContainer.appendChild(n.domNode);const r=this.renderers.get(t.templateId);if(!r)throw new di("Missing renderer for templateId: "+t.templateId);return r.renderElement(t.element,e,n.templateData,void 0),t.size=n.domNode.offsetHeight,(o=r.disposeElement)==null||o.call(r,t.element,e,n.templateData,void 0),(l=(a=this.virtualDelegate).setDynamicHeight)==null||l.call(a,t.element,t.size),t.lastDynamicHeightWidth=this.renderWidth,n.domNode.remove(),this.cache.release(n),t.size-i}getElementDomId(e){return`${this.domId}_${e}`}dispose(){var e,t,i;for(const n of this.items)if(n.dragStartDisposable.dispose(),n.checkedDisposable.dispose(),n.row){const r=this.renderers.get(n.row.templateId);r&&((e=r.disposeElement)==null||e.call(r,n.element,-1,n.row.templateData,void 0),r.disposeTemplate(n.row.templateData))}this.items=[],(t=this.domNode)==null||t.remove(),(i=this.dragOverAnimationDisposable)==null||i.dispose(),this.disposables.dispose()}};jM.InstanceCount=0;let ud=jM;Vg([$n],ud.prototype,"onMouseClick",null);Vg([$n],ud.prototype,"onMouseDblClick",null);Vg([$n],ud.prototype,"onMouseMiddleClick",null);Vg([$n],ud.prototype,"onMouseDown",null);Vg([$n],ud.prototype,"onMouseOver",null);Vg([$n],ud.prototype,"onMouseOut",null);Vg([$n],ud.prototype,"onContextMenu",null);Vg([$n],ud.prototype,"onTouchStart",null);Vg([$n],ud.prototype,"onTap",null);var b_=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r};class E9e{constructor(e){this.trait=e,this.renderedElements=[]}get templateId(){return`template:${this.trait.name}`}renderTemplate(e){return e}renderElement(e,t,i){const n=this.renderedElements.findIndex(r=>r.templateData===i);if(n>=0){const r=this.renderedElements[n];this.trait.unrender(i),r.index=t}else{const r={index:t,templateData:i};this.renderedElements.push(r)}this.trait.renderIndex(t,i)}splice(e,t,i){const n=[];for(const r of this.renderedElements)r.index<e?n.push(r):r.index>=e+t&&n.push({index:r.index+i-t,templateData:r.templateData});this.renderedElements=n}renderIndexes(e){for(const{index:t,templateData:i}of this.renderedElements)e.indexOf(t)>-1&&this.trait.renderIndex(t,i)}disposeTemplate(e){const t=this.renderedElements.findIndex(i=>i.templateData===e);t<0||this.renderedElements.splice(t,1)}}let yA=class{get name(){return this._trait}get renderer(){return new E9e(this)}constructor(e){this._trait=e,this.indexes=[],this.sortedIndexes=[],this._onChange=new Z,this.onChange=this._onChange.event}splice(e,t,i){const n=i.length-t,r=e+t,o=[];let a=0;for(;a<this.sortedIndexes.length&&this.sortedIndexes[a]<e;)o.push(this.sortedIndexes[a++]);for(let l=0;l<i.length;l++)i[l]&&o.push(l+e);for(;a<this.sortedIndexes.length&&this.sortedIndexes[a]>=r;)o.push(this.sortedIndexes[a++]+n);this.renderer.splice(e,t,i.length),this._set(o,o)}renderIndex(e,t){t.classList.toggle(this._trait,this.contains(e))}unrender(e){e.classList.remove(this._trait)}set(e,t){return this._set(e,[...e].sort(hne),t)}_set(e,t,i){const n=this.indexes,r=this.sortedIndexes;this.indexes=e,this.sortedIndexes=t;const o=u8(r,e);return this.renderer.renderIndexes(o),this._onChange.fire({indexes:e,browserEvent:i}),n}get(){return this.indexes}contains(e){return $k(this.sortedIndexes,e,hne)>=0}dispose(){Ni(this._onChange)}};b_([$n],yA.prototype,"renderer",null);class D9e extends yA{constructor(e){super("selected"),this.setAriaSelected=e}renderIndex(e,t){super.renderIndex(e,t),this.setAriaSelected&&(this.contains(e)?t.setAttribute("aria-selected","true"):t.setAttribute("aria-selected","false"))}}class MV{constructor(e,t,i){this.trait=e,this.view=t,this.identityProvider=i}splice(e,t,i){if(!this.identityProvider)return this.trait.splice(e,t,new Array(i.length).fill(!1));const n=this.trait.get().map(a=>this.identityProvider.getId(this.view.element(a)).toString());if(n.length===0)return this.trait.splice(e,t,new Array(i.length).fill(!1));const r=new Set(n),o=i.map(a=>r.has(this.identityProvider.getId(a).toString()));this.trait.splice(e,t,o)}}function hm(s){return s.tagName==="INPUT"||s.tagName==="TEXTAREA"}function rD(s,e){return s.classList.contains(e)?!0:s.classList.contains("monaco-list")||!s.parentElement?!1:rD(s.parentElement,e)}function sL(s){return rD(s,"monaco-editor")}function T9e(s){return rD(s,"monaco-custom-toggle")}function N9e(s){return rD(s,"action-item")}function OL(s){return rD(s,"monaco-tree-sticky-row")}function LI(s){return s.classList.contains("monaco-tree-sticky-container")}function ige(s){return s.tagName==="A"&&s.classList.contains("monaco-button")||s.tagName==="DIV"&&s.classList.contains("monaco-button-dropdown")?!0:s.classList.contains("monaco-list")||!s.parentElement?!1:ige(s.parentElement)}class nge{get onKeyDown(){return De.chain(this.disposables.add(new Ut(this.view.domNode,"keydown")).event,e=>e.filter(t=>!hm(t.target)).map(t=>new Mi(t)))}constructor(e,t,i){this.list=e,this.view=t,this.disposables=new ce,this.multipleSelectionDisposables=new ce,this.multipleSelectionSupport=i.multipleSelectionSupport,this.disposables.add(this.onKeyDown(n=>{switch(n.keyCode){case 3:return this.onEnter(n);case 16:return this.onUpArrow(n);case 18:return this.onDownArrow(n);case 11:return this.onPageUpArrow(n);case 12:return this.onPageDownArrow(n);case 9:return this.onEscape(n);case 31:this.multipleSelectionSupport&&(Wt?n.metaKey:n.ctrlKey)&&this.onCtrlA(n)}}))}updateOptions(e){e.multipleSelectionSupport!==void 0&&(this.multipleSelectionSupport=e.multipleSelectionSupport)}onEnter(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(this.list.getFocus(),e.browserEvent)}onUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPrevious(1,!1,e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNext(1,!1,e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onPageUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPreviousPage(e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onPageDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNextPage(e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onCtrlA(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(Uo(this.list.length),e.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus()}onEscape(e){this.list.getSelection().length&&(e.preventDefault(),e.stopPropagation(),this.list.setSelection([],e.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus())}dispose(){this.disposables.dispose(),this.multipleSelectionDisposables.dispose()}}b_([$n],nge.prototype,"onKeyDown",null);var dh;(function(s){s[s.Automatic=0]="Automatic",s[s.Trigger=1]="Trigger"})(dh||(dh={}));var TC;(function(s){s[s.Idle=0]="Idle",s[s.Typing=1]="Typing"})(TC||(TC={}));const R9e=new class{mightProducePrintableCharacter(s){return s.ctrlKey||s.metaKey||s.altKey?!1:s.keyCode>=31&&s.keyCode<=56||s.keyCode>=21&&s.keyCode<=30||s.keyCode>=98&&s.keyCode<=107||s.keyCode>=85&&s.keyCode<=95}};class A9e{constructor(e,t,i,n,r){this.list=e,this.view=t,this.keyboardNavigationLabelProvider=i,this.keyboardNavigationEventFilter=n,this.delegate=r,this.enabled=!1,this.state=TC.Idle,this.mode=dh.Automatic,this.triggered=!1,this.previouslyFocused=-1,this.enabledDisposables=new ce,this.disposables=new ce,this.updateOptions(e.options)}updateOptions(e){e.typeNavigationEnabled??!0?this.enable():this.disable(),this.mode=e.typeNavigationMode??dh.Automatic}enable(){if(this.enabled)return;let e=!1;const t=De.chain(this.enabledDisposables.add(new Ut(this.view.domNode,"keydown")).event,r=>r.filter(o=>!hm(o.target)).filter(()=>this.mode===dh.Automatic||this.triggered).map(o=>new Mi(o)).filter(o=>e||this.keyboardNavigationEventFilter(o)).filter(o=>this.delegate.mightProducePrintableCharacter(o)).forEach(o=>jt.stop(o,!0)).map(o=>o.browserEvent.key)),i=De.debounce(t,()=>null,800,void 0,void 0,void 0,this.enabledDisposables);De.reduce(De.any(t,i),(r,o)=>o===null?null:(r||"")+o,void 0,this.enabledDisposables)(this.onInput,this,this.enabledDisposables),i(this.onClear,this,this.enabledDisposables),t(()=>e=!0,void 0,this.enabledDisposables),i(()=>e=!1,void 0,this.enabledDisposables),this.enabled=!0,this.triggered=!1}disable(){this.enabled&&(this.enabledDisposables.clear(),this.enabled=!1,this.triggered=!1)}onClear(){var t;const e=this.list.getFocus();if(e.length>0&&e[0]===this.previouslyFocused){const i=(t=this.list.options.accessibilityProvider)==null?void 0:t.getAriaLabel(this.list.element(e[0]));typeof i=="string"?Eo(i):i&&Eo(i.get())}this.previouslyFocused=-1}onInput(e){if(!e){this.state=TC.Idle,this.triggered=!1;return}const t=this.list.getFocus(),i=t.length>0?t[0]:0,n=this.state===TC.Idle?1:0;this.state=TC.Typing;for(let r=0;r<this.list.length;r++){const o=(i+r+n)%this.list.length,a=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(this.view.element(o)),l=a&&a.toString();if(this.list.options.typeNavigationEnabled){if(typeof l<"u"){if(bI(e,l)){this.previouslyFocused=i,this.list.setFocus([o]),this.list.reveal(o);return}const c=e5e(e,l);if(c&&c[0].end-c[0].start>1&&c.length===1){this.previouslyFocused=i,this.list.setFocus([o]),this.list.reveal(o);return}}}else if(typeof l>"u"||bI(e,l)){this.previouslyFocused=i,this.list.setFocus([o]),this.list.reveal(o);return}}}dispose(){this.disable(),this.enabledDisposables.dispose(),this.disposables.dispose()}}class P9e{constructor(e,t){this.list=e,this.view=t,this.disposables=new ce;const i=De.chain(this.disposables.add(new Ut(t.domNode,"keydown")).event,r=>r.filter(o=>!hm(o.target)).map(o=>new Mi(o)));De.chain(i,r=>r.filter(o=>o.keyCode===2&&!o.ctrlKey&&!o.metaKey&&!o.shiftKey&&!o.altKey))(this.onTab,this,this.disposables)}onTab(e){if(e.target!==this.view.domNode)return;const t=this.list.getFocus();if(t.length===0)return;const i=this.view.domElement(t[0]);if(!i)return;const n=i.querySelector("[tabIndex]");if(!n||!Ls(n)||n.tabIndex===-1)return;const r=nt(n).getComputedStyle(n);r.visibility==="hidden"||r.display==="none"||(e.preventDefault(),e.stopPropagation(),n.focus())}dispose(){this.disposables.dispose()}}function sge(s){return Wt?s.browserEvent.metaKey:s.browserEvent.ctrlKey}function rge(s){return s.browserEvent.shiftKey}function M9e(s){return Hq(s)&&s.button===2}const une={isSelectionSingleChangeEvent:sge,isSelectionRangeChangeEvent:rge};class oge{constructor(e){this.list=e,this.disposables=new ce,this._onPointer=new Z,this.onPointer=this._onPointer.event,e.options.multipleSelectionSupport!==!1&&(this.multipleSelectionController=this.list.options.multipleSelectionController||une),this.mouseSupport=typeof e.options.mouseSupport>"u"||!!e.options.mouseSupport,this.mouseSupport&&(e.onMouseDown(this.onMouseDown,this,this.disposables),e.onContextMenu(this.onContextMenu,this,this.disposables),e.onMouseDblClick(this.onDoubleClick,this,this.disposables),e.onTouchStart(this.onMouseDown,this,this.disposables),this.disposables.add(Er.addTarget(e.getHTMLElement()))),De.any(e.onMouseClick,e.onMouseMiddleClick,e.onTap)(this.onViewPointer,this,this.disposables)}updateOptions(e){e.multipleSelectionSupport!==void 0&&(this.multipleSelectionController=void 0,e.multipleSelectionSupport&&(this.multipleSelectionController=this.list.options.multipleSelectionController||une))}isSelectionSingleChangeEvent(e){return this.multipleSelectionController?this.multipleSelectionController.isSelectionSingleChangeEvent(e):!1}isSelectionRangeChangeEvent(e){return this.multipleSelectionController?this.multipleSelectionController.isSelectionRangeChangeEvent(e):!1}isSelectionChangeEvent(e){return this.isSelectionSingleChangeEvent(e)||this.isSelectionRangeChangeEvent(e)}onMouseDown(e){sL(e.browserEvent.target)||hr()!==e.browserEvent.target&&this.list.domFocus()}onContextMenu(e){if(hm(e.browserEvent.target)||sL(e.browserEvent.target))return;const t=typeof e.index>"u"?[]:[e.index];this.list.setFocus(t,e.browserEvent)}onViewPointer(e){if(!this.mouseSupport||hm(e.browserEvent.target)||sL(e.browserEvent.target)||e.browserEvent.isHandledByList)return;e.browserEvent.isHandledByList=!0;const t=e.index;if(typeof t>"u"){this.list.setFocus([],e.browserEvent),this.list.setSelection([],e.browserEvent),this.list.setAnchor(void 0);return}if(this.isSelectionChangeEvent(e))return this.changeSelection(e);this.list.setFocus([t],e.browserEvent),this.list.setAnchor(t),M9e(e.browserEvent)||this.list.setSelection([t],e.browserEvent),this._onPointer.fire(e)}onDoubleClick(e){if(hm(e.browserEvent.target)||sL(e.browserEvent.target)||this.isSelectionChangeEvent(e)||e.browserEvent.isHandledByList)return;e.browserEvent.isHandledByList=!0;const t=this.list.getFocus();this.list.setSelection(t,e.browserEvent)}changeSelection(e){const t=e.index;let i=this.list.getAnchor();if(this.isSelectionRangeChangeEvent(e)){typeof i>"u"&&(i=this.list.getFocus()[0]??t,this.list.setAnchor(i));const n=Math.min(i,t),r=Math.max(i,t),o=Uo(n,r+1),a=this.list.getSelection(),l=V9e(u8(a,[i]),i);if(l.length===0)return;const c=u8(o,B9e(a,l));this.list.setSelection(c,e.browserEvent),this.list.setFocus([t],e.browserEvent)}else if(this.isSelectionSingleChangeEvent(e)){const n=this.list.getSelection(),r=n.filter(o=>o!==t);this.list.setFocus([t]),this.list.setAnchor(t),n.length===r.length?this.list.setSelection([...r,t],e.browserEvent):this.list.setSelection(r,e.browserEvent)}}dispose(){this.disposables.dispose()}}class age{constructor(e,t){this.styleElement=e,this.selectorSuffix=t}style(e){const t=this.selectorSuffix&&`.${this.selectorSuffix}`,i=[];e.listBackground&&i.push(`.monaco-list${t} .monaco-list-rows { background: ${e.listBackground}; }`),e.listFocusBackground&&(i.push(`.monaco-list${t}:focus .monaco-list-row.focused { background-color: ${e.listFocusBackground}; }`),i.push(`.monaco-list${t}:focus .monaco-list-row.focused:hover { background-color: ${e.listFocusBackground}; }`)),e.listFocusForeground&&i.push(`.monaco-list${t}:focus .monaco-list-row.focused { color: ${e.listFocusForeground}; }`),e.listActiveSelectionBackground&&(i.push(`.monaco-list${t}:focus .monaco-list-row.selected { background-color: ${e.listActiveSelectionBackground}; }`),i.push(`.monaco-list${t}:focus .monaco-list-row.selected:hover { background-color: ${e.listActiveSelectionBackground}; }`)),e.listActiveSelectionForeground&&i.push(`.monaco-list${t}:focus .monaco-list-row.selected { color: ${e.listActiveSelectionForeground}; }`),e.listActiveSelectionIconForeground&&i.push(`.monaco-list${t}:focus .monaco-list-row.selected .codicon { color: ${e.listActiveSelectionIconForeground}; }`),e.listFocusAndSelectionBackground&&i.push(`
				.monaco-drag-image,
				.monaco-list${t}:focus .monaco-list-row.selected.focused { background-color: ${e.listFocusAndSelectionBackground}; }
			`),e.listFocusAndSelectionForeground&&i.push(`
				.monaco-drag-image,
				.monaco-list${t}:focus .monaco-list-row.selected.focused { color: ${e.listFocusAndSelectionForeground}; }
			`),e.listInactiveFocusForeground&&(i.push(`.monaco-list${t} .monaco-list-row.focused { color:  ${e.listInactiveFocusForeground}; }`),i.push(`.monaco-list${t} .monaco-list-row.focused:hover { color:  ${e.listInactiveFocusForeground}; }`)),e.listInactiveSelectionIconForeground&&i.push(`.monaco-list${t} .monaco-list-row.focused .codicon { color:  ${e.listInactiveSelectionIconForeground}; }`),e.listInactiveFocusBackground&&(i.push(`.monaco-list${t} .monaco-list-row.focused { background-color:  ${e.listInactiveFocusBackground}; }`),i.push(`.monaco-list${t} .monaco-list-row.focused:hover { background-color:  ${e.listInactiveFocusBackground}; }`)),e.listInactiveSelectionBackground&&(i.push(`.monaco-list${t} .monaco-list-row.selected { background-color:  ${e.listInactiveSelectionBackground}; }`),i.push(`.monaco-list${t} .monaco-list-row.selected:hover { background-color:  ${e.listInactiveSelectionBackground}; }`)),e.listInactiveSelectionForeground&&i.push(`.monaco-list${t} .monaco-list-row.selected { color: ${e.listInactiveSelectionForeground}; }`),e.listHoverBackground&&i.push(`.monaco-list${t}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { background-color: ${e.listHoverBackground}; }`),e.listHoverForeground&&i.push(`.monaco-list${t}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { color:  ${e.listHoverForeground}; }`);const n=lg(e.listFocusAndSelectionOutline,lg(e.listSelectionOutline,e.listFocusOutline??""));n&&i.push(`.monaco-list${t}:focus .monaco-list-row.focused.selected { outline: 1px solid ${n}; outline-offset: -1px;}`),e.listFocusOutline&&i.push(`
				.monaco-drag-image,
				.monaco-list${t}:focus .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }
				.monaco-workbench.context-menu-visible .monaco-list${t}.last-focused .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }
			`);const r=lg(e.listSelectionOutline,e.listInactiveFocusOutline??"");r&&i.push(`.monaco-list${t} .monaco-list-row.focused.selected { outline: 1px dotted ${r}; outline-offset: -1px; }`),e.listSelectionOutline&&i.push(`.monaco-list${t} .monaco-list-row.selected { outline: 1px dotted ${e.listSelectionOutline}; outline-offset: -1px; }`),e.listInactiveFocusOutline&&i.push(`.monaco-list${t} .monaco-list-row.focused { outline: 1px dotted ${e.listInactiveFocusOutline}; outline-offset: -1px; }`),e.listHoverOutline&&i.push(`.monaco-list${t} .monaco-list-row:hover { outline: 1px dashed ${e.listHoverOutline}; outline-offset: -1px; }`),e.listDropOverBackground&&i.push(`
				.monaco-list${t}.drop-target,
				.monaco-list${t} .monaco-list-rows.drop-target,
				.monaco-list${t} .monaco-list-row.drop-target { background-color: ${e.listDropOverBackground} !important; color: inherit !important; }
			`),e.listDropBetweenBackground&&(i.push(`
			.monaco-list${t} .monaco-list-rows.drop-target-before .monaco-list-row:first-child::before,
			.monaco-list${t} .monaco-list-row.drop-target-before::before {
				content: ""; position: absolute; top: 0px; left: 0px; width: 100%; height: 1px;
				background-color: ${e.listDropBetweenBackground};
			}`),i.push(`
			.monaco-list${t} .monaco-list-rows.drop-target-after .monaco-list-row:last-child::after,
			.monaco-list${t} .monaco-list-row.drop-target-after::after {
				content: ""; position: absolute; bottom: 0px; left: 0px; width: 100%; height: 1px;
				background-color: ${e.listDropBetweenBackground};
			}`)),e.tableColumnsBorder&&i.push(`
				.monaco-table > .monaco-split-view2,
				.monaco-table > .monaco-split-view2 .monaco-sash.vertical::before,
				.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2,
				.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: ${e.tableColumnsBorder};
				}

				.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2,
				.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: transparent;
				}
			`),e.tableOddRowsBackgroundColor&&i.push(`
				.monaco-table .monaco-list-row[data-parity=odd]:not(.focused):not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(:focus) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(.focused) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr {
					background-color: ${e.tableOddRowsBackgroundColor};
				}
			`),this.styleElement.textContent=i.join(`
`)}}const O9e={listFocusBackground:"#7FB0D0",listActiveSelectionBackground:"#0E639C",listActiveSelectionForeground:"#FFFFFF",listActiveSelectionIconForeground:"#FFFFFF",listFocusAndSelectionOutline:"#90C2F9",listFocusAndSelectionBackground:"#094771",listFocusAndSelectionForeground:"#FFFFFF",listInactiveSelectionBackground:"#3F3F46",listInactiveSelectionIconForeground:"#FFFFFF",listHoverBackground:"#2A2D2E",listDropOverBackground:"#383B3D",listDropBetweenBackground:"#EEEEEE",treeIndentGuidesStroke:"#a9a9a9",treeInactiveIndentGuidesStroke:fe.fromHex("#a9a9a9").transparent(.4).toString(),tableColumnsBorder:fe.fromHex("#cccccc").transparent(.2).toString(),tableOddRowsBackgroundColor:fe.fromHex("#cccccc").transparent(.04).toString(),listBackground:void 0,listFocusForeground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusForeground:void 0,listInactiveFocusBackground:void 0,listHoverForeground:void 0,listFocusOutline:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listHoverOutline:void 0,treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:void 0},F9e={keyboardSupport:!0,mouseSupport:!0,multipleSelectionSupport:!0,dnd:{getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){},dispose(){}}};function V9e(s,e){const t=s.indexOf(e);if(t===-1)return[];const i=[];let n=t-1;for(;n>=0&&s[n]===e-(t-n);)i.push(s[n--]);for(i.reverse(),n=t;n<s.length&&s[n]===e+(n-t);)i.push(s[n++]);return i}function u8(s,e){const t=[];let i=0,n=0;for(;i<s.length||n<e.length;)if(i>=s.length)t.push(e[n++]);else if(n>=e.length)t.push(s[i++]);else if(s[i]===e[n]){t.push(s[i]),i++,n++;continue}else s[i]<e[n]?t.push(s[i++]):t.push(e[n++]);return t}function B9e(s,e){const t=[];let i=0,n=0;for(;i<s.length||n<e.length;)if(i>=s.length)t.push(e[n++]);else if(n>=e.length)t.push(s[i++]);else if(s[i]===e[n]){i++,n++;continue}else s[i]<e[n]?t.push(s[i++]):n++;return t}const hne=(s,e)=>s-e;class W9e{constructor(e,t){this._templateId=e,this.renderers=t}get templateId(){return this._templateId}renderTemplate(e){return this.renderers.map(t=>t.renderTemplate(e))}renderElement(e,t,i,n){let r=0;for(const o of this.renderers)o.renderElement(e,t,i[r++],n)}disposeElement(e,t,i,n){var o;let r=0;for(const a of this.renderers)(o=a.disposeElement)==null||o.call(a,e,t,i[r],n),r+=1}disposeTemplate(e){let t=0;for(const i of this.renderers)i.disposeTemplate(e[t++])}}class H9e{constructor(e){this.accessibilityProvider=e,this.templateId="a18n"}renderTemplate(e){return{container:e,disposables:new ce}}renderElement(e,t,i){const n=this.accessibilityProvider.getAriaLabel(e),r=n&&typeof n!="string"?n:hc(n);i.disposables.add(ht(a=>{this.setAriaLabel(a.readObservable(r),i.container)}));const o=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(e);typeof o=="number"?i.container.setAttribute("aria-level",`${o}`):i.container.removeAttribute("aria-level")}setAriaLabel(e,t){e?t.setAttribute("aria-label",e):t.removeAttribute("aria-label")}disposeElement(e,t,i,n){i.disposables.clear()}disposeTemplate(e){e.disposables.dispose()}}class z9e{constructor(e,t){this.list=e,this.dnd=t}getDragElements(e){const t=this.list.getSelectedElements();return t.indexOf(e)>-1?t:[e]}getDragURI(e){return this.dnd.getDragURI(e)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e,t)}onDragStart(e,t){var i,n;(n=(i=this.dnd).onDragStart)==null||n.call(i,e,t)}onDragOver(e,t,i,n,r){return this.dnd.onDragOver(e,t,i,n,r)}onDragLeave(e,t,i,n){var r,o;(o=(r=this.dnd).onDragLeave)==null||o.call(r,e,t,i,n)}onDragEnd(e){var t,i;(i=(t=this.dnd).onDragEnd)==null||i.call(t,e)}drop(e,t,i,n,r){this.dnd.drop(e,t,i,n,r)}dispose(){this.dnd.dispose()}}class Bl{get onDidChangeFocus(){return De.map(this.eventBufferer.wrapEvent(this.focus.onChange),e=>this.toListEvent(e),this.disposables)}get onDidChangeSelection(){return De.map(this.eventBufferer.wrapEvent(this.selection.onChange),e=>this.toListEvent(e),this.disposables)}get domId(){return this.view.domId}get onDidScroll(){return this.view.onDidScroll}get onMouseClick(){return this.view.onMouseClick}get onMouseDblClick(){return this.view.onMouseDblClick}get onMouseMiddleClick(){return this.view.onMouseMiddleClick}get onPointer(){return this.mouseController.onPointer}get onMouseDown(){return this.view.onMouseDown}get onMouseOver(){return this.view.onMouseOver}get onMouseOut(){return this.view.onMouseOut}get onTouchStart(){return this.view.onTouchStart}get onTap(){return this.view.onTap}get onContextMenu(){let e=!1;const t=De.chain(this.disposables.add(new Ut(this.view.domNode,"keydown")).event,r=>r.map(o=>new Mi(o)).filter(o=>e=o.keyCode===58||o.shiftKey&&o.keyCode===68).map(o=>jt.stop(o,!0)).filter(()=>!1)),i=De.chain(this.disposables.add(new Ut(this.view.domNode,"keyup")).event,r=>r.forEach(()=>e=!1).map(o=>new Mi(o)).filter(o=>o.keyCode===58||o.shiftKey&&o.keyCode===68).map(o=>jt.stop(o,!0)).map(({browserEvent:o})=>{const a=this.getFocus(),l=a.length?a[0]:void 0,c=typeof l<"u"?this.view.element(l):void 0,d=typeof l<"u"?this.view.domElement(l):this.view.domNode;return{index:l,element:c,anchor:d,browserEvent:o}})),n=De.chain(this.view.onContextMenu,r=>r.filter(o=>!e).map(({element:o,index:a,browserEvent:l})=>({element:o,index:a,anchor:new Xc(nt(this.view.domNode),l),browserEvent:l})));return De.any(t,i,n)}get onKeyDown(){return this.disposables.add(new Ut(this.view.domNode,"keydown")).event}get onDidFocus(){return De.signal(this.disposables.add(new Ut(this.view.domNode,"focus",!0)).event)}get onDidBlur(){return De.signal(this.disposables.add(new Ut(this.view.domNode,"blur",!0)).event)}constructor(e,t,i,n,r=F9e){var c,d,u;this.user=e,this._options=r,this.focus=new yA("focused"),this.anchor=new yA("anchor"),this.eventBufferer=new BE,this._ariaLabel="",this.disposables=new ce,this._onDidDispose=new Z,this.onDidDispose=this._onDidDispose.event;const o=this._options.accessibilityProvider&&this._options.accessibilityProvider.getWidgetRole?(c=this._options.accessibilityProvider)==null?void 0:c.getWidgetRole():"list";this.selection=new D9e(o!=="listbox");const a=[this.focus.renderer,this.selection.renderer];this.accessibilityProvider=r.accessibilityProvider,this.accessibilityProvider&&(a.push(new H9e(this.accessibilityProvider)),(u=(d=this.accessibilityProvider).onDidChangeActiveDescendant)==null||u.call(d,this.onDidChangeActiveDescendant,this,this.disposables)),n=n.map(h=>new W9e(h.templateId,[...a,h]));const l={...r,dnd:r.dnd&&new z9e(this,r.dnd)};if(this.view=this.createListView(t,i,n,l),this.view.domNode.setAttribute("role",o),r.styleController)this.styleController=r.styleController(this.view.domId);else{const h=Rl(this.view.domNode);this.styleController=new age(h,this.view.domId)}if(this.spliceable=new v9e([new MV(this.focus,this.view,r.identityProvider),new MV(this.selection,this.view,r.identityProvider),new MV(this.anchor,this.view,r.identityProvider),this.view]),this.disposables.add(this.focus),this.disposables.add(this.selection),this.disposables.add(this.anchor),this.disposables.add(this.view),this.disposables.add(this._onDidDispose),this.disposables.add(new P9e(this,this.view)),(typeof r.keyboardSupport!="boolean"||r.keyboardSupport)&&(this.keyboardController=new nge(this,this.view,r),this.disposables.add(this.keyboardController)),r.keyboardNavigationLabelProvider){const h=r.keyboardNavigationDelegate||R9e;this.typeNavigationController=new A9e(this,this.view,r.keyboardNavigationLabelProvider,r.keyboardNavigationEventFilter??(()=>!0),h),this.disposables.add(this.typeNavigationController)}this.mouseController=this.createMouseController(r),this.disposables.add(this.mouseController),this.onDidChangeFocus(this._onFocusChange,this,this.disposables),this.onDidChangeSelection(this._onSelectionChange,this,this.disposables),this.accessibilityProvider&&(this.ariaLabel=this.accessibilityProvider.getWidgetAriaLabel()),this._options.multipleSelectionSupport!==!1&&this.view.domNode.setAttribute("aria-multiselectable","true")}createListView(e,t,i,n){return new ud(e,t,i,n)}createMouseController(e){return new oge(this)}updateOptions(e={}){var t,i;this._options={...this._options,...e},(t=this.typeNavigationController)==null||t.updateOptions(this._options),this._options.multipleSelectionController!==void 0&&(this._options.multipleSelectionSupport?this.view.domNode.setAttribute("aria-multiselectable","true"):this.view.domNode.removeAttribute("aria-multiselectable")),this.mouseController.updateOptions(e),(i=this.keyboardController)==null||i.updateOptions(e),this.view.updateOptions(e)}get options(){return this._options}splice(e,t,i=[]){if(e<0||e>this.view.length)throw new q_(this.user,`Invalid start index: ${e}`);if(t<0)throw new q_(this.user,`Invalid delete count: ${t}`);t===0&&i.length===0||this.eventBufferer.bufferEvents(()=>this.spliceable.splice(e,t,i))}rerender(){this.view.rerender()}element(e){return this.view.element(e)}indexOf(e){return this.view.indexOf(e)}indexAt(e){return this.view.indexAt(e)}get length(){return this.view.length}get contentHeight(){return this.view.contentHeight}get onDidChangeContentHeight(){return this.view.onDidChangeContentHeight}get scrollTop(){return this.view.getScrollTop()}set scrollTop(e){this.view.setScrollTop(e)}get scrollHeight(){return this.view.scrollHeight}get renderHeight(){return this.view.renderHeight}get firstVisibleIndex(){return this.view.firstVisibleIndex}get ariaLabel(){return this._ariaLabel}set ariaLabel(e){this._ariaLabel=e,this.view.domNode.setAttribute("aria-label",e)}domFocus(){this.view.domNode.focus({preventScroll:!0})}layout(e,t){this.view.layout(e,t)}setSelection(e,t){for(const i of e)if(i<0||i>=this.length)throw new q_(this.user,`Invalid index ${i}`);this.selection.set(e,t)}getSelection(){return this.selection.get()}getSelectedElements(){return this.getSelection().map(e=>this.view.element(e))}setAnchor(e){if(typeof e>"u"){this.anchor.set([]);return}if(e<0||e>=this.length)throw new q_(this.user,`Invalid index ${e}`);this.anchor.set([e])}getAnchor(){return pq(this.anchor.get(),void 0)}getAnchorElement(){const e=this.getAnchor();return typeof e>"u"?void 0:this.element(e)}setFocus(e,t){for(const i of e)if(i<0||i>=this.length)throw new q_(this.user,`Invalid index ${i}`);this.focus.set(e,t)}focusNext(e=1,t=!1,i,n){if(this.length===0)return;const r=this.focus.get(),o=this.findNextIndex(r.length>0?r[0]+e:0,t,n);o>-1&&this.setFocus([o],i)}focusPrevious(e=1,t=!1,i,n){if(this.length===0)return;const r=this.focus.get(),o=this.findPreviousIndex(r.length>0?r[0]-e:0,t,n);o>-1&&this.setFocus([o],i)}async focusNextPage(e,t){let i=this.view.indexAt(this.view.getScrollTop()+this.view.renderHeight);i=i===0?0:i-1;const n=this.getFocus()[0];if(n!==i&&(n===void 0||i>n)){const r=this.findPreviousIndex(i,!1,t);r>-1&&n!==r?this.setFocus([r],e):this.setFocus([i],e)}else{const r=this.view.getScrollTop();let o=r+this.view.renderHeight;i>n&&(o-=this.view.elementHeight(i)),this.view.setScrollTop(o),this.view.getScrollTop()!==r&&(this.setFocus([]),await Sg(0),await this.focusNextPage(e,t))}}async focusPreviousPage(e,t,i=()=>0){let n;const r=i(),o=this.view.getScrollTop()+r;o===0?n=this.view.indexAt(o):n=this.view.indexAfter(o-1);const a=this.getFocus()[0];if(a!==n&&(a===void 0||a>=n)){const l=this.findNextIndex(n,!1,t);l>-1&&a!==l?this.setFocus([l],e):this.setFocus([n],e)}else{const l=o;this.view.setScrollTop(o-this.view.renderHeight-r),this.view.getScrollTop()+i()!==l&&(this.setFocus([]),await Sg(0),await this.focusPreviousPage(e,t,i))}}focusLast(e,t){if(this.length===0)return;const i=this.findPreviousIndex(this.length-1,!1,t);i>-1&&this.setFocus([i],e)}focusFirst(e,t){this.focusNth(0,e,t)}focusNth(e,t,i){if(this.length===0)return;const n=this.findNextIndex(e,!1,i);n>-1&&this.setFocus([n],t)}findNextIndex(e,t=!1,i){for(let n=0;n<this.length;n++){if(e>=this.length&&!t)return-1;if(e=e%this.length,!i||i(this.element(e)))return e;e++}return-1}findPreviousIndex(e,t=!1,i){for(let n=0;n<this.length;n++){if(e<0&&!t)return-1;if(e=(this.length+e%this.length)%this.length,!i||i(this.element(e)))return e;e--}return-1}getFocus(){return this.focus.get()}getFocusedElements(){return this.getFocus().map(e=>this.view.element(e))}reveal(e,t,i=0){if(e<0||e>=this.length)throw new q_(this.user,`Invalid index ${e}`);const n=this.view.getScrollTop(),r=this.view.elementTop(e),o=this.view.elementHeight(e);if(Vm(t)){const a=o-this.view.renderHeight+i;this.view.setScrollTop(a*ho(t,0,1)+r-i)}else{const a=r+o,l=n+this.view.renderHeight;r<n+i&&a>=l||(r<n+i||a>=l&&o>=this.view.renderHeight?this.view.setScrollTop(r-i):a>=l&&this.view.setScrollTop(a-this.view.renderHeight))}}getRelativeTop(e,t=0){if(e<0||e>=this.length)throw new q_(this.user,`Invalid index ${e}`);const i=this.view.getScrollTop(),n=this.view.elementTop(e),r=this.view.elementHeight(e);if(n<i+t||n+r>i+this.view.renderHeight)return null;const o=r-this.view.renderHeight+t;return Math.abs((i+t-n)/o)}getHTMLElement(){return this.view.domNode}getScrollableElement(){return this.view.scrollableElementDomNode}getElementID(e){return this.view.getElementDomId(e)}getElementTop(e){return this.view.elementTop(e)}style(e){this.styleController.style(e)}toListEvent({indexes:e,browserEvent:t}){return{indexes:e,elements:e.map(i=>this.view.element(i)),browserEvent:t}}_onFocusChange(){const e=this.focus.get();this.view.domNode.classList.toggle("element-focused",e.length>0),this.onDidChangeActiveDescendant()}onDidChangeActiveDescendant(){var t;const e=this.focus.get();if(e.length>0){let i;(t=this.accessibilityProvider)!=null&&t.getActiveDescendantId&&(i=this.accessibilityProvider.getActiveDescendantId(this.view.element(e[0]))),this.view.domNode.setAttribute("aria-activedescendant",i||this.view.getElementDomId(e[0]))}else this.view.domNode.removeAttribute("aria-activedescendant")}_onSelectionChange(){const e=this.selection.get();this.view.domNode.classList.toggle("selection-none",e.length===0),this.view.domNode.classList.toggle("selection-single",e.length===1),this.view.domNode.classList.toggle("selection-multiple",e.length>1)}dispose(){this._onDidDispose.fire(),this.disposables.dispose(),this._onDidDispose.dispose()}}b_([$n],Bl.prototype,"onDidChangeFocus",null);b_([$n],Bl.prototype,"onDidChangeSelection",null);b_([$n],Bl.prototype,"onContextMenu",null);b_([$n],Bl.prototype,"onKeyDown",null);b_([$n],Bl.prototype,"onDidFocus",null);b_([$n],Bl.prototype,"onDidBlur",null);const Bb=ke,lge="selectOption.entry.template";class U9e{get templateId(){return lge}renderTemplate(e){const t=Object.create(null);return t.root=e,t.text=me(e,Bb(".option-text")),t.detail=me(e,Bb(".option-detail")),t.decoratorRight=me(e,Bb(".option-decorator-right")),t}renderElement(e,t,i){const n=i,r=e.text,o=e.detail,a=e.decoratorRight,l=e.isDisabled;n.text.textContent=r,n.detail.textContent=o||"",n.decoratorRight.innerText=a||"",l?n.root.classList.add("option-disabled"):n.root.classList.remove("option-disabled")}disposeTemplate(e){}}const Yu=class Yu extends te{constructor(e,t,i,n,r){super(),this.options=[],this._currentSelection=0,this._hasDetails=!1,this._skipLayout=!1,this._sticky=!1,this._isVisible=!1,this.styles=n,this.selectBoxOptions=r||Object.create(null),typeof this.selectBoxOptions.minBottomMargin!="number"?this.selectBoxOptions.minBottomMargin=Yu.DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN:this.selectBoxOptions.minBottomMargin<0&&(this.selectBoxOptions.minBottomMargin=0),this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box monaco-select-box-dropdown-padding",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=new Z,this._register(this._onDidSelect),this.registerListeners(),this.constructSelectDropDown(i),this.selected=t||0,e&&this.setOptions(e,t),this.initStyleSheet()}setTitle(e){!this._hover&&e?this._hover=this._register(wu().setupManagedHover(No("mouse"),this.selectElement,e)):this._hover&&this._hover.update(e)}getHeight(){return 22}getTemplateId(){return lge}constructSelectDropDown(e){this.contextViewProvider=e,this.selectDropDownContainer=ke(".monaco-select-box-dropdown-container"),this.selectDropDownContainer.classList.add("monaco-select-box-dropdown-padding"),this.selectionDetailsPane=me(this.selectDropDownContainer,Bb(".select-box-details-pane"));const t=me(this.selectDropDownContainer,Bb(".select-box-dropdown-container-width-control")),i=me(t,Bb(".width-control-div"));this.widthControlElement=document.createElement("span"),this.widthControlElement.className="option-text-width-control",me(i,this.widthControlElement),this._dropDownPosition=0,this.styleElement=Rl(this.selectDropDownContainer),this.selectDropDownContainer.setAttribute("draggable","true"),this._register(oe(this.selectDropDownContainer,Le.DRAG_START,n=>{jt.stop(n,!0)}))}registerListeners(){this._register(yn(this.selectElement,"change",t=>{this.selected=t.target.selectedIndex,this._onDidSelect.fire({index:t.target.selectedIndex,selected:t.target.value}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)})),this._register(oe(this.selectElement,Le.CLICK,t=>{jt.stop(t),this._isVisible?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(oe(this.selectElement,Le.MOUSE_DOWN,t=>{jt.stop(t)}));let e;this._register(oe(this.selectElement,"touchstart",t=>{e=this._isVisible})),this._register(oe(this.selectElement,"touchend",t=>{jt.stop(t),e?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(oe(this.selectElement,Le.KEY_DOWN,t=>{const i=new Mi(t);let n=!1;Wt?(i.keyCode===18||i.keyCode===16||i.keyCode===10||i.keyCode===3)&&(n=!0):(i.keyCode===18&&i.altKey||i.keyCode===16&&i.altKey||i.keyCode===10||i.keyCode===3)&&(n=!0),n&&(this.showSelectDropDown(),jt.stop(t,!0))}))}get onDidSelect(){return this._onDidSelect.event}setOptions(e,t){dn(this.options,e)||(this.options=e,this.selectElement.options.length=0,this._hasDetails=!1,this._cachedMaxDetailsHeight=void 0,this.options.forEach((i,n)=>{this.selectElement.add(this.createOption(i.text,n,i.isDisabled)),typeof i.description=="string"&&(this._hasDetails=!0)})),t!==void 0&&(this.select(t),this._currentSelection=this.selected)}setOptionsList(){var e;(e=this.selectList)==null||e.splice(0,this.selectList.length,this.options)}select(e){e>=0&&e<this.options.length?this.selected=e:e>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setFocusable(e){this.selectElement.tabIndex=e?0:-1}render(e){this.container=e,e.classList.add("select-container"),e.appendChild(this.selectElement),this.styleSelectElement()}initStyleSheet(){const e=[];this.styles.listFocusBackground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { background-color: ${this.styles.listFocusBackground} !important; }`),this.styles.listFocusForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { color: ${this.styles.listFocusForeground} !important; }`),this.styles.decoratorRightForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.focused) .option-decorator-right { color: ${this.styles.decoratorRightForeground}; }`),this.styles.selectBackground&&this.styles.selectBorder&&this.styles.selectBorder!==this.styles.selectBackground?(e.push(`.monaco-select-box-dropdown-container { border: 1px solid ${this.styles.selectBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectBorder} } `)):this.styles.selectListBorder&&(e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectListBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectListBorder} } `)),this.styles.listHoverForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { color: ${this.styles.listHoverForeground} !important; }`),this.styles.listHoverBackground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { background-color: ${this.styles.listHoverBackground} !important; }`),this.styles.listFocusOutline&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { outline: 1.6px dotted ${this.styles.listFocusOutline} !important; outline-offset: -1.6px !important; }`),this.styles.listHoverOutline&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { outline: 1.6px dashed ${this.styles.listHoverOutline} !important; outline-offset: -1.6px !important; }`),e.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled.focused { background-color: transparent !important; color: inherit !important; outline: none !important; }"),e.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled:hover { background-color: transparent !important; color: inherit !important; outline: none !important; }"),this.styleElement.textContent=e.join(`
`)}styleSelectElement(){const e=this.styles.selectBackground??"",t=this.styles.selectForeground??"",i=this.styles.selectBorder??"";this.selectElement.style.backgroundColor=e,this.selectElement.style.color=t,this.selectElement.style.borderColor=i}styleList(){const e=this.styles.selectBackground??"",t=lg(this.styles.selectListBackground,e);this.selectDropDownListContainer.style.backgroundColor=t,this.selectionDetailsPane.style.backgroundColor=t;const i=this.styles.focusBorder??"";this.selectDropDownContainer.style.outlineColor=i,this.selectDropDownContainer.style.outlineOffset="-1px",this.selectList.style(this.styles)}createOption(e,t,i){const n=document.createElement("option");return n.value=e,n.text=e,n.disabled=!!i,n}showSelectDropDown(){this.selectionDetailsPane.innerText="",!(!this.contextViewProvider||this._isVisible)&&(this.createSelectList(this.selectDropDownContainer),this.setOptionsList(),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:e=>this.renderSelectDropDown(e,!0),layout:()=>{this.layoutSelectDropDown()},onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._isVisible=!0,this.hideSelectDropDown(!1),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:e=>this.renderSelectDropDown(e),layout:()=>this.layoutSelectDropDown(),onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._currentSelection=this.selected,this._isVisible=!0,this.selectElement.setAttribute("aria-expanded","true"))}hideSelectDropDown(e){!this.contextViewProvider||!this._isVisible||(this._isVisible=!1,this.selectElement.setAttribute("aria-expanded","false"),e&&this.selectElement.focus(),this.contextViewProvider.hideContextView())}renderSelectDropDown(e,t){return e.appendChild(this.selectDropDownContainer),this.layoutSelectDropDown(t),{dispose:()=>{this.selectDropDownContainer.remove()}}}measureMaxDetailsHeight(){let e=0;return this.options.forEach((t,i)=>{this.updateDetail(i),this.selectionDetailsPane.offsetHeight>e&&(e=this.selectionDetailsPane.offsetHeight)}),e}layoutSelectDropDown(e){if(this._skipLayout)return!1;if(this.selectList){this.selectDropDownContainer.classList.add("visible");const t=nt(this.selectElement),i=Pn(this.selectElement),n=nt(this.selectElement).getComputedStyle(this.selectElement),r=parseFloat(n.getPropertyValue("--dropdown-padding-top"))+parseFloat(n.getPropertyValue("--dropdown-padding-bottom")),o=t.innerHeight-i.top-i.height-(this.selectBoxOptions.minBottomMargin||0),a=i.top-Yu.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN,l=this.selectElement.offsetWidth,c=this.setWidthControlElement(this.widthControlElement),d=Math.max(c,Math.round(l)).toString()+"px";this.selectDropDownContainer.style.width=d,this.selectList.getHTMLElement().style.height="",this.selectList.layout();let u=this.selectList.contentHeight;this._hasDetails&&this._cachedMaxDetailsHeight===void 0&&(this._cachedMaxDetailsHeight=this.measureMaxDetailsHeight());const h=this._hasDetails?this._cachedMaxDetailsHeight:0,g=u+r+h,p=Math.floor((o-r-h)/this.getHeight()),_=Math.floor((a-r-h)/this.getHeight());if(e)return i.top+i.height>t.innerHeight-22||i.top<Yu.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||p<1&&_<1?!1:(p<Yu.DEFAULT_MINIMUM_VISIBLE_OPTIONS&&_>p&&this.options.length>p?(this._dropDownPosition=1,this.selectDropDownListContainer.remove(),this.selectionDetailsPane.remove(),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectionDetailsPane.classList.remove("border-top"),this.selectionDetailsPane.classList.add("border-bottom")):(this._dropDownPosition=0,this.selectDropDownListContainer.remove(),this.selectionDetailsPane.remove(),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectionDetailsPane.classList.remove("border-bottom"),this.selectionDetailsPane.classList.add("border-top")),!0);if(i.top+i.height>t.innerHeight-22||i.top<Yu.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||this._dropDownPosition===0&&p<1||this._dropDownPosition===1&&_<1)return this.hideSelectDropDown(!0),!1;if(this._dropDownPosition===0){if(this._isVisible&&p+_<1)return this.hideSelectDropDown(!0),!1;g>o&&(u=p*this.getHeight())}else g>a&&(u=_*this.getHeight());return this.selectList.layout(u),this.selectList.domFocus(),this.selectList.length>0&&(this.selectList.setFocus([this.selected||0]),this.selectList.reveal(this.selectList.getFocus()[0]||0)),this._hasDetails?(this.selectList.getHTMLElement().style.height=u+r+"px",this.selectDropDownContainer.style.height=""):this.selectDropDownContainer.style.height=u+r+"px",this.updateDetail(this.selected),this.selectDropDownContainer.style.width=d,this.selectDropDownListContainer.setAttribute("tabindex","0"),this.selectElement.classList.add("synthetic-focus"),this.selectDropDownContainer.classList.add("synthetic-focus"),!0}else return!1}setWidthControlElement(e){let t=0;if(e){let i=0,n=0;this.options.forEach((r,o)=>{const a=r.detail?r.detail.length:0,l=r.decoratorRight?r.decoratorRight.length:0,c=r.text.length+a+l;c>n&&(i=o,n=c)}),e.textContent=this.options[i].text+(this.options[i].decoratorRight?this.options[i].decoratorRight+" ":""),t=ya(e)}return t}createSelectList(e){if(this.selectList)return;this.selectDropDownListContainer=me(e,Bb(".select-box-dropdown-list-container")),this.listRenderer=new U9e,this.selectList=this._register(new Bl("SelectBoxCustom",this.selectDropDownListContainer,this,[this.listRenderer],{useShadows:!1,verticalScrollMode:3,keyboardSupport:!1,mouseSupport:!1,accessibilityProvider:{getAriaLabel:n=>{let r=n.text;return n.detail&&(r+=`. ${n.detail}`),n.decoratorRight&&(r+=`. ${n.decoratorRight}`),n.description&&(r+=`. ${n.description}`),r},getWidgetAriaLabel:()=>b({key:"selectBox",comment:["Behave like native select dropdown element."]},"Select Box"),getRole:()=>Wt?"":"option",getWidgetRole:()=>"listbox"}})),this.selectBoxOptions.ariaLabel&&(this.selectList.ariaLabel=this.selectBoxOptions.ariaLabel);const t=this._register(new Ut(this.selectDropDownListContainer,"keydown")),i=De.chain(t.event,n=>n.filter(()=>this.selectList.length>0).map(r=>new Mi(r)));this._register(De.chain(i,n=>n.filter(r=>r.keyCode===3))(this.onEnter,this)),this._register(De.chain(i,n=>n.filter(r=>r.keyCode===2))(this.onEnter,this)),this._register(De.chain(i,n=>n.filter(r=>r.keyCode===9))(this.onEscape,this)),this._register(De.chain(i,n=>n.filter(r=>r.keyCode===16))(this.onUpArrow,this)),this._register(De.chain(i,n=>n.filter(r=>r.keyCode===18))(this.onDownArrow,this)),this._register(De.chain(i,n=>n.filter(r=>r.keyCode===12))(this.onPageDown,this)),this._register(De.chain(i,n=>n.filter(r=>r.keyCode===11))(this.onPageUp,this)),this._register(De.chain(i,n=>n.filter(r=>r.keyCode===14))(this.onHome,this)),this._register(De.chain(i,n=>n.filter(r=>r.keyCode===13))(this.onEnd,this)),this._register(De.chain(i,n=>n.filter(r=>r.keyCode>=21&&r.keyCode<=56||r.keyCode>=85&&r.keyCode<=113))(this.onCharacter,this)),this._register(oe(this.selectList.getHTMLElement(),Le.POINTER_UP,n=>this.onPointerUp(n))),this._register(this.selectList.onMouseOver(n=>typeof n.index<"u"&&this.selectList.setFocus([n.index]))),this._register(this.selectList.onDidChangeFocus(n=>this.onListFocus(n))),this._register(oe(this.selectDropDownContainer,Le.FOCUS_OUT,n=>{!this._isVisible||ys(n.relatedTarget,this.selectDropDownContainer)||this.onListBlur()})),this.selectList.getHTMLElement().setAttribute("aria-label",this.selectBoxOptions.ariaLabel||""),this.selectList.getHTMLElement().setAttribute("aria-expanded","true"),this.styleList()}onPointerUp(e){if(!this.selectList.length)return;jt.stop(e);const t=e.target;if(!t||t.classList.contains("slider"))return;const i=t.closest(".monaco-list-row");if(!i)return;const n=Number(i.getAttribute("data-index")),r=i.classList.contains("option-disabled");n>=0&&n<this.options.length&&!r&&(this.selected=n,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)),this.hideSelectDropDown(!0))}onListBlur(){this._sticky||(this.selected!==this._currentSelection&&this.select(this._currentSelection),this.hideSelectDropDown(!1))}renderDescriptionMarkdown(e,t){const i=r=>{for(let o=0;o<r.childNodes.length;o++){const a=r.childNodes.item(o);(a.tagName&&a.tagName.toLowerCase())==="img"?a.remove():i(a)}},n=PF({value:e,supportThemeIcons:!0},{actionHandler:t});return n.element.classList.add("select-box-description-markdown"),i(n.element),n.element}onListFocus(e){!this._isVisible||!this._hasDetails||this.updateDetail(e.indexes[0])}updateDetail(e){this.selectionDetailsPane.innerText="";const t=this.options[e],i=(t==null?void 0:t.description)??"",n=(t==null?void 0:t.descriptionIsMarkdown)??!1;if(i){if(n){const r=t.descriptionMarkdownActionHandler;this.selectionDetailsPane.appendChild(this.renderDescriptionMarkdown(i,r))}else this.selectionDetailsPane.innerText=i;this.selectionDetailsPane.style.display="block"}else this.selectionDetailsPane.style.display="none";this._skipLayout=!0,this.contextViewProvider.layout(),this._skipLayout=!1}onEscape(e){jt.stop(e),this.select(this._currentSelection),this.hideSelectDropDown(!0)}onEnter(e){jt.stop(e),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)),this.hideSelectDropDown(!0)}onDownArrow(e){if(this.selected<this.options.length-1){jt.stop(e,!0);const t=this.options[this.selected+1].isDisabled;if(t&&this.options.length>this.selected+2)this.selected+=2;else{if(t)return;this.selected++}this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0])}}onUpArrow(e){this.selected>0&&(jt.stop(e,!0),this.options[this.selected-1].isDisabled&&this.selected>1?this.selected-=2:this.selected--,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]))}onPageUp(e){jt.stop(e),this.selectList.focusPreviousPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected<this.options.length-1&&(this.selected++,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onPageDown(e){jt.stop(e),this.selectList.focusNextPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected>0&&(this.selected--,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onHome(e){jt.stop(e),!(this.options.length<2)&&(this.selected=0,this.options[this.selected].isDisabled&&this.selected>1&&this.selected++,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onEnd(e){jt.stop(e),!(this.options.length<2)&&(this.selected=this.options.length-1,this.options[this.selected].isDisabled&&this.selected>1&&this.selected--,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onCharacter(e){const t=Of.toString(e.keyCode);let i=-1;for(let n=0;n<this.options.length-1;n++)if(i=(n+this.selected+1)%this.options.length,this.options[i].text.charAt(0).toUpperCase()===t&&!this.options[i].isDisabled){this.select(i),this.selectList.setFocus([i]),this.selectList.reveal(this.selectList.getFocus()[0]),jt.stop(e);break}}dispose(){this.hideSelectDropDown(!1),super.dispose()}};Yu.DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN=32,Yu.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN=2,Yu.DEFAULT_MINIMUM_VISIBLE_OPTIONS=3;let h8=Yu;class j9e extends te{constructor(e,t,i,n){super(),this.selected=0,this.selectBoxOptions=n||Object.create(null),this.options=[],this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=this._register(new Z),this.styles=i,this.registerListeners(),this.setOptions(e,t)}registerListeners(){this._register(Er.addTarget(this.selectElement)),[Vi.Tap].forEach(e=>{this._register(oe(this.selectElement,e,t=>{this.selectElement.focus()}))}),this._register(yn(this.selectElement,"click",e=>{jt.stop(e,!0)})),this._register(yn(this.selectElement,"change",e=>{this.selectElement.title=e.target.value,this._onDidSelect.fire({index:e.target.selectedIndex,selected:e.target.value})})),this._register(yn(this.selectElement,"keydown",e=>{let t=!1;Wt?(e.keyCode===18||e.keyCode===16||e.keyCode===10)&&(t=!0):(e.keyCode===18&&e.altKey||e.keyCode===10||e.keyCode===3)&&(t=!0),t&&e.stopPropagation()}))}get onDidSelect(){return this._onDidSelect.event}setOptions(e,t){(!this.options||!dn(this.options,e))&&(this.options=e,this.selectElement.options.length=0,this.options.forEach((i,n)=>{this.selectElement.add(this.createOption(i.text,n,i.isDisabled))})),t!==void 0&&this.select(t)}select(e){this.options.length===0?this.selected=0:e>=0&&e<this.options.length?this.selected=e:e>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.selected<this.options.length&&typeof this.options[this.selected].text=="string"?this.selectElement.title=this.options[this.selected].text:this.selectElement.title=""}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setFocusable(e){this.selectElement.tabIndex=e?0:-1}render(e){e.classList.add("select-container"),e.appendChild(this.selectElement),this.setOptions(this.options,this.selected),this.applyStyles()}applyStyles(){this.selectElement&&(this.selectElement.style.backgroundColor=this.styles.selectBackground??"",this.selectElement.style.color=this.styles.selectForeground??"",this.selectElement.style.borderColor=this.styles.selectBorder??"")}createOption(e,t,i){const n=document.createElement("option");return n.value=e,n.text=e,n.disabled=!!i,n}}class $9e extends Vl{constructor(e,t,i,n,r){super(),Wt&&!(r!=null&&r.useCustomDrawn)?this.selectBoxDelegate=new j9e(e,t,n,r):this.selectBoxDelegate=new h8(e,t,i,n,r),this._register(this.selectBoxDelegate)}get onDidSelect(){return this.selectBoxDelegate.onDidSelect}setOptions(e,t){this.selectBoxDelegate.setOptions(e,t)}select(e){this.selectBoxDelegate.select(e)}focus(){this.selectBoxDelegate.focus()}blur(){this.selectBoxDelegate.blur()}setFocusable(e){this.selectBoxDelegate.setFocusable(e)}render(e){this.selectBoxDelegate.render(e)}}class qd extends te{get action(){return this._action}constructor(e,t,i={}){super(),this.options=i,this._context=e||this,this._action=t,t instanceof Na&&this._register(t.onDidChange(n=>{this.element&&this.handleActionChangeEvent(n)}))}handleActionChangeEvent(e){e.enabled!==void 0&&this.updateEnabled(),e.checked!==void 0&&this.updateChecked(),e.class!==void 0&&this.updateClass(),e.label!==void 0&&(this.updateLabel(),this.updateTooltip()),e.tooltip!==void 0&&this.updateTooltip()}get actionRunner(){return this._actionRunner||(this._actionRunner=this._register(new hw)),this._actionRunner}set actionRunner(e){this._actionRunner=e}isEnabled(){return this._action.enabled}setActionContext(e){this._context=e}render(e){const t=this.element=e;this._register(Er.addTarget(e));const i=this.options&&this.options.draggable;i&&(e.draggable=!0,_c&&this._register(oe(e,Le.DRAG_START,n=>{var r;return(r=n.dataTransfer)==null?void 0:r.setData(xI.TEXT,this._action.label)}))),this._register(oe(t,Vi.Tap,n=>this.onClick(n,!0))),this._register(oe(t,Le.MOUSE_DOWN,n=>{i||jt.stop(n,!0),this._action.enabled&&n.button===0&&t.classList.add("active")})),Wt&&this._register(oe(t,Le.CONTEXT_MENU,n=>{n.button===0&&n.ctrlKey===!0&&this.onClick(n)})),this._register(oe(t,Le.CLICK,n=>{jt.stop(n,!0),this.options&&this.options.isMenu||this.onClick(n)})),this._register(oe(t,Le.DBLCLICK,n=>{jt.stop(n,!0)})),[Le.MOUSE_UP,Le.MOUSE_OUT].forEach(n=>{this._register(oe(t,n,r=>{jt.stop(r),t.classList.remove("active")}))})}onClick(e,t=!1){var n;jt.stop(e,!0);const i=ml(this._context)?(n=this.options)!=null&&n.useEventAsContext?e:{preserveFocus:t}:this._context;this.actionRunner.run(this._action,i)}focus(){this.element&&(this.element.tabIndex=0,this.element.focus(),this.element.classList.add("focused"))}blur(){this.element&&(this.element.blur(),this.element.tabIndex=-1,this.element.classList.remove("focused"))}setFocusable(e){this.element&&(this.element.tabIndex=e?0:-1)}get trapsArrowNavigation(){return!1}updateEnabled(){}updateLabel(){}getClass(){return this.action.class}getTooltip(){return this.action.tooltip}updateTooltip(){var t;if(!this.element)return;const e=this.getTooltip()??"";if(this.updateAriaLabel(),(t=this.options.hoverDelegate)!=null&&t.showNativeHover)this.element.title=e;else if(!this.customHover&&e!==""){const i=this.options.hoverDelegate??No("element");this.customHover=this._store.add(wu().setupManagedHover(i,this.element,e))}else this.customHover&&this.customHover.update(e)}updateAriaLabel(){if(this.element){const e=this.getTooltip()??"";this.element.setAttribute("aria-label",e)}}updateClass(){}updateChecked(){}dispose(){this.element&&(this.element.remove(),this.element=void 0),this._context=void 0,super.dispose()}}class I1 extends qd{constructor(e,t,i){super(e,t,i),this.options=i,this.options.icon=i.icon!==void 0?i.icon:!1,this.options.label=i.label!==void 0?i.label:!0,this.cssClass=""}render(e){super.render(e),ii(this.element);const t=document.createElement("a");if(t.classList.add("action-label"),t.setAttribute("role",this.getDefaultAriaRole()),this.label=t,this.element.appendChild(t),this.options.label&&this.options.keybinding){const i=document.createElement("span");i.classList.add("keybinding"),i.textContent=this.options.keybinding,this.element.appendChild(i)}this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked()}getDefaultAriaRole(){return this._action.id===ks.ID?"presentation":this.options.isMenu?"menuitem":this.options.isTabList?"tab":"button"}focus(){this.label&&(this.label.tabIndex=0,this.label.focus())}blur(){this.label&&(this.label.tabIndex=-1)}setFocusable(e){this.label&&(this.label.tabIndex=e?0:-1)}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this.action.label)}getTooltip(){let e=null;return this.action.tooltip?e=this.action.tooltip:!this.options.label&&this.action.label&&this.options.icon&&(e=this.action.label,this.options.keybinding&&(e=b({key:"titleLabel",comment:["action title","action keybinding"]},"{0} ({1})",e,this.options.keybinding))),e??void 0}updateClass(){var e;this.cssClass&&this.label&&this.label.classList.remove(...this.cssClass.split(" ")),this.options.icon?(this.cssClass=this.getClass(),this.label&&(this.label.classList.add("codicon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" "))),this.updateEnabled()):(e=this.label)==null||e.classList.remove("codicon")}updateEnabled(){var e,t;this.action.enabled?(this.label&&(this.label.removeAttribute("aria-disabled"),this.label.classList.remove("disabled")),(e=this.element)==null||e.classList.remove("disabled")):(this.label&&(this.label.setAttribute("aria-disabled","true"),this.label.classList.add("disabled")),(t=this.element)==null||t.classList.add("disabled"))}updateAriaLabel(){if(this.label){const e=this.getTooltip()??"";this.label.setAttribute("aria-label",e)}}updateChecked(){this.label&&(this.action.checked!==void 0?(this.label.classList.toggle("checked",this.action.checked),this.options.isTabList?this.label.setAttribute("aria-selected",this.action.checked?"true":"false"):(this.label.setAttribute("aria-checked",this.action.checked?"true":"false"),this.label.setAttribute("role","checkbox"))):(this.label.classList.remove("checked"),this.label.removeAttribute(this.options.isTabList?"aria-selected":"aria-checked"),this.label.setAttribute("role",this.getDefaultAriaRole())))}}class q9e extends qd{constructor(e,t,i,n,r,o,a){super(e,t),this.selectBox=new $9e(i,n,r,o,a),this.selectBox.setFocusable(!1),this._register(this.selectBox),this.registerListeners()}select(e){this.selectBox.select(e)}registerListeners(){this._register(this.selectBox.onDidSelect(e=>this.runAction(e.selected,e.index)))}runAction(e,t){this.actionRunner.run(this._action,this.getActionContext(e,t))}getActionContext(e,t){return e}setFocusable(e){this.selectBox.setFocusable(e)}focus(){var e;(e=this.selectBox)==null||e.focus()}blur(){var e;(e=this.selectBox)==null||e.blur()}render(e){this.selectBox.render(e)}}class K9e extends hw{constructor(e,t){super(),this._onDidChangeVisibility=this._register(new Z),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this._element=me(e,ke(".monaco-dropdown")),this._label=me(this._element,ke(".dropdown-label"));let i=t.labelRenderer;i||(i=r=>(r.textContent=t.label||"",null));for(const r of[Le.CLICK,Le.MOUSE_DOWN,Vi.Tap])this._register(oe(this.element,r,o=>jt.stop(o,!0)));for(const r of[Le.MOUSE_DOWN,Vi.Tap])this._register(oe(this._label,r,o=>{Hq(o)&&(o.detail>1||o.button!==0)||(this.visible?this.hide():this.show())}));this._register(oe(this._label,Le.KEY_UP,r=>{const o=new Mi(r);(o.equals(3)||o.equals(10))&&(jt.stop(r,!0),this.visible?this.hide():this.show())}));const n=i(this._label);n&&this._register(n),this._register(Er.addTarget(this._label))}get element(){return this._element}show(){this.visible||(this.visible=!0,this._onDidChangeVisibility.fire(!0))}hide(){this.visible&&(this.visible=!1,this._onDidChangeVisibility.fire(!1))}dispose(){super.dispose(),this.hide(),this.boxContainer&&(this.boxContainer.remove(),this.boxContainer=void 0),this.contents&&(this.contents.remove(),this.contents=void 0),this._label&&(this._label.remove(),this._label=void 0)}}class G9e extends K9e{constructor(e,t){super(e,t),this._options=t,this._actions=[],this.actions=t.actions||[]}set menuOptions(e){this._menuOptions=e}get menuOptions(){return this._menuOptions}get actions(){return this._options.actionProvider?this._options.actionProvider.getActions():this._actions}set actions(e){this._actions=e}show(){super.show(),this.element.classList.add("active"),this._options.contextMenuProvider.showContextMenu({getAnchor:()=>this.element,getActions:()=>this.actions,getActionsContext:()=>this.menuOptions?this.menuOptions.context:null,getActionViewItem:(e,t)=>this.menuOptions&&this.menuOptions.actionViewItemProvider?this.menuOptions.actionViewItemProvider(e,t):void 0,getKeyBinding:e=>this.menuOptions&&this.menuOptions.getKeyBinding?this.menuOptions.getKeyBinding(e):void 0,getMenuClassName:()=>this._options.menuClassName||"",onHide:()=>this.onHide(),actionRunner:this.menuOptions?this.menuOptions.actionRunner:void 0,anchorAlignment:this.menuOptions?this.menuOptions.anchorAlignment:0,domForShadowRoot:this._options.menuAsChild?this.element:void 0,skipTelemetry:this._options.skipTelemetry})}hide(){super.hide()}onHide(){this.hide(),this.element.classList.remove("active")}}class SA extends qd{constructor(e,t,i,n=Object.create(null)){super(null,e,n),this.actionItem=null,this._onDidChangeVisibility=this._register(new Z),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this.menuActionsOrProvider=t,this.contextMenuProvider=i,this.options=n,this.options.actionRunner&&(this.actionRunner=this.options.actionRunner)}render(e){this.actionItem=e;const t=r=>{this.element=me(r,ke("a.action-label"));let o=[];return typeof this.options.classNames=="string"?o=this.options.classNames.split(/\s+/g).filter(a=>!!a):this.options.classNames&&(o=this.options.classNames),o.find(a=>a==="icon")||o.push("codicon"),this.element.classList.add(...o),this.element.setAttribute("role","button"),this.element.setAttribute("aria-haspopup","true"),this.element.setAttribute("aria-expanded","false"),this._action.label&&this._register(wu().setupManagedHover(this.options.hoverDelegate??No("mouse"),this.element,this._action.label)),this.element.ariaLabel=this._action.label||"",null},i=Array.isArray(this.menuActionsOrProvider),n={contextMenuProvider:this.contextMenuProvider,labelRenderer:t,menuAsChild:this.options.menuAsChild,actions:i?this.menuActionsOrProvider:void 0,actionProvider:i?void 0:this.menuActionsOrProvider,skipTelemetry:this.options.skipTelemetry};if(this.dropdownMenu=this._register(new G9e(e,n)),this._register(this.dropdownMenu.onDidChangeVisibility(r=>{var o;(o=this.element)==null||o.setAttribute("aria-expanded",`${r}`),this._onDidChangeVisibility.fire(r)})),this.dropdownMenu.menuOptions={actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,getKeyBinding:this.options.keybindingProvider,context:this._context},this.options.anchorAlignmentProvider){const r=this;this.dropdownMenu.menuOptions={...this.dropdownMenu.menuOptions,get anchorAlignment(){return r.options.anchorAlignmentProvider()}}}this.updateTooltip(),this.updateEnabled()}getTooltip(){let e=null;return this.action.tooltip?e=this.action.tooltip:this.action.label&&(e=this.action.label),e??void 0}setActionContext(e){super.setActionContext(e),this.dropdownMenu&&(this.dropdownMenu.menuOptions?this.dropdownMenu.menuOptions.context=e:this.dropdownMenu.menuOptions={context:e})}show(){var e;(e=this.dropdownMenu)==null||e.show()}updateEnabled(){var t,i;const e=!this.action.enabled;(t=this.actionItem)==null||t.classList.toggle("disabled",e),(i=this.element)==null||i.classList.toggle("disabled",e)}}function Q9e(s){return s&&typeof s=="object"&&typeof s.original=="string"&&typeof s.value=="string"}function Y9e(s){return s?s.condition!==void 0:!1}var yy;(function(s){s[s.STORAGE_DOES_NOT_EXIST=0]="STORAGE_DOES_NOT_EXIST",s[s.STORAGE_IN_MEMORY=1]="STORAGE_IN_MEMORY"})(yy||(yy={}));var NC;(function(s){s[s.None=0]="None",s[s.Initialized=1]="Initialized",s[s.Closed=2]="Closed"})(NC||(NC={}));const $M=class $M extends te{constructor(e,t=Object.create(null)){super(),this.database=e,this.options=t,this._onDidChangeStorage=this._register(new aw),this.onDidChangeStorage=this._onDidChangeStorage.event,this.state=NC.None,this.cache=new Map,this.flushDelayer=this._register(new Vue($M.DEFAULT_FLUSH_DELAY)),this.pendingDeletes=new Set,this.pendingInserts=new Map,this.whenFlushedCallbacks=[],this.registerListeners()}registerListeners(){this._register(this.database.onDidChangeItemsExternal(e=>this.onDidChangeItemsExternal(e)))}onDidChangeItemsExternal(e){var t,i;this._onDidChangeStorage.pause();try{(t=e.changed)==null||t.forEach((n,r)=>this.acceptExternal(r,n)),(i=e.deleted)==null||i.forEach(n=>this.acceptExternal(n,void 0))}finally{this._onDidChangeStorage.resume()}}acceptExternal(e,t){if(this.state===NC.Closed)return;let i=!1;ml(t)?i=this.cache.delete(e):this.cache.get(e)!==t&&(this.cache.set(e,t),i=!0),i&&this._onDidChangeStorage.fire({key:e,external:!0})}get(e,t){const i=this.cache.get(e);return ml(i)?t:i}getBoolean(e,t){const i=this.get(e);return ml(i)?t:i==="true"}getNumber(e,t){const i=this.get(e);return ml(i)?t:parseInt(i,10)}async set(e,t,i=!1){if(this.state===NC.Closed)return;if(ml(t))return this.delete(e,i);const n=Ms(t)||Array.isArray(t)?I5e(t):String(t);if(this.cache.get(e)!==n)return this.cache.set(e,n),this.pendingInserts.set(e,n),this.pendingDeletes.delete(e),this._onDidChangeStorage.fire({key:e,external:i}),this.doFlush()}async delete(e,t=!1){if(!(this.state===NC.Closed||!this.cache.delete(e)))return this.pendingDeletes.has(e)||this.pendingDeletes.add(e),this.pendingInserts.delete(e),this._onDidChangeStorage.fire({key:e,external:t}),this.doFlush()}get hasPending(){return this.pendingInserts.size>0||this.pendingDeletes.size>0}async flushPending(){if(!this.hasPending)return;const e={insert:this.pendingInserts,delete:this.pendingDeletes};return this.pendingDeletes=new Set,this.pendingInserts=new Map,this.database.updateItems(e).finally(()=>{var t;if(!this.hasPending)for(;this.whenFlushedCallbacks.length;)(t=this.whenFlushedCallbacks.pop())==null||t()})}async doFlush(e){return this.options.hint===yy.STORAGE_IN_MEMORY?this.flushPending():this.flushDelayer.trigger(()=>this.flushPending(),e)}};$M.DEFAULT_FLUSH_DELAY=100;let FL=$M;class OV{constructor(){this.onDidChangeItemsExternal=De.None,this.items=new Map}async updateItems(e){var t,i;(t=e.insert)==null||t.forEach((n,r)=>this.items.set(r,n)),(i=e.delete)==null||i.forEach(n=>this.items.delete(n))}}const PR="__$__targetStorageMarker",md=Ht("storageService");var kI;(function(s){s[s.NONE=0]="NONE",s[s.SHUTDOWN=1]="SHUTDOWN"})(kI||(kI={}));function X9e(s){const e=s.get(PR);if(e)try{return JSON.parse(e)}catch{}return Object.create(null)}const qM=class qM extends te{constructor(e={flushInterval:qM.DEFAULT_FLUSH_INTERVAL}){super(),this.options=e,this._onDidChangeValue=this._register(new aw),this._onDidChangeTarget=this._register(new aw),this._onWillSaveState=this._register(new Z),this.onWillSaveState=this._onWillSaveState.event,this._workspaceKeyTargets=void 0,this._profileKeyTargets=void 0,this._applicationKeyTargets=void 0}onDidChangeValue(e,t,i){return De.filter(this._onDidChangeValue.event,n=>n.scope===e&&(t===void 0||n.key===t),i)}emitDidChangeValue(e,t){const{key:i,external:n}=t;if(i===PR){switch(e){case-1:this._applicationKeyTargets=void 0;break;case 0:this._profileKeyTargets=void 0;break;case 1:this._workspaceKeyTargets=void 0;break}this._onDidChangeTarget.fire({scope:e})}else this._onDidChangeValue.fire({scope:e,key:i,target:this.getKeyTargets(e)[i],external:n})}get(e,t,i){var n;return(n=this.getStorage(t))==null?void 0:n.get(e,i)}getBoolean(e,t,i){var n;return(n=this.getStorage(t))==null?void 0:n.getBoolean(e,i)}getNumber(e,t,i){var n;return(n=this.getStorage(t))==null?void 0:n.getNumber(e,i)}store(e,t,i,n,r=!1){if(ml(t)){this.remove(e,i,r);return}this.withPausedEmitters(()=>{var o;this.updateKeyTarget(e,i,n),(o=this.getStorage(i))==null||o.set(e,t,r)})}remove(e,t,i=!1){this.withPausedEmitters(()=>{var n;this.updateKeyTarget(e,t,void 0),(n=this.getStorage(t))==null||n.delete(e,i)})}withPausedEmitters(e){this._onDidChangeValue.pause(),this._onDidChangeTarget.pause();try{e()}finally{this._onDidChangeValue.resume(),this._onDidChangeTarget.resume()}}updateKeyTarget(e,t,i,n=!1){var o,a;const r=this.getKeyTargets(t);typeof i=="number"?r[e]!==i&&(r[e]=i,(o=this.getStorage(t))==null||o.set(PR,JSON.stringify(r),n)):typeof r[e]=="number"&&(delete r[e],(a=this.getStorage(t))==null||a.set(PR,JSON.stringify(r),n))}get workspaceKeyTargets(){return this._workspaceKeyTargets||(this._workspaceKeyTargets=this.loadKeyTargets(1)),this._workspaceKeyTargets}get profileKeyTargets(){return this._profileKeyTargets||(this._profileKeyTargets=this.loadKeyTargets(0)),this._profileKeyTargets}get applicationKeyTargets(){return this._applicationKeyTargets||(this._applicationKeyTargets=this.loadKeyTargets(-1)),this._applicationKeyTargets}getKeyTargets(e){switch(e){case-1:return this.applicationKeyTargets;case 0:return this.profileKeyTargets;default:return this.workspaceKeyTargets}}loadKeyTargets(e){const t=this.getStorage(e);return t?X9e(t):Object.create(null)}};qM.DEFAULT_FLUSH_INTERVAL=60*1e3;let f8=qM;class Z9e extends f8{constructor(){super(),this.applicationStorage=this._register(new FL(new OV,{hint:yy.STORAGE_IN_MEMORY})),this.profileStorage=this._register(new FL(new OV,{hint:yy.STORAGE_IN_MEMORY})),this.workspaceStorage=this._register(new FL(new OV,{hint:yy.STORAGE_IN_MEMORY})),this._register(this.workspaceStorage.onDidChangeStorage(e=>this.emitDidChangeValue(1,e))),this._register(this.profileStorage.onDidChangeStorage(e=>this.emitDidChangeValue(0,e))),this._register(this.applicationStorage.onDidChangeStorage(e=>this.emitDidChangeValue(-1,e)))}getStorage(e){switch(e){case-1:return this.applicationStorage;case 0:return this.profileStorage;default:return this.workspaceStorage}}}function J9e(s,e){const t={...e};for(const i in s){const n=s[i];t[i]=n!==void 0?Fe(n):void 0}return t}const eVe={keybindingLabelBackground:Fe(j4e),keybindingLabelForeground:Fe($4e),keybindingLabelBorder:Fe(q4e),keybindingLabelBottomBorder:Fe(K4e),keybindingLabelShadow:Fe(gS)},tVe={buttonForeground:Fe(mfe),buttonSeparator:Fe(T4e),buttonBackground:Fe(eL),buttonHoverBackground:Fe(N4e),buttonSecondaryForeground:Fe(A4e),buttonSecondaryBackground:Fe(P6),buttonSecondaryHoverBackground:Fe(P4e),buttonBorder:Fe(R4e)},iVe={progressBarBackground:Fe(jOe)},xA={inputActiveOptionBorder:Fe(kF),inputActiveOptionForeground:Fe(IF),inputActiveOptionBackground:Fe(GE)};Fe(tL),Fe(M4e),Fe(O4e),Fe(F4e),Fe(V4e),Fe(B4e),Fe(W4e);Fe(H4e),Fe(U4e),Fe(z4e);Fe(yl),Fe(SF),Fe(gS),Fe(Xt),Fe(u4e),Fe(h4e),Fe(f4e),Fe(zOe);const LA={inputBackground:Fe(A6),inputForeground:Fe(gfe),inputBorder:Fe(pfe),inputValidationInfoBorder:Fe(y4e),inputValidationInfoBackground:Fe(w4e),inputValidationInfoForeground:Fe(C4e),inputValidationWarningBorder:Fe(L4e),inputValidationWarningBackground:Fe(S4e),inputValidationWarningForeground:Fe(x4e),inputValidationErrorBorder:Fe(E4e),inputValidationErrorBackground:Fe(k4e),inputValidationErrorForeground:Fe(I4e)},nVe={listFilterWidgetBackground:Fe(oFe),listFilterWidgetOutline:Fe(aFe),listFilterWidgetNoMatchesOutline:Fe(lFe),listFilterWidgetShadow:Fe(cFe),inputBoxStyles:LA,toggleStyles:xA},cge={badgeBackground:Fe(TR),badgeForeground:Fe(UOe),badgeBorder:Fe(Xt)};Fe(c4e),Fe(l4e),Fe(Lie),Fe(Lie),Fe(d4e);const Gw={listBackground:void 0,listInactiveFocusForeground:void 0,listFocusBackground:Fe(G4e),listFocusForeground:Fe(Q4e),listFocusOutline:Fe(Y4e),listActiveSelectionBackground:Fe(gw),listActiveSelectionForeground:Fe(gI),listActiveSelectionIconForeground:Fe(_fe),listFocusAndSelectionOutline:Fe(X4e),listFocusAndSelectionBackground:Fe(gw),listFocusAndSelectionForeground:Fe(gI),listInactiveSelectionBackground:Fe(Z4e),listInactiveSelectionIconForeground:Fe(eFe),listInactiveSelectionForeground:Fe(J4e),listInactiveFocusBackground:Fe(tFe),listInactiveFocusOutline:Fe(iFe),listHoverBackground:Fe(bfe),listHoverForeground:Fe(vfe),listDropOverBackground:Fe(nFe),listDropBetweenBackground:Fe(sFe),listSelectionOutline:Fe(tn),listHoverOutline:Fe(tn),treeIndentGuidesStroke:Fe(wfe),treeInactiveIndentGuidesStroke:Fe(dFe),treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:Fe(aK),tableColumnsBorder:Fe(uFe),tableOddRowsBackgroundColor:Fe(hFe)};function Qw(s){return J9e(s,Gw)}const sVe={selectBackground:Fe(EF),selectListBackground:Fe(D4e),selectForeground:Fe(fK),decoratorRightForeground:Fe(Cfe),selectBorder:Fe(gK),focusBorder:Fe(Ah),listFocusBackground:Fe(mI),listInactiveSelectionIconForeground:Fe(pK),listFocusForeground:Fe(pI),listFocusOutline:OOe(tn,fe.transparent.toString()),listHoverBackground:Fe(bfe),listHoverForeground:Fe(vfe),listHoverOutline:Fe(tn),selectListBorder:Fe(lK),listBackground:void 0,listActiveSelectionBackground:void 0,listActiveSelectionForeground:void 0,listActiveSelectionIconForeground:void 0,listFocusAndSelectionBackground:void 0,listDropOverBackground:void 0,listDropBetweenBackground:void 0,listInactiveSelectionBackground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusBackground:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listFocusAndSelectionForeground:void 0,listFocusAndSelectionOutline:void 0,listInactiveFocusForeground:void 0,tableColumnsBorder:void 0,tableOddRowsBackgroundColor:void 0,treeIndentGuidesStroke:void 0,treeInactiveIndentGuidesStroke:void 0,treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:void 0},rVe={shadowColor:Fe(gS),borderColor:Fe(fFe),foregroundColor:Fe(gFe),backgroundColor:Fe(pFe),selectionForegroundColor:Fe(mFe),selectionBackgroundColor:Fe(_Fe),selectionBorderColor:Fe(bFe),separatorColor:Fe(vFe),scrollbarShadow:Fe(aK),scrollbarSliderBackground:Fe(ofe),scrollbarSliderHoverBackground:Fe(afe),scrollbarSliderActiveBackground:Fe(lfe)};var HF=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Qo=function(s,e){return function(t,i){e(t,i,s)}};function oVe(s,e,t,i){let n,r,o;if(Array.isArray(s))o=s,n=e,r=t;else{const c=e;o=s.getActions(c),n=t,r=i}const a=qf.getInstance(),l=a.keyStatus.altKey||(gr||Lo)&&a.keyStatus.shiftKey;dge(o,n,l,r?c=>c===r:c=>c==="navigation")}function zF(s,e,t,i,n,r){let o,a,l,c,d;if(Array.isArray(s))d=s,o=e,a=t,l=i,c=n;else{const h=e;d=s.getActions(h),o=t,a=i,l=n,c=r}dge(d,o,!1,typeof a=="string"?h=>h===a:a,l,c)}function dge(s,e,t,i=o=>o==="navigation",n=()=>!1,r=!1){let o,a;Array.isArray(e)?(o=e,a=e):(o=e.primary,a=e.secondary);const l=new Set;for(const[c,d]of s){let u;i(c)?(u=o,u.length>0&&r&&u.push(new ks)):(u=a,u.length>0&&u.push(new ks));for(let h of d){t&&(h=h instanceof Ra&&h.alt?h.alt:h);const g=u.push(h);h instanceof f1&&l.add({group:c,action:h,index:g-1})}}for(const{group:c,action:d,index:u}of l){const h=i(c)?o:a,g=d.actions;n(d,c,h.length)&&h.splice(u,1,...g)}}let Ym=class extends I1{constructor(e,t,i,n,r,o,a,l){super(void 0,e,{icon:!!(e.class||e.item.icon),label:!e.class&&!e.item.icon,draggable:t==null?void 0:t.draggable,keybinding:t==null?void 0:t.keybinding,hoverDelegate:t==null?void 0:t.hoverDelegate}),this._options=t,this._keybindingService=i,this._notificationService=n,this._contextKeyService=r,this._themeService=o,this._contextMenuService=a,this._accessibilityService=l,this._wantsAltCommand=!1,this._itemClassDispose=this._register(new Es),this._altKey=qf.getInstance()}get _menuItemAction(){return this._action}get _commandAction(){return this._wantsAltCommand&&this._menuItemAction.alt||this._menuItemAction}async onClick(e){e.preventDefault(),e.stopPropagation();try{await this.actionRunner.run(this._commandAction,this._context)}catch(t){this._notificationService.error(t)}}render(e){if(super.render(e),e.classList.add("menu-entry"),this.options.icon&&this._updateItemClass(this._menuItemAction.item),this._menuItemAction.alt){let t=!1;const i=()=>{var r;const n=!!((r=this._menuItemAction.alt)!=null&&r.enabled)&&(!this._accessibilityService.isMotionReduced()||t)&&(this._altKey.keyStatus.altKey||this._altKey.keyStatus.shiftKey&&t);n!==this._wantsAltCommand&&(this._wantsAltCommand=n,this.updateLabel(),this.updateTooltip(),this.updateClass())};this._register(this._altKey.event(i)),this._register(oe(e,"mouseleave",n=>{t=!1,i()})),this._register(oe(e,"mouseenter",n=>{t=!0,i()})),i()}}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this._commandAction.label)}getTooltip(){var r;const e=this._keybindingService.lookupKeybinding(this._commandAction.id,this._contextKeyService),t=e&&e.getLabel(),i=this._commandAction.tooltip||this._commandAction.label;let n=t?b("titleAndKb","{0} ({1})",i,t):i;if(!this._wantsAltCommand&&((r=this._menuItemAction.alt)!=null&&r.enabled)){const o=this._menuItemAction.alt.tooltip||this._menuItemAction.alt.label,a=this._keybindingService.lookupKeybinding(this._menuItemAction.alt.id,this._contextKeyService),l=a&&a.getLabel(),c=l?b("titleAndKb","{0} ({1})",o,l):o;n=b("titleAndKbAndAlt",`{0}
[{1}] {2}`,n,NK.modifierLabels[Da].altKey,c)}return n}updateClass(){this.options.icon&&(this._commandAction!==this._menuItemAction?this._menuItemAction.alt&&this._updateItemClass(this._menuItemAction.alt.item):this._updateItemClass(this._menuItemAction.item))}_updateItemClass(e){this._itemClassDispose.value=void 0;const{element:t,label:i}=this;if(!t||!i)return;const n=this._commandAction.checked&&Y9e(e.toggled)&&e.toggled.icon?e.toggled.icon:e.icon;if(n)if(at.isThemeIcon(n)){const r=at.asClassNameArray(n);i.classList.add(...r),this._itemClassDispose.value=Ye(()=>{i.classList.remove(...r)})}else i.style.backgroundImage=m1(this._themeService.getColorTheme().type)?xg(n.dark):xg(n.light),i.classList.add("icon"),this._itemClassDispose.value=id(Ye(()=>{i.style.backgroundImage="",i.classList.remove("icon")}),this._themeService.onDidColorThemeChange(()=>{this.updateClass()}))}};Ym=HF([Qo(2,pi),Qo(3,jn),Qo(4,ct),Qo(5,gs),Qo(6,Ba),Qo(7,Wa)],Ym);class MK extends Ym{render(e){var t;this.options.label=!0,this.options.icon=!1,super.render(e),e.classList.add("text-only"),e.classList.toggle("use-comma",((t=this._options)==null?void 0:t.useComma)??!1)}updateLabel(){var t;const e=this._keybindingService.lookupKeybinding(this._action.id,this._contextKeyService);if(!e)return super.updateLabel();if(this.label){const i=MK._symbolPrintEnter(e);(t=this._options)!=null&&t.conversational?this.label.textContent=b({key:"content2",comment:['A label with keybindg like "ESC to dismiss"']},"{1} to {0}",this._action.label,i):this.label.textContent=b({key:"content",comment:["A label","A keybinding"]},"{0} ({1})",this._action.label,i)}}static _symbolPrintEnter(e){var t;return(t=e.getLabel())==null?void 0:t.replace(/\benter\b/gi,"⏎").replace(/\bEscape\b/gi,"Esc")}}let g8=class extends SA{constructor(e,t,i,n,r){const o={...t,menuAsChild:(t==null?void 0:t.menuAsChild)??!1,classNames:(t==null?void 0:t.classNames)??(at.isThemeIcon(e.item.icon)?at.asClassName(e.item.icon):void 0),keybindingProvider:(t==null?void 0:t.keybindingProvider)??(a=>i.lookupKeybinding(a.id))};super(e,{getActions:()=>e.actions},n,o),this._keybindingService=i,this._contextMenuService=n,this._themeService=r}render(e){super.render(e),ii(this.element),e.classList.add("menu-entry");const t=this._action,{icon:i}=t.item;if(i&&!at.isThemeIcon(i)){this.element.classList.add("icon");const n=()=>{this.element&&(this.element.style.backgroundImage=m1(this._themeService.getColorTheme().type)?xg(i.dark):xg(i.light))};n(),this._register(this._themeService.onDidColorThemeChange(()=>{n()}))}}};g8=HF([Qo(2,pi),Qo(3,Ba),Qo(4,gs)],g8);let p8=class extends qd{constructor(e,t,i,n,r,o,a,l){super(null,e),this._keybindingService=i,this._notificationService=n,this._contextMenuService=r,this._menuService=o,this._instaService=a,this._storageService=l,this._container=null,this._options=t,this._storageKey=`${e.item.submenu.id}_lastActionId`;let c;const d=t!=null&&t.persistLastActionId?l.get(this._storageKey,1):void 0;d&&(c=e.actions.find(h=>d===h.id)),c||(c=e.actions[0]),this._defaultAction=this._instaService.createInstance(Ym,c,{keybinding:this._getDefaultActionKeybindingLabel(c)});const u={keybindingProvider:h=>this._keybindingService.lookupKeybinding(h.id),...t,menuAsChild:(t==null?void 0:t.menuAsChild)??!0,classNames:(t==null?void 0:t.classNames)??["codicon","codicon-chevron-down"],actionRunner:(t==null?void 0:t.actionRunner)??new hw};this._dropdown=new SA(e,e.actions,this._contextMenuService,u),this._register(this._dropdown.actionRunner.onDidRun(h=>{h.action instanceof Ra&&this.update(h.action)}))}update(e){var t;(t=this._options)!=null&&t.persistLastActionId&&this._storageService.store(this._storageKey,e.id,1,1),this._defaultAction.dispose(),this._defaultAction=this._instaService.createInstance(Ym,e,{keybinding:this._getDefaultActionKeybindingLabel(e)}),this._defaultAction.actionRunner=new class extends hw{async runAction(i,n){await i.run(void 0)}},this._container&&this._defaultAction.render(zq(this._container,ke(".action-container")))}_getDefaultActionKeybindingLabel(e){var i;let t;if((i=this._options)!=null&&i.renderKeybindingWithDefaultActionLabel){const n=this._keybindingService.lookupKeybinding(e.id);n&&(t=`(${n.getLabel()})`)}return t}setActionContext(e){super.setActionContext(e),this._defaultAction.setActionContext(e),this._dropdown.setActionContext(e)}render(e){this._container=e,super.render(this._container),this._container.classList.add("monaco-dropdown-with-default");const t=ke(".action-container");this._defaultAction.render(me(this._container,t)),this._register(oe(t,Le.KEY_DOWN,n=>{const r=new Mi(n);r.equals(17)&&(this._defaultAction.element.tabIndex=-1,this._dropdown.focus(),r.stopPropagation())}));const i=ke(".dropdown-action-container");this._dropdown.render(me(this._container,i)),this._register(oe(i,Le.KEY_DOWN,n=>{var o;const r=new Mi(n);r.equals(15)&&(this._defaultAction.element.tabIndex=0,this._dropdown.setFocusable(!1),(o=this._defaultAction.element)==null||o.focus(),r.stopPropagation())}))}focus(e){e?this._dropdown.focus():(this._defaultAction.element.tabIndex=0,this._defaultAction.element.focus())}blur(){this._defaultAction.element.tabIndex=-1,this._dropdown.blur(),this._container.blur()}setFocusable(e){e?this._defaultAction.element.tabIndex=0:(this._defaultAction.element.tabIndex=-1,this._dropdown.setFocusable(!1))}dispose(){this._defaultAction.dispose(),this._dropdown.dispose(),super.dispose()}};p8=HF([Qo(2,pi),Qo(3,jn),Qo(4,Ba),Qo(5,Ol),Qo(6,Xe),Qo(7,md)],p8);let m8=class extends q9e{constructor(e,t){super(null,e,e.actions.map(i=>({text:i.id===ks.ID?"─────────":i.label,isDisabled:!i.enabled})),0,t,sVe,{ariaLabel:e.tooltip,optionsAsChildren:!0}),this.select(Math.max(0,e.actions.findIndex(i=>i.checked)))}render(e){super.render(e),e.style.borderColor=Fe(gK)}runAction(e,t){const i=this.action.actions[t];i&&this.actionRunner.run(i)}};m8=HF([Qo(1,Fg)],m8);function uge(s,e,t){return e instanceof Ra?s.createInstance(Ym,e,t):e instanceof _y?e.item.isSelection?s.createInstance(m8,e):e.item.rememberDefaultAction?s.createInstance(p8,e,{...t,persistLastActionId:!0}):s.createInstance(g8,e,t):void 0}class Dl extends te{constructor(e,t={}){var r,o;super(),this._actionRunnerDisposables=this._register(new ce),this.viewItemDisposables=this._register(new Sq),this.triggerKeyDown=!1,this.focusable=!0,this._onDidBlur=this._register(new Z),this.onDidBlur=this._onDidBlur.event,this._onDidCancel=this._register(new Z({onWillAddFirstListener:()=>this.cancelHasListener=!0})),this.onDidCancel=this._onDidCancel.event,this.cancelHasListener=!1,this._onDidRun=this._register(new Z),this.onDidRun=this._onDidRun.event,this._onWillRun=this._register(new Z),this.onWillRun=this._onWillRun.event,this.options=t,this._context=t.context??null,this._orientation=this.options.orientation??0,this._triggerKeys={keyDown:((r=this.options.triggerKeys)==null?void 0:r.keyDown)??!1,keys:((o=this.options.triggerKeys)==null?void 0:o.keys)??[3,10]},this._hoverDelegate=t.hoverDelegate??this._register(k1()),this.options.actionRunner?this._actionRunner=this.options.actionRunner:(this._actionRunner=new hw,this._actionRunnerDisposables.add(this._actionRunner)),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(a=>this._onDidRun.fire(a))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(a=>this._onWillRun.fire(a))),this.viewItems=[],this.focusedItem=void 0,this.domNode=document.createElement("div"),this.domNode.className="monaco-action-bar";let i,n;switch(this._orientation){case 0:i=[15],n=[17];break;case 1:i=[16],n=[18],this.domNode.className+=" vertical";break}this._register(oe(this.domNode,Le.KEY_DOWN,a=>{const l=new Mi(a);let c=!0;const d=typeof this.focusedItem=="number"?this.viewItems[this.focusedItem]:void 0;i&&(l.equals(i[0])||l.equals(i[1]))?c=this.focusPrevious():n&&(l.equals(n[0])||l.equals(n[1]))?c=this.focusNext():l.equals(9)&&this.cancelHasListener?this._onDidCancel.fire():l.equals(14)?c=this.focusFirst():l.equals(13)?c=this.focusLast():l.equals(2)&&d instanceof qd&&d.trapsArrowNavigation?c=this.focusNext(void 0,!0):this.isTriggerKeyEvent(l)?this._triggerKeys.keyDown?this.doTrigger(l):this.triggerKeyDown=!0:c=!1,c&&(l.preventDefault(),l.stopPropagation())})),this._register(oe(this.domNode,Le.KEY_UP,a=>{const l=new Mi(a);this.isTriggerKeyEvent(l)?(!this._triggerKeys.keyDown&&this.triggerKeyDown&&(this.triggerKeyDown=!1,this.doTrigger(l)),l.preventDefault(),l.stopPropagation()):(l.equals(2)||l.equals(1026)||l.equals(16)||l.equals(18)||l.equals(15)||l.equals(17))&&this.updateFocusedItem()})),this.focusTracker=this._register(hu(this.domNode)),this._register(this.focusTracker.onDidBlur(()=>{(hr()===this.domNode||!ys(hr(),this.domNode))&&(this._onDidBlur.fire(),this.previouslyFocusedItem=this.focusedItem,this.focusedItem=void 0,this.triggerKeyDown=!1)})),this._register(this.focusTracker.onDidFocus(()=>this.updateFocusedItem())),this.actionsList=document.createElement("ul"),this.actionsList.className="actions-container",this.options.highlightToggledItems&&this.actionsList.classList.add("highlight-toggled"),this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"),this.options.ariaLabel&&this.actionsList.setAttribute("aria-label",this.options.ariaLabel),this.domNode.appendChild(this.actionsList),e.appendChild(this.domNode)}refreshRole(){this.length()>=1?this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"):this.actionsList.setAttribute("role","presentation")}setFocusable(e){if(this.focusable=e,this.focusable){const t=this.viewItems.find(i=>i instanceof qd&&i.isEnabled());t instanceof qd&&t.setFocusable(!0)}else this.viewItems.forEach(t=>{t instanceof qd&&t.setFocusable(!1)})}isTriggerKeyEvent(e){let t=!1;return this._triggerKeys.keys.forEach(i=>{t=t||e.equals(i)}),t}updateFocusedItem(){var e,t;for(let i=0;i<this.actionsList.children.length;i++){const n=this.actionsList.children[i];if(ys(hr(),n)){this.focusedItem=i,(t=(e=this.viewItems[this.focusedItem])==null?void 0:e.showHover)==null||t.call(e);break}}}get context(){return this._context}set context(e){this._context=e,this.viewItems.forEach(t=>t.setActionContext(e))}get actionRunner(){return this._actionRunner}set actionRunner(e){this._actionRunner=e,this._actionRunnerDisposables.clear(),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(t=>this._onDidRun.fire(t))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(t=>this._onWillRun.fire(t))),this.viewItems.forEach(t=>t.actionRunner=e)}getContainer(){return this.domNode}getAction(e){var t;if(typeof e=="number")return(t=this.viewItems[e])==null?void 0:t.action;if(Ls(e)){for(;e.parentElement!==this.actionsList;){if(!e.parentElement)return;e=e.parentElement}for(let i=0;i<this.actionsList.childNodes.length;i++)if(this.actionsList.childNodes[i]===e)return this.viewItems[i].action}}push(e,t={}){const i=Array.isArray(e)?e:[e];let n=Vm(t.index)?t.index:null;i.forEach(r=>{const o=document.createElement("li");o.className="action-item",o.setAttribute("role","presentation");let a;const l={hoverDelegate:this._hoverDelegate,...t,isTabList:this.options.ariaRole==="tablist"};this.options.actionViewItemProvider&&(a=this.options.actionViewItemProvider(r,l)),a||(a=new I1(this.context,r,l)),this.options.allowContextMenu||this.viewItemDisposables.set(a,oe(o,Le.CONTEXT_MENU,c=>{jt.stop(c,!0)})),a.actionRunner=this._actionRunner,a.setActionContext(this.context),a.render(o),this.focusable&&a instanceof qd&&this.viewItems.length===0&&a.setFocusable(!0),n===null||n<0||n>=this.actionsList.children.length?(this.actionsList.appendChild(o),this.viewItems.push(a)):(this.actionsList.insertBefore(o,this.actionsList.children[n]),this.viewItems.splice(n,0,a),n++)}),typeof this.focusedItem=="number"&&this.focus(this.focusedItem),this.refreshRole()}clear(){this.isEmpty()||(this.viewItems=Ni(this.viewItems),this.viewItemDisposables.clearAndDisposeAll(),Ys(this.actionsList),this.refreshRole())}length(){return this.viewItems.length}isEmpty(){return this.viewItems.length===0}focus(e){let t=!1,i;if(e===void 0?t=!0:typeof e=="number"?i=e:typeof e=="boolean"&&(t=e),t&&typeof this.focusedItem>"u"){const n=this.viewItems.findIndex(r=>r.isEnabled());this.focusedItem=n===-1?void 0:n,this.updateFocus(void 0,void 0,!0)}else i!==void 0&&(this.focusedItem=i),this.updateFocus(void 0,void 0,!0)}focusFirst(){return this.focusedItem=this.length()-1,this.focusNext(!0)}focusLast(){return this.focusedItem=0,this.focusPrevious(!0)}focusNext(e,t){if(typeof this.focusedItem>"u")this.focusedItem=this.viewItems.length-1;else if(this.viewItems.length<=1)return!1;const i=this.focusedItem;let n;do{if(!e&&this.options.preventLoopNavigation&&this.focusedItem+1>=this.viewItems.length)return this.focusedItem=i,!1;this.focusedItem=(this.focusedItem+1)%this.viewItems.length,n=this.viewItems[this.focusedItem]}while(this.focusedItem!==i&&(this.options.focusOnlyEnabledItems&&!n.isEnabled()||n.action.id===ks.ID));return this.updateFocus(void 0,void 0,t),!0}focusPrevious(e){if(typeof this.focusedItem>"u")this.focusedItem=0;else if(this.viewItems.length<=1)return!1;const t=this.focusedItem;let i;do{if(this.focusedItem=this.focusedItem-1,this.focusedItem<0){if(!e&&this.options.preventLoopNavigation)return this.focusedItem=t,!1;this.focusedItem=this.viewItems.length-1}i=this.viewItems[this.focusedItem]}while(this.focusedItem!==t&&(this.options.focusOnlyEnabledItems&&!i.isEnabled()||i.action.id===ks.ID));return this.updateFocus(!0),!0}updateFocus(e,t,i=!1){var r,o;typeof this.focusedItem>"u"&&this.actionsList.focus({preventScroll:t}),this.previouslyFocusedItem!==void 0&&this.previouslyFocusedItem!==this.focusedItem&&((r=this.viewItems[this.previouslyFocusedItem])==null||r.blur());const n=this.focusedItem!==void 0?this.viewItems[this.focusedItem]:void 0;if(n){let a=!0;Kk(n.focus)||(a=!1),this.options.focusOnlyEnabledItems&&Kk(n.isEnabled)&&!n.isEnabled()&&(a=!1),n.action.id===ks.ID&&(a=!1),a?(i||this.previouslyFocusedItem!==this.focusedItem)&&(n.focus(e),this.previouslyFocusedItem=this.focusedItem):(this.actionsList.focus({preventScroll:t}),this.previouslyFocusedItem=void 0),a&&((o=n.showHover)==null||o.call(n))}}doTrigger(e){if(typeof this.focusedItem>"u")return;const t=this.viewItems[this.focusedItem];if(t instanceof qd){const i=t._context===null||t._context===void 0?e:t._context;this.run(t._action,i)}}async run(e,t){await this._actionRunner.run(e,t)}dispose(){this._context=void 0,this.viewItems=Ni(this.viewItems),this.getContainer().remove(),super.dispose()}}const _8=/\(&([^\s&])\)|(^|[^&])&([^\s&])/,FV=/(&amp;)?(&amp;)([^\s&])/g;var kA;(function(s){s[s.Right=0]="Right",s[s.Left=1]="Left"})(kA||(kA={}));var b8;(function(s){s[s.Above=0]="Above",s[s.Below=1]="Below"})(b8||(b8={}));class Sy extends Dl{constructor(e,t,i,n){e.classList.add("monaco-menu-container"),e.setAttribute("role","presentation");const r=document.createElement("div");r.classList.add("monaco-menu"),r.setAttribute("role","presentation"),super(r,{orientation:1,actionViewItemProvider:c=>this.doGetActionViewItem(c,i,o),context:i.context,actionRunner:i.actionRunner,ariaLabel:i.ariaLabel,ariaRole:"menu",focusOnlyEnabledItems:!0,triggerKeys:{keys:[3,...Wt||Lo?[10]:[]],keyDown:!0}}),this.menuStyles=n,this.menuElement=r,this.actionsList.tabIndex=0,this.initializeOrUpdateStyleSheet(e,n),this._register(Er.addTarget(r)),this._register(oe(r,Le.KEY_DOWN,c=>{new Mi(c).equals(2)&&c.preventDefault()})),i.enableMnemonics&&this._register(oe(r,Le.KEY_DOWN,c=>{const d=c.key.toLocaleLowerCase();if(this.mnemonics.has(d)){jt.stop(c,!0);const u=this.mnemonics.get(d);if(u.length===1&&(u[0]instanceof fne&&u[0].container&&this.focusItemByElement(u[0].container),u[0].onClick(c)),u.length>1){const h=u.shift();h&&h.container&&(this.focusItemByElement(h.container),u.push(h)),this.mnemonics.set(d,u)}}})),Lo&&this._register(oe(r,Le.KEY_DOWN,c=>{const d=new Mi(c);d.equals(14)||d.equals(11)?(this.focusedItem=this.viewItems.length-1,this.focusNext(),jt.stop(c,!0)):(d.equals(13)||d.equals(12))&&(this.focusedItem=0,this.focusPrevious(),jt.stop(c,!0))})),this._register(oe(this.domNode,Le.MOUSE_OUT,c=>{const d=c.relatedTarget;ys(d,this.domNode)||(this.focusedItem=void 0,this.updateFocus(),c.stopPropagation())})),this._register(oe(this.actionsList,Le.MOUSE_OVER,c=>{let d=c.target;if(!(!d||!ys(d,this.actionsList)||d===this.actionsList)){for(;d.parentElement!==this.actionsList&&d.parentElement!==null;)d=d.parentElement;if(d.classList.contains("action-item")){const u=this.focusedItem;this.setFocusedItem(d),u!==this.focusedItem&&this.updateFocus()}}})),this._register(Er.addTarget(this.actionsList)),this._register(oe(this.actionsList,Vi.Tap,c=>{let d=c.initialTarget;if(!(!d||!ys(d,this.actionsList)||d===this.actionsList)){for(;d.parentElement!==this.actionsList&&d.parentElement!==null;)d=d.parentElement;if(d.classList.contains("action-item")){const u=this.focusedItem;this.setFocusedItem(d),u!==this.focusedItem&&this.updateFocus()}}}));const o={parent:this};this.mnemonics=new Map,this.scrollableElement=this._register(new QE(r,{alwaysConsumeMouseWheel:!0,horizontal:2,vertical:3,verticalScrollbarSize:7,handleMouseWheel:!0,useShadows:!0}));const a=this.scrollableElement.getDomNode();a.style.position="",this.styleScrollElement(a,n),this._register(oe(r,Vi.Change,c=>{jt.stop(c,!0);const d=this.scrollableElement.getScrollPosition().scrollTop;this.scrollableElement.setScrollPosition({scrollTop:d-c.translationY})})),this._register(oe(a,Le.MOUSE_UP,c=>{c.preventDefault()}));const l=nt(e);r.style.maxHeight=`${Math.max(10,l.innerHeight-e.getBoundingClientRect().top-35)}px`,t=t.filter((c,d)=>{var u;return(u=i.submenuIds)!=null&&u.has(c.id)?(console.warn(`Found submenu cycle: ${c.id}`),!1):!(c instanceof ks&&(d===t.length-1||d===0||t[d-1]instanceof ks))}),this.push(t,{icon:!0,label:!0,isMenu:!0}),e.appendChild(this.scrollableElement.getDomNode()),this.scrollableElement.scanDomNode(),this.viewItems.filter(c=>!(c instanceof gne)).forEach((c,d,u)=>{c.updatePositionInSet(d+1,u.length)})}initializeOrUpdateStyleSheet(e,t){this.styleSheet||($2(e)?this.styleSheet=Rl(e):(Sy.globalStyleSheet||(Sy.globalStyleSheet=Rl()),this.styleSheet=Sy.globalStyleSheet)),this.styleSheet.textContent=lVe(t,$2(e))}styleScrollElement(e,t){const i=t.foregroundColor??"",n=t.backgroundColor??"",r=t.borderColor?`1px solid ${t.borderColor}`:"",o="5px",a=t.shadowColor?`0 2px 8px ${t.shadowColor}`:"";e.style.outline=r,e.style.borderRadius=o,e.style.color=i,e.style.backgroundColor=n,e.style.boxShadow=a}getContainer(){return this.scrollableElement.getDomNode()}get onScroll(){return this.scrollableElement.onScroll}focusItemByElement(e){const t=this.focusedItem;this.setFocusedItem(e),t!==this.focusedItem&&this.updateFocus()}setFocusedItem(e){for(let t=0;t<this.actionsList.children.length;t++){const i=this.actionsList.children[t];if(e===i){this.focusedItem=t;break}}}updateFocus(e){super.updateFocus(e,!0,!0),typeof this.focusedItem<"u"&&this.scrollableElement.setScrollPosition({scrollTop:Math.round(this.menuElement.scrollTop)})}doGetActionViewItem(e,t,i){if(e instanceof ks)return new gne(t.context,e,{icon:!0},this.menuStyles);if(e instanceof f1){const n=new fne(e,e.actions,i,{...t,submenuIds:new Set([...t.submenuIds||[],e.id])},this.menuStyles);if(t.enableMnemonics){const r=n.getMnemonic();if(r&&n.isEnabled()){let o=[];this.mnemonics.has(r)&&(o=this.mnemonics.get(r)),o.push(n),this.mnemonics.set(r,o)}}return n}else{const n={enableMnemonics:t.enableMnemonics,useEventAsContext:t.useEventAsContext};if(t.getKeyBinding){const o=t.getKeyBinding(e);if(o){const a=o.getLabel();a&&(n.keybinding=a)}}const r=new hge(t.context,e,n,this.menuStyles);if(t.enableMnemonics){const o=r.getMnemonic();if(o&&r.isEnabled()){let a=[];this.mnemonics.has(o)&&(a=this.mnemonics.get(o)),a.push(r),this.mnemonics.set(o,a)}}return r}}}class hge extends qd{constructor(e,t,i,n){if(i.isMenu=!0,super(t,t,i),this.menuStyle=n,this.options=i,this.options.icon=i.icon!==void 0?i.icon:!1,this.options.label=i.label!==void 0?i.label:!0,this.cssClass="",this.options.label&&i.enableMnemonics){const r=this.action.label;if(r){const o=_8.exec(r);o&&(this.mnemonic=(o[1]?o[1]:o[3]).toLocaleLowerCase())}}this.runOnceToEnableMouseUp=new xi(()=>{this.element&&(this._register(oe(this.element,Le.MOUSE_UP,r=>{if(jt.stop(r,!0),_c){if(new Xc(nt(this.element),r).rightButton)return;this.onClick(r)}else setTimeout(()=>{this.onClick(r)},0)})),this._register(oe(this.element,Le.CONTEXT_MENU,r=>{jt.stop(r,!0)})))},100),this._register(this.runOnceToEnableMouseUp)}render(e){super.render(e),this.element&&(this.container=e,this.item=me(this.element,ke("a.action-menu-item")),this._action.id===ks.ID?this.item.setAttribute("role","presentation"):(this.item.setAttribute("role","menuitem"),this.mnemonic&&this.item.setAttribute("aria-keyshortcuts",`${this.mnemonic}`)),this.check=me(this.item,ke("span.menu-item-check"+at.asCSSSelector(xe.menuSelection))),this.check.setAttribute("role","none"),this.label=me(this.item,ke("span.action-label")),this.options.label&&this.options.keybinding&&(me(this.item,ke("span.keybinding")).textContent=this.options.keybinding),this.runOnceToEnableMouseUp.schedule(),this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked(),this.applyStyle())}blur(){super.blur(),this.applyStyle()}focus(){var e;super.focus(),(e=this.item)==null||e.focus(),this.applyStyle()}updatePositionInSet(e,t){this.item&&(this.item.setAttribute("aria-posinset",`${e}`),this.item.setAttribute("aria-setsize",`${t}`))}updateLabel(){var e;if(this.label&&this.options.label){Ys(this.label);let t=LK(this.action.label);if(t){const i=aVe(t);this.options.enableMnemonics||(t=i),this.label.setAttribute("aria-label",i.replace(/&&/g,"&"));const n=_8.exec(t);if(n){t=DL(t),FV.lastIndex=0;let r=FV.exec(t);for(;r&&r[1];)r=FV.exec(t);const o=a=>a.replace(/&amp;&amp;/g,"&amp;");r?this.label.append(WE(o(t.substr(0,r.index))," "),ke("u",{"aria-hidden":"true"},r[3]),Eue(o(t.substr(r.index+r[0].length))," ")):this.label.innerText=o(t).trim(),(e=this.item)==null||e.setAttribute("aria-keyshortcuts",(n[1]?n[1]:n[3]).toLocaleLowerCase())}else this.label.innerText=t.replace(/&&/g,"&").trim()}}}updateTooltip(){}updateClass(){this.cssClass&&this.item&&this.item.classList.remove(...this.cssClass.split(" ")),this.options.icon&&this.label?(this.cssClass=this.action.class||"",this.label.classList.add("icon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" ")),this.updateEnabled()):this.label&&this.label.classList.remove("icon")}updateEnabled(){this.action.enabled?(this.element&&(this.element.classList.remove("disabled"),this.element.removeAttribute("aria-disabled")),this.item&&(this.item.classList.remove("disabled"),this.item.removeAttribute("aria-disabled"),this.item.tabIndex=0)):(this.element&&(this.element.classList.add("disabled"),this.element.setAttribute("aria-disabled","true")),this.item&&(this.item.classList.add("disabled"),this.item.setAttribute("aria-disabled","true")))}updateChecked(){if(!this.item)return;const e=this.action.checked;this.item.classList.toggle("checked",!!e),e!==void 0?(this.item.setAttribute("role","menuitemcheckbox"),this.item.setAttribute("aria-checked",e?"true":"false")):(this.item.setAttribute("role","menuitem"),this.item.setAttribute("aria-checked",""))}getMnemonic(){return this.mnemonic}applyStyle(){const e=this.element&&this.element.classList.contains("focused"),t=e&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor,i=e&&this.menuStyle.selectionBackgroundColor?this.menuStyle.selectionBackgroundColor:void 0,n=e&&this.menuStyle.selectionBorderColor?`1px solid ${this.menuStyle.selectionBorderColor}`:"",r=e&&this.menuStyle.selectionBorderColor?"-1px":"";this.item&&(this.item.style.color=t??"",this.item.style.backgroundColor=i??"",this.item.style.outline=n,this.item.style.outlineOffset=r),this.check&&(this.check.style.color=t??"")}}class fne extends hge{constructor(e,t,i,n,r){super(e,e,n,r),this.submenuActions=t,this.parentData=i,this.submenuOptions=n,this.mysubmenu=null,this.submenuDisposables=this._register(new ce),this.mouseOver=!1,this.expandDirection=n&&n.expandDirection!==void 0?n.expandDirection:{horizontal:kA.Right,vertical:b8.Below},this.showScheduler=new xi(()=>{this.mouseOver&&(this.cleanupExistingSubmenu(!1),this.createSubmenu(!1))},250),this.hideScheduler=new xi(()=>{this.element&&!ys(hr(),this.element)&&this.parentData.submenu===this.mysubmenu&&(this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!0))},750)}render(e){super.render(e),this.element&&(this.item&&(this.item.classList.add("monaco-submenu-item"),this.item.tabIndex=0,this.item.setAttribute("aria-haspopup","true"),this.updateAriaExpanded("false"),this.submenuIndicator=me(this.item,ke("span.submenu-indicator"+at.asCSSSelector(xe.menuSubmenu))),this.submenuIndicator.setAttribute("aria-hidden","true")),this._register(oe(this.element,Le.KEY_UP,t=>{const i=new Mi(t);(i.equals(17)||i.equals(3))&&(jt.stop(t,!0),this.createSubmenu(!0))})),this._register(oe(this.element,Le.KEY_DOWN,t=>{const i=new Mi(t);hr()===this.item&&(i.equals(17)||i.equals(3))&&jt.stop(t,!0)})),this._register(oe(this.element,Le.MOUSE_OVER,t=>{this.mouseOver||(this.mouseOver=!0,this.showScheduler.schedule())})),this._register(oe(this.element,Le.MOUSE_LEAVE,t=>{this.mouseOver=!1})),this._register(oe(this.element,Le.FOCUS_OUT,t=>{this.element&&!ys(hr(),this.element)&&this.hideScheduler.schedule()})),this._register(this.parentData.parent.onScroll(()=>{this.parentData.submenu===this.mysubmenu&&(this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!0))})))}updateEnabled(){}onClick(e){jt.stop(e,!0),this.cleanupExistingSubmenu(!1),this.createSubmenu(!0)}cleanupExistingSubmenu(e){if(this.parentData.submenu&&(e||this.parentData.submenu!==this.mysubmenu)){try{this.parentData.submenu.dispose()}catch{}this.parentData.submenu=void 0,this.updateAriaExpanded("false"),this.submenuContainer&&(this.submenuDisposables.clear(),this.submenuContainer=void 0)}}calculateSubmenuMenuLayout(e,t,i,n){const r={top:0,left:0};return r.left=EC(e.width,t.width,{position:n.horizontal===kA.Right?0:1,offset:i.left,size:i.width}),r.left>=i.left&&r.left<i.left+i.width&&(i.left+10+t.width<=e.width&&(r.left=i.left+10),i.top+=10,i.height=0),r.top=EC(e.height,t.height,{position:0,offset:i.top,size:0}),r.top+t.height===i.top&&r.top+i.height+t.height<=e.height&&(r.top+=i.height),r}createSubmenu(e=!0){if(this.element)if(this.parentData.submenu)this.parentData.submenu.focus(!1);else{this.updateAriaExpanded("true"),this.submenuContainer=me(this.element,ke("div.monaco-submenu")),this.submenuContainer.classList.add("menubar-menu-items-holder","context-view");const t=nt(this.parentData.parent.domNode).getComputedStyle(this.parentData.parent.domNode),i=parseFloat(t.paddingTop||"0")||0;this.submenuContainer.style.zIndex="1",this.submenuContainer.style.position="fixed",this.submenuContainer.style.top="0",this.submenuContainer.style.left="0",this.parentData.submenu=new Sy(this.submenuContainer,this.submenuActions.length?this.submenuActions:[new JW],this.submenuOptions,this.menuStyle);const n=this.element.getBoundingClientRect(),r={top:n.top-i,left:n.left,height:n.height+2*i,width:n.width},o=this.submenuContainer.getBoundingClientRect(),a=nt(this.element),{top:l,left:c}=this.calculateSubmenuMenuLayout(new Ci(a.innerWidth,a.innerHeight),Ci.lift(o),r,this.expandDirection);this.submenuContainer.style.left=`${c-o.left}px`,this.submenuContainer.style.top=`${l-o.top}px`,this.submenuDisposables.add(oe(this.submenuContainer,Le.KEY_UP,d=>{new Mi(d).equals(15)&&(jt.stop(d,!0),this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0))})),this.submenuDisposables.add(oe(this.submenuContainer,Le.KEY_DOWN,d=>{new Mi(d).equals(15)&&jt.stop(d,!0)})),this.submenuDisposables.add(this.parentData.submenu.onDidCancel(()=>{this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0)})),this.parentData.submenu.focus(e),this.mysubmenu=this.parentData.submenu}}updateAriaExpanded(e){var t;this.item&&((t=this.item)==null||t.setAttribute("aria-expanded",e))}applyStyle(){super.applyStyle();const t=this.element&&this.element.classList.contains("focused")&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor;this.submenuIndicator&&(this.submenuIndicator.style.color=t??"")}dispose(){super.dispose(),this.hideScheduler.dispose(),this.mysubmenu&&(this.mysubmenu.dispose(),this.mysubmenu=null),this.submenuContainer&&(this.submenuContainer=void 0)}}class gne extends I1{constructor(e,t,i,n){super(e,t,i),this.menuStyles=n}render(e){super.render(e),this.label&&(this.label.style.borderBottomColor=this.menuStyles.separatorColor?`${this.menuStyles.separatorColor}`:"")}}function aVe(s){const e=_8,t=e.exec(s);if(!t)return s;const i=!t[1];return s.replace(e,i?"$2$3":"").trim()}function pne(s){const e=yue()[s.id];return`.codicon-${s.id}:before { content: '\\${e.toString(16)}'; }`}function lVe(s,e){let t=`
.monaco-menu {
	font-size: 13px;
	border-radius: 5px;
	min-width: 160px;
}

${pne(xe.menuSelection)}
${pne(xe.menuSubmenu)}

.monaco-menu .monaco-action-bar {
	text-align: right;
	overflow: hidden;
	white-space: nowrap;
}

.monaco-menu .monaco-action-bar .actions-container {
	display: flex;
	margin: 0 auto;
	padding: 0;
	width: 100%;
	justify-content: flex-end;
}

.monaco-menu .monaco-action-bar.vertical .actions-container {
	display: inline-block;
}

.monaco-menu .monaco-action-bar.reverse .actions-container {
	flex-direction: row-reverse;
}

.monaco-menu .monaco-action-bar .action-item {
	cursor: pointer;
	display: inline-block;
	transition: transform 50ms ease;
	position: relative;  /* DO NOT REMOVE - this is the key to preventing the ghosting icon bug in Chrome 42 */
}

.monaco-menu .monaco-action-bar .action-item.disabled {
	cursor: default;
}

.monaco-menu .monaco-action-bar .action-item .icon,
.monaco-menu .monaco-action-bar .action-item .codicon {
	display: inline-block;
}

.monaco-menu .monaco-action-bar .action-item .codicon {
	display: flex;
	align-items: center;
}

.monaco-menu .monaco-action-bar .action-label {
	font-size: 11px;
	margin-right: 4px;
}

.monaco-menu .monaco-action-bar .action-item.disabled .action-label,
.monaco-menu .monaco-action-bar .action-item.disabled .action-label:hover {
	color: var(--vscode-disabledForeground);
}

/* Vertical actions */

.monaco-menu .monaco-action-bar.vertical {
	text-align: left;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	display: block;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	display: block;
	border-bottom: 1px solid var(--vscode-menu-separatorBackground);
	padding-top: 1px;
	padding: 30px;
}

.monaco-menu .secondary-actions .monaco-action-bar .action-label {
	margin-left: 6px;
}

/* Action Items */
.monaco-menu .monaco-action-bar .action-item.select-container {
	overflow: hidden; /* somehow the dropdown overflows its container, we prevent it here to not push */
	flex: 1;
	max-width: 170px;
	min-width: 60px;
	display: flex;
	align-items: center;
	justify-content: center;
	margin-right: 10px;
}

.monaco-menu .monaco-action-bar.vertical {
	margin-left: 0;
	overflow: visible;
}

.monaco-menu .monaco-action-bar.vertical .actions-container {
	display: block;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	padding: 0;
	transform: none;
	display: flex;
}

.monaco-menu .monaco-action-bar.vertical .action-item.active {
	transform: none;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item {
	flex: 1 1 auto;
	display: flex;
	height: 2em;
	align-items: center;
	position: relative;
	margin: 0 4px;
	border-radius: 4px;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item:hover .keybinding,
.monaco-menu .monaco-action-bar.vertical .action-menu-item:focus .keybinding {
	opacity: unset;
}

.monaco-menu .monaco-action-bar.vertical .action-label {
	flex: 1 1 auto;
	text-decoration: none;
	padding: 0 1em;
	background: none;
	font-size: 12px;
	line-height: 1;
}

.monaco-menu .monaco-action-bar.vertical .keybinding,
.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	display: inline-block;
	flex: 2 1 auto;
	padding: 0 1em;
	text-align: right;
	font-size: 12px;
	line-height: 1;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon {
	font-size: 16px !important;
	display: flex;
	align-items: center;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon::before {
	margin-left: auto;
	margin-right: -20px;
}

.monaco-menu .monaco-action-bar.vertical .action-item.disabled .keybinding,
.monaco-menu .monaco-action-bar.vertical .action-item.disabled .submenu-indicator {
	opacity: 0.4;
}

.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator) {
	display: inline-block;
	box-sizing: border-box;
	margin: 0;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	position: static;
	overflow: visible;
}

.monaco-menu .monaco-action-bar.vertical .action-item .monaco-submenu {
	position: absolute;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	width: 100%;
	height: 0px !important;
	opacity: 1;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator.text {
	padding: 0.7em 1em 0.1em 1em;
	font-weight: bold;
	opacity: 1;
}

.monaco-menu .monaco-action-bar.vertical .action-label:hover {
	color: inherit;
}

.monaco-menu .monaco-action-bar.vertical .menu-item-check {
	position: absolute;
	visibility: hidden;
	width: 1em;
	height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item.checked .menu-item-check {
	visibility: visible;
	display: flex;
	align-items: center;
	justify-content: center;
}

/* Context Menu */

.context-view.monaco-menu-container {
	outline: 0;
	border: none;
	animation: fadeIn 0.083s linear;
	-webkit-app-region: no-drag;
}

.context-view.monaco-menu-container :focus,
.context-view.monaco-menu-container .monaco-action-bar.vertical:focus,
.context-view.monaco-menu-container .monaco-action-bar.vertical :focus {
	outline: 0;
}

.hc-black .context-view.monaco-menu-container,
.hc-light .context-view.monaco-menu-container,
:host-context(.hc-black) .context-view.monaco-menu-container,
:host-context(.hc-light) .context-view.monaco-menu-container {
	box-shadow: none;
}

.hc-black .monaco-menu .monaco-action-bar.vertical .action-item.focused,
.hc-light .monaco-menu .monaco-action-bar.vertical .action-item.focused,
:host-context(.hc-black) .monaco-menu .monaco-action-bar.vertical .action-item.focused,
:host-context(.hc-light) .monaco-menu .monaco-action-bar.vertical .action-item.focused {
	background: none;
}

/* Vertical Action Bar Styles */

.monaco-menu .monaco-action-bar.vertical {
	padding: 4px 0;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item {
	height: 2em;
}

.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator),
.monaco-menu .monaco-action-bar.vertical .keybinding {
	font-size: inherit;
	padding: 0 2em;
	max-height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .menu-item-check {
	font-size: inherit;
	width: 2em;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	font-size: inherit;
	margin: 5px 0 !important;
	padding: 0;
	border-radius: 0;
}

.linux .monaco-menu .monaco-action-bar.vertical .action-label.separator,
:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .action-label.separator {
	margin-left: 0;
	margin-right: 0;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	font-size: 60%;
	padding: 0 1.8em;
}

.linux .monaco-menu .monaco-action-bar.vertical .submenu-indicator,
:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	height: 100%;
	mask-size: 10px 10px;
	-webkit-mask-size: 10px 10px;
}

.monaco-menu .action-item {
	cursor: default;
}`;if(e){t+=`
			/* Arrows */
			.monaco-scrollable-element > .scrollbar > .scra {
				cursor: pointer;
				font-size: 11px !important;
			}

			.monaco-scrollable-element > .visible {
				opacity: 1;

				/* Background rule added for IE9 - to allow clicks on dom node */
				background:rgba(0,0,0,0);

				transition: opacity 100ms linear;
			}
			.monaco-scrollable-element > .invisible {
				opacity: 0;
				pointer-events: none;
			}
			.monaco-scrollable-element > .invisible.fade {
				transition: opacity 800ms linear;
			}

			/* Scrollable Content Inset Shadow */
			.monaco-scrollable-element > .shadow {
				position: absolute;
				display: none;
			}
			.monaco-scrollable-element > .shadow.top {
				display: block;
				top: 0;
				left: 3px;
				height: 3px;
				width: 100%;
			}
			.monaco-scrollable-element > .shadow.left {
				display: block;
				top: 3px;
				left: 0;
				height: 100%;
				width: 3px;
			}
			.monaco-scrollable-element > .shadow.top-left-corner {
				display: block;
				top: 0;
				left: 0;
				height: 3px;
				width: 3px;
			}
		`;const i=s.scrollbarShadow;i&&(t+=`
				.monaco-scrollable-element > .shadow.top {
					box-shadow: ${i} 0 6px 6px -6px inset;
				}

				.monaco-scrollable-element > .shadow.left {
					box-shadow: ${i} 6px 0 6px -6px inset;
				}

				.monaco-scrollable-element > .shadow.top.left {
					box-shadow: ${i} 6px 6px 6px -6px inset;
				}
			`);const n=s.scrollbarSliderBackground;n&&(t+=`
				.monaco-scrollable-element > .scrollbar > .slider {
					background: ${n};
				}
			`);const r=s.scrollbarSliderHoverBackground;r&&(t+=`
				.monaco-scrollable-element > .scrollbar > .slider:hover {
					background: ${r};
				}
			`);const o=s.scrollbarSliderActiveBackground;o&&(t+=`
				.monaco-scrollable-element > .scrollbar > .slider.active {
					background: ${o};
				}
			`)}return t}class cVe{constructor(e,t,i,n){this.contextViewService=e,this.telemetryService=t,this.notificationService=i,this.keybindingService=n,this.focusToReturn=null,this.lastContainer=null,this.block=null,this.blockDisposable=null,this.options={blockMouse:!0}}configure(e){this.options=e}showContextMenu(e){const t=e.getActions();if(!t.length)return;this.focusToReturn=hr();let i;const n=Ls(e.domForShadowRoot)?e.domForShadowRoot:void 0;this.contextViewService.showContextView({getAnchor:()=>e.getAnchor(),canRelayout:!1,anchorAlignment:e.anchorAlignment,anchorAxisAlignment:e.anchorAxisAlignment,render:r=>{var d;this.lastContainer=r;const o=e.getMenuClassName?e.getMenuClassName():"";o&&(r.className+=" "+o),this.options.blockMouse&&(this.block=r.appendChild(ke(".context-view-block")),this.block.style.position="fixed",this.block.style.cursor="initial",this.block.style.left="0",this.block.style.top="0",this.block.style.width="100%",this.block.style.height="100%",this.block.style.zIndex="-1",(d=this.blockDisposable)==null||d.dispose(),this.blockDisposable=oe(this.block,Le.MOUSE_DOWN,u=>u.stopPropagation()));const a=new ce,l=e.actionRunner||new hw;l.onWillRun(u=>this.onActionRun(u,!e.skipTelemetry),this,a),l.onDidRun(this.onDidActionRun,this,a),i=new Sy(r,t,{actionViewItemProvider:e.getActionViewItem,context:e.getActionsContext?e.getActionsContext():null,actionRunner:l,getKeyBinding:e.getKeyBinding?e.getKeyBinding:u=>this.keybindingService.lookupKeybinding(u.id)},rVe),i.onDidCancel(()=>this.contextViewService.hideContextView(!0),null,a),i.onDidBlur(()=>this.contextViewService.hideContextView(!0),null,a);const c=nt(r);return a.add(oe(c,Le.BLUR,()=>this.contextViewService.hideContextView(!0))),a.add(oe(c,Le.MOUSE_DOWN,u=>{if(u.defaultPrevented)return;const h=new Xc(c,u);let g=h.target;if(!h.rightButton){for(;g;){if(g===r)return;g=g.parentElement}this.contextViewService.hideContextView(!0)}})),id(a,i)},focus:()=>{i==null||i.focus(!!e.autoSelectFirstItem)},onHide:r=>{var o,a,l;(o=e.onHide)==null||o.call(e,!!r),this.block&&(this.block.remove(),this.block=null),(a=this.blockDisposable)==null||a.dispose(),this.blockDisposable=null,this.lastContainer&&(hr()===this.lastContainer||ys(hr(),this.lastContainer))&&((l=this.focusToReturn)==null||l.focus()),this.lastContainer=null}},n,!!n)}onActionRun(e,t){t&&this.telemetryService.publicLog2("workbenchActionExecuted",{id:e.action.id,from:"contextMenu"}),this.contextViewService.hideContextView(!1)}onDidActionRun(e){e.error&&!xc(e.error)&&this.notificationService.error(e.error)}}var dVe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},q0=function(s,e){return function(t,i){e(t,i,s)}};let v8=class extends te{get contextMenuHandler(){return this._contextMenuHandler||(this._contextMenuHandler=new cVe(this.contextViewService,this.telemetryService,this.notificationService,this.keybindingService)),this._contextMenuHandler}constructor(e,t,i,n,r,o){super(),this.telemetryService=e,this.notificationService=t,this.contextViewService=i,this.keybindingService=n,this.menuService=r,this.contextKeyService=o,this._contextMenuHandler=void 0,this._onDidShowContextMenu=this._store.add(new Z),this.onDidShowContextMenu=this._onDidShowContextMenu.event,this._onDidHideContextMenu=this._store.add(new Z)}configure(e){this.contextMenuHandler.configure(e)}showContextMenu(e){e=w8.transform(e,this.menuService,this.contextKeyService),this.contextMenuHandler.showContextMenu({...e,onHide:t=>{var i;(i=e.onHide)==null||i.call(e,t),this._onDidHideContextMenu.fire()}}),qf.getInstance().resetKeyStatus(),this._onDidShowContextMenu.fire()}};v8=dVe([q0(0,Tr),q0(1,jn),q0(2,Fg),q0(3,pi),q0(4,Ol),q0(5,ct)],v8);var w8;(function(s){function e(i){return i&&i.menuId instanceof ze}function t(i,n,r){if(!e(i))return i;const{menuId:o,menuActionOptions:a,contextKeyService:l}=i;return{...i,getActions:()=>{const c=[];if(o){const d=n.getMenuActions(o,l??r,a);oVe(d,c)}return i.getActions?ks.join(i.getActions(),c):c}}}s.transform=t})(w8||(w8={}));var IA;(function(s){s[s.API=0]="API",s[s.USER=1]="USER"})(IA||(IA={}));var OK=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},EA=function(s,e){return function(t,i){e(t,i,s)}};let C8=class{constructor(e){this._commandService=e}async open(e,t){if(!J4(e,gt.command))return!1;if(!(t!=null&&t.allowCommands)||(typeof e=="string"&&(e=Je.parse(e)),Array.isArray(t.allowCommands)&&!t.allowCommands.includes(e.path)))return!0;let i=[];try{i=H6(decodeURIComponent(e.query))}catch{try{i=H6(e.query)}catch{}}return Array.isArray(i)||(i=[i]),await this._commandService.executeCommand(e.path,...i),!0}};C8=OK([EA(0,Hi)],C8);let y8=class{constructor(e){this._editorService=e}async open(e,t){typeof e=="string"&&(e=Je.parse(e));const{selection:i,uri:n}=FFe(e);return e=n,e.scheme===gt.file&&(e=v5e(e)),await this._editorService.openCodeEditor({resource:e,options:{selection:i,source:t!=null&&t.fromUserGesture?IA.USER:IA.API,...t==null?void 0:t.editorOptions}},this._editorService.getFocusedCodeEditor(),t==null?void 0:t.openToSide),!0}};y8=OK([EA(0,ni)],y8);let S8=class{constructor(e,t){this._openers=new _o,this._validators=new _o,this._resolvers=new _o,this._resolvedUriTargets=new Fs(i=>i.with({path:null,fragment:null,query:null}).toString()),this._externalOpeners=new _o,this._defaultExternalOpener={openExternal:async i=>(qW(i,gt.http,gt.https)?ohe(i):Ri.location.href=i,!0)},this._openers.push({open:async(i,n)=>n!=null&&n.openExternal||qW(i,gt.mailto,gt.http,gt.https,gt.vsls)?(await this._doOpenExternal(i,n),!0):!1}),this._openers.push(new C8(t)),this._openers.push(new y8(e))}registerOpener(e){return{dispose:this._openers.unshift(e)}}async open(e,t){const i=typeof e=="string"?Je.parse(e):e,n=this._resolvedUriTargets.get(i)??e;for(const r of this._validators)if(!await r.shouldOpen(n,t))return!1;for(const r of this._openers)if(await r.open(e,t))return!0;return!1}async resolveExternalUri(e,t){for(const i of this._resolvers)try{const n=await i.resolveExternalUri(e,t);if(n)return this._resolvedUriTargets.has(n.resolved)||this._resolvedUriTargets.set(n.resolved,e),n}catch{}throw new Error("Could not resolve external URI: "+e.toString())}async _doOpenExternal(e,t){const i=typeof e=="string"?Je.parse(e):e;let n;try{n=(await this.resolveExternalUri(i,t)).resolved}catch{n=i}let r;if(typeof e=="string"&&i.toString()===n.toString()?r=e:r=encodeURI(n.toString(!0)),t!=null&&t.allowContributedOpeners){const o=typeof(t==null?void 0:t.allowContributedOpeners)=="string"?t==null?void 0:t.allowContributedOpeners:void 0;for(const a of this._externalOpeners)if(await a.openExternal(r,{sourceUri:i,preferredOpenerId:o},kt.None))return!0}return this._defaultExternalOpener.openExternal(r,{sourceUri:i},kt.None)}dispose(){this._validators.clear()}};S8=OK([EA(0,ni),EA(1,Hi)],S8);const ca=Ht("editorWorkerService");var In;(function(s){s[s.Hint=1]="Hint",s[s.Info=2]="Info",s[s.Warning=4]="Warning",s[s.Error=8]="Error"})(In||(In={}));(function(s){function e(o,a){return a-o}s.compare=e;const t=Object.create(null);t[s.Error]=b("sev.error","Error"),t[s.Warning]=b("sev.warning","Warning"),t[s.Info]=b("sev.info","Info");function i(o){return t[o]||""}s.toString=i;function n(o){switch(o){case Hn.Error:return s.Error;case Hn.Warning:return s.Warning;case Hn.Info:return s.Info;case Hn.Ignore:return s.Hint}}s.fromSeverity=n;function r(o){switch(o){case s.Error:return Hn.Error;case s.Warning:return Hn.Warning;case s.Info:return Hn.Info;case s.Hint:return Hn.Ignore}}s.toSeverity=r})(In||(In={}));var DA;(function(s){const e="";function t(n){return i(n,!0)}s.makeKey=t;function i(n,r){const o=[e];return n.source?o.push(n.source.replace("¦","\\¦")):o.push(e),n.code?typeof n.code=="string"?o.push(n.code.replace("¦","\\¦")):o.push(n.code.value.replace("¦","\\¦")):o.push(e),n.severity!==void 0&&n.severity!==null?o.push(In.toString(n.severity)):o.push(e),n.message&&r?o.push(n.message.replace("¦","\\¦")):o.push(e),n.startLineNumber!==void 0&&n.startLineNumber!==null?o.push(n.startLineNumber.toString()):o.push(e),n.startColumn!==void 0&&n.startColumn!==null?o.push(n.startColumn.toString()):o.push(e),n.endLineNumber!==void 0&&n.endLineNumber!==null?o.push(n.endLineNumber.toString()):o.push(e),n.endColumn!==void 0&&n.endColumn!==null?o.push(n.endColumn.toString()):o.push(e),o.push(e),o.join("¦")}s.makeKeyOptionalMessage=i})(DA||(DA={}));const Gh=Ht("markerService"),fge=j("editor.lineHighlightBackground",null,b("lineHighlight","Background color for the highlight of line at the cursor position.")),mne=j("editor.lineHighlightBorder",{dark:"#282828",light:"#eeeeee",hcDark:"#f38518",hcLight:Xt},b("lineHighlightBorderBox","Background color for the border around the line at the cursor position."));j("editor.rangeHighlightBackground",{dark:"#ffffff0b",light:"#fdff0033",hcDark:null,hcLight:null},b("rangeHighlight","Background color of highlighted ranges, like by quick open and find features. The color must not be opaque so as not to hide underlying decorations."),!0);j("editor.rangeHighlightBorder",{dark:null,light:null,hcDark:tn,hcLight:tn},b("rangeHighlightBorder","Background color of the border around highlighted ranges."));j("editor.symbolHighlightBackground",{dark:Gf,light:Gf,hcDark:null,hcLight:null},b("symbolHighlight","Background color of highlighted symbol, like for go to definition or go next/previous symbol. The color must not be opaque so as not to hide underlying decorations."),!0);j("editor.symbolHighlightBorder",{dark:null,light:null,hcDark:tn,hcLight:tn},b("symbolHighlightBorder","Background color of the border around highlighted symbols."));const UF=j("editorCursor.foreground",{dark:"#AEAFAD",light:fe.black,hcDark:fe.white,hcLight:"#0F4A85"},b("caret","Color of the editor cursor.")),FK=j("editorCursor.background",null,b("editorCursorBackground","The background color of the editor cursor. Allows customizing the color of a character overlapped by a block cursor.")),gge=j("editorMultiCursor.primary.foreground",UF,b("editorMultiCursorPrimaryForeground","Color of the primary editor cursor when multiple cursors are present.")),uVe=j("editorMultiCursor.primary.background",FK,b("editorMultiCursorPrimaryBackground","The background color of the primary editor cursor when multiple cursors are present. Allows customizing the color of a character overlapped by a block cursor.")),pge=j("editorMultiCursor.secondary.foreground",UF,b("editorMultiCursorSecondaryForeground","Color of secondary editor cursors when multiple cursors are present.")),hVe=j("editorMultiCursor.secondary.background",FK,b("editorMultiCursorSecondaryBackground","The background color of secondary editor cursors when multiple cursors are present. Allows customizing the color of a character overlapped by a block cursor.")),VK=j("editorWhitespace.foreground",{dark:"#e3e4e229",light:"#33333333",hcDark:"#e3e4e229",hcLight:"#CCCCCC"},b("editorWhitespaces","Color of whitespace characters in the editor.")),fVe=j("editorLineNumber.foreground",{dark:"#858585",light:"#237893",hcDark:fe.white,hcLight:"#292929"},b("editorLineNumbers","Color of editor line numbers.")),gVe=j("editorIndentGuide.background",VK,b("editorIndentGuides","Color of the editor indentation guides."),!1,b("deprecatedEditorIndentGuides","'editorIndentGuide.background' is deprecated. Use 'editorIndentGuide.background1' instead.")),pVe=j("editorIndentGuide.activeBackground",VK,b("editorActiveIndentGuide","Color of the active editor indentation guides."),!1,b("deprecatedEditorActiveIndentGuide","'editorIndentGuide.activeBackground' is deprecated. Use 'editorIndentGuide.activeBackground1' instead.")),oD=j("editorIndentGuide.background1",gVe,b("editorIndentGuides1","Color of the editor indentation guides (1).")),mVe=j("editorIndentGuide.background2","#00000000",b("editorIndentGuides2","Color of the editor indentation guides (2).")),_Ve=j("editorIndentGuide.background3","#00000000",b("editorIndentGuides3","Color of the editor indentation guides (3).")),bVe=j("editorIndentGuide.background4","#00000000",b("editorIndentGuides4","Color of the editor indentation guides (4).")),vVe=j("editorIndentGuide.background5","#00000000",b("editorIndentGuides5","Color of the editor indentation guides (5).")),wVe=j("editorIndentGuide.background6","#00000000",b("editorIndentGuides6","Color of the editor indentation guides (6).")),aD=j("editorIndentGuide.activeBackground1",pVe,b("editorActiveIndentGuide1","Color of the active editor indentation guides (1).")),CVe=j("editorIndentGuide.activeBackground2","#00000000",b("editorActiveIndentGuide2","Color of the active editor indentation guides (2).")),yVe=j("editorIndentGuide.activeBackground3","#00000000",b("editorActiveIndentGuide3","Color of the active editor indentation guides (3).")),SVe=j("editorIndentGuide.activeBackground4","#00000000",b("editorActiveIndentGuide4","Color of the active editor indentation guides (4).")),xVe=j("editorIndentGuide.activeBackground5","#00000000",b("editorActiveIndentGuide5","Color of the active editor indentation guides (5).")),LVe=j("editorIndentGuide.activeBackground6","#00000000",b("editorActiveIndentGuide6","Color of the active editor indentation guides (6).")),kVe=j("editorActiveLineNumber.foreground",{dark:"#c6c6c6",light:"#0B216F",hcDark:tn,hcLight:tn},b("editorActiveLineNumber","Color of editor active line number"),!1,b("deprecatedEditorActiveLineNumber","Id is deprecated. Use 'editorLineNumber.activeForeground' instead."));j("editorLineNumber.activeForeground",kVe,b("editorActiveLineNumber","Color of editor active line number"));const IVe=j("editorLineNumber.dimmedForeground",null,b("editorDimmedLineNumber","Color of the final editor line when editor.renderFinalNewline is set to dimmed."));j("editorRuler.foreground",{dark:"#5A5A5A",light:fe.lightgrey,hcDark:fe.white,hcLight:"#292929"},b("editorRuler","Color of the editor rulers."));j("editorCodeLens.foreground",{dark:"#999999",light:"#919191",hcDark:"#999999",hcLight:"#292929"},b("editorCodeLensForeground","Foreground color of editor CodeLens"));j("editorBracketMatch.background",{dark:"#0064001a",light:"#0064001a",hcDark:"#0064001a",hcLight:"#0000"},b("editorBracketMatchBackground","Background color behind matching brackets"));j("editorBracketMatch.border",{dark:"#888",light:"#B9B9B9",hcDark:Xt,hcLight:Xt},b("editorBracketMatchBorder","Color for matching brackets boxes"));const EVe=j("editorOverviewRuler.border",{dark:"#7f7f7f4d",light:"#7f7f7f4d",hcDark:"#7f7f7f4d",hcLight:"#666666"},b("editorOverviewRulerBorder","Color of the overview ruler border.")),DVe=j("editorOverviewRuler.background",null,b("editorOverviewRulerBackground","Background color of the editor overview ruler."));j("editorGutter.background",dd,b("editorGutter","Background color of the editor gutter. The gutter contains the glyph margins and the line numbers."));j("editorUnnecessaryCode.border",{dark:null,light:null,hcDark:fe.fromHex("#fff").transparent(.8),hcLight:Xt},b("unnecessaryCodeBorder","Border color of unnecessary (unused) source code in the editor."));const TVe=j("editorUnnecessaryCode.opacity",{dark:fe.fromHex("#000a"),light:fe.fromHex("#0007"),hcDark:null,hcLight:null},b("unnecessaryCodeOpacity",`Opacity of unnecessary (unused) source code in the editor. For example, "#000000c0" will render the code with 75% opacity. For high contrast themes, use the  'editorUnnecessaryCode.border' theme color to underline unnecessary code instead of fading it out.`));j("editorGhostText.border",{dark:null,light:null,hcDark:fe.fromHex("#fff").transparent(.8),hcLight:fe.fromHex("#292929").transparent(.8)},b("editorGhostTextBorder","Border color of ghost text in the editor."));const NVe=j("editorGhostText.foreground",{dark:fe.fromHex("#ffffff56"),light:fe.fromHex("#0007"),hcDark:null,hcLight:null},b("editorGhostTextForeground","Foreground color of the ghost text in the editor."));j("editorGhostText.background",null,b("editorGhostTextBackground","Background color of the ghost text in the editor."));const RVe=new fe(new Jt(0,122,204,.6)),mge=j("editorOverviewRuler.rangeHighlightForeground",RVe,b("overviewRulerRangeHighlight","Overview ruler marker color for range highlights. The color must not be opaque so as not to hide underlying decorations."),!0),AVe=j("editorOverviewRuler.errorForeground",{dark:new fe(new Jt(255,18,18,.7)),light:new fe(new Jt(255,18,18,.7)),hcDark:new fe(new Jt(255,50,50,1)),hcLight:"#B5200D"},b("overviewRuleError","Overview ruler marker color for errors.")),PVe=j("editorOverviewRuler.warningForeground",{dark:Lg,light:Lg,hcDark:hI,hcLight:hI},b("overviewRuleWarning","Overview ruler marker color for warnings.")),MVe=j("editorOverviewRuler.infoForeground",{dark:Ph,light:Ph,hcDark:fI,hcLight:fI},b("overviewRuleInfo","Overview ruler marker color for infos.")),_ge=j("editorBracketHighlight.foreground1",{dark:"#FFD700",light:"#0431FAFF",hcDark:"#FFD700",hcLight:"#0431FAFF"},b("editorBracketHighlightForeground1","Foreground color of brackets (1). Requires enabling bracket pair colorization.")),bge=j("editorBracketHighlight.foreground2",{dark:"#DA70D6",light:"#319331FF",hcDark:"#DA70D6",hcLight:"#319331FF"},b("editorBracketHighlightForeground2","Foreground color of brackets (2). Requires enabling bracket pair colorization.")),vge=j("editorBracketHighlight.foreground3",{dark:"#179FFF",light:"#7B3814FF",hcDark:"#87CEFA",hcLight:"#7B3814FF"},b("editorBracketHighlightForeground3","Foreground color of brackets (3). Requires enabling bracket pair colorization.")),wge=j("editorBracketHighlight.foreground4","#00000000",b("editorBracketHighlightForeground4","Foreground color of brackets (4). Requires enabling bracket pair colorization.")),Cge=j("editorBracketHighlight.foreground5","#00000000",b("editorBracketHighlightForeground5","Foreground color of brackets (5). Requires enabling bracket pair colorization.")),yge=j("editorBracketHighlight.foreground6","#00000000",b("editorBracketHighlightForeground6","Foreground color of brackets (6). Requires enabling bracket pair colorization.")),OVe=j("editorBracketHighlight.unexpectedBracket.foreground",{dark:new fe(new Jt(255,18,18,.8)),light:new fe(new Jt(255,18,18,.8)),hcDark:"new Color(new RGBA(255, 50, 50, 1))",hcLight:"#B5200D"},b("editorBracketHighlightUnexpectedBracketForeground","Foreground color of unexpected brackets.")),FVe=j("editorBracketPairGuide.background1","#00000000",b("editorBracketPairGuide.background1","Background color of inactive bracket pair guides (1). Requires enabling bracket pair guides.")),VVe=j("editorBracketPairGuide.background2","#00000000",b("editorBracketPairGuide.background2","Background color of inactive bracket pair guides (2). Requires enabling bracket pair guides.")),BVe=j("editorBracketPairGuide.background3","#00000000",b("editorBracketPairGuide.background3","Background color of inactive bracket pair guides (3). Requires enabling bracket pair guides.")),WVe=j("editorBracketPairGuide.background4","#00000000",b("editorBracketPairGuide.background4","Background color of inactive bracket pair guides (4). Requires enabling bracket pair guides.")),HVe=j("editorBracketPairGuide.background5","#00000000",b("editorBracketPairGuide.background5","Background color of inactive bracket pair guides (5). Requires enabling bracket pair guides.")),zVe=j("editorBracketPairGuide.background6","#00000000",b("editorBracketPairGuide.background6","Background color of inactive bracket pair guides (6). Requires enabling bracket pair guides.")),UVe=j("editorBracketPairGuide.activeBackground1","#00000000",b("editorBracketPairGuide.activeBackground1","Background color of active bracket pair guides (1). Requires enabling bracket pair guides.")),jVe=j("editorBracketPairGuide.activeBackground2","#00000000",b("editorBracketPairGuide.activeBackground2","Background color of active bracket pair guides (2). Requires enabling bracket pair guides.")),$Ve=j("editorBracketPairGuide.activeBackground3","#00000000",b("editorBracketPairGuide.activeBackground3","Background color of active bracket pair guides (3). Requires enabling bracket pair guides.")),qVe=j("editorBracketPairGuide.activeBackground4","#00000000",b("editorBracketPairGuide.activeBackground4","Background color of active bracket pair guides (4). Requires enabling bracket pair guides.")),KVe=j("editorBracketPairGuide.activeBackground5","#00000000",b("editorBracketPairGuide.activeBackground5","Background color of active bracket pair guides (5). Requires enabling bracket pair guides.")),GVe=j("editorBracketPairGuide.activeBackground6","#00000000",b("editorBracketPairGuide.activeBackground6","Background color of active bracket pair guides (6). Requires enabling bracket pair guides."));j("editorUnicodeHighlight.border",Lg,b("editorUnicodeHighlight.border","Border color used to highlight unicode characters."));j("editorUnicodeHighlight.background",qOe,b("editorUnicodeHighlight.background","Background color used to highlight unicode characters."));Lc((s,e)=>{const t=s.getColor(dd),i=s.getColor(fge),n=i&&!i.isTransparent()?i:t;n&&e.addRule(`.monaco-editor .inputarea.ime-input { background-color: ${n}; }`)});function QVe(s,e){const t=[],i=[];for(const n of s)e.has(n)||t.push(n);for(const n of e)s.has(n)||i.push(n);return{removed:t,added:i}}function YVe(s,e){const t=new Set;for(const i of e)s.has(i)&&t.add(i);return t}var XVe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},_ne=function(s,e){return function(t,i){e(t,i,s)}};let x8=class extends te{constructor(e,t){super(),this._markerService=t,this._onDidChangeMarker=this._register(new Z),this._markerDecorations=new Fs,e.getModels().forEach(i=>this._onModelAdded(i)),this._register(e.onModelAdded(this._onModelAdded,this)),this._register(e.onModelRemoved(this._onModelRemoved,this)),this._register(this._markerService.onMarkerChanged(this._handleMarkerChange,this))}dispose(){super.dispose(),this._markerDecorations.forEach(e=>e.dispose()),this._markerDecorations.clear()}getMarker(e,t){const i=this._markerDecorations.get(e);return i&&i.getMarker(t)||null}_handleMarkerChange(e){e.forEach(t=>{const i=this._markerDecorations.get(t);i&&this._updateDecorations(i)})}_onModelAdded(e){const t=new ZVe(e);this._markerDecorations.set(e.uri,t),this._updateDecorations(t)}_onModelRemoved(e){var i;const t=this._markerDecorations.get(e.uri);t&&(t.dispose(),this._markerDecorations.delete(e.uri)),(e.uri.scheme===gt.inMemory||e.uri.scheme===gt.internal||e.uri.scheme===gt.vscode)&&((i=this._markerService)==null||i.read({resource:e.uri}).map(n=>n.owner).forEach(n=>this._markerService.remove(n,[e.uri])))}_updateDecorations(e){const t=this._markerService.read({resource:e.model.uri,take:500});e.update(t)&&this._onDidChangeMarker.fire(e.model)}};x8=XVe([_ne(0,Gi),_ne(1,Gh)],x8);class ZVe extends te{constructor(e){super(),this.model=e,this._map=new JPe,this._register(Ye(()=>{this.model.deltaDecorations([...this._map.values()],[]),this._map.clear()}))}update(e){const{added:t,removed:i}=QVe(new Set(this._map.keys()),new Set(e));if(t.length===0&&i.length===0)return!1;const n=i.map(a=>this._map.get(a)),r=t.map(a=>({range:this._createDecorationRange(this.model,a),options:this._createDecorationOption(a)})),o=this.model.deltaDecorations(n,r);for(const a of i)this._map.delete(a);for(let a=0;a<o.length;a++)this._map.set(t[a],o[a]);return!0}getMarker(e){return this._map.getKey(e.id)}_createDecorationRange(e,t){let i=F.lift(t);if(t.severity===In.Hint&&!this._hasMarkerTag(t,1)&&!this._hasMarkerTag(t,2)&&(i=i.setEndPosition(i.startLineNumber,i.startColumn+2)),i=e.validateRange(i),i.isEmpty()){const n=e.getLineLastNonWhitespaceColumn(i.startLineNumber)||e.getLineMaxColumn(i.startLineNumber);if(n===1||i.endColumn>=n)return i;const r=e.getWordAtPosition(i.getStartPosition());r&&(i=new F(i.startLineNumber,r.startColumn,i.endLineNumber,r.endColumn))}else if(t.endColumn===Number.MAX_VALUE&&t.startColumn===1&&i.startLineNumber===i.endLineNumber){const n=e.getLineFirstNonWhitespaceColumn(t.startLineNumber);n<i.endColumn&&(i=new F(i.startLineNumber,n,i.endLineNumber,i.endColumn),t.startColumn=n)}return i}_createDecorationOption(e){let t,i,n,r,o;switch(e.severity){case In.Hint:this._hasMarkerTag(e,2)?t=void 0:this._hasMarkerTag(e,1)?t="squiggly-unnecessary":t="squiggly-hint",n=0;break;case In.Info:t="squiggly-info",i=kn(MVe),n=10,o={color:kn(g4e),position:1};break;case In.Warning:t="squiggly-warning",i=kn(PVe),n=20,o={color:kn(p4e),position:1};break;case In.Error:default:t="squiggly-error",i=kn(AVe),n=30,o={color:kn(m4e),position:1};break}return e.tags&&(e.tags.indexOf(1)!==-1&&(r="squiggly-inline-unnecessary"),e.tags.indexOf(2)!==-1&&(r="squiggly-inline-deprecated")),{description:"marker-decoration",stickiness:1,className:t,showIfCollapsed:!0,overviewRuler:{color:i,position:Il.Right},minimap:o,zIndex:n,inlineClassName:r}}_hasMarkerTag(e,t){return e.tags?e.tags.indexOf(t)>=0:!1}}const BK=Ht("markerDecorationsService");class hs{static _nextVisibleColumn(e,t,i){return e===9?hs.nextRenderTabStop(t,i):Um(e)||Aq(e)?t+2:t+1}static visibleColumnFromColumn(e,t,i){const n=Math.min(t-1,e.length),r=e.substring(0,n),o=new H2(r);let a=0;for(;!o.eol();){const l=W2(r,n,o.offset);o.nextGraphemeLength(),a=this._nextVisibleColumn(l,a,i)}return a}static columnFromVisibleColumn(e,t,i){if(t<=0)return 1;const n=e.length,r=new H2(e);let o=0,a=1;for(;!r.eol();){const l=W2(e,n,r.offset);r.nextGraphemeLength();const c=this._nextVisibleColumn(l,o,i),d=r.offset+1;if(c>=t){const u=t-o;return c-t<u?d:a}o=c,a=d}return n+1}static nextRenderTabStop(e,t){return e+t-e%t}static nextIndentTabStop(e,t){return e+t-e%t}static prevRenderTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}static prevIndentTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}}function JVe(s,e,t){let i=0;for(let r=0;r<s.length;r++)s.charAt(r)==="	"?i=hs.nextIndentTabStop(i,e):i++;let n="";if(!t){const r=Math.floor(i/e);i=i%e;for(let o=0;o<r;o++)n+="	"}for(let r=0;r<i;r++)n+=" ";return n}function WK(s,e,t){let i=Zr(s);return i===-1&&(i=s.length),JVe(s.substring(0,i),e,t)+s.substring(i)}class bne{constructor(e,t,i,n){this.range=e,this.nestingLevel=t,this.nestingLevelOfEqualBracketType=i,this.isInvalid=n}}class eBe{constructor(e,t,i,n,r,o){this.range=e,this.openingBracketRange=t,this.closingBracketRange=i,this.nestingLevel=n,this.nestingLevelOfEqualBracketType=r,this.bracketPairNode=o}get openingBracketInfo(){return this.bracketPairNode.openingBracket.bracketInfo}}class tBe extends eBe{constructor(e,t,i,n,r,o,a){super(e,t,i,n,r,o),this.minVisibleColumnIndentation=a}}function iBe(s,e,t,i){return s!==t?Qn(t-s,i):Qn(0,i-e)}const bo=0;function TA(s){return s===0}const Sl=2**26;function Qn(s,e){return s*Sl+e}function gc(s){const e=s,t=Math.floor(e/Sl),i=e-t*Sl;return new cd(t,i)}function nBe(s){return Math.floor(s/Sl)}function En(s,e){let t=s+e;return e>=Sl&&(t=t-s%Sl),t}function sBe(s,e){return s.reduce((t,i)=>En(t,e(i)),bo)}function Sge(s,e){return s===e}function II(s,e){const t=s,i=e;if(i-t<=0)return bo;const r=Math.floor(t/Sl),o=Math.floor(i/Sl),a=i-o*Sl;if(r===o){const l=t-r*Sl;return Qn(0,a-l)}else return Qn(o-r,a)}function xy(s,e){return s<e}function Ly(s,e){return s<=e}function rL(s,e){return s>=e}function RC(s){return Qn(s.lineNumber-1,s.column-1)}function Zb(s,e){const t=s,i=Math.floor(t/Sl),n=t-i*Sl,r=e,o=Math.floor(r/Sl),a=r-o*Sl;return new F(i+1,n+1,o+1,a+1)}function rBe(s){const e=Uh(s);return Qn(e.length-1,e[e.length-1].length)}class Qf{static fromModelContentChanges(e){return e.map(i=>{const n=F.lift(i.range);return new Qf(RC(n.getStartPosition()),RC(n.getEndPosition()),rBe(i.text))}).reverse()}constructor(e,t,i){this.startOffset=e,this.endOffset=t,this.newLength=i}toString(){return`[${gc(this.startOffset)}...${gc(this.endOffset)}) -> ${gc(this.newLength)}`}}class oBe{constructor(e){this.nextEditIdx=0,this.deltaOldToNewLineCount=0,this.deltaOldToNewColumnCount=0,this.deltaLineIdxInOld=-1,this.edits=e.map(t=>HK.from(t))}getOffsetBeforeChange(e){return this.adjustNextEdit(e),this.translateCurToOld(e)}getDistanceToNextChange(e){this.adjustNextEdit(e);const t=this.edits[this.nextEditIdx],i=t?this.translateOldToCur(t.offsetObj):null;return i===null?null:II(e,i)}translateOldToCur(e){return e.lineCount===this.deltaLineIdxInOld?Qn(e.lineCount+this.deltaOldToNewLineCount,e.columnCount+this.deltaOldToNewColumnCount):Qn(e.lineCount+this.deltaOldToNewLineCount,e.columnCount)}translateCurToOld(e){const t=gc(e);return t.lineCount-this.deltaOldToNewLineCount===this.deltaLineIdxInOld?Qn(t.lineCount-this.deltaOldToNewLineCount,t.columnCount-this.deltaOldToNewColumnCount):Qn(t.lineCount-this.deltaOldToNewLineCount,t.columnCount)}adjustNextEdit(e){for(;this.nextEditIdx<this.edits.length;){const t=this.edits[this.nextEditIdx],i=this.translateOldToCur(t.endOffsetAfterObj);if(Ly(i,e)){this.nextEditIdx++;const n=gc(i),r=gc(this.translateOldToCur(t.endOffsetBeforeObj)),o=n.lineCount-r.lineCount;this.deltaOldToNewLineCount+=o;const a=this.deltaLineIdxInOld===t.endOffsetBeforeObj.lineCount?this.deltaOldToNewColumnCount:0,l=n.columnCount-r.columnCount;this.deltaOldToNewColumnCount=a+l,this.deltaLineIdxInOld=t.endOffsetBeforeObj.lineCount}else break}}}class HK{static from(e){return new HK(e.startOffset,e.endOffset,e.newLength)}constructor(e,t,i){this.endOffsetBeforeObj=gc(t),this.endOffsetAfterObj=gc(En(e,i)),this.offsetObj=gc(e)}}const bN=[],Jl=class Jl{static create(e,t){if(e<=128&&t.length===0){let i=Jl.cache[e];return i||(i=new Jl(e,t),Jl.cache[e]=i),i}return new Jl(e,t)}static getEmpty(){return this.empty}constructor(e,t){this.items=e,this.additionalItems=t}add(e,t){const i=t.getKey(e);let n=i>>5;if(n===0){const o=1<<i|this.items;return o===this.items?this:Jl.create(o,this.additionalItems)}n--;const r=this.additionalItems.slice(0);for(;r.length<n;)r.push(0);return r[n]|=1<<(i&31),Jl.create(this.items,r)}merge(e){const t=this.items|e.items;if(this.additionalItems===bN&&e.additionalItems===bN)return t===this.items?this:t===e.items?e:Jl.create(t,bN);const i=[];for(let n=0;n<Math.max(this.additionalItems.length,e.additionalItems.length);n++){const r=this.additionalItems[n]||0,o=e.additionalItems[n]||0;i.push(r|o)}return Jl.create(t,i)}intersects(e){if((this.items&e.items)!==0)return!0;for(let t=0;t<Math.min(this.additionalItems.length,e.additionalItems.length);t++)if((this.additionalItems[t]&e.additionalItems[t])!==0)return!0;return!1}};Jl.cache=new Array(129),Jl.empty=Jl.create(0,bN);let Ia=Jl;const vne={getKey(s){return s}};class xge{constructor(){this.items=new Map}getKey(e){let t=this.items.get(e);return t===void 0&&(t=this.items.size,this.items.set(e,t)),t}}class zK{get length(){return this._length}constructor(e){this._length=e}}class EI extends zK{static create(e,t,i){let n=e.length;return t&&(n=En(n,t.length)),i&&(n=En(n,i.length)),new EI(n,e,t,i,t?t.missingOpeningBracketIds:Ia.getEmpty())}get kind(){return 2}get listHeight(){return 0}get childrenLength(){return 3}getChild(e){switch(e){case 0:return this.openingBracket;case 1:return this.child;case 2:return this.closingBracket}throw new Error("Invalid child index")}get children(){const e=[];return e.push(this.openingBracket),this.child&&e.push(this.child),this.closingBracket&&e.push(this.closingBracket),e}constructor(e,t,i,n,r){super(e),this.openingBracket=t,this.child=i,this.closingBracket=n,this.missingOpeningBracketIds=r}canBeReused(e){return!(this.closingBracket===null||e.intersects(this.missingOpeningBracketIds))}deepClone(){return new EI(this.length,this.openingBracket.deepClone(),this.child&&this.child.deepClone(),this.closingBracket&&this.closingBracket.deepClone(),this.missingOpeningBracketIds)}computeMinIndentation(e,t){return this.child?this.child.computeMinIndentation(En(e,this.openingBracket.length),t):Number.MAX_SAFE_INTEGER}}class Oh extends zK{static create23(e,t,i,n=!1){let r=e.length,o=e.missingOpeningBracketIds;if(e.listHeight!==t.listHeight)throw new Error("Invalid list heights");if(r=En(r,t.length),o=o.merge(t.missingOpeningBracketIds),i){if(e.listHeight!==i.listHeight)throw new Error("Invalid list heights");r=En(r,i.length),o=o.merge(i.missingOpeningBracketIds)}return n?new aBe(r,e.listHeight+1,e,t,i,o):new DI(r,e.listHeight+1,e,t,i,o)}static getEmpty(){return new lBe(bo,0,[],Ia.getEmpty())}get kind(){return 4}get missingOpeningBracketIds(){return this._missingOpeningBracketIds}constructor(e,t,i){super(e),this.listHeight=t,this._missingOpeningBracketIds=i,this.cachedMinIndentation=-1}throwIfImmutable(){}makeLastElementMutable(){this.throwIfImmutable();const e=this.childrenLength;if(e===0)return;const t=this.getChild(e-1),i=t.kind===4?t.toMutable():t;return t!==i&&this.setChild(e-1,i),i}makeFirstElementMutable(){if(this.throwIfImmutable(),this.childrenLength===0)return;const t=this.getChild(0),i=t.kind===4?t.toMutable():t;return t!==i&&this.setChild(0,i),i}canBeReused(e){if(e.intersects(this.missingOpeningBracketIds)||this.childrenLength===0)return!1;let t=this;for(;t.kind===4;){const i=t.childrenLength;if(i===0)throw new di;t=t.getChild(i-1)}return t.canBeReused(e)}handleChildrenChanged(){this.throwIfImmutable();const e=this.childrenLength;let t=this.getChild(0).length,i=this.getChild(0).missingOpeningBracketIds;for(let n=1;n<e;n++){const r=this.getChild(n);t=En(t,r.length),i=i.merge(r.missingOpeningBracketIds)}this._length=t,this._missingOpeningBracketIds=i,this.cachedMinIndentation=-1}computeMinIndentation(e,t){if(this.cachedMinIndentation!==-1)return this.cachedMinIndentation;let i=Number.MAX_SAFE_INTEGER,n=e;for(let r=0;r<this.childrenLength;r++){const o=this.getChild(r);o&&(i=Math.min(i,o.computeMinIndentation(n,t)),n=En(n,o.length))}return this.cachedMinIndentation=i,i}}class DI extends Oh{get childrenLength(){return this._item3!==null?3:2}getChild(e){switch(e){case 0:return this._item1;case 1:return this._item2;case 2:return this._item3}throw new Error("Invalid child index")}setChild(e,t){switch(e){case 0:this._item1=t;return;case 1:this._item2=t;return;case 2:this._item3=t;return}throw new Error("Invalid child index")}get children(){return this._item3?[this._item1,this._item2,this._item3]:[this._item1,this._item2]}get item1(){return this._item1}get item2(){return this._item2}get item3(){return this._item3}constructor(e,t,i,n,r,o){super(e,t,o),this._item1=i,this._item2=n,this._item3=r}deepClone(){return new DI(this.length,this.listHeight,this._item1.deepClone(),this._item2.deepClone(),this._item3?this._item3.deepClone():null,this.missingOpeningBracketIds)}appendChildOfSameHeight(e){if(this._item3)throw new Error("Cannot append to a full (2,3) tree node");this.throwIfImmutable(),this._item3=e,this.handleChildrenChanged()}unappendChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();const e=this._item3;return this._item3=null,this.handleChildrenChanged(),e}prependChildOfSameHeight(e){if(this._item3)throw new Error("Cannot prepend to a full (2,3) tree node");this.throwIfImmutable(),this._item3=this._item2,this._item2=this._item1,this._item1=e,this.handleChildrenChanged()}unprependChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();const e=this._item1;return this._item1=this._item2,this._item2=this._item3,this._item3=null,this.handleChildrenChanged(),e}toMutable(){return this}}class aBe extends DI{toMutable(){return new DI(this.length,this.listHeight,this.item1,this.item2,this.item3,this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}}class NA extends Oh{get childrenLength(){return this._children.length}getChild(e){return this._children[e]}setChild(e,t){this._children[e]=t}get children(){return this._children}constructor(e,t,i,n){super(e,t,n),this._children=i}deepClone(){const e=new Array(this._children.length);for(let t=0;t<this._children.length;t++)e[t]=this._children[t].deepClone();return new NA(this.length,this.listHeight,e,this.missingOpeningBracketIds)}appendChildOfSameHeight(e){this.throwIfImmutable(),this._children.push(e),this.handleChildrenChanged()}unappendChild(){this.throwIfImmutable();const e=this._children.pop();return this.handleChildrenChanged(),e}prependChildOfSameHeight(e){this.throwIfImmutable(),this._children.unshift(e),this.handleChildrenChanged()}unprependChild(){this.throwIfImmutable();const e=this._children.shift();return this.handleChildrenChanged(),e}toMutable(){return this}}class lBe extends NA{toMutable(){return new NA(this.length,this.listHeight,[...this.children],this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}}const cBe=[];class UK extends zK{get listHeight(){return 0}get childrenLength(){return 0}getChild(e){return null}get children(){return cBe}deepClone(){return this}}class Cb extends UK{get kind(){return 0}get missingOpeningBracketIds(){return Ia.getEmpty()}canBeReused(e){return!0}computeMinIndentation(e,t){const i=gc(e),n=(i.columnCount===0?i.lineCount:i.lineCount+1)+1,r=nBe(En(e,this.length))+1;let o=Number.MAX_SAFE_INTEGER;for(let a=n;a<=r;a++){const l=t.getLineFirstNonWhitespaceColumn(a),c=t.getLineContent(a);if(l===0)continue;const d=hs.visibleColumnFromColumn(c,l,t.getOptions().tabSize);o=Math.min(o,d)}return o}}class RA extends UK{static create(e,t,i){return new RA(e,t,i)}get kind(){return 1}get missingOpeningBracketIds(){return Ia.getEmpty()}constructor(e,t,i){super(e),this.bracketInfo=t,this.bracketIds=i}get text(){return this.bracketInfo.bracketText}get languageId(){return this.bracketInfo.languageId}canBeReused(e){return!1}computeMinIndentation(e,t){return Number.MAX_SAFE_INTEGER}}class dBe extends UK{get kind(){return 3}constructor(e,t){super(t),this.missingOpeningBracketIds=e}canBeReused(e){return!e.intersects(this.missingOpeningBracketIds)}computeMinIndentation(e,t){return Number.MAX_SAFE_INTEGER}}let Ap=class{constructor(e,t,i,n,r){this.length=e,this.kind=t,this.bracketId=i,this.bracketIds=n,this.astNode=r}};class Lge{constructor(e,t){this.textModel=e,this.bracketTokens=t,this.reader=new uBe(this.textModel,this.bracketTokens),this._offset=bo,this.didPeek=!1,this.peeked=null,this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}get offset(){return this._offset}get length(){return Qn(this.textBufferLineCount-1,this.textBufferLastLineLength)}skip(e){this.didPeek=!1,this._offset=En(this._offset,e);const t=gc(this._offset);this.reader.setPosition(t.lineCount,t.columnCount)}read(){let e;return this.peeked?(this.didPeek=!1,e=this.peeked):e=this.reader.read(),e&&(this._offset=En(this._offset,e.length)),e}peek(){return this.didPeek||(this.peeked=this.reader.read(),this.didPeek=!0),this.peeked}}class uBe{constructor(e,t){this.textModel=e,this.bracketTokens=t,this.lineIdx=0,this.line=null,this.lineCharOffset=0,this.lineTokens=null,this.lineTokenOffset=0,this.peekedToken=null,this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}setPosition(e,t){e===this.lineIdx?(this.lineCharOffset=t,this.line!==null&&(this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset))):(this.lineIdx=e,this.lineCharOffset=t,this.line=null),this.peekedToken=null}read(){if(this.peekedToken){const r=this.peekedToken;return this.peekedToken=null,this.lineCharOffset+=r.length,r}if(this.lineIdx>this.textBufferLineCount-1||this.lineIdx===this.textBufferLineCount-1&&this.lineCharOffset>=this.textBufferLastLineLength)return null;this.line===null&&(this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.line=this.lineTokens.getLineContent(),this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset));const e=this.lineIdx,t=this.lineCharOffset;let i=0;for(;;){const r=this.lineTokens,o=r.getCount();let a=null;if(this.lineTokenOffset<o){const l=r.getMetadata(this.lineTokenOffset);for(;this.lineTokenOffset+1<o&&l===r.getMetadata(this.lineTokenOffset+1);)this.lineTokenOffset++;const c=Go.getTokenType(l)===0,d=Go.containsBalancedBrackets(l),u=r.getEndOffset(this.lineTokenOffset);if(d&&c&&this.lineCharOffset<u){const h=r.getLanguageId(this.lineTokenOffset),g=this.line.substring(this.lineCharOffset,u),p=this.bracketTokens.getSingleLanguageBracketTokens(h),_=p.regExpGlobal;if(_){_.lastIndex=0;const v=_.exec(g);v&&(a=p.getToken(v[0]),a&&(this.lineCharOffset+=v.index))}}if(i+=u-this.lineCharOffset,a)if(e!==this.lineIdx||t!==this.lineCharOffset){this.peekedToken=a;break}else return this.lineCharOffset+=a.length,a;else this.lineTokenOffset++,this.lineCharOffset=u}else if(this.lineIdx===this.textBufferLineCount-1||(this.lineIdx++,this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.lineTokenOffset=0,this.line=this.lineTokens.getLineContent(),this.lineCharOffset=0,i+=33,i>1e3))break;if(i>1500)break}const n=iBe(e,t,this.lineIdx,this.lineCharOffset);return new Ap(n,0,-1,Ia.getEmpty(),new Cb(n))}}class hBe{constructor(e,t){this.text=e,this._offset=bo,this.idx=0;const i=t.getRegExpStr(),n=i?new RegExp(i+`|
`,"gi"):null,r=[];let o,a=0,l=0,c=0,d=0;const u=[];for(let p=0;p<60;p++)u.push(new Ap(Qn(0,p),0,-1,Ia.getEmpty(),new Cb(Qn(0,p))));const h=[];for(let p=0;p<60;p++)h.push(new Ap(Qn(1,p),0,-1,Ia.getEmpty(),new Cb(Qn(1,p))));if(n)for(n.lastIndex=0;(o=n.exec(e))!==null;){const p=o.index,_=o[0];if(_===`
`)a++,l=p+1;else{if(c!==p){let v;if(d===a){const C=p-c;if(C<u.length)v=u[C];else{const y=Qn(0,C);v=new Ap(y,0,-1,Ia.getEmpty(),new Cb(y))}}else{const C=a-d,y=p-l;if(C===1&&y<h.length)v=h[y];else{const x=Qn(C,y);v=new Ap(x,0,-1,Ia.getEmpty(),new Cb(x))}}r.push(v)}r.push(t.getToken(_)),c=p+_.length,d=a}}const g=e.length;if(c!==g){const p=d===a?Qn(0,g-c):Qn(a-d,g-l);r.push(new Ap(p,0,-1,Ia.getEmpty(),new Cb(p)))}this.length=Qn(a,g-l),this.tokens=r}get offset(){return this._offset}read(){return this.tokens[this.idx++]||null}peek(){return this.tokens[this.idx]||null}skip(e){throw new $Ne}}class jK{static createFromLanguage(e,t){function i(r){return t.getKey(`${r.languageId}:::${r.bracketText}`)}const n=new Map;for(const r of e.bracketsNew.openingBrackets){const o=Qn(0,r.bracketText.length),a=i(r),l=Ia.getEmpty().add(a,vne);n.set(r.bracketText,new Ap(o,1,a,l,RA.create(o,r,l)))}for(const r of e.bracketsNew.closingBrackets){const o=Qn(0,r.bracketText.length);let a=Ia.getEmpty();const l=r.getOpeningBrackets();for(const c of l)a=a.add(i(c),vne);n.set(r.bracketText,new Ap(o,2,i(l[0]),a,RA.create(o,r,a)))}return new jK(n)}constructor(e){this.map=e,this.hasRegExp=!1,this._regExpGlobal=null}getRegExpStr(){if(this.isEmpty)return null;{const e=[...this.map.keys()];return e.sort(),e.reverse(),e.map(t=>fBe(t)).join("|")}}get regExpGlobal(){if(!this.hasRegExp){const e=this.getRegExpStr();this._regExpGlobal=e?new RegExp(e,"gi"):null,this.hasRegExp=!0}return this._regExpGlobal}getToken(e){return this.map.get(e.toLowerCase())}findClosingTokenText(e){for(const[t,i]of this.map)if(i.kind===2&&i.bracketIds.intersects(e))return t}get isEmpty(){return this.map.size===0}}function fBe(s){let e=Nl(s);return/^[\w ]+/.test(s)&&(e=`\\b${e}`),/[\w ]+$/.test(s)&&(e=`${e}\\b`),e}class kge{constructor(e,t){this.denseKeyProvider=e,this.getLanguageConfiguration=t,this.languageIdToBracketTokens=new Map}didLanguageChange(e){return this.languageIdToBracketTokens.has(e)}getSingleLanguageBracketTokens(e){let t=this.languageIdToBracketTokens.get(e);return t||(t=jK.createFromLanguage(this.getLanguageConfiguration(e),this.denseKeyProvider),this.languageIdToBracketTokens.set(e,t)),t}}function gBe(s){if(s.length===0)return null;if(s.length===1)return s[0];let e=0;function t(){if(e>=s.length)return null;const o=e,a=s[o].listHeight;for(e++;e<s.length&&s[e].listHeight===a;)e++;return e-o>=2?Ige(o===0&&e===s.length?s:s.slice(o,e),!1):s[o]}let i=t(),n=t();if(!n)return i;for(let o=t();o;o=t())wne(i,n)<=wne(n,o)?(i=VV(i,n),n=o):n=VV(n,o);return VV(i,n)}function Ige(s,e=!1){if(s.length===0)return null;if(s.length===1)return s[0];let t=s.length;for(;t>3;){const i=t>>1;for(let n=0;n<i;n++){const r=n<<1;s[n]=Oh.create23(s[r],s[r+1],r+3===t?s[r+2]:null,e)}t=i}return Oh.create23(s[0],s[1],t>=3?s[2]:null,e)}function wne(s,e){return Math.abs(s.listHeight-e.listHeight)}function VV(s,e){return s.listHeight===e.listHeight?Oh.create23(s,e,null,!1):s.listHeight>e.listHeight?pBe(s,e):mBe(e,s)}function pBe(s,e){s=s.toMutable();let t=s;const i=[];let n;for(;;){if(e.listHeight===t.listHeight){n=e;break}if(t.kind!==4)throw new Error("unexpected");i.push(t),t=t.makeLastElementMutable()}for(let r=i.length-1;r>=0;r--){const o=i[r];n?o.childrenLength>=3?n=Oh.create23(o.unappendChild(),n,null,!1):(o.appendChildOfSameHeight(n),n=void 0):o.handleChildrenChanged()}return n?Oh.create23(s,n,null,!1):s}function mBe(s,e){s=s.toMutable();let t=s;const i=[];for(;e.listHeight!==t.listHeight;){if(t.kind!==4)throw new Error("unexpected");i.push(t),t=t.makeFirstElementMutable()}let n=e;for(let r=i.length-1;r>=0;r--){const o=i[r];n?o.childrenLength>=3?n=Oh.create23(n,o.unprependChild(),null,!1):(o.prependChildOfSameHeight(n),n=void 0):o.handleChildrenChanged()}return n?Oh.create23(n,s,null,!1):s}class _Be{constructor(e){this.lastOffset=bo,this.nextNodes=[e],this.offsets=[bo],this.idxs=[]}readLongestNodeAt(e,t){if(xy(e,this.lastOffset))throw new Error("Invalid offset");for(this.lastOffset=e;;){const i=Ex(this.nextNodes);if(!i)return;const n=Ex(this.offsets);if(xy(e,n))return;if(xy(n,e))if(En(n,i.length)<=e)this.nextNodeAfterCurrent();else{const r=BV(i);r!==-1?(this.nextNodes.push(i.getChild(r)),this.offsets.push(n),this.idxs.push(r)):this.nextNodeAfterCurrent()}else{if(t(i))return this.nextNodeAfterCurrent(),i;{const r=BV(i);if(r===-1){this.nextNodeAfterCurrent();return}else this.nextNodes.push(i.getChild(r)),this.offsets.push(n),this.idxs.push(r)}}}}nextNodeAfterCurrent(){for(;;){const e=Ex(this.offsets),t=Ex(this.nextNodes);if(this.nextNodes.pop(),this.offsets.pop(),this.idxs.length===0)break;const i=Ex(this.nextNodes),n=BV(i,this.idxs[this.idxs.length-1]);if(n!==-1){this.nextNodes.push(i.getChild(n)),this.offsets.push(En(e,t.length)),this.idxs[this.idxs.length-1]=n;break}else this.idxs.pop()}}}function BV(s,e=-1){for(;;){if(e++,e>=s.childrenLength)return-1;if(s.getChild(e))return e}}function Ex(s){return s.length>0?s[s.length-1]:void 0}function L8(s,e,t,i){return new bBe(s,e,t,i).parseDocument()}class bBe{constructor(e,t,i,n){if(this.tokenizer=e,this.createImmutableLists=n,this._itemsConstructed=0,this._itemsFromCache=0,i&&n)throw new Error("Not supported");this.oldNodeReader=i?new _Be(i):void 0,this.positionMapper=new oBe(t)}parseDocument(){this._itemsConstructed=0,this._itemsFromCache=0;let e=this.parseList(Ia.getEmpty(),0);return e||(e=Oh.getEmpty()),e}parseList(e,t){const i=[];for(;;){let r=this.tryReadChildFromCache(e);if(!r){const o=this.tokenizer.peek();if(!o||o.kind===2&&o.bracketIds.intersects(e))break;r=this.parseChild(e,t+1)}r.kind===4&&r.childrenLength===0||i.push(r)}return this.oldNodeReader?gBe(i):Ige(i,this.createImmutableLists)}tryReadChildFromCache(e){if(this.oldNodeReader){const t=this.positionMapper.getDistanceToNextChange(this.tokenizer.offset);if(t===null||!TA(t)){const i=this.oldNodeReader.readLongestNodeAt(this.positionMapper.getOffsetBeforeChange(this.tokenizer.offset),n=>t!==null&&!xy(n.length,t)?!1:n.canBeReused(e));if(i)return this._itemsFromCache++,this.tokenizer.skip(i.length),i}}}parseChild(e,t){this._itemsConstructed++;const i=this.tokenizer.read();switch(i.kind){case 2:return new dBe(i.bracketIds,i.length);case 0:return i.astNode;case 1:{if(t>300)return new Cb(i.length);const n=e.merge(i.bracketIds),r=this.parseList(n,t+1),o=this.tokenizer.peek();return o&&o.kind===2&&(o.bracketId===i.bracketId||o.bracketIds.intersects(i.bracketIds))?(this.tokenizer.read(),EI.create(i.astNode,r,o.astNode)):EI.create(i.astNode,r,null)}default:throw new Error("unexpected")}}}function AA(s,e){if(s.length===0)return e;if(e.length===0)return s;const t=new Cg(Cne(s)),i=Cne(e);i.push({modified:!1,lengthBefore:void 0,lengthAfter:void 0});let n=t.dequeue();function r(c){if(c===void 0){const u=t.takeWhile(h=>!0)||[];return n&&u.unshift(n),u}const d=[];for(;n&&!TA(c);){const[u,h]=n.splitAt(c);d.push(u),c=II(u.lengthAfter,c),n=h??t.dequeue()}return TA(c)||d.push(new Gp(!1,c,c)),d}const o=[];function a(c,d,u){if(o.length>0&&Sge(o[o.length-1].endOffset,c)){const h=o[o.length-1];o[o.length-1]=new Qf(h.startOffset,d,En(h.newLength,u))}else o.push({startOffset:c,endOffset:d,newLength:u})}let l=bo;for(const c of i){const d=r(c.lengthBefore);if(c.modified){const u=sBe(d,g=>g.lengthBefore),h=En(l,u);a(l,h,c.lengthAfter),l=h}else for(const u of d){const h=l;l=En(l,u.lengthBefore),u.modified&&a(h,l,u.lengthAfter)}}return o}class Gp{constructor(e,t,i){this.modified=e,this.lengthBefore=t,this.lengthAfter=i}splitAt(e){const t=II(e,this.lengthAfter);return Sge(t,bo)?[this,void 0]:this.modified?[new Gp(this.modified,this.lengthBefore,e),new Gp(this.modified,bo,t)]:[new Gp(this.modified,e,e),new Gp(this.modified,t,t)]}toString(){return`${this.modified?"M":"U"}:${gc(this.lengthBefore)} -> ${gc(this.lengthAfter)}`}}function Cne(s){const e=[];let t=bo;for(const i of s){const n=II(t,i.startOffset);TA(n)||e.push(new Gp(!1,n,n));const r=II(i.startOffset,i.endOffset);e.push(new Gp(!0,r,i.newLength)),t=i.endOffset}return e}class vBe extends te{didLanguageChange(e){return this.brackets.didLanguageChange(e)}constructor(e,t){if(super(),this.textModel=e,this.getLanguageConfiguration=t,this.didChangeEmitter=new Z,this.denseKeyProvider=new xge,this.brackets=new kge(this.denseKeyProvider,this.getLanguageConfiguration),this.onDidChange=this.didChangeEmitter.event,this.queuedTextEditsForInitialAstWithoutTokens=[],this.queuedTextEdits=[],e.tokenization.hasTokens)e.tokenization.backgroundTokenizationState===2?(this.initialAstWithoutTokens=void 0,this.astWithTokens=this.parseDocumentFromTextBuffer([],void 0,!1)):(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer([],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens);else{const i=this.brackets.getSingleLanguageBracketTokens(this.textModel.getLanguageId()),n=new hBe(this.textModel.getValue(),i);this.initialAstWithoutTokens=L8(n,[],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens}}handleDidChangeBackgroundTokenizationState(){if(this.textModel.tokenization.backgroundTokenizationState===2){const e=this.initialAstWithoutTokens===void 0;this.initialAstWithoutTokens=void 0,e||this.didChangeEmitter.fire()}}handleDidChangeTokens({ranges:e}){const t=e.map(i=>new Qf(Qn(i.fromLineNumber-1,0),Qn(i.toLineNumber,0),Qn(i.toLineNumber-i.fromLineNumber+1,0)));this.handleEdits(t,!0),this.initialAstWithoutTokens||this.didChangeEmitter.fire()}handleContentChanged(e){const t=Qf.fromModelContentChanges(e.changes);this.handleEdits(t,!1)}handleEdits(e,t){const i=AA(this.queuedTextEdits,e);this.queuedTextEdits=i,this.initialAstWithoutTokens&&!t&&(this.queuedTextEditsForInitialAstWithoutTokens=AA(this.queuedTextEditsForInitialAstWithoutTokens,e))}flushQueue(){this.queuedTextEdits.length>0&&(this.astWithTokens=this.parseDocumentFromTextBuffer(this.queuedTextEdits,this.astWithTokens,!1),this.queuedTextEdits=[]),this.queuedTextEditsForInitialAstWithoutTokens.length>0&&(this.initialAstWithoutTokens&&(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer(this.queuedTextEditsForInitialAstWithoutTokens,this.initialAstWithoutTokens,!1)),this.queuedTextEditsForInitialAstWithoutTokens=[])}parseDocumentFromTextBuffer(e,t,i){const n=t,r=new Lge(this.textModel,this.brackets);return L8(r,e,n,i)}getBracketsInRange(e,t){this.flushQueue();const i=Qn(e.startLineNumber-1,e.startColumn-1),n=Qn(e.endLineNumber-1,e.endColumn-1);return new Kb(r=>{const o=this.initialAstWithoutTokens||this.astWithTokens;k8(o,bo,o.length,i,n,r,0,0,new Map,t)})}getBracketPairsInRange(e,t){this.flushQueue();const i=RC(e.getStartPosition()),n=RC(e.getEndPosition());return new Kb(r=>{const o=this.initialAstWithoutTokens||this.astWithTokens,a=new wBe(r,t,this.textModel);I8(o,bo,o.length,i,n,a,0,new Map)})}getFirstBracketAfter(e){this.flushQueue();const t=this.initialAstWithoutTokens||this.astWithTokens;return Dge(t,bo,t.length,RC(e))}getFirstBracketBefore(e){this.flushQueue();const t=this.initialAstWithoutTokens||this.astWithTokens;return Ege(t,bo,t.length,RC(e))}}function Ege(s,e,t,i){if(s.kind===4||s.kind===2){const n=[];for(const r of s.children)t=En(e,r.length),n.push({nodeOffsetStart:e,nodeOffsetEnd:t}),e=t;for(let r=n.length-1;r>=0;r--){const{nodeOffsetStart:o,nodeOffsetEnd:a}=n[r];if(xy(o,i)){const l=Ege(s.children[r],o,a,i);if(l)return l}}return null}else{if(s.kind===3)return null;if(s.kind===1){const n=Zb(e,t);return{bracketInfo:s.bracketInfo,range:n}}}return null}function Dge(s,e,t,i){if(s.kind===4||s.kind===2){for(const n of s.children){if(t=En(e,n.length),xy(i,t)){const r=Dge(n,e,t,i);if(r)return r}e=t}return null}else{if(s.kind===3)return null;if(s.kind===1){const n=Zb(e,t);return{bracketInfo:s.bracketInfo,range:n}}}return null}function k8(s,e,t,i,n,r,o,a,l,c,d=!1){if(o>200)return!0;e:for(;;)switch(s.kind){case 4:{const u=s.childrenLength;for(let h=0;h<u;h++){const g=s.getChild(h);if(g){if(t=En(e,g.length),Ly(e,n)&&rL(t,i)){if(rL(t,n)){s=g;continue e}if(!k8(g,e,t,i,n,r,o,0,l,c))return!1}e=t}}return!0}case 2:{const u=!c||!s.closingBracket||s.closingBracket.bracketInfo.closesColorized(s.openingBracket.bracketInfo);let h=0;if(l){let p=l.get(s.openingBracket.text);p===void 0&&(p=0),h=p,u&&(p++,l.set(s.openingBracket.text,p))}const g=s.childrenLength;for(let p=0;p<g;p++){const _=s.getChild(p);if(_){if(t=En(e,_.length),Ly(e,n)&&rL(t,i)){if(rL(t,n)&&_.kind!==1){s=_,u?(o++,a=h+1):a=h;continue e}if((u||_.kind!==1||!s.closingBracket)&&!k8(_,e,t,i,n,r,u?o+1:o,u?h+1:h,l,c,!s.closingBracket))return!1}e=t}}return l==null||l.set(s.openingBracket.text,h),!0}case 3:{const u=Zb(e,t);return r(new bne(u,o-1,0,!0))}case 1:{const u=Zb(e,t);return r(new bne(u,o-1,a-1,d))}case 0:return!0}}class wBe{constructor(e,t,i){this.push=e,this.includeMinIndentation=t,this.textModel=i}}function I8(s,e,t,i,n,r,o,a){var c;if(o>200)return!0;let l=!0;if(s.kind===2){let d=0;if(a){let g=a.get(s.openingBracket.text);g===void 0&&(g=0),d=g,g++,a.set(s.openingBracket.text,g)}const u=En(e,s.openingBracket.length);let h=-1;if(r.includeMinIndentation&&(h=s.computeMinIndentation(e,r.textModel)),l=r.push(new tBe(Zb(e,t),Zb(e,u),s.closingBracket?Zb(En(u,((c=s.child)==null?void 0:c.length)||bo),t):void 0,o,d,s,h)),e=u,l&&s.child){const g=s.child;if(t=En(e,g.length),Ly(e,n)&&rL(t,i)&&(l=I8(g,e,t,i,n,r,o+1,a),!l))return!1}a==null||a.set(s.openingBracket.text,d)}else{let d=e;for(const u of s.children){const h=d;if(d=En(d,u.length),Ly(h,n)&&Ly(i,d)&&(l=I8(u,h,d,i,n,r,o,a),!l))return!1}}return l}class CBe extends te{get canBuildAST(){return this.textModel.getValueLength()<=5e6}constructor(e,t){super(),this.textModel=e,this.languageConfigurationService=t,this.bracketPairsTree=this._register(new Es),this.onDidChangeEmitter=new Z,this.onDidChange=this.onDidChangeEmitter.event,this.bracketsRequested=!1}handleLanguageConfigurationServiceChange(e){var t;(!e.languageId||(t=this.bracketPairsTree.value)!=null&&t.object.didLanguageChange(e.languageId))&&(this.bracketPairsTree.clear(),this.updateBracketPairsTree())}handleDidChangeOptions(e){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeLanguage(e){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeContent(e){var t;(t=this.bracketPairsTree.value)==null||t.object.handleContentChanged(e)}handleDidChangeBackgroundTokenizationState(){var e;(e=this.bracketPairsTree.value)==null||e.object.handleDidChangeBackgroundTokenizationState()}handleDidChangeTokens(e){var t;(t=this.bracketPairsTree.value)==null||t.object.handleDidChangeTokens(e)}updateBracketPairsTree(){if(this.bracketsRequested&&this.canBuildAST){if(!this.bracketPairsTree.value){const e=new ce;this.bracketPairsTree.value=yBe(e.add(new vBe(this.textModel,t=>this.languageConfigurationService.getLanguageConfiguration(t))),e),e.add(this.bracketPairsTree.value.object.onDidChange(t=>this.onDidChangeEmitter.fire(t))),this.onDidChangeEmitter.fire()}}else this.bracketPairsTree.value&&(this.bracketPairsTree.clear(),this.onDidChangeEmitter.fire())}getBracketPairsInRange(e){var t;return this.bracketsRequested=!0,this.updateBracketPairsTree(),((t=this.bracketPairsTree.value)==null?void 0:t.object.getBracketPairsInRange(e,!1))||Kb.empty}getBracketPairsInRangeWithMinIndentation(e){var t;return this.bracketsRequested=!0,this.updateBracketPairsTree(),((t=this.bracketPairsTree.value)==null?void 0:t.object.getBracketPairsInRange(e,!0))||Kb.empty}getBracketsInRange(e,t=!1){var i;return this.bracketsRequested=!0,this.updateBracketPairsTree(),((i=this.bracketPairsTree.value)==null?void 0:i.object.getBracketsInRange(e,t))||Kb.empty}findMatchingBracketUp(e,t,i){const n=this.textModel.validatePosition(t),r=this.textModel.getLanguageIdAtPosition(n.lineNumber,n.column);if(this.canBuildAST){const o=this.languageConfigurationService.getLanguageConfiguration(r).bracketsNew.getClosingBracketInfo(e);if(!o)return null;const a=this.getBracketPairsInRange(F.fromPositions(t,t)).findLast(l=>o.closes(l.openingBracketInfo));return a?a.openingBracketRange:null}else{const o=e.toLowerCase(),a=this.languageConfigurationService.getLanguageConfiguration(r).brackets;if(!a)return null;const l=a.textIsBracket[o];return l?vN(this._findMatchingBracketUp(l,n,WV(i))):null}}matchBracket(e,t){if(this.canBuildAST){const i=this.getBracketPairsInRange(F.fromPositions(e,e)).filter(n=>n.closingBracketRange!==void 0&&(n.openingBracketRange.containsPosition(e)||n.closingBracketRange.containsPosition(e))).findLastMaxBy(Co(n=>n.openingBracketRange.containsPosition(e)?n.openingBracketRange:n.closingBracketRange,F.compareRangesUsingStarts));return i?[i.openingBracketRange,i.closingBracketRange]:null}else{const i=WV(t);return this._matchBracket(this.textModel.validatePosition(e),i)}}_establishBracketSearchOffsets(e,t,i,n){const r=t.getCount(),o=t.getLanguageId(n);let a=Math.max(0,e.column-1-i.maxBracketLength);for(let c=n-1;c>=0;c--){const d=t.getEndOffset(c);if(d<=a)break;if(ju(t.getStandardTokenType(c))||t.getLanguageId(c)!==o){a=d;break}}let l=Math.min(t.getLineContent().length,e.column-1+i.maxBracketLength);for(let c=n+1;c<r;c++){const d=t.getStartOffset(c);if(d>=l)break;if(ju(t.getStandardTokenType(c))||t.getLanguageId(c)!==o){l=d;break}}return{searchStartOffset:a,searchEndOffset:l}}_matchBracket(e,t){const i=e.lineNumber,n=this.textModel.tokenization.getLineTokens(i),r=this.textModel.getLineContent(i),o=n.findTokenIndexAtOffset(e.column-1);if(o<0)return null;const a=this.languageConfigurationService.getLanguageConfiguration(n.getLanguageId(o)).brackets;if(a&&!ju(n.getStandardTokenType(o))){let{searchStartOffset:l,searchEndOffset:c}=this._establishBracketSearchOffsets(e,n,a,o),d=null;for(;;){const u=Hc.findNextBracketInRange(a.forwardRegex,i,r,l,c);if(!u)break;if(u.startColumn<=e.column&&e.column<=u.endColumn){const h=r.substring(u.startColumn-1,u.endColumn-1).toLowerCase(),g=this._matchFoundBracket(u,a.textIsBracket[h],a.textIsOpenBracket[h],t);if(g){if(g instanceof Tf)return null;d=g}}l=u.endColumn-1}if(d)return d}if(o>0&&n.getStartOffset(o)===e.column-1){const l=o-1,c=this.languageConfigurationService.getLanguageConfiguration(n.getLanguageId(l)).brackets;if(c&&!ju(n.getStandardTokenType(l))){const{searchStartOffset:d,searchEndOffset:u}=this._establishBracketSearchOffsets(e,n,c,l),h=Hc.findPrevBracketInRange(c.reversedRegex,i,r,d,u);if(h&&h.startColumn<=e.column&&e.column<=h.endColumn){const g=r.substring(h.startColumn-1,h.endColumn-1).toLowerCase(),p=this._matchFoundBracket(h,c.textIsBracket[g],c.textIsOpenBracket[g],t);if(p)return p instanceof Tf?null:p}}}return null}_matchFoundBracket(e,t,i,n){if(!t)return null;const r=i?this._findMatchingBracketDown(t,e.getEndPosition(),n):this._findMatchingBracketUp(t,e.getStartPosition(),n);return r?r instanceof Tf?r:[e,r]:null}_findMatchingBracketUp(e,t,i){const n=e.languageId,r=e.reversedRegex;let o=-1,a=0;const l=(c,d,u,h)=>{for(;;){if(i&&++a%100===0&&!i())return Tf.INSTANCE;const g=Hc.findPrevBracketInRange(r,c,d,u,h);if(!g)break;const p=d.substring(g.startColumn-1,g.endColumn-1).toLowerCase();if(e.isOpen(p)?o++:e.isClose(p)&&o--,o===0)return g;h=g.startColumn-1}return null};for(let c=t.lineNumber;c>=1;c--){const d=this.textModel.tokenization.getLineTokens(c),u=d.getCount(),h=this.textModel.getLineContent(c);let g=u-1,p=h.length,_=h.length;c===t.lineNumber&&(g=d.findTokenIndexAtOffset(t.column-1),p=t.column-1,_=t.column-1);let v=!0;for(;g>=0;g--){const C=d.getLanguageId(g)===n&&!ju(d.getStandardTokenType(g));if(C)v?p=d.getStartOffset(g):(p=d.getStartOffset(g),_=d.getEndOffset(g));else if(v&&p!==_){const y=l(c,h,p,_);if(y)return y}v=C}if(v&&p!==_){const C=l(c,h,p,_);if(C)return C}}return null}_findMatchingBracketDown(e,t,i){const n=e.languageId,r=e.forwardRegex;let o=1,a=0;const l=(d,u,h,g)=>{for(;;){if(i&&++a%100===0&&!i())return Tf.INSTANCE;const p=Hc.findNextBracketInRange(r,d,u,h,g);if(!p)break;const _=u.substring(p.startColumn-1,p.endColumn-1).toLowerCase();if(e.isOpen(_)?o++:e.isClose(_)&&o--,o===0)return p;h=p.endColumn-1}return null},c=this.textModel.getLineCount();for(let d=t.lineNumber;d<=c;d++){const u=this.textModel.tokenization.getLineTokens(d),h=u.getCount(),g=this.textModel.getLineContent(d);let p=0,_=0,v=0;d===t.lineNumber&&(p=u.findTokenIndexAtOffset(t.column-1),_=t.column-1,v=t.column-1);let C=!0;for(;p<h;p++){const y=u.getLanguageId(p)===n&&!ju(u.getStandardTokenType(p));if(y)C||(_=u.getStartOffset(p)),v=u.getEndOffset(p);else if(C&&_!==v){const x=l(d,g,_,v);if(x)return x}C=y}if(C&&_!==v){const y=l(d,g,_,v);if(y)return y}}return null}findPrevBracket(e){var o;const t=this.textModel.validatePosition(e);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),((o=this.bracketPairsTree.value)==null?void 0:o.object.getFirstBracketBefore(t))||null;let i=null,n=null,r=null;for(let a=t.lineNumber;a>=1;a--){const l=this.textModel.tokenization.getLineTokens(a),c=l.getCount(),d=this.textModel.getLineContent(a);let u=c-1,h=d.length,g=d.length;if(a===t.lineNumber){u=l.findTokenIndexAtOffset(t.column-1),h=t.column-1,g=t.column-1;const _=l.getLanguageId(u);i!==_&&(i=_,n=this.languageConfigurationService.getLanguageConfiguration(i).brackets,r=this.languageConfigurationService.getLanguageConfiguration(i).bracketsNew)}let p=!0;for(;u>=0;u--){const _=l.getLanguageId(u);if(i!==_){if(n&&r&&p&&h!==g){const C=Hc.findPrevBracketInRange(n.reversedRegex,a,d,h,g);if(C)return this._toFoundBracket(r,C);p=!1}i=_,n=this.languageConfigurationService.getLanguageConfiguration(i).brackets,r=this.languageConfigurationService.getLanguageConfiguration(i).bracketsNew}const v=!!n&&!ju(l.getStandardTokenType(u));if(v)p?h=l.getStartOffset(u):(h=l.getStartOffset(u),g=l.getEndOffset(u));else if(r&&n&&p&&h!==g){const C=Hc.findPrevBracketInRange(n.reversedRegex,a,d,h,g);if(C)return this._toFoundBracket(r,C)}p=v}if(r&&n&&p&&h!==g){const _=Hc.findPrevBracketInRange(n.reversedRegex,a,d,h,g);if(_)return this._toFoundBracket(r,_)}}return null}findNextBracket(e){var a;const t=this.textModel.validatePosition(e);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),((a=this.bracketPairsTree.value)==null?void 0:a.object.getFirstBracketAfter(t))||null;const i=this.textModel.getLineCount();let n=null,r=null,o=null;for(let l=t.lineNumber;l<=i;l++){const c=this.textModel.tokenization.getLineTokens(l),d=c.getCount(),u=this.textModel.getLineContent(l);let h=0,g=0,p=0;if(l===t.lineNumber){h=c.findTokenIndexAtOffset(t.column-1),g=t.column-1,p=t.column-1;const v=c.getLanguageId(h);n!==v&&(n=v,r=this.languageConfigurationService.getLanguageConfiguration(n).brackets,o=this.languageConfigurationService.getLanguageConfiguration(n).bracketsNew)}let _=!0;for(;h<d;h++){const v=c.getLanguageId(h);if(n!==v){if(o&&r&&_&&g!==p){const y=Hc.findNextBracketInRange(r.forwardRegex,l,u,g,p);if(y)return this._toFoundBracket(o,y);_=!1}n=v,r=this.languageConfigurationService.getLanguageConfiguration(n).brackets,o=this.languageConfigurationService.getLanguageConfiguration(n).bracketsNew}const C=!!r&&!ju(c.getStandardTokenType(h));if(C)_||(g=c.getStartOffset(h)),p=c.getEndOffset(h);else if(o&&r&&_&&g!==p){const y=Hc.findNextBracketInRange(r.forwardRegex,l,u,g,p);if(y)return this._toFoundBracket(o,y)}_=C}if(o&&r&&_&&g!==p){const v=Hc.findNextBracketInRange(r.forwardRegex,l,u,g,p);if(v)return this._toFoundBracket(o,v)}}return null}findEnclosingBrackets(e,t){const i=this.textModel.validatePosition(e);if(this.canBuildAST){const g=F.fromPositions(i),p=this.getBracketPairsInRange(F.fromPositions(i,i)).findLast(_=>_.closingBracketRange!==void 0&&_.range.strictContainsRange(g));return p?[p.openingBracketRange,p.closingBracketRange]:null}const n=WV(t),r=this.textModel.getLineCount(),o=new Map;let a=[];const l=(g,p)=>{if(!o.has(g)){const _=[];for(let v=0,C=p?p.brackets.length:0;v<C;v++)_[v]=0;o.set(g,_)}a=o.get(g)};let c=0;const d=(g,p,_,v,C)=>{for(;;){if(n&&++c%100===0&&!n())return Tf.INSTANCE;const y=Hc.findNextBracketInRange(g.forwardRegex,p,_,v,C);if(!y)break;const x=_.substring(y.startColumn-1,y.endColumn-1).toLowerCase(),L=g.textIsBracket[x];if(L&&(L.isOpen(x)?a[L.index]++:L.isClose(x)&&a[L.index]--,a[L.index]===-1))return this._matchFoundBracket(y,L,!1,n);v=y.endColumn-1}return null};let u=null,h=null;for(let g=i.lineNumber;g<=r;g++){const p=this.textModel.tokenization.getLineTokens(g),_=p.getCount(),v=this.textModel.getLineContent(g);let C=0,y=0,x=0;if(g===i.lineNumber){C=p.findTokenIndexAtOffset(i.column-1),y=i.column-1,x=i.column-1;const I=p.getLanguageId(C);u!==I&&(u=I,h=this.languageConfigurationService.getLanguageConfiguration(u).brackets,l(u,h))}let L=!0;for(;C<_;C++){const I=p.getLanguageId(C);if(u!==I){if(h&&L&&y!==x){const D=d(h,g,v,y,x);if(D)return vN(D);L=!1}u=I,h=this.languageConfigurationService.getLanguageConfiguration(u).brackets,l(u,h)}const A=!!h&&!ju(p.getStandardTokenType(C));if(A)L||(y=p.getStartOffset(C)),x=p.getEndOffset(C);else if(h&&L&&y!==x){const D=d(h,g,v,y,x);if(D)return vN(D)}L=A}if(h&&L&&y!==x){const I=d(h,g,v,y,x);if(I)return vN(I)}}return null}_toFoundBracket(e,t){if(!t)return null;let i=this.textModel.getValueInRange(t);i=i.toLowerCase();const n=e.getBracketInfo(i);return n?{range:t,bracketInfo:n}:null}}function yBe(s,e){return{object:s,dispose:()=>e==null?void 0:e.dispose()}}function WV(s){if(typeof s>"u")return()=>!0;{const e=Date.now();return()=>Date.now()-e<=s}}const KM=class KM{constructor(){this._searchCanceledBrand=void 0}};KM.INSTANCE=new KM;let Tf=KM;function vN(s){return s instanceof Tf?null:s}class SBe extends te{constructor(e){super(),this.textModel=e,this.colorProvider=new Tge,this.onDidChangeEmitter=new Z,this.onDidChange=this.onDidChangeEmitter.event,this.colorizationOptions=e.getOptions().bracketPairColorizationOptions,this._register(e.bracketPairs.onDidChange(t=>{this.onDidChangeEmitter.fire()}))}handleDidChangeOptions(e){this.colorizationOptions=this.textModel.getOptions().bracketPairColorizationOptions}getDecorationsInRange(e,t,i,n){return n?[]:t===void 0?[]:this.colorizationOptions.enabled?this.textModel.bracketPairs.getBracketsInRange(e,!0).map(o=>({id:`bracket${o.range.toString()}-${o.nestingLevel}`,options:{description:"BracketPairColorization",inlineClassName:this.colorProvider.getInlineClassName(o,this.colorizationOptions.independentColorPoolPerBracketType)},ownerId:0,range:o.range})).toArray():[]}getAllDecorations(e,t){return e===void 0?[]:this.colorizationOptions.enabled?this.getDecorationsInRange(new F(1,1,this.textModel.getLineCount(),1),e,t):[]}}class Tge{constructor(){this.unexpectedClosingBracketClassName="unexpected-closing-bracket"}getInlineClassName(e,t){return e.isInvalid?this.unexpectedClosingBracketClassName:this.getInlineClassNameOfLevel(t?e.nestingLevelOfEqualBracketType:e.nestingLevel)}getInlineClassNameOfLevel(e){return`bracket-highlighting-${e%30}`}}Lc((s,e)=>{const t=[_ge,bge,vge,wge,Cge,yge],i=new Tge;e.addRule(`.monaco-editor .${i.unexpectedClosingBracketClassName} { color: ${s.getColor(OVe)}; }`);const n=t.map(r=>s.getColor(r)).filter(r=>!!r).filter(r=>!r.isTransparent());for(let r=0;r<30;r++){const o=n[r%n.length];e.addRule(`.monaco-editor .${i.getInlineClassNameOfLevel(r)} { color: ${o}; }`)}});function wN(s){return s.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}class ar{get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}constructor(e,t,i,n){this.oldPosition=e,this.oldText=t,this.newPosition=i,this.newText=n}toString(){return this.oldText.length===0?`(insert@${this.oldPosition} "${wN(this.newText)}")`:this.newText.length===0?`(delete@${this.oldPosition} "${wN(this.oldText)}")`:`(replace@${this.oldPosition} "${wN(this.oldText)}" with "${wN(this.newText)}")`}static _writeStringSize(e){return 4+2*e.length}static _writeString(e,t,i){const n=t.length;Hd(e,n,i),i+=4;for(let r=0;r<n;r++)dPe(e,t.charCodeAt(r),i),i+=2;return i}static _readString(e,t){const i=Wd(e,t);return t+=4,hPe(e,t,i)}writeSize(){return 8+ar._writeStringSize(this.oldText)+ar._writeStringSize(this.newText)}write(e,t){return Hd(e,this.oldPosition,t),t+=4,Hd(e,this.newPosition,t),t+=4,t=ar._writeString(e,this.oldText,t),t=ar._writeString(e,this.newText,t),t}static read(e,t,i){const n=Wd(e,t);t+=4;const r=Wd(e,t);t+=4;const o=ar._readString(e,t);t+=ar._writeStringSize(o);const a=ar._readString(e,t);return t+=ar._writeStringSize(a),i.push(new ar(n,o,r,a)),t}}function xBe(s,e){return s===null||s.length===0?e:new Ku(s,e).compress()}class Ku{constructor(e,t){this._prevEdits=e,this._currEdits=t,this._result=[],this._resultLen=0,this._prevLen=this._prevEdits.length,this._prevDeltaOffset=0,this._currLen=this._currEdits.length,this._currDeltaOffset=0}compress(){let e=0,t=0,i=this._getPrev(e),n=this._getCurr(t);for(;e<this._prevLen||t<this._currLen;){if(i===null){this._acceptCurr(n),n=this._getCurr(++t);continue}if(n===null){this._acceptPrev(i),i=this._getPrev(++e);continue}if(n.oldEnd<=i.newPosition){this._acceptCurr(n),n=this._getCurr(++t);continue}if(i.newEnd<=n.oldPosition){this._acceptPrev(i),i=this._getPrev(++e);continue}if(n.oldPosition<i.newPosition){const[c,d]=Ku._splitCurr(n,i.newPosition-n.oldPosition);this._acceptCurr(c),n=d;continue}if(i.newPosition<n.oldPosition){const[c,d]=Ku._splitPrev(i,n.oldPosition-i.newPosition);this._acceptPrev(c),i=d;continue}let a,l;if(n.oldEnd===i.newEnd)a=i,l=n,i=this._getPrev(++e),n=this._getCurr(++t);else if(n.oldEnd<i.newEnd){const[c,d]=Ku._splitPrev(i,n.oldLength);a=c,l=n,i=d,n=this._getCurr(++t)}else{const[c,d]=Ku._splitCurr(n,i.newLength);a=i,l=c,i=this._getPrev(++e),n=d}this._result[this._resultLen++]=new ar(a.oldPosition,a.oldText,l.newPosition,l.newText),this._prevDeltaOffset+=a.newLength-a.oldLength,this._currDeltaOffset+=l.newLength-l.oldLength}const r=Ku._merge(this._result);return Ku._removeNoOps(r)}_acceptCurr(e){this._result[this._resultLen++]=Ku._rebaseCurr(this._prevDeltaOffset,e),this._currDeltaOffset+=e.newLength-e.oldLength}_getCurr(e){return e<this._currLen?this._currEdits[e]:null}_acceptPrev(e){this._result[this._resultLen++]=Ku._rebasePrev(this._currDeltaOffset,e),this._prevDeltaOffset+=e.newLength-e.oldLength}_getPrev(e){return e<this._prevLen?this._prevEdits[e]:null}static _rebaseCurr(e,t){return new ar(t.oldPosition-e,t.oldText,t.newPosition,t.newText)}static _rebasePrev(e,t){return new ar(t.oldPosition,t.oldText,t.newPosition+e,t.newText)}static _splitPrev(e,t){const i=e.newText.substr(0,t),n=e.newText.substr(t);return[new ar(e.oldPosition,e.oldText,e.newPosition,i),new ar(e.oldEnd,"",e.newPosition+t,n)]}static _splitCurr(e,t){const i=e.oldText.substr(0,t),n=e.oldText.substr(t);return[new ar(e.oldPosition,i,e.newPosition,e.newText),new ar(e.oldPosition+t,n,e.newEnd,"")]}static _merge(e){if(e.length===0)return e;const t=[];let i=0,n=e[0];for(let r=1;r<e.length;r++){const o=e[r];n.oldEnd===o.oldPosition?n=new ar(n.oldPosition,n.oldText+o.oldText,n.newPosition,n.newText+o.newText):(t[i++]=n,n=o)}return t[i++]=n,t}static _removeNoOps(e){if(e.length===0)return e;const t=[];let i=0;for(let n=0;n<e.length;n++){const r=e[n];r.oldText!==r.newText&&(t[i++]=r)}return t}}function K0(s){return s.toString()}class Rs{static create(e,t){const i=e.getAlternativeVersionId(),n=E8(e);return new Rs(i,i,n,n,t,t,[])}constructor(e,t,i,n,r,o,a){this.beforeVersionId=e,this.afterVersionId=t,this.beforeEOL=i,this.afterEOL=n,this.beforeCursorState=r,this.afterCursorState=o,this.changes=a}append(e,t,i,n,r){t.length>0&&(this.changes=xBe(this.changes,t)),this.afterEOL=i,this.afterVersionId=n,this.afterCursorState=r}static _writeSelectionsSize(e){return 4+4*4*(e?e.length:0)}static _writeSelections(e,t,i){if(Hd(e,t?t.length:0,i),i+=4,t)for(const n of t)Hd(e,n.selectionStartLineNumber,i),i+=4,Hd(e,n.selectionStartColumn,i),i+=4,Hd(e,n.positionLineNumber,i),i+=4,Hd(e,n.positionColumn,i),i+=4;return i}static _readSelections(e,t,i){const n=Wd(e,t);t+=4;for(let r=0;r<n;r++){const o=Wd(e,t);t+=4;const a=Wd(e,t);t+=4;const l=Wd(e,t);t+=4;const c=Wd(e,t);t+=4,i.push(new Ue(o,a,l,c))}return t}serialize(){let e=10+Rs._writeSelectionsSize(this.beforeCursorState)+Rs._writeSelectionsSize(this.afterCursorState)+4;for(const n of this.changes)e+=n.writeSize();const t=new Uint8Array(e);let i=0;Hd(t,this.beforeVersionId,i),i+=4,Hd(t,this.afterVersionId,i),i+=4,xte(t,this.beforeEOL,i),i+=1,xte(t,this.afterEOL,i),i+=1,i=Rs._writeSelections(t,this.beforeCursorState,i),i=Rs._writeSelections(t,this.afterCursorState,i),Hd(t,this.changes.length,i),i+=4;for(const n of this.changes)i=n.write(t,i);return t.buffer}static deserialize(e){const t=new Uint8Array(e);let i=0;const n=Wd(t,i);i+=4;const r=Wd(t,i);i+=4;const o=Ste(t,i);i+=1;const a=Ste(t,i);i+=1;const l=[];i=Rs._readSelections(t,i,l);const c=[];i=Rs._readSelections(t,i,c);const d=Wd(t,i);i+=4;const u=[];for(let h=0;h<d;h++)i=ar.read(t,i,u);return new Rs(n,r,o,a,l,c,u)}}class Nge{get type(){return 0}get resource(){return Je.isUri(this.model)?this.model:this.model.uri}constructor(e,t,i,n){this.label=e,this.code=t,this.model=i,this._data=Rs.create(i,n)}toString(){return(this._data instanceof Rs?this._data:Rs.deserialize(this._data)).changes.map(t=>t.toString()).join(", ")}matchesResource(e){return(Je.isUri(this.model)?this.model:this.model.uri).toString()===e.toString()}setModel(e){this.model=e}canAppend(e){return this.model===e&&this._data instanceof Rs}append(e,t,i,n,r){this._data instanceof Rs&&this._data.append(e,t,i,n,r)}close(){this._data instanceof Rs&&(this._data=this._data.serialize())}open(){this._data instanceof Rs||(this._data=Rs.deserialize(this._data))}undo(){if(Je.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof Rs&&(this._data=this._data.serialize());const e=Rs.deserialize(this._data);this.model._applyUndo(e.changes,e.beforeEOL,e.beforeVersionId,e.beforeCursorState)}redo(){if(Je.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof Rs&&(this._data=this._data.serialize());const e=Rs.deserialize(this._data);this.model._applyRedo(e.changes,e.afterEOL,e.afterVersionId,e.afterCursorState)}heapSize(){return this._data instanceof Rs&&(this._data=this._data.serialize()),this._data.byteLength+168}}class LBe{get resources(){return this._editStackElementsArr.map(e=>e.resource)}constructor(e,t,i){this.label=e,this.code=t,this.type=1,this._isOpen=!0,this._editStackElementsArr=i.slice(0),this._editStackElementsMap=new Map;for(const n of this._editStackElementsArr){const r=K0(n.resource);this._editStackElementsMap.set(r,n)}this._delegate=null}prepareUndoRedo(){if(this._delegate)return this._delegate.prepareUndoRedo(this)}matchesResource(e){const t=K0(e);return this._editStackElementsMap.has(t)}setModel(e){const t=K0(Je.isUri(e)?e:e.uri);this._editStackElementsMap.has(t)&&this._editStackElementsMap.get(t).setModel(e)}canAppend(e){if(!this._isOpen)return!1;const t=K0(e.uri);return this._editStackElementsMap.has(t)?this._editStackElementsMap.get(t).canAppend(e):!1}append(e,t,i,n,r){const o=K0(e.uri);this._editStackElementsMap.get(o).append(e,t,i,n,r)}close(){this._isOpen=!1}open(){}undo(){this._isOpen=!1;for(const e of this._editStackElementsArr)e.undo()}redo(){for(const e of this._editStackElementsArr)e.redo()}heapSize(e){const t=K0(e);return this._editStackElementsMap.has(t)?this._editStackElementsMap.get(t).heapSize():0}split(){return this._editStackElementsArr}toString(){const e=[];for(const t of this._editStackElementsArr)e.push(`${Cc(t.resource)}: ${t}`);return`{${e.join(", ")}}`}}function E8(s){return s.getEOL()===`
`?0:1}function Nf(s){return s?s instanceof Nge||s instanceof LBe:!1}class $K{constructor(e,t){this._model=e,this._undoRedoService=t}pushStackElement(){const e=this._undoRedoService.getLastElement(this._model.uri);Nf(e)&&e.close()}popStackElement(){const e=this._undoRedoService.getLastElement(this._model.uri);Nf(e)&&e.open()}clear(){this._undoRedoService.removeElements(this._model.uri)}_getOrCreateEditStackElement(e,t){const i=this._undoRedoService.getLastElement(this._model.uri);if(Nf(i)&&i.canAppend(this._model))return i;const n=new Nge(b("edit","Typing"),"undoredo.textBufferEdit",this._model,e);return this._undoRedoService.pushElement(n,t),n}pushEOL(e){const t=this._getOrCreateEditStackElement(null,void 0);this._model.setEOL(e),t.append(this._model,[],E8(this._model),this._model.getAlternativeVersionId(),null)}pushEditOperation(e,t,i,n){const r=this._getOrCreateEditStackElement(e,n),o=this._model.applyEdits(t,!0),a=$K._computeCursorState(i,o),l=o.map((c,d)=>({index:d,textChange:c.textChange}));return l.sort((c,d)=>c.textChange.oldPosition===d.textChange.oldPosition?c.index-d.index:c.textChange.oldPosition-d.textChange.oldPosition),r.append(this._model,l.map(c=>c.textChange),E8(this._model),this._model.getAlternativeVersionId(),a),a}static _computeCursorState(e,t){try{return e?e(t):null}catch(i){return ft(i),null}}}class Rge extends te{constructor(){super(...arguments),this._isDisposed=!1}dispose(){super.dispose(),this._isDisposed=!0}assertNotDisposed(){if(this._isDisposed)throw new Error("TextModelPart is disposed!")}}function jF(s,e){let t=0,i=0;const n=s.length;for(;i<n;){const r=s.charCodeAt(i);if(r===32)t++;else if(r===9)t=t-t%e+e;else break;i++}return i===n?-1:t}var Jb;(function(s){s[s.Disabled=0]="Disabled",s[s.EnabledForActive=1]="EnabledForActive",s[s.Enabled=2]="Enabled"})(Jb||(Jb={}));class Wb{constructor(e,t,i,n,r,o){if(this.visibleColumn=e,this.column=t,this.className=i,this.horizontalLine=n,this.forWrappedLinesAfterColumn=r,this.forWrappedLinesBeforeOrAtColumn=o,e!==-1==(t!==-1))throw new Error}}class VL{constructor(e,t){this.top=e,this.endColumn=t}}class kBe extends Rge{constructor(e,t){super(),this.textModel=e,this.languageConfigurationService=t}getLanguageConfiguration(e){return this.languageConfigurationService.getLanguageConfiguration(e)}_computeIndentLevel(e){return jF(this.textModel.getLineContent(e+1),this.textModel.getOptions().tabSize)}getActiveIndentGuide(e,t,i){this.assertNotDisposed();const n=this.textModel.getLineCount();if(e<1||e>n)throw new di("Illegal value for lineNumber");const r=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,o=!!(r&&r.offSide);let a=-2,l=-1,c=-2,d=-1;const u=D=>{if(a!==-1&&(a===-2||a>D-1)){a=-1,l=-1;for(let N=D-2;N>=0;N--){const R=this._computeIndentLevel(N);if(R>=0){a=N,l=R;break}}}if(c===-2){c=-1,d=-1;for(let N=D;N<n;N++){const R=this._computeIndentLevel(N);if(R>=0){c=N,d=R;break}}}};let h=-2,g=-1,p=-2,_=-1;const v=D=>{if(h===-2){h=-1,g=-1;for(let N=D-2;N>=0;N--){const R=this._computeIndentLevel(N);if(R>=0){h=N,g=R;break}}}if(p!==-1&&(p===-2||p<D-1)){p=-1,_=-1;for(let N=D;N<n;N++){const R=this._computeIndentLevel(N);if(R>=0){p=N,_=R;break}}}};let C=0,y=!0,x=0,L=!0,I=0,A=0;for(let D=0;y||L;D++){const N=e-D,R=e+D;D>1&&(N<1||N<t)&&(y=!1),D>1&&(R>n||R>i)&&(L=!1),D>5e4&&(y=!1,L=!1);let W=-1;if(y&&N>=1){const U=this._computeIndentLevel(N-1);U>=0?(c=N-1,d=U,W=Math.ceil(U/this.textModel.getOptions().indentSize)):(u(N),W=this._getIndentLevelForWhitespaceLine(o,l,d))}let H=-1;if(L&&R<=n){const U=this._computeIndentLevel(R-1);U>=0?(h=R-1,g=U,H=Math.ceil(U/this.textModel.getOptions().indentSize)):(v(R),H=this._getIndentLevelForWhitespaceLine(o,g,_))}if(D===0){A=W;continue}if(D===1){if(R<=n&&H>=0&&A+1===H){y=!1,C=R,x=R,I=H;continue}if(N>=1&&W>=0&&W-1===A){L=!1,C=N,x=N,I=W;continue}if(C=e,x=e,I=A,I===0)return{startLineNumber:C,endLineNumber:x,indent:I}}y&&(W>=I?C=N:y=!1),L&&(H>=I?x=R:L=!1)}return{startLineNumber:C,endLineNumber:x,indent:I}}getLinesBracketGuides(e,t,i,n){var u;const r=[];for(let h=e;h<=t;h++)r.push([]);const o=!0,a=this.textModel.bracketPairs.getBracketPairsInRangeWithMinIndentation(new F(e,1,t,this.textModel.getLineMaxColumn(t))).toArray();let l;if(i&&a.length>0){const h=(e<=i.lineNumber&&i.lineNumber<=t?a:this.textModel.bracketPairs.getBracketPairsInRange(F.fromPositions(i)).toArray()).filter(g=>F.strictContainsPosition(g.range,i));l=(u=oI(h,g=>o))==null?void 0:u.range}const c=this.textModel.getOptions().bracketPairColorizationOptions.independentColorPoolPerBracketType,d=new Age;for(const h of a){if(!h.closingBracketRange)continue;const g=l&&h.range.equalsRange(l);if(!g&&!n.includeInactive)continue;const p=d.getInlineClassName(h.nestingLevel,h.nestingLevelOfEqualBracketType,c)+(n.highlightActive&&g?" "+d.activeClassName:""),_=h.openingBracketRange.getStartPosition(),v=h.closingBracketRange.getStartPosition(),C=n.horizontalGuides===Jb.Enabled||n.horizontalGuides===Jb.EnabledForActive&&g;if(h.range.startLineNumber===h.range.endLineNumber){C&&r[h.range.startLineNumber-e].push(new Wb(-1,h.openingBracketRange.getEndPosition().column,p,new VL(!1,v.column),-1,-1));continue}const y=this.getVisibleColumnFromPosition(v),x=this.getVisibleColumnFromPosition(h.openingBracketRange.getStartPosition()),L=Math.min(x,y,h.minVisibleColumnIndentation+1);let I=!1;Zr(this.textModel.getLineContent(h.closingBracketRange.startLineNumber))<h.closingBracketRange.startColumn-1&&(I=!0);const N=Math.max(_.lineNumber,e),R=Math.min(v.lineNumber,t),W=I?1:0;for(let H=N;H<R+W;H++)r[H-e].push(new Wb(L,-1,p,null,H===_.lineNumber?_.column:-1,H===v.lineNumber?v.column:-1));C&&(_.lineNumber>=e&&x>L&&r[_.lineNumber-e].push(new Wb(L,-1,p,new VL(!1,_.column),-1,-1)),v.lineNumber<=t&&y>L&&r[v.lineNumber-e].push(new Wb(L,-1,p,new VL(!I,v.column),-1,-1)))}for(const h of r)h.sort((g,p)=>g.visibleColumn-p.visibleColumn);return r}getVisibleColumnFromPosition(e){return hs.visibleColumnFromColumn(this.textModel.getLineContent(e.lineNumber),e.column,this.textModel.getOptions().tabSize)+1}getLinesIndentGuides(e,t){this.assertNotDisposed();const i=this.textModel.getLineCount();if(e<1||e>i)throw new Error("Illegal value for startLineNumber");if(t<1||t>i)throw new Error("Illegal value for endLineNumber");const n=this.textModel.getOptions(),r=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,o=!!(r&&r.offSide),a=new Array(t-e+1);let l=-2,c=-1,d=-2,u=-1;for(let h=e;h<=t;h++){const g=h-e,p=this._computeIndentLevel(h-1);if(p>=0){l=h-1,c=p,a[g]=Math.ceil(p/n.indentSize);continue}if(l===-2){l=-1,c=-1;for(let _=h-2;_>=0;_--){const v=this._computeIndentLevel(_);if(v>=0){l=_,c=v;break}}}if(d!==-1&&(d===-2||d<h-1)){d=-1,u=-1;for(let _=h;_<i;_++){const v=this._computeIndentLevel(_);if(v>=0){d=_,u=v;break}}}a[g]=this._getIndentLevelForWhitespaceLine(o,c,u)}return a}_getIndentLevelForWhitespaceLine(e,t,i){const n=this.textModel.getOptions();return t===-1||i===-1?0:t<i?1+Math.floor(t/n.indentSize):t===i||e?Math.ceil(i/n.indentSize):1+Math.floor(i/n.indentSize)}}class Age{constructor(){this.activeClassName="indent-active"}getInlineClassName(e,t,i){return this.getInlineClassNameOfLevel(i?t:e)}getInlineClassNameOfLevel(e){return`bracket-indent-guide lvl-${e%30}`}}class IBe{constructor(){this.spacesDiff=0,this.looksLikeAlignment=!1}}function EBe(s,e,t,i,n){n.spacesDiff=0,n.looksLikeAlignment=!1;let r;for(r=0;r<e&&r<i;r++){const h=s.charCodeAt(r),g=t.charCodeAt(r);if(h!==g)break}let o=0,a=0;for(let h=r;h<e;h++)s.charCodeAt(h)===32?o++:a++;let l=0,c=0;for(let h=r;h<i;h++)t.charCodeAt(h)===32?l++:c++;if(o>0&&a>0||l>0&&c>0)return;const d=Math.abs(a-c),u=Math.abs(o-l);if(d===0){n.spacesDiff=u,u>0&&0<=l-1&&l-1<s.length&&l<t.length&&t.charCodeAt(l)!==32&&s.charCodeAt(l-1)===32&&s.charCodeAt(s.length-1)===44&&(n.looksLikeAlignment=!0);return}if(u%d===0){n.spacesDiff=u/d;return}}function yne(s,e,t){const i=Math.min(s.getLineCount(),1e4);let n=0,r=0,o="",a=0;const l=[2,4,6,8,3,5,7],c=8,d=[0,0,0,0,0,0,0,0,0],u=new IBe;for(let p=1;p<=i;p++){const _=s.getLineLength(p),v=s.getLineContent(p),C=_<=65536;let y=!1,x=0,L=0,I=0;for(let D=0,N=_;D<N;D++){const R=C?v.charCodeAt(D):s.getLineCharCode(p,D);if(R===9)I++;else if(R===32)L++;else{y=!0,x=D;break}}if(!y||(I>0?n++:L>1&&r++,EBe(o,a,v,x,u),u.looksLikeAlignment&&!(t&&e===u.spacesDiff)))continue;const A=u.spacesDiff;A<=c&&d[A]++,o=v,a=x}let h=t;n!==r&&(h=n<r);let g=e;if(h){let p=h?0:.1*i;l.forEach(_=>{const v=d[_];v>p&&(p=v,g=_)}),g===4&&d[4]>0&&d[2]>0&&d[2]>=d[4]/2&&(g=2)}return{insertSpaces:h,tabSize:g}}function zo(s){return(s.metadata&1)>>>0}function Zi(s,e){s.metadata=s.metadata&254|e<<0}function fr(s){return(s.metadata&2)>>>1===1}function qi(s,e){s.metadata=s.metadata&253|(e?1:0)<<1}function Pge(s){return(s.metadata&4)>>>2===1}function Sne(s,e){s.metadata=s.metadata&251|(e?1:0)<<2}function Mge(s){return(s.metadata&64)>>>6===1}function xne(s,e){s.metadata=s.metadata&191|(e?1:0)<<6}function DBe(s){return(s.metadata&24)>>>3}function Lne(s,e){s.metadata=s.metadata&231|e<<3}function TBe(s){return(s.metadata&32)>>>5===1}function kne(s,e){s.metadata=s.metadata&223|(e?1:0)<<5}class Oge{constructor(e,t,i){this.metadata=0,this.parent=this,this.left=this,this.right=this,Zi(this,1),this.start=t,this.end=i,this.delta=0,this.maxEnd=i,this.id=e,this.ownerId=0,this.options=null,Sne(this,!1),xne(this,!1),Lne(this,1),kne(this,!1),this.cachedVersionId=0,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=i,this.range=null,qi(this,!1)}reset(e,t,i,n){this.start=t,this.end=i,this.maxEnd=i,this.cachedVersionId=e,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=i,this.range=n}setOptions(e){this.options=e;const t=this.options.className;Sne(this,t==="squiggly-error"||t==="squiggly-warning"||t==="squiggly-info"),xne(this,this.options.glyphMarginClassName!==null),Lne(this,this.options.stickiness),kne(this,this.options.collapseOnReplaceEdit)}setCachedOffsets(e,t,i){this.cachedVersionId!==i&&(this.range=null),this.cachedVersionId=i,this.cachedAbsoluteStart=e,this.cachedAbsoluteEnd=t}detach(){this.parent=null,this.left=null,this.right=null}}const Bt=new Oge(null,0,0);Bt.parent=Bt;Bt.left=Bt;Bt.right=Bt;Zi(Bt,0);class HV{constructor(){this.root=Bt,this.requestNormalizeDelta=!1}intervalSearch(e,t,i,n,r,o){return this.root===Bt?[]:VBe(this,e,t,i,n,r,o)}search(e,t,i,n){return this.root===Bt?[]:FBe(this,e,t,i,n)}collectNodesFromOwner(e){return MBe(this,e)}collectNodesPostOrder(){return OBe(this)}insert(e){Ine(this,e),this._normalizeDeltaIfNecessary()}delete(e){Ene(this,e),this._normalizeDeltaIfNecessary()}resolveNode(e,t){const i=e;let n=0;for(;e!==this.root;)e===e.parent.right&&(n+=e.parent.delta),e=e.parent;const r=i.start+n,o=i.end+n;i.setCachedOffsets(r,o,t)}acceptReplace(e,t,i,n){const r=ABe(this,e,e+t);for(let o=0,a=r.length;o<a;o++){const l=r[o];Ene(this,l)}this._normalizeDeltaIfNecessary(),PBe(this,e,e+t,i),this._normalizeDeltaIfNecessary();for(let o=0,a=r.length;o<a;o++){const l=r[o];l.start=l.cachedAbsoluteStart,l.end=l.cachedAbsoluteEnd,RBe(l,e,e+t,i,n),l.maxEnd=l.end,Ine(this,l)}this._normalizeDeltaIfNecessary()}_normalizeDeltaIfNecessary(){this.requestNormalizeDelta&&(this.requestNormalizeDelta=!1,NBe(this))}}function NBe(s){let e=s.root,t=0;for(;e!==Bt;){if(e.left!==Bt&&!fr(e.left)){e=e.left;continue}if(e.right!==Bt&&!fr(e.right)){t+=e.delta,e=e.right;continue}e.start=t+e.start,e.end=t+e.end,e.delta=0,Xm(e),qi(e,!0),qi(e.left,!1),qi(e.right,!1),e===e.parent.right&&(t-=e.parent.delta),e=e.parent}qi(s.root,!1)}function G0(s,e,t,i){return s<t?!0:s>t||i===1?!1:i===2?!0:e}function RBe(s,e,t,i,n){const r=DBe(s),o=r===0||r===2,a=r===1||r===2,l=t-e,c=i,d=Math.min(l,c),u=s.start;let h=!1;const g=s.end;let p=!1;e<=u&&g<=t&&TBe(s)&&(s.start=e,h=!0,s.end=e,p=!0);{const v=n?1:l>0?2:0;!h&&G0(u,o,e,v)&&(h=!0),!p&&G0(g,a,e,v)&&(p=!0)}if(d>0&&!n){const v=l>c?2:0;!h&&G0(u,o,e+d,v)&&(h=!0),!p&&G0(g,a,e+d,v)&&(p=!0)}{const v=n?1:0;!h&&G0(u,o,t,v)&&(s.start=e+c,h=!0),!p&&G0(g,a,t,v)&&(s.end=e+c,p=!0)}const _=c-l;h||(s.start=Math.max(0,u+_)),p||(s.end=Math.max(0,g+_)),s.start>s.end&&(s.end=s.start)}function ABe(s,e,t){let i=s.root,n=0,r=0,o=0,a=0;const l=[];let c=0;for(;i!==Bt;){if(fr(i)){qi(i.left,!1),qi(i.right,!1),i===i.parent.right&&(n-=i.parent.delta),i=i.parent;continue}if(!fr(i.left)){if(r=n+i.maxEnd,r<e){qi(i,!0);continue}if(i.left!==Bt){i=i.left;continue}}if(o=n+i.start,o>t){qi(i,!0);continue}if(a=n+i.end,a>=e&&(i.setCachedOffsets(o,a,0),l[c++]=i),qi(i,!0),i.right!==Bt&&!fr(i.right)){n+=i.delta,i=i.right;continue}}return qi(s.root,!1),l}function PBe(s,e,t,i){let n=s.root,r=0,o=0,a=0;const l=i-(t-e);for(;n!==Bt;){if(fr(n)){qi(n.left,!1),qi(n.right,!1),n===n.parent.right&&(r-=n.parent.delta),Xm(n),n=n.parent;continue}if(!fr(n.left)){if(o=r+n.maxEnd,o<e){qi(n,!0);continue}if(n.left!==Bt){n=n.left;continue}}if(a=r+n.start,a>t){n.start+=l,n.end+=l,n.delta+=l,(n.delta<-1073741824||n.delta>1073741824)&&(s.requestNormalizeDelta=!0),qi(n,!0);continue}if(qi(n,!0),n.right!==Bt&&!fr(n.right)){r+=n.delta,n=n.right;continue}}qi(s.root,!1)}function MBe(s,e){let t=s.root;const i=[];let n=0;for(;t!==Bt;){if(fr(t)){qi(t.left,!1),qi(t.right,!1),t=t.parent;continue}if(t.left!==Bt&&!fr(t.left)){t=t.left;continue}if(t.ownerId===e&&(i[n++]=t),qi(t,!0),t.right!==Bt&&!fr(t.right)){t=t.right;continue}}return qi(s.root,!1),i}function OBe(s){let e=s.root;const t=[];let i=0;for(;e!==Bt;){if(fr(e)){qi(e.left,!1),qi(e.right,!1),e=e.parent;continue}if(e.left!==Bt&&!fr(e.left)){e=e.left;continue}if(e.right!==Bt&&!fr(e.right)){e=e.right;continue}t[i++]=e,qi(e,!0)}return qi(s.root,!1),t}function FBe(s,e,t,i,n){let r=s.root,o=0,a=0,l=0;const c=[];let d=0;for(;r!==Bt;){if(fr(r)){qi(r.left,!1),qi(r.right,!1),r===r.parent.right&&(o-=r.parent.delta),r=r.parent;continue}if(r.left!==Bt&&!fr(r.left)){r=r.left;continue}a=o+r.start,l=o+r.end,r.setCachedOffsets(a,l,i);let u=!0;if(e&&r.ownerId&&r.ownerId!==e&&(u=!1),t&&Pge(r)&&(u=!1),n&&!Mge(r)&&(u=!1),u&&(c[d++]=r),qi(r,!0),r.right!==Bt&&!fr(r.right)){o+=r.delta,r=r.right;continue}}return qi(s.root,!1),c}function VBe(s,e,t,i,n,r,o){let a=s.root,l=0,c=0,d=0,u=0;const h=[];let g=0;for(;a!==Bt;){if(fr(a)){qi(a.left,!1),qi(a.right,!1),a===a.parent.right&&(l-=a.parent.delta),a=a.parent;continue}if(!fr(a.left)){if(c=l+a.maxEnd,c<e){qi(a,!0);continue}if(a.left!==Bt){a=a.left;continue}}if(d=l+a.start,d>t){qi(a,!0);continue}if(u=l+a.end,u>=e){a.setCachedOffsets(d,u,r);let p=!0;i&&a.ownerId&&a.ownerId!==i&&(p=!1),n&&Pge(a)&&(p=!1),o&&!Mge(a)&&(p=!1),p&&(h[g++]=a)}if(qi(a,!0),a.right!==Bt&&!fr(a.right)){l+=a.delta,a=a.right;continue}}return qi(s.root,!1),h}function Ine(s,e){if(s.root===Bt)return e.parent=Bt,e.left=Bt,e.right=Bt,Zi(e,0),s.root=e,s.root;BBe(s,e),vp(e.parent);let t=e;for(;t!==s.root&&zo(t.parent)===1;)if(t.parent===t.parent.parent.left){const i=t.parent.parent.right;zo(i)===1?(Zi(t.parent,0),Zi(i,0),Zi(t.parent.parent,1),t=t.parent.parent):(t===t.parent.right&&(t=t.parent,BL(s,t)),Zi(t.parent,0),Zi(t.parent.parent,1),WL(s,t.parent.parent))}else{const i=t.parent.parent.left;zo(i)===1?(Zi(t.parent,0),Zi(i,0),Zi(t.parent.parent,1),t=t.parent.parent):(t===t.parent.left&&(t=t.parent,WL(s,t)),Zi(t.parent,0),Zi(t.parent.parent,1),BL(s,t.parent.parent))}return Zi(s.root,0),e}function BBe(s,e){let t=0,i=s.root;const n=e.start,r=e.end;for(;;)if(HBe(n,r,i.start+t,i.end+t)<0)if(i.left===Bt){e.start-=t,e.end-=t,e.maxEnd-=t,i.left=e;break}else i=i.left;else if(i.right===Bt){e.start-=t+i.delta,e.end-=t+i.delta,e.maxEnd-=t+i.delta,i.right=e;break}else t+=i.delta,i=i.right;e.parent=i,e.left=Bt,e.right=Bt,Zi(e,1)}function Ene(s,e){let t,i;if(e.left===Bt?(t=e.right,i=e,t.delta+=e.delta,(t.delta<-1073741824||t.delta>1073741824)&&(s.requestNormalizeDelta=!0),t.start+=e.delta,t.end+=e.delta):e.right===Bt?(t=e.left,i=e):(i=WBe(e.right),t=i.right,t.start+=i.delta,t.end+=i.delta,t.delta+=i.delta,(t.delta<-1073741824||t.delta>1073741824)&&(s.requestNormalizeDelta=!0),i.start+=e.delta,i.end+=e.delta,i.delta=e.delta,(i.delta<-1073741824||i.delta>1073741824)&&(s.requestNormalizeDelta=!0)),i===s.root){s.root=t,Zi(t,0),e.detach(),zV(),Xm(t),s.root.parent=Bt;return}const n=zo(i)===1;if(i===i.parent.left?i.parent.left=t:i.parent.right=t,i===e?t.parent=i.parent:(i.parent===e?t.parent=i:t.parent=i.parent,i.left=e.left,i.right=e.right,i.parent=e.parent,Zi(i,zo(e)),e===s.root?s.root=i:e===e.parent.left?e.parent.left=i:e.parent.right=i,i.left!==Bt&&(i.left.parent=i),i.right!==Bt&&(i.right.parent=i)),e.detach(),n){vp(t.parent),i!==e&&(vp(i),vp(i.parent)),zV();return}vp(t),vp(t.parent),i!==e&&(vp(i),vp(i.parent));let r;for(;t!==s.root&&zo(t)===0;)t===t.parent.left?(r=t.parent.right,zo(r)===1&&(Zi(r,0),Zi(t.parent,1),BL(s,t.parent),r=t.parent.right),zo(r.left)===0&&zo(r.right)===0?(Zi(r,1),t=t.parent):(zo(r.right)===0&&(Zi(r.left,0),Zi(r,1),WL(s,r),r=t.parent.right),Zi(r,zo(t.parent)),Zi(t.parent,0),Zi(r.right,0),BL(s,t.parent),t=s.root)):(r=t.parent.left,zo(r)===1&&(Zi(r,0),Zi(t.parent,1),WL(s,t.parent),r=t.parent.left),zo(r.left)===0&&zo(r.right)===0?(Zi(r,1),t=t.parent):(zo(r.left)===0&&(Zi(r.right,0),Zi(r,1),BL(s,r),r=t.parent.left),Zi(r,zo(t.parent)),Zi(t.parent,0),Zi(r.left,0),WL(s,t.parent),t=s.root));Zi(t,0),zV()}function WBe(s){for(;s.left!==Bt;)s=s.left;return s}function zV(){Bt.parent=Bt,Bt.delta=0,Bt.start=0,Bt.end=0}function BL(s,e){const t=e.right;t.delta+=e.delta,(t.delta<-1073741824||t.delta>1073741824)&&(s.requestNormalizeDelta=!0),t.start+=e.delta,t.end+=e.delta,e.right=t.left,t.left!==Bt&&(t.left.parent=e),t.parent=e.parent,e.parent===Bt?s.root=t:e===e.parent.left?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t,Xm(e),Xm(t)}function WL(s,e){const t=e.left;e.delta-=t.delta,(e.delta<-1073741824||e.delta>1073741824)&&(s.requestNormalizeDelta=!0),e.start-=t.delta,e.end-=t.delta,e.left=t.right,t.right!==Bt&&(t.right.parent=e),t.parent=e.parent,e.parent===Bt?s.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t,Xm(e),Xm(t)}function Fge(s){let e=s.end;if(s.left!==Bt){const t=s.left.maxEnd;t>e&&(e=t)}if(s.right!==Bt){const t=s.right.maxEnd+s.delta;t>e&&(e=t)}return e}function Xm(s){s.maxEnd=Fge(s)}function vp(s){for(;s!==Bt;){const e=Fge(s);if(s.maxEnd===e)return;s.maxEnd=e,s=s.parent}}function HBe(s,e,t,i){return s===t?e-i:s-t}class D8{constructor(e,t){this.piece=e,this.color=t,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==St)return qK(this.right);let e=this;for(;e.parent!==St&&e.parent.left!==e;)e=e.parent;return e.parent===St?St:e.parent}prev(){if(this.left!==St)return Vge(this.left);let e=this;for(;e.parent!==St&&e.parent.right!==e;)e=e.parent;return e.parent===St?St:e.parent}detach(){this.parent=null,this.left=null,this.right=null}}const St=new D8(null,0);St.parent=St;St.left=St;St.right=St;St.color=0;function qK(s){for(;s.left!==St;)s=s.left;return s}function Vge(s){for(;s.right!==St;)s=s.right;return s}function KK(s){return s===St?0:s.size_left+s.piece.length+KK(s.right)}function GK(s){return s===St?0:s.lf_left+s.piece.lineFeedCnt+GK(s.right)}function UV(){St.parent=St}function HL(s,e){const t=e.right;t.size_left+=e.size_left+(e.piece?e.piece.length:0),t.lf_left+=e.lf_left+(e.piece?e.piece.lineFeedCnt:0),e.right=t.left,t.left!==St&&(t.left.parent=e),t.parent=e.parent,e.parent===St?s.root=t:e.parent.left===e?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t}function zL(s,e){const t=e.left;e.left=t.right,t.right!==St&&(t.right.parent=e),t.parent=e.parent,e.size_left-=t.size_left+(t.piece?t.piece.length:0),e.lf_left-=t.lf_left+(t.piece?t.piece.lineFeedCnt:0),e.parent===St?s.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t}function CN(s,e){let t,i;if(e.left===St?(i=e,t=i.right):e.right===St?(i=e,t=i.left):(i=qK(e.right),t=i.right),i===s.root){s.root=t,t.color=0,e.detach(),UV(),s.root.parent=St;return}const n=i.color===1;if(i===i.parent.left?i.parent.left=t:i.parent.right=t,i===e?(t.parent=i.parent,oL(s,t)):(i.parent===e?t.parent=i:t.parent=i.parent,oL(s,t),i.left=e.left,i.right=e.right,i.parent=e.parent,i.color=e.color,e===s.root?s.root=i:e===e.parent.left?e.parent.left=i:e.parent.right=i,i.left!==St&&(i.left.parent=i),i.right!==St&&(i.right.parent=i),i.size_left=e.size_left,i.lf_left=e.lf_left,oL(s,i)),e.detach(),t.parent.left===t){const o=KK(t),a=GK(t);if(o!==t.parent.size_left||a!==t.parent.lf_left){const l=o-t.parent.size_left,c=a-t.parent.lf_left;t.parent.size_left=o,t.parent.lf_left=a,_f(s,t.parent,l,c)}}if(oL(s,t.parent),n){UV();return}let r;for(;t!==s.root&&t.color===0;)t===t.parent.left?(r=t.parent.right,r.color===1&&(r.color=0,t.parent.color=1,HL(s,t.parent),r=t.parent.right),r.left.color===0&&r.right.color===0?(r.color=1,t=t.parent):(r.right.color===0&&(r.left.color=0,r.color=1,zL(s,r),r=t.parent.right),r.color=t.parent.color,t.parent.color=0,r.right.color=0,HL(s,t.parent),t=s.root)):(r=t.parent.left,r.color===1&&(r.color=0,t.parent.color=1,zL(s,t.parent),r=t.parent.left),r.left.color===0&&r.right.color===0?(r.color=1,t=t.parent):(r.left.color===0&&(r.right.color=0,r.color=1,HL(s,r),r=t.parent.left),r.color=t.parent.color,t.parent.color=0,r.left.color=0,zL(s,t.parent),t=s.root));t.color=0,UV()}function Dne(s,e){for(oL(s,e);e!==s.root&&e.parent.color===1;)if(e.parent===e.parent.parent.left){const t=e.parent.parent.right;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.right&&(e=e.parent,HL(s,e)),e.parent.color=0,e.parent.parent.color=1,zL(s,e.parent.parent))}else{const t=e.parent.parent.left;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.left&&(e=e.parent,zL(s,e)),e.parent.color=0,e.parent.parent.color=1,HL(s,e.parent.parent))}s.root.color=0}function _f(s,e,t,i){for(;e!==s.root&&e!==St;)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=i),e=e.parent}function oL(s,e){let t=0,i=0;if(e!==s.root){for(;e!==s.root&&e===e.parent.right;)e=e.parent;if(e!==s.root)for(e=e.parent,t=KK(e.left)-e.size_left,i=GK(e.left)-e.lf_left,e.size_left+=t,e.lf_left+=i;e!==s.root&&(t!==0||i!==0);)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=i),e=e.parent}}const hf=65535;function Bge(s){let e;return s[s.length-1]<65536?e=new Uint16Array(s.length):e=new Uint32Array(s.length),e.set(s,0),e}class zBe{constructor(e,t,i,n,r){this.lineStarts=e,this.cr=t,this.lf=i,this.crlf=n,this.isBasicASCII=r}}function bf(s,e=!0){const t=[0];let i=1;for(let n=0,r=s.length;n<r;n++){const o=s.charCodeAt(n);o===13?n+1<r&&s.charCodeAt(n+1)===10?(t[i++]=n+2,n++):t[i++]=n+1:o===10&&(t[i++]=n+1)}return e?Bge(t):t}function UBe(s,e){s.length=0,s[0]=0;let t=1,i=0,n=0,r=0,o=!0;for(let l=0,c=e.length;l<c;l++){const d=e.charCodeAt(l);d===13?l+1<c&&e.charCodeAt(l+1)===10?(r++,s[t++]=l+2,l++):(i++,s[t++]=l+1):d===10?(n++,s[t++]=l+1):o&&d!==9&&(d<32||d>126)&&(o=!1)}const a=new zBe(Bge(s),i,n,r,o);return s.length=0,a}class ba{constructor(e,t,i,n,r){this.bufferIndex=e,this.start=t,this.end=i,this.lineFeedCnt=n,this.length=r}}class yb{constructor(e,t){this.buffer=e,this.lineStarts=t}}class jBe{constructor(e,t){this._pieces=[],this._tree=e,this._BOM=t,this._index=0,e.root!==St&&e.iterate(e.root,i=>(i!==St&&this._pieces.push(i.piece),!0))}read(){return this._pieces.length===0?this._index===0?(this._index++,this._BOM):null:this._index>this._pieces.length-1?null:this._index===0?this._BOM+this._tree.getPieceContent(this._pieces[this._index++]):this._tree.getPieceContent(this._pieces[this._index++])}}class $Be{constructor(e){this._limit=e,this._cache=[]}get(e){for(let t=this._cache.length-1;t>=0;t--){const i=this._cache[t];if(i.nodeStartOffset<=e&&i.nodeStartOffset+i.node.piece.length>=e)return i}return null}get2(e){for(let t=this._cache.length-1;t>=0;t--){const i=this._cache[t];if(i.nodeStartLineNumber&&i.nodeStartLineNumber<e&&i.nodeStartLineNumber+i.node.piece.lineFeedCnt>=e)return i}return null}set(e){this._cache.length>=this._limit&&this._cache.shift(),this._cache.push(e)}validate(e){let t=!1;const i=this._cache;for(let n=0;n<i.length;n++){const r=i[n];if(r.node.parent===null||r.nodeStartOffset>=e){i[n]=null,t=!0;continue}}if(t){const n=[];for(const r of i)r!==null&&n.push(r);this._cache=n}}}class qBe{constructor(e,t,i){this.create(e,t,i)}create(e,t,i){this._buffers=[new yb("",[0])],this._lastChangeBufferPos={line:0,column:0},this.root=St,this._lineCnt=1,this._length=0,this._EOL=t,this._EOLLength=t.length,this._EOLNormalized=i;let n=null;for(let r=0,o=e.length;r<o;r++)if(e[r].buffer.length>0){e[r].lineStarts||(e[r].lineStarts=bf(e[r].buffer));const a=new ba(r+1,{line:0,column:0},{line:e[r].lineStarts.length-1,column:e[r].buffer.length-e[r].lineStarts[e[r].lineStarts.length-1]},e[r].lineStarts.length-1,e[r].buffer.length);this._buffers.push(e[r]),n=this.rbInsertRight(n,a)}this._searchCache=new $Be(1),this._lastVisitedLine={lineNumber:0,value:""},this.computeBufferMetadata()}normalizeEOL(e){const t=hf,i=t-Math.floor(t/3),n=i*2;let r="",o=0;const a=[];if(this.iterate(this.root,l=>{const c=this.getNodeContent(l),d=c.length;if(o<=i||o+d<n)return r+=c,o+=d,!0;const u=r.replace(/\r\n|\r|\n/g,e);return a.push(new yb(u,bf(u))),r=c,o=d,!0}),o>0){const l=r.replace(/\r\n|\r|\n/g,e);a.push(new yb(l,bf(l)))}this.create(a,e,!0)}getEOL(){return this._EOL}setEOL(e){this._EOL=e,this._EOLLength=this._EOL.length,this.normalizeEOL(e)}createSnapshot(e){return new jBe(this,e)}getOffsetAt(e,t){let i=0,n=this.root;for(;n!==St;)if(n.left!==St&&n.lf_left+1>=e)n=n.left;else if(n.lf_left+n.piece.lineFeedCnt+1>=e){i+=n.size_left;const r=this.getAccumulatedValue(n,e-n.lf_left-2);return i+=r+t-1}else e-=n.lf_left+n.piece.lineFeedCnt,i+=n.size_left+n.piece.length,n=n.right;return i}getPositionAt(e){e=Math.floor(e),e=Math.max(0,e);let t=this.root,i=0;const n=e;for(;t!==St;)if(t.size_left!==0&&t.size_left>=e)t=t.left;else if(t.size_left+t.piece.length>=e){const r=this.getIndexOf(t,e-t.size_left);if(i+=t.lf_left+r.index,r.index===0){const o=this.getOffsetAt(i+1,1),a=n-o;return new X(i+1,a+1)}return new X(i+1,r.remainder+1)}else if(e-=t.size_left+t.piece.length,i+=t.lf_left+t.piece.lineFeedCnt,t.right===St){const r=this.getOffsetAt(i+1,1),o=n-e-r;return new X(i+1,o+1)}else t=t.right;return new X(1,1)}getValueInRange(e,t){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return"";const i=this.nodeAt2(e.startLineNumber,e.startColumn),n=this.nodeAt2(e.endLineNumber,e.endColumn),r=this.getValueInRange2(i,n);return t?t!==this._EOL||!this._EOLNormalized?r.replace(/\r\n|\r|\n/g,t):t===this.getEOL()&&this._EOLNormalized?r:r.replace(/\r\n|\r|\n/g,t):r}getValueInRange2(e,t){if(e.node===t.node){const a=e.node,l=this._buffers[a.piece.bufferIndex].buffer,c=this.offsetInBuffer(a.piece.bufferIndex,a.piece.start);return l.substring(c+e.remainder,c+t.remainder)}let i=e.node;const n=this._buffers[i.piece.bufferIndex].buffer,r=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);let o=n.substring(r+e.remainder,r+i.piece.length);for(i=i.next();i!==St;){const a=this._buffers[i.piece.bufferIndex].buffer,l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(i===t.node){o+=a.substring(l,l+t.remainder);break}else o+=a.substr(l,i.piece.length);i=i.next()}return o}getLinesContent(){const e=[];let t=0,i="",n=!1;return this.iterate(this.root,r=>{if(r===St)return!0;const o=r.piece;let a=o.length;if(a===0)return!0;const l=this._buffers[o.bufferIndex].buffer,c=this._buffers[o.bufferIndex].lineStarts,d=o.start.line,u=o.end.line;let h=c[d]+o.start.column;if(n&&(l.charCodeAt(h)===10&&(h++,a--),e[t++]=i,i="",n=!1,a===0))return!0;if(d===u)return!this._EOLNormalized&&l.charCodeAt(h+a-1)===13?(n=!0,i+=l.substr(h,a-1)):i+=l.substr(h,a),!0;i+=this._EOLNormalized?l.substring(h,Math.max(h,c[d+1]-this._EOLLength)):l.substring(h,c[d+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;for(let g=d+1;g<u;g++)i=this._EOLNormalized?l.substring(c[g],c[g+1]-this._EOLLength):l.substring(c[g],c[g+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;return!this._EOLNormalized&&l.charCodeAt(c[u]+o.end.column-1)===13?(n=!0,o.end.column===0?t--:i=l.substr(c[u],o.end.column-1)):i=l.substr(c[u],o.end.column),!0}),n&&(e[t++]=i,i=""),e[t++]=i,e}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(e){return this._lastVisitedLine.lineNumber===e?this._lastVisitedLine.value:(this._lastVisitedLine.lineNumber=e,e===this._lineCnt?this._lastVisitedLine.value=this.getLineRawContent(e):this._EOLNormalized?this._lastVisitedLine.value=this.getLineRawContent(e,this._EOLLength):this._lastVisitedLine.value=this.getLineRawContent(e).replace(/(\r\n|\r|\n)$/,""),this._lastVisitedLine.value)}_getCharCode(e){if(e.remainder===e.node.piece.length){const t=e.node.next();if(!t)return 0;const i=this._buffers[t.piece.bufferIndex],n=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start);return i.buffer.charCodeAt(n)}else{const t=this._buffers[e.node.piece.bufferIndex],n=this.offsetInBuffer(e.node.piece.bufferIndex,e.node.piece.start)+e.remainder;return t.buffer.charCodeAt(n)}}getLineCharCode(e,t){const i=this.nodeAt2(e,t+1);return this._getCharCode(i)}getLineLength(e){if(e===this.getLineCount()){const t=this.getOffsetAt(e,1);return this.getLength()-t}return this.getOffsetAt(e+1,1)-this.getOffsetAt(e,1)-this._EOLLength}findMatchesInNode(e,t,i,n,r,o,a,l,c,d,u){const h=this._buffers[e.piece.bufferIndex],g=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start),p=this.offsetInBuffer(e.piece.bufferIndex,r),_=this.offsetInBuffer(e.piece.bufferIndex,o);let v;const C={line:0,column:0};let y,x;t._wordSeparators?(y=h.buffer.substring(p,_),x=L=>L+p,t.reset(0)):(y=h.buffer,x=L=>L,t.reset(p));do if(v=t.next(y),v){if(x(v.index)>=_)return d;this.positionInBuffer(e,x(v.index)-g,C);const L=this.getLineFeedCnt(e.piece.bufferIndex,r,C),I=C.line===r.line?C.column-r.column+n:C.column+1,A=I+v[0].length;if(u[d++]=mb(new F(i+L,I,i+L,A),v,l),x(v.index)+v[0].length>=_||d>=c)return d}while(v);return d}findMatchesLineByLine(e,t,i,n){const r=[];let o=0;const a=new kC(t.wordSeparators,t.regex);let l=this.nodeAt2(e.startLineNumber,e.startColumn);if(l===null)return[];const c=this.nodeAt2(e.endLineNumber,e.endColumn);if(c===null)return[];let d=this.positionInBuffer(l.node,l.remainder);const u=this.positionInBuffer(c.node,c.remainder);if(l.node===c.node)return this.findMatchesInNode(l.node,a,e.startLineNumber,e.startColumn,d,u,t,i,n,o,r),r;let h=e.startLineNumber,g=l.node;for(;g!==c.node;){const _=this.getLineFeedCnt(g.piece.bufferIndex,d,g.piece.end);if(_>=1){const C=this._buffers[g.piece.bufferIndex].lineStarts,y=this.offsetInBuffer(g.piece.bufferIndex,g.piece.start),x=C[d.line+_],L=h===e.startLineNumber?e.startColumn:1;if(o=this.findMatchesInNode(g,a,h,L,d,this.positionInBuffer(g,x-y),t,i,n,o,r),o>=n)return r;h+=_}const v=h===e.startLineNumber?e.startColumn-1:0;if(h===e.endLineNumber){const C=this.getLineContent(h).substring(v,e.endColumn-1);return o=this._findMatchesInLine(t,a,C,e.endLineNumber,v,o,r,i,n),r}if(o=this._findMatchesInLine(t,a,this.getLineContent(h).substr(v),h,v,o,r,i,n),o>=n)return r;h++,l=this.nodeAt2(h,1),g=l.node,d=this.positionInBuffer(l.node,l.remainder)}if(h===e.endLineNumber){const _=h===e.startLineNumber?e.startColumn-1:0,v=this.getLineContent(h).substring(_,e.endColumn-1);return o=this._findMatchesInLine(t,a,v,e.endLineNumber,_,o,r,i,n),r}const p=h===e.startLineNumber?e.startColumn:1;return o=this.findMatchesInNode(c.node,a,h,p,d,u,t,i,n,o,r),r}_findMatchesInLine(e,t,i,n,r,o,a,l,c){const d=e.wordSeparators;if(!l&&e.simpleSearch){const h=e.simpleSearch,g=h.length,p=i.length;let _=-g;for(;(_=i.indexOf(h,_+g))!==-1;)if((!d||Qq(d,i,p,_,g))&&(a[o++]=new rI(new F(n,_+1+r,n,_+1+g+r),null),o>=c))return o;return o}let u;t.reset(0);do if(u=t.next(i),u&&(a[o++]=mb(new F(n,u.index+1+r,n,u.index+1+u[0].length+r),u,l),o>=c))return o;while(u);return o}insert(e,t,i=!1){if(this._EOLNormalized=this._EOLNormalized&&i,this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",this.root!==St){const{node:n,remainder:r,nodeStartOffset:o}=this.nodeAt(e),a=n.piece,l=a.bufferIndex,c=this.positionInBuffer(n,r);if(n.piece.bufferIndex===0&&a.end.line===this._lastChangeBufferPos.line&&a.end.column===this._lastChangeBufferPos.column&&o+a.length===e&&t.length<hf){this.appendToNode(n,t),this.computeBufferMetadata();return}if(o===e)this.insertContentToNodeLeft(t,n),this._searchCache.validate(e);else if(o+n.piece.length>e){const d=[];let u=new ba(a.bufferIndex,c,a.end,this.getLineFeedCnt(a.bufferIndex,c,a.end),this.offsetInBuffer(l,a.end)-this.offsetInBuffer(l,c));if(this.shouldCheckCRLF()&&this.endWithCR(t)&&this.nodeCharCodeAt(n,r)===10){const _={line:u.start.line+1,column:0};u=new ba(u.bufferIndex,_,u.end,this.getLineFeedCnt(u.bufferIndex,_,u.end),u.length-1),t+=`
`}if(this.shouldCheckCRLF()&&this.startWithLF(t))if(this.nodeCharCodeAt(n,r-1)===13){const _=this.positionInBuffer(n,r-1);this.deleteNodeTail(n,_),t="\r"+t,n.piece.length===0&&d.push(n)}else this.deleteNodeTail(n,c);else this.deleteNodeTail(n,c);const h=this.createNewPieces(t);u.length>0&&this.rbInsertRight(n,u);let g=n;for(let p=0;p<h.length;p++)g=this.rbInsertRight(g,h[p]);this.deleteNodes(d)}else this.insertContentToNodeRight(t,n)}else{const n=this.createNewPieces(t);let r=this.rbInsertLeft(null,n[0]);for(let o=1;o<n.length;o++)r=this.rbInsertRight(r,n[o])}this.computeBufferMetadata()}delete(e,t){if(this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",t<=0||this.root===St)return;const i=this.nodeAt(e),n=this.nodeAt(e+t),r=i.node,o=n.node;if(r===o){const h=this.positionInBuffer(r,i.remainder),g=this.positionInBuffer(r,n.remainder);if(i.nodeStartOffset===e){if(t===r.piece.length){const p=r.next();CN(this,r),this.validateCRLFWithPrevNode(p),this.computeBufferMetadata();return}this.deleteNodeHead(r,g),this._searchCache.validate(e),this.validateCRLFWithPrevNode(r),this.computeBufferMetadata();return}if(i.nodeStartOffset+r.piece.length===e+t){this.deleteNodeTail(r,h),this.validateCRLFWithNextNode(r),this.computeBufferMetadata();return}this.shrinkNode(r,h,g),this.computeBufferMetadata();return}const a=[],l=this.positionInBuffer(r,i.remainder);this.deleteNodeTail(r,l),this._searchCache.validate(e),r.piece.length===0&&a.push(r);const c=this.positionInBuffer(o,n.remainder);this.deleteNodeHead(o,c),o.piece.length===0&&a.push(o);const d=r.next();for(let h=d;h!==St&&h!==o;h=h.next())a.push(h);const u=r.piece.length===0?r.prev():r;this.deleteNodes(a),this.validateCRLFWithNextNode(u),this.computeBufferMetadata()}insertContentToNodeLeft(e,t){const i=[];if(this.shouldCheckCRLF()&&this.endWithCR(e)&&this.startWithLF(t)){const o=t.piece,a={line:o.start.line+1,column:0},l=new ba(o.bufferIndex,a,o.end,this.getLineFeedCnt(o.bufferIndex,a,o.end),o.length-1);t.piece=l,e+=`
`,_f(this,t,-1,-1),t.piece.length===0&&i.push(t)}const n=this.createNewPieces(e);let r=this.rbInsertLeft(t,n[n.length-1]);for(let o=n.length-2;o>=0;o--)r=this.rbInsertLeft(r,n[o]);this.validateCRLFWithPrevNode(r),this.deleteNodes(i)}insertContentToNodeRight(e,t){this.adjustCarriageReturnFromNext(e,t)&&(e+=`
`);const i=this.createNewPieces(e),n=this.rbInsertRight(t,i[0]);let r=n;for(let o=1;o<i.length;o++)r=this.rbInsertRight(r,i[o]);this.validateCRLFWithPrevNode(n)}positionInBuffer(e,t,i){const n=e.piece,r=e.piece.bufferIndex,o=this._buffers[r].lineStarts,l=o[n.start.line]+n.start.column+t;let c=n.start.line,d=n.end.line,u=0,h=0,g=0;for(;c<=d&&(u=c+(d-c)/2|0,g=o[u],u!==d);)if(h=o[u+1],l<g)d=u-1;else if(l>=h)c=u+1;else break;return i?(i.line=u,i.column=l-g,null):{line:u,column:l-g}}getLineFeedCnt(e,t,i){if(i.column===0)return i.line-t.line;const n=this._buffers[e].lineStarts;if(i.line===n.length-1)return i.line-t.line;const r=n[i.line+1],o=n[i.line]+i.column;if(r>o+1)return i.line-t.line;const a=o-1;return this._buffers[e].buffer.charCodeAt(a)===13?i.line-t.line+1:i.line-t.line}offsetInBuffer(e,t){return this._buffers[e].lineStarts[t.line]+t.column}deleteNodes(e){for(let t=0;t<e.length;t++)CN(this,e[t])}createNewPieces(e){if(e.length>hf){const d=[];for(;e.length>hf;){const h=e.charCodeAt(hf-1);let g;h===13||h>=55296&&h<=56319?(g=e.substring(0,hf-1),e=e.substring(hf-1)):(g=e.substring(0,hf),e=e.substring(hf));const p=bf(g);d.push(new ba(this._buffers.length,{line:0,column:0},{line:p.length-1,column:g.length-p[p.length-1]},p.length-1,g.length)),this._buffers.push(new yb(g,p))}const u=bf(e);return d.push(new ba(this._buffers.length,{line:0,column:0},{line:u.length-1,column:e.length-u[u.length-1]},u.length-1,e.length)),this._buffers.push(new yb(e,u)),d}let t=this._buffers[0].buffer.length;const i=bf(e,!1);let n=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===t&&t!==0&&this.startWithLF(e)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1},n=this._lastChangeBufferPos;for(let d=0;d<i.length;d++)i[d]+=t+1;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+="_"+e,t+=1}else{if(t!==0)for(let d=0;d<i.length;d++)i[d]+=t;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+=e}const r=this._buffers[0].buffer.length,o=this._buffers[0].lineStarts.length-1,a=r-this._buffers[0].lineStarts[o],l={line:o,column:a},c=new ba(0,n,l,this.getLineFeedCnt(0,n,l),r-t);return this._lastChangeBufferPos=l,[c]}getLineRawContent(e,t=0){let i=this.root,n="";const r=this._searchCache.get2(e);if(r){i=r.node;const o=this.getAccumulatedValue(i,e-r.nodeStartLineNumber-1),a=this._buffers[i.piece.bufferIndex].buffer,l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(r.nodeStartLineNumber+i.piece.lineFeedCnt===e)n=a.substring(l+o,l+i.piece.length);else{const c=this.getAccumulatedValue(i,e-r.nodeStartLineNumber);return a.substring(l+o,l+c-t)}}else{let o=0;const a=e;for(;i!==St;)if(i.left!==St&&i.lf_left>=e-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>e-1){const l=this.getAccumulatedValue(i,e-i.lf_left-2),c=this.getAccumulatedValue(i,e-i.lf_left-1),d=this._buffers[i.piece.bufferIndex].buffer,u=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return o+=i.size_left,this._searchCache.set({node:i,nodeStartOffset:o,nodeStartLineNumber:a-(e-1-i.lf_left)}),d.substring(u+l,u+c-t)}else if(i.lf_left+i.piece.lineFeedCnt===e-1){const l=this.getAccumulatedValue(i,e-i.lf_left-2),c=this._buffers[i.piece.bufferIndex].buffer,d=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);n=c.substring(d+l,d+i.piece.length);break}else e-=i.lf_left+i.piece.lineFeedCnt,o+=i.size_left+i.piece.length,i=i.right}for(i=i.next();i!==St;){const o=this._buffers[i.piece.bufferIndex].buffer;if(i.piece.lineFeedCnt>0){const a=this.getAccumulatedValue(i,0),l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return n+=o.substring(l,l+a-t),n}else{const a=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);n+=o.substr(a,i.piece.length)}i=i.next()}return n}computeBufferMetadata(){let e=this.root,t=1,i=0;for(;e!==St;)t+=e.lf_left+e.piece.lineFeedCnt,i+=e.size_left+e.piece.length,e=e.right;this._lineCnt=t,this._length=i,this._searchCache.validate(this._length)}getIndexOf(e,t){const i=e.piece,n=this.positionInBuffer(e,t),r=n.line-i.start.line;if(this.offsetInBuffer(i.bufferIndex,i.end)-this.offsetInBuffer(i.bufferIndex,i.start)===t){const o=this.getLineFeedCnt(e.piece.bufferIndex,i.start,n);if(o!==r)return{index:o,remainder:0}}return{index:r,remainder:n.column}}getAccumulatedValue(e,t){if(t<0)return 0;const i=e.piece,n=this._buffers[i.bufferIndex].lineStarts,r=i.start.line+t+1;return r>i.end.line?n[i.end.line]+i.end.column-n[i.start.line]-i.start.column:n[r]-n[i.start.line]-i.start.column}deleteNodeTail(e,t){const i=e.piece,n=i.lineFeedCnt,r=this.offsetInBuffer(i.bufferIndex,i.end),o=t,a=this.offsetInBuffer(i.bufferIndex,o),l=this.getLineFeedCnt(i.bufferIndex,i.start,o),c=l-n,d=a-r,u=i.length+d;e.piece=new ba(i.bufferIndex,i.start,o,l,u),_f(this,e,d,c)}deleteNodeHead(e,t){const i=e.piece,n=i.lineFeedCnt,r=this.offsetInBuffer(i.bufferIndex,i.start),o=t,a=this.getLineFeedCnt(i.bufferIndex,o,i.end),l=this.offsetInBuffer(i.bufferIndex,o),c=a-n,d=r-l,u=i.length+d;e.piece=new ba(i.bufferIndex,o,i.end,a,u),_f(this,e,d,c)}shrinkNode(e,t,i){const n=e.piece,r=n.start,o=n.end,a=n.length,l=n.lineFeedCnt,c=t,d=this.getLineFeedCnt(n.bufferIndex,n.start,c),u=this.offsetInBuffer(n.bufferIndex,t)-this.offsetInBuffer(n.bufferIndex,r);e.piece=new ba(n.bufferIndex,n.start,c,d,u),_f(this,e,u-a,d-l);const h=new ba(n.bufferIndex,i,o,this.getLineFeedCnt(n.bufferIndex,i,o),this.offsetInBuffer(n.bufferIndex,o)-this.offsetInBuffer(n.bufferIndex,i)),g=this.rbInsertRight(e,h);this.validateCRLFWithPrevNode(g)}appendToNode(e,t){this.adjustCarriageReturnFromNext(t,e)&&(t+=`
`);const i=this.shouldCheckCRLF()&&this.startWithLF(t)&&this.endWithCR(e),n=this._buffers[0].buffer.length;this._buffers[0].buffer+=t;const r=bf(t,!1);for(let g=0;g<r.length;g++)r[g]+=n;if(i){const g=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop(),this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:n-g}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(r.slice(1));const o=this._buffers[0].lineStarts.length-1,a=this._buffers[0].buffer.length-this._buffers[0].lineStarts[o],l={line:o,column:a},c=e.piece.length+t.length,d=e.piece.lineFeedCnt,u=this.getLineFeedCnt(0,e.piece.start,l),h=u-d;e.piece=new ba(e.piece.bufferIndex,e.piece.start,l,u,c),this._lastChangeBufferPos=l,_f(this,e,t.length,h)}nodeAt(e){let t=this.root;const i=this._searchCache.get(e);if(i)return{node:i.node,nodeStartOffset:i.nodeStartOffset,remainder:e-i.nodeStartOffset};let n=0;for(;t!==St;)if(t.size_left>e)t=t.left;else if(t.size_left+t.piece.length>=e){n+=t.size_left;const r={node:t,remainder:e-t.size_left,nodeStartOffset:n};return this._searchCache.set(r),r}else e-=t.size_left+t.piece.length,n+=t.size_left+t.piece.length,t=t.right;return null}nodeAt2(e,t){let i=this.root,n=0;for(;i!==St;)if(i.left!==St&&i.lf_left>=e-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>e-1){const r=this.getAccumulatedValue(i,e-i.lf_left-2),o=this.getAccumulatedValue(i,e-i.lf_left-1);return n+=i.size_left,{node:i,remainder:Math.min(r+t-1,o),nodeStartOffset:n}}else if(i.lf_left+i.piece.lineFeedCnt===e-1){const r=this.getAccumulatedValue(i,e-i.lf_left-2);if(r+t-1<=i.piece.length)return{node:i,remainder:r+t-1,nodeStartOffset:n};t-=i.piece.length-r;break}else e-=i.lf_left+i.piece.lineFeedCnt,n+=i.size_left+i.piece.length,i=i.right;for(i=i.next();i!==St;){if(i.piece.lineFeedCnt>0){const r=this.getAccumulatedValue(i,0),o=this.offsetOfNode(i);return{node:i,remainder:Math.min(t-1,r),nodeStartOffset:o}}else if(i.piece.length>=t-1){const r=this.offsetOfNode(i);return{node:i,remainder:t-1,nodeStartOffset:r}}else t-=i.piece.length;i=i.next()}return null}nodeCharCodeAt(e,t){if(e.piece.lineFeedCnt<1)return-1;const i=this._buffers[e.piece.bufferIndex],n=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start)+t;return i.buffer.charCodeAt(n)}offsetOfNode(e){if(!e)return 0;let t=e.size_left;for(;e!==this.root;)e.parent.right===e&&(t+=e.parent.size_left+e.parent.piece.length),e=e.parent;return t}shouldCheckCRLF(){return!(this._EOLNormalized&&this._EOL===`
`)}startWithLF(e){if(typeof e=="string")return e.charCodeAt(0)===10;if(e===St||e.piece.lineFeedCnt===0)return!1;const t=e.piece,i=this._buffers[t.bufferIndex].lineStarts,n=t.start.line,r=i[n]+t.start.column;return n===i.length-1||i[n+1]>r+1?!1:this._buffers[t.bufferIndex].buffer.charCodeAt(r)===10}endWithCR(e){return typeof e=="string"?e.charCodeAt(e.length-1)===13:e===St||e.piece.lineFeedCnt===0?!1:this.nodeCharCodeAt(e,e.piece.length-1)===13}validateCRLFWithPrevNode(e){if(this.shouldCheckCRLF()&&this.startWithLF(e)){const t=e.prev();this.endWithCR(t)&&this.fixCRLF(t,e)}}validateCRLFWithNextNode(e){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const t=e.next();this.startWithLF(t)&&this.fixCRLF(e,t)}}fixCRLF(e,t){const i=[],n=this._buffers[e.piece.bufferIndex].lineStarts;let r;e.piece.end.column===0?r={line:e.piece.end.line-1,column:n[e.piece.end.line]-n[e.piece.end.line-1]-1}:r={line:e.piece.end.line,column:e.piece.end.column-1};const o=e.piece.length-1,a=e.piece.lineFeedCnt-1;e.piece=new ba(e.piece.bufferIndex,e.piece.start,r,a,o),_f(this,e,-1,-1),e.piece.length===0&&i.push(e);const l={line:t.piece.start.line+1,column:0},c=t.piece.length-1,d=this.getLineFeedCnt(t.piece.bufferIndex,l,t.piece.end);t.piece=new ba(t.piece.bufferIndex,l,t.piece.end,d,c),_f(this,t,-1,-1),t.piece.length===0&&i.push(t);const u=this.createNewPieces(`\r
`);this.rbInsertRight(e,u[0]);for(let h=0;h<i.length;h++)CN(this,i[h])}adjustCarriageReturnFromNext(e,t){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const i=t.next();if(this.startWithLF(i)){if(e+=`
`,i.piece.length===1)CN(this,i);else{const n=i.piece,r={line:n.start.line+1,column:0},o=n.length-1,a=this.getLineFeedCnt(n.bufferIndex,r,n.end);i.piece=new ba(n.bufferIndex,r,n.end,a,o),_f(this,i,-1,-1)}return!0}}return!1}iterate(e,t){if(e===St)return t(St);const i=this.iterate(e.left,t);return i&&t(e)&&this.iterate(e.right,t)}getNodeContent(e){if(e===St)return"";const t=this._buffers[e.piece.bufferIndex],i=e.piece,n=this.offsetInBuffer(i.bufferIndex,i.start),r=this.offsetInBuffer(i.bufferIndex,i.end);return t.buffer.substring(n,r)}getPieceContent(e){const t=this._buffers[e.bufferIndex],i=this.offsetInBuffer(e.bufferIndex,e.start),n=this.offsetInBuffer(e.bufferIndex,e.end);return t.buffer.substring(i,n)}rbInsertRight(e,t){const i=new D8(t,1);if(i.left=St,i.right=St,i.parent=St,i.size_left=0,i.lf_left=0,this.root===St)this.root=i,i.color=0;else if(e.right===St)e.right=i,i.parent=e;else{const r=qK(e.right);r.left=i,i.parent=r}return Dne(this,i),i}rbInsertLeft(e,t){const i=new D8(t,1);if(i.left=St,i.right=St,i.parent=St,i.size_left=0,i.lf_left=0,this.root===St)this.root=i,i.color=0;else if(e.left===St)e.left=i,i.parent=e;else{const n=Vge(e.left);n.right=i,i.parent=n}return Dne(this,i),i}}class ky extends te{constructor(e,t,i,n,r,o,a){super(),this._onDidChangeContent=this._register(new Z),this._BOM=t,this._mightContainNonBasicASCII=!o,this._mightContainRTL=n,this._mightContainUnusualLineTerminators=r,this._pieceTree=new qBe(e,i,a)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=!1}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(e){return this._pieceTree.createSnapshot(e?this._BOM:"")}getOffsetAt(e,t){return this._pieceTree.getOffsetAt(e,t)}getPositionAt(e){return this._pieceTree.getPositionAt(e)}getRangeAt(e,t){const i=e+t,n=this.getPositionAt(e),r=this.getPositionAt(i);return new F(n.lineNumber,n.column,r.lineNumber,r.column)}getValueInRange(e,t=0){if(e.isEmpty())return"";const i=this._getEndOfLine(t);return this._pieceTree.getValueInRange(e,i)}getValueLengthInRange(e,t=0){if(e.isEmpty())return 0;if(e.startLineNumber===e.endLineNumber)return e.endColumn-e.startColumn;const i=this.getOffsetAt(e.startLineNumber,e.startColumn),n=this.getOffsetAt(e.endLineNumber,e.endColumn);let r=0;const o=this._getEndOfLine(t),a=this.getEOL();if(o.length!==a.length){const l=o.length-a.length,c=e.endLineNumber-e.startLineNumber;r=l*c}return n-i+r}getCharacterCountInRange(e,t=0){if(this._mightContainNonBasicASCII){let i=0;const n=e.startLineNumber,r=e.endLineNumber;for(let o=n;o<=r;o++){const a=this.getLineContent(o),l=o===n?e.startColumn-1:0,c=o===r?e.endColumn-1:a.length;for(let d=l;d<c;d++)ws(a.charCodeAt(d))?(i=i+1,d=d+1):i=i+1}return i+=this._getEndOfLine(t).length*(r-n),i}return this.getValueLengthInRange(e,t)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(e){return this._pieceTree.getLineContent(e)}getLineCharCode(e,t){return this._pieceTree.getLineCharCode(e,t)}getLineLength(e){return this._pieceTree.getLineLength(e)}getLineFirstNonWhitespaceColumn(e){const t=Zr(this.getLineContent(e));return t===-1?0:t+1}getLineLastNonWhitespaceColumn(e){const t=nu(this.getLineContent(e));return t===-1?0:t+2}_getEndOfLine(e){switch(e){case 1:return`
`;case 2:return`\r
`;case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(e){this._pieceTree.setEOL(e)}applyEdits(e,t,i){let n=this._mightContainRTL,r=this._mightContainUnusualLineTerminators,o=this._mightContainNonBasicASCII,a=!0,l=[];for(let _=0;_<e.length;_++){const v=e[_];a&&v._isTracked&&(a=!1);const C=v.range;if(v.text){let A=!0;o||(A=!zE(v.text),o=A),!n&&A&&(n=h1(v.text)),!r&&A&&(r=Rue(v.text))}let y="",x=0,L=0,I=0;if(v.text){let A;[x,L,I,A]=Gm(v.text);const D=this.getEOL();A===0||A===(D===`\r
`?2:1)?y=v.text:y=v.text.replace(/\r\n|\r|\n/g,D)}l[_]={sortIndex:_,identifier:v.identifier||null,range:C,rangeOffset:this.getOffsetAt(C.startLineNumber,C.startColumn),rangeLength:this.getValueLengthInRange(C),text:y,eolCount:x,firstLineLength:L,lastLineLength:I,forceMoveMarkers:!!v.forceMoveMarkers,isAutoWhitespaceEdit:v.isAutoWhitespaceEdit||!1}}l.sort(ky._sortOpsAscending);let c=!1;for(let _=0,v=l.length-1;_<v;_++){const C=l[_].range.getEndPosition(),y=l[_+1].range.getStartPosition();if(y.isBeforeOrEqual(C)){if(y.isBefore(C))throw new Error("Overlapping ranges are not allowed!");c=!0}}a&&(l=this._reduceOperations(l));const d=i||t?ky._getInverseEditRanges(l):[],u=[];if(t)for(let _=0;_<l.length;_++){const v=l[_],C=d[_];if(v.isAutoWhitespaceEdit&&v.range.isEmpty())for(let y=C.startLineNumber;y<=C.endLineNumber;y++){let x="";y===C.startLineNumber&&(x=this.getLineContent(v.range.startLineNumber),Zr(x)!==-1)||u.push({lineNumber:y,oldContent:x})}}let h=null;if(i){let _=0;h=[];for(let v=0;v<l.length;v++){const C=l[v],y=d[v],x=this.getValueInRange(C.range),L=C.rangeOffset+_;_+=C.text.length-x.length,h[v]={sortIndex:C.sortIndex,identifier:C.identifier,range:y,text:x,textChange:new ar(C.rangeOffset,x,L,C.text)}}c||h.sort((v,C)=>v.sortIndex-C.sortIndex)}this._mightContainRTL=n,this._mightContainUnusualLineTerminators=r,this._mightContainNonBasicASCII=o;const g=this._doApplyEdits(l);let p=null;if(t&&u.length>0){u.sort((_,v)=>v.lineNumber-_.lineNumber),p=[];for(let _=0,v=u.length;_<v;_++){const C=u[_].lineNumber;if(_>0&&u[_-1].lineNumber===C)continue;const y=u[_].oldContent,x=this.getLineContent(C);x.length===0||x===y||Zr(x)!==-1||p.push(C)}}return this._onDidChangeContent.fire(),new nMe(h,g,p)}_reduceOperations(e){return e.length<1e3?e:[this._toSingleEditOperation(e)]}_toSingleEditOperation(e){let t=!1;const i=e[0].range,n=e[e.length-1].range,r=new F(i.startLineNumber,i.startColumn,n.endLineNumber,n.endColumn);let o=i.startLineNumber,a=i.startColumn;const l=[];for(let g=0,p=e.length;g<p;g++){const _=e[g],v=_.range;t=t||_.forceMoveMarkers,l.push(this.getValueInRange(new F(o,a,v.startLineNumber,v.startColumn))),_.text.length>0&&l.push(_.text),o=v.endLineNumber,a=v.endColumn}const c=l.join(""),[d,u,h]=Gm(c);return{sortIndex:0,identifier:e[0].identifier,range:r,rangeOffset:this.getOffsetAt(r.startLineNumber,r.startColumn),rangeLength:this.getValueLengthInRange(r,0),text:c,eolCount:d,firstLineLength:u,lastLineLength:h,forceMoveMarkers:t,isAutoWhitespaceEdit:!1}}_doApplyEdits(e){e.sort(ky._sortOpsDescending);const t=[];for(let i=0;i<e.length;i++){const n=e[i],r=n.range.startLineNumber,o=n.range.startColumn,a=n.range.endLineNumber,l=n.range.endColumn;if(r===a&&o===l&&n.text.length===0)continue;n.text?(this._pieceTree.delete(n.rangeOffset,n.rangeLength),this._pieceTree.insert(n.rangeOffset,n.text,!0)):this._pieceTree.delete(n.rangeOffset,n.rangeLength);const c=new F(r,o,a,l);t.push({range:c,rangeLength:n.rangeLength,text:n.text,rangeOffset:n.rangeOffset,forceMoveMarkers:n.forceMoveMarkers})}return t}findMatchesLineByLine(e,t,i,n){return this._pieceTree.findMatchesLineByLine(e,t,i,n)}static _getInverseEditRanges(e){const t=[];let i=0,n=0,r=null;for(let o=0,a=e.length;o<a;o++){const l=e[o];let c,d;r?r.range.endLineNumber===l.range.startLineNumber?(c=i,d=n+(l.range.startColumn-r.range.endColumn)):(c=i+(l.range.startLineNumber-r.range.endLineNumber),d=l.range.startColumn):(c=l.range.startLineNumber,d=l.range.startColumn);let u;if(l.text.length>0){const h=l.eolCount+1;h===1?u=new F(c,d,c,d+l.firstLineLength):u=new F(c,d,c+h-1,l.lastLineLength+1)}else u=new F(c,d,c,d);i=u.endLineNumber,n=u.endColumn,t.push(u),r=l}return t}static _sortOpsAscending(e,t){const i=F.compareRangesUsingEnds(e.range,t.range);return i===0?e.sortIndex-t.sortIndex:i}static _sortOpsDescending(e,t){const i=F.compareRangesUsingEnds(e.range,t.range);return i===0?t.sortIndex-e.sortIndex:-i}}class KBe{constructor(e,t,i,n,r,o,a,l,c){this._chunks=e,this._bom=t,this._cr=i,this._lf=n,this._crlf=r,this._containsRTL=o,this._containsUnusualLineTerminators=a,this._isBasicASCII=l,this._normalizeEOL=c}_getEOL(e){const t=this._cr+this._lf+this._crlf,i=this._cr+this._crlf;return t===0?e===1?`
`:`\r
`:i>t/2?`\r
`:`
`}create(e){const t=this._getEOL(e),i=this._chunks;if(this._normalizeEOL&&(t===`\r
`&&(this._cr>0||this._lf>0)||t===`
`&&(this._cr>0||this._crlf>0)))for(let r=0,o=i.length;r<o;r++){const a=i[r].buffer.replace(/\r\n|\r|\n/g,t),l=bf(a);i[r]=new yb(a,l)}const n=new ky(i,this._bom,t,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:n,disposable:n}}}class Wge{constructor(){this.chunks=[],this.BOM="",this._hasPreviousChar=!1,this._previousChar=0,this._tmpLineStarts=[],this.cr=0,this.lf=0,this.crlf=0,this.containsRTL=!1,this.containsUnusualLineTerminators=!1,this.isBasicASCII=!0}acceptChunk(e){if(e.length===0)return;this.chunks.length===0&&Pq(e)&&(this.BOM=qRe,e=e.substr(1));const t=e.charCodeAt(e.length-1);t===13||t>=55296&&t<=56319?(this._acceptChunk1(e.substr(0,e.length-1),!1),this._hasPreviousChar=!0,this._previousChar=t):(this._acceptChunk1(e,!1),this._hasPreviousChar=!1,this._previousChar=t)}_acceptChunk1(e,t){!t&&e.length===0||(this._hasPreviousChar?this._acceptChunk2(String.fromCharCode(this._previousChar)+e):this._acceptChunk2(e))}_acceptChunk2(e){const t=UBe(this._tmpLineStarts,e);this.chunks.push(new yb(e,t.lineStarts)),this.cr+=t.cr,this.lf+=t.lf,this.crlf+=t.crlf,t.isBasicASCII||(this.isBasicASCII=!1,this.containsRTL||(this.containsRTL=h1(e)),this.containsUnusualLineTerminators||(this.containsUnusualLineTerminators=Rue(e)))}finish(e=!0){return this._finish(),new KBe(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,e)}_finish(){if(this.chunks.length===0&&this._acceptChunk1("",!0),this._hasPreviousChar){this._hasPreviousChar=!1;const e=this.chunks[this.chunks.length-1];e.buffer+=String.fromCharCode(this._previousChar);const t=bf(e.buffer);e.lineStarts=t,this._previousChar===13&&this.cr++}}}class GBe{constructor(e){this._default=e,this._store=[]}get(e){return e<this._store.length?this._store[e]:this._default}set(e,t){for(;e>=this._store.length;)this._store[this._store.length]=this._default;this._store[e]=t}replace(e,t,i){if(e>=this._store.length)return;if(t===0){this.insert(e,i);return}else if(i===0){this.delete(e,t);return}const n=this._store.slice(0,e),r=this._store.slice(e+t),o=QBe(i,this._default);this._store=n.concat(o,r)}delete(e,t){t===0||e>=this._store.length||this._store.splice(e,t)}insert(e,t){if(t===0||e>=this._store.length)return;const i=[];for(let n=0;n<t;n++)i[n]=this._default;this._store=K4(this._store,e,i)}}function QBe(s,e){const t=[];for(let i=0;i<s;i++)t[i]=e;return t}class YBe{get startLineNumber(){return this._startLineNumber}get endLineNumber(){return this._startLineNumber+this._tokens.length-1}constructor(e,t){this._startLineNumber=e,this._tokens=t}getLineTokens(e){return this._tokens[e-this._startLineNumber]}appendLineTokens(e){this._tokens.push(e)}}class T8{constructor(){this._tokens=[]}add(e,t){if(this._tokens.length>0){const i=this._tokens[this._tokens.length-1];if(i.endLineNumber+1===e){i.appendLineTokens(t);return}}this._tokens.push(new YBe(e,[t]))}finalize(){return this._tokens}}class XBe{constructor(e,t){this.tokenizationSupport=t,this.initialState=this.tokenizationSupport.getInitialState(),this.store=new N8(e)}getStartState(e){return this.store.getStartState(e,this.initialState)}getFirstInvalidLine(){return this.store.getFirstInvalidLine(this.initialState)}}class ZBe extends XBe{constructor(e,t,i,n){super(e,t),this._textModel=i,this._languageIdCodec=n}updateTokensUntilLine(e,t){const i=this._textModel.getLanguageId();for(;;){const n=this.getFirstInvalidLine();if(!n||n.lineNumber>t)break;const r=this._textModel.getLineContent(n.lineNumber),o=Dx(this._languageIdCodec,i,this.tokenizationSupport,r,!0,n.startState);e.add(n.lineNumber,o.tokens),this.store.setEndState(n.lineNumber,o.endState)}}getTokenTypeIfInsertingCharacter(e,t){const i=this.getStartState(e.lineNumber);if(!i)return 0;const n=this._textModel.getLanguageId(),r=this._textModel.getLineContent(e.lineNumber),o=r.substring(0,e.column-1)+t+r.substring(e.column-1),a=Dx(this._languageIdCodec,n,this.tokenizationSupport,o,!0,i),l=new Ws(a.tokens,o,this._languageIdCodec);if(l.getCount()===0)return 0;const c=l.findTokenIndexAtOffset(e.column-1);return l.getStandardTokenType(c)}tokenizeLineWithEdit(e,t,i){const n=e.lineNumber,r=e.column,o=this.getStartState(n);if(!o)return null;const a=this._textModel.getLineContent(n),l=a.substring(0,r-1)+i+a.substring(r-1+t),c=this._textModel.getLanguageIdAtPosition(n,0),d=Dx(this._languageIdCodec,c,this.tokenizationSupport,l,!0,o);return new Ws(d.tokens,l,this._languageIdCodec)}hasAccurateTokensForLine(e){const t=this.store.getFirstInvalidEndStateLineNumberOrMax();return e<t}isCheapToTokenize(e){const t=this.store.getFirstInvalidEndStateLineNumberOrMax();return e<t||e===t&&this._textModel.getLineLength(e)<2048}tokenizeHeuristically(e,t,i){if(i<=this.store.getFirstInvalidEndStateLineNumberOrMax())return{heuristicTokens:!1};if(t<=this.store.getFirstInvalidEndStateLineNumberOrMax())return this.updateTokensUntilLine(e,i),{heuristicTokens:!1};let n=this.guessStartState(t);const r=this._textModel.getLanguageId();for(let o=t;o<=i;o++){const a=this._textModel.getLineContent(o),l=Dx(this._languageIdCodec,r,this.tokenizationSupport,a,!0,n);e.add(o,l.tokens),n=l.endState}return{heuristicTokens:!0}}guessStartState(e){let t=this._textModel.getLineFirstNonWhitespaceColumn(e);const i=[];let n=null;for(let a=e-1;t>1&&a>=1;a--){const l=this._textModel.getLineFirstNonWhitespaceColumn(a);if(l!==0&&l<t&&(i.push(this._textModel.getLineContent(a)),t=l,n=this.getStartState(a),n))break}n||(n=this.tokenizationSupport.getInitialState()),i.reverse();const r=this._textModel.getLanguageId();let o=n;for(const a of i)o=Dx(this._languageIdCodec,r,this.tokenizationSupport,a,!1,o).endState;return o}}class N8{constructor(e){this.lineCount=e,this._tokenizationStateStore=new JBe,this._invalidEndStatesLineNumbers=new e7e,this._invalidEndStatesLineNumbers.addRange(new Mt(1,e+1))}getEndState(e){return this._tokenizationStateStore.getEndState(e)}setEndState(e,t){if(!t)throw new di("Cannot set null/undefined state");this._invalidEndStatesLineNumbers.delete(e);const i=this._tokenizationStateStore.setEndState(e,t);return i&&e<this.lineCount&&this._invalidEndStatesLineNumbers.addRange(new Mt(e+1,e+2)),i}acceptChange(e,t){this.lineCount+=t-e.length,this._tokenizationStateStore.acceptChange(e,t),this._invalidEndStatesLineNumbers.addRangeAndResize(new Mt(e.startLineNumber,e.endLineNumberExclusive),t)}acceptChanges(e){for(const t of e){const[i]=Gm(t.text);this.acceptChange(new Ct(t.range.startLineNumber,t.range.endLineNumber+1),i+1)}}invalidateEndStateRange(e){this._invalidEndStatesLineNumbers.addRange(new Mt(e.startLineNumber,e.endLineNumberExclusive))}getFirstInvalidEndStateLineNumber(){return this._invalidEndStatesLineNumbers.min}getFirstInvalidEndStateLineNumberOrMax(){return this.getFirstInvalidEndStateLineNumber()||Number.MAX_SAFE_INTEGER}allStatesValid(){return this._invalidEndStatesLineNumbers.min===null}getStartState(e,t){return e===1?t:this.getEndState(e-1)}getFirstInvalidLine(e){const t=this.getFirstInvalidEndStateLineNumber();if(t===null)return null;const i=this.getStartState(t,e);if(!i)throw new di("Start state must be defined");return{lineNumber:t,startState:i}}}class JBe{constructor(){this._lineEndStates=new GBe(null)}getEndState(e){return this._lineEndStates.get(e)}setEndState(e,t){const i=this._lineEndStates.get(e);return i&&i.equals(t)?!1:(this._lineEndStates.set(e,t),!0)}acceptChange(e,t){let i=e.length;t>0&&i>0&&(i--,t--),this._lineEndStates.replace(e.startLineNumber,i,t)}}class e7e{constructor(){this._ranges=[]}get min(){return this._ranges.length===0?null:this._ranges[0].start}delete(e){const t=this._ranges.findIndex(i=>i.contains(e));if(t!==-1){const i=this._ranges[t];i.start===e?i.endExclusive===e+1?this._ranges.splice(t,1):this._ranges[t]=new Mt(e+1,i.endExclusive):i.endExclusive===e+1?this._ranges[t]=new Mt(i.start,e):this._ranges.splice(t,1,new Mt(i.start,e),new Mt(e+1,i.endExclusive))}}addRange(e){Mt.addRange(e,this._ranges)}addRangeAndResize(e,t){let i=0;for(;!(i>=this._ranges.length||e.start<=this._ranges[i].endExclusive);)i++;let n=i;for(;!(n>=this._ranges.length||e.endExclusive<this._ranges[n].start);)n++;const r=t-e.length;for(let o=n;o<this._ranges.length;o++)this._ranges[o]=this._ranges[o].delta(r);if(i===n){const o=new Mt(e.start,e.start+t);o.isEmpty||this._ranges.splice(i,0,o)}else{const o=Math.min(e.start,this._ranges[i].start),a=Math.max(e.endExclusive,this._ranges[n-1].endExclusive),l=new Mt(o,a+r);l.isEmpty?this._ranges.splice(i,n-i):this._ranges.splice(i,n-i,l)}}toString(){return this._ranges.map(e=>e.toString()).join(" + ")}}function Dx(s,e,t,i,n,r){let o=null;if(t)try{o=t.tokenizeEncoded(i,n,r.clone())}catch(a){ft(a)}return o||(o=MF(s.encodeLanguageId(e),r)),Ws.convertToEndOffset(o.tokens,i.length),o}class t7e{constructor(e,t){this._tokenizerWithStateStore=e,this._backgroundTokenStore=t,this._isDisposed=!1,this._isScheduled=!1}dispose(){this._isDisposed=!0}handleChanges(){this._beginBackgroundTokenization()}_beginBackgroundTokenization(){this._isScheduled||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._isScheduled=!0,Bue(e=>{this._isScheduled=!1,this._backgroundTokenizeWithDeadline(e)}))}_backgroundTokenizeWithDeadline(e){const t=Date.now()+e.timeRemaining(),i=()=>{this._isDisposed||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._backgroundTokenizeForAtLeast1ms(),Date.now()<t?sue(i):this._beginBackgroundTokenization())};i()}_backgroundTokenizeForAtLeast1ms(){const e=this._tokenizerWithStateStore._textModel.getLineCount(),t=new T8,i=Bs.create(!1);do if(i.elapsed()>1||this._tokenizeOneInvalidLine(t)>=e)break;while(this._hasLinesToTokenize());this._backgroundTokenStore.setTokens(t.finalize()),this.checkFinished()}_hasLinesToTokenize(){return this._tokenizerWithStateStore?!this._tokenizerWithStateStore.store.allStatesValid():!1}_tokenizeOneInvalidLine(e){var i;const t=(i=this._tokenizerWithStateStore)==null?void 0:i.getFirstInvalidLine();return t?(this._tokenizerWithStateStore.updateTokensUntilLine(e,t.lineNumber),t.lineNumber):this._tokenizerWithStateStore._textModel.getLineCount()+1}checkFinished(){this._isDisposed||this._tokenizerWithStateStore.store.allStatesValid()&&this._backgroundTokenStore.backgroundTokenizationFinished()}requestTokens(e,t){this._tokenizerWithStateStore.store.invalidateEndStateRange(new Ct(e,t))}}class i7e{constructor(){this._onDidChangeVisibleRanges=new Z,this.onDidChangeVisibleRanges=this._onDidChangeVisibleRanges.event,this._views=new Set}attachView(){const e=new n7e(t=>{this._onDidChangeVisibleRanges.fire({view:e,state:t})});return this._views.add(e),e}detachView(e){this._views.delete(e),this._onDidChangeVisibleRanges.fire({view:e,state:void 0})}}class n7e{constructor(e){this.handleStateChange=e}setVisibleLines(e,t){const i=e.map(n=>new Ct(n.startLineNumber,n.endLineNumber+1));this.handleStateChange({visibleLineRanges:i,stabilized:t})}}class s7e extends te{get lineRanges(){return this._lineRanges}constructor(e){super(),this._refreshTokens=e,this.runner=this._register(new xi(()=>this.update(),50)),this._computedLineRanges=[],this._lineRanges=[]}update(){dn(this._computedLineRanges,this._lineRanges,(e,t)=>e.equals(t))||(this._computedLineRanges=this._lineRanges,this._refreshTokens())}handleStateChange(e){this._lineRanges=e.visibleLineRanges,e.stabilized?(this.runner.cancel(),this.update()):this.runner.schedule()}}class Hge extends te{get backgroundTokenizationState(){return this._backgroundTokenizationState}constructor(e,t,i){super(),this._languageIdCodec=e,this._textModel=t,this.getLanguageId=i,this._backgroundTokenizationState=1,this._onDidChangeBackgroundTokenizationState=this._register(new Z),this.onDidChangeBackgroundTokenizationState=this._onDidChangeBackgroundTokenizationState.event,this._onDidChangeTokens=this._register(new Z),this.onDidChangeTokens=this._onDidChangeTokens.event}tokenizeIfCheap(e){this.isCheapToTokenize(e)&&this.forceTokenization(e)}}class Tne extends Hge{constructor(e,t,i,n){super(t,i,n),this._treeSitterService=e,this._tokenizationSupport=null,this._initialize()}_initialize(){const e=this.getLanguageId();(!this._tokenizationSupport||this._lastLanguageId!==e)&&(this._lastLanguageId=e,this._tokenizationSupport=q7.get(e))}getLineTokens(e){const t=this._textModel.getLineContent(e);if(this._tokenizationSupport){const i=this._tokenizationSupport.tokenizeEncoded(e,this._textModel);if(i)return new Ws(i,t,this._languageIdCodec)}return Ws.createEmpty(t,this._languageIdCodec)}resetTokenization(e=!0){e&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]}),this._initialize()}handleDidChangeAttached(){}handleDidChangeContent(e){e.isFlush&&this.resetTokenization(!1)}forceTokenization(e){}hasAccurateTokensForLine(e){return!0}isCheapToTokenize(e){return!0}getTokenTypeIfInsertingCharacter(e,t,i){return 0}tokenizeLineWithEdit(e,t,i){return null}get hasTokens(){return this._treeSitterService.getParseResult(this._textModel)!==void 0}}const zge=Ht("treeSitterParserService"),vf=new Uint32Array(0).buffer;class ih{static deleteBeginning(e,t){return e===null||e===vf?e:ih.delete(e,0,t)}static deleteEnding(e,t){if(e===null||e===vf)return e;const i=Vf(e),n=i[i.length-2];return ih.delete(e,t,n)}static delete(e,t,i){if(e===null||e===vf||t===i)return e;const n=Vf(e),r=n.length>>>1;if(t===0&&n[n.length-2]===i)return vf;const o=Ws.findIndexInTokensArray(n,t),a=o>0?n[o-1<<1]:0,l=n[o<<1];if(i<l){const g=i-t;for(let p=o;p<r;p++)n[p<<1]-=g;return e}let c,d;a!==t?(n[o<<1]=t,c=o+1<<1,d=t):(c=o<<1,d=a);const u=i-t;for(let g=o+1;g<r;g++){const p=n[g<<1]-u;p>d&&(n[c++]=p,n[c++]=n[(g<<1)+1],d=p)}if(c===n.length)return e;const h=new Uint32Array(c);return h.set(n.subarray(0,c),0),h.buffer}static append(e,t){if(t===vf)return e;if(e===vf)return t;if(e===null)return e;if(t===null)return null;const i=Vf(e),n=Vf(t),r=n.length>>>1,o=new Uint32Array(i.length+n.length);o.set(i,0);let a=i.length;const l=i[i.length-2];for(let c=0;c<r;c++)o[a++]=n[c<<1]+l,o[a++]=n[(c<<1)+1];return o.buffer}static insert(e,t,i){if(e===null||e===vf)return e;const n=Vf(e),r=n.length>>>1;let o=Ws.findIndexInTokensArray(n,t);o>0&&n[o-1<<1]===t&&o--;for(let a=o;a<r;a++)n[a<<1]+=i;return e}}function Vf(s){return s instanceof Uint32Array?s:new Uint32Array(s)}class TI{constructor(e){this._lineTokens=[],this._len=0,this._languageIdCodec=e}flush(){this._lineTokens=[],this._len=0}get hasTokens(){return this._lineTokens.length>0}getTokens(e,t,i){let n=null;if(t<this._len&&(n=this._lineTokens[t]),n!==null&&n!==vf)return new Ws(Vf(n),i,this._languageIdCodec);const r=new Uint32Array(2);return r[0]=i.length,r[1]=Nne(this._languageIdCodec.encodeLanguageId(e)),new Ws(r,i,this._languageIdCodec)}static _massageTokens(e,t,i){const n=i?Vf(i):null;if(t===0){let r=!1;if(n&&n.length>1&&(r=Go.getLanguageId(n[1])!==e),!r)return vf}if(!n||n.length===0){const r=new Uint32Array(2);return r[0]=t,r[1]=Nne(e),r.buffer}return n[n.length-2]=t,n.byteOffset===0&&n.byteLength===n.buffer.byteLength?n.buffer:n}_ensureLine(e){for(;e>=this._len;)this._lineTokens[this._len]=null,this._len++}_deleteLines(e,t){t!==0&&(e+t>this._len&&(t=this._len-e),this._lineTokens.splice(e,t),this._len-=t)}_insertLines(e,t){if(t===0)return;const i=[];for(let n=0;n<t;n++)i[n]=null;this._lineTokens=K4(this._lineTokens,e,i),this._len+=t}setTokens(e,t,i,n,r){const o=TI._massageTokens(this._languageIdCodec.encodeLanguageId(e),i,n);this._ensureLine(t);const a=this._lineTokens[t];return this._lineTokens[t]=o,r?!TI._equals(a,o):!1}static _equals(e,t){if(!e||!t)return!e&&!t;const i=Vf(e),n=Vf(t);if(i.length!==n.length)return!1;for(let r=0,o=i.length;r<o;r++)if(i[r]!==n[r])return!1;return!0}acceptEdit(e,t,i){this._acceptDeleteRange(e),this._acceptInsertText(new X(e.startLineNumber,e.startColumn),t,i)}_acceptDeleteRange(e){const t=e.startLineNumber-1;if(t>=this._len)return;if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this._lineTokens[t]=ih.delete(this._lineTokens[t],e.startColumn-1,e.endColumn-1);return}this._lineTokens[t]=ih.deleteEnding(this._lineTokens[t],e.startColumn-1);const i=e.endLineNumber-1;let n=null;i<this._len&&(n=ih.deleteBeginning(this._lineTokens[i],e.endColumn-1)),this._lineTokens[t]=ih.append(this._lineTokens[t],n),this._deleteLines(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t,i){if(t===0&&i===0)return;const n=e.lineNumber-1;if(!(n>=this._len)){if(t===0){this._lineTokens[n]=ih.insert(this._lineTokens[n],e.column-1,i);return}this._lineTokens[n]=ih.deleteEnding(this._lineTokens[n],e.column-1),this._lineTokens[n]=ih.insert(this._lineTokens[n],e.column-1,i),this._insertLines(e.lineNumber,t)}}setMultilineTokens(e,t){if(e.length===0)return{changes:[]};const i=[];for(let n=0,r=e.length;n<r;n++){const o=e[n];let a=0,l=0,c=!1;for(let d=o.startLineNumber;d<=o.endLineNumber;d++)c?(this.setTokens(t.getLanguageId(),d-1,t.getLineLength(d),o.getLineTokens(d),!1),l=d):this.setTokens(t.getLanguageId(),d-1,t.getLineLength(d),o.getLineTokens(d),!0)&&(c=!0,a=d,l=d);c&&i.push({fromLineNumber:a,toLineNumber:l})}return{changes:i}}}function Nne(s){return(s<<0|0|0|32768|2<<24|1024)>>>0}class QK{constructor(e){this._pieces=[],this._isComplete=!1,this._languageIdCodec=e}flush(){this._pieces=[],this._isComplete=!1}isEmpty(){return this._pieces.length===0}set(e,t){this._pieces=e||[],this._isComplete=t}setPartial(e,t){let i=e;if(t.length>0){const r=t[0].getRange(),o=t[t.length-1].getRange();if(!r||!o)return e;i=e.plusRange(r).plusRange(o)}let n=null;for(let r=0,o=this._pieces.length;r<o;r++){const a=this._pieces[r];if(a.endLineNumber<i.startLineNumber)continue;if(a.startLineNumber>i.endLineNumber){n=n||{index:r};break}if(a.removeTokens(i),a.isEmpty()){this._pieces.splice(r,1),r--,o--;continue}if(a.endLineNumber<i.startLineNumber)continue;if(a.startLineNumber>i.endLineNumber){n=n||{index:r};continue}const[l,c]=a.split(i);if(l.isEmpty()){n=n||{index:r};continue}c.isEmpty()||(this._pieces.splice(r,1,l,c),r++,o++,n=n||{index:r})}return n=n||{index:this._pieces.length},t.length>0&&(this._pieces=K4(this._pieces,n.index,t)),i}isComplete(){return this._isComplete}addSparseTokens(e,t){if(t.getLineContent().length===0)return t;const i=this._pieces;if(i.length===0)return t;const n=QK._findFirstPieceWithLine(i,e),r=i[n].getLineTokens(e);if(!r)return t;const o=t.getCount(),a=r.getCount();let l=0;const c=[];let d=0,u=0;const h=(g,p)=>{g!==u&&(u=g,c[d++]=g,c[d++]=p)};for(let g=0;g<a;g++){const p=r.getStartCharacter(g),_=r.getEndCharacter(g),v=r.getMetadata(g),C=((v&1?2048:0)|(v&2?4096:0)|(v&4?8192:0)|(v&8?16384:0)|(v&16?16744448:0)|(v&32?4278190080:0))>>>0,y=~C>>>0;for(;l<o&&t.getEndOffset(l)<=p;)h(t.getEndOffset(l),t.getMetadata(l)),l++;for(l<o&&t.getStartOffset(l)<p&&h(p,t.getMetadata(l));l<o&&t.getEndOffset(l)<_;)h(t.getEndOffset(l),t.getMetadata(l)&y|v&C),l++;if(l<o)h(_,t.getMetadata(l)&y|v&C),t.getEndOffset(l)===_&&l++;else{const x=Math.min(Math.max(0,l-1),o-1);h(_,t.getMetadata(x)&y|v&C)}}for(;l<o;)h(t.getEndOffset(l),t.getMetadata(l)),l++;return new Ws(new Uint32Array(c),t.getLineContent(),this._languageIdCodec)}static _findFirstPieceWithLine(e,t){let i=0,n=e.length-1;for(;i<n;){let r=i+Math.floor((n-i)/2);if(e[r].endLineNumber<t)i=r+1;else if(e[r].startLineNumber>t)n=r-1;else{for(;r>i&&e[r-1].startLineNumber<=t&&t<=e[r-1].endLineNumber;)r--;return r}}return i}acceptEdit(e,t,i,n,r){for(const o of this._pieces)o.acceptEdit(e,t,i,n,r)}}var r7e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},jV=function(s,e){return function(t,i){e(t,i,s)}},MR;let R8=MR=class extends Rge{constructor(e,t,i,n,r,o,a){super(),this._textModel=e,this._bracketPairsTextModelPart=t,this._languageId=i,this._attachedViews=n,this._languageService=r,this._languageConfigurationService=o,this._treeSitterService=a,this._semanticTokens=new QK(this._languageService.languageIdCodec),this._onDidChangeLanguage=this._register(new Z),this.onDidChangeLanguage=this._onDidChangeLanguage.event,this._onDidChangeLanguageConfiguration=this._register(new Z),this.onDidChangeLanguageConfiguration=this._onDidChangeLanguageConfiguration.event,this._onDidChangeTokens=this._register(new Z),this.onDidChangeTokens=this._onDidChangeTokens.event,this._tokensDisposables=this._register(new ce),this._register(this._languageConfigurationService.onDidChange(l=>{l.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})})),this._register(De.filter(q7.onDidChange,l=>l.changedLanguages.includes(this._languageId))(()=>{this.createPreferredTokenProvider()})),this.createPreferredTokenProvider()}createGrammarTokens(){return this._register(new Rne(this._languageService.languageIdCodec,this._textModel,()=>this._languageId,this._attachedViews))}createTreeSitterTokens(){return this._register(new Tne(this._treeSitterService,this._languageService.languageIdCodec,this._textModel,()=>this._languageId))}createTokens(e){var i;const t=this._tokens!==void 0;(i=this._tokens)==null||i.dispose(),this._tokens=e?this.createTreeSitterTokens():this.createGrammarTokens(),this._tokensDisposables.clear(),this._tokensDisposables.add(this._tokens.onDidChangeTokens(n=>{this._emitModelTokensChangedEvent(n)})),this._tokensDisposables.add(this._tokens.onDidChangeBackgroundTokenizationState(n=>{this._bracketPairsTextModelPart.handleDidChangeBackgroundTokenizationState()})),t&&this._tokens.resetTokenization()}createPreferredTokenProvider(){q7.get(this._languageId)?this._tokens instanceof Tne||this.createTokens(!0):this._tokens instanceof Rne||this.createTokens(!1)}handleLanguageConfigurationServiceChange(e){e.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})}handleDidChangeContent(e){if(e.isFlush)this._semanticTokens.flush();else if(!e.isEolChange)for(const t of e.changes){const[i,n,r]=Gm(t.text);this._semanticTokens.acceptEdit(t.range,i,n,r,t.text.length>0?t.text.charCodeAt(0):0)}this._tokens.handleDidChangeContent(e)}handleDidChangeAttached(){this._tokens.handleDidChangeAttached()}getLineTokens(e){this.validateLineNumber(e);const t=this._tokens.getLineTokens(e);return this._semanticTokens.addSparseTokens(e,t)}_emitModelTokensChangedEvent(e){this._textModel._isDisposing()||(this._bracketPairsTextModelPart.handleDidChangeTokens(e),this._onDidChangeTokens.fire(e))}validateLineNumber(e){if(e<1||e>this._textModel.getLineCount())throw new di("Illegal value for lineNumber")}get hasTokens(){return this._tokens.hasTokens}resetTokenization(){this._tokens.resetTokenization()}get backgroundTokenizationState(){return this._tokens.backgroundTokenizationState}forceTokenization(e){this.validateLineNumber(e),this._tokens.forceTokenization(e)}hasAccurateTokensForLine(e){return this.validateLineNumber(e),this._tokens.hasAccurateTokensForLine(e)}isCheapToTokenize(e){return this.validateLineNumber(e),this._tokens.isCheapToTokenize(e)}tokenizeIfCheap(e){this.validateLineNumber(e),this._tokens.tokenizeIfCheap(e)}getTokenTypeIfInsertingCharacter(e,t,i){return this._tokens.getTokenTypeIfInsertingCharacter(e,t,i)}tokenizeLineWithEdit(e,t,i){return this._tokens.tokenizeLineWithEdit(e,t,i)}setSemanticTokens(e,t){this._semanticTokens.set(e,t),this._emitModelTokensChangedEvent({semanticTokensApplied:e!==null,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]})}hasCompleteSemanticTokens(){return this._semanticTokens.isComplete()}hasSomeSemanticTokens(){return!this._semanticTokens.isEmpty()}setPartialSemanticTokens(e,t){if(this.hasCompleteSemanticTokens())return;const i=this._textModel.validateRange(this._semanticTokens.setPartial(e,t));this._emitModelTokensChangedEvent({semanticTokensApplied:!0,ranges:[{fromLineNumber:i.startLineNumber,toLineNumber:i.endLineNumber}]})}getWordAtPosition(e){this.assertNotDisposed();const t=this._textModel.validatePosition(e),i=this._textModel.getLineContent(t.lineNumber),n=this.getLineTokens(t.lineNumber),r=n.findTokenIndexAtOffset(t.column-1),[o,a]=MR._findLanguageBoundaries(n,r),l=Gk(t.column,this.getLanguageConfiguration(n.getLanguageId(r)).getWordDefinition(),i.substring(o,a),o);if(l&&l.startColumn<=e.column&&e.column<=l.endColumn)return l;if(r>0&&o===t.column-1){const[c,d]=MR._findLanguageBoundaries(n,r-1),u=Gk(t.column,this.getLanguageConfiguration(n.getLanguageId(r-1)).getWordDefinition(),i.substring(c,d),c);if(u&&u.startColumn<=e.column&&e.column<=u.endColumn)return u}return null}getLanguageConfiguration(e){return this._languageConfigurationService.getLanguageConfiguration(e)}static _findLanguageBoundaries(e,t){const i=e.getLanguageId(t);let n=0;for(let o=t;o>=0&&e.getLanguageId(o)===i;o--)n=e.getStartOffset(o);let r=e.getLineContent().length;for(let o=t,a=e.getCount();o<a&&e.getLanguageId(o)===i;o++)r=e.getEndOffset(o);return[n,r]}getWordUntilPosition(e){const t=this.getWordAtPosition(e);return t?{word:t.word.substr(0,e.column-t.startColumn),startColumn:t.startColumn,endColumn:e.column}:{word:"",startColumn:e.column,endColumn:e.column}}getLanguageId(){return this._languageId}getLanguageIdAtPosition(e,t){const i=this._textModel.validatePosition(new X(e,t)),n=this.getLineTokens(i.lineNumber);return n.getLanguageId(n.findTokenIndexAtOffset(i.column-1))}setLanguageId(e,t="api"){if(this._languageId===e)return;const i={oldLanguage:this._languageId,newLanguage:e,source:t};this._languageId=e,this._bracketPairsTextModelPart.handleDidChangeLanguage(i),this._tokens.resetTokenization(),this.createPreferredTokenProvider(),this._onDidChangeLanguage.fire(i),this._onDidChangeLanguageConfiguration.fire({})}};R8=MR=r7e([jV(4,un),jV(5,bn),jV(6,zge)],R8);class Rne extends Hge{constructor(e,t,i,n){super(e,t,i),this._tokenizer=null,this._defaultBackgroundTokenizer=null,this._backgroundTokenizer=this._register(new Es),this._tokens=new TI(this._languageIdCodec),this._debugBackgroundTokenizer=this._register(new Es),this._attachedViewStates=this._register(new Sq),this._register(Ln.onDidChange(r=>{const o=this.getLanguageId();r.changedLanguages.indexOf(o)!==-1&&this.resetTokenization()})),this.resetTokenization(),this._register(n.onDidChangeVisibleRanges(({view:r,state:o})=>{if(o){let a=this._attachedViewStates.get(r);a||(a=new s7e(()=>this.refreshRanges(a.lineRanges)),this._attachedViewStates.set(r,a)),a.handleStateChange(o)}else this._attachedViewStates.deleteAndDispose(r)}))}resetTokenization(e=!0){var r;this._tokens.flush(),(r=this._debugBackgroundTokens)==null||r.flush(),this._debugBackgroundStates&&(this._debugBackgroundStates=new N8(this._textModel.getLineCount())),e&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]});const t=()=>{if(this._textModel.isTooLargeForTokenization())return[null,null];const o=Ln.get(this.getLanguageId());if(!o)return[null,null];let a;try{a=o.getInitialState()}catch(l){return ft(l),[null,null]}return[o,a]},[i,n]=t();if(i&&n?this._tokenizer=new ZBe(this._textModel.getLineCount(),i,this._textModel,this._languageIdCodec):this._tokenizer=null,this._backgroundTokenizer.clear(),this._defaultBackgroundTokenizer=null,this._tokenizer){const o={setTokens:a=>{this.setTokens(a)},backgroundTokenizationFinished:()=>{if(this._backgroundTokenizationState===2)return;const a=2;this._backgroundTokenizationState=a,this._onDidChangeBackgroundTokenizationState.fire()},setEndState:(a,l)=>{var d;if(!this._tokenizer)return;const c=this._tokenizer.store.getFirstInvalidEndStateLineNumber();c!==null&&a>=c&&((d=this._tokenizer)==null||d.store.setEndState(a,l))}};i&&i.createBackgroundTokenizer&&!i.backgroundTokenizerShouldOnlyVerifyTokens&&(this._backgroundTokenizer.value=i.createBackgroundTokenizer(this._textModel,o)),!this._backgroundTokenizer.value&&!this._textModel.isTooLargeForTokenization()&&(this._backgroundTokenizer.value=this._defaultBackgroundTokenizer=new t7e(this._tokenizer,o),this._defaultBackgroundTokenizer.handleChanges()),i!=null&&i.backgroundTokenizerShouldOnlyVerifyTokens&&i.createBackgroundTokenizer?(this._debugBackgroundTokens=new TI(this._languageIdCodec),this._debugBackgroundStates=new N8(this._textModel.getLineCount()),this._debugBackgroundTokenizer.clear(),this._debugBackgroundTokenizer.value=i.createBackgroundTokenizer(this._textModel,{setTokens:a=>{var l;(l=this._debugBackgroundTokens)==null||l.setMultilineTokens(a,this._textModel)},backgroundTokenizationFinished(){},setEndState:(a,l)=>{var c;(c=this._debugBackgroundStates)==null||c.setEndState(a,l)}})):(this._debugBackgroundTokens=void 0,this._debugBackgroundStates=void 0,this._debugBackgroundTokenizer.value=void 0)}this.refreshAllVisibleLineTokens()}handleDidChangeAttached(){var e;(e=this._defaultBackgroundTokenizer)==null||e.handleChanges()}handleDidChangeContent(e){var t,i,n;if(e.isFlush)this.resetTokenization(!1);else if(!e.isEolChange){for(const r of e.changes){const[o,a]=Gm(r.text);this._tokens.acceptEdit(r.range,o,a),(t=this._debugBackgroundTokens)==null||t.acceptEdit(r.range,o,a)}(i=this._debugBackgroundStates)==null||i.acceptChanges(e.changes),this._tokenizer&&this._tokenizer.store.acceptChanges(e.changes),(n=this._defaultBackgroundTokenizer)==null||n.handleChanges()}}setTokens(e){const{changes:t}=this._tokens.setMultilineTokens(e,this._textModel);return t.length>0&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:t}),{changes:t}}refreshAllVisibleLineTokens(){const e=Ct.joinMany([...this._attachedViewStates].map(([t,i])=>i.lineRanges));this.refreshRanges(e)}refreshRanges(e){for(const t of e)this.refreshRange(t.startLineNumber,t.endLineNumberExclusive-1)}refreshRange(e,t){var o,a;if(!this._tokenizer)return;e=Math.max(1,Math.min(this._textModel.getLineCount(),e)),t=Math.min(this._textModel.getLineCount(),t);const i=new T8,{heuristicTokens:n}=this._tokenizer.tokenizeHeuristically(i,e,t),r=this.setTokens(i.finalize());if(n)for(const l of r.changes)(o=this._backgroundTokenizer.value)==null||o.requestTokens(l.fromLineNumber,l.toLineNumber+1);(a=this._defaultBackgroundTokenizer)==null||a.checkFinished()}forceTokenization(e){var i,n;const t=new T8;(i=this._tokenizer)==null||i.updateTokensUntilLine(t,e),this.setTokens(t.finalize()),(n=this._defaultBackgroundTokenizer)==null||n.checkFinished()}hasAccurateTokensForLine(e){return this._tokenizer?this._tokenizer.hasAccurateTokensForLine(e):!0}isCheapToTokenize(e){return this._tokenizer?this._tokenizer.isCheapToTokenize(e):!0}getLineTokens(e){var n;const t=this._textModel.getLineContent(e),i=this._tokens.getTokens(this._textModel.getLanguageId(),e-1,t);if(this._debugBackgroundTokens&&this._debugBackgroundStates&&this._tokenizer&&this._debugBackgroundStates.getFirstInvalidEndStateLineNumberOrMax()>e&&this._tokenizer.store.getFirstInvalidEndStateLineNumberOrMax()>e){const r=this._debugBackgroundTokens.getTokens(this._textModel.getLanguageId(),e-1,t);!i.equals(r)&&((n=this._debugBackgroundTokenizer.value)!=null&&n.reportMismatchingTokens)&&this._debugBackgroundTokenizer.value.reportMismatchingTokens(e)}return i}getTokenTypeIfInsertingCharacter(e,t,i){if(!this._tokenizer)return 0;const n=this._textModel.validatePosition(new X(e,t));return this.forceTokenization(n.lineNumber),this._tokenizer.getTokenTypeIfInsertingCharacter(n,i)}tokenizeLineWithEdit(e,t,i){if(!this._tokenizer)return null;const n=this._textModel.validatePosition(e);return this.forceTokenization(n.lineNumber),this._tokenizer.tokenizeLineWithEdit(n,t,i)}get hasTokens(){return this._tokens.hasTokens}}class o7e{constructor(){this.changeType=1}}class fu{static applyInjectedText(e,t){if(!t||t.length===0)return e;let i="",n=0;for(const r of t)i+=e.substring(n,r.column-1),n=r.column-1,i+=r.options.content;return i+=e.substring(n),i}static fromDecorations(e){const t=[];for(const i of e)i.options.before&&i.options.before.content.length>0&&t.push(new fu(i.ownerId,i.range.startLineNumber,i.range.startColumn,i.options.before,0)),i.options.after&&i.options.after.content.length>0&&t.push(new fu(i.ownerId,i.range.endLineNumber,i.range.endColumn,i.options.after,1));return t.sort((i,n)=>i.lineNumber===n.lineNumber?i.column===n.column?i.order-n.order:i.column-n.column:i.lineNumber-n.lineNumber),t}constructor(e,t,i,n,r){this.ownerId=e,this.lineNumber=t,this.column=i,this.options=n,this.order=r}}class Ane{constructor(e,t,i){this.changeType=2,this.lineNumber=e,this.detail=t,this.injectedText=i}}class a7e{constructor(e,t){this.changeType=3,this.fromLineNumber=e,this.toLineNumber=t}}class l7e{constructor(e,t,i,n){this.changeType=4,this.injectedTexts=n,this.fromLineNumber=e,this.toLineNumber=t,this.detail=i}}class c7e{constructor(){this.changeType=5}}class Iy{constructor(e,t,i,n){this.changes=e,this.versionId=t,this.isUndoing=i,this.isRedoing=n,this.resultingSelection=null}containsEvent(e){for(let t=0,i=this.changes.length;t<i;t++)if(this.changes[t].changeType===e)return!0;return!1}static merge(e,t){const i=[].concat(e.changes).concat(t.changes),n=t.versionId,r=e.isUndoing||t.isUndoing,o=e.isRedoing||t.isRedoing;return new Iy(i,n,r,o)}}class Uge{constructor(e){this.changes=e}}class ev{constructor(e,t){this.rawContentChangedEvent=e,this.contentChangedEvent=t}merge(e){const t=Iy.merge(this.rawContentChangedEvent,e.rawContentChangedEvent),i=ev._mergeChangeEvents(this.contentChangedEvent,e.contentChangedEvent);return new ev(t,i)}static _mergeChangeEvents(e,t){const i=[].concat(e.changes).concat(t.changes),n=t.eol,r=t.versionId,o=e.isUndoing||t.isUndoing,a=e.isRedoing||t.isRedoing,l=e.isFlush||t.isFlush,c=e.isEolChange&&t.isEolChange;return{changes:i,eol:n,isEolChange:c,versionId:r,isUndoing:o,isRedoing:a,isFlush:l}}}var d7e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},yN=function(s,e){return function(t,i){e(t,i,s)}},ab;function u7e(s){const e=new Wge;return e.acceptChunk(s),e.finish()}function h7e(s){const e=new Wge;let t;for(;typeof(t=s.read())=="string";)e.acceptChunk(t);return e.finish()}function Pne(s,e){let t;return typeof s=="string"?t=u7e(s):tMe(s)?t=h7e(s):t=s,t.create(e)}let SN=0;const f7e=999,g7e=1e4;class p7e{constructor(e){this._source=e,this._eos=!1}read(){if(this._eos)return null;const e=[];let t=0,i=0;do{const n=this._source.read();if(n===null)return this._eos=!0,t===0?null:e.join("");if(n.length>0&&(e[t++]=n,i+=n.length),i>=64*1024)return e.join("")}while(!0)}}const Tx=()=>{throw new Error("Invalid change accessor")};var Kd;let Jd=(Kd=class extends te{static resolveOptions(e,t){if(t.detectIndentation){const i=yne(e,t.tabSize,t.insertSpaces);return new LR({tabSize:i.tabSize,indentSize:"tabSize",insertSpaces:i.insertSpaces,trimAutoWhitespace:t.trimAutoWhitespace,defaultEOL:t.defaultEOL,bracketPairColorizationOptions:t.bracketPairColorizationOptions})}return new LR(t)}get onDidChangeLanguage(){return this._tokenizationTextModelPart.onDidChangeLanguage}get onDidChangeLanguageConfiguration(){return this._tokenizationTextModelPart.onDidChangeLanguageConfiguration}get onDidChangeTokens(){return this._tokenizationTextModelPart.onDidChangeTokens}onDidChangeContent(e){return this._eventEmitter.slowEvent(t=>e(t.contentChangedEvent))}onDidChangeContentOrInjectedText(e){return id(this._eventEmitter.fastEvent(t=>e(t)),this._onDidChangeInjectedText.event(t=>e(t)))}_isDisposing(){return this.__isDisposing}get tokenization(){return this._tokenizationTextModelPart}get bracketPairs(){return this._bracketPairs}get guides(){return this._guidesTextModelPart}constructor(e,t,i,n=null,r,o,a,l){super(),this._undoRedoService=r,this._languageService=o,this._languageConfigurationService=a,this.instantiationService=l,this._onWillDispose=this._register(new Z),this.onWillDispose=this._onWillDispose.event,this._onDidChangeDecorations=this._register(new C7e(p=>this.handleBeforeFireDecorationsChangedEvent(p))),this.onDidChangeDecorations=this._onDidChangeDecorations.event,this._onDidChangeOptions=this._register(new Z),this.onDidChangeOptions=this._onDidChangeOptions.event,this._onDidChangeAttached=this._register(new Z),this.onDidChangeAttached=this._onDidChangeAttached.event,this._onDidChangeInjectedText=this._register(new Z),this._eventEmitter=this._register(new y7e),this._languageSelectionListener=this._register(new Es),this._deltaDecorationCallCnt=0,this._attachedViews=new i7e,SN++,this.id="$model"+SN,this.isForSimpleWidget=i.isForSimpleWidget,typeof n>"u"||n===null?this._associatedResource=Je.parse("inmemory://model/"+SN):this._associatedResource=n,this._attachedEditorCount=0;const{textBuffer:c,disposable:d}=Pne(e,i.defaultEOL);this._buffer=c,this._bufferDisposable=d,this._options=ab.resolveOptions(this._buffer,i);const u=typeof t=="string"?t:t.languageId;typeof t!="string"&&(this._languageSelectionListener.value=t.onDidChange(()=>this._setLanguage(t.languageId))),this._bracketPairs=this._register(new CBe(this,this._languageConfigurationService)),this._guidesTextModelPart=this._register(new kBe(this,this._languageConfigurationService)),this._decorationProvider=this._register(new SBe(this)),this._tokenizationTextModelPart=this.instantiationService.createInstance(R8,this,this._bracketPairs,u,this._attachedViews);const h=this._buffer.getLineCount(),g=this._buffer.getValueLengthInRange(new F(1,1,h,this._buffer.getLineLength(h)+1),0);i.largeFileOptimizations?(this._isTooLargeForTokenization=g>ab.LARGE_FILE_SIZE_THRESHOLD||h>ab.LARGE_FILE_LINE_COUNT_THRESHOLD,this._isTooLargeForHeapOperation=g>ab.LARGE_FILE_HEAP_OPERATION_THRESHOLD):(this._isTooLargeForTokenization=!1,this._isTooLargeForHeapOperation=!1),this._isTooLargeForSyncing=g>ab._MODEL_SYNC_LIMIT,this._versionId=1,this._alternativeVersionId=1,this._initialUndoRedoSnapshot=null,this._isDisposed=!1,this.__isDisposing=!1,this._instanceId=Aue(SN),this._lastDecorationId=0,this._decorations=Object.create(null),this._decorationsTree=new Mne,this._commandManager=new $K(this,this._undoRedoService),this._isUndoing=!1,this._isRedoing=!1,this._trimAutoWhitespaceLines=null,this._register(this._decorationProvider.onDidChange(()=>{this._onDidChangeDecorations.beginDeferredEmit(),this._onDidChangeDecorations.fire(),this._onDidChangeDecorations.endDeferredEmit()})),this._languageService.requestRichLanguageFeatures(u),this._register(this._languageConfigurationService.onDidChange(p=>{this._bracketPairs.handleLanguageConfigurationServiceChange(p),this._tokenizationTextModelPart.handleLanguageConfigurationServiceChange(p)}))}dispose(){this.__isDisposing=!0,this._onWillDispose.fire(),this._tokenizationTextModelPart.dispose(),this._isDisposed=!0,super.dispose(),this._bufferDisposable.dispose(),this.__isDisposing=!1;const e=new ky([],"",`
`,!1,!1,!0,!0);e.dispose(),this._buffer=e,this._bufferDisposable=te.None}_assertNotDisposed(){if(this._isDisposed)throw new di("Model is disposed!")}_emitContentChangedEvent(e,t){this.__isDisposing||(this._tokenizationTextModelPart.handleDidChangeContent(t),this._bracketPairs.handleDidChangeContent(t),this._eventEmitter.fire(new ev(e,t)))}setValue(e){if(this._assertNotDisposed(),e==null)throw fc();const{textBuffer:t,disposable:i}=Pne(e,this._options.defaultEOL);this._setValueFromTextBuffer(t,i)}_createContentChanged2(e,t,i,n,r,o,a,l){return{changes:[{range:e,rangeOffset:t,rangeLength:i,text:n}],eol:this._buffer.getEOL(),isEolChange:l,versionId:this.getVersionId(),isUndoing:r,isRedoing:o,isFlush:a}}_setValueFromTextBuffer(e,t){this._assertNotDisposed();const i=this.getFullModelRange(),n=this.getValueLengthInRange(i),r=this.getLineCount(),o=this.getLineMaxColumn(r);this._buffer=e,this._bufferDisposable.dispose(),this._bufferDisposable=t,this._increaseVersionId(),this._decorations=Object.create(null),this._decorationsTree=new Mne,this._commandManager.clear(),this._trimAutoWhitespaceLines=null,this._emitContentChangedEvent(new Iy([new o7e],this._versionId,!1,!1),this._createContentChanged2(new F(1,1,r,o),0,n,this.getValue(),!1,!1,!0,!1))}setEOL(e){this._assertNotDisposed();const t=e===1?`\r
`:`
`;if(this._buffer.getEOL()===t)return;const i=this.getFullModelRange(),n=this.getValueLengthInRange(i),r=this.getLineCount(),o=this.getLineMaxColumn(r);this._onBeforeEOLChange(),this._buffer.setEOL(t),this._increaseVersionId(),this._onAfterEOLChange(),this._emitContentChangedEvent(new Iy([new c7e],this._versionId,!1,!1),this._createContentChanged2(new F(1,1,r,o),0,n,this.getValue(),!1,!1,!1,!0))}_onBeforeEOLChange(){this._decorationsTree.ensureAllNodesHaveRanges(this)}_onAfterEOLChange(){const e=this.getVersionId(),t=this._decorationsTree.collectNodesPostOrder();for(let i=0,n=t.length;i<n;i++){const r=t[i],o=r.range,a=r.cachedAbsoluteStart-r.start,l=this._buffer.getOffsetAt(o.startLineNumber,o.startColumn),c=this._buffer.getOffsetAt(o.endLineNumber,o.endColumn);r.cachedAbsoluteStart=l,r.cachedAbsoluteEnd=c,r.cachedVersionId=e,r.start=l-a,r.end=c-a,Xm(r)}}onBeforeAttached(){return this._attachedEditorCount++,this._attachedEditorCount===1&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.attachView()}onBeforeDetached(e){this._attachedEditorCount--,this._attachedEditorCount===0&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.detachView(e)}isAttachedToEditor(){return this._attachedEditorCount>0}getAttachedEditorCount(){return this._attachedEditorCount}isTooLargeForSyncing(){return this._isTooLargeForSyncing}isTooLargeForTokenization(){return this._isTooLargeForTokenization}isTooLargeForHeapOperation(){return this._isTooLargeForHeapOperation}isDisposed(){return this._isDisposed}isDominatedByLongLines(){if(this._assertNotDisposed(),this.isTooLargeForTokenization())return!1;let e=0,t=0;const i=this._buffer.getLineCount();for(let n=1;n<=i;n++){const r=this._buffer.getLineLength(n);r>=g7e?t+=r:e+=r}return t>e}get uri(){return this._associatedResource}getOptions(){return this._assertNotDisposed(),this._options}getFormattingOptions(){return{tabSize:this._options.indentSize,insertSpaces:this._options.insertSpaces}}updateOptions(e){this._assertNotDisposed();const t=typeof e.tabSize<"u"?e.tabSize:this._options.tabSize,i=typeof e.indentSize<"u"?e.indentSize:this._options.originalIndentSize,n=typeof e.insertSpaces<"u"?e.insertSpaces:this._options.insertSpaces,r=typeof e.trimAutoWhitespace<"u"?e.trimAutoWhitespace:this._options.trimAutoWhitespace,o=typeof e.bracketColorizationOptions<"u"?e.bracketColorizationOptions:this._options.bracketPairColorizationOptions,a=new LR({tabSize:t,indentSize:i,insertSpaces:n,defaultEOL:this._options.defaultEOL,trimAutoWhitespace:r,bracketPairColorizationOptions:o});if(this._options.equals(a))return;const l=this._options.createChangeEvent(a);this._options=a,this._bracketPairs.handleDidChangeOptions(l),this._decorationProvider.handleDidChangeOptions(l),this._onDidChangeOptions.fire(l)}detectIndentation(e,t){this._assertNotDisposed();const i=yne(this._buffer,t,e);this.updateOptions({insertSpaces:i.insertSpaces,tabSize:i.tabSize,indentSize:i.tabSize})}normalizeIndentation(e){return this._assertNotDisposed(),WK(e,this._options.indentSize,this._options.insertSpaces)}getVersionId(){return this._assertNotDisposed(),this._versionId}mightContainRTL(){return this._buffer.mightContainRTL()}mightContainUnusualLineTerminators(){return this._buffer.mightContainUnusualLineTerminators()}removeUnusualLineTerminators(e=null){const t=this.findMatches(Nue.source,!1,!0,!1,null,!1,1073741824);this._buffer.resetMightContainUnusualLineTerminators(),this.pushEditOperations(e,t.map(i=>({range:i.range,text:null})),()=>null)}mightContainNonBasicASCII(){return this._buffer.mightContainNonBasicASCII()}getAlternativeVersionId(){return this._assertNotDisposed(),this._alternativeVersionId}getInitialUndoRedoSnapshot(){return this._assertNotDisposed(),this._initialUndoRedoSnapshot}getOffsetAt(e){this._assertNotDisposed();const t=this._validatePosition(e.lineNumber,e.column,0);return this._buffer.getOffsetAt(t.lineNumber,t.column)}getPositionAt(e){this._assertNotDisposed();const t=Math.min(this._buffer.getLength(),Math.max(0,e));return this._buffer.getPositionAt(t)}_increaseVersionId(){this._versionId=this._versionId+1,this._alternativeVersionId=this._versionId}_overwriteVersionId(e){this._versionId=e}_overwriteAlternativeVersionId(e){this._alternativeVersionId=e}_overwriteInitialUndoRedoSnapshot(e){this._initialUndoRedoSnapshot=e}getValue(e,t=!1){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new di("Operation would exceed heap memory limits");const i=this.getFullModelRange(),n=this.getValueInRange(i,e);return t?this._buffer.getBOM()+n:n}createSnapshot(e=!1){return new p7e(this._buffer.createSnapshot(e))}getValueLength(e,t=!1){this._assertNotDisposed();const i=this.getFullModelRange(),n=this.getValueLengthInRange(i,e);return t?this._buffer.getBOM().length+n:n}getValueInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getValueInRange(this.validateRange(e),t)}getValueLengthInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getValueLengthInRange(this.validateRange(e),t)}getCharacterCountInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getCharacterCountInRange(this.validateRange(e),t)}getLineCount(){return this._assertNotDisposed(),this._buffer.getLineCount()}getLineContent(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new di("Illegal value for lineNumber");return this._buffer.getLineContent(e)}getLineLength(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new di("Illegal value for lineNumber");return this._buffer.getLineLength(e)}getLinesContent(){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new di("Operation would exceed heap memory limits");return this._buffer.getLinesContent()}getEOL(){return this._assertNotDisposed(),this._buffer.getEOL()}getEndOfLineSequence(){return this._assertNotDisposed(),this._buffer.getEOL()===`
`?0:1}getLineMinColumn(e){return this._assertNotDisposed(),1}getLineMaxColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new di("Illegal value for lineNumber");return this._buffer.getLineLength(e)+1}getLineFirstNonWhitespaceColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new di("Illegal value for lineNumber");return this._buffer.getLineFirstNonWhitespaceColumn(e)}getLineLastNonWhitespaceColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new di("Illegal value for lineNumber");return this._buffer.getLineLastNonWhitespaceColumn(e)}_validateRangeRelaxedNoAllocations(e){const t=this._buffer.getLineCount(),i=e.startLineNumber,n=e.startColumn;let r=Math.floor(typeof i=="number"&&!isNaN(i)?i:1),o=Math.floor(typeof n=="number"&&!isNaN(n)?n:1);if(r<1)r=1,o=1;else if(r>t)r=t,o=this.getLineMaxColumn(r);else if(o<=1)o=1;else{const u=this.getLineMaxColumn(r);o>=u&&(o=u)}const a=e.endLineNumber,l=e.endColumn;let c=Math.floor(typeof a=="number"&&!isNaN(a)?a:1),d=Math.floor(typeof l=="number"&&!isNaN(l)?l:1);if(c<1)c=1,d=1;else if(c>t)c=t,d=this.getLineMaxColumn(c);else if(d<=1)d=1;else{const u=this.getLineMaxColumn(c);d>=u&&(d=u)}return i===r&&n===o&&a===c&&l===d&&e instanceof F&&!(e instanceof Ue)?e:new F(r,o,c,d)}_isValidPosition(e,t,i){if(typeof e!="number"||typeof t!="number"||isNaN(e)||isNaN(t)||e<1||t<1||(e|0)!==e||(t|0)!==t)return!1;const n=this._buffer.getLineCount();if(e>n)return!1;if(t===1)return!0;const r=this.getLineMaxColumn(e);if(t>r)return!1;if(i===1){const o=this._buffer.getLineCharCode(e,t-2);if(ws(o))return!1}return!0}_validatePosition(e,t,i){const n=Math.floor(typeof e=="number"&&!isNaN(e)?e:1),r=Math.floor(typeof t=="number"&&!isNaN(t)?t:1),o=this._buffer.getLineCount();if(n<1)return new X(1,1);if(n>o)return new X(o,this.getLineMaxColumn(o));if(r<=1)return new X(n,1);const a=this.getLineMaxColumn(n);if(r>=a)return new X(n,a);if(i===1){const l=this._buffer.getLineCharCode(n,r-2);if(ws(l))return new X(n,r-1)}return new X(n,r)}validatePosition(e){return this._assertNotDisposed(),e instanceof X&&this._isValidPosition(e.lineNumber,e.column,1)?e:this._validatePosition(e.lineNumber,e.column,1)}_isValidRange(e,t){const i=e.startLineNumber,n=e.startColumn,r=e.endLineNumber,o=e.endColumn;if(!this._isValidPosition(i,n,0)||!this._isValidPosition(r,o,0))return!1;if(t===1){const a=n>1?this._buffer.getLineCharCode(i,n-2):0,l=o>1&&o<=this._buffer.getLineLength(r)?this._buffer.getLineCharCode(r,o-2):0,c=ws(a),d=ws(l);return!c&&!d}return!0}validateRange(e){if(this._assertNotDisposed(),e instanceof F&&!(e instanceof Ue)&&this._isValidRange(e,1))return e;const i=this._validatePosition(e.startLineNumber,e.startColumn,0),n=this._validatePosition(e.endLineNumber,e.endColumn,0),r=i.lineNumber,o=i.column,a=n.lineNumber,l=n.column;{const c=o>1?this._buffer.getLineCharCode(r,o-2):0,d=l>1&&l<=this._buffer.getLineLength(a)?this._buffer.getLineCharCode(a,l-2):0,u=ws(c),h=ws(d);return!u&&!h?new F(r,o,a,l):r===a&&o===l?new F(r,o-1,a,l-1):u&&h?new F(r,o-1,a,l+1):u?new F(r,o-1,a,l):new F(r,o,a,l+1)}}modifyPosition(e,t){this._assertNotDisposed();const i=this.getOffsetAt(e)+t;return this.getPositionAt(Math.min(this._buffer.getLength(),Math.max(0,i)))}getFullModelRange(){this._assertNotDisposed();const e=this.getLineCount();return new F(1,1,e,this.getLineMaxColumn(e))}findMatchesLineByLine(e,t,i,n){return this._buffer.findMatchesLineByLine(e,t,i,n)}findMatches(e,t,i,n,r,o,a=f7e){this._assertNotDisposed();let l=null;t!==null&&(Array.isArray(t)||(t=[t]),t.every(u=>F.isIRange(u))&&(l=t.map(u=>this.validateRange(u)))),l===null&&(l=[this.getFullModelRange()]),l=l.sort((u,h)=>u.startLineNumber-h.startLineNumber||u.startColumn-h.startColumn);const c=[];c.push(l.reduce((u,h)=>F.areIntersecting(u,h)?u.plusRange(h):(c.push(u),h)));let d;if(!i&&e.indexOf(`
`)<0){const h=new ob(e,i,n,r).parseSearchRequest();if(!h)return[];d=g=>this.findMatchesLineByLine(g,h,o,a)}else d=u=>nN.findMatches(this,new ob(e,i,n,r),u,o,a);return c.map(d).reduce((u,h)=>u.concat(h),[])}findNextMatch(e,t,i,n,r,o){this._assertNotDisposed();const a=this.validatePosition(t);if(!i&&e.indexOf(`
`)<0){const c=new ob(e,i,n,r).parseSearchRequest();if(!c)return null;const d=this.getLineCount();let u=new F(a.lineNumber,a.column,d,this.getLineMaxColumn(d)),h=this.findMatchesLineByLine(u,c,o,1);return nN.findNextMatch(this,new ob(e,i,n,r),a,o),h.length>0||(u=new F(1,1,a.lineNumber,this.getLineMaxColumn(a.lineNumber)),h=this.findMatchesLineByLine(u,c,o,1),h.length>0)?h[0]:null}return nN.findNextMatch(this,new ob(e,i,n,r),a,o)}findPreviousMatch(e,t,i,n,r,o){this._assertNotDisposed();const a=this.validatePosition(t);return nN.findPreviousMatch(this,new ob(e,i,n,r),a,o)}pushStackElement(){this._commandManager.pushStackElement()}popStackElement(){this._commandManager.popStackElement()}pushEOL(e){if((this.getEOL()===`
`?0:1)!==e)try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEOL(e)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_validateEditOperation(e){return e instanceof _V?e:new _V(e.identifier||null,this.validateRange(e.range),e.text,e.forceMoveMarkers||!1,e.isAutoWhitespaceEdit||!1,e._isTracked||!1)}_validateEditOperations(e){const t=[];for(let i=0,n=e.length;i<n;i++)t[i]=this._validateEditOperation(e[i]);return t}pushEditOperations(e,t,i,n){try{return this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._pushEditOperations(e,this._validateEditOperations(t),i,n)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_pushEditOperations(e,t,i,n){if(this._options.trimAutoWhitespace&&this._trimAutoWhitespaceLines){const r=t.map(a=>({range:this.validateRange(a.range),text:a.text}));let o=!0;if(e)for(let a=0,l=e.length;a<l;a++){const c=e[a];let d=!1;for(let u=0,h=r.length;u<h;u++){const g=r[u].range,p=g.startLineNumber>c.endLineNumber,_=c.startLineNumber>g.endLineNumber;if(!p&&!_){d=!0;break}}if(!d){o=!1;break}}if(o)for(let a=0,l=this._trimAutoWhitespaceLines.length;a<l;a++){const c=this._trimAutoWhitespaceLines[a],d=this.getLineMaxColumn(c);let u=!0;for(let h=0,g=r.length;h<g;h++){const p=r[h].range,_=r[h].text;if(!(c<p.startLineNumber||c>p.endLineNumber)&&!(c===p.startLineNumber&&p.startColumn===d&&p.isEmpty()&&_&&_.length>0&&_.charAt(0)===`
`)&&!(c===p.startLineNumber&&p.startColumn===1&&p.isEmpty()&&_&&_.length>0&&_.charAt(_.length-1)===`
`)){u=!1;break}}if(u){const h=new F(c,1,c,d);t.push(new _V(null,h,null,!1,!1,!1))}}this._trimAutoWhitespaceLines=null}return this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEditOperation(e,t,i,n)}_applyUndo(e,t,i,n){const r=e.map(o=>{const a=this.getPositionAt(o.newPosition),l=this.getPositionAt(o.newEnd);return{range:new F(a.lineNumber,a.column,l.lineNumber,l.column),text:o.oldText}});this._applyUndoRedoEdits(r,t,!0,!1,i,n)}_applyRedo(e,t,i,n){const r=e.map(o=>{const a=this.getPositionAt(o.oldPosition),l=this.getPositionAt(o.oldEnd);return{range:new F(a.lineNumber,a.column,l.lineNumber,l.column),text:o.newText}});this._applyUndoRedoEdits(r,t,!1,!0,i,n)}_applyUndoRedoEdits(e,t,i,n,r,o){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._isUndoing=i,this._isRedoing=n,this.applyEdits(e,!1),this.setEOL(t),this._overwriteAlternativeVersionId(r)}finally{this._isUndoing=!1,this._isRedoing=!1,this._eventEmitter.endDeferredEmit(o),this._onDidChangeDecorations.endDeferredEmit()}}applyEdits(e,t=!1){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit();const i=this._validateEditOperations(e);return this._doApplyEdits(i,t)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_doApplyEdits(e,t){const i=this._buffer.getLineCount(),n=this._buffer.applyEdits(e,this._options.trimAutoWhitespace,t),r=this._buffer.getLineCount(),o=n.changes;if(this._trimAutoWhitespaceLines=n.trimAutoWhitespaceLineNumbers,o.length!==0){for(let c=0,d=o.length;c<d;c++){const u=o[c];this._decorationsTree.acceptReplace(u.rangeOffset,u.rangeLength,u.text.length,u.forceMoveMarkers)}const a=[];this._increaseVersionId();let l=i;for(let c=0,d=o.length;c<d;c++){const u=o[c],[h]=Gm(u.text);this._onDidChangeDecorations.fire();const g=u.range.startLineNumber,p=u.range.endLineNumber,_=p-g,v=h,C=Math.min(_,v),y=v-_,x=r-l-y+g,L=x,I=x+v,A=this._decorationsTree.getInjectedTextInInterval(this,this.getOffsetAt(new X(L,1)),this.getOffsetAt(new X(I,this.getLineMaxColumn(I))),0),D=fu.fromDecorations(A),N=new Cg(D);for(let R=C;R>=0;R--){const W=g+R,H=x+R;N.takeFromEndWhile(B=>B.lineNumber>H);const U=N.takeFromEndWhile(B=>B.lineNumber===H);a.push(new Ane(W,this.getLineContent(H),U))}if(C<_){const R=g+C;a.push(new a7e(R+1,p))}if(C<v){const R=new Cg(D),W=g+C,H=v-C,U=r-l-H+W+1,B=[],ee=[];for(let re=0;re<H;re++){const pe=U+re;ee[re]=this.getLineContent(pe),R.takeWhile(Ie=>Ie.lineNumber<pe),B[re]=R.takeWhile(Ie=>Ie.lineNumber===pe)}a.push(new l7e(W+1,g+v,ee,B))}l+=y}this._emitContentChangedEvent(new Iy(a,this.getVersionId(),this._isUndoing,this._isRedoing),{changes:o,eol:this._buffer.getEOL(),isEolChange:!1,versionId:this.getVersionId(),isUndoing:this._isUndoing,isRedoing:this._isRedoing,isFlush:!1})}return n.reverseEdits===null?void 0:n.reverseEdits}undo(){return this._undoRedoService.undo(this.uri)}canUndo(){return this._undoRedoService.canUndo(this.uri)}redo(){return this._undoRedoService.redo(this.uri)}canRedo(){return this._undoRedoService.canRedo(this.uri)}handleBeforeFireDecorationsChangedEvent(e){if(e===null||e.size===0)return;const i=Array.from(e).map(n=>new Ane(n,this.getLineContent(n),this._getInjectedTextInLine(n)));this._onDidChangeInjectedText.fire(new Uge(i))}changeDecorations(e,t=0){this._assertNotDisposed();try{return this._onDidChangeDecorations.beginDeferredEmit(),this._changeDecorations(t,e)}finally{this._onDidChangeDecorations.endDeferredEmit()}}_changeDecorations(e,t){const i={addDecoration:(r,o)=>this._deltaDecorationsImpl(e,[],[{range:r,options:o}])[0],changeDecoration:(r,o)=>{this._changeDecorationImpl(r,o)},changeDecorationOptions:(r,o)=>{this._changeDecorationOptionsImpl(r,Fne(o))},removeDecoration:r=>{this._deltaDecorationsImpl(e,[r],[])},deltaDecorations:(r,o)=>r.length===0&&o.length===0?[]:this._deltaDecorationsImpl(e,r,o)};let n=null;try{n=t(i)}catch(r){ft(r)}return i.addDecoration=Tx,i.changeDecoration=Tx,i.changeDecorationOptions=Tx,i.removeDecoration=Tx,i.deltaDecorations=Tx,n}deltaDecorations(e,t,i=0){if(this._assertNotDisposed(),e||(e=[]),e.length===0&&t.length===0)return[];try{return this._deltaDecorationCallCnt++,this._deltaDecorationCallCnt>1&&(console.warn("Invoking deltaDecorations recursively could lead to leaking decorations."),ft(new Error("Invoking deltaDecorations recursively could lead to leaking decorations."))),this._onDidChangeDecorations.beginDeferredEmit(),this._deltaDecorationsImpl(i,e,t)}finally{this._onDidChangeDecorations.endDeferredEmit(),this._deltaDecorationCallCnt--}}_getTrackedRange(e){return this.getDecorationRange(e)}_setTrackedRange(e,t,i){const n=e?this._decorations[e]:null;if(!n)return t?this._deltaDecorationsImpl(0,[],[{range:t,options:One[i]}],!0)[0]:null;if(!t)return this._decorationsTree.delete(n),delete this._decorations[n.id],null;const r=this._validateRangeRelaxedNoAllocations(t),o=this._buffer.getOffsetAt(r.startLineNumber,r.startColumn),a=this._buffer.getOffsetAt(r.endLineNumber,r.endColumn);return this._decorationsTree.delete(n),n.reset(this.getVersionId(),o,a,r),n.setOptions(One[i]),this._decorationsTree.insert(n),n.id}removeAllDecorationsWithOwnerId(e){if(this._isDisposed)return;const t=this._decorationsTree.collectNodesFromOwner(e);for(let i=0,n=t.length;i<n;i++){const r=t[i];this._decorationsTree.delete(r),delete this._decorations[r.id]}}getDecorationOptions(e){const t=this._decorations[e];return t?t.options:null}getDecorationRange(e){const t=this._decorations[e];return t?this._decorationsTree.getNodeRange(this,t):null}getLineDecorations(e,t=0,i=!1){return e<1||e>this.getLineCount()?[]:this.getLinesDecorations(e,e,t,i)}getLinesDecorations(e,t,i=0,n=!1,r=!1){const o=this.getLineCount(),a=Math.min(o,Math.max(1,e)),l=Math.min(o,Math.max(1,t)),c=this.getLineMaxColumn(l),d=new F(a,1,l,c),u=this._getDecorationsInRange(d,i,n,r);return N7(u,this._decorationProvider.getDecorationsInRange(d,i,n)),u}getDecorationsInRange(e,t=0,i=!1,n=!1,r=!1){const o=this.validateRange(e),a=this._getDecorationsInRange(o,t,i,r);return N7(a,this._decorationProvider.getDecorationsInRange(o,t,i,n)),a}getOverviewRulerDecorations(e=0,t=!1){return this._decorationsTree.getAll(this,e,t,!0,!1)}getInjectedTextDecorations(e=0){return this._decorationsTree.getAllInjectedText(this,e)}_getInjectedTextInLine(e){const t=this._buffer.getOffsetAt(e,1),i=t+this._buffer.getLineLength(e),n=this._decorationsTree.getInjectedTextInInterval(this,t,i,0);return fu.fromDecorations(n).filter(r=>r.lineNumber===e)}getAllDecorations(e=0,t=!1){let i=this._decorationsTree.getAll(this,e,t,!1,!1);return i=i.concat(this._decorationProvider.getAllDecorations(e,t)),i}getAllMarginDecorations(e=0){return this._decorationsTree.getAll(this,e,!1,!1,!0)}_getDecorationsInRange(e,t,i,n){const r=this._buffer.getOffsetAt(e.startLineNumber,e.startColumn),o=this._buffer.getOffsetAt(e.endLineNumber,e.endColumn);return this._decorationsTree.getAllInInterval(this,r,o,t,i,n)}getRangeAt(e,t){return this._buffer.getRangeAt(e,t-e)}_changeDecorationImpl(e,t){const i=this._decorations[e];if(!i)return;if(i.options.after){const a=this.getDecorationRange(e);this._onDidChangeDecorations.recordLineAffectedByInjectedText(a.endLineNumber)}if(i.options.before){const a=this.getDecorationRange(e);this._onDidChangeDecorations.recordLineAffectedByInjectedText(a.startLineNumber)}const n=this._validateRangeRelaxedNoAllocations(t),r=this._buffer.getOffsetAt(n.startLineNumber,n.startColumn),o=this._buffer.getOffsetAt(n.endLineNumber,n.endColumn);this._decorationsTree.delete(i),i.reset(this.getVersionId(),r,o,n),this._decorationsTree.insert(i),this._onDidChangeDecorations.checkAffectedAndFire(i.options),i.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(n.endLineNumber),i.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(n.startLineNumber)}_changeDecorationOptionsImpl(e,t){const i=this._decorations[e];if(!i)return;const n=!!(i.options.overviewRuler&&i.options.overviewRuler.color),r=!!(t.overviewRuler&&t.overviewRuler.color);if(this._onDidChangeDecorations.checkAffectedAndFire(i.options),this._onDidChangeDecorations.checkAffectedAndFire(t),i.options.after||t.after){const l=this._decorationsTree.getNodeRange(this,i);this._onDidChangeDecorations.recordLineAffectedByInjectedText(l.endLineNumber)}if(i.options.before||t.before){const l=this._decorationsTree.getNodeRange(this,i);this._onDidChangeDecorations.recordLineAffectedByInjectedText(l.startLineNumber)}const o=n!==r,a=_7e(t)!==OR(i);o||a?(this._decorationsTree.delete(i),i.setOptions(t),this._decorationsTree.insert(i)):i.setOptions(t)}_deltaDecorationsImpl(e,t,i,n=!1){const r=this.getVersionId(),o=t.length;let a=0;const l=i.length;let c=0;this._onDidChangeDecorations.beginDeferredEmit();try{const d=new Array(l);for(;a<o||c<l;){let u=null;if(a<o){do u=this._decorations[t[a++]];while(!u&&a<o);if(u){if(u.options.after){const h=this._decorationsTree.getNodeRange(this,u);this._onDidChangeDecorations.recordLineAffectedByInjectedText(h.endLineNumber)}if(u.options.before){const h=this._decorationsTree.getNodeRange(this,u);this._onDidChangeDecorations.recordLineAffectedByInjectedText(h.startLineNumber)}this._decorationsTree.delete(u),n||this._onDidChangeDecorations.checkAffectedAndFire(u.options)}}if(c<l){if(!u){const C=++this._lastDecorationId,y=`${this._instanceId};${C}`;u=new Oge(y,0,0),this._decorations[y]=u}const h=i[c],g=this._validateRangeRelaxedNoAllocations(h.range),p=Fne(h.options),_=this._buffer.getOffsetAt(g.startLineNumber,g.startColumn),v=this._buffer.getOffsetAt(g.endLineNumber,g.endColumn);u.ownerId=e,u.reset(r,_,v,g),u.setOptions(p),u.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(g.endLineNumber),u.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(g.startLineNumber),n||this._onDidChangeDecorations.checkAffectedAndFire(p),this._decorationsTree.insert(u),d[c]=u.id,c++}else u&&delete this._decorations[u.id]}return d}finally{this._onDidChangeDecorations.endDeferredEmit()}}getLanguageId(){return this.tokenization.getLanguageId()}setLanguage(e,t){typeof e=="string"?(this._languageSelectionListener.clear(),this._setLanguage(e,t)):(this._languageSelectionListener.value=e.onDidChange(()=>this._setLanguage(e.languageId,t)),this._setLanguage(e.languageId,t))}_setLanguage(e,t){this.tokenization.setLanguageId(e,t),this._languageService.requestRichLanguageFeatures(e)}getLanguageIdAtPosition(e,t){return this.tokenization.getLanguageIdAtPosition(e,t)}getWordAtPosition(e){return this._tokenizationTextModelPart.getWordAtPosition(e)}getWordUntilPosition(e){return this._tokenizationTextModelPart.getWordUntilPosition(e)}normalizePosition(e,t){return e}getLineIndentColumn(e){return m7e(this.getLineContent(e))+1}},ab=Kd,Kd._MODEL_SYNC_LIMIT=50*1024*1024,Kd.LARGE_FILE_SIZE_THRESHOLD=20*1024*1024,Kd.LARGE_FILE_LINE_COUNT_THRESHOLD=300*1e3,Kd.LARGE_FILE_HEAP_OPERATION_THRESHOLD=256*1024*1024,Kd.DEFAULT_CREATION_OPTIONS={isForSimpleWidget:!1,tabSize:xr.tabSize,indentSize:xr.indentSize,insertSpaces:xr.insertSpaces,detectIndentation:!1,defaultEOL:1,trimAutoWhitespace:xr.trimAutoWhitespace,largeFileOptimizations:xr.largeFileOptimizations,bracketPairColorizationOptions:xr.bracketPairColorizationOptions},Kd);Jd=ab=d7e([yN(4,iK),yN(5,un),yN(6,bn),yN(7,Xe)],Jd);function m7e(s){let e=0;for(const t of s)if(t===" "||t==="	")e++;else break;return e}function $V(s){return!!(s.options.overviewRuler&&s.options.overviewRuler.color)}function _7e(s){return!!s.after||!!s.before}function OR(s){return!!s.options.after||!!s.options.before}class Mne{constructor(){this._decorationsTree0=new HV,this._decorationsTree1=new HV,this._injectedTextDecorationsTree=new HV}ensureAllNodesHaveRanges(e){this.getAll(e,0,!1,!1,!1)}_ensureNodesHaveRanges(e,t){for(const i of t)i.range===null&&(i.range=e.getRangeAt(i.cachedAbsoluteStart,i.cachedAbsoluteEnd));return t}getAllInInterval(e,t,i,n,r,o){const a=e.getVersionId(),l=this._intervalSearch(t,i,n,r,a,o);return this._ensureNodesHaveRanges(e,l)}_intervalSearch(e,t,i,n,r,o){const a=this._decorationsTree0.intervalSearch(e,t,i,n,r,o),l=this._decorationsTree1.intervalSearch(e,t,i,n,r,o),c=this._injectedTextDecorationsTree.intervalSearch(e,t,i,n,r,o);return a.concat(l).concat(c)}getInjectedTextInInterval(e,t,i,n){const r=e.getVersionId(),o=this._injectedTextDecorationsTree.intervalSearch(t,i,n,!1,r,!1);return this._ensureNodesHaveRanges(e,o).filter(a=>a.options.showIfCollapsed||!a.range.isEmpty())}getAllInjectedText(e,t){const i=e.getVersionId(),n=this._injectedTextDecorationsTree.search(t,!1,i,!1);return this._ensureNodesHaveRanges(e,n).filter(r=>r.options.showIfCollapsed||!r.range.isEmpty())}getAll(e,t,i,n,r){const o=e.getVersionId(),a=this._search(t,i,n,o,r);return this._ensureNodesHaveRanges(e,a)}_search(e,t,i,n,r){if(i)return this._decorationsTree1.search(e,t,n,r);{const o=this._decorationsTree0.search(e,t,n,r),a=this._decorationsTree1.search(e,t,n,r),l=this._injectedTextDecorationsTree.search(e,t,n,r);return o.concat(a).concat(l)}}collectNodesFromOwner(e){const t=this._decorationsTree0.collectNodesFromOwner(e),i=this._decorationsTree1.collectNodesFromOwner(e),n=this._injectedTextDecorationsTree.collectNodesFromOwner(e);return t.concat(i).concat(n)}collectNodesPostOrder(){const e=this._decorationsTree0.collectNodesPostOrder(),t=this._decorationsTree1.collectNodesPostOrder(),i=this._injectedTextDecorationsTree.collectNodesPostOrder();return e.concat(t).concat(i)}insert(e){OR(e)?this._injectedTextDecorationsTree.insert(e):$V(e)?this._decorationsTree1.insert(e):this._decorationsTree0.insert(e)}delete(e){OR(e)?this._injectedTextDecorationsTree.delete(e):$V(e)?this._decorationsTree1.delete(e):this._decorationsTree0.delete(e)}getNodeRange(e,t){const i=e.getVersionId();return t.cachedVersionId!==i&&this._resolveNode(t,i),t.range===null&&(t.range=e.getRangeAt(t.cachedAbsoluteStart,t.cachedAbsoluteEnd)),t.range}_resolveNode(e,t){OR(e)?this._injectedTextDecorationsTree.resolveNode(e,t):$V(e)?this._decorationsTree1.resolveNode(e,t):this._decorationsTree0.resolveNode(e,t)}acceptReplace(e,t,i,n){this._decorationsTree0.acceptReplace(e,t,i,n),this._decorationsTree1.acceptReplace(e,t,i,n),this._injectedTextDecorationsTree.acceptReplace(e,t,i,n)}}function Bu(s){return s.replace(/[^a-z0-9\-_]/gi," ")}class jge{constructor(e){this.color=e.color||"",this.darkColor=e.darkColor||""}}class b7e extends jge{constructor(e){super(e),this._resolvedColor=null,this.position=typeof e.position=="number"?e.position:Il.Center}getColor(e){return this._resolvedColor||(e.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=null}_resolveColor(e,t){if(typeof e=="string")return e;const i=e?t.getColor(e.id):null;return i?i.toString():""}}class v7e{constructor(e){this.position=(e==null?void 0:e.position)??ld.Center,this.persistLane=e==null?void 0:e.persistLane}}class w7e extends jge{constructor(e){super(e),this.position=e.position,this.sectionHeaderStyle=e.sectionHeaderStyle??null,this.sectionHeaderText=e.sectionHeaderText??null}getColor(e){return this._resolvedColor||(e.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=void 0}_resolveColor(e,t){return typeof e=="string"?fe.fromHex(e):t.getColor(e.id)}}class Zm{static from(e){return e instanceof Zm?e:new Zm(e)}constructor(e){this.content=e.content||"",this.inlineClassName=e.inlineClassName||null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.attachedData=e.attachedData||null,this.cursorStops=e.cursorStops||null}}class _t{static register(e){return new _t(e)}static createDynamic(e){return new _t(e)}constructor(e){this.description=e.description,this.blockClassName=e.blockClassName?Bu(e.blockClassName):null,this.blockDoesNotCollapse=e.blockDoesNotCollapse??null,this.blockIsAfterEnd=e.blockIsAfterEnd??null,this.blockPadding=e.blockPadding??null,this.stickiness=e.stickiness||0,this.zIndex=e.zIndex||0,this.className=e.className?Bu(e.className):null,this.shouldFillLineOnLineBreak=e.shouldFillLineOnLineBreak??null,this.hoverMessage=e.hoverMessage||null,this.glyphMarginHoverMessage=e.glyphMarginHoverMessage||null,this.lineNumberHoverMessage=e.lineNumberHoverMessage||null,this.isWholeLine=e.isWholeLine||!1,this.showIfCollapsed=e.showIfCollapsed||!1,this.collapseOnReplaceEdit=e.collapseOnReplaceEdit||!1,this.overviewRuler=e.overviewRuler?new b7e(e.overviewRuler):null,this.minimap=e.minimap?new w7e(e.minimap):null,this.glyphMargin=e.glyphMarginClassName?new v7e(e.glyphMargin):null,this.glyphMarginClassName=e.glyphMarginClassName?Bu(e.glyphMarginClassName):null,this.linesDecorationsClassName=e.linesDecorationsClassName?Bu(e.linesDecorationsClassName):null,this.lineNumberClassName=e.lineNumberClassName?Bu(e.lineNumberClassName):null,this.linesDecorationsTooltip=e.linesDecorationsTooltip?ORe(e.linesDecorationsTooltip):null,this.firstLineDecorationClassName=e.firstLineDecorationClassName?Bu(e.firstLineDecorationClassName):null,this.marginClassName=e.marginClassName?Bu(e.marginClassName):null,this.inlineClassName=e.inlineClassName?Bu(e.inlineClassName):null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.beforeContentClassName=e.beforeContentClassName?Bu(e.beforeContentClassName):null,this.afterContentClassName=e.afterContentClassName?Bu(e.afterContentClassName):null,this.after=e.after?Zm.from(e.after):null,this.before=e.before?Zm.from(e.before):null,this.hideInCommentTokens=e.hideInCommentTokens??!1,this.hideInStringTokens=e.hideInStringTokens??!1}}_t.EMPTY=_t.register({description:"empty"});const One=[_t.register({description:"tracked-range-always-grows-when-typing-at-edges",stickiness:0}),_t.register({description:"tracked-range-never-grows-when-typing-at-edges",stickiness:1}),_t.register({description:"tracked-range-grows-only-when-typing-before",stickiness:2}),_t.register({description:"tracked-range-grows-only-when-typing-after",stickiness:3})];function Fne(s){return s instanceof _t?s:_t.createDynamic(s)}class C7e extends te{constructor(e){super(),this.handleBeforeFire=e,this._actual=this._register(new Z),this.event=this._actual.event,this._affectedInjectedTextLines=null,this._deferredCnt=0,this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._affectsLineNumber=!1}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(){var e;this._deferredCnt--,this._deferredCnt===0&&(this._shouldFireDeferred&&this.doFire(),(e=this._affectedInjectedTextLines)==null||e.clear(),this._affectedInjectedTextLines=null)}recordLineAffectedByInjectedText(e){this._affectedInjectedTextLines||(this._affectedInjectedTextLines=new Set),this._affectedInjectedTextLines.add(e)}checkAffectedAndFire(e){var t,i;this._affectsMinimap||(this._affectsMinimap=!!((t=e.minimap)!=null&&t.position)),this._affectsOverviewRuler||(this._affectsOverviewRuler=!!((i=e.overviewRuler)!=null&&i.color)),this._affectsGlyphMargin||(this._affectsGlyphMargin=!!e.glyphMarginClassName),this._affectsLineNumber||(this._affectsLineNumber=!!e.lineNumberClassName),this.tryFire()}fire(){this._affectsMinimap=!0,this._affectsOverviewRuler=!0,this._affectsGlyphMargin=!0,this.tryFire()}tryFire(){this._deferredCnt===0?this.doFire():this._shouldFireDeferred=!0}doFire(){this.handleBeforeFire(this._affectedInjectedTextLines);const e={affectsMinimap:this._affectsMinimap,affectsOverviewRuler:this._affectsOverviewRuler,affectsGlyphMargin:this._affectsGlyphMargin,affectsLineNumber:this._affectsLineNumber};this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._actual.fire(e)}}class y7e extends te{constructor(){super(),this._fastEmitter=this._register(new Z),this.fastEvent=this._fastEmitter.event,this._slowEmitter=this._register(new Z),this.slowEvent=this._slowEmitter.event,this._deferredCnt=0,this._deferredEvent=null}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(e=null){if(this._deferredCnt--,this._deferredCnt===0&&this._deferredEvent!==null){this._deferredEvent.rawContentChangedEvent.resultingSelection=e;const t=this._deferredEvent;this._deferredEvent=null,this._fastEmitter.fire(t),this._slowEmitter.fire(t)}}fire(e){if(this._deferredCnt>0){this._deferredEvent?this._deferredEvent=this._deferredEvent.merge(e):this._deferredEvent=e;return}this._fastEmitter.fire(e),this._slowEmitter.fire(e)}}var S7e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},xN=function(s,e){return function(t,i){e(t,i,s)}},fC;function G_(s){return s.toString()}let x7e=class{constructor(e,t,i){this.model=e,this._modelEventListeners=new ce,this.model=e,this._modelEventListeners.add(e.onWillDispose(()=>t(e))),this._modelEventListeners.add(e.onDidChangeLanguage(n=>i(e,n)))}dispose(){this._modelEventListeners.dispose()}};const L7e=Lo||Wt?1:2;class k7e{constructor(e,t,i,n,r,o,a,l){this.uri=e,this.initialUndoRedoSnapshot=t,this.time=i,this.sharesUndoRedoStack=n,this.heapSize=r,this.sha1=o,this.versionId=a,this.alternativeVersionId=l}}var lv;let A8=(lv=class extends te{constructor(e,t,i,n){super(),this._configurationService=e,this._resourcePropertiesService=t,this._undoRedoService=i,this._instantiationService=n,this._onModelAdded=this._register(new Z),this.onModelAdded=this._onModelAdded.event,this._onModelRemoved=this._register(new Z),this.onModelRemoved=this._onModelRemoved.event,this._onModelModeChanged=this._register(new Z),this.onModelLanguageChanged=this._onModelModeChanged.event,this._modelCreationOptionsByLanguageAndResource=Object.create(null),this._models={},this._disposedModels=new Map,this._disposedModelsHeapSize=0,this._register(this._configurationService.onDidChangeConfiguration(r=>this._updateModelOptions(r))),this._updateModelOptions(void 0)}static _readModelOptions(e,t){var h;let i=xr.tabSize;if(e.editor&&typeof e.editor.tabSize<"u"){const g=parseInt(e.editor.tabSize,10);isNaN(g)||(i=g),i<1&&(i=1)}let n="tabSize";if(e.editor&&typeof e.editor.indentSize<"u"&&e.editor.indentSize!=="tabSize"){const g=parseInt(e.editor.indentSize,10);isNaN(g)||(n=Math.max(g,1))}let r=xr.insertSpaces;e.editor&&typeof e.editor.insertSpaces<"u"&&(r=e.editor.insertSpaces==="false"?!1:!!e.editor.insertSpaces);let o=L7e;const a=e.eol;a===`\r
`?o=2:a===`
`&&(o=1);let l=xr.trimAutoWhitespace;e.editor&&typeof e.editor.trimAutoWhitespace<"u"&&(l=e.editor.trimAutoWhitespace==="false"?!1:!!e.editor.trimAutoWhitespace);let c=xr.detectIndentation;e.editor&&typeof e.editor.detectIndentation<"u"&&(c=e.editor.detectIndentation==="false"?!1:!!e.editor.detectIndentation);let d=xr.largeFileOptimizations;e.editor&&typeof e.editor.largeFileOptimizations<"u"&&(d=e.editor.largeFileOptimizations==="false"?!1:!!e.editor.largeFileOptimizations);let u=xr.bracketPairColorizationOptions;return(h=e.editor)!=null&&h.bracketPairColorization&&typeof e.editor.bracketPairColorization=="object"&&(u={enabled:!!e.editor.bracketPairColorization.enabled,independentColorPoolPerBracketType:!!e.editor.bracketPairColorization.independentColorPoolPerBracketType}),{isForSimpleWidget:t,tabSize:i,indentSize:n,insertSpaces:r,detectIndentation:c,defaultEOL:o,trimAutoWhitespace:l,largeFileOptimizations:d,bracketPairColorizationOptions:u}}_getEOL(e,t){if(e)return this._resourcePropertiesService.getEOL(e,t);const i=this._configurationService.getValue("files.eol",{overrideIdentifier:t});return i&&typeof i=="string"&&i!=="auto"?i:Da===3||Da===2?`
`:`\r
`}_shouldRestoreUndoStack(){const e=this._configurationService.getValue("files.restoreUndoStack");return typeof e=="boolean"?e:!0}getCreationOptions(e,t,i){const n=typeof e=="string"?e:e.languageId;let r=this._modelCreationOptionsByLanguageAndResource[n+t];if(!r){const o=this._configurationService.getValue("editor",{overrideIdentifier:n,resource:t}),a=this._getEOL(t,n);r=fC._readModelOptions({editor:o,eol:a},i),this._modelCreationOptionsByLanguageAndResource[n+t]=r}return r}_updateModelOptions(e){const t=this._modelCreationOptionsByLanguageAndResource;this._modelCreationOptionsByLanguageAndResource=Object.create(null);const i=Object.keys(this._models);for(let n=0,r=i.length;n<r;n++){const o=i[n],a=this._models[o],l=a.model.getLanguageId(),c=a.model.uri;if(e&&!e.affectsConfiguration("editor",{overrideIdentifier:l,resource:c})&&!e.affectsConfiguration("files.eol",{overrideIdentifier:l,resource:c}))continue;const d=t[l+c],u=this.getCreationOptions(l,c,a.model.isForSimpleWidget);fC._setModelOptionsForModel(a.model,u,d)}}static _setModelOptionsForModel(e,t,i){i&&i.defaultEOL!==t.defaultEOL&&e.getLineCount()===1&&e.setEOL(t.defaultEOL===1?0:1),!(i&&i.detectIndentation===t.detectIndentation&&i.insertSpaces===t.insertSpaces&&i.tabSize===t.tabSize&&i.indentSize===t.indentSize&&i.trimAutoWhitespace===t.trimAutoWhitespace&&Ta(i.bracketPairColorizationOptions,t.bracketPairColorizationOptions))&&(t.detectIndentation?(e.detectIndentation(t.insertSpaces,t.tabSize),e.updateOptions({trimAutoWhitespace:t.trimAutoWhitespace,bracketColorizationOptions:t.bracketPairColorizationOptions})):e.updateOptions({insertSpaces:t.insertSpaces,tabSize:t.tabSize,indentSize:t.indentSize,trimAutoWhitespace:t.trimAutoWhitespace,bracketColorizationOptions:t.bracketPairColorizationOptions}))}_insertDisposedModel(e){this._disposedModels.set(G_(e.uri),e),this._disposedModelsHeapSize+=e.heapSize}_removeDisposedModel(e){const t=this._disposedModels.get(G_(e));return t&&(this._disposedModelsHeapSize-=t.heapSize),this._disposedModels.delete(G_(e)),t}_ensureDisposedModelsHeapSize(e){if(this._disposedModelsHeapSize>e){const t=[];for(this._disposedModels.forEach(i=>{i.sharesUndoRedoStack||t.push(i)}),t.sort((i,n)=>i.time-n.time);t.length>0&&this._disposedModelsHeapSize>e;){const i=t.shift();this._removeDisposedModel(i.uri),i.initialUndoRedoSnapshot!==null&&this._undoRedoService.restoreSnapshot(i.initialUndoRedoSnapshot)}}}_createModelData(e,t,i,n){const r=this.getCreationOptions(t,i,n),o=this._instantiationService.createInstance(Jd,e,t,r,i);if(i&&this._disposedModels.has(G_(i))){const c=this._removeDisposedModel(i),d=this._undoRedoService.getElements(i),u=this._getSHA1Computer(),h=u.canComputeSHA1(o)?u.computeSHA1(o)===c.sha1:!1;if(h||c.sharesUndoRedoStack){for(const g of d.past)Nf(g)&&g.matchesResource(i)&&g.setModel(o);for(const g of d.future)Nf(g)&&g.matchesResource(i)&&g.setModel(o);this._undoRedoService.setElementsValidFlag(i,!0,g=>Nf(g)&&g.matchesResource(i)),h&&(o._overwriteVersionId(c.versionId),o._overwriteAlternativeVersionId(c.alternativeVersionId),o._overwriteInitialUndoRedoSnapshot(c.initialUndoRedoSnapshot))}else c.initialUndoRedoSnapshot!==null&&this._undoRedoService.restoreSnapshot(c.initialUndoRedoSnapshot)}const a=G_(o.uri);if(this._models[a])throw new Error("ModelService: Cannot add model because it already exists!");const l=new x7e(o,c=>this._onWillDispose(c),(c,d)=>this._onDidChangeLanguage(c,d));return this._models[a]=l,l}createModel(e,t,i,n=!1){let r;return t?r=this._createModelData(e,t,i,n):r=this._createModelData(e,So,i,n),this._onModelAdded.fire(r.model),r.model}getModels(){const e=[],t=Object.keys(this._models);for(let i=0,n=t.length;i<n;i++){const r=t[i];e.push(this._models[r].model)}return e}getModel(e){const t=G_(e),i=this._models[t];return i?i.model:null}_schemaShouldMaintainUndoRedoElements(e){return e.scheme===gt.file||e.scheme===gt.vscodeRemote||e.scheme===gt.vscodeUserData||e.scheme===gt.vscodeNotebookCell||e.scheme==="fake-fs"}_onWillDispose(e){const t=G_(e.uri),i=this._models[t],n=this._undoRedoService.getUriComparisonKey(e.uri)!==e.uri.toString();let r=!1,o=0;if(n||this._shouldRestoreUndoStack()&&this._schemaShouldMaintainUndoRedoElements(e.uri)){const c=this._undoRedoService.getElements(e.uri);if(c.past.length>0||c.future.length>0){for(const d of c.past)Nf(d)&&d.matchesResource(e.uri)&&(r=!0,o+=d.heapSize(e.uri),d.setModel(e.uri));for(const d of c.future)Nf(d)&&d.matchesResource(e.uri)&&(r=!0,o+=d.heapSize(e.uri),d.setModel(e.uri))}}const a=fC.MAX_MEMORY_FOR_CLOSED_FILES_UNDO_STACK,l=this._getSHA1Computer();if(r)if(!n&&(o>a||!l.canComputeSHA1(e))){const c=i.model.getInitialUndoRedoSnapshot();c!==null&&this._undoRedoService.restoreSnapshot(c)}else this._ensureDisposedModelsHeapSize(a-o),this._undoRedoService.setElementsValidFlag(e.uri,!1,c=>Nf(c)&&c.matchesResource(e.uri)),this._insertDisposedModel(new k7e(e.uri,i.model.getInitialUndoRedoSnapshot(),Date.now(),n,o,l.computeSHA1(e),e.getVersionId(),e.getAlternativeVersionId()));else if(!n){const c=i.model.getInitialUndoRedoSnapshot();c!==null&&this._undoRedoService.restoreSnapshot(c)}delete this._models[t],i.dispose(),delete this._modelCreationOptionsByLanguageAndResource[e.getLanguageId()+e.uri],this._onModelRemoved.fire(e)}_onDidChangeLanguage(e,t){const i=t.oldLanguage,n=e.getLanguageId(),r=this.getCreationOptions(i,e.uri,e.isForSimpleWidget),o=this.getCreationOptions(n,e.uri,e.isForSimpleWidget);fC._setModelOptionsForModel(e,o,r),this._onModelModeChanged.fire({model:e,oldLanguageId:i})}_getSHA1Computer(){return new P8}},fC=lv,lv.MAX_MEMORY_FOR_CLOSED_FILES_UNDO_STACK=20*1024*1024,lv);A8=fC=S7e([xN(0,At),xN(1,Whe),xN(2,iK),xN(3,Xe)],A8);const GM=class GM{canComputeSHA1(e){return e.getValueLength()<=GM.MAX_MODEL_SIZE}computeSHA1(e){const t=new QW,i=e.createSnapshot();let n;for(;n=i.read();)t.update(n);return t.digest()}};GM.MAX_MODEL_SIZE=10*1024*1024;let P8=GM;var M8;(function(s){s[s.PRESERVE=0]="PRESERVE",s[s.LAST=1]="LAST"})(M8||(M8={}));const Yw={Quickaccess:"workbench.contributions.quickaccess"};class I7e{constructor(){this.providers=[],this.defaultProvider=void 0}registerQuickAccessProvider(e){return e.prefix.length===0?this.defaultProvider=e:this.providers.push(e),this.providers.sort((t,i)=>i.prefix.length-t.prefix.length),Ye(()=>{this.providers.splice(this.providers.indexOf(e),1),this.defaultProvider===e&&(this.defaultProvider=void 0)})}getQuickAccessProviders(){return rd([this.defaultProvider,...this.providers])}getQuickAccessProvider(e){return e&&this.providers.find(i=>e.startsWith(i.prefix))||void 0||this.defaultProvider}}_n.add(Yw.Quickaccess,new I7e);const E7e={ctrlCmd:!1,alt:!1};var E1;(function(s){s[s.Blur=1]="Blur",s[s.Gesture=2]="Gesture",s[s.Other=3]="Other"})(E1||(E1={}));var zd;(function(s){s[s.NONE=0]="NONE",s[s.FIRST=1]="FIRST",s[s.SECOND=2]="SECOND",s[s.LAST=3]="LAST"})(zd||(zd={}));var ji;(function(s){s[s.First=1]="First",s[s.Second=2]="Second",s[s.Last=3]="Last",s[s.Next=4]="Next",s[s.Previous=5]="Previous",s[s.NextPage=6]="NextPage",s[s.PreviousPage=7]="PreviousPage",s[s.NextSeparator=8]="NextSeparator",s[s.PreviousSeparator=9]="PreviousSeparator"})(ji||(ji={}));var PA;(function(s){s[s.Title=1]="Title",s[s.Inline=2]="Inline"})(PA||(PA={}));const kc=Ht("quickInputService");var D7e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Vne=function(s,e){return function(t,i){e(t,i,s)}};let O8=class extends te{constructor(e,t){super(),this.quickInputService=e,this.instantiationService=t,this.registry=_n.as(Yw.Quickaccess),this.mapProviderToDescriptor=new Map,this.lastAcceptedPickerValues=new Map,this.visibleQuickAccess=void 0}show(e="",t){this.doShowOrPick(e,!1,t)}doShowOrPick(e,t,i){var p,_;const[n,r]=this.getOrInstantiateProvider(e,i==null?void 0:i.enabledProviderPrefixes),o=this.visibleQuickAccess,a=o==null?void 0:o.descriptor;if(o&&r&&a===r){e!==r.prefix&&!(i!=null&&i.preserveValue)&&(o.picker.value=e),this.adjustValueSelection(o.picker,r,i);return}if(r&&!(i!=null&&i.preserveValue)){let v;if(o&&a&&a!==r){const C=o.value.substr(a.prefix.length);C&&(v=`${r.prefix}${C}`)}if(!v){const C=n==null?void 0:n.defaultFilterValue;C===M8.LAST?v=this.lastAcceptedPickerValues.get(r):typeof C=="string"&&(v=`${r.prefix}${C}`)}typeof v=="string"&&(e=v)}const l=(p=o==null?void 0:o.picker)==null?void 0:p.valueSelection,c=(_=o==null?void 0:o.picker)==null?void 0:_.value,d=new ce,u=d.add(this.quickInputService.createQuickPick({useSeparators:!0}));u.value=e,this.adjustValueSelection(u,r,i),u.placeholder=(i==null?void 0:i.placeholder)??(r==null?void 0:r.placeholder),u.quickNavigate=i==null?void 0:i.quickNavigateConfiguration,u.hideInput=!!u.quickNavigate&&!o,(typeof(i==null?void 0:i.itemActivation)=="number"||i!=null&&i.quickNavigateConfiguration)&&(u.itemActivation=(i==null?void 0:i.itemActivation)??zd.SECOND),u.contextKey=r==null?void 0:r.contextKey,u.filterValue=v=>v.substring(r?r.prefix.length:0);let h;t&&(h=new lS,d.add(De.once(u.onWillAccept)(v=>{v.veto(),u.hide()}))),d.add(this.registerPickerListeners(u,n,r,e,i));const g=d.add(new mn);if(n&&d.add(n.provide(u,g.token,i==null?void 0:i.providerOptions)),De.once(u.onDidHide)(()=>{u.selectedItems.length===0&&g.cancel(),d.dispose(),h==null||h.complete(u.selectedItems.slice(0))}),u.show(),l&&c===e&&(u.valueSelection=l),t)return h==null?void 0:h.p}adjustValueSelection(e,t,i){let n;i!=null&&i.preserveValue?n=[e.value.length,e.value.length]:n=[(t==null?void 0:t.prefix.length)??0,e.value.length],e.valueSelection=n}registerPickerListeners(e,t,i,n,r){const o=new ce,a=this.visibleQuickAccess={picker:e,descriptor:i,value:n};return o.add(Ye(()=>{a===this.visibleQuickAccess&&(this.visibleQuickAccess=void 0)})),o.add(e.onDidChangeValue(l=>{const[c]=this.getOrInstantiateProvider(l,r==null?void 0:r.enabledProviderPrefixes);c!==t?this.show(l,{enabledProviderPrefixes:r==null?void 0:r.enabledProviderPrefixes,preserveValue:!0,providerOptions:r==null?void 0:r.providerOptions}):a.value=l})),i&&o.add(e.onDidAccept(()=>{this.lastAcceptedPickerValues.set(i,e.value)})),o}getOrInstantiateProvider(e,t){const i=this.registry.getQuickAccessProvider(e);if(!i||t&&!(t!=null&&t.includes(i.prefix)))return[void 0,void 0];let n=this.mapProviderToDescriptor.get(i);return n||(n=this.instantiationService.createInstance(i.ctor),this.mapProviderToDescriptor.set(i,n)),[n,i]}};O8=D7e([Vne(0,kc),Vne(1,Xe)],O8);class CS extends Vl{constructor(e){super(),this._onChange=this._register(new Z),this.onChange=this._onChange.event,this._onKeyDown=this._register(new Z),this.onKeyDown=this._onKeyDown.event,this._opts=e,this._checked=this._opts.isChecked;const t=["monaco-custom-toggle"];this._opts.icon&&(this._icon=this._opts.icon,t.push(...at.asClassNameArray(this._icon))),this._opts.actionClassName&&t.push(...this._opts.actionClassName.split(" ")),this._checked&&t.push("checked"),this.domNode=document.createElement("div"),this._hover=this._register(wu().setupManagedHover(e.hoverDelegate??No("mouse"),this.domNode,this._opts.title)),this.domNode.classList.add(...t),this._opts.notFocusable||(this.domNode.tabIndex=0),this.domNode.setAttribute("role","checkbox"),this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.setAttribute("aria-label",this._opts.title),this.applyStyles(),this.onclick(this.domNode,i=>{this.enabled&&(this.checked=!this._checked,this._onChange.fire(!1),i.preventDefault())}),this._register(this.ignoreGesture(this.domNode)),this.onkeydown(this.domNode,i=>{if(i.keyCode===10||i.keyCode===3){this.checked=!this._checked,this._onChange.fire(!0),i.preventDefault(),i.stopPropagation();return}this._onKeyDown.fire(i)})}get enabled(){return this.domNode.getAttribute("aria-disabled")!=="true"}focus(){this.domNode.focus()}get checked(){return this._checked}set checked(e){this._checked=e,this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.classList.toggle("checked",this._checked),this.applyStyles()}width(){return 22}applyStyles(){this.domNode&&(this.domNode.style.borderColor=this._checked&&this._opts.inputActiveOptionBorder||"",this.domNode.style.color=this._checked&&this._opts.inputActiveOptionForeground||"inherit",this.domNode.style.backgroundColor=this._checked&&this._opts.inputActiveOptionBackground||"")}enable(){this.domNode.setAttribute("aria-disabled",String(!1))}disable(){this.domNode.setAttribute("aria-disabled",String(!0))}}var T7e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r};class $ge{constructor(e){this.nodes=e}toString(){return this.nodes.map(e=>typeof e=="string"?e:e.label).join("")}}T7e([$n],$ge.prototype,"toString",null);const N7e=/\[([^\]]+)\]\(((?:https?:\/\/|command:|file:)[^\)\s]+)(?: (["'])(.+?)(\3))?\)/gi;function R7e(s){const e=[];let t=0,i;for(;i=N7e.exec(s);){i.index-t>0&&e.push(s.substring(t,i.index));const[,n,r,,o]=i;o?e.push({label:n,href:r,title:o}):e.push({label:n,href:r}),t=i.index+i[0].length}return t<s.length&&e.push(s.substring(t)),new $ge(e)}const qV={},A7e=new kK("quick-input-button-icon-");function P7e(s){if(!s)return;let e;const t=s.dark.toString();return qV[t]?e=qV[t]:(e=A7e.nextId(),q2(`.${e}, .hc-light .${e}`,`background-image: ${xg(s.light||s.dark)}`),q2(`.vs-dark .${e}, .hc-black .${e}`,`background-image: ${xg(s.dark)}`),qV[t]=e),e}function UL(s,e,t){let i=s.iconClass||P7e(s.iconPath);return s.alwaysVisible&&(i=i?`${i} always-visible`:"always-visible"),{id:e,label:"",tooltip:s.tooltip||"",class:i,enabled:!0,run:t}}function M7e(s,e,t){Xs(e);const i=R7e(s);let n=0;for(const r of i.nodes)if(typeof r=="string")e.append(...dm(r));else{let o=r.title;!o&&r.href.startsWith("command:")?o=b("executeCommand","Click to execute command '{0}'",r.href.substring(8)):o||(o=r.href);const a=ke("a",{href:r.href,title:o,tabIndex:n++},r.label);a.style.textDecoration="underline";const l=g=>{tAe(g)&&jt.stop(g,!0),t.callback(r.href)},c=t.disposables.add(new Ut(a,Le.CLICK)).event,d=t.disposables.add(new Ut(a,Le.KEY_DOWN)).event,u=De.chain(d,g=>g.filter(p=>{const _=new Mi(p);return _.equals(10)||_.equals(3)}));t.disposables.add(Er.addTarget(a));const h=t.disposables.add(new Ut(a,Vi.Tap)).event;De.any(c,h,u)(l,null,t.disposables),e.appendChild(a)}}var O7e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Bne=function(s,e){return function(t,i){e(t,i,s)}};const qge="inQuickInput",F7e=new Oe(qge,!1,b("inQuickInput","Whether keyboard focus is inside the quick input control")),V7e=he.has(qge),Kge="quickInputType",B7e=new Oe(Kge,void 0,b("quickInputType","The type of the currently visible quick input")),Gge="cursorAtEndOfQuickInputBox",W7e=new Oe(Gge,!1,b("cursorAtEndOfQuickInputBox","Whether the cursor in the quick input is at the end of the input box")),H7e=he.has(Gge),F8={iconClass:at.asClassName(xe.quickInputBack),tooltip:b("quickInput.back","Back")},QM=class QM extends te{constructor(e){super(),this.ui=e,this._widgetUpdated=!1,this.visible=!1,this._enabled=!0,this._busy=!1,this._ignoreFocusOut=!1,this._leftButtons=[],this._rightButtons=[],this._inlineButtons=[],this.buttonsUpdated=!1,this._toggles=[],this.togglesUpdated=!1,this.noValidationMessage=QM.noPromptMessage,this._severity=Hn.Ignore,this.onDidTriggerButtonEmitter=this._register(new Z),this.onDidHideEmitter=this._register(new Z),this.onWillHideEmitter=this._register(new Z),this.onDisposeEmitter=this._register(new Z),this.visibleDisposables=this._register(new ce),this.onDidHide=this.onDidHideEmitter.event}get title(){return this._title}set title(e){this._title=e,this.update()}get description(){return this._description}set description(e){this._description=e,this.update()}get step(){return this._steps}set step(e){this._steps=e,this.update()}get totalSteps(){return this._totalSteps}set totalSteps(e){this._totalSteps=e,this.update()}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this.update()}get contextKey(){return this._contextKey}set contextKey(e){this._contextKey=e,this.update()}get busy(){return this._busy}set busy(e){this._busy=e,this.update()}get ignoreFocusOut(){return this._ignoreFocusOut}set ignoreFocusOut(e){const t=this._ignoreFocusOut!==e&&!du;this._ignoreFocusOut=e&&!du,t&&this.update()}get titleButtons(){return this._leftButtons.length?[...this._leftButtons,this._rightButtons]:this._rightButtons}get buttons(){return[...this._leftButtons,...this._rightButtons,...this._inlineButtons]}set buttons(e){this._leftButtons=e.filter(t=>t===F8),this._rightButtons=e.filter(t=>t!==F8&&t.location!==PA.Inline),this._inlineButtons=e.filter(t=>t.location===PA.Inline),this.buttonsUpdated=!0,this.update()}get toggles(){return this._toggles}set toggles(e){this._toggles=e??[],this.togglesUpdated=!0,this.update()}get validationMessage(){return this._validationMessage}set validationMessage(e){this._validationMessage=e,this.update()}get severity(){return this._severity}set severity(e){this._severity=e,this.update()}show(){this.visible||(this.visibleDisposables.add(this.ui.onDidTriggerButton(e=>{this.buttons.indexOf(e)!==-1&&this.onDidTriggerButtonEmitter.fire(e)})),this.ui.show(this),this.visible=!0,this._lastValidationMessage=void 0,this._lastSeverity=void 0,this.buttons.length&&(this.buttonsUpdated=!0),this.toggles.length&&(this.togglesUpdated=!0),this.update())}hide(){this.visible&&this.ui.hide()}didHide(e=E1.Other){this.visible=!1,this.visibleDisposables.clear(),this.onDidHideEmitter.fire({reason:e})}willHide(e=E1.Other){this.onWillHideEmitter.fire({reason:e})}update(){var n;if(!this.visible)return;const e=this.getTitle();e&&this.ui.title.textContent!==e?this.ui.title.textContent=e:!e&&this.ui.title.innerHTML!=="&nbsp;"&&(this.ui.title.innerText=" ");const t=this.getDescription();if(this.ui.description1.textContent!==t&&(this.ui.description1.textContent=t),this.ui.description2.textContent!==t&&(this.ui.description2.textContent=t),this._widgetUpdated&&(this._widgetUpdated=!1,this._widget?Xs(this.ui.widget,this._widget):Xs(this.ui.widget)),this.busy&&!this.busyDelay&&(this.busyDelay=new gd,this.busyDelay.setIfNotSet(()=>{this.visible&&this.ui.progressBar.infinite()},800)),!this.busy&&this.busyDelay&&(this.ui.progressBar.stop(),this.busyDelay.cancel(),this.busyDelay=void 0),this.buttonsUpdated){this.buttonsUpdated=!1,this.ui.leftActionBar.clear();const r=this._leftButtons.map((l,c)=>UL(l,`id-${c}`,async()=>this.onDidTriggerButtonEmitter.fire(l)));this.ui.leftActionBar.push(r,{icon:!0,label:!1}),this.ui.rightActionBar.clear();const o=this._rightButtons.map((l,c)=>UL(l,`id-${c}`,async()=>this.onDidTriggerButtonEmitter.fire(l)));this.ui.rightActionBar.push(o,{icon:!0,label:!1}),this.ui.inlineActionBar.clear();const a=this._inlineButtons.map((l,c)=>UL(l,`id-${c}`,async()=>this.onDidTriggerButtonEmitter.fire(l)));this.ui.inlineActionBar.push(a,{icon:!0,label:!1})}if(this.togglesUpdated){this.togglesUpdated=!1;const r=((n=this.toggles)==null?void 0:n.filter(o=>o instanceof CS))??[];this.ui.inputBox.toggles=r}this.ui.ignoreFocusOut=this.ignoreFocusOut,this.ui.setEnabled(this.enabled),this.ui.setContextKey(this.contextKey);const i=this.validationMessage||this.noValidationMessage;this._lastValidationMessage!==i&&(this._lastValidationMessage=i,Xs(this.ui.message),M7e(i,this.ui.message,{callback:r=>{this.ui.linkOpenerDelegate(r)},disposables:this.visibleDisposables})),this._lastSeverity!==this.severity&&(this._lastSeverity=this.severity,this.showMessageDecoration(this.severity))}getTitle(){return this.title&&this.step?`${this.title} (${this.getSteps()})`:this.title?this.title:this.step?this.getSteps():""}getDescription(){return this.description||""}getSteps(){return this.step&&this.totalSteps?b("quickInput.steps","{0}/{1}",this.step,this.totalSteps):this.step?String(this.step):""}showMessageDecoration(e){if(this.ui.inputBox.showDecoration(e),e!==Hn.Ignore){const t=this.ui.inputBox.stylesForType(e);this.ui.message.style.color=t.foreground?`${t.foreground}`:"",this.ui.message.style.backgroundColor=t.background?`${t.background}`:"",this.ui.message.style.border=t.border?`1px solid ${t.border}`:"",this.ui.message.style.marginBottom="-2px"}else this.ui.message.style.color="",this.ui.message.style.backgroundColor="",this.ui.message.style.border="",this.ui.message.style.marginBottom=""}dispose(){this.hide(),this.onDisposeEmitter.fire(),super.dispose()}};QM.noPromptMessage=b("inputModeEntry","Press 'Enter' to confirm your input or 'Escape' to cancel");let MA=QM;const YM=class YM extends MA{constructor(){super(...arguments),this._value="",this.onDidChangeValueEmitter=this._register(new Z),this.onWillAcceptEmitter=this._register(new Z),this.onDidAcceptEmitter=this._register(new Z),this.onDidCustomEmitter=this._register(new Z),this._items=[],this.itemsUpdated=!1,this._canSelectMany=!1,this._canAcceptInBackground=!1,this._matchOnDescription=!1,this._matchOnDetail=!1,this._matchOnLabel=!0,this._matchOnLabelMode="fuzzy",this._sortByLabel=!0,this._keepScrollPosition=!1,this._itemActivation=zd.FIRST,this._activeItems=[],this.activeItemsUpdated=!1,this.activeItemsToConfirm=[],this.onDidChangeActiveEmitter=this._register(new Z),this._selectedItems=[],this.selectedItemsUpdated=!1,this.selectedItemsToConfirm=[],this.onDidChangeSelectionEmitter=this._register(new Z),this.onDidTriggerItemButtonEmitter=this._register(new Z),this.onDidTriggerSeparatorButtonEmitter=this._register(new Z),this.valueSelectionUpdated=!0,this._ok="default",this._customButton=!1,this._focusEventBufferer=new BE,this.type="quickPick",this.filterValue=e=>e,this.onDidChangeValue=this.onDidChangeValueEmitter.event,this.onWillAccept=this.onWillAcceptEmitter.event,this.onDidAccept=this.onDidAcceptEmitter.event,this.onDidChangeActive=this.onDidChangeActiveEmitter.event,this.onDidChangeSelection=this.onDidChangeSelectionEmitter.event,this.onDidTriggerItemButton=this.onDidTriggerItemButtonEmitter.event,this.onDidTriggerSeparatorButton=this.onDidTriggerSeparatorButtonEmitter.event}get quickNavigate(){return this._quickNavigate}set quickNavigate(e){this._quickNavigate=e,this.update()}get value(){return this._value}set value(e){this.doSetValue(e)}doSetValue(e,t){this._value!==e&&(this._value=e,t||this.update(),this.visible&&this.ui.list.filter(this.filterValue(this._value))&&this.trySelectFirst(),this.onDidChangeValueEmitter.fire(this._value))}set ariaLabel(e){this._ariaLabel=e,this.update()}get ariaLabel(){return this._ariaLabel}get placeholder(){return this._placeholder}set placeholder(e){this._placeholder=e,this.update()}get items(){return this._items}get scrollTop(){return this.ui.list.scrollTop}set scrollTop(e){this.ui.list.scrollTop=e}set items(e){this._items=e,this.itemsUpdated=!0,this.update()}get canSelectMany(){return this._canSelectMany}set canSelectMany(e){this._canSelectMany=e,this.update()}get canAcceptInBackground(){return this._canAcceptInBackground}set canAcceptInBackground(e){this._canAcceptInBackground=e}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(e){this._matchOnDescription=e,this.update()}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(e){this._matchOnDetail=e,this.update()}get matchOnLabel(){return this._matchOnLabel}set matchOnLabel(e){this._matchOnLabel=e,this.update()}get matchOnLabelMode(){return this._matchOnLabelMode}set matchOnLabelMode(e){this._matchOnLabelMode=e,this.update()}get sortByLabel(){return this._sortByLabel}set sortByLabel(e){this._sortByLabel=e,this.update()}get keepScrollPosition(){return this._keepScrollPosition}set keepScrollPosition(e){this._keepScrollPosition=e}get itemActivation(){return this._itemActivation}set itemActivation(e){this._itemActivation=e}get activeItems(){return this._activeItems}set activeItems(e){this._activeItems=e,this.activeItemsUpdated=!0,this.update()}get selectedItems(){return this._selectedItems}set selectedItems(e){this._selectedItems=e,this.selectedItemsUpdated=!0,this.update()}get keyMods(){return this._quickNavigate?E7e:this.ui.keyMods}get valueSelection(){const e=this.ui.inputBox.getSelection();if(e)return[e.start,e.end]}set valueSelection(e){this._valueSelection=e,this.valueSelectionUpdated=!0,this.update()}get customButton(){return this._customButton}set customButton(e){this._customButton=e,this.update()}get customLabel(){return this._customButtonLabel}set customLabel(e){this._customButtonLabel=e,this.update()}get customHover(){return this._customButtonHover}set customHover(e){this._customButtonHover=e,this.update()}get ok(){return this._ok}set ok(e){this._ok=e,this.update()}get hideInput(){return!!this._hideInput}set hideInput(e){this._hideInput=e,this.update()}trySelectFirst(){this.canSelectMany||this.ui.list.focus(ji.First)}show(){this.visible||(this.visibleDisposables.add(this.ui.inputBox.onDidChange(e=>{this.doSetValue(e,!0)})),this.visibleDisposables.add(this.ui.onDidAccept(()=>{this.canSelectMany?this.ui.list.getCheckedElements().length||(this._selectedItems=[],this.onDidChangeSelectionEmitter.fire(this.selectedItems)):this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems)),this.handleAccept(!1)})),this.visibleDisposables.add(this.ui.onDidCustom(()=>{this.onDidCustomEmitter.fire()})),this.visibleDisposables.add(this._focusEventBufferer.wrapEvent(this.ui.list.onDidChangeFocus,(e,t)=>t)(e=>{this.activeItemsUpdated||this.activeItemsToConfirm!==this._activeItems&&dn(e,this._activeItems,(t,i)=>t===i)||(this._activeItems=e,this.onDidChangeActiveEmitter.fire(e))})),this.visibleDisposables.add(this.ui.list.onDidChangeSelection(({items:e,event:t})=>{if(this.canSelectMany){e.length&&this.ui.list.setSelectedElements([]);return}this.selectedItemsToConfirm!==this._selectedItems&&dn(e,this._selectedItems,(i,n)=>i===n)||(this._selectedItems=e,this.onDidChangeSelectionEmitter.fire(e),e.length&&this.handleAccept(Hq(t)&&t.button===1))})),this.visibleDisposables.add(this.ui.list.onChangedCheckedElements(e=>{!this.canSelectMany||!this.visible||this.selectedItemsToConfirm!==this._selectedItems&&dn(e,this._selectedItems,(t,i)=>t===i)||(this._selectedItems=e,this.onDidChangeSelectionEmitter.fire(e))})),this.visibleDisposables.add(this.ui.list.onButtonTriggered(e=>this.onDidTriggerItemButtonEmitter.fire(e))),this.visibleDisposables.add(this.ui.list.onSeparatorButtonTriggered(e=>this.onDidTriggerSeparatorButtonEmitter.fire(e))),this.visibleDisposables.add(this.registerQuickNavigation()),this.valueSelectionUpdated=!0),super.show()}handleAccept(e){let t=!1;this.onWillAcceptEmitter.fire({veto:()=>t=!0}),t||this.onDidAcceptEmitter.fire({inBackground:e})}registerQuickNavigation(){return oe(this.ui.container,Le.KEY_UP,e=>{if(this.canSelectMany||!this._quickNavigate)return;const t=new Mi(e),i=t.keyCode;this._quickNavigate.keybindings.some(o=>{const a=o.getChords();return a.length>1?!1:a[0].shiftKey&&i===4?!(t.ctrlKey||t.altKey||t.metaKey):!!(a[0].altKey&&i===6||a[0].ctrlKey&&i===5||a[0].metaKey&&i===57)})&&(this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems),this.handleAccept(!1)),this._quickNavigate=void 0)})}update(){if(!this.visible)return;const e=this.keepScrollPosition?this.scrollTop:0,t=!!this.description,i={title:!!this.title||!!this.step||!!this.titleButtons.length,description:t,checkAll:this.canSelectMany&&!this._hideCheckAll,checkBox:this.canSelectMany,inputBox:!this._hideInput,progressBar:!this._hideInput||t,visibleCount:!0,count:this.canSelectMany&&!this._hideCountBadge,ok:this.ok==="default"?this.canSelectMany:this.ok,list:!0,message:!!this.validationMessage,customButton:this.customButton};this.ui.setVisibilities(i),super.update(),this.ui.inputBox.value!==this.value&&(this.ui.inputBox.value=this.value),this.valueSelectionUpdated&&(this.valueSelectionUpdated=!1,this.ui.inputBox.select(this._valueSelection&&{start:this._valueSelection[0],end:this._valueSelection[1]})),this.ui.inputBox.placeholder!==(this.placeholder||"")&&(this.ui.inputBox.placeholder=this.placeholder||"");let n=this.ariaLabel;!n&&i.inputBox&&(n=this.placeholder||YM.DEFAULT_ARIA_LABEL,this.title&&(n+=` - ${this.title}`)),this.ui.list.ariaLabel!==n&&(this.ui.list.ariaLabel=n??null),this.ui.list.matchOnDescription=this.matchOnDescription,this.ui.list.matchOnDetail=this.matchOnDetail,this.ui.list.matchOnLabel=this.matchOnLabel,this.ui.list.matchOnLabelMode=this.matchOnLabelMode,this.ui.list.sortByLabel=this.sortByLabel,this.itemsUpdated&&(this.itemsUpdated=!1,this._focusEventBufferer.bufferEvents(()=>{switch(this.ui.list.setElements(this.items),this.ui.list.shouldLoop=!this.canSelectMany,this.ui.list.filter(this.filterValue(this.ui.inputBox.value)),this._itemActivation){case zd.NONE:this._itemActivation=zd.FIRST;break;case zd.SECOND:this.ui.list.focus(ji.Second),this._itemActivation=zd.FIRST;break;case zd.LAST:this.ui.list.focus(ji.Last),this._itemActivation=zd.FIRST;break;default:this.trySelectFirst();break}})),this.ui.container.classList.contains("show-checkboxes")!==!!this.canSelectMany&&(this.canSelectMany?this.ui.list.clearFocus():this.trySelectFirst()),this.activeItemsUpdated&&(this.activeItemsUpdated=!1,this.activeItemsToConfirm=this._activeItems,this.ui.list.setFocusedElements(this.activeItems),this.activeItemsToConfirm===this._activeItems&&(this.activeItemsToConfirm=null)),this.selectedItemsUpdated&&(this.selectedItemsUpdated=!1,this.selectedItemsToConfirm=this._selectedItems,this.canSelectMany?this.ui.list.setCheckedElements(this.selectedItems):this.ui.list.setSelectedElements(this.selectedItems),this.selectedItemsToConfirm===this._selectedItems&&(this.selectedItemsToConfirm=null)),this.ui.customButton.label=this.customLabel||"",this.ui.customButton.element.title=this.customHover||"",i.inputBox||(this.ui.list.domFocus(),this.canSelectMany&&this.ui.list.focus(ji.First)),this.keepScrollPosition&&(this.scrollTop=e)}focus(e){this.ui.list.focus(e),this.canSelectMany&&this.ui.list.domFocus()}accept(e){e&&!this._canAcceptInBackground||this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems),this.handleAccept(e??!1))}};YM.DEFAULT_ARIA_LABEL=b("quickInputBox.ariaLabel","Type to narrow down results.");let OA=YM,z7e=class extends MA{constructor(){super(...arguments),this._value="",this.valueSelectionUpdated=!0,this._password=!1,this.onDidValueChangeEmitter=this._register(new Z),this.onDidAcceptEmitter=this._register(new Z),this.type="inputBox",this.onDidChangeValue=this.onDidValueChangeEmitter.event,this.onDidAccept=this.onDidAcceptEmitter.event}get value(){return this._value}set value(e){this._value=e||"",this.update()}get placeholder(){return this._placeholder}set placeholder(e){this._placeholder=e,this.update()}get password(){return this._password}set password(e){this._password=e,this.update()}show(){this.visible||(this.visibleDisposables.add(this.ui.inputBox.onDidChange(e=>{e!==this.value&&(this._value=e,this.onDidValueChangeEmitter.fire(e))})),this.visibleDisposables.add(this.ui.onDidAccept(()=>this.onDidAcceptEmitter.fire())),this.valueSelectionUpdated=!0),super.show()}update(){if(!this.visible)return;this.ui.container.classList.remove("hidden-input");const e={title:!!this.title||!!this.step||!!this.titleButtons.length,description:!!this.description||!!this.step,inputBox:!0,message:!0,progressBar:!0};this.ui.setVisibilities(e),super.update(),this.ui.inputBox.value!==this.value&&(this.ui.inputBox.value=this.value),this.valueSelectionUpdated&&(this.valueSelectionUpdated=!1,this.ui.inputBox.select(this._valueSelection&&{start:this._valueSelection[0],end:this._valueSelection[1]})),this.ui.inputBox.placeholder!==(this.placeholder||"")&&(this.ui.inputBox.placeholder=this.placeholder||""),this.ui.inputBox.password!==this.password&&(this.ui.inputBox.password=this.password)}},V8=class extends v1{constructor(e,t){super("element",!1,i=>this.getOverrideOptions(i),e,t)}getOverrideOptions(e){const t=(Ls(e.content)?e.content.textContent??"":typeof e.content=="string"?e.content:e.content.value).includes(`
`);return{persistence:{hideOnKeyDown:!1},appearance:{showHoverHint:t,skipFadeInAnimation:!0}}}};V8=O7e([Bne(0,At),Bne(1,Kh)],V8);fe.white.toString(),fe.white.toString();class FA extends te{get onDidClick(){return this._onDidClick.event}constructor(e,t){super(),this._label="",this._onDidClick=this._register(new Z),this._onDidEscape=this._register(new Z),this.options=t,this._element=document.createElement("a"),this._element.classList.add("monaco-button"),this._element.tabIndex=0,this._element.setAttribute("role","button"),this._element.classList.toggle("secondary",!!t.secondary);const i=t.secondary?t.buttonSecondaryBackground:t.buttonBackground,n=t.secondary?t.buttonSecondaryForeground:t.buttonForeground;this._element.style.color=n||"",this._element.style.backgroundColor=i||"",t.supportShortLabel&&(this._labelShortElement=document.createElement("div"),this._labelShortElement.classList.add("monaco-button-label-short"),this._element.appendChild(this._labelShortElement),this._labelElement=document.createElement("div"),this._labelElement.classList.add("monaco-button-label"),this._element.appendChild(this._labelElement),this._element.classList.add("monaco-text-button-with-short-label")),typeof t.title=="string"&&this.setTitle(t.title),typeof t.ariaLabel=="string"&&this._element.setAttribute("aria-label",t.ariaLabel),e.appendChild(this._element),this._register(Er.addTarget(this._element)),[Le.CLICK,Vi.Tap].forEach(r=>{this._register(oe(this._element,r,o=>{if(!this.enabled){jt.stop(o);return}this._onDidClick.fire(o)}))}),this._register(oe(this._element,Le.KEY_DOWN,r=>{const o=new Mi(r);let a=!1;this.enabled&&(o.equals(3)||o.equals(10))?(this._onDidClick.fire(r),a=!0):o.equals(9)&&(this._onDidEscape.fire(r),this._element.blur(),a=!0),a&&jt.stop(o,!0)})),this._register(oe(this._element,Le.MOUSE_OVER,r=>{this._element.classList.contains("disabled")||this.updateBackground(!0)})),this._register(oe(this._element,Le.MOUSE_OUT,r=>{this.updateBackground(!1)})),this.focusTracker=this._register(hu(this._element)),this._register(this.focusTracker.onDidFocus(()=>{this.enabled&&this.updateBackground(!0)})),this._register(this.focusTracker.onDidBlur(()=>{this.enabled&&this.updateBackground(!1)}))}dispose(){super.dispose(),this._element.remove()}getContentElements(e){const t=[];for(let i of dm(e))if(typeof i=="string"){if(i=i.trim(),i==="")continue;const n=document.createElement("span");n.textContent=i,t.push(n)}else t.push(i);return t}updateBackground(e){let t;this.options.secondary?t=e?this.options.buttonSecondaryHoverBackground:this.options.buttonSecondaryBackground:t=e?this.options.buttonHoverBackground:this.options.buttonBackground,t&&(this._element.style.backgroundColor=t)}get element(){return this._element}set label(e){var n;if(this._label===e||au(this._label)&&au(e)&&C5e(this._label,e))return;this._element.classList.add("monaco-text-button");const t=this.options.supportShortLabel?this._labelElement:this._element;if(au(e)){const r=PF(e,{inline:!0});r.dispose();const o=(n=r.element.querySelector("p"))==null?void 0:n.innerHTML;if(o){const a=que(o,{ADD_TAGS:["b","i","u","code","span"],ALLOWED_ATTR:["class"],RETURN_TRUSTED_TYPE:!0});t.innerHTML=a}else Xs(t)}else this.options.supportIcons?Xs(t,...this.getContentElements(e)):t.textContent=e;let i="";typeof this.options.title=="string"?i=this.options.title:this.options.title&&(i=R5e(e)),this.setTitle(i),typeof this.options.ariaLabel=="string"?this._element.setAttribute("aria-label",this.options.ariaLabel):this.options.ariaLabel&&this._element.setAttribute("aria-label",i),this._label=e}get label(){return this._label}set icon(e){this._element.classList.add(...at.asClassNameArray(e))}set enabled(e){e?(this._element.classList.remove("disabled"),this._element.setAttribute("aria-disabled",String(!1)),this._element.tabIndex=0):(this._element.classList.add("disabled"),this._element.setAttribute("aria-disabled",String(!0)))}get enabled(){return!this._element.classList.contains("disabled")}setTitle(e){!this._hover&&e!==""?this._hover=this._register(wu().setupManagedHover(this.options.hoverDelegate??No("mouse"),this._element,e)):this._hover&&this._hover.update(e)}}class B8{constructor(e,t,i){this.options=t,this.styles=i,this.count=0,this.element=me(e,ke(".monaco-count-badge")),this.countFormat=this.options.countFormat||"{0}",this.titleFormat=this.options.titleFormat||"",this.setCount(this.options.count||0)}setCount(e){this.count=e,this.render()}setTitleFormat(e){this.titleFormat=e,this.render()}render(){this.element.textContent=lw(this.countFormat,this.count),this.element.title=lw(this.titleFormat,this.count),this.element.style.backgroundColor=this.styles.badgeBackground??"",this.element.style.color=this.styles.badgeForeground??"",this.styles.badgeBorder&&(this.element.style.border=`1px solid ${this.styles.badgeBorder}`)}}const Wne="done",Hne="active",KV="infinite",GV="infinite-long-running",zne="discrete",XM=class XM extends te{constructor(e,t){super(),this.progressSignal=this._register(new Es),this.workedVal=0,this.showDelayedScheduler=this._register(new xi(()=>ka(this.element),0)),this.longRunningScheduler=this._register(new xi(()=>this.infiniteLongRunning(),XM.LONG_RUNNING_INFINITE_THRESHOLD)),this.create(e,t)}create(e,t){this.element=document.createElement("div"),this.element.classList.add("monaco-progress-container"),this.element.setAttribute("role","progressbar"),this.element.setAttribute("aria-valuemin","0"),e.appendChild(this.element),this.bit=document.createElement("div"),this.bit.classList.add("progress-bit"),this.bit.style.backgroundColor=(t==null?void 0:t.progressBarBackground)||"#0E70C0",this.element.appendChild(this.bit)}off(){this.bit.style.width="inherit",this.bit.style.opacity="1",this.element.classList.remove(Hne,KV,GV,zne),this.workedVal=0,this.totalWork=void 0,this.longRunningScheduler.cancel(),this.progressSignal.clear()}stop(){return this.doDone(!1)}doDone(e){return this.element.classList.add(Wne),this.element.classList.contains(KV)?(this.bit.style.opacity="0",e?setTimeout(()=>this.off(),200):this.off()):(this.bit.style.width="inherit",e?setTimeout(()=>this.off(),200):this.off()),this}infinite(){return this.bit.style.width="2%",this.bit.style.opacity="1",this.element.classList.remove(zne,Wne,GV),this.element.classList.add(Hne,KV),this.longRunningScheduler.schedule(),this}infiniteLongRunning(){this.element.classList.add(GV)}getContainer(){return this.element}};XM.LONG_RUNNING_INFINITE_THRESHOLD=1e4;let W8=XM;const U7e=b("caseDescription","Match Case"),j7e=b("wordsDescription","Match Whole Word"),$7e=b("regexDescription","Use Regular Expression");class Qge extends CS{constructor(e){super({icon:xe.caseSensitive,title:U7e+e.appendTitle,isChecked:e.isChecked,hoverDelegate:e.hoverDelegate??No("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class Yge extends CS{constructor(e){super({icon:xe.wholeWord,title:j7e+e.appendTitle,isChecked:e.isChecked,hoverDelegate:e.hoverDelegate??No("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class Xge extends CS{constructor(e){super({icon:xe.regex,title:$7e+e.appendTitle,isChecked:e.isChecked,hoverDelegate:e.hoverDelegate??No("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class q7e{constructor(e,t=0,i=e.length,n=t-1){this.items=e,this.start=t,this.end=i,this.index=n}current(){return this.index===this.start-1||this.index===this.end?null:this.items[this.index]}next(){return this.index=Math.min(this.index+1,this.end),this.current()}previous(){return this.index=Math.max(this.index-1,this.start-1),this.current()}first(){return this.index=this.start,this.current()}last(){return this.index=this.end-1,this.current()}}class K7e{constructor(e=[],t=10){this._initialize(e),this._limit=t,this._onChange()}getHistory(){return this._elements}add(e){this._history.delete(e),this._history.add(e),this._onChange()}next(){return this._navigator.next()}previous(){return this._currentPosition()!==0?this._navigator.previous():null}current(){return this._navigator.current()}first(){return this._navigator.first()}last(){return this._navigator.last()}isLast(){return this._currentPosition()>=this._elements.length-1}isNowhere(){return this._navigator.current()===null}has(e){return this._history.has(e)}_onChange(){this._reduceToLimit();const e=this._elements;this._navigator=new q7e(e,0,e.length,e.length)}_reduceToLimit(){const e=this._elements;e.length>this._limit&&this._initialize(e.slice(e.length-this._limit))}_currentPosition(){const e=this._navigator.current();return e?this._elements.indexOf(e):-1}_initialize(e){this._history=new Set;for(const t of e)this._history.add(t)}get _elements(){const e=[];return this._history.forEach(t=>e.push(t)),e}}const Nx=ke;class G7e extends Vl{constructor(e,t,i){super(),this.state="idle",this.maxHeight=Number.POSITIVE_INFINITY,this._onDidChange=this._register(new Z),this.onDidChange=this._onDidChange.event,this._onDidHeightChange=this._register(new Z),this.onDidHeightChange=this._onDidHeightChange.event,this.contextViewProvider=t,this.options=i,this.message=null,this.placeholder=this.options.placeholder||"",this.tooltip=this.options.tooltip??(this.placeholder||""),this.ariaLabel=this.options.ariaLabel||"",this.options.validationOptions&&(this.validation=this.options.validationOptions.validation),this.element=me(e,Nx(".monaco-inputbox.idle"));const n=this.options.flexibleHeight?"textarea":"input",r=me(this.element,Nx(".ibwrapper"));if(this.input=me(r,Nx(n+".input.empty")),this.input.setAttribute("autocorrect","off"),this.input.setAttribute("autocapitalize","off"),this.input.setAttribute("spellcheck","false"),this.onfocus(this.input,()=>this.element.classList.add("synthetic-focus")),this.onblur(this.input,()=>this.element.classList.remove("synthetic-focus")),this.options.flexibleHeight){this.maxHeight=typeof this.options.flexibleMaxHeight=="number"?this.options.flexibleMaxHeight:Number.POSITIVE_INFINITY,this.mirror=me(r,Nx("div.mirror")),this.mirror.innerText=" ",this.scrollableElement=new Sfe(this.element,{vertical:1}),this.options.flexibleWidth&&(this.input.setAttribute("wrap","off"),this.mirror.style.whiteSpace="pre",this.mirror.style.wordWrap="initial"),me(e,this.scrollableElement.getDomNode()),this._register(this.scrollableElement),this._register(this.scrollableElement.onScroll(l=>this.input.scrollTop=l.scrollTop));const o=this._register(new Ut(e.ownerDocument,"selectionchange")),a=De.filter(o.event,()=>{const l=e.ownerDocument.getSelection();return(l==null?void 0:l.anchorNode)===r});this._register(a(this.updateScrollDimensions,this)),this._register(this.onDidHeightChange(this.updateScrollDimensions,this))}else this.input.type=this.options.type||"text",this.input.setAttribute("wrap","off");this.ariaLabel&&this.input.setAttribute("aria-label",this.ariaLabel),this.placeholder&&!this.options.showPlaceholderOnFocus&&this.setPlaceHolder(this.placeholder),this.tooltip&&this.setTooltip(this.tooltip),this.oninput(this.input,()=>this.onValueChange()),this.onblur(this.input,()=>this.onBlur()),this.onfocus(this.input,()=>this.onFocus()),this._register(this.ignoreGesture(this.input)),setTimeout(()=>this.updateMirror(),0),this.options.actions&&(this.actionbar=this._register(new Dl(this.element)),this.actionbar.push(this.options.actions,{icon:!0,label:!1})),this.applyStyles()}onBlur(){this._hideMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder","")}onFocus(){this._showMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder",this.placeholder||"")}setPlaceHolder(e){this.placeholder=e,this.input.setAttribute("placeholder",e)}setTooltip(e){this.tooltip=e,this.hover?this.hover.update(e):this.hover=this._register(wu().setupManagedHover(No("mouse"),this.input,e))}get inputElement(){return this.input}get value(){return this.input.value}set value(e){this.input.value!==e&&(this.input.value=e,this.onValueChange())}get height(){return typeof this.cachedHeight=="number"?this.cachedHeight:$f(this.element)}focus(){this.input.focus()}blur(){this.input.blur()}hasFocus(){return rF(this.input)}select(e=null){this.input.select(),e&&(this.input.setSelectionRange(e.start,e.end),e.end===this.input.value.length&&(this.input.scrollLeft=this.input.scrollWidth))}isSelectionAtEnd(){return this.input.selectionEnd===this.input.value.length&&this.input.selectionStart===this.input.selectionEnd}getSelection(){const e=this.input.selectionStart;if(e===null)return null;const t=this.input.selectionEnd??e;return{start:e,end:t}}enable(){this.input.removeAttribute("disabled")}disable(){this.blur(),this.input.disabled=!0,this._hideMessage()}set paddingRight(e){this.input.style.width=`calc(100% - ${e}px)`,this.mirror&&(this.mirror.style.paddingRight=e+"px")}updateScrollDimensions(){if(typeof this.cachedContentHeight!="number"||typeof this.cachedHeight!="number"||!this.scrollableElement)return;const e=this.cachedContentHeight,t=this.cachedHeight,i=this.input.scrollTop;this.scrollableElement.setScrollDimensions({scrollHeight:e,height:t}),this.scrollableElement.setScrollPosition({scrollTop:i})}showMessage(e,t){if(this.state==="open"&&Ta(this.message,e))return;this.message=e,this.element.classList.remove("idle"),this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add(this.classForType(e.type));const i=this.stylesForType(this.message.type);this.element.style.border=`1px solid ${lg(i.border,"transparent")}`,this.message.content&&(this.hasFocus()||t)&&this._showMessage()}hideMessage(){this.message=null,this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add("idle"),this._hideMessage(),this.applyStyles()}validate(){let e=null;return this.validation&&(e=this.validation(this.value),e?(this.inputElement.setAttribute("aria-invalid","true"),this.showMessage(e)):this.inputElement.hasAttribute("aria-invalid")&&(this.inputElement.removeAttribute("aria-invalid"),this.hideMessage())),e==null?void 0:e.type}stylesForType(e){const t=this.options.inputBoxStyles;switch(e){case 1:return{border:t.inputValidationInfoBorder,background:t.inputValidationInfoBackground,foreground:t.inputValidationInfoForeground};case 2:return{border:t.inputValidationWarningBorder,background:t.inputValidationWarningBackground,foreground:t.inputValidationWarningForeground};default:return{border:t.inputValidationErrorBorder,background:t.inputValidationErrorBackground,foreground:t.inputValidationErrorForeground}}}classForType(e){switch(e){case 1:return"info";case 2:return"warning";default:return"error"}}_showMessage(){if(!this.contextViewProvider||!this.message)return;let e;const t=()=>e.style.width=ya(this.element)+"px";this.contextViewProvider.showContextView({getAnchor:()=>this.element,anchorAlignment:1,render:n=>{if(!this.message)return null;e=me(n,Nx(".monaco-inputbox-container")),t();const r={inline:!0,className:"monaco-inputbox-message"},o=this.message.formatContent?BFe(this.message.content,r):VFe(this.message.content,r);o.classList.add(this.classForType(this.message.type));const a=this.stylesForType(this.message.type);return o.style.backgroundColor=a.background??"",o.style.color=a.foreground??"",o.style.border=a.border?`1px solid ${a.border}`:"",me(e,o),null},onHide:()=>{this.state="closed"},layout:t});let i;this.message.type===3?i=b("alertErrorMessage","Error: {0}",this.message.content):this.message.type===2?i=b("alertWarningMessage","Warning: {0}",this.message.content):i=b("alertInfoMessage","Info: {0}",this.message.content),Eo(i),this.state="open"}_hideMessage(){this.contextViewProvider&&(this.state==="open"&&this.contextViewProvider.hideContextView(),this.state="idle")}onValueChange(){this._onDidChange.fire(this.value),this.validate(),this.updateMirror(),this.input.classList.toggle("empty",!this.value),this.state==="open"&&this.contextViewProvider&&this.contextViewProvider.layout()}updateMirror(){if(!this.mirror)return;const e=this.value,i=e.charCodeAt(e.length-1)===10?" ":"";(e+i).replace(/\u000c/g,"")?this.mirror.textContent=e+i:this.mirror.innerText=" ",this.layout()}applyStyles(){const e=this.options.inputBoxStyles,t=e.inputBackground??"",i=e.inputForeground??"",n=e.inputBorder??"";this.element.style.backgroundColor=t,this.element.style.color=i,this.input.style.backgroundColor="inherit",this.input.style.color=i,this.element.style.border=`1px solid ${lg(n,"transparent")}`}layout(){if(!this.mirror)return;const e=this.cachedContentHeight;this.cachedContentHeight=$f(this.mirror),e!==this.cachedContentHeight&&(this.cachedHeight=Math.min(this.cachedContentHeight,this.maxHeight),this.input.style.height=this.cachedHeight+"px",this._onDidHeightChange.fire(this.cachedContentHeight))}insertAtCursor(e){const t=this.inputElement,i=t.selectionStart,n=t.selectionEnd,r=t.value;i!==null&&n!==null&&(this.value=r.substr(0,i)+e+r.substr(n),t.setSelectionRange(i+1,i+1),this.layout())}dispose(){var e;this._hideMessage(),this.message=null,(e=this.actionbar)==null||e.dispose(),super.dispose()}}class Zge extends G7e{constructor(e,t,i){const n=b({key:"history.inputbox.hint.suffix.noparens",comment:['Text is the suffix of an input field placeholder coming after the action the input field performs, this will be used when the input field ends in a closing parenthesis ")", for example "Filter (e.g. text, !exclude)". The character inserted into the final string is ⇅ to represent the up and down arrow keys.']}," or {0} for history","⇅"),r=b({key:"history.inputbox.hint.suffix.inparens",comment:['Text is the suffix of an input field placeholder coming after the action the input field performs, this will be used when the input field does NOT end in a closing parenthesis (eg. "Find"). The character inserted into the final string is ⇅ to represent the up and down arrow keys.']}," ({0} for history)","⇅");super(e,t,i),this._onDidFocus=this._register(new Z),this.onDidFocus=this._onDidFocus.event,this._onDidBlur=this._register(new Z),this.onDidBlur=this._onDidBlur.event,this.history=new K7e(i.history,100);const o=()=>{if(i.showHistoryHint&&i.showHistoryHint()&&!this.placeholder.endsWith(n)&&!this.placeholder.endsWith(r)&&this.history.getHistory().length){const a=this.placeholder.endsWith(")")?n:r,l=this.placeholder+a;i.showPlaceholderOnFocus&&!rF(this.input)?this.placeholder=l:this.setPlaceHolder(l)}};this.observer=new MutationObserver((a,l)=>{a.forEach(c=>{c.target.textContent||o()})}),this.observer.observe(this.input,{attributeFilter:["class"]}),this.onfocus(this.input,()=>o()),this.onblur(this.input,()=>{const a=l=>{if(this.placeholder.endsWith(l)){const c=this.placeholder.slice(0,this.placeholder.length-l.length);return i.showPlaceholderOnFocus?this.placeholder=c:this.setPlaceHolder(c),!0}else return!1};a(r)||a(n)})}dispose(){super.dispose(),this.observer&&(this.observer.disconnect(),this.observer=void 0)}addToHistory(e){this.value&&(e||this.value!==this.getCurrentValue())&&this.history.add(this.value)}isAtLastInHistory(){return this.history.isLast()}isNowhereInHistory(){return this.history.isNowhere()}showNextValue(){this.history.has(this.value)||this.addToHistory();let e=this.getNextValue();e&&(e=e===this.value?this.getNextValue():e),this.value=e??"",Mh(this.value?this.value:b("clearedInput","Cleared Input"))}showPreviousValue(){this.history.has(this.value)||this.addToHistory();let e=this.getPreviousValue();e&&(e=e===this.value?this.getPreviousValue():e),e&&(this.value=e,Mh(this.value))}setPlaceHolder(e){super.setPlaceHolder(e),this.setTooltip(e)}onBlur(){super.onBlur(),this._onDidBlur.fire()}onFocus(){super.onFocus(),this._onDidFocus.fire()}getCurrentValue(){let e=this.history.current();return e||(e=this.history.last(),this.history.next()),e}getPreviousValue(){return this.history.previous()||this.history.first()}getNextValue(){return this.history.next()}}const Q7e=b("defaultLabel","input");class Jge extends Vl{constructor(e,t,i){super(),this.fixFocusOnOptionClickEnabled=!0,this.imeSessionInProgress=!1,this.additionalTogglesDisposables=this._register(new Es),this.additionalToggles=[],this._onDidOptionChange=this._register(new Z),this.onDidOptionChange=this._onDidOptionChange.event,this._onKeyDown=this._register(new Z),this.onKeyDown=this._onKeyDown.event,this._onMouseDown=this._register(new Z),this.onMouseDown=this._onMouseDown.event,this._onInput=this._register(new Z),this._onKeyUp=this._register(new Z),this._onCaseSensitiveKeyDown=this._register(new Z),this.onCaseSensitiveKeyDown=this._onCaseSensitiveKeyDown.event,this._onRegexKeyDown=this._register(new Z),this.onRegexKeyDown=this._onRegexKeyDown.event,this._lastHighlightFindOptions=0,this.placeholder=i.placeholder||"",this.validation=i.validation,this.label=i.label||Q7e,this.showCommonFindToggles=!!i.showCommonFindToggles;const n=i.appendCaseSensitiveLabel||"",r=i.appendWholeWordsLabel||"",o=i.appendRegexLabel||"",a=i.history||[],l=!!i.flexibleHeight,c=!!i.flexibleWidth,d=i.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new Zge(this.domNode,t,{placeholder:this.placeholder||"",ariaLabel:this.label||"",validationOptions:{validation:this.validation},history:a,showHistoryHint:i.showHistoryHint,flexibleHeight:l,flexibleWidth:c,flexibleMaxHeight:d,inputBoxStyles:i.inputBoxStyles}));const u=this._register(k1());if(this.showCommonFindToggles){this.regex=this._register(new Xge({appendTitle:o,isChecked:!1,hoverDelegate:u,...i.toggleStyles})),this._register(this.regex.onChange(g=>{this._onDidOptionChange.fire(g),!g&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.regex.onKeyDown(g=>{this._onRegexKeyDown.fire(g)})),this.wholeWords=this._register(new Yge({appendTitle:r,isChecked:!1,hoverDelegate:u,...i.toggleStyles})),this._register(this.wholeWords.onChange(g=>{this._onDidOptionChange.fire(g),!g&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this.caseSensitive=this._register(new Qge({appendTitle:n,isChecked:!1,hoverDelegate:u,...i.toggleStyles})),this._register(this.caseSensitive.onChange(g=>{this._onDidOptionChange.fire(g),!g&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.caseSensitive.onKeyDown(g=>{this._onCaseSensitiveKeyDown.fire(g)}));const h=[this.caseSensitive.domNode,this.wholeWords.domNode,this.regex.domNode];this.onkeydown(this.domNode,g=>{if(g.equals(15)||g.equals(17)||g.equals(9)){const p=h.indexOf(this.domNode.ownerDocument.activeElement);if(p>=0){let _=-1;g.equals(17)?_=(p+1)%h.length:g.equals(15)&&(p===0?_=h.length-1:_=p-1),g.equals(9)?(h[p].blur(),this.inputBox.focus()):_>=0&&h[_].focus(),jt.stop(g,!0)}}})}this.controls=document.createElement("div"),this.controls.className="controls",this.controls.style.display=this.showCommonFindToggles?"":"none",this.caseSensitive&&this.controls.append(this.caseSensitive.domNode),this.wholeWords&&this.controls.appendChild(this.wholeWords.domNode),this.regex&&this.controls.appendChild(this.regex.domNode),this.setAdditionalToggles(i==null?void 0:i.additionalToggles),this.controls&&this.domNode.appendChild(this.controls),e==null||e.appendChild(this.domNode),this._register(oe(this.inputBox.inputElement,"compositionstart",h=>{this.imeSessionInProgress=!0})),this._register(oe(this.inputBox.inputElement,"compositionend",h=>{this.imeSessionInProgress=!1,this._onInput.fire()})),this.onkeydown(this.inputBox.inputElement,h=>this._onKeyDown.fire(h)),this.onkeyup(this.inputBox.inputElement,h=>this._onKeyUp.fire(h)),this.oninput(this.inputBox.inputElement,h=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,h=>this._onMouseDown.fire(h))}get onDidChange(){return this.inputBox.onDidChange}layout(e){this.inputBox.layout(),this.updateInputBoxPadding(e.collapsedFindWidget)}enable(){var e,t,i;this.domNode.classList.remove("disabled"),this.inputBox.enable(),(e=this.regex)==null||e.enable(),(t=this.wholeWords)==null||t.enable(),(i=this.caseSensitive)==null||i.enable();for(const n of this.additionalToggles)n.enable()}disable(){var e,t,i;this.domNode.classList.add("disabled"),this.inputBox.disable(),(e=this.regex)==null||e.disable(),(t=this.wholeWords)==null||t.disable(),(i=this.caseSensitive)==null||i.disable();for(const n of this.additionalToggles)n.disable()}setFocusInputOnOptionClick(e){this.fixFocusOnOptionClickEnabled=e}setEnabled(e){e?this.enable():this.disable()}setAdditionalToggles(e){for(const t of this.additionalToggles)t.domNode.remove();this.additionalToggles=[],this.additionalTogglesDisposables.value=new ce;for(const t of e??[])this.additionalTogglesDisposables.value.add(t),this.controls.appendChild(t.domNode),this.additionalTogglesDisposables.value.add(t.onChange(i=>{this._onDidOptionChange.fire(i),!i&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus()})),this.additionalToggles.push(t);this.additionalToggles.length>0&&(this.controls.style.display=""),this.updateInputBoxPadding()}updateInputBoxPadding(e=!1){var t,i,n;e?this.inputBox.paddingRight=0:this.inputBox.paddingRight=(((t=this.caseSensitive)==null?void 0:t.width())??0)+(((i=this.wholeWords)==null?void 0:i.width())??0)+(((n=this.regex)==null?void 0:n.width())??0)+this.additionalToggles.reduce((r,o)=>r+o.width(),0)}getValue(){return this.inputBox.value}setValue(e){this.inputBox.value!==e&&(this.inputBox.value=e)}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getCaseSensitive(){var e;return((e=this.caseSensitive)==null?void 0:e.checked)??!1}setCaseSensitive(e){this.caseSensitive&&(this.caseSensitive.checked=e)}getWholeWords(){var e;return((e=this.wholeWords)==null?void 0:e.checked)??!1}setWholeWords(e){this.wholeWords&&(this.wholeWords.checked=e)}getRegex(){var e;return((e=this.regex)==null?void 0:e.checked)??!1}setRegex(e){this.regex&&(this.regex.checked=e,this.validate())}focusOnCaseSensitive(){var e;(e=this.caseSensitive)==null||e.focus()}highlightFindOptions(){this.domNode.classList.remove("highlight-"+this._lastHighlightFindOptions),this._lastHighlightFindOptions=1-this._lastHighlightFindOptions,this.domNode.classList.add("highlight-"+this._lastHighlightFindOptions)}validate(){this.inputBox.validate()}showMessage(e){this.inputBox.showMessage(e)}clearMessage(){this.inputBox.hideMessage()}}const Y7e=ke;class X7e extends te{constructor(e,t,i){super(),this.parent=e,this.onKeyDown=r=>yn(this.findInput.inputBox.inputElement,Le.KEY_DOWN,r),this.onDidChange=r=>this.findInput.onDidChange(r),this.container=me(this.parent,Y7e(".quick-input-box")),this.findInput=this._register(new Jge(this.container,void 0,{label:"",inputBoxStyles:t,toggleStyles:i}));const n=this.findInput.inputBox.inputElement;n.role="combobox",n.ariaHasPopup="menu",n.ariaAutoComplete="list",n.ariaExpanded="true"}get value(){return this.findInput.getValue()}set value(e){this.findInput.setValue(e)}select(e=null){this.findInput.inputBox.select(e)}getSelection(){return this.findInput.inputBox.getSelection()}isSelectionAtEnd(){return this.findInput.inputBox.isSelectionAtEnd()}get placeholder(){return this.findInput.inputBox.inputElement.getAttribute("placeholder")||""}set placeholder(e){this.findInput.inputBox.setPlaceHolder(e)}get password(){return this.findInput.inputBox.inputElement.type==="password"}set password(e){this.findInput.inputBox.inputElement.type=e?"password":"text"}set enabled(e){this.findInput.inputBox.inputElement.toggleAttribute("readonly",!e)}set toggles(e){this.findInput.setAdditionalToggles(e)}setAttribute(e,t){this.findInput.inputBox.inputElement.setAttribute(e,t)}showDecoration(e){e===Hn.Ignore?this.findInput.clearMessage():this.findInput.showMessage({type:e===Hn.Info?1:e===Hn.Warning?2:3,content:""})}stylesForType(e){return this.findInput.inputBox.stylesForType(e===Hn.Info?1:e===Hn.Warning?2:3)}setFocus(){this.findInput.focus()}layout(){this.findInput.inputBox.layout()}}class Z7e{get templateId(){return this.renderer.templateId}constructor(e,t){this.renderer=e,this.modelProvider=t}renderTemplate(e){return{data:this.renderer.renderTemplate(e),disposable:te.None}}renderElement(e,t,i,n){var l;if((l=i.disposable)==null||l.dispose(),!i.data)return;const r=this.modelProvider();if(r.isResolved(e))return this.renderer.renderElement(r.get(e),e,i.data,n);const o=new mn,a=r.resolve(e,o.token);i.disposable={dispose:()=>o.cancel()},this.renderer.renderPlaceholder(e,i.data),a.then(c=>this.renderer.renderElement(c,e,i.data,n))}disposeTemplate(e){e.disposable&&(e.disposable.dispose(),e.disposable=void 0),e.data&&(this.renderer.disposeTemplate(e.data),e.data=void 0)}}class J7e{constructor(e,t){this.modelProvider=e,this.accessibilityProvider=t}getWidgetAriaLabel(){return this.accessibilityProvider.getWidgetAriaLabel()}getAriaLabel(e){const t=this.modelProvider();return t.isResolved(e)?this.accessibilityProvider.getAriaLabel(t.get(e)):null}}function eWe(s,e){return{...e,accessibilityProvider:e.accessibilityProvider&&new J7e(s,e.accessibilityProvider)}}class tWe{constructor(e,t,i,n,r={}){const o=()=>this.model,a=n.map(l=>new Z7e(l,o));this.list=new Bl(e,t,i,a,eWe(o,r))}updateOptions(e){this.list.updateOptions(e)}getHTMLElement(){return this.list.getHTMLElement()}get onDidFocus(){return this.list.onDidFocus}get widget(){return this.list}get onDidDispose(){return this.list.onDidDispose}get onMouseDblClick(){return De.map(this.list.onMouseDblClick,({element:e,index:t,browserEvent:i})=>({element:e===void 0?void 0:this._model.get(e),index:t,browserEvent:i}))}get onPointer(){return De.map(this.list.onPointer,({element:e,index:t,browserEvent:i})=>({element:e===void 0?void 0:this._model.get(e),index:t,browserEvent:i}))}get onDidChangeSelection(){return De.map(this.list.onDidChangeSelection,({elements:e,indexes:t,browserEvent:i})=>({elements:e.map(n=>this._model.get(n)),indexes:t,browserEvent:i}))}get model(){return this._model}set model(e){this._model=e,this.list.splice(0,this.list.length,Uo(e.length))}getFocus(){return this.list.getFocus()}getSelection(){return this.list.getSelection()}getSelectedElements(){return this.getSelection().map(e=>this.model.get(e))}style(e){this.list.style(e)}dispose(){this.list.dispose()}}var yS=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r};const iWe=!1;var VA;(function(s){s.North="north",s.South="south",s.East="east",s.West="west"})(VA||(VA={}));let nWe=4;const sWe=new Z;let rWe=300;const oWe=new Z;class YK{constructor(e){this.el=e,this.disposables=new ce}get onPointerMove(){return this.disposables.add(new Ut(nt(this.el),"mousemove")).event}get onPointerUp(){return this.disposables.add(new Ut(nt(this.el),"mouseup")).event}dispose(){this.disposables.dispose()}}yS([$n],YK.prototype,"onPointerMove",null);yS([$n],YK.prototype,"onPointerUp",null);class XK{get onPointerMove(){return this.disposables.add(new Ut(this.el,Vi.Change)).event}get onPointerUp(){return this.disposables.add(new Ut(this.el,Vi.End)).event}constructor(e){this.el=e,this.disposables=new ce}dispose(){this.disposables.dispose()}}yS([$n],XK.prototype,"onPointerMove",null);yS([$n],XK.prototype,"onPointerUp",null);class BA{get onPointerMove(){return this.factory.onPointerMove}get onPointerUp(){return this.factory.onPointerUp}constructor(e){this.factory=e}dispose(){}}yS([$n],BA.prototype,"onPointerMove",null);yS([$n],BA.prototype,"onPointerUp",null);const Une="pointer-events-disabled";class Sr extends te{get state(){return this._state}get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}set state(e){this._state!==e&&(this.el.classList.toggle("disabled",e===0),this.el.classList.toggle("minimum",e===1),this.el.classList.toggle("maximum",e===2),this._state=e,this.onDidEnablementChange.fire(e))}set orthogonalStartSash(e){if(this._orthogonalStartSash!==e){if(this.orthogonalStartDragHandleDisposables.clear(),this.orthogonalStartSashDisposables.clear(),e){const t=i=>{this.orthogonalStartDragHandleDisposables.clear(),i!==0&&(this._orthogonalStartDragHandle=me(this.el,ke(".orthogonal-drag-handle.start")),this.orthogonalStartDragHandleDisposables.add(Ye(()=>this._orthogonalStartDragHandle.remove())),this.orthogonalStartDragHandleDisposables.add(new Ut(this._orthogonalStartDragHandle,"mouseenter")).event(()=>Sr.onMouseEnter(e),void 0,this.orthogonalStartDragHandleDisposables),this.orthogonalStartDragHandleDisposables.add(new Ut(this._orthogonalStartDragHandle,"mouseleave")).event(()=>Sr.onMouseLeave(e),void 0,this.orthogonalStartDragHandleDisposables))};this.orthogonalStartSashDisposables.add(e.onDidEnablementChange.event(t,this)),t(e.state)}this._orthogonalStartSash=e}}set orthogonalEndSash(e){if(this._orthogonalEndSash!==e){if(this.orthogonalEndDragHandleDisposables.clear(),this.orthogonalEndSashDisposables.clear(),e){const t=i=>{this.orthogonalEndDragHandleDisposables.clear(),i!==0&&(this._orthogonalEndDragHandle=me(this.el,ke(".orthogonal-drag-handle.end")),this.orthogonalEndDragHandleDisposables.add(Ye(()=>this._orthogonalEndDragHandle.remove())),this.orthogonalEndDragHandleDisposables.add(new Ut(this._orthogonalEndDragHandle,"mouseenter")).event(()=>Sr.onMouseEnter(e),void 0,this.orthogonalEndDragHandleDisposables),this.orthogonalEndDragHandleDisposables.add(new Ut(this._orthogonalEndDragHandle,"mouseleave")).event(()=>Sr.onMouseLeave(e),void 0,this.orthogonalEndDragHandleDisposables))};this.orthogonalEndSashDisposables.add(e.onDidEnablementChange.event(t,this)),t(e.state)}this._orthogonalEndSash=e}}constructor(e,t,i){super(),this.hoverDelay=rWe,this.hoverDelayer=this._register(new bc(this.hoverDelay)),this._state=3,this.onDidEnablementChange=this._register(new Z),this._onDidStart=this._register(new Z),this._onDidChange=this._register(new Z),this._onDidReset=this._register(new Z),this._onDidEnd=this._register(new Z),this.orthogonalStartSashDisposables=this._register(new ce),this.orthogonalStartDragHandleDisposables=this._register(new ce),this.orthogonalEndSashDisposables=this._register(new ce),this.orthogonalEndDragHandleDisposables=this._register(new ce),this.onDidStart=this._onDidStart.event,this.onDidChange=this._onDidChange.event,this.onDidReset=this._onDidReset.event,this.onDidEnd=this._onDidEnd.event,this.linkedSash=void 0,this.el=me(e,ke(".monaco-sash")),i.orthogonalEdge&&this.el.classList.add(`orthogonal-edge-${i.orthogonalEdge}`),Wt&&this.el.classList.add("mac");const n=this._register(new Ut(this.el,"mousedown")).event;this._register(n(u=>this.onPointerStart(u,new YK(e)),this));const r=this._register(new Ut(this.el,"dblclick")).event;this._register(r(this.onPointerDoublePress,this));const o=this._register(new Ut(this.el,"mouseenter")).event;this._register(o(()=>Sr.onMouseEnter(this)));const a=this._register(new Ut(this.el,"mouseleave")).event;this._register(a(()=>Sr.onMouseLeave(this))),this._register(Er.addTarget(this.el));const l=this._register(new Ut(this.el,Vi.Start)).event;this._register(l(u=>this.onPointerStart(u,new XK(this.el)),this));const c=this._register(new Ut(this.el,Vi.Tap)).event;let d;this._register(c(u=>{if(d){clearTimeout(d),d=void 0,this.onPointerDoublePress(u);return}clearTimeout(d),d=setTimeout(()=>d=void 0,250)},this)),typeof i.size=="number"?(this.size=i.size,i.orientation===0?this.el.style.width=`${this.size}px`:this.el.style.height=`${this.size}px`):(this.size=nWe,this._register(sWe.event(u=>{this.size=u,this.layout()}))),this._register(oWe.event(u=>this.hoverDelay=u)),this.layoutProvider=t,this.orthogonalStartSash=i.orthogonalStartSash,this.orthogonalEndSash=i.orthogonalEndSash,this.orientation=i.orientation||0,this.orientation===1?(this.el.classList.add("horizontal"),this.el.classList.remove("vertical")):(this.el.classList.remove("horizontal"),this.el.classList.add("vertical")),this.el.classList.toggle("debug",iWe),this.layout()}onPointerStart(e,t){jt.stop(e);let i=!1;if(!e.__orthogonalSashEvent){const p=this.getOrthogonalSash(e);p&&(i=!0,e.__orthogonalSashEvent=!0,p.onPointerStart(e,new BA(t)))}if(this.linkedSash&&!e.__linkedSashEvent&&(e.__linkedSashEvent=!0,this.linkedSash.onPointerStart(e,new BA(t))),!this.state)return;const n=this.el.ownerDocument.getElementsByTagName("iframe");for(const p of n)p.classList.add(Une);const r=e.pageX,o=e.pageY,a=e.altKey,l={startX:r,currentX:r,startY:o,currentY:o,altKey:a};this.el.classList.add("active"),this._onDidStart.fire(l);const c=Rl(this.el),d=()=>{let p="";i?p="all-scroll":this.orientation===1?this.state===1?p="s-resize":this.state===2?p="n-resize":p=Wt?"row-resize":"ns-resize":this.state===1?p="e-resize":this.state===2?p="w-resize":p=Wt?"col-resize":"ew-resize",c.textContent=`* { cursor: ${p} !important; }`},u=new ce;d(),i||this.onDidEnablementChange.event(d,null,u);const h=p=>{jt.stop(p,!1);const _={startX:r,currentX:p.pageX,startY:o,currentY:p.pageY,altKey:a};this._onDidChange.fire(_)},g=p=>{jt.stop(p,!1),c.remove(),this.el.classList.remove("active"),this._onDidEnd.fire(),u.dispose();for(const _ of n)_.classList.remove(Une)};t.onPointerMove(h,null,u),t.onPointerUp(g,null,u),u.add(t)}onPointerDoublePress(e){const t=this.getOrthogonalSash(e);t&&t._onDidReset.fire(),this.linkedSash&&this.linkedSash._onDidReset.fire(),this._onDidReset.fire()}static onMouseEnter(e,t=!1){e.el.classList.contains("active")?(e.hoverDelayer.cancel(),e.el.classList.add("hover")):e.hoverDelayer.trigger(()=>e.el.classList.add("hover"),e.hoverDelay).then(void 0,()=>{}),!t&&e.linkedSash&&Sr.onMouseEnter(e.linkedSash,!0)}static onMouseLeave(e,t=!1){e.hoverDelayer.cancel(),e.el.classList.remove("hover"),!t&&e.linkedSash&&Sr.onMouseLeave(e.linkedSash,!0)}clearSashHoverState(){Sr.onMouseLeave(this)}layout(){if(this.orientation===0){const e=this.layoutProvider;this.el.style.left=e.getVerticalSashLeft(this)-this.size/2+"px",e.getVerticalSashTop&&(this.el.style.top=e.getVerticalSashTop(this)+"px"),e.getVerticalSashHeight&&(this.el.style.height=e.getVerticalSashHeight(this)+"px")}else{const e=this.layoutProvider;this.el.style.top=e.getHorizontalSashTop(this)-this.size/2+"px",e.getHorizontalSashLeft&&(this.el.style.left=e.getHorizontalSashLeft(this)+"px"),e.getHorizontalSashWidth&&(this.el.style.width=e.getHorizontalSashWidth(this)+"px")}}getOrthogonalSash(e){const t=e.initialTarget??e.target;if(!(!t||!Ls(t))&&t.classList.contains("orthogonal-drag-handle"))return t.classList.contains("start")?this.orthogonalStartSash:this.orthogonalEndSash}dispose(){super.dispose(),this.el.remove()}}const aWe={separatorBorder:fe.transparent};class epe{set size(e){this._size=e}get size(){return this._size}get visible(){return typeof this._cachedVisibleSize>"u"}setVisible(e,t){var i,n;if(e!==this.visible){e?(this.size=ho(this._cachedVisibleSize,this.viewMinimumSize,this.viewMaximumSize),this._cachedVisibleSize=void 0):(this._cachedVisibleSize=typeof t=="number"?t:this.size,this.size=0),this.container.classList.toggle("visible",e);try{(n=(i=this.view).setVisible)==null||n.call(i,e)}catch(r){console.error("Splitview: Failed to set visible view"),console.error(r)}}}get minimumSize(){return this.visible?this.view.minimumSize:0}get viewMinimumSize(){return this.view.minimumSize}get maximumSize(){return this.visible?this.view.maximumSize:0}get viewMaximumSize(){return this.view.maximumSize}get priority(){return this.view.priority}get proportionalLayout(){return this.view.proportionalLayout??!0}get snap(){return!!this.view.snap}set enabled(e){this.container.style.pointerEvents=e?"":"none"}constructor(e,t,i,n){this.container=e,this.view=t,this.disposable=n,this._cachedVisibleSize=void 0,typeof i=="number"?(this._size=i,this._cachedVisibleSize=void 0,e.classList.add("visible")):(this._size=0,this._cachedVisibleSize=i.cachedVisibleSize)}layout(e,t){this.layoutContainer(e);try{this.view.layout(this.size,e,t)}catch(i){console.error("Splitview: Failed to layout view"),console.error(i)}}dispose(){this.disposable.dispose()}}class lWe extends epe{layoutContainer(e){this.container.style.top=`${e}px`,this.container.style.height=`${this.size}px`}}class cWe extends epe{layoutContainer(e){this.container.style.left=`${e}px`,this.container.style.width=`${this.size}px`}}var wf;(function(s){s[s.Idle=0]="Idle",s[s.Busy=1]="Busy"})(wf||(wf={}));var WA;(function(s){s.Distribute={type:"distribute"};function e(n){return{type:"split",index:n}}s.Split=e;function t(n){return{type:"auto",index:n}}s.Auto=t;function i(n){return{type:"invisible",cachedVisibleSize:n}}s.Invisible=i})(WA||(WA={}));class tpe extends te{get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}get startSnappingEnabled(){return this._startSnappingEnabled}get endSnappingEnabled(){return this._endSnappingEnabled}set orthogonalStartSash(e){for(const t of this.sashItems)t.sash.orthogonalStartSash=e;this._orthogonalStartSash=e}set orthogonalEndSash(e){for(const t of this.sashItems)t.sash.orthogonalEndSash=e;this._orthogonalEndSash=e}set startSnappingEnabled(e){this._startSnappingEnabled!==e&&(this._startSnappingEnabled=e,this.updateSashEnablement())}set endSnappingEnabled(e){this._endSnappingEnabled!==e&&(this._endSnappingEnabled=e,this.updateSashEnablement())}constructor(e,t={}){super(),this.size=0,this._contentSize=0,this.proportions=void 0,this.viewItems=[],this.sashItems=[],this.state=wf.Idle,this._onDidSashChange=this._register(new Z),this._onDidSashReset=this._register(new Z),this._startSnappingEnabled=!0,this._endSnappingEnabled=!0,this.onDidSashChange=this._onDidSashChange.event,this.onDidSashReset=this._onDidSashReset.event,this.orientation=t.orientation??0,this.inverseAltBehavior=t.inverseAltBehavior??!1,this.proportionalLayout=t.proportionalLayout??!0,this.getSashOrthogonalSize=t.getSashOrthogonalSize,this.el=document.createElement("div"),this.el.classList.add("monaco-split-view2"),this.el.classList.add(this.orientation===0?"vertical":"horizontal"),e.appendChild(this.el),this.sashContainer=me(this.el,ke(".sash-container")),this.viewContainer=ke(".split-view-container"),this.scrollable=this._register(new mS({forceIntegerValues:!0,smoothScrollDuration:125,scheduleAtNextAnimationFrame:n=>Fa(nt(this.el),n)})),this.scrollableElement=this._register(new DF(this.viewContainer,{vertical:this.orientation===0?t.scrollbarVisibility??1:2,horizontal:this.orientation===1?t.scrollbarVisibility??1:2},this.scrollable));const i=this._register(new Ut(this.viewContainer,"scroll")).event;this._register(i(n=>{const r=this.scrollableElement.getScrollPosition(),o=Math.abs(this.viewContainer.scrollLeft-r.scrollLeft)<=1?void 0:this.viewContainer.scrollLeft,a=Math.abs(this.viewContainer.scrollTop-r.scrollTop)<=1?void 0:this.viewContainer.scrollTop;(o!==void 0||a!==void 0)&&this.scrollableElement.setScrollPosition({scrollLeft:o,scrollTop:a})})),this.onDidScroll=this.scrollableElement.onScroll,this._register(this.onDidScroll(n=>{n.scrollTopChanged&&(this.viewContainer.scrollTop=n.scrollTop),n.scrollLeftChanged&&(this.viewContainer.scrollLeft=n.scrollLeft)})),me(this.el,this.scrollableElement.getDomNode()),this.style(t.styles||aWe),t.descriptor&&(this.size=t.descriptor.size,t.descriptor.views.forEach((n,r)=>{const o=Yr(n.visible)||n.visible?n.size:{type:"invisible",cachedVisibleSize:n.size},a=n.view;this.doAddView(a,o,r,!0)}),this._contentSize=this.viewItems.reduce((n,r)=>n+r.size,0),this.saveProportions())}style(e){e.separatorBorder.isTransparent()?(this.el.classList.remove("separator-border"),this.el.style.removeProperty("--separator-border")):(this.el.classList.add("separator-border"),this.el.style.setProperty("--separator-border",e.separatorBorder.toString()))}addView(e,t,i=this.viewItems.length,n){this.doAddView(e,t,i,n)}layout(e,t){const i=Math.max(this.size,this._contentSize);if(this.size=e,this.layoutContext=t,this.proportions){let n=0;for(let r=0;r<this.viewItems.length;r++){const o=this.viewItems[r],a=this.proportions[r];typeof a=="number"?n+=a:e-=o.size}for(let r=0;r<this.viewItems.length;r++){const o=this.viewItems[r],a=this.proportions[r];typeof a=="number"&&n>0&&(o.size=ho(Math.round(a*e/n),o.minimumSize,o.maximumSize))}}else{const n=Uo(this.viewItems.length),r=n.filter(a=>this.viewItems[a].priority===1),o=n.filter(a=>this.viewItems[a].priority===2);this.resize(this.viewItems.length-1,e-i,void 0,r,o)}this.distributeEmptySpace(),this.layoutViews()}saveProportions(){this.proportionalLayout&&this._contentSize>0&&(this.proportions=this.viewItems.map(e=>e.proportionalLayout&&e.visible?e.size/this._contentSize:void 0))}onSashStart({sash:e,start:t,alt:i}){for(const a of this.viewItems)a.enabled=!1;const n=this.sashItems.findIndex(a=>a.sash===e),r=id(oe(this.el.ownerDocument.body,"keydown",a=>o(this.sashDragState.current,a.altKey)),oe(this.el.ownerDocument.body,"keyup",()=>o(this.sashDragState.current,!1))),o=(a,l)=>{const c=this.viewItems.map(p=>p.size);let d=Number.NEGATIVE_INFINITY,u=Number.POSITIVE_INFINITY;if(this.inverseAltBehavior&&(l=!l),l)if(n===this.sashItems.length-1){const _=this.viewItems[n];d=(_.minimumSize-_.size)/2,u=(_.maximumSize-_.size)/2}else{const _=this.viewItems[n+1];d=(_.size-_.maximumSize)/2,u=(_.size-_.minimumSize)/2}let h,g;if(!l){const p=Uo(n,-1),_=Uo(n+1,this.viewItems.length),v=p.reduce((N,R)=>N+(this.viewItems[R].minimumSize-c[R]),0),C=p.reduce((N,R)=>N+(this.viewItems[R].viewMaximumSize-c[R]),0),y=_.length===0?Number.POSITIVE_INFINITY:_.reduce((N,R)=>N+(c[R]-this.viewItems[R].minimumSize),0),x=_.length===0?Number.NEGATIVE_INFINITY:_.reduce((N,R)=>N+(c[R]-this.viewItems[R].viewMaximumSize),0),L=Math.max(v,x),I=Math.min(y,C),A=this.findFirstSnapIndex(p),D=this.findFirstSnapIndex(_);if(typeof A=="number"){const N=this.viewItems[A],R=Math.floor(N.viewMinimumSize/2);h={index:A,limitDelta:N.visible?L-R:L+R,size:N.size}}if(typeof D=="number"){const N=this.viewItems[D],R=Math.floor(N.viewMinimumSize/2);g={index:D,limitDelta:N.visible?I+R:I-R,size:N.size}}}this.sashDragState={start:a,current:a,index:n,sizes:c,minDelta:d,maxDelta:u,alt:l,snapBefore:h,snapAfter:g,disposable:r}};o(t,i)}onSashChange({current:e}){const{index:t,start:i,sizes:n,alt:r,minDelta:o,maxDelta:a,snapBefore:l,snapAfter:c}=this.sashDragState;this.sashDragState.current=e;const d=e-i,u=this.resize(t,d,n,void 0,void 0,o,a,l,c);if(r){const h=t===this.sashItems.length-1,g=this.viewItems.map(x=>x.size),p=h?t:t+1,_=this.viewItems[p],v=_.size-_.maximumSize,C=_.size-_.minimumSize,y=h?t-1:t+1;this.resize(y,-u,g,void 0,void 0,v,C)}this.distributeEmptySpace(),this.layoutViews()}onSashEnd(e){this._onDidSashChange.fire(e),this.sashDragState.disposable.dispose(),this.saveProportions();for(const t of this.viewItems)t.enabled=!0}onViewChange(e,t){const i=this.viewItems.indexOf(e);i<0||i>=this.viewItems.length||(t=typeof t=="number"?t:e.size,t=ho(t,e.minimumSize,e.maximumSize),this.inverseAltBehavior&&i>0?(this.resize(i-1,Math.floor((e.size-t)/2)),this.distributeEmptySpace(),this.layoutViews()):(e.size=t,this.relayout([i],void 0)))}resizeView(e,t){if(!(e<0||e>=this.viewItems.length)){if(this.state!==wf.Idle)throw new Error("Cant modify splitview");this.state=wf.Busy;try{const i=Uo(this.viewItems.length).filter(a=>a!==e),n=[...i.filter(a=>this.viewItems[a].priority===1),e],r=i.filter(a=>this.viewItems[a].priority===2),o=this.viewItems[e];t=Math.round(t),t=ho(t,o.minimumSize,Math.min(o.maximumSize,this.size)),o.size=t,this.relayout(n,r)}finally{this.state=wf.Idle}}}distributeViewSizes(){const e=[];let t=0;for(const a of this.viewItems)a.maximumSize-a.minimumSize>0&&(e.push(a),t+=a.size);const i=Math.floor(t/e.length);for(const a of e)a.size=ho(i,a.minimumSize,a.maximumSize);const n=Uo(this.viewItems.length),r=n.filter(a=>this.viewItems[a].priority===1),o=n.filter(a=>this.viewItems[a].priority===2);this.relayout(r,o)}getViewSize(e){return e<0||e>=this.viewItems.length?-1:this.viewItems[e].size}doAddView(e,t,i=this.viewItems.length,n){if(this.state!==wf.Idle)throw new Error("Cant modify splitview");this.state=wf.Busy;try{const r=ke(".split-view-view");i===this.viewItems.length?this.viewContainer.appendChild(r):this.viewContainer.insertBefore(r,this.viewContainer.children.item(i));const o=e.onDidChange(h=>this.onViewChange(d,h)),a=Ye(()=>r.remove()),l=id(o,a);let c;typeof t=="number"?c=t:(t.type==="auto"&&(this.areViewsDistributed()?t={type:"distribute"}:t={type:"split",index:t.index}),t.type==="split"?c=this.getViewSize(t.index)/2:t.type==="invisible"?c={cachedVisibleSize:t.cachedVisibleSize}:c=e.minimumSize);const d=this.orientation===0?new lWe(r,e,c,l):new cWe(r,e,c,l);if(this.viewItems.splice(i,0,d),this.viewItems.length>1){const h={orthogonalStartSash:this.orthogonalStartSash,orthogonalEndSash:this.orthogonalEndSash},g=this.orientation===0?new Sr(this.sashContainer,{getHorizontalSashTop:N=>this.getSashPosition(N),getHorizontalSashWidth:this.getSashOrthogonalSize},{...h,orientation:1}):new Sr(this.sashContainer,{getVerticalSashLeft:N=>this.getSashPosition(N),getVerticalSashHeight:this.getSashOrthogonalSize},{...h,orientation:0}),p=this.orientation===0?N=>({sash:g,start:N.startY,current:N.currentY,alt:N.altKey}):N=>({sash:g,start:N.startX,current:N.currentX,alt:N.altKey}),v=De.map(g.onDidStart,p)(this.onSashStart,this),y=De.map(g.onDidChange,p)(this.onSashChange,this),L=De.map(g.onDidEnd,()=>this.sashItems.findIndex(N=>N.sash===g))(this.onSashEnd,this),I=g.onDidReset(()=>{const N=this.sashItems.findIndex(B=>B.sash===g),R=Uo(N,-1),W=Uo(N+1,this.viewItems.length),H=this.findFirstSnapIndex(R),U=this.findFirstSnapIndex(W);typeof H=="number"&&!this.viewItems[H].visible||typeof U=="number"&&!this.viewItems[U].visible||this._onDidSashReset.fire(N)}),A=id(v,y,L,I,g),D={sash:g,disposable:A};this.sashItems.splice(i-1,0,D)}r.appendChild(e.element);let u;typeof t!="number"&&t.type==="split"&&(u=[t.index]),n||this.relayout([i],u),!n&&typeof t!="number"&&t.type==="distribute"&&this.distributeViewSizes()}finally{this.state=wf.Idle}}relayout(e,t){const i=this.viewItems.reduce((n,r)=>n+r.size,0);this.resize(this.viewItems.length-1,this.size-i,void 0,e,t),this.distributeEmptySpace(),this.layoutViews(),this.saveProportions()}resize(e,t,i=this.viewItems.map(d=>d.size),n,r,o=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY,l,c){if(e<0||e>=this.viewItems.length)return 0;const d=Uo(e,-1),u=Uo(e+1,this.viewItems.length);if(r)for(const D of r)U9(d,D),U9(u,D);if(n)for(const D of n)KT(d,D),KT(u,D);const h=d.map(D=>this.viewItems[D]),g=d.map(D=>i[D]),p=u.map(D=>this.viewItems[D]),_=u.map(D=>i[D]),v=d.reduce((D,N)=>D+(this.viewItems[N].minimumSize-i[N]),0),C=d.reduce((D,N)=>D+(this.viewItems[N].maximumSize-i[N]),0),y=u.length===0?Number.POSITIVE_INFINITY:u.reduce((D,N)=>D+(i[N]-this.viewItems[N].minimumSize),0),x=u.length===0?Number.NEGATIVE_INFINITY:u.reduce((D,N)=>D+(i[N]-this.viewItems[N].maximumSize),0),L=Math.max(v,x,o),I=Math.min(y,C,a);let A=!1;if(l){const D=this.viewItems[l.index],N=t>=l.limitDelta;A=N!==D.visible,D.setVisible(N,l.size)}if(!A&&c){const D=this.viewItems[c.index],N=t<c.limitDelta;A=N!==D.visible,D.setVisible(N,c.size)}if(A)return this.resize(e,t,i,n,r,o,a);t=ho(t,L,I);for(let D=0,N=t;D<h.length;D++){const R=h[D],W=ho(g[D]+N,R.minimumSize,R.maximumSize),H=W-g[D];N-=H,R.size=W}for(let D=0,N=t;D<p.length;D++){const R=p[D],W=ho(_[D]-N,R.minimumSize,R.maximumSize),H=W-_[D];N+=H,R.size=W}return t}distributeEmptySpace(e){const t=this.viewItems.reduce((a,l)=>a+l.size,0);let i=this.size-t;const n=Uo(this.viewItems.length-1,-1),r=n.filter(a=>this.viewItems[a].priority===1),o=n.filter(a=>this.viewItems[a].priority===2);for(const a of o)U9(n,a);for(const a of r)KT(n,a);typeof e=="number"&&KT(n,e);for(let a=0;i!==0&&a<n.length;a++){const l=this.viewItems[n[a]],c=ho(l.size+i,l.minimumSize,l.maximumSize),d=c-l.size;i-=d,l.size=c}}layoutViews(){this._contentSize=this.viewItems.reduce((t,i)=>t+i.size,0);let e=0;for(const t of this.viewItems)t.layout(e,this.layoutContext),e+=t.size;this.sashItems.forEach(t=>t.sash.layout()),this.updateSashEnablement(),this.updateScrollableElement()}updateScrollableElement(){this.orientation===0?this.scrollableElement.setScrollDimensions({height:this.size,scrollHeight:this._contentSize}):this.scrollableElement.setScrollDimensions({width:this.size,scrollWidth:this._contentSize})}updateSashEnablement(){let e=!1;const t=this.viewItems.map(l=>e=l.size-l.minimumSize>0||e);e=!1;const i=this.viewItems.map(l=>e=l.maximumSize-l.size>0||e),n=[...this.viewItems].reverse();e=!1;const r=n.map(l=>e=l.size-l.minimumSize>0||e).reverse();e=!1;const o=n.map(l=>e=l.maximumSize-l.size>0||e).reverse();let a=0;for(let l=0;l<this.sashItems.length;l++){const{sash:c}=this.sashItems[l],d=this.viewItems[l];a+=d.size;const u=!(t[l]&&o[l+1]),h=!(i[l]&&r[l+1]);if(u&&h){const g=Uo(l,-1),p=Uo(l+1,this.viewItems.length),_=this.findFirstSnapIndex(g),v=this.findFirstSnapIndex(p),C=typeof _=="number"&&!this.viewItems[_].visible,y=typeof v=="number"&&!this.viewItems[v].visible;C&&r[l]&&(a>0||this.startSnappingEnabled)?c.state=1:y&&t[l]&&(a<this._contentSize||this.endSnappingEnabled)?c.state=2:c.state=0}else u&&!h?c.state=1:!u&&h?c.state=2:c.state=3}}getSashPosition(e){let t=0;for(let i=0;i<this.sashItems.length;i++)if(t+=this.viewItems[i].size,this.sashItems[i].sash===e)return t;return 0}findFirstSnapIndex(e){for(const t of e){const i=this.viewItems[t];if(i.visible&&i.snap)return t}for(const t of e){const i=this.viewItems[t];if(i.visible&&i.maximumSize-i.minimumSize>0)return;if(!i.visible&&i.snap)return t}}areViewsDistributed(){let e,t;for(const i of this.viewItems)if(e=e===void 0?i.size:Math.min(e,i.size),t=t===void 0?i.size:Math.max(t,i.size),t-e>2)return!1;return!0}dispose(){var e;(e=this.sashDragState)==null||e.disposable.dispose(),Ni(this.viewItems),this.viewItems=[],this.sashItems.forEach(t=>t.disposable.dispose()),this.sashItems=[],super.dispose()}}const ZM=class ZM{constructor(e,t,i){this.columns=e,this.getColumnSize=i,this.templateId=ZM.TemplateId,this.renderedTemplates=new Set;const n=new Map(t.map(r=>[r.templateId,r]));this.renderers=[];for(const r of e){const o=n.get(r.templateId);if(!o)throw new Error(`Table cell renderer for template id ${r.templateId} not found.`);this.renderers.push(o)}}renderTemplate(e){const t=me(e,ke(".monaco-table-tr")),i=[],n=[];for(let o=0;o<this.columns.length;o++){const a=this.renderers[o],l=me(t,ke(".monaco-table-td",{"data-col-index":o}));l.style.width=`${this.getColumnSize(o)}px`,i.push(l),n.push(a.renderTemplate(l))}const r={container:e,cellContainers:i,cellTemplateData:n};return this.renderedTemplates.add(r),r}renderElement(e,t,i,n){for(let r=0;r<this.columns.length;r++){const a=this.columns[r].project(e);this.renderers[r].renderElement(a,t,i.cellTemplateData[r],n)}}disposeElement(e,t,i,n){for(let r=0;r<this.columns.length;r++){const o=this.renderers[r];if(o.disposeElement){const l=this.columns[r].project(e);o.disposeElement(l,t,i.cellTemplateData[r],n)}}}disposeTemplate(e){for(let t=0;t<this.columns.length;t++)this.renderers[t].disposeTemplate(e.cellTemplateData[t]);Ys(e.container),this.renderedTemplates.delete(e)}layoutColumn(e,t){for(const{cellContainers:i}of this.renderedTemplates)i[e].style.width=`${t}px`}};ZM.TemplateId="row";let HA=ZM;function dWe(s){return{getHeight(e){return s.getHeight(e)},getTemplateId(){return HA.TemplateId}}}class uWe extends te{get minimumSize(){return this.column.minimumWidth??120}get maximumSize(){return this.column.maximumWidth??Number.POSITIVE_INFINITY}get onDidChange(){return this.column.onDidChangeWidthConstraints??De.None}constructor(e,t){super(),this.column=e,this.index=t,this._onDidLayout=new Z,this.onDidLayout=this._onDidLayout.event,this.element=ke(".monaco-table-th",{"data-col-index":t},e.label),e.tooltip&&this._register(wu().setupManagedHover(No("mouse"),this.element,e.tooltip))}layout(e){this._onDidLayout.fire([this.index,e])}}const JM=class JM{get onDidChangeFocus(){return this.list.onDidChangeFocus}get onDidChangeSelection(){return this.list.onDidChangeSelection}get onDidScroll(){return this.list.onDidScroll}get onMouseDblClick(){return this.list.onMouseDblClick}get onPointer(){return this.list.onPointer}get onDidFocus(){return this.list.onDidFocus}get scrollTop(){return this.list.scrollTop}set scrollTop(e){this.list.scrollTop=e}get scrollHeight(){return this.list.scrollHeight}get renderHeight(){return this.list.renderHeight}get onDidDispose(){return this.list.onDidDispose}constructor(e,t,i,n,r,o){this.virtualDelegate=i,this.columns=n,this.domId=`table_id_${++JM.InstanceCount}`,this.disposables=new ce,this.cachedWidth=0,this.cachedHeight=0,this.domNode=me(t,ke(`.monaco-table.${this.domId}`));const a=n.map((d,u)=>this.disposables.add(new uWe(d,u))),l={size:a.reduce((d,u)=>d+u.column.weight,0),views:a.map(d=>({size:d.column.weight,view:d}))};this.splitview=this.disposables.add(new tpe(this.domNode,{orientation:1,scrollbarVisibility:2,getSashOrthogonalSize:()=>this.cachedHeight,descriptor:l})),this.splitview.el.style.height=`${i.headerRowHeight}px`,this.splitview.el.style.lineHeight=`${i.headerRowHeight}px`;const c=new HA(n,r,d=>this.splitview.getViewSize(d));this.list=this.disposables.add(new Bl(e,this.domNode,dWe(i),[c],o)),De.any(...a.map(d=>d.onDidLayout))(([d,u])=>c.layoutColumn(d,u),null,this.disposables),this.splitview.onDidSashReset(d=>{const u=n.reduce((g,p)=>g+p.weight,0),h=n[d].weight/u*this.cachedWidth;this.splitview.resizeView(d,h)},null,this.disposables),this.styleElement=Rl(this.domNode),this.style(O9e)}updateOptions(e){this.list.updateOptions(e)}splice(e,t,i=[]){this.list.splice(e,t,i)}getHTMLElement(){return this.domNode}style(e){const t=[];t.push(`.monaco-table.${this.domId} > .monaco-split-view2 .monaco-sash.vertical::before {
			top: ${this.virtualDelegate.headerRowHeight+1}px;
			height: calc(100% - ${this.virtualDelegate.headerRowHeight}px);
		}`),this.styleElement.textContent=t.join(`
`),this.list.style(e)}getSelectedElements(){return this.list.getSelectedElements()}getSelection(){return this.list.getSelection()}getFocus(){return this.list.getFocus()}dispose(){this.disposables.dispose()}};JM.InstanceCount=0;let H8=JM;var dl;(function(s){s[s.Expanded=0]="Expanded",s[s.Collapsed=1]="Collapsed",s[s.PreserveOrExpanded=2]="PreserveOrExpanded",s[s.PreserveOrCollapsed=3]="PreserveOrCollapsed"})(dl||(dl={}));var Hb;(function(s){s[s.Unknown=0]="Unknown",s[s.Twistie=1]="Twistie",s[s.Element=2]="Element",s[s.Filter=3]="Filter"})(Hb||(Hb={}));class bl extends Error{constructor(e,t){super(`TreeError [${e}] ${t}`)}}class ZK{constructor(e){this.fn=e,this._map=new WeakMap}map(e){let t=this._map.get(e);return t||(t=this.fn(e),this._map.set(e,t)),t}}function JK(s){return typeof s=="object"&&"visibility"in s&&"data"in s}function NI(s){switch(s){case!0:return 1;case!1:return 0;default:return s}}function QV(s){return typeof s.collapsible=="boolean"}class hWe{constructor(e,t,i,n={}){this.user=e,this.list=t,this.rootRef=[],this.eventBufferer=new BE,this._onDidChangeCollapseState=new Z,this.onDidChangeCollapseState=this.eventBufferer.wrapEvent(this._onDidChangeCollapseState.event),this._onDidChangeRenderNodeCount=new Z,this.onDidChangeRenderNodeCount=this.eventBufferer.wrapEvent(this._onDidChangeRenderNodeCount.event),this._onDidSplice=new Z,this.onDidSplice=this._onDidSplice.event,this.refilterDelayer=new bc(Fue),this.collapseByDefault=typeof n.collapseByDefault>"u"?!1:n.collapseByDefault,this.allowNonCollapsibleParents=n.allowNonCollapsibleParents??!1,this.filter=n.filter,this.autoExpandSingleChildren=typeof n.autoExpandSingleChildren>"u"?!1:n.autoExpandSingleChildren,this.root={parent:void 0,element:i,children:[],depth:0,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:!1,collapsed:!1,renderNodeCount:0,visibility:1,visible:!0,filterData:void 0}}splice(e,t,i=Kt.empty(),n={}){if(e.length===0)throw new bl(this.user,"Invalid tree location");n.diffIdentityProvider?this.spliceSmart(n.diffIdentityProvider,e,t,i,n):this.spliceSimple(e,t,i,n)}spliceSmart(e,t,i,n=Kt.empty(),r,o=r.diffDepth??0){const{parentNode:a}=this.getParentNodeWithListIndex(t);if(!a.lastDiffIds)return this.spliceSimple(t,i,n,r);const l=[...n],c=t[t.length-1],d=new ch({getElements:()=>a.lastDiffIds},{getElements:()=>[...a.children.slice(0,c),...l,...a.children.slice(c+i)].map(_=>e.getId(_.element).toString())}).ComputeDiff(!1);if(d.quitEarly)return a.lastDiffIds=void 0,this.spliceSimple(t,i,l,r);const u=t.slice(0,-1),h=(_,v,C)=>{if(o>0)for(let y=0;y<C;y++)_--,v--,this.spliceSmart(e,[...u,_,0],Number.MAX_SAFE_INTEGER,l[v].children,r,o-1)};let g=Math.min(a.children.length,c+i),p=l.length;for(const _ of d.changes.sort((v,C)=>C.originalStart-v.originalStart))h(g,p,g-(_.originalStart+_.originalLength)),g=_.originalStart,p=_.modifiedStart-c,this.spliceSimple([...u,g],_.originalLength,Kt.slice(l,p,p+_.modifiedLength),r);h(g,p,g)}spliceSimple(e,t,i=Kt.empty(),{onDidCreateNode:n,onDidDeleteNode:r,diffIdentityProvider:o}){const{parentNode:a,listIndex:l,revealed:c,visible:d}=this.getParentNodeWithListIndex(e),u=[],h=Kt.map(i,I=>this.createTreeNode(I,a,a.visible?1:0,c,u,n)),g=e[e.length-1];let p=0;for(let I=g;I>=0&&I<a.children.length;I--){const A=a.children[I];if(A.visible){p=A.visibleChildIndex;break}}const _=[];let v=0,C=0;for(const I of h)_.push(I),C+=I.renderNodeCount,I.visible&&(I.visibleChildIndex=p+v++);const y=Wee(a.children,g,t,_);o?a.lastDiffIds?Wee(a.lastDiffIds,g,t,_.map(I=>o.getId(I.element).toString())):a.lastDiffIds=a.children.map(I=>o.getId(I.element).toString()):a.lastDiffIds=void 0;let x=0;for(const I of y)I.visible&&x++;if(x!==0)for(let I=g+_.length;I<a.children.length;I++){const A=a.children[I];A.visible&&(A.visibleChildIndex-=x)}if(a.visibleChildrenCount+=v-x,c&&d){const I=y.reduce((A,D)=>A+(D.visible?D.renderNodeCount:0),0);this._updateAncestorsRenderNodeCount(a,C-I),this.list.splice(l,I,u)}if(y.length>0&&r){const I=A=>{r(A),A.children.forEach(I)};y.forEach(I)}this._onDidSplice.fire({insertedNodes:_,deletedNodes:y});let L=a;for(;L;){if(L.visibility===2){this.refilterDelayer.trigger(()=>this.refilter());break}L=L.parent}}rerender(e){if(e.length===0)throw new bl(this.user,"Invalid tree location");const{node:t,listIndex:i,revealed:n}=this.getTreeNodeWithListIndex(e);t.visible&&n&&this.list.splice(i,1,[t])}has(e){return this.hasTreeNode(e)}getListIndex(e){const{listIndex:t,visible:i,revealed:n}=this.getTreeNodeWithListIndex(e);return i&&n?t:-1}getListRenderCount(e){return this.getTreeNode(e).renderNodeCount}isCollapsible(e){return this.getTreeNode(e).collapsible}setCollapsible(e,t){const i=this.getTreeNode(e);typeof t>"u"&&(t=!i.collapsible);const n={collapsible:t};return this.eventBufferer.bufferEvents(()=>this._setCollapseState(e,n))}isCollapsed(e){return this.getTreeNode(e).collapsed}setCollapsed(e,t,i){const n=this.getTreeNode(e);typeof t>"u"&&(t=!n.collapsed);const r={collapsed:t,recursive:i||!1};return this.eventBufferer.bufferEvents(()=>this._setCollapseState(e,r))}_setCollapseState(e,t){const{node:i,listIndex:n,revealed:r}=this.getTreeNodeWithListIndex(e),o=this._setListNodeCollapseState(i,n,r,t);if(i!==this.root&&this.autoExpandSingleChildren&&o&&!QV(t)&&i.collapsible&&!i.collapsed&&!t.recursive){let a=-1;for(let l=0;l<i.children.length;l++)if(i.children[l].visible)if(a>-1){a=-1;break}else a=l;a>-1&&this._setCollapseState([...e,a],t)}return o}_setListNodeCollapseState(e,t,i,n){const r=this._setNodeCollapseState(e,n,!1);if(!i||!e.visible||!r)return r;const o=e.renderNodeCount,a=this.updateNodeAfterCollapseChange(e),l=o-(t===-1?0:1);return this.list.splice(t+1,l,a.slice(1)),r}_setNodeCollapseState(e,t,i){let n;if(e===this.root?n=!1:(QV(t)?(n=e.collapsible!==t.collapsible,e.collapsible=t.collapsible):e.collapsible?(n=e.collapsed!==t.collapsed,e.collapsed=t.collapsed):n=!1,n&&this._onDidChangeCollapseState.fire({node:e,deep:i})),!QV(t)&&t.recursive)for(const r of e.children)n=this._setNodeCollapseState(r,t,!0)||n;return n}expandTo(e){this.eventBufferer.bufferEvents(()=>{let t=this.getTreeNode(e);for(;t.parent;)t=t.parent,e=e.slice(0,e.length-1),t.collapsed&&this._setCollapseState(e,{collapsed:!1,recursive:!1})})}refilter(){const e=this.root.renderNodeCount,t=this.updateNodeAfterFilterChange(this.root);this.list.splice(0,e,t),this.refilterDelayer.cancel()}createTreeNode(e,t,i,n,r,o){const a={parent:t,element:e.element,children:[],depth:t.depth+1,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:typeof e.collapsible=="boolean"?e.collapsible:typeof e.collapsed<"u",collapsed:typeof e.collapsed>"u"?this.collapseByDefault:e.collapsed,renderNodeCount:1,visibility:1,visible:!0,filterData:void 0},l=this._filterNode(a,i);a.visibility=l,n&&r.push(a);const c=e.children||Kt.empty(),d=n&&l!==0&&!a.collapsed;let u=0,h=1;for(const g of c){const p=this.createTreeNode(g,a,l,d,r,o);a.children.push(p),h+=p.renderNodeCount,p.visible&&(p.visibleChildIndex=u++)}return this.allowNonCollapsibleParents||(a.collapsible=a.collapsible||a.children.length>0),a.visibleChildrenCount=u,a.visible=l===2?u>0:l===1,a.visible?a.collapsed||(a.renderNodeCount=h):(a.renderNodeCount=0,n&&r.pop()),o==null||o(a),a}updateNodeAfterCollapseChange(e){const t=e.renderNodeCount,i=[];return this._updateNodeAfterCollapseChange(e,i),this._updateAncestorsRenderNodeCount(e.parent,i.length-t),i}_updateNodeAfterCollapseChange(e,t){if(e.visible===!1)return 0;if(t.push(e),e.renderNodeCount=1,!e.collapsed)for(const i of e.children)e.renderNodeCount+=this._updateNodeAfterCollapseChange(i,t);return this._onDidChangeRenderNodeCount.fire(e),e.renderNodeCount}updateNodeAfterFilterChange(e){const t=e.renderNodeCount,i=[];return this._updateNodeAfterFilterChange(e,e.visible?1:0,i),this._updateAncestorsRenderNodeCount(e.parent,i.length-t),i}_updateNodeAfterFilterChange(e,t,i,n=!0){let r;if(e!==this.root){if(r=this._filterNode(e,t),r===0)return e.visible=!1,e.renderNodeCount=0,!1;n&&i.push(e)}const o=i.length;e.renderNodeCount=e===this.root?0:1;let a=!1;if(!e.collapsed||r!==0){let l=0;for(const c of e.children)a=this._updateNodeAfterFilterChange(c,r,i,n&&!e.collapsed)||a,c.visible&&(c.visibleChildIndex=l++);e.visibleChildrenCount=l}else e.visibleChildrenCount=0;return e!==this.root&&(e.visible=r===2?a:r===1,e.visibility=r),e.visible?e.collapsed||(e.renderNodeCount+=i.length-o):(e.renderNodeCount=0,n&&i.pop()),this._onDidChangeRenderNodeCount.fire(e),e.visible}_updateAncestorsRenderNodeCount(e,t){if(t!==0)for(;e;)e.renderNodeCount+=t,this._onDidChangeRenderNodeCount.fire(e),e=e.parent}_filterNode(e,t){const i=this.filter?this.filter.filter(e.element,t):1;return typeof i=="boolean"?(e.filterData=void 0,i?1:0):JK(i)?(e.filterData=i.data,NI(i.visibility)):(e.filterData=void 0,NI(i))}hasTreeNode(e,t=this.root){if(!e||e.length===0)return!0;const[i,...n]=e;return i<0||i>t.children.length?!1:this.hasTreeNode(n,t.children[i])}getTreeNode(e,t=this.root){if(!e||e.length===0)return t;const[i,...n]=e;if(i<0||i>t.children.length)throw new bl(this.user,"Invalid tree location");return this.getTreeNode(n,t.children[i])}getTreeNodeWithListIndex(e){if(e.length===0)return{node:this.root,listIndex:-1,revealed:!0,visible:!1};const{parentNode:t,listIndex:i,revealed:n,visible:r}=this.getParentNodeWithListIndex(e),o=e[e.length-1];if(o<0||o>t.children.length)throw new bl(this.user,"Invalid tree location");const a=t.children[o];return{node:a,listIndex:i,revealed:n,visible:r&&a.visible}}getParentNodeWithListIndex(e,t=this.root,i=0,n=!0,r=!0){const[o,...a]=e;if(o<0||o>t.children.length)throw new bl(this.user,"Invalid tree location");for(let l=0;l<o;l++)i+=t.children[l].renderNodeCount;return n=n&&!t.collapsed,r=r&&t.visible,a.length===0?{parentNode:t,listIndex:i,revealed:n,visible:r}:this.getParentNodeWithListIndex(a,t.children[o],i+1,n,r)}getNode(e=[]){return this.getTreeNode(e)}getNodeLocation(e){const t=[];let i=e;for(;i.parent;)t.push(i.parent.children.indexOf(i)),i=i.parent;return t.reverse()}getParentNodeLocation(e){if(e.length!==0)return e.length===1?[]:LTe(e)[0]}getFirstElementChild(e){const t=this.getTreeNode(e);if(t.children.length!==0)return t.children[0].element}}class fWe extends sD{constructor(e){super(e.elements.map(t=>t.element)),this.data=e}}function YV(s){return s instanceof sD?new fWe(s):s}class gWe{constructor(e,t){this.modelProvider=e,this.dnd=t,this.autoExpandDisposable=te.None,this.disposables=new ce}getDragURI(e){return this.dnd.getDragURI(e.element)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e.map(i=>i.element),t)}onDragStart(e,t){var i,n;(n=(i=this.dnd).onDragStart)==null||n.call(i,YV(e),t)}onDragOver(e,t,i,n,r,o=!0){const a=this.dnd.onDragOver(YV(e),t&&t.element,i,n,r),l=this.autoExpandNode!==t;if(l&&(this.autoExpandDisposable.dispose(),this.autoExpandNode=t),typeof t>"u")return a;if(l&&typeof a!="boolean"&&a.autoExpand&&(this.autoExpandDisposable=$m(()=>{const g=this.modelProvider(),p=g.getNodeLocation(t);g.isCollapsed(p)&&g.setCollapsed(p,!1),this.autoExpandNode=void 0},500,this.disposables)),typeof a=="boolean"||!a.accept||typeof a.bubble>"u"||a.feedback){if(!o){const g=typeof a=="boolean"?a:a.accept,p=typeof a=="boolean"?void 0:a.effect;return{accept:g,effect:p,feedback:[i]}}return a}if(a.bubble===1){const g=this.modelProvider(),p=g.getNodeLocation(t),_=g.getParentNodeLocation(p),v=g.getNode(_),C=_&&g.getListIndex(_);return this.onDragOver(e,v,C,n,r,!1)}const c=this.modelProvider(),d=c.getNodeLocation(t),u=c.getListIndex(d),h=c.getListRenderCount(d);return{...a,feedback:Uo(u,u+h)}}drop(e,t,i,n,r){this.autoExpandDisposable.dispose(),this.autoExpandNode=void 0,this.dnd.drop(YV(e),t&&t.element,i,n,r)}onDragEnd(e){var t,i;(i=(t=this.dnd).onDragEnd)==null||i.call(t,e)}dispose(){this.disposables.dispose(),this.dnd.dispose()}}function pWe(s,e){return e&&{...e,identityProvider:e.identityProvider&&{getId(t){return e.identityProvider.getId(t.element)}},dnd:e.dnd&&new gWe(s,e.dnd),multipleSelectionController:e.multipleSelectionController&&{isSelectionSingleChangeEvent(t){return e.multipleSelectionController.isSelectionSingleChangeEvent({...t,element:t.element})},isSelectionRangeChangeEvent(t){return e.multipleSelectionController.isSelectionRangeChangeEvent({...t,element:t.element})}},accessibilityProvider:e.accessibilityProvider&&{...e.accessibilityProvider,getSetSize(t){const i=s(),n=i.getNodeLocation(t),r=i.getParentNodeLocation(n);return i.getNode(r).visibleChildrenCount},getPosInSet(t){return t.visibleChildIndex+1},isChecked:e.accessibilityProvider&&e.accessibilityProvider.isChecked?t=>e.accessibilityProvider.isChecked(t.element):void 0,getRole:e.accessibilityProvider&&e.accessibilityProvider.getRole?t=>e.accessibilityProvider.getRole(t.element):()=>"treeitem",getAriaLabel(t){return e.accessibilityProvider.getAriaLabel(t.element)},getWidgetAriaLabel(){return e.accessibilityProvider.getWidgetAriaLabel()},getWidgetRole:e.accessibilityProvider&&e.accessibilityProvider.getWidgetRole?()=>e.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:e.accessibilityProvider&&e.accessibilityProvider.getAriaLevel?t=>e.accessibilityProvider.getAriaLevel(t.element):t=>t.depth,getActiveDescendantId:e.accessibilityProvider.getActiveDescendantId&&(t=>e.accessibilityProvider.getActiveDescendantId(t.element))},keyboardNavigationLabelProvider:e.keyboardNavigationLabelProvider&&{...e.keyboardNavigationLabelProvider,getKeyboardNavigationLabel(t){return e.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t.element)}}}}class eG{constructor(e){this.delegate=e}getHeight(e){return this.delegate.getHeight(e.element)}getTemplateId(e){return this.delegate.getTemplateId(e.element)}hasDynamicHeight(e){return!!this.delegate.hasDynamicHeight&&this.delegate.hasDynamicHeight(e.element)}setDynamicHeight(e,t){var i,n;(n=(i=this.delegate).setDynamicHeight)==null||n.call(i,e.element,t)}}var D1;(function(s){s.None="none",s.OnHover="onHover",s.Always="always"})(D1||(D1={}));class mWe{get elements(){return this._elements}constructor(e,t=[]){this._elements=t,this.disposables=new ce,this.onDidChange=De.forEach(e,i=>this._elements=i,this.disposables)}dispose(){this.disposables.dispose()}}const yk=class yk{constructor(e,t,i,n,r,o={}){var a;this.renderer=e,this.modelProvider=t,this.activeNodes=n,this.renderedIndentGuides=r,this.renderedElements=new Map,this.renderedNodes=new Map,this.indent=yk.DefaultIndent,this.hideTwistiesOfChildlessElements=!1,this.shouldRenderIndentGuides=!1,this.activeIndentNodes=new Set,this.indentGuidesDisposable=te.None,this.disposables=new ce,this.templateId=e.templateId,this.updateOptions(o),De.map(i,l=>l.node)(this.onDidChangeNodeTwistieState,this,this.disposables),(a=e.onDidChangeTwistieState)==null||a.call(e,this.onDidChangeTwistieState,this,this.disposables)}updateOptions(e={}){if(typeof e.indent<"u"){const t=ho(e.indent,0,40);if(t!==this.indent){this.indent=t;for(const[i,n]of this.renderedNodes)this.renderTreeElement(i,n)}}if(typeof e.renderIndentGuides<"u"){const t=e.renderIndentGuides!==D1.None;if(t!==this.shouldRenderIndentGuides){this.shouldRenderIndentGuides=t;for(const[i,n]of this.renderedNodes)this._renderIndentGuides(i,n);if(this.indentGuidesDisposable.dispose(),t){const i=new ce;this.activeNodes.onDidChange(this._onDidChangeActiveNodes,this,i),this.indentGuidesDisposable=i,this._onDidChangeActiveNodes(this.activeNodes.elements)}}}typeof e.hideTwistiesOfChildlessElements<"u"&&(this.hideTwistiesOfChildlessElements=e.hideTwistiesOfChildlessElements)}renderTemplate(e){const t=me(e,ke(".monaco-tl-row")),i=me(t,ke(".monaco-tl-indent")),n=me(t,ke(".monaco-tl-twistie")),r=me(t,ke(".monaco-tl-contents")),o=this.renderer.renderTemplate(r);return{container:e,indent:i,twistie:n,indentGuidesDisposable:te.None,templateData:o}}renderElement(e,t,i,n){this.renderedNodes.set(e,i),this.renderedElements.set(e.element,e),this.renderTreeElement(e,i),this.renderer.renderElement(e,t,i.templateData,n)}disposeElement(e,t,i,n){var r,o;i.indentGuidesDisposable.dispose(),(o=(r=this.renderer).disposeElement)==null||o.call(r,e,t,i.templateData,n),typeof n=="number"&&(this.renderedNodes.delete(e),this.renderedElements.delete(e.element))}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}onDidChangeTwistieState(e){const t=this.renderedElements.get(e);t&&this.onDidChangeNodeTwistieState(t)}onDidChangeNodeTwistieState(e){const t=this.renderedNodes.get(e);t&&(this._onDidChangeActiveNodes(this.activeNodes.elements),this.renderTreeElement(e,t))}renderTreeElement(e,t){const i=yk.DefaultIndent+(e.depth-1)*this.indent;t.twistie.style.paddingLeft=`${i}px`,t.indent.style.width=`${i+this.indent-16}px`,e.collapsible?t.container.setAttribute("aria-expanded",String(!e.collapsed)):t.container.removeAttribute("aria-expanded"),t.twistie.classList.remove(...at.asClassNameArray(xe.treeItemExpanded));let n=!1;this.renderer.renderTwistie&&(n=this.renderer.renderTwistie(e.element,t.twistie)),e.collapsible&&(!this.hideTwistiesOfChildlessElements||e.visibleChildrenCount>0)?(n||t.twistie.classList.add(...at.asClassNameArray(xe.treeItemExpanded)),t.twistie.classList.add("collapsible"),t.twistie.classList.toggle("collapsed",e.collapsed)):t.twistie.classList.remove("collapsible","collapsed"),this._renderIndentGuides(e,t)}_renderIndentGuides(e,t){if(Ys(t.indent),t.indentGuidesDisposable.dispose(),!this.shouldRenderIndentGuides)return;const i=new ce,n=this.modelProvider();for(;;){const r=n.getNodeLocation(e),o=n.getParentNodeLocation(r);if(!o)break;const a=n.getNode(o),l=ke(".indent-guide",{style:`width: ${this.indent}px`});this.activeIndentNodes.has(a)&&l.classList.add("active"),t.indent.childElementCount===0?t.indent.appendChild(l):t.indent.insertBefore(l,t.indent.firstElementChild),this.renderedIndentGuides.add(a,l),i.add(Ye(()=>this.renderedIndentGuides.delete(a,l))),e=a}t.indentGuidesDisposable=i}_onDidChangeActiveNodes(e){if(!this.shouldRenderIndentGuides)return;const t=new Set,i=this.modelProvider();e.forEach(n=>{const r=i.getNodeLocation(n);try{const o=i.getParentNodeLocation(r);n.collapsible&&n.children.length>0&&!n.collapsed?t.add(n):o&&t.add(i.getNode(o))}catch{}}),this.activeIndentNodes.forEach(n=>{t.has(n)||this.renderedIndentGuides.forEach(n,r=>r.classList.remove("active"))}),t.forEach(n=>{this.activeIndentNodes.has(n)||this.renderedIndentGuides.forEach(n,r=>r.classList.add("active"))}),this.activeIndentNodes=t}dispose(){this.renderedNodes.clear(),this.renderedElements.clear(),this.indentGuidesDisposable.dispose(),Ni(this.disposables)}};yk.DefaultIndent=8;let z8=yk;class _We{get totalCount(){return this._totalCount}get matchCount(){return this._matchCount}constructor(e,t,i){this.tree=e,this.keyboardNavigationLabelProvider=t,this._filter=i,this._totalCount=0,this._matchCount=0,this._pattern="",this._lowercasePattern="",this.disposables=new ce,e.onWillRefilter(this.reset,this,this.disposables)}filter(e,t){let i=1;if(this._filter){const o=this._filter.filter(e,t);if(typeof o=="boolean"?i=o?1:0:JK(o)?i=NI(o.visibility):i=o,i===0)return!1}if(this._totalCount++,!this._pattern)return this._matchCount++,{data:ou.Default,visibility:i};const n=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e),r=Array.isArray(n)?n:[n];for(const o of r){const a=o&&o.toString();if(typeof a>"u")return{data:ou.Default,visibility:i};let l;if(this.tree.findMatchType===ww.Contiguous){const c=a.toLowerCase().indexOf(this._lowercasePattern);if(c>-1){l=[Number.MAX_SAFE_INTEGER,0];for(let d=this._lowercasePattern.length;d>0;d--)l.push(c+d-1)}}else l=mw(this._pattern,this._lowercasePattern,0,a,a.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0});if(l)return this._matchCount++,r.length===1?{data:l,visibility:i}:{data:{label:a,score:l},visibility:i}}return this.tree.findMode===Yf.Filter?typeof this.tree.options.defaultFindVisibility=="number"?this.tree.options.defaultFindVisibility:this.tree.options.defaultFindVisibility?this.tree.options.defaultFindVisibility(e):2:{data:ou.Default,visibility:i}}reset(){this._totalCount=0,this._matchCount=0}dispose(){Ni(this.disposables)}}var Yf;(function(s){s[s.Highlight=0]="Highlight",s[s.Filter=1]="Filter"})(Yf||(Yf={}));var ww;(function(s){s[s.Fuzzy=0]="Fuzzy",s[s.Contiguous=1]="Contiguous"})(ww||(ww={}));let bWe=class{get pattern(){return this._pattern}get mode(){return this._mode}set mode(e){e!==this._mode&&(this._mode=e,this.widget&&(this.widget.mode=this._mode),this.tree.refilter(),this.render(),this._onDidChangeMode.fire(e))}get matchType(){return this._matchType}set matchType(e){e!==this._matchType&&(this._matchType=e,this.widget&&(this.widget.matchType=this._matchType),this.tree.refilter(),this.render(),this._onDidChangeMatchType.fire(e))}constructor(e,t,i,n,r,o={}){this.tree=e,this.view=i,this.filter=n,this.contextViewProvider=r,this.options=o,this._pattern="",this.width=0,this._onDidChangeMode=new Z,this.onDidChangeMode=this._onDidChangeMode.event,this._onDidChangeMatchType=new Z,this.onDidChangeMatchType=this._onDidChangeMatchType.event,this._onDidChangePattern=new Z,this._onDidChangeOpenState=new Z,this.onDidChangeOpenState=this._onDidChangeOpenState.event,this.enabledDisposables=new ce,this.disposables=new ce,this._mode=e.options.defaultFindMode??Yf.Highlight,this._matchType=e.options.defaultFindMatchType??ww.Fuzzy,t.onDidSplice(this.onDidSpliceModel,this,this.disposables)}updateOptions(e={}){e.defaultFindMode!==void 0&&(this.mode=e.defaultFindMode),e.defaultFindMatchType!==void 0&&(this.matchType=e.defaultFindMatchType)}onDidSpliceModel(){!this.widget||this.pattern.length===0||(this.tree.refilter(),this.render())}render(){var t,i,n;const e=this.filter.totalCount>0&&this.filter.matchCount===0;this.pattern&&e?(Eo(b("replFindNoResults","No results")),this.tree.options.showNotFoundMessage??!0?(t=this.widget)==null||t.showMessage({type:2,content:b("not found","No elements found.")}):(i=this.widget)==null||i.showMessage({type:2})):((n=this.widget)==null||n.clearMessage(),this.pattern&&Eo(b("replFindResults","{0} results",this.filter.matchCount)))}shouldAllowFocus(e){return!this.widget||!this.pattern||this.filter.totalCount>0&&this.filter.matchCount<=1?!0:!ou.isDefault(e.filterData)}layout(e){var t;this.width=e,(t=this.widget)==null||t.layout(e)}dispose(){this._history=void 0,this._onDidChangePattern.dispose(),this.enabledDisposables.dispose(),this.disposables.dispose()}};function vWe(s,e){return s.position===e.position&&ipe(s,e)}function ipe(s,e){return s.node.element===e.node.element&&s.startIndex===e.startIndex&&s.height===e.height&&s.endIndex===e.endIndex}class wWe{constructor(e=[]){this.stickyNodes=e}get count(){return this.stickyNodes.length}equal(e){return dn(this.stickyNodes,e.stickyNodes,vWe)}lastNodePartiallyVisible(){if(this.count===0)return!1;const e=this.stickyNodes[this.count-1];if(this.count===1)return e.position!==0;const t=this.stickyNodes[this.count-2];return t.position+t.height!==e.position}animationStateChanged(e){if(!dn(this.stickyNodes,e.stickyNodes,ipe)||this.count===0)return!1;const t=this.stickyNodes[this.count-1],i=e.stickyNodes[e.count-1];return t.position!==i.position}}class CWe{constrainStickyScrollNodes(e,t,i){for(let n=0;n<e.length;n++){const r=e[n];if(r.position+r.height>i||n>=t)return e.slice(0,n)}return e}}let jne=class extends te{constructor(e,t,i,n,r,o={}){super(),this.tree=e,this.model=t,this.view=i,this.treeDelegate=r,this.maxWidgetViewRatio=.4;const a=this.validateStickySettings(o);this.stickyScrollMaxItemCount=a.stickyScrollMaxItemCount,this.stickyScrollDelegate=o.stickyScrollDelegate??new CWe,this._widget=this._register(new yWe(i.getScrollableElement(),i,e,n,r,o.accessibilityProvider)),this.onDidChangeHasFocus=this._widget.onDidChangeHasFocus,this.onContextMenu=this._widget.onContextMenu,this._register(i.onDidScroll(()=>this.update())),this._register(i.onDidChangeContentHeight(()=>this.update())),this._register(e.onDidChangeCollapseState(()=>this.update())),this.update()}get height(){return this._widget.height}getNodeAtHeight(e){let t;if(e===0?t=this.view.firstVisibleIndex:t=this.view.indexAt(e+this.view.scrollTop),!(t<0||t>=this.view.length))return this.view.element(t)}update(){const e=this.getNodeAtHeight(0);if(!e||this.tree.scrollTop===0){this._widget.setState(void 0);return}const t=this.findStickyState(e);this._widget.setState(t)}findStickyState(e){const t=[];let i=e,n=0,r=this.getNextStickyNode(i,void 0,n);for(;r&&(t.push(r),n+=r.height,!(t.length<=this.stickyScrollMaxItemCount&&(i=this.getNextVisibleNode(r),!i)));)r=this.getNextStickyNode(i,r.node,n);const o=this.constrainStickyNodes(t);return o.length?new wWe(o):void 0}getNextVisibleNode(e){return this.getNodeAtHeight(e.position+e.height)}getNextStickyNode(e,t,i){const n=this.getAncestorUnderPrevious(e,t);if(n&&!(n===e&&(!this.nodeIsUncollapsedParent(e)||this.nodeTopAlignsWithStickyNodesBottom(e,i))))return this.createStickyScrollNode(n,i)}nodeTopAlignsWithStickyNodesBottom(e,t){const i=this.getNodeIndex(e),n=this.view.getElementTop(i),r=t;return this.view.scrollTop===n-r}createStickyScrollNode(e,t){const i=this.treeDelegate.getHeight(e),{startIndex:n,endIndex:r}=this.getNodeRange(e),o=this.calculateStickyNodePosition(r,t,i);return{node:e,position:o,height:i,startIndex:n,endIndex:r}}getAncestorUnderPrevious(e,t=void 0){let i=e,n=this.getParentNode(i);for(;n;){if(n===t)return i;i=n,n=this.getParentNode(i)}if(t===void 0)return i}calculateStickyNodePosition(e,t,i){let n=this.view.getRelativeTop(e);if(n===null&&this.view.firstVisibleIndex===e&&e+1<this.view.length){const c=this.treeDelegate.getHeight(this.view.element(e)),d=this.view.getRelativeTop(e+1);n=d?d-c/this.view.renderHeight:null}if(n===null)return t;const r=this.view.element(e),o=this.treeDelegate.getHeight(r),l=n*this.view.renderHeight+o;return t+i>l&&t<=l?l-i:t}constrainStickyNodes(e){if(e.length===0)return[];const t=this.view.renderHeight*this.maxWidgetViewRatio,i=e[e.length-1];if(e.length<=this.stickyScrollMaxItemCount&&i.position+i.height<=t)return e;const n=this.stickyScrollDelegate.constrainStickyScrollNodes(e,this.stickyScrollMaxItemCount,t);if(!n.length)return[];const r=n[n.length-1];if(n.length>this.stickyScrollMaxItemCount||r.position+r.height>t)throw new Error("stickyScrollDelegate violates constraints");return n}getParentNode(e){const t=this.model.getNodeLocation(e),i=this.model.getParentNodeLocation(t);return i?this.model.getNode(i):void 0}nodeIsUncollapsedParent(e){const t=this.model.getNodeLocation(e);return this.model.getListRenderCount(t)>1}getNodeIndex(e){const t=this.model.getNodeLocation(e);return this.model.getListIndex(t)}getNodeRange(e){const t=this.model.getNodeLocation(e),i=this.model.getListIndex(t);if(i<0)throw new Error("Node not found in tree");const n=this.model.getListRenderCount(t),r=i+n-1;return{startIndex:i,endIndex:r}}nodePositionTopBelowWidget(e){const t=[];let i=this.getParentNode(e);for(;i;)t.push(i),i=this.getParentNode(i);let n=0;for(let r=0;r<t.length&&r<this.stickyScrollMaxItemCount;r++)n+=this.treeDelegate.getHeight(t[r]);return n}domFocus(){this._widget.domFocus()}focusedLast(){return this._widget.focusedLast()}updateOptions(e={}){if(!e.stickyScrollMaxItemCount)return;const t=this.validateStickySettings(e);this.stickyScrollMaxItemCount!==t.stickyScrollMaxItemCount&&(this.stickyScrollMaxItemCount=t.stickyScrollMaxItemCount,this.update())}validateStickySettings(e){let t=7;return typeof e.stickyScrollMaxItemCount=="number"&&(t=Math.max(e.stickyScrollMaxItemCount,1)),{stickyScrollMaxItemCount:t}}},yWe=class{constructor(e,t,i,n,r,o){this.view=t,this.tree=i,this.treeRenderers=n,this.treeDelegate=r,this.accessibilityProvider=o,this._previousElements=[],this._previousStateDisposables=new ce,this._rootDomNode=ke(".monaco-tree-sticky-container.empty"),e.appendChild(this._rootDomNode);const a=ke(".monaco-tree-sticky-container-shadow");this._rootDomNode.appendChild(a),this.stickyScrollFocus=new SWe(this._rootDomNode,t),this.onDidChangeHasFocus=this.stickyScrollFocus.onDidChangeHasFocus,this.onContextMenu=this.stickyScrollFocus.onContextMenu}get height(){if(!this._previousState)return 0;const e=this._previousState.stickyNodes[this._previousState.count-1];return e.position+e.height}setState(e){const t=!!this._previousState&&this._previousState.count>0,i=!!e&&e.count>0;if(!t&&!i||t&&i&&this._previousState.equal(e))return;if(t!==i&&this.setVisible(i),!i){this._previousState=void 0,this._previousElements=[],this._previousStateDisposables.clear();return}const n=e.stickyNodes[e.count-1];if(this._previousState&&e.animationStateChanged(this._previousState))this._previousElements[this._previousState.count-1].style.top=`${n.position}px`;else{this._previousStateDisposables.clear();const r=Array(e.count);for(let o=e.count-1;o>=0;o--){const a=e.stickyNodes[o],{element:l,disposable:c}=this.createElement(a,o,e.count);r[o]=l,this._rootDomNode.appendChild(l),this._previousStateDisposables.add(c)}this.stickyScrollFocus.updateElements(r,e),this._previousElements=r}this._previousState=e,this._rootDomNode.style.height=`${n.position+n.height}px`}createElement(e,t,i){const n=e.startIndex,r=document.createElement("div");r.style.top=`${e.position}px`,this.tree.options.setRowHeight!==!1&&(r.style.height=`${e.height}px`),this.tree.options.setRowLineHeight!==!1&&(r.style.lineHeight=`${e.height}px`),r.classList.add("monaco-tree-sticky-row"),r.classList.add("monaco-list-row"),r.setAttribute("data-index",`${n}`),r.setAttribute("data-parity",n%2===0?"even":"odd"),r.setAttribute("id",this.view.getElementID(n));const o=this.setAccessibilityAttributes(r,e.node.element,t,i),a=this.treeDelegate.getTemplateId(e.node),l=this.treeRenderers.find(h=>h.templateId===a);if(!l)throw new Error(`No renderer found for template id ${a}`);let c=e.node;c===this.tree.getNode(this.tree.getNodeLocation(e.node))&&(c=new Proxy(e.node,{}));const d=l.renderTemplate(r);l.renderElement(c,e.startIndex,d,e.height);const u=Ye(()=>{o.dispose(),l.disposeElement(c,e.startIndex,d,e.height),l.disposeTemplate(d),r.remove()});return{element:r,disposable:u}}setAccessibilityAttributes(e,t,i,n){if(!this.accessibilityProvider)return te.None;this.accessibilityProvider.getSetSize&&e.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(t,i,n))),this.accessibilityProvider.getPosInSet&&e.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(t,i))),this.accessibilityProvider.getRole&&e.setAttribute("role",this.accessibilityProvider.getRole(t)??"treeitem");const r=this.accessibilityProvider.getAriaLabel(t),o=r&&typeof r!="string"?r:hc(r),a=ht(c=>{const d=c.readObservable(o);d?e.setAttribute("aria-label",d):e.removeAttribute("aria-label")});typeof r=="string"||r&&e.setAttribute("aria-label",r.get());const l=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(t);return typeof l=="number"&&e.setAttribute("aria-level",`${l}`),e.setAttribute("aria-selected",String(!1)),a}setVisible(e){this._rootDomNode.classList.toggle("empty",!e),e||this.stickyScrollFocus.updateElements([],void 0)}domFocus(){this.stickyScrollFocus.domFocus()}focusedLast(){return this.stickyScrollFocus.focusedLast()}dispose(){this.stickyScrollFocus.dispose(),this._previousStateDisposables.dispose(),this._rootDomNode.remove()}};class SWe extends te{get domHasFocus(){return this._domHasFocus}set domHasFocus(e){e!==this._domHasFocus&&(this._onDidChangeHasFocus.fire(e),this._domHasFocus=e)}constructor(e,t){super(),this.container=e,this.view=t,this.focusedIndex=-1,this.elements=[],this._onDidChangeHasFocus=new Z,this.onDidChangeHasFocus=this._onDidChangeHasFocus.event,this._onContextMenu=new Z,this.onContextMenu=this._onContextMenu.event,this._domHasFocus=!1,this._register(oe(this.container,"focus",()=>this.onFocus())),this._register(oe(this.container,"blur",()=>this.onBlur())),this._register(this.view.onDidFocus(()=>this.toggleStickyScrollFocused(!1))),this._register(this.view.onKeyDown(i=>this.onKeyDown(i))),this._register(this.view.onMouseDown(i=>this.onMouseDown(i))),this._register(this.view.onContextMenu(i=>this.handleContextMenu(i)))}handleContextMenu(e){const t=e.browserEvent.target;if(!LI(t)&&!OL(t)){this.focusedLast()&&this.view.domFocus();return}if(!Df(e.browserEvent)){if(!this.state)throw new Error("Context menu should not be triggered when state is undefined");const o=this.state.stickyNodes.findIndex(a=>{var l;return a.node.element===((l=e.element)==null?void 0:l.element)});if(o===-1)throw new Error("Context menu should not be triggered when element is not in sticky scroll widget");this.container.focus(),this.setFocus(o);return}if(!this.state||this.focusedIndex<0)throw new Error("Context menu key should not be triggered when focus is not in sticky scroll widget");const n=this.state.stickyNodes[this.focusedIndex].node.element,r=this.elements[this.focusedIndex];this._onContextMenu.fire({element:n,anchor:r,browserEvent:e.browserEvent,isStickyScroll:!0})}onKeyDown(e){if(this.domHasFocus&&this.state){if(e.key==="ArrowUp")this.setFocusedElement(Math.max(0,this.focusedIndex-1)),e.preventDefault(),e.stopPropagation();else if(e.key==="ArrowDown"||e.key==="ArrowRight"){if(this.focusedIndex>=this.state.count-1){const t=this.state.stickyNodes[this.state.count-1].startIndex+1;this.view.domFocus(),this.view.setFocus([t]),this.scrollNodeUnderWidget(t,this.state)}else this.setFocusedElement(this.focusedIndex+1);e.preventDefault(),e.stopPropagation()}}}onMouseDown(e){const t=e.browserEvent.target;!LI(t)&&!OL(t)||(e.browserEvent.preventDefault(),e.browserEvent.stopPropagation())}updateElements(e,t){if(t&&t.count===0)throw new Error("Sticky scroll state must be undefined when there are no sticky nodes");if(t&&t.count!==e.length)throw new Error("Sticky scroll focus received illigel state");const i=this.focusedIndex;if(this.removeFocus(),this.elements=e,this.state=t,t){const n=ho(i,0,t.count-1);this.setFocus(n)}else this.domHasFocus&&this.view.domFocus();this.container.tabIndex=t?0:-1}setFocusedElement(e){const t=this.state;if(!t)throw new Error("Cannot set focus when state is undefined");if(this.setFocus(e),!(e<t.count-1)&&t.lastNodePartiallyVisible()){const i=t.stickyNodes[e];this.scrollNodeUnderWidget(i.endIndex+1,t)}}scrollNodeUnderWidget(e,t){const i=t.stickyNodes[t.count-1],n=t.count>1?t.stickyNodes[t.count-2]:void 0,r=this.view.getElementTop(e),o=n?n.position+n.height+i.height:i.height;this.view.scrollTop=r-o}domFocus(){if(!this.state)throw new Error("Cannot focus when state is undefined");this.container.focus()}focusedLast(){return this.state?this.view.getHTMLElement().classList.contains("sticky-scroll-focused"):!1}removeFocus(){this.focusedIndex!==-1&&(this.toggleElementFocus(this.elements[this.focusedIndex],!1),this.focusedIndex=-1)}setFocus(e){if(0>e)throw new Error("addFocus() can not remove focus");if(!this.state&&e>=0)throw new Error("Cannot set focus index when state is undefined");if(this.state&&e>=this.state.count)throw new Error("Cannot set focus index to an index that does not exist");const t=this.focusedIndex;t>=0&&this.toggleElementFocus(this.elements[t],!1),e>=0&&this.toggleElementFocus(this.elements[e],!0),this.focusedIndex=e}toggleElementFocus(e,t){this.toggleElementActiveFocus(e,t&&this.domHasFocus),this.toggleElementPassiveFocus(e,t)}toggleCurrentElementActiveFocus(e){this.focusedIndex!==-1&&this.toggleElementActiveFocus(this.elements[this.focusedIndex],e)}toggleElementActiveFocus(e,t){e.classList.toggle("focused",t)}toggleElementPassiveFocus(e,t){e.classList.toggle("passive-focused",t)}toggleStickyScrollFocused(e){this.view.getHTMLElement().classList.toggle("sticky-scroll-focused",e)}onFocus(){if(!this.state||this.elements.length===0)throw new Error("Cannot focus when state is undefined or elements are empty");this.domHasFocus=!0,this.toggleStickyScrollFocused(!0),this.toggleCurrentElementActiveFocus(!0),this.focusedIndex===-1&&this.setFocus(0)}onBlur(){this.domHasFocus=!1,this.toggleCurrentElementActiveFocus(!1)}dispose(){this.toggleStickyScrollFocused(!1),this._onDidChangeHasFocus.fire(!1),super.dispose()}}function LN(s){let e=Hb.Unknown;return sV(s.browserEvent.target,"monaco-tl-twistie","monaco-tl-row")?e=Hb.Twistie:sV(s.browserEvent.target,"monaco-tl-contents","monaco-tl-row")?e=Hb.Element:sV(s.browserEvent.target,"monaco-tree-type-filter","monaco-list")&&(e=Hb.Filter),{browserEvent:s.browserEvent,element:s.element?s.element.element:null,target:e}}function xWe(s){const e=LI(s.browserEvent.target);return{element:s.element?s.element.element:null,browserEvent:s.browserEvent,anchor:s.anchor,isStickyScroll:e}}function FR(s,e){e(s),s.children.forEach(t=>FR(t,e))}class XV{get nodeSet(){return this._nodeSet||(this._nodeSet=this.createNodeSet()),this._nodeSet}constructor(e,t){this.getFirstViewElementWithTrait=e,this.identityProvider=t,this.nodes=[],this._onDidChange=new Z,this.onDidChange=this._onDidChange.event}set(e,t){!(t!=null&&t.__forceEvent)&&dn(this.nodes,e)||this._set(e,!1,t)}_set(e,t,i){if(this.nodes=[...e],this.elements=void 0,this._nodeSet=void 0,!t){const n=this;this._onDidChange.fire({get elements(){return n.get()},browserEvent:i})}}get(){return this.elements||(this.elements=this.nodes.map(e=>e.element)),[...this.elements]}getNodes(){return this.nodes}has(e){return this.nodeSet.has(e)}onDidModelSplice({insertedNodes:e,deletedNodes:t}){if(!this.identityProvider){const l=this.createNodeSet(),c=d=>l.delete(d);t.forEach(d=>FR(d,c)),this.set([...l.values()]);return}const i=new Set,n=l=>i.add(this.identityProvider.getId(l.element).toString());t.forEach(l=>FR(l,n));const r=new Map,o=l=>r.set(this.identityProvider.getId(l.element).toString(),l);e.forEach(l=>FR(l,o));const a=[];for(const l of this.nodes){const c=this.identityProvider.getId(l.element).toString();if(!i.has(c))a.push(l);else{const u=r.get(c);u&&u.visible&&a.push(u)}}if(this.nodes.length>0&&a.length===0){const l=this.getFirstViewElementWithTrait();l&&a.push(l)}this._set(a,!0)}createNodeSet(){const e=new Set;for(const t of this.nodes)e.add(t);return e}}class LWe extends oge{constructor(e,t,i){super(e),this.tree=t,this.stickyScrollProvider=i}onViewPointer(e){if(ige(e.browserEvent.target)||hm(e.browserEvent.target)||sL(e.browserEvent.target)||e.browserEvent.isHandledByList)return;const t=e.element;if(!t)return super.onViewPointer(e);if(this.isSelectionRangeChangeEvent(e)||this.isSelectionSingleChangeEvent(e))return super.onViewPointer(e);const i=e.browserEvent.target,n=i.classList.contains("monaco-tl-twistie")||i.classList.contains("monaco-icon-label")&&i.classList.contains("folder-icon")&&e.browserEvent.offsetX<16,r=OL(e.browserEvent.target);let o=!1;if(r?o=!0:typeof this.tree.expandOnlyOnTwistieClick=="function"?o=this.tree.expandOnlyOnTwistieClick(t.element):o=!!this.tree.expandOnlyOnTwistieClick,r)this.handleStickyScrollMouseEvent(e,t);else{if(o&&!n&&e.browserEvent.detail!==2)return super.onViewPointer(e);if(!this.tree.expandOnDoubleClick&&e.browserEvent.detail===2)return super.onViewPointer(e)}if(t.collapsible&&(!r||n)){const a=this.tree.getNodeLocation(t),l=e.browserEvent.altKey;if(this.tree.setFocus([a]),this.tree.toggleCollapsed(a,l),n){e.browserEvent.isHandledByList=!0;return}}r||super.onViewPointer(e)}handleStickyScrollMouseEvent(e,t){if(T9e(e.browserEvent.target)||N9e(e.browserEvent.target))return;const i=this.stickyScrollProvider();if(!i)throw new Error("Sticky scroll controller not found");const n=this.list.indexOf(t),r=this.list.getElementTop(n),o=i.nodePositionTopBelowWidget(t);this.tree.scrollTop=r-o,this.list.domFocus(),this.list.setFocus([n]),this.list.setSelection([n])}onDoubleClick(e){e.browserEvent.target.classList.contains("monaco-tl-twistie")||!this.tree.expandOnDoubleClick||e.browserEvent.isHandledByList||super.onDoubleClick(e)}onMouseDown(e){const t=e.browserEvent.target;if(!LI(t)&&!OL(t)){super.onMouseDown(e);return}}onContextMenu(e){const t=e.browserEvent.target;if(!LI(t)&&!OL(t)){super.onContextMenu(e);return}}}class kWe extends Bl{constructor(e,t,i,n,r,o,a,l){super(e,t,i,n,l),this.focusTrait=r,this.selectionTrait=o,this.anchorTrait=a}createMouseController(e){return new LWe(this,e.tree,e.stickyScrollProvider)}splice(e,t,i=[]){if(super.splice(e,t,i),i.length===0)return;const n=[],r=[];let o;i.forEach((a,l)=>{this.focusTrait.has(a)&&n.push(e+l),this.selectionTrait.has(a)&&r.push(e+l),this.anchorTrait.has(a)&&(o=e+l)}),n.length>0&&super.setFocus(wg([...super.getFocus(),...n])),r.length>0&&super.setSelection(wg([...super.getSelection(),...r])),typeof o=="number"&&super.setAnchor(o)}setFocus(e,t,i=!1){super.setFocus(e,t),i||this.focusTrait.set(e.map(n=>this.element(n)),t)}setSelection(e,t,i=!1){super.setSelection(e,t),i||this.selectionTrait.set(e.map(n=>this.element(n)),t)}setAnchor(e,t=!1){super.setAnchor(e),t||(typeof e>"u"?this.anchorTrait.set([]):this.anchorTrait.set([this.element(e)]))}}class npe{get onDidScroll(){return this.view.onDidScroll}get onDidChangeFocus(){return this.eventBufferer.wrapEvent(this.focus.onDidChange)}get onDidChangeSelection(){return this.eventBufferer.wrapEvent(this.selection.onDidChange)}get onMouseDblClick(){return De.filter(De.map(this.view.onMouseDblClick,LN),e=>e.target!==Hb.Filter)}get onMouseOver(){return De.map(this.view.onMouseOver,LN)}get onMouseOut(){return De.map(this.view.onMouseOut,LN)}get onContextMenu(){var e;return De.any(De.filter(De.map(this.view.onContextMenu,xWe),t=>!t.isStickyScroll),((e=this.stickyScrollController)==null?void 0:e.onContextMenu)??De.None)}get onPointer(){return De.map(this.view.onPointer,LN)}get onKeyDown(){return this.view.onKeyDown}get onDidFocus(){return this.view.onDidFocus}get onDidChangeModel(){return De.signal(this.model.onDidSplice)}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get findMode(){var e;return((e=this.findController)==null?void 0:e.mode)??Yf.Highlight}set findMode(e){this.findController&&(this.findController.mode=e)}get findMatchType(){var e;return((e=this.findController)==null?void 0:e.matchType)??ww.Fuzzy}set findMatchType(e){this.findController&&(this.findController.matchType=e)}get expandOnDoubleClick(){return typeof this._options.expandOnDoubleClick>"u"?!0:this._options.expandOnDoubleClick}get expandOnlyOnTwistieClick(){return typeof this._options.expandOnlyOnTwistieClick>"u"?!0:this._options.expandOnlyOnTwistieClick}get onDidDispose(){return this.view.onDidDispose}constructor(e,t,i,n,r={}){this._user=e,this._options=r,this.eventBufferer=new BE,this.onDidChangeFindOpenState=De.None,this.onDidChangeStickyScrollFocused=De.None,this.disposables=new ce,this._onWillRefilter=new Z,this.onWillRefilter=this._onWillRefilter.event,this._onDidUpdateOptions=new Z,this.treeDelegate=new eG(i);const o=new Kee,a=new Kee,l=this.disposables.add(new mWe(a.event)),c=new Gq;this.renderers=n.map(p=>new z8(p,()=>this.model,o.event,l,c,r));for(const p of this.renderers)this.disposables.add(p);let d;r.keyboardNavigationLabelProvider&&(d=new _We(this,r.keyboardNavigationLabelProvider,r.filter),r={...r,filter:d},this.disposables.add(d)),this.focus=new XV(()=>this.view.getFocusedElements()[0],r.identityProvider),this.selection=new XV(()=>this.view.getSelectedElements()[0],r.identityProvider),this.anchor=new XV(()=>this.view.getAnchorElement(),r.identityProvider),this.view=new kWe(e,t,this.treeDelegate,this.renderers,this.focus,this.selection,this.anchor,{...pWe(()=>this.model,r),tree:this,stickyScrollProvider:()=>this.stickyScrollController}),this.model=this.createModel(e,this.view,r),o.input=this.model.onDidChangeCollapseState;const u=De.forEach(this.model.onDidSplice,p=>{this.eventBufferer.bufferEvents(()=>{this.focus.onDidModelSplice(p),this.selection.onDidModelSplice(p)})},this.disposables);u(()=>null,null,this.disposables);const h=this.disposables.add(new Z),g=this.disposables.add(new bc(0));if(this.disposables.add(De.any(u,this.focus.onDidChange,this.selection.onDidChange)(()=>{g.trigger(()=>{const p=new Set;for(const _ of this.focus.getNodes())p.add(_);for(const _ of this.selection.getNodes())p.add(_);h.fire([...p.values()])})})),a.input=h.event,r.keyboardSupport!==!1){const p=De.chain(this.view.onKeyDown,_=>_.filter(v=>!hm(v.target)).map(v=>new Mi(v)));De.chain(p,_=>_.filter(v=>v.keyCode===15))(this.onLeftArrow,this,this.disposables),De.chain(p,_=>_.filter(v=>v.keyCode===17))(this.onRightArrow,this,this.disposables),De.chain(p,_=>_.filter(v=>v.keyCode===10))(this.onSpace,this,this.disposables)}if((r.findWidgetEnabled??!0)&&r.keyboardNavigationLabelProvider&&r.contextViewProvider){const p=this.options.findWidgetStyles?{styles:this.options.findWidgetStyles}:void 0;this.findController=new bWe(this,this.model,this.view,d,r.contextViewProvider,p),this.focusNavigationFilter=_=>this.findController.shouldAllowFocus(_),this.onDidChangeFindOpenState=this.findController.onDidChangeOpenState,this.disposables.add(this.findController),this.onDidChangeFindMode=this.findController.onDidChangeMode,this.onDidChangeFindMatchType=this.findController.onDidChangeMatchType}else this.onDidChangeFindMode=De.None,this.onDidChangeFindMatchType=De.None;r.enableStickyScroll&&(this.stickyScrollController=new jne(this,this.model,this.view,this.renderers,this.treeDelegate,r),this.onDidChangeStickyScrollFocused=this.stickyScrollController.onDidChangeHasFocus),this.styleElement=Rl(this.view.getHTMLElement()),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides===D1.Always)}updateOptions(e={}){var t;this._options={...this._options,...e};for(const i of this.renderers)i.updateOptions(e);this.view.updateOptions(this._options),(t=this.findController)==null||t.updateOptions(e),this.updateStickyScroll(e),this._onDidUpdateOptions.fire(this._options),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides===D1.Always)}get options(){return this._options}updateStickyScroll(e){var t;!this.stickyScrollController&&this._options.enableStickyScroll?(this.stickyScrollController=new jne(this,this.model,this.view,this.renderers,this.treeDelegate,this._options),this.onDidChangeStickyScrollFocused=this.stickyScrollController.onDidChangeHasFocus):this.stickyScrollController&&!this._options.enableStickyScroll&&(this.onDidChangeStickyScrollFocused=De.None,this.stickyScrollController.dispose(),this.stickyScrollController=void 0),(t=this.stickyScrollController)==null||t.updateOptions(e)}getHTMLElement(){return this.view.getHTMLElement()}get scrollTop(){return this.view.scrollTop}set scrollTop(e){this.view.scrollTop=e}get scrollHeight(){return this.view.scrollHeight}get renderHeight(){return this.view.renderHeight}get ariaLabel(){return this.view.ariaLabel}set ariaLabel(e){this.view.ariaLabel=e}domFocus(){var e;(e=this.stickyScrollController)!=null&&e.focusedLast()?this.stickyScrollController.domFocus():this.view.domFocus()}layout(e,t){var i;this.view.layout(e,t),Vm(t)&&((i=this.findController)==null||i.layout(t))}style(e){const t=`.${this.view.domId}`,i=[];e.treeIndentGuidesStroke&&(i.push(`.monaco-list${t}:hover .monaco-tl-indent > .indent-guide, .monaco-list${t}.always .monaco-tl-indent > .indent-guide  { border-color: ${e.treeInactiveIndentGuidesStroke}; }`),i.push(`.monaco-list${t} .monaco-tl-indent > .indent-guide.active { border-color: ${e.treeIndentGuidesStroke}; }`));const n=e.treeStickyScrollBackground??e.listBackground;n&&(i.push(`.monaco-list${t} .monaco-scrollable-element .monaco-tree-sticky-container { background-color: ${n}; }`),i.push(`.monaco-list${t} .monaco-scrollable-element .monaco-tree-sticky-container .monaco-tree-sticky-row { background-color: ${n}; }`)),e.treeStickyScrollBorder&&i.push(`.monaco-list${t} .monaco-scrollable-element .monaco-tree-sticky-container { border-bottom: 1px solid ${e.treeStickyScrollBorder}; }`),e.treeStickyScrollShadow&&i.push(`.monaco-list${t} .monaco-scrollable-element .monaco-tree-sticky-container .monaco-tree-sticky-container-shadow { box-shadow: ${e.treeStickyScrollShadow} 0 6px 6px -6px inset; height: 3px; }`),e.listFocusForeground&&(i.push(`.monaco-list${t}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused { color: ${e.listFocusForeground}; }`),i.push(`.monaco-list${t}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused { color: inherit; }`));const r=lg(e.listFocusAndSelectionOutline,lg(e.listSelectionOutline,e.listFocusOutline??""));r&&(i.push(`.monaco-list${t}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused.selected { outline: 1px solid ${r}; outline-offset: -1px;}`),i.push(`.monaco-list${t}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused.selected { outline: inherit;}`)),e.listFocusOutline&&(i.push(`.monaco-list${t}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }`),i.push(`.monaco-list${t}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused { outline: inherit; }`),i.push(`.monaco-workbench.context-menu-visible .monaco-list${t}.last-focused.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.passive-focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }`),i.push(`.monaco-workbench.context-menu-visible .monaco-list${t}.last-focused.sticky-scroll-focused .monaco-list-rows .monaco-list-row.focused { outline: inherit; }`),i.push(`.monaco-workbench.context-menu-visible .monaco-list${t}.last-focused:not(.sticky-scroll-focused) .monaco-tree-sticky-container .monaco-list-rows .monaco-list-row.focused { outline: inherit; }`)),this.styleElement.textContent=i.join(`
`),this.view.style(e)}getParentElement(e){const t=this.model.getParentNodeLocation(e);return this.model.getNode(t).element}getFirstElementChild(e){return this.model.getFirstElementChild(e)}getNode(e){return this.model.getNode(e)}getNodeLocation(e){return this.model.getNodeLocation(e)}collapse(e,t=!1){return this.model.setCollapsed(e,!0,t)}expand(e,t=!1){return this.model.setCollapsed(e,!1,t)}toggleCollapsed(e,t=!1){return this.model.setCollapsed(e,void 0,t)}isCollapsible(e){return this.model.isCollapsible(e)}setCollapsible(e,t){return this.model.setCollapsible(e,t)}isCollapsed(e){return this.model.isCollapsed(e)}refilter(){this._onWillRefilter.fire(void 0),this.model.refilter()}setSelection(e,t){this.eventBufferer.bufferEvents(()=>{const i=e.map(r=>this.model.getNode(r));this.selection.set(i,t);const n=e.map(r=>this.model.getListIndex(r)).filter(r=>r>-1);this.view.setSelection(n,t,!0)})}getSelection(){return this.selection.get()}setFocus(e,t){this.eventBufferer.bufferEvents(()=>{const i=e.map(r=>this.model.getNode(r));this.focus.set(i,t);const n=e.map(r=>this.model.getListIndex(r)).filter(r=>r>-1);this.view.setFocus(n,t,!0)})}focusNext(e=1,t=!1,i,n=Df(i)&&i.altKey?void 0:this.focusNavigationFilter){this.view.focusNext(e,t,i,n)}focusPrevious(e=1,t=!1,i,n=Df(i)&&i.altKey?void 0:this.focusNavigationFilter){this.view.focusPrevious(e,t,i,n)}focusNextPage(e,t=Df(e)&&e.altKey?void 0:this.focusNavigationFilter){return this.view.focusNextPage(e,t)}focusPreviousPage(e,t=Df(e)&&e.altKey?void 0:this.focusNavigationFilter){return this.view.focusPreviousPage(e,t,()=>{var i;return((i=this.stickyScrollController)==null?void 0:i.height)??0})}focusLast(e,t=Df(e)&&e.altKey?void 0:this.focusNavigationFilter){this.view.focusLast(e,t)}focusFirst(e,t=Df(e)&&e.altKey?void 0:this.focusNavigationFilter){this.view.focusFirst(e,t)}getFocus(){return this.focus.get()}reveal(e,t){this.model.expandTo(e);const i=this.model.getListIndex(e);if(i!==-1)if(!this.stickyScrollController)this.view.reveal(i,t);else{const n=this.stickyScrollController.nodePositionTopBelowWidget(this.getNode(e));this.view.reveal(i,t,n)}}onLeftArrow(e){e.preventDefault(),e.stopPropagation();const t=this.view.getFocusedElements();if(t.length===0)return;const i=t[0],n=this.model.getNodeLocation(i);if(!this.model.setCollapsed(n,!0)){const o=this.model.getParentNodeLocation(n);if(!o)return;const a=this.model.getListIndex(o);this.view.reveal(a),this.view.setFocus([a])}}onRightArrow(e){e.preventDefault(),e.stopPropagation();const t=this.view.getFocusedElements();if(t.length===0)return;const i=t[0],n=this.model.getNodeLocation(i);if(!this.model.setCollapsed(n,!1)){if(!i.children.some(l=>l.visible))return;const[o]=this.view.getFocus(),a=o+1;this.view.reveal(a),this.view.setFocus([a])}}onSpace(e){e.preventDefault(),e.stopPropagation();const t=this.view.getFocusedElements();if(t.length===0)return;const i=t[0],n=this.model.getNodeLocation(i),r=e.browserEvent.altKey;this.model.setCollapsed(n,void 0,r)}dispose(){var e;Ni(this.disposables),(e=this.stickyScrollController)==null||e.dispose(),this.view.dispose()}}class tG{constructor(e,t,i={}){this.user=e,this.rootRef=null,this.nodes=new Map,this.nodesByIdentity=new Map,this.model=new hWe(e,t,null,i),this.onDidSplice=this.model.onDidSplice,this.onDidChangeCollapseState=this.model.onDidChangeCollapseState,this.onDidChangeRenderNodeCount=this.model.onDidChangeRenderNodeCount,i.sorter&&(this.sorter={compare(n,r){return i.sorter.compare(n.element,r.element)}}),this.identityProvider=i.identityProvider}setChildren(e,t=Kt.empty(),i={}){const n=this.getElementLocation(e);this._setChildren(n,this.preserveCollapseState(t),i)}_setChildren(e,t=Kt.empty(),i){const n=new Set,r=new Set,o=l=>{var d;if(l.element===null)return;const c=l;if(n.add(c.element),this.nodes.set(c.element,c),this.identityProvider){const u=this.identityProvider.getId(c.element).toString();r.add(u),this.nodesByIdentity.set(u,c)}(d=i.onDidCreateNode)==null||d.call(i,c)},a=l=>{var d;if(l.element===null)return;const c=l;if(n.has(c.element)||this.nodes.delete(c.element),this.identityProvider){const u=this.identityProvider.getId(c.element).toString();r.has(u)||this.nodesByIdentity.delete(u)}(d=i.onDidDeleteNode)==null||d.call(i,c)};this.model.splice([...e,0],Number.MAX_VALUE,t,{...i,onDidCreateNode:o,onDidDeleteNode:a})}preserveCollapseState(e=Kt.empty()){return this.sorter&&(e=[...e].sort(this.sorter.compare.bind(this.sorter))),Kt.map(e,t=>{let i=this.nodes.get(t.element);if(!i&&this.identityProvider){const o=this.identityProvider.getId(t.element).toString();i=this.nodesByIdentity.get(o)}if(!i){let o;return typeof t.collapsed>"u"?o=void 0:t.collapsed===dl.Collapsed||t.collapsed===dl.PreserveOrCollapsed?o=!0:t.collapsed===dl.Expanded||t.collapsed===dl.PreserveOrExpanded?o=!1:o=!!t.collapsed,{...t,children:this.preserveCollapseState(t.children),collapsed:o}}const n=typeof t.collapsible=="boolean"?t.collapsible:i.collapsible;let r;return typeof t.collapsed>"u"||t.collapsed===dl.PreserveOrCollapsed||t.collapsed===dl.PreserveOrExpanded?r=i.collapsed:t.collapsed===dl.Collapsed?r=!0:t.collapsed===dl.Expanded?r=!1:r=!!t.collapsed,{...t,collapsible:n,collapsed:r,children:this.preserveCollapseState(t.children)}})}rerender(e){const t=this.getElementLocation(e);this.model.rerender(t)}getFirstElementChild(e=null){const t=this.getElementLocation(e);return this.model.getFirstElementChild(t)}has(e){return this.nodes.has(e)}getListIndex(e){const t=this.getElementLocation(e);return this.model.getListIndex(t)}getListRenderCount(e){const t=this.getElementLocation(e);return this.model.getListRenderCount(t)}isCollapsible(e){const t=this.getElementLocation(e);return this.model.isCollapsible(t)}setCollapsible(e,t){const i=this.getElementLocation(e);return this.model.setCollapsible(i,t)}isCollapsed(e){const t=this.getElementLocation(e);return this.model.isCollapsed(t)}setCollapsed(e,t,i){const n=this.getElementLocation(e);return this.model.setCollapsed(n,t,i)}expandTo(e){const t=this.getElementLocation(e);this.model.expandTo(t)}refilter(){this.model.refilter()}getNode(e=null){if(e===null)return this.model.getNode(this.model.rootRef);const t=this.nodes.get(e);if(!t)throw new bl(this.user,`Tree element not found: ${e}`);return t}getNodeLocation(e){return e.element}getParentNodeLocation(e){if(e===null)throw new bl(this.user,"Invalid getParentNodeLocation call");const t=this.nodes.get(e);if(!t)throw new bl(this.user,`Tree element not found: ${e}`);const i=this.model.getNodeLocation(t),n=this.model.getParentNodeLocation(i);return this.model.getNode(n).element}getElementLocation(e){if(e===null)return[];const t=this.nodes.get(e);if(!t)throw new bl(this.user,`Tree element not found: ${e}`);return this.model.getNodeLocation(t)}}function VR(s){const e=[s.element],t=s.incompressible||!1;return{element:{elements:e,incompressible:t},children:Kt.map(Kt.from(s.children),VR),collapsible:s.collapsible,collapsed:s.collapsed}}function BR(s){const e=[s.element],t=s.incompressible||!1;let i,n;for(;[n,i]=Kt.consume(Kt.from(s.children),2),!(n.length!==1||n[0].incompressible);)s=n[0],e.push(s.element);return{element:{elements:e,incompressible:t},children:Kt.map(Kt.concat(n,i),BR),collapsible:s.collapsible,collapsed:s.collapsed}}function U8(s,e=0){let t;return e<s.element.elements.length-1?t=[U8(s,e+1)]:t=Kt.map(Kt.from(s.children),i=>U8(i,0)),e===0&&s.element.incompressible?{element:s.element.elements[e],children:t,incompressible:!0,collapsible:s.collapsible,collapsed:s.collapsed}:{element:s.element.elements[e],children:t,collapsible:s.collapsible,collapsed:s.collapsed}}function $ne(s){return U8(s,0)}function spe(s,e,t){return s.element===e?{...s,children:t}:{...s,children:Kt.map(Kt.from(s.children),i=>spe(i,e,t))}}const IWe=s=>({getId(e){return e.elements.map(t=>s.getId(t).toString()).join("\0")}});class EWe{get onDidSplice(){return this.model.onDidSplice}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get onDidChangeRenderNodeCount(){return this.model.onDidChangeRenderNodeCount}constructor(e,t,i={}){this.user=e,this.rootRef=null,this.nodes=new Map,this.model=new tG(e,t,i),this.enabled=typeof i.compressionEnabled>"u"?!0:i.compressionEnabled,this.identityProvider=i.identityProvider}setChildren(e,t=Kt.empty(),i){const n=i.diffIdentityProvider&&IWe(i.diffIdentityProvider);if(e===null){const p=Kt.map(t,this.enabled?BR:VR);this._setChildren(null,p,{diffIdentityProvider:n,diffDepth:1/0});return}const r=this.nodes.get(e);if(!r)throw new bl(this.user,"Unknown compressed tree node");const o=this.model.getNode(r),a=this.model.getParentNodeLocation(r),l=this.model.getNode(a),c=$ne(o),d=spe(c,e,t),u=(this.enabled?BR:VR)(d),h=i.diffIdentityProvider?(p,_)=>i.diffIdentityProvider.getId(p)===i.diffIdentityProvider.getId(_):void 0;if(dn(u.element.elements,o.element.elements,h)){this._setChildren(r,u.children||Kt.empty(),{diffIdentityProvider:n,diffDepth:1});return}const g=l.children.map(p=>p===o?u:p);this._setChildren(l.element,g,{diffIdentityProvider:n,diffDepth:o.depth-l.depth})}isCompressionEnabled(){return this.enabled}setCompressionEnabled(e){if(e===this.enabled)return;this.enabled=e;const i=this.model.getNode().children,n=Kt.map(i,$ne),r=Kt.map(n,e?BR:VR);this._setChildren(null,r,{diffIdentityProvider:this.identityProvider,diffDepth:1/0})}_setChildren(e,t,i){const n=new Set,r=a=>{for(const l of a.element.elements)n.add(l),this.nodes.set(l,a.element)},o=a=>{for(const l of a.element.elements)n.has(l)||this.nodes.delete(l)};this.model.setChildren(e,t,{...i,onDidCreateNode:r,onDidDeleteNode:o})}has(e){return this.nodes.has(e)}getListIndex(e){const t=this.getCompressedNode(e);return this.model.getListIndex(t)}getListRenderCount(e){const t=this.getCompressedNode(e);return this.model.getListRenderCount(t)}getNode(e){if(typeof e>"u")return this.model.getNode();const t=this.getCompressedNode(e);return this.model.getNode(t)}getNodeLocation(e){const t=this.model.getNodeLocation(e);return t===null?null:t.elements[t.elements.length-1]}getParentNodeLocation(e){const t=this.getCompressedNode(e),i=this.model.getParentNodeLocation(t);return i===null?null:i.elements[i.elements.length-1]}getFirstElementChild(e){const t=this.getCompressedNode(e);return this.model.getFirstElementChild(t)}isCollapsible(e){const t=this.getCompressedNode(e);return this.model.isCollapsible(t)}setCollapsible(e,t){const i=this.getCompressedNode(e);return this.model.setCollapsible(i,t)}isCollapsed(e){const t=this.getCompressedNode(e);return this.model.isCollapsed(t)}setCollapsed(e,t,i){const n=this.getCompressedNode(e);return this.model.setCollapsed(n,t,i)}expandTo(e){const t=this.getCompressedNode(e);this.model.expandTo(t)}rerender(e){const t=this.getCompressedNode(e);this.model.rerender(t)}refilter(){this.model.refilter()}getCompressedNode(e){if(e===null)return null;const t=this.nodes.get(e);if(!t)throw new bl(this.user,`Tree element not found: ${e}`);return t}}const DWe=s=>s[s.length-1];class iG{get element(){return this.node.element===null?null:this.unwrapper(this.node.element)}get children(){return this.node.children.map(e=>new iG(this.unwrapper,e))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}constructor(e,t){this.unwrapper=e,this.node=t}}function TWe(s,e){return{splice(t,i,n){e.splice(t,i,n.map(r=>s.map(r)))},updateElementHeight(t,i){e.updateElementHeight(t,i)}}}function NWe(s,e){return{...e,identityProvider:e.identityProvider&&{getId(t){return e.identityProvider.getId(s(t))}},sorter:e.sorter&&{compare(t,i){return e.sorter.compare(t.elements[0],i.elements[0])}},filter:e.filter&&{filter(t,i){return e.filter.filter(s(t),i)}}}}class RWe{get onDidSplice(){return De.map(this.model.onDidSplice,({insertedNodes:e,deletedNodes:t})=>({insertedNodes:e.map(i=>this.nodeMapper.map(i)),deletedNodes:t.map(i=>this.nodeMapper.map(i))}))}get onDidChangeCollapseState(){return De.map(this.model.onDidChangeCollapseState,({node:e,deep:t})=>({node:this.nodeMapper.map(e),deep:t}))}get onDidChangeRenderNodeCount(){return De.map(this.model.onDidChangeRenderNodeCount,e=>this.nodeMapper.map(e))}constructor(e,t,i={}){this.rootRef=null,this.elementMapper=i.elementMapper||DWe;const n=r=>this.elementMapper(r.elements);this.nodeMapper=new ZK(r=>new iG(n,r)),this.model=new EWe(e,TWe(this.nodeMapper,t),NWe(n,i))}setChildren(e,t=Kt.empty(),i={}){this.model.setChildren(e,t,i)}isCompressionEnabled(){return this.model.isCompressionEnabled()}setCompressionEnabled(e){this.model.setCompressionEnabled(e)}has(e){return this.model.has(e)}getListIndex(e){return this.model.getListIndex(e)}getListRenderCount(e){return this.model.getListRenderCount(e)}getNode(e){return this.nodeMapper.map(this.model.getNode(e))}getNodeLocation(e){return e.element}getParentNodeLocation(e){return this.model.getParentNodeLocation(e)}getFirstElementChild(e){const t=this.model.getFirstElementChild(e);return t===null||typeof t>"u"?t:this.elementMapper(t.elements)}isCollapsible(e){return this.model.isCollapsible(e)}setCollapsible(e,t){return this.model.setCollapsible(e,t)}isCollapsed(e){return this.model.isCollapsed(e)}setCollapsed(e,t,i){return this.model.setCollapsed(e,t,i)}expandTo(e){return this.model.expandTo(e)}rerender(e){return this.model.rerender(e)}refilter(){return this.model.refilter()}getCompressedTreeNode(e=null){return this.model.getNode(e)}}var AWe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r};class nG extends npe{get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}constructor(e,t,i,n,r={}){super(e,t,i,n,r),this.user=e}setChildren(e,t=Kt.empty(),i){this.model.setChildren(e,t,i)}rerender(e){if(e===void 0){this.view.rerender();return}this.model.rerender(e)}hasElement(e){return this.model.has(e)}createModel(e,t,i){return new tG(e,t,i)}}class rpe{get compressedTreeNodeProvider(){return this._compressedTreeNodeProvider()}constructor(e,t,i){this._compressedTreeNodeProvider=e,this.stickyScrollDelegate=t,this.renderer=i,this.templateId=i.templateId,i.onDidChangeTwistieState&&(this.onDidChangeTwistieState=i.onDidChangeTwistieState)}renderTemplate(e){return{compressedTreeNode:void 0,data:this.renderer.renderTemplate(e)}}renderElement(e,t,i,n){let r=this.stickyScrollDelegate.getCompressedNode(e);r||(r=this.compressedTreeNodeProvider.getCompressedTreeNode(e.element)),r.element.elements.length===1?(i.compressedTreeNode=void 0,this.renderer.renderElement(e,t,i.data,n)):(i.compressedTreeNode=r,this.renderer.renderCompressedElements(r,t,i.data,n))}disposeElement(e,t,i,n){var r,o,a,l;i.compressedTreeNode?(o=(r=this.renderer).disposeCompressedElements)==null||o.call(r,i.compressedTreeNode,t,i.data,n):(l=(a=this.renderer).disposeElement)==null||l.call(a,e,t,i.data,n)}disposeTemplate(e){this.renderer.disposeTemplate(e.data)}renderTwistie(e,t){return this.renderer.renderTwistie?this.renderer.renderTwistie(e,t):!1}}AWe([$n],rpe.prototype,"compressedTreeNodeProvider",null);class PWe{constructor(e){this.modelProvider=e,this.compressedStickyNodes=new Map}getCompressedNode(e){return this.compressedStickyNodes.get(e)}constrainStickyScrollNodes(e,t,i){if(this.compressedStickyNodes.clear(),e.length===0)return[];for(let n=0;n<e.length;n++){const r=e[n],o=r.position+r.height;if(n+1<e.length&&o+e[n+1].height>i||n>=t-1&&t<e.length){const l=e.slice(0,n),c=e.slice(n),d=this.compressStickyNodes(c);return[...l,d]}}return e}compressStickyNodes(e){if(e.length===0)throw new Error("Can't compress empty sticky nodes");const t=this.modelProvider();if(!t.isCompressionEnabled())return e[0];const i=[];for(let c=0;c<e.length;c++){const d=e[c],u=t.getCompressedTreeNode(d.node.element);if(u.element){if(c!==0&&u.element.incompressible)break;i.push(...u.element.elements)}}if(i.length<2)return e[0];const n=e[e.length-1],r={elements:i,incompressible:!1},o={...n.node,children:[],element:r},a=new Proxy(e[0].node,{}),l={node:a,startIndex:e[0].startIndex,endIndex:n.endIndex,position:e[0].position,height:e[0].height};return this.compressedStickyNodes.set(a,o),l}}function MWe(s,e){return e&&{...e,keyboardNavigationLabelProvider:e.keyboardNavigationLabelProvider&&{getKeyboardNavigationLabel(t){let i;try{i=s().getCompressedTreeNode(t)}catch{return e.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t)}return i.element.elements.length===1?e.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t):e.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(i.element.elements)}}}}class ope extends nG{constructor(e,t,i,n,r={}){const o=()=>this,a=new PWe(()=>this.model),l=n.map(c=>new rpe(o,a,c));super(e,t,i,l,{...MWe(o,r),stickyScrollDelegate:a})}setChildren(e,t=Kt.empty(),i){this.model.setChildren(e,t,i)}createModel(e,t,i){return new RWe(e,t,i)}updateOptions(e={}){super.updateOptions(e),typeof e.compressionEnabled<"u"&&this.model.setCompressionEnabled(e.compressionEnabled)}getCompressedTreeNode(e=null){return this.model.getCompressedTreeNode(e)}}function ZV(s){return{...s,children:[],refreshPromise:void 0,stale:!0,slow:!1,forceExpanded:!1}}function j8(s,e){return e.parent?e.parent===s?!0:j8(s,e.parent):!1}function OWe(s,e){return s===e||j8(s,e)||j8(e,s)}class sG{get element(){return this.node.element.element}get children(){return this.node.children.map(e=>new sG(e))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}constructor(e){this.node=e}}class FWe{constructor(e,t,i){this.renderer=e,this.nodeMapper=t,this.onDidChangeTwistieState=i,this.renderedNodes=new Map,this.templateId=e.templateId}renderTemplate(e){return{templateData:this.renderer.renderTemplate(e)}}renderElement(e,t,i,n){this.renderer.renderElement(this.nodeMapper.map(e),t,i.templateData,n)}renderTwistie(e,t){return e.slow?(t.classList.add(...at.asClassNameArray(xe.treeItemLoading)),!0):(t.classList.remove(...at.asClassNameArray(xe.treeItemLoading)),!1)}disposeElement(e,t,i,n){var r,o;(o=(r=this.renderer).disposeElement)==null||o.call(r,this.nodeMapper.map(e),t,i.templateData,n)}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}dispose(){this.renderedNodes.clear()}}function qne(s){return{browserEvent:s.browserEvent,elements:s.elements.map(e=>e.element)}}function Kne(s){return{browserEvent:s.browserEvent,element:s.element&&s.element.element,target:s.target}}class VWe extends sD{constructor(e){super(e.elements.map(t=>t.element)),this.data=e}}function JV(s){return s instanceof sD?new VWe(s):s}class BWe{constructor(e){this.dnd=e}getDragURI(e){return this.dnd.getDragURI(e.element)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e.map(i=>i.element),t)}onDragStart(e,t){var i,n;(n=(i=this.dnd).onDragStart)==null||n.call(i,JV(e),t)}onDragOver(e,t,i,n,r,o=!0){return this.dnd.onDragOver(JV(e),t&&t.element,i,n,r)}drop(e,t,i,n,r){this.dnd.drop(JV(e),t&&t.element,i,n,r)}onDragEnd(e){var t,i;(i=(t=this.dnd).onDragEnd)==null||i.call(t,e)}dispose(){this.dnd.dispose()}}function ape(s){return s&&{...s,collapseByDefault:!0,identityProvider:s.identityProvider&&{getId(e){return s.identityProvider.getId(e.element)}},dnd:s.dnd&&new BWe(s.dnd),multipleSelectionController:s.multipleSelectionController&&{isSelectionSingleChangeEvent(e){return s.multipleSelectionController.isSelectionSingleChangeEvent({...e,element:e.element})},isSelectionRangeChangeEvent(e){return s.multipleSelectionController.isSelectionRangeChangeEvent({...e,element:e.element})}},accessibilityProvider:s.accessibilityProvider&&{...s.accessibilityProvider,getPosInSet:void 0,getSetSize:void 0,getRole:s.accessibilityProvider.getRole?e=>s.accessibilityProvider.getRole(e.element):()=>"treeitem",isChecked:s.accessibilityProvider.isChecked?e=>{var t;return!!((t=s.accessibilityProvider)!=null&&t.isChecked(e.element))}:void 0,getAriaLabel(e){return s.accessibilityProvider.getAriaLabel(e.element)},getWidgetAriaLabel(){return s.accessibilityProvider.getWidgetAriaLabel()},getWidgetRole:s.accessibilityProvider.getWidgetRole?()=>s.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:s.accessibilityProvider.getAriaLevel&&(e=>s.accessibilityProvider.getAriaLevel(e.element)),getActiveDescendantId:s.accessibilityProvider.getActiveDescendantId&&(e=>s.accessibilityProvider.getActiveDescendantId(e.element))},filter:s.filter&&{filter(e,t){return s.filter.filter(e.element,t)}},keyboardNavigationLabelProvider:s.keyboardNavigationLabelProvider&&{...s.keyboardNavigationLabelProvider,getKeyboardNavigationLabel(e){return s.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e.element)}},sorter:void 0,expandOnlyOnTwistieClick:typeof s.expandOnlyOnTwistieClick>"u"?void 0:typeof s.expandOnlyOnTwistieClick!="function"?s.expandOnlyOnTwistieClick:e=>s.expandOnlyOnTwistieClick(e.element),defaultFindVisibility:e=>e.hasChildren&&e.stale?1:typeof s.defaultFindVisibility=="number"?s.defaultFindVisibility:typeof s.defaultFindVisibility>"u"?2:s.defaultFindVisibility(e.element)}}function $8(s,e){e(s),s.children.forEach(t=>$8(t,e))}class lpe{get onDidScroll(){return this.tree.onDidScroll}get onDidChangeFocus(){return De.map(this.tree.onDidChangeFocus,qne)}get onDidChangeSelection(){return De.map(this.tree.onDidChangeSelection,qne)}get onMouseDblClick(){return De.map(this.tree.onMouseDblClick,Kne)}get onPointer(){return De.map(this.tree.onPointer,Kne)}get onDidFocus(){return this.tree.onDidFocus}get onDidChangeModel(){return this.tree.onDidChangeModel}get onDidChangeCollapseState(){return this.tree.onDidChangeCollapseState}get onDidChangeFindOpenState(){return this.tree.onDidChangeFindOpenState}get onDidChangeStickyScrollFocused(){return this.tree.onDidChangeStickyScrollFocused}get onDidDispose(){return this.tree.onDidDispose}constructor(e,t,i,n,r,o={}){this.user=e,this.dataSource=r,this.nodes=new Map,this.subTreeRefreshPromises=new Map,this.refreshPromises=new Map,this._onDidRender=new Z,this._onDidChangeNodeSlowState=new Z,this.nodeMapper=new ZK(a=>new sG(a)),this.disposables=new ce,this.identityProvider=o.identityProvider,this.autoExpandSingleChildren=typeof o.autoExpandSingleChildren>"u"?!1:o.autoExpandSingleChildren,this.sorter=o.sorter,this.getDefaultCollapseState=a=>o.collapseByDefault?o.collapseByDefault(a)?dl.PreserveOrCollapsed:dl.PreserveOrExpanded:void 0,this.tree=this.createTree(e,t,i,n,o),this.onDidChangeFindMode=this.tree.onDidChangeFindMode,this.onDidChangeFindMatchType=this.tree.onDidChangeFindMatchType,this.root=ZV({element:void 0,parent:null,hasChildren:!0,defaultCollapseState:void 0}),this.identityProvider&&(this.root={...this.root,id:null}),this.nodes.set(null,this.root),this.tree.onDidChangeCollapseState(this._onDidChangeCollapseState,this,this.disposables)}createTree(e,t,i,n,r){const o=new eG(i),a=n.map(c=>new FWe(c,this.nodeMapper,this._onDidChangeNodeSlowState.event)),l=ape(r)||{};return new nG(e,t,o,a,l)}updateOptions(e={}){this.tree.updateOptions(e)}getHTMLElement(){return this.tree.getHTMLElement()}get scrollTop(){return this.tree.scrollTop}set scrollTop(e){this.tree.scrollTop=e}get scrollHeight(){return this.tree.scrollHeight}get renderHeight(){return this.tree.renderHeight}domFocus(){this.tree.domFocus()}layout(e,t){this.tree.layout(e,t)}style(e){this.tree.style(e)}getInput(){return this.root.element}async setInput(e,t){this.refreshPromises.forEach(n=>n.cancel()),this.refreshPromises.clear(),this.root.element=e;const i=t&&{viewState:t,focus:[],selection:[]};await this._updateChildren(e,!0,!1,i),i&&(this.tree.setFocus(i.focus),this.tree.setSelection(i.selection)),t&&typeof t.scrollTop=="number"&&(this.scrollTop=t.scrollTop)}async _updateChildren(e=this.root.element,t=!0,i=!1,n,r){if(typeof this.root.element>"u")throw new bl(this.user,"Tree input not set");this.root.refreshPromise&&(await this.root.refreshPromise,await De.toPromise(this._onDidRender.event));const o=this.getDataNode(e);if(await this.refreshAndRenderNode(o,t,n,r),i)try{this.tree.rerender(o)}catch{}}rerender(e){if(e===void 0||e===this.root.element){this.tree.rerender();return}const t=this.getDataNode(e);this.tree.rerender(t)}getNode(e=this.root.element){const t=this.getDataNode(e),i=this.tree.getNode(t===this.root?null:t);return this.nodeMapper.map(i)}collapse(e,t=!1){const i=this.getDataNode(e);return this.tree.collapse(i===this.root?null:i,t)}async expand(e,t=!1){if(typeof this.root.element>"u")throw new bl(this.user,"Tree input not set");this.root.refreshPromise&&(await this.root.refreshPromise,await De.toPromise(this._onDidRender.event));const i=this.getDataNode(e);if(this.tree.hasElement(i)&&!this.tree.isCollapsible(i)||(i.refreshPromise&&(await this.root.refreshPromise,await De.toPromise(this._onDidRender.event)),i!==this.root&&!i.refreshPromise&&!this.tree.isCollapsed(i)))return!1;const n=this.tree.expand(i===this.root?null:i,t);return i.refreshPromise&&(await this.root.refreshPromise,await De.toPromise(this._onDidRender.event)),n}setSelection(e,t){const i=e.map(n=>this.getDataNode(n));this.tree.setSelection(i,t)}getSelection(){return this.tree.getSelection().map(t=>t.element)}setFocus(e,t){const i=e.map(n=>this.getDataNode(n));this.tree.setFocus(i,t)}getFocus(){return this.tree.getFocus().map(t=>t.element)}reveal(e,t){this.tree.reveal(this.getDataNode(e),t)}getParentElement(e){const t=this.tree.getParentElement(this.getDataNode(e));return t&&t.element}getFirstElementChild(e=this.root.element){const t=this.getDataNode(e),i=this.tree.getFirstElementChild(t===this.root?null:t);return i&&i.element}getDataNode(e){const t=this.nodes.get(e===this.root.element?null:e);if(!t)throw new bl(this.user,`Data tree node not found: ${e}`);return t}async refreshAndRenderNode(e,t,i,n){await this.refreshNode(e,t,i),!this.disposables.isDisposed&&this.render(e,i,n)}async refreshNode(e,t,i){let n;if(this.subTreeRefreshPromises.forEach((r,o)=>{!n&&OWe(o,e)&&(n=r.then(()=>this.refreshNode(e,t,i)))}),n)return n;if(e!==this.root&&this.tree.getNode(e).collapsed){e.hasChildren=!!this.dataSource.hasChildren(e.element),e.stale=!0,this.setChildren(e,[],t,i);return}return this.doRefreshSubTree(e,t,i)}async doRefreshSubTree(e,t,i){let n;e.refreshPromise=new Promise(r=>n=r),this.subTreeRefreshPromises.set(e,e.refreshPromise),e.refreshPromise.finally(()=>{e.refreshPromise=void 0,this.subTreeRefreshPromises.delete(e)});try{const r=await this.doRefreshNode(e,t,i);e.stale=!1,await UW.settled(r.map(o=>this.doRefreshSubTree(o,t,i)))}finally{n()}}async doRefreshNode(e,t,i){e.hasChildren=!!this.dataSource.hasChildren(e.element);let n;if(!e.hasChildren)n=Promise.resolve(Kt.empty());else{const r=this.doGetChildren(e);if(Hee(r))n=Promise.resolve(r);else{const o=Sg(800);o.then(()=>{e.slow=!0,this._onDidChangeNodeSlowState.fire(e)},a=>null),n=r.finally(()=>o.cancel())}}try{const r=await n;return this.setChildren(e,r,t,i)}catch(r){if(e!==this.root&&this.tree.hasElement(e)&&this.tree.collapse(e),xc(r))return[];throw r}finally{e.slow&&(e.slow=!1,this._onDidChangeNodeSlowState.fire(e))}}doGetChildren(e){let t=this.refreshPromises.get(e);if(t)return t;const i=this.dataSource.getChildren(e.element);return Hee(i)?this.processChildren(i):(t=xs(async()=>this.processChildren(await i)),this.refreshPromises.set(e,t),t.finally(()=>{this.refreshPromises.delete(e)}))}_onDidChangeCollapseState({node:e,deep:t}){e.element!==null&&!e.collapsed&&e.element.stale&&(t?this.collapse(e.element.element):this.refreshAndRenderNode(e.element,!1).catch(ft))}setChildren(e,t,i,n){const r=[...t];if(e.children.length===0&&r.length===0)return[];const o=new Map,a=new Map;for(const d of e.children)o.set(d.element,d),this.identityProvider&&a.set(d.id,{node:d,collapsed:this.tree.hasElement(d)&&this.tree.isCollapsed(d)});const l=[],c=r.map(d=>{const u=!!this.dataSource.hasChildren(d);if(!this.identityProvider){const _=ZV({element:d,parent:e,hasChildren:u,defaultCollapseState:this.getDefaultCollapseState(d)});return u&&_.defaultCollapseState===dl.PreserveOrExpanded&&l.push(_),_}const h=this.identityProvider.getId(d).toString(),g=a.get(h);if(g){const _=g.node;return o.delete(_.element),this.nodes.delete(_.element),this.nodes.set(d,_),_.element=d,_.hasChildren=u,i?g.collapsed?(_.children.forEach(v=>$8(v,C=>this.nodes.delete(C.element))),_.children.splice(0,_.children.length),_.stale=!0):l.push(_):u&&!g.collapsed&&l.push(_),_}const p=ZV({element:d,parent:e,id:h,hasChildren:u,defaultCollapseState:this.getDefaultCollapseState(d)});return n&&n.viewState.focus&&n.viewState.focus.indexOf(h)>-1&&n.focus.push(p),n&&n.viewState.selection&&n.viewState.selection.indexOf(h)>-1&&n.selection.push(p),(n&&n.viewState.expanded&&n.viewState.expanded.indexOf(h)>-1||u&&p.defaultCollapseState===dl.PreserveOrExpanded)&&l.push(p),p});for(const d of o.values())$8(d,u=>this.nodes.delete(u.element));for(const d of c)this.nodes.set(d.element,d);return e.children.splice(0,e.children.length,...c),e!==this.root&&this.autoExpandSingleChildren&&c.length===1&&l.length===0&&(c[0].forceExpanded=!0,l.push(c[0])),l}render(e,t,i){const n=e.children.map(o=>this.asTreeElement(o,t)),r=i&&{...i,diffIdentityProvider:i.diffIdentityProvider&&{getId(o){return i.diffIdentityProvider.getId(o.element)}}};this.tree.setChildren(e===this.root?null:e,n,r),e!==this.root&&this.tree.setCollapsible(e,e.hasChildren),this._onDidRender.fire()}asTreeElement(e,t){if(e.stale)return{element:e,collapsible:e.hasChildren,collapsed:!0};let i;return t&&t.viewState.expanded&&e.id&&t.viewState.expanded.indexOf(e.id)>-1?i=!1:e.forceExpanded?(i=!1,e.forceExpanded=!1):i=e.defaultCollapseState,{element:e,children:e.hasChildren?Kt.map(e.children,n=>this.asTreeElement(n,t)):[],collapsible:e.hasChildren,collapsed:i}}processChildren(e){return this.sorter&&(e=[...e].sort(this.sorter.compare.bind(this.sorter))),e}dispose(){this.disposables.dispose(),this.tree.dispose()}}class rG{get element(){return{elements:this.node.element.elements.map(e=>e.element),incompressible:this.node.element.incompressible}}get children(){return this.node.children.map(e=>new rG(e))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}constructor(e){this.node=e}}class WWe{constructor(e,t,i,n){this.renderer=e,this.nodeMapper=t,this.compressibleNodeMapperProvider=i,this.onDidChangeTwistieState=n,this.renderedNodes=new Map,this.disposables=[],this.templateId=e.templateId}renderTemplate(e){return{templateData:this.renderer.renderTemplate(e)}}renderElement(e,t,i,n){this.renderer.renderElement(this.nodeMapper.map(e),t,i.templateData,n)}renderCompressedElements(e,t,i,n){this.renderer.renderCompressedElements(this.compressibleNodeMapperProvider().map(e),t,i.templateData,n)}renderTwistie(e,t){return e.slow?(t.classList.add(...at.asClassNameArray(xe.treeItemLoading)),!0):(t.classList.remove(...at.asClassNameArray(xe.treeItemLoading)),!1)}disposeElement(e,t,i,n){var r,o;(o=(r=this.renderer).disposeElement)==null||o.call(r,this.nodeMapper.map(e),t,i.templateData,n)}disposeCompressedElements(e,t,i,n){var r,o;(o=(r=this.renderer).disposeCompressedElements)==null||o.call(r,this.compressibleNodeMapperProvider().map(e),t,i.templateData,n)}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}dispose(){this.renderedNodes.clear(),this.disposables=Ni(this.disposables)}}function HWe(s){const e=s&&ape(s);return e&&{...e,keyboardNavigationLabelProvider:e.keyboardNavigationLabelProvider&&{...e.keyboardNavigationLabelProvider,getCompressedNodeKeyboardNavigationLabel(t){return s.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(t.map(i=>i.element))}}}}class zWe extends lpe{constructor(e,t,i,n,r,o,a={}){super(e,t,i,r,o,a),this.compressionDelegate=n,this.compressibleNodeMapper=new ZK(l=>new rG(l)),this.filter=a.filter}createTree(e,t,i,n,r){const o=new eG(i),a=n.map(c=>new WWe(c,this.nodeMapper,()=>this.compressibleNodeMapper,this._onDidChangeNodeSlowState.event)),l=HWe(r)||{};return new ope(e,t,o,a,l)}asTreeElement(e,t){return{incompressible:this.compressionDelegate.isIncompressible(e.element),...super.asTreeElement(e,t)}}updateOptions(e={}){this.tree.updateOptions(e)}render(e,t,i){if(!this.identityProvider)return super.render(e,t);const n=g=>this.identityProvider.getId(g).toString(),r=g=>{const p=new Set;for(const _ of g){const v=this.tree.getCompressedTreeNode(_===this.root?null:_);if(v.element)for(const C of v.element.elements)p.add(n(C.element))}return p},o=r(this.tree.getSelection()),a=r(this.tree.getFocus());super.render(e,t,i);const l=this.getSelection();let c=!1;const d=this.getFocus();let u=!1;const h=g=>{const p=g.element;if(p)for(let _=0;_<p.elements.length;_++){const v=n(p.elements[_].element),C=p.elements[p.elements.length-1].element;o.has(v)&&l.indexOf(C)===-1&&(l.push(C),c=!0),a.has(v)&&d.indexOf(C)===-1&&(d.push(C),u=!0)}g.children.forEach(h)};h(this.tree.getCompressedTreeNode(e===this.root?null:e)),c&&this.setSelection(l),u&&this.setFocus(d)}processChildren(e){return this.filter&&(e=Kt.filter(e,t=>{const i=this.filter.filter(t,1),n=UWe(i);if(n===2)throw new Error("Recursive tree visibility not supported in async data compressed trees");return n===1})),super.processChildren(e)}}function UWe(s){return typeof s=="boolean"?s?1:0:JK(s)?NI(s.visibility):NI(s)}class jWe extends npe{constructor(e,t,i,n,r,o={}){super(e,t,i,n,o),this.user=e,this.dataSource=r,this.identityProvider=o.identityProvider}createModel(e,t,i){return new tG(e,t,i)}}new Oe("isMac",Wt,b("isMac","Whether the operating system is macOS"));new Oe("isLinux",Lo,b("isLinux","Whether the operating system is Linux"));const $F=new Oe("isWindows",gr,b("isWindows","Whether the operating system is Windows")),cpe=new Oe("isWeb",Uw,b("isWeb","Whether the platform is a web browser"));new Oe("isMacNative",Wt&&!Uw,b("isMacNative","Whether the operating system is macOS on a non-browser platform"));new Oe("isIOS",du,b("isIOS","Whether the operating system is iOS"));new Oe("isMobile",nue,b("isMobile","Whether the platform is a mobile web browser"));new Oe("isDevelopment",!1,!0);new Oe("productQualityType","",b("productQualityType","Quality type of VS Code"));const dpe="inputFocus",upe=new Oe(dpe,!1,b("inputFocus","Whether keyboard focus is inside an input box"));var Bg=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Ki=function(s,e){return function(t,i){e(t,i,s)}};const Ic=Ht("listService");class $We{get lastFocusedList(){return this._lastFocusedWidget}constructor(){this.disposables=new ce,this.lists=[],this._lastFocusedWidget=void 0,this._hasCreatedStyleController=!1}setLastFocusedList(e){var t,i;e!==this._lastFocusedWidget&&((t=this._lastFocusedWidget)==null||t.getHTMLElement().classList.remove("last-focused"),this._lastFocusedWidget=e,(i=this._lastFocusedWidget)==null||i.getHTMLElement().classList.add("last-focused"))}register(e,t){if(this._hasCreatedStyleController||(this._hasCreatedStyleController=!0,new age(Rl(),"").style(Gw)),this.lists.some(n=>n.widget===e))throw new Error("Cannot register the same widget multiple times");const i={widget:e,extraContextKeys:t};return this.lists.push(i),rF(e.getHTMLElement())&&this.setLastFocusedList(e),id(e.onDidFocus(()=>this.setLastFocusedList(e)),Ye(()=>this.lists.splice(this.lists.indexOf(i),1)),e.onDidDispose(()=>{this.lists=this.lists.filter(n=>n!==i),this._lastFocusedWidget===e&&this.setLastFocusedList(void 0)}))}dispose(){this.disposables.dispose()}}const RI=new Oe("listScrollAtBoundary","none");he.or(RI.isEqualTo("top"),RI.isEqualTo("both"));he.or(RI.isEqualTo("bottom"),RI.isEqualTo("both"));const hpe=new Oe("listFocus",!0),fpe=new Oe("treestickyScrollFocused",!1),qF=new Oe("listSupportsMultiselect",!0),gpe=he.and(hpe,he.not(dpe),fpe.negate()),oG=new Oe("listHasSelectionOrFocus",!1),aG=new Oe("listDoubleSelection",!1),lG=new Oe("listMultiSelection",!1),KF=new Oe("listSelectionNavigation",!1),qWe=new Oe("listSupportsFind",!0),cG=new Oe("treeElementCanCollapse",!1),KWe=new Oe("treeElementHasParent",!1),dG=new Oe("treeElementCanExpand",!1),GWe=new Oe("treeElementHasChild",!1),QWe=new Oe("treeFindOpen",!1),ppe="listTypeNavigationMode",mpe="listAutomaticKeyboardNavigation";function GF(s,e){const t=s.createScoped(e.getHTMLElement());return hpe.bindTo(t),t}function QF(s,e){const t=RI.bindTo(s),i=()=>{const n=e.scrollTop===0,r=e.scrollHeight-e.renderHeight-e.scrollTop<1;n&&r?t.set("both"):n?t.set("top"):r?t.set("bottom"):t.set("none")};return i(),e.onDidScroll(i)}const Xw="workbench.list.multiSelectModifier",WR="workbench.list.openMode",pc="workbench.list.horizontalScrolling",uG="workbench.list.defaultFindMode",hG="workbench.list.typeNavigationMode",zA="workbench.list.keyboardNavigation",gu="workbench.list.scrollByPage",fG="workbench.list.defaultFindMatchType",AI="workbench.tree.indent",UA="workbench.tree.renderIndentGuides",pu="workbench.list.smoothScrolling",Fh="workbench.list.mouseWheelScrollSensitivity",Vh="workbench.list.fastScrollSensitivity",jA="workbench.tree.expandMode",$A="workbench.tree.enableStickyScroll",qA="workbench.tree.stickyScrollMaxItemCount";function Bh(s){return s.getValue(Xw)==="alt"}class YWe extends te{constructor(e){super(),this.configurationService=e,this.useAltAsMultipleSelectionModifier=Bh(e),this.registerListeners()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration(Xw)&&(this.useAltAsMultipleSelectionModifier=Bh(this.configurationService))}))}isSelectionSingleChangeEvent(e){return this.useAltAsMultipleSelectionModifier?e.browserEvent.altKey:sge(e)}isSelectionRangeChangeEvent(e){return rge(e)}}function YF(s,e){const t=s.get(At),i=s.get(pi),n=new ce;return[{...e,keyboardNavigationDelegate:{mightProducePrintableCharacter(o){return i.mightProducePrintableCharacter(o)}},smoothScrolling:!!t.getValue(pu),mouseWheelScrollSensitivity:t.getValue(Fh),fastScrollSensitivity:t.getValue(Vh),multipleSelectionController:e.multipleSelectionController??n.add(new YWe(t)),keyboardNavigationEventFilter:JWe(i),scrollByPage:!!t.getValue(gu)},n]}let Gne=class extends Bl{constructor(e,t,i,n,r,o,a,l,c){const d=typeof r.horizontalScrolling<"u"?r.horizontalScrolling:!!l.getValue(pc),[u,h]=c.invokeFunction(YF,r);super(e,t,i,n,{keyboardSupport:!1,...u,horizontalScrolling:d}),this.disposables.add(h),this.contextKeyService=GF(o,this),this.disposables.add(QF(this.contextKeyService,this)),this.listSupportsMultiSelect=qF.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(r.multipleSelectionSupport!==!1),KF.bindTo(this.contextKeyService).set(!!r.selectionNavigation),this.listHasSelectionOrFocus=oG.bindTo(this.contextKeyService),this.listDoubleSelection=aG.bindTo(this.contextKeyService),this.listMultiSelection=lG.bindTo(this.contextKeyService),this.horizontalScrolling=r.horizontalScrolling,this._useAltAsMultipleSelectionModifier=Bh(l),this.disposables.add(this.contextKeyService),this.disposables.add(a.register(this)),this.updateStyles(r.overrideStyles),this.disposables.add(this.onDidChangeSelection(()=>{const p=this.getSelection(),_=this.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.listHasSelectionOrFocus.set(p.length>0||_.length>0),this.listMultiSelection.set(p.length>1),this.listDoubleSelection.set(p.length===2)})})),this.disposables.add(this.onDidChangeFocus(()=>{const p=this.getSelection(),_=this.getFocus();this.listHasSelectionOrFocus.set(p.length>0||_.length>0)})),this.disposables.add(l.onDidChangeConfiguration(p=>{p.affectsConfiguration(Xw)&&(this._useAltAsMultipleSelectionModifier=Bh(l));let _={};if(p.affectsConfiguration(pc)&&this.horizontalScrolling===void 0){const v=!!l.getValue(pc);_={..._,horizontalScrolling:v}}if(p.affectsConfiguration(gu)){const v=!!l.getValue(gu);_={..._,scrollByPage:v}}if(p.affectsConfiguration(pu)){const v=!!l.getValue(pu);_={..._,smoothScrolling:v}}if(p.affectsConfiguration(Fh)){const v=l.getValue(Fh);_={..._,mouseWheelScrollSensitivity:v}}if(p.affectsConfiguration(Vh)){const v=l.getValue(Vh);_={..._,fastScrollSensitivity:v}}Object.keys(_).length>0&&this.updateOptions(_)})),this.navigator=new _pe(this,{configurationService:l,...r}),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles!==void 0&&this.updateStyles(e.overrideStyles),e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){this.style(e?Qw(e):Gw)}};Gne=Bg([Ki(5,ct),Ki(6,Ic),Ki(7,At),Ki(8,Xe)],Gne);let Qne=class extends tWe{constructor(e,t,i,n,r,o,a,l,c){const d=typeof r.horizontalScrolling<"u"?r.horizontalScrolling:!!l.getValue(pc),[u,h]=c.invokeFunction(YF,r);super(e,t,i,n,{keyboardSupport:!1,...u,horizontalScrolling:d}),this.disposables=new ce,this.disposables.add(h),this.contextKeyService=GF(o,this),this.disposables.add(QF(this.contextKeyService,this.widget)),this.horizontalScrolling=r.horizontalScrolling,this.listSupportsMultiSelect=qF.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(r.multipleSelectionSupport!==!1),KF.bindTo(this.contextKeyService).set(!!r.selectionNavigation),this._useAltAsMultipleSelectionModifier=Bh(l),this.disposables.add(this.contextKeyService),this.disposables.add(a.register(this)),this.updateStyles(r.overrideStyles),this.disposables.add(l.onDidChangeConfiguration(p=>{p.affectsConfiguration(Xw)&&(this._useAltAsMultipleSelectionModifier=Bh(l));let _={};if(p.affectsConfiguration(pc)&&this.horizontalScrolling===void 0){const v=!!l.getValue(pc);_={..._,horizontalScrolling:v}}if(p.affectsConfiguration(gu)){const v=!!l.getValue(gu);_={..._,scrollByPage:v}}if(p.affectsConfiguration(pu)){const v=!!l.getValue(pu);_={..._,smoothScrolling:v}}if(p.affectsConfiguration(Fh)){const v=l.getValue(Fh);_={..._,mouseWheelScrollSensitivity:v}}if(p.affectsConfiguration(Vh)){const v=l.getValue(Vh);_={..._,fastScrollSensitivity:v}}Object.keys(_).length>0&&this.updateOptions(_)})),this.navigator=new _pe(this,{configurationService:l,...r}),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles!==void 0&&this.updateStyles(e.overrideStyles),e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){this.style(e?Qw(e):Gw)}dispose(){this.disposables.dispose(),super.dispose()}};Qne=Bg([Ki(5,ct),Ki(6,Ic),Ki(7,At),Ki(8,Xe)],Qne);let Yne=class extends H8{constructor(e,t,i,n,r,o,a,l,c,d){const u=typeof o.horizontalScrolling<"u"?o.horizontalScrolling:!!c.getValue(pc),[h,g]=d.invokeFunction(YF,o);super(e,t,i,n,r,{keyboardSupport:!1,...h,horizontalScrolling:u}),this.disposables.add(g),this.contextKeyService=GF(a,this),this.disposables.add(QF(this.contextKeyService,this)),this.listSupportsMultiSelect=qF.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(o.multipleSelectionSupport!==!1),KF.bindTo(this.contextKeyService).set(!!o.selectionNavigation),this.listHasSelectionOrFocus=oG.bindTo(this.contextKeyService),this.listDoubleSelection=aG.bindTo(this.contextKeyService),this.listMultiSelection=lG.bindTo(this.contextKeyService),this.horizontalScrolling=o.horizontalScrolling,this._useAltAsMultipleSelectionModifier=Bh(c),this.disposables.add(this.contextKeyService),this.disposables.add(l.register(this)),this.updateStyles(o.overrideStyles),this.disposables.add(this.onDidChangeSelection(()=>{const _=this.getSelection(),v=this.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.listHasSelectionOrFocus.set(_.length>0||v.length>0),this.listMultiSelection.set(_.length>1),this.listDoubleSelection.set(_.length===2)})})),this.disposables.add(this.onDidChangeFocus(()=>{const _=this.getSelection(),v=this.getFocus();this.listHasSelectionOrFocus.set(_.length>0||v.length>0)})),this.disposables.add(c.onDidChangeConfiguration(_=>{_.affectsConfiguration(Xw)&&(this._useAltAsMultipleSelectionModifier=Bh(c));let v={};if(_.affectsConfiguration(pc)&&this.horizontalScrolling===void 0){const C=!!c.getValue(pc);v={...v,horizontalScrolling:C}}if(_.affectsConfiguration(gu)){const C=!!c.getValue(gu);v={...v,scrollByPage:C}}if(_.affectsConfiguration(pu)){const C=!!c.getValue(pu);v={...v,smoothScrolling:C}}if(_.affectsConfiguration(Fh)){const C=c.getValue(Fh);v={...v,mouseWheelScrollSensitivity:C}}if(_.affectsConfiguration(Vh)){const C=c.getValue(Vh);v={...v,fastScrollSensitivity:C}}Object.keys(v).length>0&&this.updateOptions(v)})),this.navigator=new XWe(this,{configurationService:c,...o}),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles!==void 0&&this.updateStyles(e.overrideStyles),e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){this.style(e?Qw(e):Gw)}dispose(){this.disposables.dispose(),super.dispose()}};Yne=Bg([Ki(6,ct),Ki(7,Ic),Ki(8,At),Ki(9,Xe)],Yne);class gG extends te{constructor(e,t){super(),this.widget=e,this._onDidOpen=this._register(new Z),this.onDidOpen=this._onDidOpen.event,this._register(De.filter(this.widget.onDidChangeSelection,i=>Df(i.browserEvent))(i=>this.onSelectionFromKeyboard(i))),this._register(this.widget.onPointer(i=>this.onPointer(i.element,i.browserEvent))),this._register(this.widget.onMouseDblClick(i=>this.onMouseDblClick(i.element,i.browserEvent))),typeof(t==null?void 0:t.openOnSingleClick)!="boolean"&&(t!=null&&t.configurationService)?(this.openOnSingleClick=(t==null?void 0:t.configurationService.getValue(WR))!=="doubleClick",this._register(t==null?void 0:t.configurationService.onDidChangeConfiguration(i=>{i.affectsConfiguration(WR)&&(this.openOnSingleClick=(t==null?void 0:t.configurationService.getValue(WR))!=="doubleClick")}))):this.openOnSingleClick=(t==null?void 0:t.openOnSingleClick)??!0}onSelectionFromKeyboard(e){if(e.elements.length!==1)return;const t=e.browserEvent,i=typeof t.preserveFocus=="boolean"?t.preserveFocus:!0,n=typeof t.pinned=="boolean"?t.pinned:!i;this._open(this.getSelectedElement(),i,n,!1,e.browserEvent)}onPointer(e,t){if(!this.openOnSingleClick||t.detail===2)return;const n=t.button===1,r=!0,o=n,a=t.ctrlKey||t.metaKey||t.altKey;this._open(e,r,o,a,t)}onMouseDblClick(e,t){if(!t)return;const i=t.target;if(i.classList.contains("monaco-tl-twistie")||i.classList.contains("monaco-icon-label")&&i.classList.contains("folder-icon")&&t.offsetX<16)return;const r=!1,o=!0,a=t.ctrlKey||t.metaKey||t.altKey;this._open(e,r,o,a,t)}_open(e,t,i,n,r){e&&this._onDidOpen.fire({editorOptions:{preserveFocus:t,pinned:i,revealIfVisible:!0},sideBySide:n,element:e,browserEvent:r})}}class _pe extends gG{constructor(e,t){super(e,t),this.widget=e}getSelectedElement(){return this.widget.getSelectedElements()[0]}}class XWe extends gG{constructor(e,t){super(e,t)}getSelectedElement(){return this.widget.getSelectedElements()[0]}}class ZWe extends gG{constructor(e,t){super(e,t)}getSelectedElement(){return this.widget.getSelection()[0]??void 0}}function JWe(s){let e=!1;return t=>{if(t.toKeyCodeChord().isModifierKey())return!1;if(e)return e=!1,!1;const i=s.softDispatch(t,t.target);return i.kind===1?(e=!0,!1):(e=!1,i.kind===0)}}let q8=class extends nG{constructor(e,t,i,n,r,o,a,l,c){const{options:d,getTypeNavigationMode:u,disposable:h}=o.invokeFunction(lD,r);super(e,t,i,n,d),this.disposables.add(h),this.internals=new Cw(this,r,u,r.overrideStyles,a,l,c),this.disposables.add(this.internals)}updateOptions(e){super.updateOptions(e),this.internals.updateOptions(e)}};q8=Bg([Ki(5,Xe),Ki(6,ct),Ki(7,Ic),Ki(8,At)],q8);let Xne=class extends ope{constructor(e,t,i,n,r,o,a,l,c){const{options:d,getTypeNavigationMode:u,disposable:h}=o.invokeFunction(lD,r);super(e,t,i,n,d),this.disposables.add(h),this.internals=new Cw(this,r,u,r.overrideStyles,a,l,c),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};Xne=Bg([Ki(5,Xe),Ki(6,ct),Ki(7,Ic),Ki(8,At)],Xne);let Zne=class extends jWe{constructor(e,t,i,n,r,o,a,l,c,d){const{options:u,getTypeNavigationMode:h,disposable:g}=a.invokeFunction(lD,o);super(e,t,i,n,r,u),this.disposables.add(g),this.internals=new Cw(this,o,h,o.overrideStyles,l,c,d),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles!==void 0&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};Zne=Bg([Ki(6,Xe),Ki(7,ct),Ki(8,Ic),Ki(9,At)],Zne);let K8=class extends lpe{get onDidOpen(){return this.internals.onDidOpen}constructor(e,t,i,n,r,o,a,l,c,d){const{options:u,getTypeNavigationMode:h,disposable:g}=a.invokeFunction(lD,o);super(e,t,i,n,r,u),this.disposables.add(g),this.internals=new Cw(this,o,h,o.overrideStyles,l,c,d),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};K8=Bg([Ki(6,Xe),Ki(7,ct),Ki(8,Ic),Ki(9,At)],K8);let Jne=class extends zWe{constructor(e,t,i,n,r,o,a,l,c,d,u){const{options:h,getTypeNavigationMode:g,disposable:p}=l.invokeFunction(lD,a);super(e,t,i,n,r,o,h),this.disposables.add(p),this.internals=new Cw(this,a,g,a.overrideStyles,c,d,u),this.disposables.add(this.internals)}updateOptions(e){super.updateOptions(e),this.internals.updateOptions(e)}};Jne=Bg([Ki(7,Xe),Ki(8,ct),Ki(9,Ic),Ki(10,At)],Jne);function bpe(s){const e=s.getValue(uG);if(e==="highlight")return Yf.Highlight;if(e==="filter")return Yf.Filter;const t=s.getValue(zA);if(t==="simple"||t==="highlight")return Yf.Highlight;if(t==="filter")return Yf.Filter}function vpe(s){const e=s.getValue(fG);if(e==="fuzzy")return ww.Fuzzy;if(e==="contiguous")return ww.Contiguous}function lD(s,e){const t=s.get(At),i=s.get(Fg),n=s.get(ct),r=s.get(Xe),o=()=>{const h=n.getContextKeyValue(ppe);if(h==="automatic")return dh.Automatic;if(h==="trigger"||n.getContextKeyValue(mpe)===!1)return dh.Trigger;const p=t.getValue(hG);if(p==="automatic")return dh.Automatic;if(p==="trigger")return dh.Trigger},a=e.horizontalScrolling!==void 0?e.horizontalScrolling:!!t.getValue(pc),[l,c]=r.invokeFunction(YF,e),d=e.paddingBottom,u=e.renderIndentGuides!==void 0?e.renderIndentGuides:t.getValue(UA);return{getTypeNavigationMode:o,disposable:c,options:{keyboardSupport:!1,...l,indent:typeof t.getValue(AI)=="number"?t.getValue(AI):void 0,renderIndentGuides:u,smoothScrolling:!!t.getValue(pu),defaultFindMode:bpe(t),defaultFindMatchType:vpe(t),horizontalScrolling:a,scrollByPage:!!t.getValue(gu),paddingBottom:d,hideTwistiesOfChildlessElements:e.hideTwistiesOfChildlessElements,expandOnlyOnTwistieClick:e.expandOnlyOnTwistieClick??t.getValue(jA)==="doubleClick",contextViewProvider:i,findWidgetStyles:nVe,enableStickyScroll:!!t.getValue($A),stickyScrollMaxItemCount:Number(t.getValue(qA))}}}let Cw=class{get onDidOpen(){return this.navigator.onDidOpen}constructor(e,t,i,n,r,o,a){this.tree=e,this.disposables=[],this.contextKeyService=GF(r,e),this.disposables.push(QF(this.contextKeyService,e)),this.listSupportsMultiSelect=qF.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(t.multipleSelectionSupport!==!1),KF.bindTo(this.contextKeyService).set(!!t.selectionNavigation),this.listSupportFindWidget=qWe.bindTo(this.contextKeyService),this.listSupportFindWidget.set(t.findWidgetEnabled??!0),this.hasSelectionOrFocus=oG.bindTo(this.contextKeyService),this.hasDoubleSelection=aG.bindTo(this.contextKeyService),this.hasMultiSelection=lG.bindTo(this.contextKeyService),this.treeElementCanCollapse=cG.bindTo(this.contextKeyService),this.treeElementHasParent=KWe.bindTo(this.contextKeyService),this.treeElementCanExpand=dG.bindTo(this.contextKeyService),this.treeElementHasChild=GWe.bindTo(this.contextKeyService),this.treeFindOpen=QWe.bindTo(this.contextKeyService),this.treeStickyScrollFocused=fpe.bindTo(this.contextKeyService),this._useAltAsMultipleSelectionModifier=Bh(a),this.updateStyleOverrides(n);const c=()=>{const u=e.getFocus()[0];if(!u)return;const h=e.getNode(u);this.treeElementCanCollapse.set(h.collapsible&&!h.collapsed),this.treeElementHasParent.set(!!e.getParentElement(u)),this.treeElementCanExpand.set(h.collapsible&&h.collapsed),this.treeElementHasChild.set(!!e.getFirstElementChild(u))},d=new Set;d.add(ppe),d.add(mpe),this.disposables.push(this.contextKeyService,o.register(e),e.onDidChangeSelection(()=>{const u=e.getSelection(),h=e.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.hasSelectionOrFocus.set(u.length>0||h.length>0),this.hasMultiSelection.set(u.length>1),this.hasDoubleSelection.set(u.length===2)})}),e.onDidChangeFocus(()=>{const u=e.getSelection(),h=e.getFocus();this.hasSelectionOrFocus.set(u.length>0||h.length>0),c()}),e.onDidChangeCollapseState(c),e.onDidChangeModel(c),e.onDidChangeFindOpenState(u=>this.treeFindOpen.set(u)),e.onDidChangeStickyScrollFocused(u=>this.treeStickyScrollFocused.set(u)),a.onDidChangeConfiguration(u=>{let h={};if(u.affectsConfiguration(Xw)&&(this._useAltAsMultipleSelectionModifier=Bh(a)),u.affectsConfiguration(AI)){const g=a.getValue(AI);h={...h,indent:g}}if(u.affectsConfiguration(UA)&&t.renderIndentGuides===void 0){const g=a.getValue(UA);h={...h,renderIndentGuides:g}}if(u.affectsConfiguration(pu)){const g=!!a.getValue(pu);h={...h,smoothScrolling:g}}if(u.affectsConfiguration(uG)||u.affectsConfiguration(zA)){const g=bpe(a);h={...h,defaultFindMode:g}}if(u.affectsConfiguration(hG)||u.affectsConfiguration(zA)){const g=i();h={...h,typeNavigationMode:g}}if(u.affectsConfiguration(fG)){const g=vpe(a);h={...h,defaultFindMatchType:g}}if(u.affectsConfiguration(pc)&&t.horizontalScrolling===void 0){const g=!!a.getValue(pc);h={...h,horizontalScrolling:g}}if(u.affectsConfiguration(gu)){const g=!!a.getValue(gu);h={...h,scrollByPage:g}}if(u.affectsConfiguration(jA)&&t.expandOnlyOnTwistieClick===void 0&&(h={...h,expandOnlyOnTwistieClick:a.getValue(jA)==="doubleClick"}),u.affectsConfiguration($A)){const g=a.getValue($A);h={...h,enableStickyScroll:g}}if(u.affectsConfiguration(qA)){const g=Math.max(1,a.getValue(qA));h={...h,stickyScrollMaxItemCount:g}}if(u.affectsConfiguration(Fh)){const g=a.getValue(Fh);h={...h,mouseWheelScrollSensitivity:g}}if(u.affectsConfiguration(Vh)){const g=a.getValue(Vh);h={...h,fastScrollSensitivity:g}}Object.keys(h).length>0&&e.updateOptions(h)}),this.contextKeyService.onDidChangeContext(u=>{u.affectsSome(d)&&e.updateOptions({typeNavigationMode:i()})})),this.navigator=new ZWe(e,{configurationService:a,...t}),this.disposables.push(this.navigator)}updateOptions(e){e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyleOverrides(e){this.tree.style(e?Qw(e):Gw)}dispose(){this.disposables=Ni(this.disposables)}};Cw=Bg([Ki(4,ct),Ki(5,Ic),Ki(6,At)],Cw);const e6e=_n.as(pd.Configuration);e6e.registerConfiguration({id:"workbench",order:7,title:b("workbenchConfigurationTitle","Workbench"),type:"object",properties:{[Xw]:{type:"string",enum:["ctrlCmd","alt"],markdownEnumDescriptions:[b("multiSelectModifier.ctrlCmd","Maps to `Control` on Windows and Linux and to `Command` on macOS."),b("multiSelectModifier.alt","Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],default:"ctrlCmd",description:b({key:"multiSelectModifier",comment:["- `ctrlCmd` refers to a value the setting can take and should not be localized.","- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized."]},"The modifier to be used to add an item in trees and lists to a multi-selection with the mouse (for example in the explorer, open editors and scm view). The 'Open to Side' mouse gestures - if supported - will adapt such that they do not conflict with the multiselect modifier.")},[WR]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:b({key:"openModeModifier",comment:["`singleClick` and `doubleClick` refers to a value the setting can take and should not be localized."]},"Controls how to open items in trees and lists using the mouse (if supported). Note that some trees and lists might choose to ignore this setting if it is not applicable.")},[pc]:{type:"boolean",default:!1,description:b("horizontalScrolling setting","Controls whether lists and trees support horizontal scrolling in the workbench. Warning: turning on this setting has a performance implication.")},[gu]:{type:"boolean",default:!1,description:b("list.scrollByPage","Controls whether clicks in the scrollbar scroll page by page.")},[AI]:{type:"number",default:8,minimum:4,maximum:40,description:b("tree indent setting","Controls tree indentation in pixels.")},[UA]:{type:"string",enum:["none","onHover","always"],default:"onHover",description:b("render tree indent guides","Controls whether the tree should render indent guides.")},[pu]:{type:"boolean",default:!1,description:b("list smoothScrolling setting","Controls whether lists and trees have smooth scrolling.")},[Fh]:{type:"number",default:1,markdownDescription:b("Mouse Wheel Scroll Sensitivity","A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")},[Vh]:{type:"number",default:5,markdownDescription:b("Fast Scroll Sensitivity","Scrolling speed multiplier when pressing `Alt`.")},[uG]:{type:"string",enum:["highlight","filter"],enumDescriptions:[b("defaultFindModeSettingKey.highlight","Highlight elements when searching. Further up and down navigation will traverse only the highlighted elements."),b("defaultFindModeSettingKey.filter","Filter elements when searching.")],default:"highlight",description:b("defaultFindModeSettingKey","Controls the default find mode for lists and trees in the workbench.")},[zA]:{type:"string",enum:["simple","highlight","filter"],enumDescriptions:[b("keyboardNavigationSettingKey.simple","Simple keyboard navigation focuses elements which match the keyboard input. Matching is done only on prefixes."),b("keyboardNavigationSettingKey.highlight","Highlight keyboard navigation highlights elements which match the keyboard input. Further up and down navigation will traverse only the highlighted elements."),b("keyboardNavigationSettingKey.filter","Filter keyboard navigation will filter out and hide all the elements which do not match the keyboard input.")],default:"highlight",description:b("keyboardNavigationSettingKey","Controls the keyboard navigation style for lists and trees in the workbench. Can be simple, highlight and filter."),deprecated:!0,deprecationMessage:b("keyboardNavigationSettingKeyDeprecated","Please use 'workbench.list.defaultFindMode' and	'workbench.list.typeNavigationMode' instead.")},[fG]:{type:"string",enum:["fuzzy","contiguous"],enumDescriptions:[b("defaultFindMatchTypeSettingKey.fuzzy","Use fuzzy matching when searching."),b("defaultFindMatchTypeSettingKey.contiguous","Use contiguous matching when searching.")],default:"fuzzy",description:b("defaultFindMatchTypeSettingKey","Controls the type of matching used when searching lists and trees in the workbench.")},[jA]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:b("expand mode","Controls how tree folders are expanded when clicking the folder names. Note that some trees and lists might choose to ignore this setting if it is not applicable.")},[$A]:{type:"boolean",default:!0,description:b("sticky scroll","Controls whether sticky scrolling is enabled in trees.")},[qA]:{type:"number",minimum:1,default:7,markdownDescription:b("sticky scroll maximum items","Controls the number of sticky elements displayed in the tree when {0} is enabled.","`#workbench.tree.enableStickyScroll#`")},[hG]:{type:"string",enum:["automatic","trigger"],default:"automatic",markdownDescription:b("typeNavigationMode2","Controls how type navigation works in lists and trees in the workbench. When set to `trigger`, type navigation begins once the `list.triggerTypeNavigation` command is run.")}}});class fm extends te{constructor(e,t){super(),this.options=t,this.text="",this.title="",this.highlights=[],this.didEverRender=!1,this.supportIcons=(t==null?void 0:t.supportIcons)??!1,this.domNode=me(e,ke("span.monaco-highlighted-label"))}get element(){return this.domNode}set(e,t=[],i="",n){e||(e=""),n&&(e=fm.escapeNewLines(e,t)),!(this.didEverRender&&this.text===e&&this.title===i&&Ta(this.highlights,t))&&(this.text=e,this.title=i,this.highlights=t,this.render())}render(){var i,n,r;const e=[];let t=0;for(const o of this.highlights){if(o.end===o.start)continue;if(t<o.start){const c=this.text.substring(t,o.start);this.supportIcons?e.push(...dm(c)):e.push(c),t=o.start}const a=this.text.substring(t,o.end),l=ke("span.highlight",void 0,...this.supportIcons?dm(a):[a]);o.extraClasses&&l.classList.add(...o.extraClasses),e.push(l),t=o.end}if(t<this.text.length){const o=this.text.substring(t);this.supportIcons?e.push(...dm(o)):e.push(o)}if(Xs(this.domNode,...e),(n=(i=this.options)==null?void 0:i.hoverDelegate)!=null&&n.showNativeHover)this.domNode.title=this.title;else if(!this.customHover&&this.title!==""){const o=((r=this.options)==null?void 0:r.hoverDelegate)??No("mouse");this.customHover=this._register(wu().setupManagedHover(o,this.domNode,this.title))}else this.customHover&&this.customHover.update(this.title);this.didEverRender=!0}static escapeNewLines(e,t){let i=0,n=0;return e.replace(/\r\n|\r|\n/g,(r,o)=>{n=r===`\r
`?-1:0,o+=i;for(const a of t)a.end<=o||(a.start>=o&&(a.start+=n),a.end>=o&&(a.end+=n));return i+=n,"⏎"})}}class Rx{constructor(e){this._element=e}get element(){return this._element}set textContent(e){this.disposed||e===this._textContent||(this._textContent=e,this._element.textContent=e)}set classNames(e){this.disposed||Ta(e,this._classNames)||(this._classNames=e,this._element.classList.value="",this._element.classList.add(...e))}set empty(e){this.disposed||e===this._empty||(this._empty=e,this._element.style.marginLeft=e?"0":"")}dispose(){this.disposed=!0}}class KA extends te{constructor(e,t){super(),this.customHovers=new Map,this.creationOptions=t,this.domNode=this._register(new Rx(me(e,ke(".monaco-icon-label")))),this.labelContainer=me(this.domNode.element,ke(".monaco-icon-label-container")),this.nameContainer=me(this.labelContainer,ke("span.monaco-icon-name-container")),t!=null&&t.supportHighlights||t!=null&&t.supportIcons?this.nameNode=this._register(new n6e(this.nameContainer,!!t.supportIcons)):this.nameNode=new t6e(this.nameContainer),this.hoverDelegate=(t==null?void 0:t.hoverDelegate)??No("mouse")}get element(){return this.domNode.element}setLabel(e,t,i){const n=["monaco-icon-label"],r=["monaco-icon-label-container"];let o="";i&&(i.extraClasses&&n.push(...i.extraClasses),i.italic&&n.push("italic"),i.strikethrough&&n.push("strikethrough"),i.disabledCommand&&r.push("disabled"),i.title&&(typeof i.title=="string"?o+=i.title:o+=e));const a=this.domNode.element.querySelector(".monaco-icon-label-iconpath");if(i!=null&&i.iconPath){let l;!a||!Ls(a)?(l=ke(".monaco-icon-label-iconpath"),this.domNode.element.prepend(l)):l=a,l.style.backgroundImage=xg(i==null?void 0:i.iconPath)}else a&&a.remove();if(this.domNode.classNames=n,this.domNode.element.setAttribute("aria-label",o),this.labelContainer.classList.value="",this.labelContainer.classList.add(...r),this.setupHover(i!=null&&i.descriptionTitle?this.labelContainer:this.element,i==null?void 0:i.title),this.nameNode.setLabel(e,i),t||this.descriptionNode){const l=this.getOrCreateDescriptionNode();l instanceof fm?(l.set(t||"",i?i.descriptionMatches:void 0,void 0,i==null?void 0:i.labelEscapeNewLines),this.setupHover(l.element,i==null?void 0:i.descriptionTitle)):(l.textContent=t&&(i!=null&&i.labelEscapeNewLines)?fm.escapeNewLines(t,[]):t||"",this.setupHover(l.element,(i==null?void 0:i.descriptionTitle)||""),l.empty=!t)}if(i!=null&&i.suffix||this.suffixNode){const l=this.getOrCreateSuffixNode();l.textContent=(i==null?void 0:i.suffix)??""}}setupHover(e,t){const i=this.customHovers.get(e);if(i&&(i.dispose(),this.customHovers.delete(e)),!t){e.removeAttribute("title");return}if(this.hoverDelegate.showNativeHover)(function(r,o){Zo(o)?r.title=LK(o):o!=null&&o.markdownNotSupportedFallback?r.title=o.markdownNotSupportedFallback:r.removeAttribute("title")})(e,t);else{const n=wu().setupManagedHover(this.hoverDelegate,e,t);n&&this.customHovers.set(e,n)}}dispose(){super.dispose();for(const e of this.customHovers.values())e.dispose();this.customHovers.clear()}getOrCreateSuffixNode(){if(!this.suffixNode){const e=this._register(new Rx(sAe(this.nameContainer,ke("span.monaco-icon-suffix-container"))));this.suffixNode=this._register(new Rx(me(e.element,ke("span.label-suffix"))))}return this.suffixNode}getOrCreateDescriptionNode(){var e;if(!this.descriptionNode){const t=this._register(new Rx(me(this.labelContainer,ke("span.monaco-icon-description-container"))));(e=this.creationOptions)!=null&&e.supportDescriptionHighlights?this.descriptionNode=this._register(new fm(me(t.element,ke("span.label-description")),{supportIcons:!!this.creationOptions.supportIcons})):this.descriptionNode=this._register(new Rx(me(t.element,ke("span.label-description"))))}return this.descriptionNode}}class t6e{constructor(e){this.container=e,this.label=void 0,this.singleLabel=void 0}setLabel(e,t){if(!(this.label===e&&Ta(this.options,t)))if(this.label=e,this.options=t,typeof e=="string")this.singleLabel||(this.container.innerText="",this.container.classList.remove("multiple"),this.singleLabel=me(this.container,ke("a.label-name",{id:t==null?void 0:t.domId}))),this.singleLabel.textContent=e;else{this.container.innerText="",this.container.classList.add("multiple"),this.singleLabel=void 0;for(let i=0;i<e.length;i++){const n=e[i],r=(t==null?void 0:t.domId)&&`${t==null?void 0:t.domId}_${i}`;me(this.container,ke("a.label-name",{id:r,"data-icon-label-count":e.length,"data-icon-label-index":i,role:"treeitem"},n)),i<e.length-1&&me(this.container,ke("span.label-separator",void 0,(t==null?void 0:t.separator)||"/"))}}}}function i6e(s,e,t){if(!t)return;let i=0;return s.map(n=>{const r={start:i,end:i+n.length},o=t.map(a=>yr.intersect(r,a)).filter(a=>!yr.isEmpty(a)).map(({start:a,end:l})=>({start:a-i,end:l-i}));return i=r.end+e.length,o})}class n6e extends te{constructor(e,t){super(),this.container=e,this.supportIcons=t,this.label=void 0,this.singleLabel=void 0}setLabel(e,t){if(!(this.label===e&&Ta(this.options,t)))if(this.label=e,this.options=t,typeof e=="string")this.singleLabel||(this.container.innerText="",this.container.classList.remove("multiple"),this.singleLabel=this._register(new fm(me(this.container,ke("a.label-name",{id:t==null?void 0:t.domId})),{supportIcons:this.supportIcons}))),this.singleLabel.set(e,t==null?void 0:t.matches,void 0,t==null?void 0:t.labelEscapeNewLines);else{this.container.innerText="",this.container.classList.add("multiple"),this.singleLabel=void 0;const i=(t==null?void 0:t.separator)||"/",n=i6e(e,i,t==null?void 0:t.matches);for(let r=0;r<e.length;r++){const o=e[r],a=n?n[r]:void 0,l=(t==null?void 0:t.domId)&&`${t==null?void 0:t.domId}_${r}`,c=ke("a.label-name",{id:l,"data-icon-label-count":e.length,"data-icon-label-index":r,role:"treeitem"});this._register(new fm(me(this.container,c),{supportIcons:this.supportIcons})).set(o,a,void 0,t==null?void 0:t.labelEscapeNewLines),r<e.length-1&&me(c,ke("span.label-separator",void 0,i))}}}}const kN=ke,wpe={keybindingLabelBackground:void 0,keybindingLabelForeground:void 0,keybindingLabelBorder:void 0,keybindingLabelBottomBorder:void 0,keybindingLabelShadow:void 0};class SS extends te{constructor(e,t,i){super(),this.os=t,this.keyElements=new Set,this.options=i||Object.create(null);const n=this.options.keybindingLabelForeground;this.domNode=me(e,kN(".monaco-keybinding")),n&&(this.domNode.style.color=n),this.hover=this._register(wu().setupManagedHover(No("mouse"),this.domNode,"")),this.didEverRender=!1,e.appendChild(this.domNode)}get element(){return this.domNode}set(e,t){this.didEverRender&&this.keybinding===e&&SS.areSame(this.matches,t)||(this.keybinding=e,this.matches=t,this.render())}render(){if(this.clear(),this.keybinding){const e=this.keybinding.getChords();e[0]&&this.renderChord(this.domNode,e[0],this.matches?this.matches.firstPart:null);for(let i=1;i<e.length;i++)me(this.domNode,kN("span.monaco-keybinding-key-chord-separator",void 0," ")),this.renderChord(this.domNode,e[i],this.matches?this.matches.chordPart:null);const t=this.options.disableTitle??!1?void 0:this.keybinding.getAriaLabel()||void 0;this.hover.update(t),this.domNode.setAttribute("aria-label",t||"")}else this.options&&this.options.renderUnboundKeybindings&&this.renderUnbound(this.domNode);this.didEverRender=!0}clear(){Ys(this.domNode),this.keyElements.clear()}renderChord(e,t,i){const n=NK.modifierLabels[this.os];t.ctrlKey&&this.renderKey(e,n.ctrlKey,!!(i!=null&&i.ctrlKey),n.separator),t.shiftKey&&this.renderKey(e,n.shiftKey,!!(i!=null&&i.shiftKey),n.separator),t.altKey&&this.renderKey(e,n.altKey,!!(i!=null&&i.altKey),n.separator),t.metaKey&&this.renderKey(e,n.metaKey,!!(i!=null&&i.metaKey),n.separator);const r=t.keyLabel;r&&this.renderKey(e,r,!!(i!=null&&i.keyCode),"")}renderKey(e,t,i,n){me(e,this.createKeyElement(t,i?".highlight":"")),n&&me(e,kN("span.monaco-keybinding-key-separator",void 0,n))}renderUnbound(e){me(e,this.createKeyElement(b("unbound","Unbound")))}createKeyElement(e,t=""){const i=kN("span.monaco-keybinding-key"+t,void 0,e);return this.keyElements.add(i),this.options.keybindingLabelBackground&&(i.style.backgroundColor=this.options.keybindingLabelBackground),this.options.keybindingLabelBorder&&(i.style.borderColor=this.options.keybindingLabelBorder),this.options.keybindingLabelBottomBorder&&(i.style.borderBottomColor=this.options.keybindingLabelBottomBorder),this.options.keybindingLabelShadow&&(i.style.boxShadow=`inset 0 -1px 0 ${this.options.keybindingLabelShadow}`),i}static areSame(e,t){return e===t||!e&&!t?!0:!!e&&!!t&&Ta(e.firstPart,t.firstPart)&&Ta(e.chordPart,t.chordPart)}}const ese=new uu(()=>{const s=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return{collator:s,collatorIsNumeric:s.resolvedOptions().numeric}});function s6e(s,e,t=!1){const i=s||"",n=e||"",r=ese.value.collator.compare(i,n);return ese.value.collatorIsNumeric&&r===0&&i!==n?i<n?-1:1:r}function r6e(s,e,t){const i=s.toLowerCase(),n=e.toLowerCase(),r=o6e(s,e,t);if(r)return r;const o=i.endsWith(t),a=n.endsWith(t);if(o!==a)return o?-1:1;const l=s6e(i,n);return l!==0?l:i.localeCompare(n)}function o6e(s,e,t){const i=s.toLowerCase(),n=e.toLowerCase(),r=i.startsWith(t),o=n.startsWith(t);if(r!==o)return r?-1:1;if(r&&o){if(i.length<n.length)return-1;if(i.length>n.length)return 1}return 0}var XF=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},G8=function(s,e){return function(t,i){e(t,i,s)}},Q8;const Ad=ke;class Cpe{constructor(e,t,i){this.index=e,this.hasCheckbox=t,this._hidden=!1,this._init=new uu(()=>{const n=i.label??"",r=iL(n).text.trim(),o=i.ariaLabel||[n,this.saneDescription,this.saneDetail].map(a=>g5e(a)).filter(a=>!!a).join(", ");return{saneLabel:n,saneSortLabel:r,saneAriaLabel:o}}),this._saneDescription=i.description,this._saneTooltip=i.tooltip}get saneLabel(){return this._init.value.saneLabel}get saneSortLabel(){return this._init.value.saneSortLabel}get saneAriaLabel(){return this._init.value.saneAriaLabel}get element(){return this._element}set element(e){this._element=e}get hidden(){return this._hidden}set hidden(e){this._hidden=e}get saneDescription(){return this._saneDescription}set saneDescription(e){this._saneDescription=e}get saneDetail(){return this._saneDetail}set saneDetail(e){this._saneDetail=e}get saneTooltip(){return this._saneTooltip}set saneTooltip(e){this._saneTooltip=e}get labelHighlights(){return this._labelHighlights}set labelHighlights(e){this._labelHighlights=e}get descriptionHighlights(){return this._descriptionHighlights}set descriptionHighlights(e){this._descriptionHighlights=e}get detailHighlights(){return this._detailHighlights}set detailHighlights(e){this._detailHighlights=e}}class nr extends Cpe{constructor(e,t,i,n,r,o){var a,l,c;super(e,t,r),this.fireButtonTriggered=i,this._onChecked=n,this.item=r,this._separator=o,this._checked=!1,this.onChecked=t?De.map(De.filter(this._onChecked.event,d=>d.element===this),d=>d.checked):De.None,this._saneDetail=r.detail,this._labelHighlights=(a=r.highlights)==null?void 0:a.label,this._descriptionHighlights=(l=r.highlights)==null?void 0:l.description,this._detailHighlights=(c=r.highlights)==null?void 0:c.detail}get separator(){return this._separator}set separator(e){this._separator=e}get checked(){return this._checked}set checked(e){e!==this._checked&&(this._checked=e,this._onChecked.fire({element:this,checked:e}))}get checkboxDisabled(){return!!this.item.disabled}}var nh;(function(s){s[s.NONE=0]="NONE",s[s.MOUSE_HOVER=1]="MOUSE_HOVER",s[s.ACTIVE_ITEM=2]="ACTIVE_ITEM"})(nh||(nh={}));class lb extends Cpe{constructor(e,t,i){super(e,!1,i),this.fireSeparatorButtonTriggered=t,this.separator=i,this.children=new Array,this.focusInsideSeparator=nh.NONE}}class a6e{getHeight(e){return e instanceof lb?30:e.saneDetail?44:22}getTemplateId(e){return e instanceof nr?GA.ID:QA.ID}}class l6e{getWidgetAriaLabel(){return b("quickInput","Quick Input")}getAriaLabel(e){var t;return(t=e.separator)!=null&&t.label?`${e.saneAriaLabel}, ${e.separator.label}`:e.saneAriaLabel}getWidgetRole(){return"listbox"}getRole(e){return e.hasCheckbox?"checkbox":"option"}isChecked(e){if(!(!e.hasCheckbox||!(e instanceof nr)))return{get value(){return e.checked},onDidChange:t=>e.onChecked(()=>t())}}}class ype{constructor(e){this.hoverDelegate=e}renderTemplate(e){const t=Object.create(null);t.toDisposeElement=new ce,t.toDisposeTemplate=new ce,t.entry=me(e,Ad(".quick-input-list-entry"));const i=me(t.entry,Ad("label.quick-input-list-label"));t.toDisposeTemplate.add(yn(i,Le.CLICK,c=>{t.checkbox.offsetParent||c.preventDefault()})),t.checkbox=me(i,Ad("input.quick-input-list-checkbox")),t.checkbox.type="checkbox";const n=me(i,Ad(".quick-input-list-rows")),r=me(n,Ad(".quick-input-list-row")),o=me(n,Ad(".quick-input-list-row"));t.label=new KA(r,{supportHighlights:!0,supportDescriptionHighlights:!0,supportIcons:!0,hoverDelegate:this.hoverDelegate}),t.toDisposeTemplate.add(t.label),t.icon=zq(t.label.element,Ad(".quick-input-list-icon"));const a=me(r,Ad(".quick-input-list-entry-keybinding"));t.keybinding=new SS(a,Da),t.toDisposeTemplate.add(t.keybinding);const l=me(o,Ad(".quick-input-list-label-meta"));return t.detail=new KA(l,{supportHighlights:!0,supportIcons:!0,hoverDelegate:this.hoverDelegate}),t.toDisposeTemplate.add(t.detail),t.separator=me(t.entry,Ad(".quick-input-list-separator")),t.actionBar=new Dl(t.entry,this.hoverDelegate?{hoverDelegate:this.hoverDelegate}:void 0),t.actionBar.domNode.classList.add("quick-input-list-entry-action-bar"),t.toDisposeTemplate.add(t.actionBar),t}disposeTemplate(e){e.toDisposeElement.dispose(),e.toDisposeTemplate.dispose()}disposeElement(e,t,i){i.toDisposeElement.clear(),i.actionBar.clear()}}var cv;let GA=(cv=class extends ype{constructor(e,t){super(e),this.themeService=t,this._itemsWithSeparatorsFrequency=new Map}get templateId(){return Q8.ID}renderTemplate(e){const t=super.renderTemplate(e);return t.toDisposeTemplate.add(yn(t.checkbox,Le.CHANGE,i=>{t.element.checked=t.checkbox.checked})),t}renderElement(e,t,i){var h;const n=e.element;i.element=n,n.element=i.entry??void 0;const r=n.item;i.checkbox.checked=n.checked,i.toDisposeElement.add(n.onChecked(g=>i.checkbox.checked=g)),i.checkbox.disabled=n.checkboxDisabled;const{labelHighlights:o,descriptionHighlights:a,detailHighlights:l}=n;if(r.iconPath){const g=m1(this.themeService.getColorTheme().type)?r.iconPath.dark:r.iconPath.light??r.iconPath.dark,p=Je.revive(g);i.icon.className="quick-input-list-icon",i.icon.style.backgroundImage=xg(p)}else i.icon.style.backgroundImage="",i.icon.className=r.iconClass?`quick-input-list-icon ${r.iconClass}`:"";let c;!n.saneTooltip&&n.saneDescription&&(c={markdown:{value:n.saneDescription,supportThemeIcons:!0},markdownNotSupportedFallback:n.saneDescription});const d={matches:o||[],descriptionTitle:c,descriptionMatches:a||[],labelEscapeNewLines:!0};if(d.extraClasses=r.iconClasses,d.italic=r.italic,d.strikethrough=r.strikethrough,i.entry.classList.remove("quick-input-list-separator-as-item"),i.label.setLabel(n.saneLabel,n.saneDescription,d),i.keybinding.set(r.keybinding),n.saneDetail){let g;n.saneTooltip||(g={markdown:{value:n.saneDetail,supportThemeIcons:!0},markdownNotSupportedFallback:n.saneDetail}),i.detail.element.style.display="",i.detail.setLabel(n.saneDetail,void 0,{matches:l,title:g,labelEscapeNewLines:!0})}else i.detail.element.style.display="none";(h=n.separator)!=null&&h.label?(i.separator.textContent=n.separator.label,i.separator.style.display="",this.addItemWithSeparator(n)):i.separator.style.display="none",i.entry.classList.toggle("quick-input-list-separator-border",!!n.separator);const u=r.buttons;u&&u.length?(i.actionBar.push(u.map((g,p)=>UL(g,`id-${p}`,()=>n.fireButtonTriggered({button:g,item:n.item}))),{icon:!0,label:!1}),i.entry.classList.add("has-actions")):i.entry.classList.remove("has-actions")}disposeElement(e,t,i){this.removeItemWithSeparator(e.element),super.disposeElement(e,t,i)}isItemWithSeparatorVisible(e){return this._itemsWithSeparatorsFrequency.has(e)}addItemWithSeparator(e){this._itemsWithSeparatorsFrequency.set(e,(this._itemsWithSeparatorsFrequency.get(e)||0)+1)}removeItemWithSeparator(e){const t=this._itemsWithSeparatorsFrequency.get(e)||0;t>1?this._itemsWithSeparatorsFrequency.set(e,t-1):this._itemsWithSeparatorsFrequency.delete(e)}},Q8=cv,cv.ID="quickpickitem",cv);GA=Q8=XF([G8(1,gs)],GA);const eO=class eO extends ype{constructor(){super(...arguments),this._visibleSeparatorsFrequency=new Map}get templateId(){return eO.ID}get visibleSeparators(){return[...this._visibleSeparatorsFrequency.keys()]}isSeparatorVisible(e){return this._visibleSeparatorsFrequency.has(e)}renderTemplate(e){const t=super.renderTemplate(e);return t.checkbox.style.display="none",t}renderElement(e,t,i){const n=e.element;i.element=n,n.element=i.entry??void 0,n.element.classList.toggle("focus-inside",!!n.focusInsideSeparator);const r=n.separator,{labelHighlights:o,descriptionHighlights:a,detailHighlights:l}=n;i.icon.style.backgroundImage="",i.icon.className="";let c;!n.saneTooltip&&n.saneDescription&&(c={markdown:{value:n.saneDescription,supportThemeIcons:!0},markdownNotSupportedFallback:n.saneDescription});const d={matches:o||[],descriptionTitle:c,descriptionMatches:a||[],labelEscapeNewLines:!0};if(i.entry.classList.add("quick-input-list-separator-as-item"),i.label.setLabel(n.saneLabel,n.saneDescription,d),n.saneDetail){let h;n.saneTooltip||(h={markdown:{value:n.saneDetail,supportThemeIcons:!0},markdownNotSupportedFallback:n.saneDetail}),i.detail.element.style.display="",i.detail.setLabel(n.saneDetail,void 0,{matches:l,title:h,labelEscapeNewLines:!0})}else i.detail.element.style.display="none";i.separator.style.display="none",i.entry.classList.add("quick-input-list-separator-border");const u=r.buttons;u&&u.length?(i.actionBar.push(u.map((h,g)=>UL(h,`id-${g}`,()=>n.fireSeparatorButtonTriggered({button:h,separator:n.separator}))),{icon:!0,label:!1}),i.entry.classList.add("has-actions")):i.entry.classList.remove("has-actions"),this.addSeparator(n)}disposeElement(e,t,i){var n;this.removeSeparator(e.element),this.isSeparatorVisible(e.element)||(n=e.element.element)==null||n.classList.remove("focus-inside"),super.disposeElement(e,t,i)}addSeparator(e){this._visibleSeparatorsFrequency.set(e,(this._visibleSeparatorsFrequency.get(e)||0)+1)}removeSeparator(e){const t=this._visibleSeparatorsFrequency.get(e)||0;t>1?this._visibleSeparatorsFrequency.set(e,t-1):this._visibleSeparatorsFrequency.delete(e)}};eO.ID="quickpickseparator";let QA=eO,PI=class extends te{constructor(e,t,i,n,r,o){super(),this.parent=e,this.hoverDelegate=t,this.linkOpenerDelegate=i,this.accessibilityService=o,this._onKeyDown=new Z,this._onLeave=new Z,this.onLeave=this._onLeave.event,this._visibleCountObservable=Rt("VisibleCount",0),this.onChangedVisibleCount=De.fromObservable(this._visibleCountObservable,this._store),this._allVisibleCheckedObservable=Rt("AllVisibleChecked",!1),this.onChangedAllVisibleChecked=De.fromObservable(this._allVisibleCheckedObservable,this._store),this._checkedCountObservable=Rt("CheckedCount",0),this.onChangedCheckedCount=De.fromObservable(this._checkedCountObservable,this._store),this._checkedElementsObservable=l8({equalsFn:dn},new Array),this.onChangedCheckedElements=De.fromObservable(this._checkedElementsObservable,this._store),this._onButtonTriggered=new Z,this.onButtonTriggered=this._onButtonTriggered.event,this._onSeparatorButtonTriggered=new Z,this.onSeparatorButtonTriggered=this._onSeparatorButtonTriggered.event,this._elementChecked=new Z,this._elementCheckedEventBufferer=new BE,this._hasCheckboxes=!1,this._inputElements=new Array,this._elementTree=new Array,this._itemElements=new Array,this._elementDisposable=this._register(new ce),this._matchOnDescription=!1,this._matchOnDetail=!1,this._matchOnLabel=!0,this._matchOnLabelMode="fuzzy",this._sortByLabel=!0,this._shouldLoop=!0,this._container=me(this.parent,Ad(".quick-input-list")),this._separatorRenderer=new QA(t),this._itemRenderer=r.createInstance(GA,t),this._tree=this._register(r.createInstance(q8,"QuickInput",this._container,new a6e,[this._itemRenderer,this._separatorRenderer],{filter:{filter(a){return a.hidden?0:a instanceof lb?2:1}},sorter:{compare:(a,l)=>{if(!this.sortByLabel||!this._lastQueryString)return 0;const c=this._lastQueryString.toLowerCase();return d6e(a,l,c)}},accessibilityProvider:new l6e,setRowLineHeight:!1,multipleSelectionSupport:!1,hideTwistiesOfChildlessElements:!0,renderIndentGuides:D1.None,findWidgetEnabled:!1,indent:0,horizontalScrolling:!1,allowNonCollapsibleParents:!0,alwaysConsumeMouseWheel:!0})),this._tree.getHTMLElement().id=n,this._registerListeners()}get onDidChangeFocus(){return De.map(this._tree.onDidChangeFocus,e=>e.elements.filter(t=>t instanceof nr).map(t=>t.item),this._store)}get onDidChangeSelection(){return De.map(this._tree.onDidChangeSelection,e=>({items:e.elements.filter(t=>t instanceof nr).map(t=>t.item),event:e.browserEvent}),this._store)}get displayed(){return this._container.style.display!=="none"}set displayed(e){this._container.style.display=e?"":"none"}get scrollTop(){return this._tree.scrollTop}set scrollTop(e){this._tree.scrollTop=e}get ariaLabel(){return this._tree.ariaLabel}set ariaLabel(e){this._tree.ariaLabel=e??""}set enabled(e){this._tree.getHTMLElement().style.pointerEvents=e?"":"none"}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(e){this._matchOnDescription=e}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(e){this._matchOnDetail=e}get matchOnLabel(){return this._matchOnLabel}set matchOnLabel(e){this._matchOnLabel=e}get matchOnLabelMode(){return this._matchOnLabelMode}set matchOnLabelMode(e){this._matchOnLabelMode=e}get sortByLabel(){return this._sortByLabel}set sortByLabel(e){this._sortByLabel=e}get shouldLoop(){return this._shouldLoop}set shouldLoop(e){this._shouldLoop=e}_registerListeners(){this._registerOnKeyDown(),this._registerOnContainerClick(),this._registerOnMouseMiddleClick(),this._registerOnTreeModelChanged(),this._registerOnElementChecked(),this._registerOnContextMenu(),this._registerHoverListeners(),this._registerSelectionChangeListener(),this._registerSeparatorActionShowingListeners()}_registerOnKeyDown(){this._register(this._tree.onKeyDown(e=>{const t=new Mi(e);switch(t.keyCode){case 10:this.toggleCheckbox();break}this._onKeyDown.fire(t)}))}_registerOnContainerClick(){this._register(oe(this._container,Le.CLICK,e=>{(e.x||e.y)&&this._onLeave.fire()}))}_registerOnMouseMiddleClick(){this._register(oe(this._container,Le.AUXCLICK,e=>{e.button===1&&this._onLeave.fire()}))}_registerOnTreeModelChanged(){this._register(this._tree.onDidChangeModel(()=>{const e=this._itemElements.filter(t=>!t.hidden).length;this._visibleCountObservable.set(e,void 0),this._hasCheckboxes&&this._updateCheckedObservables()}))}_registerOnElementChecked(){this._register(this._elementCheckedEventBufferer.wrapEvent(this._elementChecked.event,(e,t)=>t)(e=>this._updateCheckedObservables()))}_registerOnContextMenu(){this._register(this._tree.onContextMenu(e=>{e.element&&(e.browserEvent.preventDefault(),this._tree.setSelection([e.element]))}))}_registerHoverListeners(){const e=this._register(new Vue(this.hoverDelegate.delay));this._register(this._tree.onMouseOver(async t=>{var i;if(ute(t.browserEvent.target)){e.cancel();return}if(!(!ute(t.browserEvent.relatedTarget)&&ys(t.browserEvent.relatedTarget,(i=t.element)==null?void 0:i.element)))try{await e.trigger(async()=>{t.element instanceof nr&&this.showHover(t.element)})}catch(n){if(!xc(n))throw n}})),this._register(this._tree.onMouseOut(t=>{var i;ys(t.browserEvent.relatedTarget,(i=t.element)==null?void 0:i.element)||e.cancel()}))}_registerSeparatorActionShowingListeners(){this._register(this._tree.onDidChangeFocus(e=>{const t=e.elements[0]?this._tree.getParentElement(e.elements[0]):null;for(const i of this._separatorRenderer.visibleSeparators){const n=i===t;!!(i.focusInsideSeparator&nh.ACTIVE_ITEM)!==n&&(n?i.focusInsideSeparator|=nh.ACTIVE_ITEM:i.focusInsideSeparator&=~nh.ACTIVE_ITEM,this._tree.rerender(i))}})),this._register(this._tree.onMouseOver(e=>{const t=e.element?this._tree.getParentElement(e.element):null;for(const i of this._separatorRenderer.visibleSeparators){if(i!==t)continue;!!(i.focusInsideSeparator&nh.MOUSE_HOVER)||(i.focusInsideSeparator|=nh.MOUSE_HOVER,this._tree.rerender(i))}})),this._register(this._tree.onMouseOut(e=>{const t=e.element?this._tree.getParentElement(e.element):null;for(const i of this._separatorRenderer.visibleSeparators){if(i!==t)continue;!!(i.focusInsideSeparator&nh.MOUSE_HOVER)&&(i.focusInsideSeparator&=~nh.MOUSE_HOVER,this._tree.rerender(i))}}))}_registerSelectionChangeListener(){this._register(this._tree.onDidChangeSelection(e=>{const t=e.elements.filter(i=>i instanceof nr);t.length!==e.elements.length&&(e.elements.length===1&&e.elements[0]instanceof lb&&(this._tree.setFocus([e.elements[0].children[0]]),this._tree.reveal(e.elements[0],0)),this._tree.setSelection(t))}))}setAllVisibleChecked(e){this._elementCheckedEventBufferer.bufferEvents(()=>{this._itemElements.forEach(t=>{!t.hidden&&!t.checkboxDisabled&&(t.checked=e)})})}setElements(e){this._elementDisposable.clear(),this._lastQueryString=void 0,this._inputElements=e,this._hasCheckboxes=this.parent.classList.contains("show-checkboxes");let t;this._itemElements=new Array,this._elementTree=e.reduce((i,n,r)=>{let o;if(n.type==="separator"){if(!n.buttons)return i;t=new lb(r,a=>this._onSeparatorButtonTriggered.fire(a),n),o=t}else{const a=r>0?e[r-1]:void 0;let l;a&&a.type==="separator"&&!a.buttons&&(t=void 0,l=a);const c=new nr(r,this._hasCheckboxes,d=>this._onButtonTriggered.fire(d),this._elementChecked,n,l);if(this._itemElements.push(c),t)return t.children.push(c),i;o=c}return i.push(o),i},new Array),this._setElementsToTree(this._elementTree),this.accessibilityService.isScreenReaderOptimized()&&setTimeout(()=>{const i=this._tree.getHTMLElement().querySelector(".monaco-list-row.focused"),n=i==null?void 0:i.parentNode;if(i&&n){const r=i.nextSibling;i.remove(),n.insertBefore(i,r)}},0)}setFocusedElements(e){const t=e.map(i=>this._itemElements.find(n=>n.item===i)).filter(i=>!!i).filter(i=>!i.hidden);if(this._tree.setFocus(t),e.length>0){const i=this._tree.getFocus()[0];i&&this._tree.reveal(i)}}getActiveDescendant(){return this._tree.getHTMLElement().getAttribute("aria-activedescendant")}setSelectedElements(e){const t=e.map(i=>this._itemElements.find(n=>n.item===i)).filter(i=>!!i);this._tree.setSelection(t)}getCheckedElements(){return this._itemElements.filter(e=>e.checked).map(e=>e.item)}setCheckedElements(e){this._elementCheckedEventBufferer.bufferEvents(()=>{const t=new Set;for(const i of e)t.add(i);for(const i of this._itemElements)i.checked=t.has(i.item)})}focus(e){var t;if(this._itemElements.length)switch(e===ji.Second&&this._itemElements.length<2&&(e=ji.First),e){case ji.First:this._tree.scrollTop=0,this._tree.focusFirst(void 0,i=>i.element instanceof nr);break;case ji.Second:{this._tree.scrollTop=0;let i=!1;this._tree.focusFirst(void 0,n=>n.element instanceof nr?i?!0:(i=!i,!1):!1);break}case ji.Last:this._tree.scrollTop=this._tree.scrollHeight,this._tree.focusLast(void 0,i=>i.element instanceof nr);break;case ji.Next:{const i=this._tree.getFocus();this._tree.focusNext(void 0,this._shouldLoop,void 0,r=>r.element instanceof nr?(this._tree.reveal(r.element),!0):!1);const n=this._tree.getFocus();i.length&&i[0]===n[0]&&i[0]===this._itemElements[this._itemElements.length-1]&&this._onLeave.fire();break}case ji.Previous:{const i=this._tree.getFocus();this._tree.focusPrevious(void 0,this._shouldLoop,void 0,r=>{if(!(r.element instanceof nr))return!1;const o=this._tree.getParentElement(r.element);return o===null||o.children[0]!==r.element?this._tree.reveal(r.element):this._tree.reveal(o),!0});const n=this._tree.getFocus();i.length&&i[0]===n[0]&&i[0]===this._itemElements[0]&&this._onLeave.fire();break}case ji.NextPage:this._tree.focusNextPage(void 0,i=>i.element instanceof nr?(this._tree.reveal(i.element),!0):!1);break;case ji.PreviousPage:this._tree.focusPreviousPage(void 0,i=>{if(!(i.element instanceof nr))return!1;const n=this._tree.getParentElement(i.element);return n===null||n.children[0]!==i.element?this._tree.reveal(i.element):this._tree.reveal(n),!0});break;case ji.NextSeparator:{let i=!1;const n=this._tree.getFocus()[0];this._tree.focusNext(void 0,!0,void 0,o=>{if(i)return!0;if(o.element instanceof lb)i=!0,this._separatorRenderer.isSeparatorVisible(o.element)?this._tree.reveal(o.element.children[0]):this._tree.reveal(o.element,0);else if(o.element instanceof nr){if(o.element.separator)return this._itemRenderer.isItemWithSeparatorVisible(o.element)?this._tree.reveal(o.element):this._tree.reveal(o.element,0),!0;if(o.element===this._elementTree[0])return this._tree.reveal(o.element,0),!0}return!1});const r=this._tree.getFocus()[0];n===r&&(this._tree.scrollTop=this._tree.scrollHeight,this._tree.focusLast(void 0,o=>o.element instanceof nr));break}case ji.PreviousSeparator:{let i,n=!!((t=this._tree.getFocus()[0])!=null&&t.separator);this._tree.focusPrevious(void 0,!0,void 0,r=>{if(r.element instanceof lb)n?i||(this._separatorRenderer.isSeparatorVisible(r.element)?this._tree.reveal(r.element):this._tree.reveal(r.element,0),i=r.element.children[0]):n=!0;else if(r.element instanceof nr&&!i){if(r.element.separator)this._itemRenderer.isItemWithSeparatorVisible(r.element)?this._tree.reveal(r.element):this._tree.reveal(r.element,0),i=r.element;else if(r.element===this._elementTree[0])return this._tree.reveal(r.element,0),!0}return!1}),i&&this._tree.setFocus([i]);break}}}clearFocus(){this._tree.setFocus([])}domFocus(){this._tree.domFocus()}layout(e){this._tree.getHTMLElement().style.maxHeight=e?`${Math.floor(e/44)*44+6}px`:"",this._tree.layout()}filter(e){if(this._lastQueryString=e,!(this._sortByLabel||this._matchOnLabel||this._matchOnDescription||this._matchOnDetail))return this._tree.layout(),!1;const t=e;if(e=e.trim(),!e||!(this.matchOnLabel||this.matchOnDescription||this.matchOnDetail))this._itemElements.forEach(i=>{i.labelHighlights=void 0,i.descriptionHighlights=void 0,i.detailHighlights=void 0,i.hidden=!1;const n=i.index&&this._inputElements[i.index-1];i.item&&(i.separator=n&&n.type==="separator"&&!n.buttons?n:void 0)});else{let i;this._itemElements.forEach(n=>{let r;this.matchOnLabelMode==="fuzzy"?r=this.matchOnLabel?NV(e,iL(n.saneLabel))??void 0:void 0:r=this.matchOnLabel?c6e(t,iL(n.saneLabel))??void 0:void 0;const o=this.matchOnDescription?NV(e,iL(n.saneDescription||""))??void 0:void 0,a=this.matchOnDetail?NV(e,iL(n.saneDetail||""))??void 0:void 0;if(r||o||a?(n.labelHighlights=r,n.descriptionHighlights=o,n.detailHighlights=a,n.hidden=!1):(n.labelHighlights=void 0,n.descriptionHighlights=void 0,n.detailHighlights=void 0,n.hidden=n.item?!n.item.alwaysShow:!0),n.item?n.separator=void 0:n.separator&&(n.hidden=!0),!this.sortByLabel){const l=n.index&&this._inputElements[n.index-1]||void 0;(l==null?void 0:l.type)==="separator"&&!l.buttons&&(i=l),i&&!n.hidden&&(n.separator=i,i=void 0)}})}return this._setElementsToTree(this._sortByLabel&&e?this._itemElements:this._elementTree),this._tree.layout(),!0}toggleCheckbox(){this._elementCheckedEventBufferer.bufferEvents(()=>{const e=this._tree.getFocus().filter(i=>i instanceof nr),t=this._allVisibleChecked(e);for(const i of e)i.checkboxDisabled||(i.checked=!t)})}style(e){this._tree.style(e)}toggleHover(){const e=this._tree.getFocus()[0];if(!(e!=null&&e.saneTooltip)||!(e instanceof nr))return;if(this._lastHover&&!this._lastHover.isDisposed){this._lastHover.dispose();return}this.showHover(e);const t=new ce;t.add(this._tree.onDidChangeFocus(i=>{i.elements[0]instanceof nr&&this.showHover(i.elements[0])})),this._lastHover&&t.add(this._lastHover),this._elementDisposable.add(t)}_setElementsToTree(e){const t=new Array;for(const i of e)i instanceof lb?t.push({element:i,collapsible:!1,collapsed:!1,children:i.children.map(n=>({element:n,collapsible:!1,collapsed:!1}))}):t.push({element:i,collapsible:!1,collapsed:!1});this._tree.setChildren(null,t)}_allVisibleChecked(e,t=!0){for(let i=0,n=e.length;i<n;i++){const r=e[i];if(!r.hidden)if(r.checked)t=!0;else return!1}return t}_updateCheckedObservables(){pn(e=>{this._allVisibleCheckedObservable.set(this._allVisibleChecked(this._itemElements,!1),e);const t=this._itemElements.filter(i=>i.checked).length;this._checkedCountObservable.set(t,e),this._checkedElementsObservable.set(this.getCheckedElements(),e)})}showHover(e){var t,i,n;this._lastHover&&!this._lastHover.isDisposed&&((i=(t=this.hoverDelegate).onDidHideHover)==null||i.call(t),(n=this._lastHover)==null||n.dispose()),!(!e.element||!e.saneTooltip)&&(this._lastHover=this.hoverDelegate.showHover({content:e.saneTooltip,target:e.element,linkHandler:r=>{this.linkOpenerDelegate(r)},appearance:{showPointer:!0},container:this._container,position:{hoverPosition:1}},!1))}};XF([$n],PI.prototype,"onDidChangeFocus",null);XF([$n],PI.prototype,"onDidChangeSelection",null);PI=XF([G8(4,Xe),G8(5,Wa)],PI);function c6e(s,e){const{text:t,iconOffsets:i}=e;if(!i||i.length===0)return tse(s,t);const n=WE(t," "),r=t.length-n.length,o=tse(s,n);if(o)for(const a of o){const l=i[a.start+r]+r;a.start+=l,a.end+=l}return o}function tse(s,e){const t=e.toLowerCase().indexOf(s.toLowerCase());return t!==-1?[{start:t,end:t+s.length}]:null}function d6e(s,e,t){const i=s.labelHighlights||[],n=e.labelHighlights||[];return i.length&&!n.length?-1:!i.length&&n.length?1:i.length===0&&n.length===0?0:r6e(s.saneSortLabel,e.saneSortLabel,t)}const Spe={weight:200,when:he.and(he.equals(Kge,"quickPick"),V7e),metadata:{description:b("quickPick","Used while in the context of the quick pick. If you change one keybinding for this command, you should change all of the other keybindings (modifier variants) of this command as well.")}};function Sa(s,e={}){Io.registerCommandAndKeybindingRule({...Spe,...s,secondary:u6e(s.primary,s.secondary??[],e)})}const YA=Wt?256:2048;function u6e(s,e,t={}){return t.withAltMod&&e.push(512+s),t.withCtrlMod&&(e.push(YA+s),t.withAltMod&&e.push(512+YA+s)),t.withCmdMod&&Wt&&(e.push(2048+s),t.withCtrlMod&&e.push(2304+s),t.withAltMod&&(e.push(2560+s),t.withCtrlMod&&e.push(2816+s))),e}function ul(s,e){return t=>{const i=t.get(kc).currentQuickInput;if(i)return e&&i.quickNavigate?i.focus(e):i.focus(s)}}Sa({id:"quickInput.pageNext",primary:12,handler:ul(ji.NextPage)},{withAltMod:!0,withCtrlMod:!0,withCmdMod:!0});Sa({id:"quickInput.pagePrevious",primary:11,handler:ul(ji.PreviousPage)},{withAltMod:!0,withCtrlMod:!0,withCmdMod:!0});Sa({id:"quickInput.first",primary:YA+14,handler:ul(ji.First)},{withAltMod:!0,withCmdMod:!0});Sa({id:"quickInput.last",primary:YA+13,handler:ul(ji.Last)},{withAltMod:!0,withCmdMod:!0});Sa({id:"quickInput.next",primary:18,handler:ul(ji.Next)},{withCtrlMod:!0});Sa({id:"quickInput.previous",primary:16,handler:ul(ji.Previous)},{withCtrlMod:!0});const ise=b("quickInput.nextSeparatorWithQuickAccessFallback","If we're in quick access mode, this will navigate to the next item. If we are not in quick access mode, this will navigate to the next separator."),nse=b("quickInput.previousSeparatorWithQuickAccessFallback","If we're in quick access mode, this will navigate to the previous item. If we are not in quick access mode, this will navigate to the previous separator.");Wt?(Sa({id:"quickInput.nextSeparatorWithQuickAccessFallback",primary:2066,handler:ul(ji.NextSeparator,ji.Next),metadata:{description:ise}}),Sa({id:"quickInput.nextSeparator",primary:2578,secondary:[2322],handler:ul(ji.NextSeparator)},{withCtrlMod:!0}),Sa({id:"quickInput.previousSeparatorWithQuickAccessFallback",primary:2064,handler:ul(ji.PreviousSeparator,ji.Previous),metadata:{description:nse}}),Sa({id:"quickInput.previousSeparator",primary:2576,secondary:[2320],handler:ul(ji.PreviousSeparator)},{withCtrlMod:!0})):(Sa({id:"quickInput.nextSeparatorWithQuickAccessFallback",primary:530,handler:ul(ji.NextSeparator,ji.Next),metadata:{description:ise}}),Sa({id:"quickInput.nextSeparator",primary:2578,handler:ul(ji.NextSeparator)}),Sa({id:"quickInput.previousSeparatorWithQuickAccessFallback",primary:528,handler:ul(ji.PreviousSeparator,ji.Previous),metadata:{description:nse}}),Sa({id:"quickInput.previousSeparator",primary:2576,handler:ul(ji.PreviousSeparator)}));Sa({id:"quickInput.acceptInBackground",when:he.and(Spe.when,he.or(upe.negate(),H7e)),primary:17,weight:250,handler:s=>{const e=s.get(kc).currentQuickInput;e==null||e.accept(!0)}},{withAltMod:!0,withCtrlMod:!0,withCmdMod:!0});var h6e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},eB=function(s,e){return function(t,i){e(t,i,s)}},Y8;const va=ke;var dv;let X8=(dv=class extends te{get currentQuickInput(){return this.controller??void 0}get container(){return this._container}constructor(e,t,i,n){super(),this.options=e,this.layoutService=t,this.instantiationService=i,this.contextKeyService=n,this.enabled=!0,this.onDidAcceptEmitter=this._register(new Z),this.onDidCustomEmitter=this._register(new Z),this.onDidTriggerButtonEmitter=this._register(new Z),this.keyMods={ctrlCmd:!1,alt:!1},this.controller=null,this.onShowEmitter=this._register(new Z),this.onShow=this.onShowEmitter.event,this.onHideEmitter=this._register(new Z),this.onHide=this.onHideEmitter.event,this.inQuickInputContext=F7e.bindTo(this.contextKeyService),this.quickInputTypeContext=B7e.bindTo(this.contextKeyService),this.endOfQuickInputBoxContext=W7e.bindTo(this.contextKeyService),this.idPrefix=e.idPrefix,this._container=e.container,this.styles=e.styles,this._register(De.runAndSubscribe(nF,({window:r,disposables:o})=>this.registerKeyModsListeners(r,o),{window:Ri,disposables:this._store})),this._register(H2e(r=>{this.ui&&nt(this.ui.container)===r&&(this.reparentUI(this.layoutService.mainContainer),this.layout(this.layoutService.mainContainerDimension,this.layoutService.mainContainerOffset.quickPickTop))}))}registerKeyModsListeners(e,t){const i=n=>{this.keyMods.ctrlCmd=n.ctrlKey||n.metaKey,this.keyMods.alt=n.altKey};for(const n of[Le.KEY_DOWN,Le.KEY_UP,Le.MOUSE_DOWN])t.add(oe(e,n,i,!0))}getUI(e){if(this.ui)return e&&nt(this._container)!==nt(this.layoutService.activeContainer)&&(this.reparentUI(this.layoutService.activeContainer),this.layout(this.layoutService.activeContainerDimension,this.layoutService.activeContainerOffset.quickPickTop)),this.ui;const t=me(this._container,va(".quick-input-widget.show-file-icons"));t.tabIndex=-1,t.style.display="none";const i=Rl(t),n=me(t,va(".quick-input-titlebar")),r=this._register(new Dl(n,{hoverDelegate:this.options.hoverDelegate}));r.domNode.classList.add("quick-input-left-action-bar");const o=me(n,va(".quick-input-title")),a=this._register(new Dl(n,{hoverDelegate:this.options.hoverDelegate}));a.domNode.classList.add("quick-input-right-action-bar");const l=me(t,va(".quick-input-header")),c=me(l,va("input.quick-input-check-all"));c.type="checkbox",c.setAttribute("aria-label",b("quickInput.checkAll","Toggle all checkboxes")),this._register(yn(c,Le.CHANGE,ee=>{const re=c.checked;U.setAllVisibleChecked(re)})),this._register(oe(c,Le.CLICK,ee=>{(ee.x||ee.y)&&g.setFocus()}));const d=me(l,va(".quick-input-description")),u=me(l,va(".quick-input-and-message")),h=me(u,va(".quick-input-filter")),g=this._register(new X7e(h,this.styles.inputBox,this.styles.toggle));g.setAttribute("aria-describedby",`${this.idPrefix}message`);const p=me(h,va(".quick-input-visible-count"));p.setAttribute("aria-live","polite"),p.setAttribute("aria-atomic","true");const _=new B8(p,{countFormat:b({key:"quickInput.visibleCount",comment:["This tells the user how many items are shown in a list of items to select from. The items can be anything. Currently not visible, but read by screen readers."]},"{0} Results")},this.styles.countBadge),v=me(h,va(".quick-input-count"));v.setAttribute("aria-live","polite");const C=new B8(v,{countFormat:b({key:"quickInput.countSelected",comment:["This tells the user how many items are selected in a list of items to select from. The items can be anything."]},"{0} Selected")},this.styles.countBadge),y=this._register(new Dl(l,{hoverDelegate:this.options.hoverDelegate}));y.domNode.classList.add("quick-input-inline-action-bar");const x=me(l,va(".quick-input-action")),L=this._register(new FA(x,this.styles.button));L.label=b("ok","OK"),this._register(L.onDidClick(ee=>{this.onDidAcceptEmitter.fire()}));const I=me(l,va(".quick-input-action")),A=this._register(new FA(I,{...this.styles.button,supportIcons:!0}));A.label=b("custom","Custom"),this._register(A.onDidClick(ee=>{this.onDidCustomEmitter.fire()}));const D=me(u,va(`#${this.idPrefix}message.quick-input-message`)),N=this._register(new W8(t,this.styles.progressBar));N.getContainer().classList.add("quick-input-progress");const R=me(t,va(".quick-input-html-widget"));R.tabIndex=-1;const W=me(t,va(".quick-input-description")),H=this.idPrefix+"list",U=this._register(this.instantiationService.createInstance(PI,t,this.options.hoverDelegate,this.options.linkOpenerDelegate,H));g.setAttribute("aria-controls",H),this._register(U.onDidChangeFocus(()=>{g.setAttribute("aria-activedescendant",U.getActiveDescendant()??"")})),this._register(U.onChangedAllVisibleChecked(ee=>{c.checked=ee})),this._register(U.onChangedVisibleCount(ee=>{_.setCount(ee)})),this._register(U.onChangedCheckedCount(ee=>{C.setCount(ee)})),this._register(U.onLeave(()=>{setTimeout(()=>{this.controller&&(g.setFocus(),this.controller instanceof OA&&this.controller.canSelectMany&&U.clearFocus())},0)}));const B=hu(t);return this._register(B),this._register(oe(t,Le.FOCUS,ee=>{const re=this.getUI();if(ys(ee.relatedTarget,re.inputContainer)){const pe=re.inputBox.isSelectionAtEnd();this.endOfQuickInputBoxContext.get()!==pe&&this.endOfQuickInputBoxContext.set(pe)}ys(ee.relatedTarget,re.container)||(this.inQuickInputContext.set(!0),this.previousFocusElement=Ls(ee.relatedTarget)?ee.relatedTarget:void 0)},!0)),this._register(B.onDidBlur(()=>{!this.getUI().ignoreFocusOut&&!this.options.ignoreFocusOut()&&this.hide(E1.Blur),this.inQuickInputContext.set(!1),this.endOfQuickInputBoxContext.set(!1),this.previousFocusElement=void 0})),this._register(g.onKeyDown(ee=>{const re=this.getUI().inputBox.isSelectionAtEnd();this.endOfQuickInputBoxContext.get()!==re&&this.endOfQuickInputBoxContext.set(re)})),this._register(oe(t,Le.FOCUS,ee=>{g.setFocus()})),this._register(yn(t,Le.KEY_DOWN,ee=>{if(!ys(ee.target,R))switch(ee.keyCode){case 3:jt.stop(ee,!0),this.enabled&&this.onDidAcceptEmitter.fire();break;case 9:jt.stop(ee,!0),this.hide(E1.Gesture);break;case 2:if(!ee.altKey&&!ee.ctrlKey&&!ee.metaKey){const re=[".quick-input-list .monaco-action-bar .always-visible",".quick-input-list-entry:hover .monaco-action-bar",".monaco-list-row.focused .monaco-action-bar"];if(t.classList.contains("show-checkboxes")?re.push("input"):re.push("input[type=text]"),this.getUI().list.displayed&&re.push(".monaco-list"),this.getUI().message&&re.push(".quick-input-message a"),this.getUI().widget){if(ys(ee.target,this.getUI().widget))break;re.push(".quick-input-html-widget")}const pe=t.querySelectorAll(re.join(", "));ee.shiftKey&&ee.target===pe[0]?(jt.stop(ee,!0),U.clearFocus()):!ee.shiftKey&&ys(ee.target,pe[pe.length-1])&&(jt.stop(ee,!0),pe[0].focus())}break;case 10:ee.ctrlKey&&(jt.stop(ee,!0),this.getUI().list.toggleHover());break}})),this.ui={container:t,styleSheet:i,leftActionBar:r,titleBar:n,title:o,description1:W,description2:d,widget:R,rightActionBar:a,inlineActionBar:y,checkAll:c,inputContainer:u,filterContainer:h,inputBox:g,visibleCountContainer:p,visibleCount:_,countContainer:v,count:C,okContainer:x,ok:L,message:D,customButtonContainer:I,customButton:A,list:U,progressBar:N,onDidAccept:this.onDidAcceptEmitter.event,onDidCustom:this.onDidCustomEmitter.event,onDidTriggerButton:this.onDidTriggerButtonEmitter.event,ignoreFocusOut:!1,keyMods:this.keyMods,show:ee=>this.show(ee),hide:()=>this.hide(),setVisibilities:ee=>this.setVisibilities(ee),setEnabled:ee=>this.setEnabled(ee),setContextKey:ee=>this.options.setContextKey(ee),linkOpenerDelegate:ee=>this.options.linkOpenerDelegate(ee)},this.updateStyles(),this.ui}reparentUI(e){this.ui&&(this._container=e,me(this._container,this.ui.container))}pick(e,t={},i=kt.None){return new Promise((n,r)=>{let o=d=>{var u;o=n,(u=t.onKeyMods)==null||u.call(t,a.keyMods),n(d)};if(i.isCancellationRequested){o(void 0);return}const a=this.createQuickPick({useSeparators:!0});let l;const c=[a,a.onDidAccept(()=>{if(a.canSelectMany)o(a.selectedItems.slice()),a.hide();else{const d=a.activeItems[0];d&&(o(d),a.hide())}}),a.onDidChangeActive(d=>{const u=d[0];u&&t.onDidFocus&&t.onDidFocus(u)}),a.onDidChangeSelection(d=>{if(!a.canSelectMany){const u=d[0];u&&(o(u),a.hide())}}),a.onDidTriggerItemButton(d=>t.onDidTriggerItemButton&&t.onDidTriggerItemButton({...d,removeItem:()=>{const u=a.items.indexOf(d.item);if(u!==-1){const h=a.items.slice(),g=h.splice(u,1),p=a.activeItems.filter(v=>v!==g[0]),_=a.keepScrollPosition;a.keepScrollPosition=!0,a.items=h,p&&(a.activeItems=p),a.keepScrollPosition=_}}})),a.onDidTriggerSeparatorButton(d=>{var u;return(u=t.onDidTriggerSeparatorButton)==null?void 0:u.call(t,d)}),a.onDidChangeValue(d=>{l&&!d&&(a.activeItems.length!==1||a.activeItems[0]!==l)&&(a.activeItems=[l])}),i.onCancellationRequested(()=>{a.hide()}),a.onDidHide(()=>{Ni(c),o(void 0)})];a.title=t.title,t.value&&(a.value=t.value),a.canSelectMany=!!t.canPickMany,a.placeholder=t.placeHolder,a.ignoreFocusOut=!!t.ignoreFocusLost,a.matchOnDescription=!!t.matchOnDescription,a.matchOnDetail=!!t.matchOnDetail,a.matchOnLabel=t.matchOnLabel===void 0||t.matchOnLabel,a.quickNavigate=t.quickNavigate,a.hideInput=!!t.hideInput,a.contextKey=t.contextKey,a.busy=!0,Promise.all([e,t.activeItem]).then(([d,u])=>{l=u,a.busy=!1,a.items=d,a.canSelectMany&&(a.selectedItems=d.filter(h=>h.type!=="separator"&&h.picked)),l&&(a.activeItems=[l])}),a.show(),Promise.resolve(e).then(void 0,d=>{r(d),a.hide()})})}createQuickPick(e={useSeparators:!1}){const t=this.getUI(!0);return new OA(t)}createInputBox(){const e=this.getUI(!0);return new z7e(e)}show(e){const t=this.getUI(!0);this.onShowEmitter.fire();const i=this.controller;this.controller=e,i==null||i.didHide(),this.setEnabled(!0),t.leftActionBar.clear(),t.title.textContent="",t.description1.textContent="",t.description2.textContent="",Xs(t.widget),t.rightActionBar.clear(),t.inlineActionBar.clear(),t.checkAll.checked=!1,t.inputBox.placeholder="",t.inputBox.password=!1,t.inputBox.showDecoration(Hn.Ignore),t.visibleCount.setCount(0),t.count.setCount(0),Xs(t.message),t.progressBar.stop(),t.list.setElements([]),t.list.matchOnDescription=!1,t.list.matchOnDetail=!1,t.list.matchOnLabel=!0,t.list.sortByLabel=!0,t.ignoreFocusOut=!1,t.inputBox.toggles=void 0;const n=this.options.backKeybindingLabel();F8.tooltip=n?b("quickInput.backWithKeybinding","Back ({0})",n):b("quickInput.back","Back"),t.container.style.display="",this.updateLayout(),t.inputBox.setFocus(),this.quickInputTypeContext.set(e.type)}isVisible(){return!!this.ui&&this.ui.container.style.display!=="none"}setVisibilities(e){const t=this.getUI();t.title.style.display=e.title?"":"none",t.description1.style.display=e.description&&(e.inputBox||e.checkAll)?"":"none",t.description2.style.display=e.description&&!(e.inputBox||e.checkAll)?"":"none",t.checkAll.style.display=e.checkAll?"":"none",t.inputContainer.style.display=e.inputBox?"":"none",t.filterContainer.style.display=e.inputBox?"":"none",t.visibleCountContainer.style.display=e.visibleCount?"":"none",t.countContainer.style.display=e.count?"":"none",t.okContainer.style.display=e.ok?"":"none",t.customButtonContainer.style.display=e.customButton?"":"none",t.message.style.display=e.message?"":"none",t.progressBar.getContainer().style.display=e.progressBar?"":"none",t.list.displayed=!!e.list,t.container.classList.toggle("show-checkboxes",!!e.checkBox),t.container.classList.toggle("hidden-input",!e.inputBox&&!e.description),this.updateLayout()}setEnabled(e){if(e!==this.enabled){this.enabled=e;for(const t of this.getUI().leftActionBar.viewItems)t.action.enabled=e;for(const t of this.getUI().rightActionBar.viewItems)t.action.enabled=e;this.getUI().checkAll.disabled=!e,this.getUI().inputBox.enabled=e,this.getUI().ok.enabled=e,this.getUI().list.enabled=e}}hide(e){var r;const t=this.controller;if(!t)return;t.willHide(e);const i=(r=this.ui)==null?void 0:r.container,n=i&&!the(i);if(this.controller=null,this.onHideEmitter.fire(),i&&(i.style.display="none"),!n){let o=this.previousFocusElement;for(;o&&!o.offsetParent;)o=o.parentElement??void 0;o!=null&&o.offsetParent?(o.focus(),this.previousFocusElement=void 0):this.options.returnFocus()}t.didHide(e)}layout(e,t){this.dimension=e,this.titleBarOffset=t,this.updateLayout()}updateLayout(){if(this.ui&&this.isVisible()){this.ui.container.style.top=`${this.titleBarOffset}px`;const e=this.ui.container.style,t=Math.min(this.dimension.width*.62,Y8.MAX_WIDTH);e.width=t+"px",e.marginLeft="-"+t/2+"px",this.ui.inputBox.layout(),this.ui.list.layout(this.dimension&&this.dimension.height*.4)}}applyStyles(e){this.styles=e,this.updateStyles()}updateStyles(){if(this.ui){const{quickInputTitleBackground:e,quickInputBackground:t,quickInputForeground:i,widgetBorder:n,widgetShadow:r}=this.styles.widget;this.ui.titleBar.style.backgroundColor=e??"",this.ui.container.style.backgroundColor=t??"",this.ui.container.style.color=i??"",this.ui.container.style.border=n?`1px solid ${n}`:"",this.ui.container.style.boxShadow=r?`0 0 8px 2px ${r}`:"",this.ui.list.style(this.styles.list);const o=[];this.styles.pickerGroup.pickerGroupBorder&&o.push(`.quick-input-list .quick-input-list-entry { border-top-color:  ${this.styles.pickerGroup.pickerGroupBorder}; }`),this.styles.pickerGroup.pickerGroupForeground&&o.push(`.quick-input-list .quick-input-list-separator { color:  ${this.styles.pickerGroup.pickerGroupForeground}; }`),this.styles.pickerGroup.pickerGroupForeground&&o.push(".quick-input-list .quick-input-list-separator-as-item { color: var(--vscode-descriptionForeground); }"),(this.styles.keybindingLabel.keybindingLabelBackground||this.styles.keybindingLabel.keybindingLabelBorder||this.styles.keybindingLabel.keybindingLabelBottomBorder||this.styles.keybindingLabel.keybindingLabelShadow||this.styles.keybindingLabel.keybindingLabelForeground)&&(o.push(".quick-input-list .monaco-keybinding > .monaco-keybinding-key {"),this.styles.keybindingLabel.keybindingLabelBackground&&o.push(`background-color: ${this.styles.keybindingLabel.keybindingLabelBackground};`),this.styles.keybindingLabel.keybindingLabelBorder&&o.push(`border-color: ${this.styles.keybindingLabel.keybindingLabelBorder};`),this.styles.keybindingLabel.keybindingLabelBottomBorder&&o.push(`border-bottom-color: ${this.styles.keybindingLabel.keybindingLabelBottomBorder};`),this.styles.keybindingLabel.keybindingLabelShadow&&o.push(`box-shadow: inset 0 -1px 0 ${this.styles.keybindingLabel.keybindingLabelShadow};`),this.styles.keybindingLabel.keybindingLabelForeground&&o.push(`color: ${this.styles.keybindingLabel.keybindingLabelForeground};`),o.push("}"));const a=o.join(`
`);a!==this.ui.styleSheet.textContent&&(this.ui.styleSheet.textContent=a)}}},Y8=dv,dv.MAX_WIDTH=600,dv);X8=Y8=h6e([eB(1,g_),eB(2,Xe),eB(3,ct)],X8);var f6e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Ax=function(s,e){return function(t,i){e(t,i,s)}};let Z8=class extends sOe{get controller(){return this._controller||(this._controller=this._register(this.createController())),this._controller}get hasController(){return!!this._controller}get currentQuickInput(){return this.controller.currentQuickInput}get quickAccess(){return this._quickAccess||(this._quickAccess=this._register(this.instantiationService.createInstance(O8))),this._quickAccess}constructor(e,t,i,n,r){super(i),this.instantiationService=e,this.contextKeyService=t,this.layoutService=n,this.configurationService=r,this._onShow=this._register(new Z),this._onHide=this._register(new Z),this.contexts=new Map}createController(e=this.layoutService,t){const i={idPrefix:"quickInput_",container:e.activeContainer,ignoreFocusOut:()=>!1,backKeybindingLabel:()=>{},setContextKey:r=>this.setContextKey(r),linkOpenerDelegate:r=>{this.instantiationService.invokeFunction(o=>{o.get(la).open(r,{allowCommands:!0,fromUserGesture:!0})})},returnFocus:()=>e.focus(),styles:this.computeStyles(),hoverDelegate:this._register(this.instantiationService.createInstance(V8))},n=this._register(this.instantiationService.createInstance(X8,{...i,...t}));return n.layout(e.activeContainerDimension,e.activeContainerOffset.quickPickTop),this._register(e.onDidLayoutActiveContainer(r=>{nt(e.activeContainer)===nt(n.container)&&n.layout(r,e.activeContainerOffset.quickPickTop)})),this._register(e.onDidChangeActiveContainer(()=>{n.isVisible()||n.layout(e.activeContainerDimension,e.activeContainerOffset.quickPickTop)})),this._register(n.onShow(()=>{this.resetContextKeys(),this._onShow.fire()})),this._register(n.onHide(()=>{this.resetContextKeys(),this._onHide.fire()})),n}setContextKey(e){let t;e&&(t=this.contexts.get(e),t||(t=new Oe(e,!1).bindTo(this.contextKeyService),this.contexts.set(e,t))),!(t&&t.get())&&(this.resetContextKeys(),t==null||t.set(!0))}resetContextKeys(){this.contexts.forEach(e=>{e.get()&&e.reset()})}pick(e,t,i=kt.None){return this.controller.pick(e,t,i)}createQuickPick(e={useSeparators:!1}){return this.controller.createQuickPick(e)}createInputBox(){return this.controller.createInputBox()}updateStyles(){this.hasController&&this.controller.applyStyles(this.computeStyles())}computeStyles(){return{widget:{quickInputBackground:Fe(Tie),quickInputForeground:Fe(wFe),quickInputTitleBackground:Fe(CFe),widgetBorder:Fe(ufe),widgetShadow:Fe(gS)},inputBox:LA,toggle:xA,countBadge:cge,button:tVe,progressBar:iVe,keybindingLabel:eVe,list:Qw({listBackground:Tie,listFocusBackground:mI,listFocusForeground:pI,listInactiveFocusForeground:pI,listInactiveSelectionIconForeground:pK,listInactiveFocusBackground:mI,listFocusOutline:tn,listInactiveFocusOutline:tn}),pickerGroup:{pickerGroupBorder:Fe(yFe),pickerGroupForeground:Fe(Cfe)}}}};Z8=f6e([Ax(0,Xe),Ax(1,ct),Ax(2,gs),Ax(3,g_),Ax(4,At)],Z8);var xpe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Sb=function(s,e){return function(t,i){e(t,i,s)}};let J8=class extends Z8{constructor(e,t,i,n,r,o){super(t,i,n,new v6(e.getContainerDomNode(),r),o),this.host=void 0;const a=MI.get(e);if(a){const l=a.widget;this.host={_serviceBrand:void 0,get mainContainer(){return l.getDomNode()},getContainer(){return l.getDomNode()},whenContainerStylesLoaded(){},get containers(){return[l.getDomNode()]},get activeContainer(){return l.getDomNode()},get mainContainerDimension(){return e.getLayoutInfo()},get activeContainerDimension(){return e.getLayoutInfo()},get onDidLayoutMainContainer(){return e.onDidLayoutChange},get onDidLayoutActiveContainer(){return e.onDidLayoutChange},get onDidLayoutContainer(){return De.map(e.onDidLayoutChange,c=>({container:l.getDomNode(),dimension:c}))},get onDidChangeActiveContainer(){return De.None},get onDidAddContainer(){return De.None},get mainContainerOffset(){return{top:0,quickPickTop:0}},get activeContainerOffset(){return{top:0,quickPickTop:0}},focus:()=>e.focus()}}else this.host=void 0}createController(){return super.createController(this.host)}};J8=xpe([Sb(1,Xe),Sb(2,ct),Sb(3,gs),Sb(4,ni),Sb(5,At)],J8);let eH=class{get activeService(){const e=this.codeEditorService.getFocusedCodeEditor();if(!e)throw new Error("Quick input service needs a focused editor to work.");let t=this.mapEditorToService.get(e);if(!t){const i=t=this.instantiationService.createInstance(J8,e);this.mapEditorToService.set(e,t),Wm(e.onDidDispose)(()=>{i.dispose(),this.mapEditorToService.delete(e)})}return t}get currentQuickInput(){return this.activeService.currentQuickInput}get quickAccess(){return this.activeService.quickAccess}constructor(e,t){this.instantiationService=e,this.codeEditorService=t,this.mapEditorToService=new Map}pick(e,t,i=kt.None){return this.activeService.pick(e,t,i)}createQuickPick(e={useSeparators:!1}){return this.activeService.createQuickPick(e)}createInputBox(){return this.activeService.createInputBox()}};eH=xpe([Sb(0,Xe),Sb(1,ni)],eH);const tO=class tO{static get(e){return e.getContribution(tO.ID)}constructor(e){this.editor=e,this.widget=new tH(this.editor)}dispose(){this.widget.dispose()}};tO.ID="editor.controller.quickInput";let MI=tO;const iO=class iO{constructor(e){this.codeEditor=e,this.domNode=document.createElement("div"),this.codeEditor.addOverlayWidget(this)}getId(){return iO.ID}getDomNode(){return this.domNode}getPosition(){return{preference:2}}dispose(){this.codeEditor.removeOverlayWidget(this)}};iO.ID="editor.contrib.quickInputWidget";let tH=iO;Zt(MI.ID,MI,4);class g6e{constructor(e,t,i,n,r){this._parsedThemeRuleBrand=void 0,this.token=e,this.index=t,this.fontStyle=i,this.foreground=n,this.background=r}}function p6e(s){if(!s||!Array.isArray(s))return[];const e=[];let t=0;for(let i=0,n=s.length;i<n;i++){const r=s[i];let o=-1;if(typeof r.fontStyle=="string"){o=0;const c=r.fontStyle.split(" ");for(let d=0,u=c.length;d<u;d++)switch(c[d]){case"italic":o=o|1;break;case"bold":o=o|2;break;case"underline":o=o|4;break;case"strikethrough":o=o|8;break}}let a=null;typeof r.foreground=="string"&&(a=r.foreground);let l=null;typeof r.background=="string"&&(l=r.background),e[t++]=new g6e(r.token||"",i,o,a,l)}return e}function m6e(s,e){s.sort((d,u)=>{const h=C6e(d.token,u.token);return h!==0?h:d.index-u.index});let t=0,i="000000",n="ffffff";for(;s.length>=1&&s[0].token==="";){const d=s.shift();d.fontStyle!==-1&&(t=d.fontStyle),d.foreground!==null&&(i=d.foreground),d.background!==null&&(n=d.background)}const r=new b6e;for(const d of e)r.getId(d);const o=r.getId(i),a=r.getId(n),l=new pG(t,o,a),c=new mG(l);for(let d=0,u=s.length;d<u;d++){const h=s[d];c.insert(h.token,h.fontStyle,r.getId(h.foreground),r.getId(h.background))}return new Lpe(r,c)}const _6e=/^#?([0-9A-Fa-f]{6})([0-9A-Fa-f]{2})?$/;class b6e{constructor(){this._lastColorId=0,this._id2color=[],this._color2id=new Map}getId(e){if(e===null)return 0;const t=e.match(_6e);if(!t)throw new Error("Illegal value for token color: "+e);e=t[1].toUpperCase();let i=this._color2id.get(e);return i||(i=++this._lastColorId,this._color2id.set(e,i),this._id2color[i]=fe.fromHex("#"+e),i)}getColorMap(){return this._id2color.slice(0)}}class Lpe{static createFromRawTokenTheme(e,t){return this.createFromParsedTokenTheme(p6e(e),t)}static createFromParsedTokenTheme(e,t){return m6e(e,t)}constructor(e,t){this._colorMap=e,this._root=t,this._cache=new Map}getColorMap(){return this._colorMap.getColorMap()}_match(e){return this._root.match(e)}match(e,t){let i=this._cache.get(t);if(typeof i>"u"){const n=this._match(t),r=w6e(t);i=(n.metadata|r<<8)>>>0,this._cache.set(t,i)}return(i|e<<0)>>>0}}const v6e=/\b(comment|string|regex|regexp)\b/;function w6e(s){const e=s.match(v6e);if(!e)return 0;switch(e[1]){case"comment":return 1;case"string":return 2;case"regex":return 3;case"regexp":return 3}throw new Error("Unexpected match for standard token type!")}function C6e(s,e){return s<e?-1:s>e?1:0}class pG{constructor(e,t,i){this._themeTrieElementRuleBrand=void 0,this._fontStyle=e,this._foreground=t,this._background=i,this.metadata=(this._fontStyle<<11|this._foreground<<15|this._background<<24)>>>0}clone(){return new pG(this._fontStyle,this._foreground,this._background)}acceptOverwrite(e,t,i){e!==-1&&(this._fontStyle=e),t!==0&&(this._foreground=t),i!==0&&(this._background=i),this.metadata=(this._fontStyle<<11|this._foreground<<15|this._background<<24)>>>0}}class mG{constructor(e){this._themeTrieElementBrand=void 0,this._mainRule=e,this._children=new Map}match(e){if(e==="")return this._mainRule;const t=e.indexOf(".");let i,n;t===-1?(i=e,n=""):(i=e.substring(0,t),n=e.substring(t+1));const r=this._children.get(i);return typeof r<"u"?r.match(n):this._mainRule}insert(e,t,i,n){if(e===""){this._mainRule.acceptOverwrite(t,i,n);return}const r=e.indexOf(".");let o,a;r===-1?(o=e,a=""):(o=e.substring(0,r),a=e.substring(r+1));let l=this._children.get(o);typeof l>"u"&&(l=new mG(this._mainRule.clone()),this._children.set(o,l)),l.insert(a,t,i,n)}}function y6e(s){const e=[];for(let t=1,i=s.length;t<i;t++){const n=s[t];e[t]=`.mtk${t} { color: ${n}; }`}return e.push(".mtki { font-style: italic; }"),e.push(".mtkb { font-weight: bold; }"),e.push(".mtku { text-decoration: underline; text-underline-position: under; }"),e.push(".mtks { text-decoration: line-through; }"),e.push(".mtks.mtku { text-decoration: underline line-through; text-underline-position: under; }"),e.join(`
`)}const S6e={base:"vs",inherit:!1,rules:[{token:"",foreground:"000000",background:"fffffe"},{token:"invalid",foreground:"cd3131"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"001188"},{token:"variable.predefined",foreground:"4864AA"},{token:"constant",foreground:"dd0000"},{token:"comment",foreground:"008000"},{token:"number",foreground:"098658"},{token:"number.hex",foreground:"3030c0"},{token:"regexp",foreground:"800000"},{token:"annotation",foreground:"808080"},{token:"type",foreground:"008080"},{token:"delimiter",foreground:"000000"},{token:"delimiter.html",foreground:"383838"},{token:"delimiter.xml",foreground:"0000FF"},{token:"tag",foreground:"800000"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"800000"},{token:"metatag",foreground:"e00000"},{token:"metatag.content.html",foreground:"FF0000"},{token:"metatag.html",foreground:"808080"},{token:"metatag.xml",foreground:"808080"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"863B00"},{token:"string.key.json",foreground:"A31515"},{token:"string.value.json",foreground:"0451A5"},{token:"attribute.name",foreground:"FF0000"},{token:"attribute.value",foreground:"0451A5"},{token:"attribute.value.number",foreground:"098658"},{token:"attribute.value.unit",foreground:"098658"},{token:"attribute.value.html",foreground:"0000FF"},{token:"attribute.value.xml",foreground:"0000FF"},{token:"string",foreground:"A31515"},{token:"string.html",foreground:"0000FF"},{token:"string.sql",foreground:"FF0000"},{token:"string.yaml",foreground:"0451A5"},{token:"keyword",foreground:"0000FF"},{token:"keyword.json",foreground:"0451A5"},{token:"keyword.flow",foreground:"AF00DB"},{token:"keyword.flow.scss",foreground:"0000FF"},{token:"operator.scss",foreground:"666666"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"666666"},{token:"predefined.sql",foreground:"C700C7"}],colors:{[dd]:"#FFFFFE",[qh]:"#000000",[cfe]:"#E5EBF1",[oD]:"#D3D3D3",[aD]:"#939393",[cK]:"#ADD6FF4D"}},x6e={base:"vs-dark",inherit:!1,rules:[{token:"",foreground:"D4D4D4",background:"1E1E1E"},{token:"invalid",foreground:"f44747"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"74B0DF"},{token:"variable.predefined",foreground:"4864AA"},{token:"variable.parameter",foreground:"9CDCFE"},{token:"constant",foreground:"569CD6"},{token:"comment",foreground:"608B4E"},{token:"number",foreground:"B5CEA8"},{token:"number.hex",foreground:"5BB498"},{token:"regexp",foreground:"B46695"},{token:"annotation",foreground:"cc6666"},{token:"type",foreground:"3DC9B0"},{token:"delimiter",foreground:"DCDCDC"},{token:"delimiter.html",foreground:"808080"},{token:"delimiter.xml",foreground:"808080"},{token:"tag",foreground:"569CD6"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"A79873"},{token:"meta.tag",foreground:"CE9178"},{token:"metatag",foreground:"DD6A6F"},{token:"metatag.content.html",foreground:"9CDCFE"},{token:"metatag.html",foreground:"569CD6"},{token:"metatag.xml",foreground:"569CD6"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"9CDCFE"},{token:"string.key.json",foreground:"9CDCFE"},{token:"string.value.json",foreground:"CE9178"},{token:"attribute.name",foreground:"9CDCFE"},{token:"attribute.value",foreground:"CE9178"},{token:"attribute.value.number.css",foreground:"B5CEA8"},{token:"attribute.value.unit.css",foreground:"B5CEA8"},{token:"attribute.value.hex.css",foreground:"D4D4D4"},{token:"string",foreground:"CE9178"},{token:"string.sql",foreground:"FF0000"},{token:"keyword",foreground:"569CD6"},{token:"keyword.flow",foreground:"C586C0"},{token:"keyword.json",foreground:"CE9178"},{token:"keyword.flow.scss",foreground:"569CD6"},{token:"operator.scss",foreground:"909090"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"909090"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[dd]:"#1E1E1E",[qh]:"#D4D4D4",[cfe]:"#3A3D41",[oD]:"#404040",[aD]:"#707070",[cK]:"#ADD6FF26"}},L6e={base:"hc-black",inherit:!1,rules:[{token:"",foreground:"FFFFFF",background:"000000"},{token:"invalid",foreground:"f44747"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"1AEBFF"},{token:"variable.parameter",foreground:"9CDCFE"},{token:"constant",foreground:"569CD6"},{token:"comment",foreground:"608B4E"},{token:"number",foreground:"FFFFFF"},{token:"regexp",foreground:"C0C0C0"},{token:"annotation",foreground:"569CD6"},{token:"type",foreground:"3DC9B0"},{token:"delimiter",foreground:"FFFF00"},{token:"delimiter.html",foreground:"FFFF00"},{token:"tag",foreground:"569CD6"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta",foreground:"D4D4D4"},{token:"meta.tag",foreground:"CE9178"},{token:"metatag",foreground:"569CD6"},{token:"metatag.content.html",foreground:"1AEBFF"},{token:"metatag.html",foreground:"569CD6"},{token:"metatag.xml",foreground:"569CD6"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"9CDCFE"},{token:"string.key",foreground:"9CDCFE"},{token:"string.value",foreground:"CE9178"},{token:"attribute.name",foreground:"569CD6"},{token:"attribute.value",foreground:"3FF23F"},{token:"string",foreground:"CE9178"},{token:"string.sql",foreground:"FF0000"},{token:"keyword",foreground:"569CD6"},{token:"keyword.flow",foreground:"C586C0"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"909090"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[dd]:"#000000",[qh]:"#FFFFFF",[oD]:"#FFFFFF",[aD]:"#FFFFFF"}},k6e={base:"hc-light",inherit:!1,rules:[{token:"",foreground:"292929",background:"FFFFFF"},{token:"invalid",foreground:"B5200D"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"264F70"},{token:"variable.predefined",foreground:"4864AA"},{token:"constant",foreground:"dd0000"},{token:"comment",foreground:"008000"},{token:"number",foreground:"098658"},{token:"number.hex",foreground:"3030c0"},{token:"regexp",foreground:"800000"},{token:"annotation",foreground:"808080"},{token:"type",foreground:"008080"},{token:"delimiter",foreground:"000000"},{token:"delimiter.html",foreground:"383838"},{token:"tag",foreground:"800000"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"800000"},{token:"metatag",foreground:"e00000"},{token:"metatag.content.html",foreground:"B5200D"},{token:"metatag.html",foreground:"808080"},{token:"metatag.xml",foreground:"808080"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"863B00"},{token:"string.key.json",foreground:"A31515"},{token:"string.value.json",foreground:"0451A5"},{token:"attribute.name",foreground:"264F78"},{token:"attribute.value",foreground:"0451A5"},{token:"string",foreground:"A31515"},{token:"string.sql",foreground:"B5200D"},{token:"keyword",foreground:"0000FF"},{token:"keyword.flow",foreground:"AF00DB"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"666666"},{token:"predefined.sql",foreground:"C700C7"}],colors:{[dd]:"#FFFFFF",[qh]:"#292929",[oD]:"#292929",[aD]:"#292929"}},I6e={IconContribution:"base.contributions.icons"};var sse;(function(s){function e(t,i){let n=t.defaults;for(;at.isThemeIcon(n);){const r=Zw.getIcon(n.id);if(!r)return;n=r.defaults}return n}s.getDefinition=e})(sse||(sse={}));var rse;(function(s){function e(i){return{weight:i.weight,style:i.style,src:i.src.map(n=>({format:n.format,location:n.location.toString()}))}}s.toJSONObject=e;function t(i){const n=r=>Zo(r)?r:void 0;if(i&&Array.isArray(i.src)&&i.src.every(r=>Zo(r.format)&&Zo(r.location)))return{weight:n(i.weight),style:n(i.style),src:i.src.map(r=>({format:r.format,location:Je.parse(r.location)}))}}s.fromJSONObject=t})(rse||(rse={}));class E6e{constructor(){this._onDidChange=new Z,this.onDidChange=this._onDidChange.event,this.iconSchema={definitions:{icons:{type:"object",properties:{fontId:{type:"string",description:b("iconDefinition.fontId","The id of the font to use. If not set, the font that is defined first is used.")},fontCharacter:{type:"string",description:b("iconDefinition.fontCharacter","The font character associated with the icon definition.")}},additionalProperties:!1,defaultSnippets:[{body:{fontCharacter:"\\\\e030"}}]}},type:"object",properties:{}},this.iconReferenceSchema={type:"string",pattern:`^${at.iconNameExpression}$`,enum:[],enumDescriptions:[]},this.iconsById={},this.iconFontsById={}}registerIcon(e,t,i,n){const r=this.iconsById[e];if(r){if(i&&!r.description){r.description=i,this.iconSchema.properties[e].markdownDescription=`${i} $(${e})`;const l=this.iconReferenceSchema.enum.indexOf(e);l!==-1&&(this.iconReferenceSchema.enumDescriptions[l]=i),this._onDidChange.fire()}return r}const o={id:e,description:i,defaults:t,deprecationMessage:n};this.iconsById[e]=o;const a={$ref:"#/definitions/icons"};return n&&(a.deprecationMessage=n),i&&(a.markdownDescription=`${i}: $(${e})`),this.iconSchema.properties[e]=a,this.iconReferenceSchema.enum.push(e),this.iconReferenceSchema.enumDescriptions.push(i||""),this._onDidChange.fire(),{id:e}}getIcons(){return Object.keys(this.iconsById).map(e=>this.iconsById[e])}getIcon(e){return this.iconsById[e]}getIconSchema(){return this.iconSchema}toString(){const e=(r,o)=>r.id.localeCompare(o.id),t=r=>{for(;at.isThemeIcon(r.defaults);)r=this.iconsById[r.defaults.id];return`codicon codicon-${r?r.id:""}`},i=[];i.push("| preview     | identifier                        | default codicon ID                | description"),i.push("| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |");const n=Object.keys(this.iconsById).map(r=>this.iconsById[r]);for(const r of n.filter(o=>!!o.description).sort(e))i.push(`|<i class="${t(r)}"></i>|${r.id}|${at.isThemeIcon(r.defaults)?r.defaults.id:r.id}|${r.description||""}|`);i.push("| preview     | identifier                        "),i.push("| ----------- | --------------------------------- |");for(const r of n.filter(o=>!at.isThemeIcon(o.defaults)).sort(e))i.push(`|<i class="${t(r)}"></i>|${r.id}|`);return i.join(`
`)}}const Zw=new E6e;_n.add(I6e.IconContribution,Zw);function Qi(s,e,t,i){return Zw.registerIcon(s,e,t,i)}function kpe(){return Zw}function D6e(){const s=yue();for(const e in s){const t="\\"+s[e].toString(16);Zw.registerIcon(e,{fontCharacter:t})}}D6e();const Ipe="vscode://schemas/icons",Epe=_n.as(bF.JSONContribution);Epe.registerSchema(Ipe,Zw.getIconSchema());const ose=new xi(()=>Epe.notifySchemaChanged(Ipe),200);Zw.onDidChange(()=>{ose.isScheduled()||ose.schedule()});const Dpe=Qi("widget-close",xe.close,b("widgetClose","Icon for the close action in widgets."));Qi("goto-previous-location",xe.arrowUp,b("previousChangeIcon","Icon for goto previous editor location."));Qi("goto-next-location",xe.arrowDown,b("nextChangeIcon","Icon for goto next editor location."));at.modify(xe.sync,"spin");at.modify(xe.loading,"spin");function T6e(s){const e=new ce,t=e.add(new Z),i=kpe();return e.add(i.onDidChange(()=>t.fire())),s&&e.add(s.onDidProductIconThemeChange(()=>t.fire())),{dispose:()=>e.dispose(),onDidChange:t.event,getCSS(){const n=s?s.getProductIconTheme():new Tpe,r={},o=[],a=[];for(const l of i.getIcons()){const c=n.getIcon(l);if(!c)continue;const d=c.font,u=`--vscode-icon-${l.id}-font-family`,h=`--vscode-icon-${l.id}-content`;d?(r[d.id]=d.definition,a.push(`${u}: ${oV(d.id)};`,`${h}: '${c.fontCharacter}';`),o.push(`.codicon-${l.id}:before { content: '${c.fontCharacter}'; font-family: ${oV(d.id)}; }`)):(a.push(`${h}: '${c.fontCharacter}'; ${u}: 'codicon';`),o.push(`.codicon-${l.id}:before { content: '${c.fontCharacter}'; }`))}for(const l in r){const c=r[l],d=c.weight?`font-weight: ${c.weight};`:"",u=c.style?`font-style: ${c.style};`:"",h=c.src.map(g=>`${xg(g.location)} format('${g.format}')`).join(", ");o.push(`@font-face { src: ${h}; font-family: ${oV(l)};${d}${u} font-display: block; }`)}return o.push(`:root { ${a.join(" ")} }`),o.join(`
`)}}}class Tpe{getIcon(e){const t=kpe();let i=e.defaults;for(;at.isThemeIcon(i);){const n=t.getIcon(i.id);if(!n)return;i=n.defaults}return i}}const Bf="vs",Ey="vs-dark",tv="hc-black",iv="hc-light",Npe=_n.as(nfe.ColorContribution),N6e=_n.as(Hhe.ThemingContribution);class Rpe{constructor(e,t){this.semanticHighlighting=!1,this.themeData=t;const i=t.base;e.length>0?(HR(e)?this.id=e:this.id=i+" "+e,this.themeName=e):(this.id=i,this.themeName=i),this.colors=null,this.defaultColors=Object.create(null),this._tokenTheme=null}get base(){return this.themeData.base}notifyBaseUpdated(){this.themeData.inherit&&(this.colors=null,this._tokenTheme=null)}getColors(){if(!this.colors){const e=new Map;for(const t in this.themeData.colors)e.set(t,fe.fromHex(this.themeData.colors[t]));if(this.themeData.inherit){const t=iH(this.themeData.base);for(const i in t.colors)e.has(i)||e.set(i,fe.fromHex(t.colors[i]))}this.colors=e}return this.colors}getColor(e,t){const i=this.getColors().get(e);if(i)return i;if(t!==!1)return this.getDefault(e)}getDefault(e){let t=this.defaultColors[e];return t||(t=Npe.resolveDefaultColor(e,this),this.defaultColors[e]=t,t)}defines(e){return this.getColors().has(e)}get type(){switch(this.base){case Bf:return uc.LIGHT;case tv:return uc.HIGH_CONTRAST_DARK;case iv:return uc.HIGH_CONTRAST_LIGHT;default:return uc.DARK}}get tokenTheme(){if(!this._tokenTheme){let e=[],t=[];if(this.themeData.inherit){const r=iH(this.themeData.base);e=r.rules,r.encodedTokensColors&&(t=r.encodedTokensColors)}const i=this.themeData.colors["editor.foreground"],n=this.themeData.colors["editor.background"];if(i||n){const r={token:""};i&&(r.foreground=i),n&&(r.background=n),e.push(r)}e=e.concat(this.themeData.rules),this.themeData.encodedTokensColors&&(t=this.themeData.encodedTokensColors),this._tokenTheme=Lpe.createFromRawTokenTheme(e,t)}return this._tokenTheme}getTokenStyleMetadata(e,t,i){const r=this.tokenTheme._match([e].concat(t).join(".")).metadata,o=Go.getForeground(r),a=Go.getFontStyle(r);return{foreground:o,italic:!!(a&1),bold:!!(a&2),underline:!!(a&4),strikethrough:!!(a&8)}}}function HR(s){return s===Bf||s===Ey||s===tv||s===iv}function iH(s){switch(s){case Bf:return S6e;case Ey:return x6e;case tv:return L6e;case iv:return k6e}}function IN(s){const e=iH(s);return new Rpe(s,e)}class R6e extends te{constructor(){super(),this._onColorThemeChange=this._register(new Z),this.onDidColorThemeChange=this._onColorThemeChange.event,this._onProductIconThemeChange=this._register(new Z),this.onDidProductIconThemeChange=this._onProductIconThemeChange.event,this._environment=Object.create(null),this._builtInProductIconTheme=new Tpe,this._autoDetectHighContrast=!0,this._knownThemes=new Map,this._knownThemes.set(Bf,IN(Bf)),this._knownThemes.set(Ey,IN(Ey)),this._knownThemes.set(tv,IN(tv)),this._knownThemes.set(iv,IN(iv));const e=this._register(T6e(this));this._codiconCSS=e.getCSS(),this._themeCSS="",this._allCSS=`${this._codiconCSS}
${this._themeCSS}`,this._globalStyleElement=null,this._styleElements=[],this._colorMapOverride=null,this.setTheme(Bf),this._onOSSchemeChanged(),this._register(e.onDidChange(()=>{this._codiconCSS=e.getCSS(),this._updateCSS()})),Mue(Ri,"(forced-colors: active)",()=>{this._onOSSchemeChanged()})}registerEditorContainer(e){return $2(e)?this._registerShadowDomContainer(e):this._registerRegularEditorContainer()}_registerRegularEditorContainer(){return this._globalStyleElement||(this._globalStyleElement=Rl(void 0,e=>{e.className="monaco-colors",e.textContent=this._allCSS}),this._styleElements.push(this._globalStyleElement)),te.None}_registerShadowDomContainer(e){const t=Rl(e,i=>{i.className="monaco-colors",i.textContent=this._allCSS});return this._styleElements.push(t),{dispose:()=>{for(let i=0;i<this._styleElements.length;i++)if(this._styleElements[i]===t){this._styleElements.splice(i,1);return}}}}defineTheme(e,t){if(!/^[a-z0-9\-]+$/i.test(e))throw new Error("Illegal theme name!");if(!HR(t.base)&&!HR(e))throw new Error("Illegal theme base!");this._knownThemes.set(e,new Rpe(e,t)),HR(e)&&this._knownThemes.forEach(i=>{i.base===e&&i.notifyBaseUpdated()}),this._theme.themeName===e&&this.setTheme(e)}getColorTheme(){return this._theme}setColorMapOverride(e){this._colorMapOverride=e,this._updateThemeOrColorMap()}setTheme(e){let t;this._knownThemes.has(e)?t=this._knownThemes.get(e):t=this._knownThemes.get(Bf),this._updateActualTheme(t)}_updateActualTheme(e){!e||this._theme===e||(this._theme=e,this._updateThemeOrColorMap())}_onOSSchemeChanged(){if(this._autoDetectHighContrast){const e=Ri.matchMedia("(forced-colors: active)").matches;if(e!==su(this._theme.type)){let t;m1(this._theme.type)?t=e?tv:Ey:t=e?iv:Bf,this._updateActualTheme(this._knownThemes.get(t))}}}setAutoDetectHighContrast(e){this._autoDetectHighContrast=e,this._onOSSchemeChanged()}_updateThemeOrColorMap(){const e=[],t={},i={addRule:o=>{t[o]||(e.push(o),t[o]=!0)}};N6e.getThemingParticipants().forEach(o=>o(this._theme,i,this._environment));const n=[];for(const o of Npe.getColors()){const a=this._theme.getColor(o.id,!0);a&&n.push(`${oK(o.id)}: ${a.toString()};`)}i.addRule(`.monaco-editor, .monaco-diff-editor, .monaco-component { ${n.join(`
`)} }`);const r=this._colorMapOverride||this._theme.tokenTheme.getColorMap();i.addRule(y6e(r)),this._themeCSS=e.join(`
`),this._updateCSS(),Ln.setColorMap(r),this._onColorThemeChange.fire(this._theme)}_updateCSS(){this._allCSS=`${this._codiconCSS}
${this._themeCSS}`,this._styleElements.forEach(e=>e.textContent=this._allCSS)}getFileIconTheme(){return{hasFileIcons:!1,hasFolderIcons:!1,hidesExplorerArrows:!1}}getProductIconTheme(){return this._builtInProductIconTheme}}const Wl=Ht("themeService");var A6e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},tB=function(s,e){return function(t,i){e(t,i,s)}};let nH=class extends te{constructor(e,t,i){super(),this._contextKeyService=e,this._layoutService=t,this._configurationService=i,this._accessibilitySupport=0,this._onDidChangeScreenReaderOptimized=new Z,this._onDidChangeReducedMotion=new Z,this._onDidChangeLinkUnderline=new Z,this._accessibilityModeEnabledContext=XE.bindTo(this._contextKeyService);const n=()=>this._accessibilityModeEnabledContext.set(this.isScreenReaderOptimized());this._register(this._configurationService.onDidChangeConfiguration(o=>{o.affectsConfiguration("editor.accessibilitySupport")&&(n(),this._onDidChangeScreenReaderOptimized.fire()),o.affectsConfiguration("workbench.reduceMotion")&&(this._configMotionReduced=this._configurationService.getValue("workbench.reduceMotion"),this._onDidChangeReducedMotion.fire())})),n(),this._register(this.onDidChangeScreenReaderOptimized(()=>n()));const r=Ri.matchMedia("(prefers-reduced-motion: reduce)");this._systemMotionReduced=r.matches,this._configMotionReduced=this._configurationService.getValue("workbench.reduceMotion"),this._linkUnderlinesEnabled=this._configurationService.getValue("accessibility.underlineLinks"),this.initReducedMotionListeners(r),this.initLinkUnderlineListeners()}initReducedMotionListeners(e){this._register(oe(e,"change",()=>{this._systemMotionReduced=e.matches,this._configMotionReduced==="auto"&&this._onDidChangeReducedMotion.fire()}));const t=()=>{const i=this.isMotionReduced();this._layoutService.mainContainer.classList.toggle("reduce-motion",i),this._layoutService.mainContainer.classList.toggle("enable-motion",!i)};t(),this._register(this.onDidChangeReducedMotion(()=>t()))}initLinkUnderlineListeners(){this._register(this._configurationService.onDidChangeConfiguration(t=>{if(t.affectsConfiguration("accessibility.underlineLinks")){const i=this._configurationService.getValue("accessibility.underlineLinks");this._linkUnderlinesEnabled=i,this._onDidChangeLinkUnderline.fire()}}));const e=()=>{const t=this._linkUnderlinesEnabled;this._layoutService.mainContainer.classList.toggle("underline-links",t)};e(),this._register(this.onDidChangeLinkUnderlines(()=>e()))}onDidChangeLinkUnderlines(e){return this._onDidChangeLinkUnderline.event(e)}get onDidChangeScreenReaderOptimized(){return this._onDidChangeScreenReaderOptimized.event}isScreenReaderOptimized(){const e=this._configurationService.getValue("editor.accessibilitySupport");return e==="on"||e==="auto"&&this._accessibilitySupport===2}get onDidChangeReducedMotion(){return this._onDidChangeReducedMotion.event}isMotionReduced(){const e=this._configMotionReduced;return e==="on"||e==="auto"&&this._systemMotionReduced}getAccessibilitySupport(){return this._accessibilitySupport}};nH=A6e([tB(0,ct),tB(1,g_),tB(2,At)],nH);var ZF=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},xh=function(s,e){return function(t,i){e(t,i,s)}},gC,aL;let sH=class{constructor(e,t,i){this._commandService=e,this._keybindingService=t,this._hiddenStates=new rH(i)}createMenu(e,t,i){return new XA(e,this._hiddenStates,{emitEventsForSubmenuChanges:!1,eventDebounceDelay:50,...i},this._commandService,this._keybindingService,t)}getMenuActions(e,t,i){const n=new XA(e,this._hiddenStates,{emitEventsForSubmenuChanges:!1,eventDebounceDelay:50,...i},this._commandService,this._keybindingService,t),r=n.getActions(i);return n.dispose(),r}resetHiddenStates(e){this._hiddenStates.reset(e)}};sH=ZF([xh(0,Hi),xh(1,pi),xh(2,md)],sH);var uv;let rH=(uv=class{constructor(e){this._storageService=e,this._disposables=new ce,this._onDidChange=new Z,this.onDidChange=this._onDidChange.event,this._ignoreChangeEvent=!1,this._hiddenByDefaultCache=new Map;try{const t=e.get(gC._key,0,"{}");this._data=JSON.parse(t)}catch{this._data=Object.create(null)}this._disposables.add(e.onDidChangeValue(0,gC._key,this._disposables)(()=>{if(!this._ignoreChangeEvent)try{const t=e.get(gC._key,0,"{}");this._data=JSON.parse(t)}catch(t){console.log("FAILED to read storage after UPDATE",t)}this._onDidChange.fire()}))}dispose(){this._onDidChange.dispose(),this._disposables.dispose()}_isHiddenByDefault(e,t){return this._hiddenByDefaultCache.get(`${e.id}/${t}`)??!1}setDefaultState(e,t,i){this._hiddenByDefaultCache.set(`${e.id}/${t}`,i)}isHidden(e,t){var r;const i=this._isHiddenByDefault(e,t),n=((r=this._data[e.id])==null?void 0:r.includes(t))??!1;return i?!n:n}updateHidden(e,t,i){this._isHiddenByDefault(e,t)&&(i=!i);const r=this._data[e.id];if(i)r?r.indexOf(t)<0&&r.push(t):this._data[e.id]=[t];else if(r){const o=r.indexOf(t);o>=0&&kTe(r,o),r.length===0&&delete this._data[e.id]}this._persist()}reset(e){if(e===void 0)this._data=Object.create(null),this._persist();else{for(const{id:t}of e)this._data[t]&&delete this._data[t];this._persist()}}_persist(){try{this._ignoreChangeEvent=!0;const e=JSON.stringify(this._data);this._storageService.store(gC._key,e,0,0)}finally{this._ignoreChangeEvent=!1}}},gC=uv,uv._key="menu.hiddenCommands",uv);rH=gC=ZF([xh(0,md)],rH);class jL{constructor(e,t){this._id=e,this._collectContextKeysForSubmenus=t,this._menuGroups=[],this._allMenuIds=new Set,this._structureContextKeys=new Set,this._preconditionContextKeys=new Set,this._toggledContextKeys=new Set,this.refresh()}get allMenuIds(){return this._allMenuIds}get structureContextKeys(){return this._structureContextKeys}get preconditionContextKeys(){return this._preconditionContextKeys}get toggledContextKeys(){return this._toggledContextKeys}refresh(){this._menuGroups.length=0,this._allMenuIds.clear(),this._structureContextKeys.clear(),this._preconditionContextKeys.clear(),this._toggledContextKeys.clear();const e=this._sort(Os.getMenuItems(this._id));let t;for(const i of e){const n=i.group||"";(!t||t[0]!==n)&&(t=[n,[]],this._menuGroups.push(t)),t[1].push(i),this._collectContextKeysAndSubmenuIds(i)}this._allMenuIds.add(this._id)}_sort(e){return e}_collectContextKeysAndSubmenuIds(e){if(jL._fillInKbExprKeys(e.when,this._structureContextKeys),my(e)){if(e.command.precondition&&jL._fillInKbExprKeys(e.command.precondition,this._preconditionContextKeys),e.command.toggled){const t=e.command.toggled.condition||e.command.toggled;jL._fillInKbExprKeys(t,this._toggledContextKeys)}}else this._collectContextKeysForSubmenus&&(Os.getMenuItems(e.submenu).forEach(this._collectContextKeysAndSubmenuIds,this),this._allMenuIds.add(e.submenu))}static _fillInKbExprKeys(e,t){if(e)for(const i of e.keys())t.add(i)}}let oH=aL=class extends jL{constructor(e,t,i,n,r,o){super(e,i),this._hiddenStates=t,this._commandService=n,this._keybindingService=r,this._contextKeyService=o,this.refresh()}createActionGroups(e){const t=[];for(const i of this._menuGroups){const[n,r]=i;let o;for(const a of r)if(this._contextKeyService.contextMatchesRules(a.when)){const l=my(a);l&&this._hiddenStates.setDefaultState(this._id,a.command.id,!!a.isHiddenByDefault);const c=P6e(this._id,l?a.command:a,this._hiddenStates);if(l){const d=Ape(this._commandService,this._keybindingService,a.command.id,a.when);(o??(o=[])).push(new Ra(a.command,a.alt,e,c,d,this._contextKeyService,this._commandService))}else{const d=new aL(a.submenu,this._hiddenStates,this._collectContextKeysForSubmenus,this._commandService,this._keybindingService,this._contextKeyService).createActionGroups(e),u=ks.join(...d.map(h=>h[1]));u.length>0&&(o??(o=[])).push(new _y(a,c,u))}}o&&o.length>0&&t.push([n,o])}return t}_sort(e){return e.sort(aL._compareMenuItems)}static _compareMenuItems(e,t){const i=e.group,n=t.group;if(i!==n){if(i){if(!n)return-1}else return 1;if(i==="navigation")return-1;if(n==="navigation")return 1;const a=i.localeCompare(n);if(a!==0)return a}const r=e.order||0,o=t.order||0;return r<o?-1:r>o?1:aL._compareTitles(my(e)?e.command.title:e.title,my(t)?t.command.title:t.title)}static _compareTitles(e,t){const i=typeof e=="string"?e:e.original,n=typeof t=="string"?t:t.original;return i.localeCompare(n)}};oH=aL=ZF([xh(3,Hi),xh(4,pi),xh(5,ct)],oH);let XA=class{constructor(e,t,i,n,r,o){this._disposables=new ce,this._menuInfo=new oH(e,t,i.emitEventsForSubmenuChanges,n,r,o);const a=new xi(()=>{this._menuInfo.refresh(),this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!0,isToggleChange:!0})},i.eventDebounceDelay);this._disposables.add(a),this._disposables.add(Os.onDidChangeMenu(u=>{for(const h of this._menuInfo.allMenuIds)if(u.has(h)){a.schedule();break}}));const l=this._disposables.add(new ce),c=u=>{let h=!1,g=!1,p=!1;for(const _ of u)if(h=h||_.isStructuralChange,g=g||_.isEnablementChange,p=p||_.isToggleChange,h&&g&&p)break;return{menu:this,isStructuralChange:h,isEnablementChange:g,isToggleChange:p}},d=()=>{l.add(o.onDidChangeContext(u=>{const h=u.affectsSome(this._menuInfo.structureContextKeys),g=u.affectsSome(this._menuInfo.preconditionContextKeys),p=u.affectsSome(this._menuInfo.toggledContextKeys);(h||g||p)&&this._onDidChange.fire({menu:this,isStructuralChange:h,isEnablementChange:g,isToggleChange:p})})),l.add(t.onDidChange(u=>{this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!1,isToggleChange:!1})}))};this._onDidChange=new hue({onWillAddFirstListener:d,onDidRemoveLastListener:l.clear.bind(l),delay:i.eventDebounceDelay,merge:c}),this.onDidChange=this._onDidChange.event}getActions(e){return this._menuInfo.createActionGroups(e)}dispose(){this._disposables.dispose(),this._onDidChange.dispose()}};XA=ZF([xh(3,Hi),xh(4,pi),xh(5,ct)],XA);function P6e(s,e,t){const i=VAe(e)?e.submenu.id:e.id,n=typeof e.title=="string"?e.title:e.title.value,r=Yb({id:`hide/${s.id}/${i}`,label:b("hide.label","Hide '{0}'",n),run(){t.updateHidden(s,i,!0)}}),o=Yb({id:`toggle/${s.id}/${i}`,label:n,get checked(){return!t.isHidden(s,i)},run(){t.updateHidden(s,i,!!this.checked)}});return{hide:r,toggle:o,get isHidden(){return!o.checked}}}function Ape(s,e,t,i=void 0,n=!0){return Yb({id:`configureKeybinding/${t}`,label:b("configure keybinding","Configure Keybinding"),enabled:n,run(){const o=!!!e.lookupKeybinding(t)&&i?i.serialize():void 0;s.executeCommand("workbench.action.openGlobalKeybindings",`@command:${t}`+(o?` +when:${o}`:""))}})}var M6e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},ase=function(s,e){return function(t,i){e(t,i,s)}},aH;const lse="application/vnd.code.resources";var hv;let lH=(hv=class extends te{constructor(e,t){super(),this.layoutService=e,this.logService=t,this.mapTextToType=new Map,this.findText="",this.resources=[],this.resourcesStateHash=void 0,(jm||Oue)&&this.installWebKitWriteTextWorkaround(),this._register(De.runAndSubscribe(nF,({window:i,disposables:n})=>{n.add(oe(i.document,"copy",()=>this.clearResourcesState()))},{window:Ri,disposables:this._store}))}installWebKitWriteTextWorkaround(){const e=()=>{const t=new lS;this.webKitPendingClipboardWritePromise&&!this.webKitPendingClipboardWritePromise.isSettled&&this.webKitPendingClipboardWritePromise.cancel(),this.webKitPendingClipboardWritePromise=t,Zx().navigator.clipboard.write([new ClipboardItem({"text/plain":t.p})]).catch(async i=>{(!(i instanceof Error)||i.name!=="NotAllowedError"||!t.isRejected)&&this.logService.error(i)})};this._register(De.runAndSubscribe(this.layoutService.onDidAddContainer,({container:t,disposables:i})=>{i.add(oe(t,"click",e)),i.add(oe(t,"keydown",e))},{container:this.layoutService.mainContainer,disposables:this._store}))}async writeText(e,t){if(this.clearResourcesState(),t){this.mapTextToType.set(t,e);return}if(this.webKitPendingClipboardWritePromise)return this.webKitPendingClipboardWritePromise.complete(e);try{return await Zx().navigator.clipboard.writeText(e)}catch(i){console.error(i)}this.fallbackWriteText(e)}fallbackWriteText(e){const t=cS(),i=t.activeElement,n=t.body.appendChild(ke("textarea",{"aria-hidden":!0}));n.style.height="1px",n.style.width="1px",n.style.position="absolute",n.value=e,n.focus(),n.select(),t.execCommand("copy"),Ls(i)&&i.focus(),n.remove()}async readText(e){if(e)return this.mapTextToType.get(e)||"";try{return await Zx().navigator.clipboard.readText()}catch(t){console.error(t)}return""}async readFindText(){return this.findText}async writeFindText(e){this.findText=e}async readResources(){try{const t=await Zx().navigator.clipboard.read();for(const i of t)if(i.types.includes(`web ${lse}`)){const n=await i.getType(`web ${lse}`);return JSON.parse(await n.text()).map(o=>Je.from(o))}}catch{}const e=await this.computeResourcesStateHash();return this.resourcesStateHash!==e&&this.clearResourcesState(),this.resources}async computeResourcesStateHash(){if(this.resources.length===0)return;const e=await this.readText();return tF(e.substring(0,aH.MAX_RESOURCE_STATE_SOURCE_LENGTH))}clearInternalState(){this.clearResourcesState()}clearResourcesState(){this.resources=[],this.resourcesStateHash=void 0}},aH=hv,hv.MAX_RESOURCE_STATE_SOURCE_LENGTH=1e3,hv);lH=aH=M6e([ase(0,g_),ase(1,pr)],lH);const Wg=Ht("clipboardService");var O6e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},F6e=function(s,e){return function(t,i){e(t,i,s)}};const $L="data-keybinding-context";let _G=class{constructor(e,t){this._id=e,this._parent=t,this._value=Object.create(null),this._value._contextId=e}get value(){return{...this._value}}setValue(e,t){return this._value[e]!==t?(this._value[e]=t,!0):!1}removeValue(e){return e in this._value?(delete this._value[e],!0):!1}getValue(e){const t=this._value[e];return typeof t>"u"&&this._parent?this._parent.getValue(e):t}};const nO=class nO extends _G{constructor(){super(-1,null)}setValue(e,t){return!1}removeValue(e){return!1}getValue(e){}};nO.INSTANCE=new nO;let T1=nO;const Sk=class Sk extends _G{constructor(e,t,i){super(e,null),this._configurationService=t,this._values=Cy.forConfigKeys(),this._listener=this._configurationService.onDidChangeConfiguration(n=>{if(n.source===7){const r=Array.from(this._values,([o])=>o);this._values.clear(),i.fire(new dse(r))}else{const r=[];for(const o of n.affectedKeys){const a=`config.${o}`,l=this._values.findSuperstr(a);l!==void 0&&(r.push(...Kt.map(l,([c])=>c)),this._values.deleteSuperstr(a)),this._values.has(a)&&(r.push(a),this._values.delete(a))}i.fire(new dse(r))}})}dispose(){this._listener.dispose()}getValue(e){if(e.indexOf(Sk._keyPrefix)!==0)return super.getValue(e);if(this._values.has(e))return this._values.get(e);const t=e.substr(Sk._keyPrefix.length),i=this._configurationService.getValue(t);let n;switch(typeof i){case"number":case"boolean":case"string":n=i;break;default:Array.isArray(i)?n=JSON.stringify(i):n=i}return this._values.set(e,n),n}setValue(e,t){return super.setValue(e,t)}removeValue(e){return super.removeValue(e)}};Sk._keyPrefix="config.";let cH=Sk;class V6e{constructor(e,t,i){this._service=e,this._key=t,this._defaultValue=i,this.reset()}set(e){this._service.setContext(this._key,e)}reset(){typeof this._defaultValue>"u"?this._service.removeContext(this._key):this._service.setContext(this._key,this._defaultValue)}get(){return this._service.getContextKeyValue(this._key)}}class cse{constructor(e){this.key=e}affectsSome(e){return e.has(this.key)}allKeysContainedIn(e){return this.affectsSome(e)}}class dse{constructor(e){this.keys=e}affectsSome(e){for(const t of this.keys)if(e.has(t))return!0;return!1}allKeysContainedIn(e){return this.keys.every(t=>e.has(t))}}class B6e{constructor(e){this.events=e}affectsSome(e){for(const t of this.events)if(t.affectsSome(e))return!0;return!1}allKeysContainedIn(e){return this.events.every(t=>t.allKeysContainedIn(e))}}function W6e(s,e){return s.allKeysContainedIn(new Set(Object.keys(e)))}class Ppe extends te{constructor(e){super(),this._onDidChangeContext=this._register(new aw({merge:t=>new B6e(t)})),this.onDidChangeContext=this._onDidChangeContext.event,this._isDisposed=!1,this._myContextId=e}createKey(e,t){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");return new V6e(this,e,t)}bufferChangeEvents(e){this._onDidChangeContext.pause();try{e()}finally{this._onDidChangeContext.resume()}}createScoped(e){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");return new H6e(this,e)}contextMatchesRules(e){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");const t=this.getContextValuesContainer(this._myContextId);return e?e.evaluate(t):!0}getContextKeyValue(e){if(!this._isDisposed)return this.getContextValuesContainer(this._myContextId).getValue(e)}setContext(e,t){if(this._isDisposed)return;const i=this.getContextValuesContainer(this._myContextId);i&&i.setValue(e,t)&&this._onDidChangeContext.fire(new cse(e))}removeContext(e){this._isDisposed||this.getContextValuesContainer(this._myContextId).removeValue(e)&&this._onDidChangeContext.fire(new cse(e))}getContext(e){return this._isDisposed?T1.INSTANCE:this.getContextValuesContainer(z6e(e))}dispose(){super.dispose(),this._isDisposed=!0}}let dH=class extends Ppe{constructor(e){super(0),this._contexts=new Map,this._lastContextId=0;const t=this._register(new cH(this._myContextId,e,this._onDidChangeContext));this._contexts.set(this._myContextId,t)}getContextValuesContainer(e){return this._isDisposed?T1.INSTANCE:this._contexts.get(e)||T1.INSTANCE}createChildContext(e=this._myContextId){if(this._isDisposed)throw new Error("ContextKeyService has been disposed");const t=++this._lastContextId;return this._contexts.set(t,new _G(t,this.getContextValuesContainer(e))),t}disposeContext(e){this._isDisposed||this._contexts.delete(e)}};dH=O6e([F6e(0,At)],dH);class H6e extends Ppe{constructor(e,t){if(super(e.createChildContext()),this._parentChangeListener=this._register(new Es),this._parent=e,this._updateParentChangeListener(),this._domNode=t,this._domNode.hasAttribute($L)){let i="";this._domNode.classList&&(i=Array.from(this._domNode.classList.values()).join(", ")),console.error(`Element already has context attribute${i?": "+i:""}`)}this._domNode.setAttribute($L,String(this._myContextId))}_updateParentChangeListener(){this._parentChangeListener.value=this._parent.onDidChangeContext(e=>{const i=this._parent.getContextValuesContainer(this._myContextId).value;W6e(e,i)||this._onDidChangeContext.fire(e)})}dispose(){this._isDisposed||(this._parent.disposeContext(this._myContextId),this._domNode.removeAttribute($L),super.dispose())}getContextValuesContainer(e){return this._isDisposed?T1.INSTANCE:this._parent.getContextValuesContainer(e)}createChildContext(e=this._myContextId){if(this._isDisposed)throw new Error("ScopedContextKeyService has been disposed");return this._parent.createChildContext(e)}disposeContext(e){this._isDisposed||this._parent.disposeContext(e)}}function z6e(s){for(;s;){if(s.hasAttribute($L)){const e=s.getAttribute($L);return e?parseInt(e,10):NaN}s=s.parentElement}return 0}function U6e(s,e,t){s.get(ct).createKey(String(e),j6e(t))}function j6e(s){return Zde(s,e=>{if(typeof e=="object"&&e.$mid===1)return Je.revive(e).toString();if(e instanceof Je)return e.toString()})}Gt.registerCommand("_setContext",U6e);Gt.registerCommand({id:"getContextKeyInfo",handler(){return[...Oe.all()].sort((s,e)=>s.key.localeCompare(e.key))},metadata:{description:b("getContextKeyInfo","A command that returns information about context keys"),args:[]}});Gt.registerCommand("_generateContextKeyInfo",function(){const s=[],e=new Set;for(const t of Oe.all())e.has(t.key)||(e.add(t.key),s.push(t));s.sort((t,i)=>t.key.localeCompare(i.key)),console.log(JSON.stringify(s,void 0,2))});let $6e=class{constructor(e,t){this.key=e,this.data=t,this.incoming=new Map,this.outgoing=new Map}};class use{constructor(e){this._hashFn=e,this._nodes=new Map}roots(){const e=[];for(const t of this._nodes.values())t.outgoing.size===0&&e.push(t);return e}insertEdge(e,t){const i=this.lookupOrInsertNode(e),n=this.lookupOrInsertNode(t);i.outgoing.set(n.key,n),n.incoming.set(i.key,i)}removeNode(e){const t=this._hashFn(e);this._nodes.delete(t);for(const i of this._nodes.values())i.outgoing.delete(t),i.incoming.delete(t)}lookupOrInsertNode(e){const t=this._hashFn(e);let i=this._nodes.get(t);return i||(i=new $6e(t,e),this._nodes.set(t,i)),i}isEmpty(){return this._nodes.size===0}toString(){const e=[];for(const[t,i]of this._nodes)e.push(`${t}
	(-> incoming)[${[...i.incoming.keys()].join(", ")}]
	(outgoing ->)[${[...i.outgoing.keys()].join(",")}]
`);return e.join(`
`)}findCycleSlow(){for(const[e,t]of this._nodes){const i=new Set([e]),n=this._findCycle(t,i);if(n)return n}}_findCycle(e,t){for(const[i,n]of e.outgoing){if(t.has(i))return[...t,i].join(" -> ");t.add(i);const r=this._findCycle(n,t);if(r)return r;t.delete(i)}}}class xS{constructor(...e){this._entries=new Map;for(const[t,i]of e)this.set(t,i)}set(e,t){const i=this._entries.get(e);return this._entries.set(e,t),i}get(e){return this._entries.get(e)}}const q6e=!1;class hse extends Error{constructor(e){super("cyclic dependency between services"),this.message=e.findCycleSlow()??`UNABLE to detect cycle, dumping graph: 
${e.toString()}`}}class ZA{constructor(e=new xS,t=!1,i,n=q6e){this._services=e,this._strict=t,this._parent=i,this._enableTracing=n,this._isDisposed=!1,this._servicesToMaybeDispose=new Set,this._children=new Set,this._activeInstantiations=new Set,this._services.set(Xe,this),this._globalGraph=n?(i==null?void 0:i._globalGraph)??new use(r=>r):void 0}dispose(){if(!this._isDisposed){this._isDisposed=!0,Ni(this._children),this._children.clear();for(const e of this._servicesToMaybeDispose)Y4(e)&&e.dispose();this._servicesToMaybeDispose.clear()}}_throwIfDisposed(){if(this._isDisposed)throw new Error("InstantiationService has been disposed")}createChild(e,t){this._throwIfDisposed();const i=this,n=new class extends ZA{dispose(){i._children.delete(n),super.dispose()}}(e,this._strict,this,this._enableTracing);return this._children.add(n),t==null||t.add(n),n}invokeFunction(e,...t){this._throwIfDisposed();const i=qL.traceInvocation(this._enableTracing,e);let n=!1;try{return e({get:o=>{if(n)throw yq("service accessor is only valid during the invocation of its target method");const a=this._getOrCreateServiceInstance(o,i);if(!a)throw new Error(`[invokeFunction] unknown service '${o}'`);return a}},...t)}finally{n=!0,i.stop()}}createInstance(e,...t){this._throwIfDisposed();let i,n;return e instanceof rh?(i=qL.traceCreation(this._enableTracing,e.ctor),n=this._createInstance(e.ctor,e.staticArguments.concat(t),i)):(i=qL.traceCreation(this._enableTracing,e),n=this._createInstance(e,t,i)),i.stop(),n}_createInstance(e,t=[],i){const n=Xd.getServiceDependencies(e).sort((a,l)=>a.index-l.index),r=[];for(const a of n){const l=this._getOrCreateServiceInstance(a.id,i);l||this._throwIfStrict(`[createInstance] ${e.name} depends on UNKNOWN service ${a.id}.`,!1),r.push(l)}const o=n.length>0?n[0].index:t.length;if(t.length!==o){console.trace(`[createInstance] First service dependency of ${e.name} at position ${o+1} conflicts with ${t.length} static arguments`);const a=o-t.length;a>0?t=t.concat(new Array(a)):t=t.slice(0,o)}return Reflect.construct(e,t.concat(r))}_setCreatedServiceInstance(e,t){if(this._services.get(e)instanceof rh)this._services.set(e,t);else if(this._parent)this._parent._setCreatedServiceInstance(e,t);else throw new Error("illegalState - setting UNKNOWN service instance")}_getServiceInstanceOrDescriptor(e){const t=this._services.get(e);return!t&&this._parent?this._parent._getServiceInstanceOrDescriptor(e):t}_getOrCreateServiceInstance(e,t){this._globalGraph&&this._globalGraphImplicitDependency&&this._globalGraph.insertEdge(this._globalGraphImplicitDependency,String(e));const i=this._getServiceInstanceOrDescriptor(e);return i instanceof rh?this._safeCreateAndCacheServiceInstance(e,i,t.branch(e,!0)):(t.branch(e,!1),i)}_safeCreateAndCacheServiceInstance(e,t,i){if(this._activeInstantiations.has(e))throw new Error(`illegal state - RECURSIVELY instantiating service '${e}'`);this._activeInstantiations.add(e);try{return this._createAndCacheServiceInstance(e,t,i)}finally{this._activeInstantiations.delete(e)}}_createAndCacheServiceInstance(e,t,i){var l;const n=new use(c=>c.id.toString());let r=0;const o=[{id:e,desc:t,_trace:i}],a=new Set;for(;o.length;){const c=o.pop();if(!a.has(String(c.id))){if(a.add(String(c.id)),n.lookupOrInsertNode(c),r++>1e3)throw new hse(n);for(const d of Xd.getServiceDependencies(c.desc.ctor)){const u=this._getServiceInstanceOrDescriptor(d.id);if(u||this._throwIfStrict(`[createInstance] ${e} depends on ${d.id} which is NOT registered.`,!0),(l=this._globalGraph)==null||l.insertEdge(String(c.id),String(d.id)),u instanceof rh){const h={id:d.id,desc:u,_trace:c._trace.branch(d.id,!0)};n.insertEdge(c,h),o.push(h)}}}}for(;;){const c=n.roots();if(c.length===0){if(!n.isEmpty())throw new hse(n);break}for(const{data:d}of c){if(this._getServiceInstanceOrDescriptor(d.id)instanceof rh){const h=this._createServiceInstanceWithOwner(d.id,d.desc.ctor,d.desc.staticArguments,d.desc.supportsDelayedInstantiation,d._trace);this._setCreatedServiceInstance(d.id,h)}n.removeNode(d)}}return this._getServiceInstanceOrDescriptor(e)}_createServiceInstanceWithOwner(e,t,i=[],n,r){if(this._services.get(e)instanceof rh)return this._createServiceInstance(e,t,i,n,r,this._servicesToMaybeDispose);if(this._parent)return this._parent._createServiceInstanceWithOwner(e,t,i,n,r);throw new Error(`illegalState - creating UNKNOWN service instance ${t.name}`)}_createServiceInstance(e,t,i=[],n,r,o){if(n){const a=new ZA(void 0,this._strict,this,this._enableTracing);a._globalGraphImplicitDependency=String(e);const l=new Map,c=new u2e(()=>{const d=a._createInstance(t,i,r);for(const[u,h]of l){const g=d[u];if(typeof g=="function")for(const p of h)p.disposable=g.apply(d,p.listener)}return l.clear(),o.add(d),d});return new Proxy(Object.create(null),{get(d,u){if(!c.isInitialized&&typeof u=="string"&&(u.startsWith("onDid")||u.startsWith("onWill"))){let p=l.get(u);return p||(p=new _o,l.set(u,p)),(v,C,y)=>{if(c.isInitialized)return c.value[u](v,C,y);{const x={listener:[v,C,y],disposable:void 0},L=p.push(x);return Ye(()=>{var A;L(),(A=x.disposable)==null||A.dispose()})}}}if(u in d)return d[u];const h=c.value;let g=h[u];return typeof g!="function"||(g=g.bind(h),d[u]=g),g},set(d,u,h){return c.value[u]=h,!0},getPrototypeOf(d){return t.prototype}})}else{const a=this._createInstance(t,i,r);return o.add(a),a}}_throwIfStrict(e,t){if(t&&console.warn(e),this._strict)throw new Error(e)}}const ol=class ol{static traceInvocation(e,t){return e?new ol(2,t.name||new Error().stack.split(`
`).slice(3,4).join(`
`)):ol._None}static traceCreation(e,t){return e?new ol(1,t.name):ol._None}constructor(e,t){this.type=e,this.name=t,this._start=Date.now(),this._dep=[]}branch(e,t){const i=new ol(3,e.toString());return this._dep.push([e,t,i]),i}stop(){const e=Date.now()-this._start;ol._totals+=e;let t=!1;function i(r,o){const a=[],l=new Array(r+1).join("	");for(const[c,d,u]of o._dep)if(d&&u){t=!0,a.push(`${l}CREATES -> ${c}`);const h=i(r+1,u);h&&a.push(h)}else a.push(`${l}uses -> ${c}`);return a.join(`
`)}const n=[`${this.type===1?"CREATE":"CALL"} ${this.name}`,`${i(1,this)}`,`DONE, took ${e.toFixed(2)}ms (grand total ${ol._totals.toFixed(2)}ms)`];(e>2||t)&&ol.all.add(n.join(`
`))}};ol.all=new Set,ol._None=new class extends ol{constructor(){super(0,null)}stop(){}branch(){return this}},ol._totals=0;let qL=ol;const K6e=new Set([gt.inMemory,gt.vscodeSourceControl,gt.walkThrough,gt.walkThroughSnippet,gt.vscodeChatCodeBlock]);class G6e{constructor(){this._byResource=new Fs,this._byOwner=new Map}set(e,t,i){let n=this._byResource.get(e);n||(n=new Map,this._byResource.set(e,n)),n.set(t,i);let r=this._byOwner.get(t);r||(r=new Fs,this._byOwner.set(t,r)),r.set(e,i)}get(e,t){const i=this._byResource.get(e);return i==null?void 0:i.get(t)}delete(e,t){let i=!1,n=!1;const r=this._byResource.get(e);r&&(i=r.delete(t));const o=this._byOwner.get(t);if(o&&(n=o.delete(e)),i!==n)throw new Error("illegal state");return i&&n}values(e){var t,i;return typeof e=="string"?((t=this._byOwner.get(e))==null?void 0:t.values())??Kt.empty():Je.isUri(e)?((i=this._byResource.get(e))==null?void 0:i.values())??Kt.empty():Kt.map(Kt.concat(...this._byOwner.values()),n=>n[1])}}class Q6e{constructor(e){this.errors=0,this.infos=0,this.warnings=0,this.unknowns=0,this._data=new Fs,this._service=e,this._subscription=e.onMarkerChanged(this._update,this)}dispose(){this._subscription.dispose()}_update(e){for(const t of e){const i=this._data.get(t);i&&this._substract(i);const n=this._resourceStats(t);this._add(n),this._data.set(t,n)}}_resourceStats(e){const t={errors:0,warnings:0,infos:0,unknowns:0};if(K6e.has(e.scheme))return t;for(const{severity:i}of this._service.read({resource:e}))i===In.Error?t.errors+=1:i===In.Warning?t.warnings+=1:i===In.Info?t.infos+=1:t.unknowns+=1;return t}_substract(e){this.errors-=e.errors,this.warnings-=e.warnings,this.infos-=e.infos,this.unknowns-=e.unknowns}_add(e){this.errors+=e.errors,this.warnings+=e.warnings,this.infos+=e.infos,this.unknowns+=e.unknowns}}class yp{constructor(){this._onMarkerChanged=new hue({delay:0,merge:yp._merge}),this.onMarkerChanged=this._onMarkerChanged.event,this._data=new G6e,this._stats=new Q6e(this)}dispose(){this._stats.dispose(),this._onMarkerChanged.dispose()}remove(e,t){for(const i of t||[])this.changeOne(e,i,[])}changeOne(e,t,i){if(Kde(i))this._data.delete(t,e)&&this._onMarkerChanged.fire([t]);else{const n=[];for(const r of i){const o=yp._toMarker(e,t,r);o&&n.push(o)}this._data.set(t,e,n),this._onMarkerChanged.fire([t])}}static _toMarker(e,t,i){let{code:n,severity:r,message:o,source:a,startLineNumber:l,startColumn:c,endLineNumber:d,endColumn:u,relatedInformation:h,tags:g}=i;if(o)return l=l>0?l:1,c=c>0?c:1,d=d>=l?d:l,u=u>0?u:c,{resource:t,owner:e,code:n,severity:r,message:o,source:a,startLineNumber:l,startColumn:c,endLineNumber:d,endColumn:u,relatedInformation:h,tags:g}}changeAll(e,t){const i=[],n=this._data.values(e);if(n)for(const r of n){const o=Kt.first(r);o&&(i.push(o.resource),this._data.delete(o.resource,e))}if(Xr(t)){const r=new Fs;for(const{resource:o,marker:a}of t){const l=yp._toMarker(e,o,a);if(!l)continue;const c=r.get(o);c?c.push(l):(r.set(o,[l]),i.push(o))}for(const[o,a]of r)this._data.set(o,e,a)}i.length>0&&this._onMarkerChanged.fire(i)}read(e=Object.create(null)){let{owner:t,resource:i,severities:n,take:r}=e;if((!r||r<0)&&(r=-1),t&&i){const o=this._data.get(i,t);if(o){const a=[];for(const l of o)if(yp._accept(l,n)){const c=a.push(l);if(r>0&&c===r)break}return a}else return[]}else if(!t&&!i){const o=[];for(const a of this._data.values())for(const l of a)if(yp._accept(l,n)){const c=o.push(l);if(r>0&&c===r)return o}return o}else{const o=this._data.values(i??t),a=[];for(const l of o)for(const c of l)if(yp._accept(c,n)){const d=a.push(c);if(r>0&&d===r)return a}return a}}static _accept(e,t){return t===void 0||(t&e.severity)===e.severity}static _merge(e){const t=new Fs;for(const i of e)for(const n of i)t.set(n,!0);return Array.from(t.keys())}}class Y6e extends te{get configurationModel(){return this._configurationModel}constructor(e){super(),this.logService=e,this._configurationModel=Qs.createEmptyModel(this.logService)}reload(){return this.resetConfigurationModel(),this.configurationModel}getConfigurationDefaultOverrides(){return{}}resetConfigurationModel(){this._configurationModel=Qs.createEmptyModel(this.logService);const e=_n.as(pd.Configuration).getConfigurationProperties();this.updateConfigurationModel(Object.keys(e),e)}updateConfigurationModel(e,t){const i=this.getConfigurationDefaultOverrides();for(const n of e){const r=i[n],o=t[n];r!==void 0?this._configurationModel.setValue(n,r):o?this._configurationModel.setValue(n,o.default):this._configurationModel.removeValue(n)}}}const v_=Ht("accessibilitySignalService"),ri=class ri{static register(e){return new ri(e.fileName)}constructor(e){this.fileName=e}};ri.error=ri.register({fileName:"error.mp3"}),ri.warning=ri.register({fileName:"warning.mp3"}),ri.success=ri.register({fileName:"success.mp3"}),ri.foldedArea=ri.register({fileName:"foldedAreas.mp3"}),ri.break=ri.register({fileName:"break.mp3"}),ri.quickFixes=ri.register({fileName:"quickFixes.mp3"}),ri.taskCompleted=ri.register({fileName:"taskCompleted.mp3"}),ri.taskFailed=ri.register({fileName:"taskFailed.mp3"}),ri.terminalBell=ri.register({fileName:"terminalBell.mp3"}),ri.diffLineInserted=ri.register({fileName:"diffLineInserted.mp3"}),ri.diffLineDeleted=ri.register({fileName:"diffLineDeleted.mp3"}),ri.diffLineModified=ri.register({fileName:"diffLineModified.mp3"}),ri.chatRequestSent=ri.register({fileName:"chatRequestSent.mp3"}),ri.chatResponseReceived1=ri.register({fileName:"chatResponseReceived1.mp3"}),ri.chatResponseReceived2=ri.register({fileName:"chatResponseReceived2.mp3"}),ri.chatResponseReceived3=ri.register({fileName:"chatResponseReceived3.mp3"}),ri.chatResponseReceived4=ri.register({fileName:"chatResponseReceived4.mp3"}),ri.clear=ri.register({fileName:"clear.mp3"}),ri.save=ri.register({fileName:"save.mp3"}),ri.format=ri.register({fileName:"format.mp3"}),ri.voiceRecordingStarted=ri.register({fileName:"voiceRecordingStarted.mp3"}),ri.voiceRecordingStopped=ri.register({fileName:"voiceRecordingStopped.mp3"}),ri.progress=ri.register({fileName:"progress.mp3"});let ln=ri;class X6e{constructor(e){this.randomOneOf=e}}const Nt=class Nt{constructor(e,t,i,n,r,o){this.sound=e,this.name=t,this.legacySoundSettingsKey=i,this.settingsKey=n,this.legacyAnnouncementSettingsKey=r,this.announcementMessage=o}static register(e){const t=new X6e("randomOneOf"in e.sound?e.sound.randomOneOf:[e.sound]),i=new Nt(t,e.name,e.legacySoundSettingsKey,e.settingsKey,e.legacyAnnouncementSettingsKey,e.announcementMessage);return Nt._signals.add(i),i}};Nt._signals=new Set,Nt.errorAtPosition=Nt.register({name:b("accessibilitySignals.positionHasError.name","Error at Position"),sound:ln.error,announcementMessage:b("accessibility.signals.positionHasError","Error"),settingsKey:"accessibility.signals.positionHasError",delaySettingsKey:"accessibility.signalOptions.delays.errorAtPosition"}),Nt.warningAtPosition=Nt.register({name:b("accessibilitySignals.positionHasWarning.name","Warning at Position"),sound:ln.warning,announcementMessage:b("accessibility.signals.positionHasWarning","Warning"),settingsKey:"accessibility.signals.positionHasWarning",delaySettingsKey:"accessibility.signalOptions.delays.warningAtPosition"}),Nt.errorOnLine=Nt.register({name:b("accessibilitySignals.lineHasError.name","Error on Line"),sound:ln.error,legacySoundSettingsKey:"audioCues.lineHasError",legacyAnnouncementSettingsKey:"accessibility.alert.error",announcementMessage:b("accessibility.signals.lineHasError","Error on Line"),settingsKey:"accessibility.signals.lineHasError"}),Nt.warningOnLine=Nt.register({name:b("accessibilitySignals.lineHasWarning.name","Warning on Line"),sound:ln.warning,legacySoundSettingsKey:"audioCues.lineHasWarning",legacyAnnouncementSettingsKey:"accessibility.alert.warning",announcementMessage:b("accessibility.signals.lineHasWarning","Warning on Line"),settingsKey:"accessibility.signals.lineHasWarning"}),Nt.foldedArea=Nt.register({name:b("accessibilitySignals.lineHasFoldedArea.name","Folded Area on Line"),sound:ln.foldedArea,legacySoundSettingsKey:"audioCues.lineHasFoldedArea",legacyAnnouncementSettingsKey:"accessibility.alert.foldedArea",announcementMessage:b("accessibility.signals.lineHasFoldedArea","Folded"),settingsKey:"accessibility.signals.lineHasFoldedArea"}),Nt.break=Nt.register({name:b("accessibilitySignals.lineHasBreakpoint.name","Breakpoint on Line"),sound:ln.break,legacySoundSettingsKey:"audioCues.lineHasBreakpoint",legacyAnnouncementSettingsKey:"accessibility.alert.breakpoint",announcementMessage:b("accessibility.signals.lineHasBreakpoint","Breakpoint"),settingsKey:"accessibility.signals.lineHasBreakpoint"}),Nt.inlineSuggestion=Nt.register({name:b("accessibilitySignals.lineHasInlineSuggestion.name","Inline Suggestion on Line"),sound:ln.quickFixes,legacySoundSettingsKey:"audioCues.lineHasInlineSuggestion",settingsKey:"accessibility.signals.lineHasInlineSuggestion"}),Nt.terminalQuickFix=Nt.register({name:b("accessibilitySignals.terminalQuickFix.name","Terminal Quick Fix"),sound:ln.quickFixes,legacySoundSettingsKey:"audioCues.terminalQuickFix",legacyAnnouncementSettingsKey:"accessibility.alert.terminalQuickFix",announcementMessage:b("accessibility.signals.terminalQuickFix","Quick Fix"),settingsKey:"accessibility.signals.terminalQuickFix"}),Nt.onDebugBreak=Nt.register({name:b("accessibilitySignals.onDebugBreak.name","Debugger Stopped on Breakpoint"),sound:ln.break,legacySoundSettingsKey:"audioCues.onDebugBreak",legacyAnnouncementSettingsKey:"accessibility.alert.onDebugBreak",announcementMessage:b("accessibility.signals.onDebugBreak","Breakpoint"),settingsKey:"accessibility.signals.onDebugBreak"}),Nt.noInlayHints=Nt.register({name:b("accessibilitySignals.noInlayHints","No Inlay Hints on Line"),sound:ln.error,legacySoundSettingsKey:"audioCues.noInlayHints",legacyAnnouncementSettingsKey:"accessibility.alert.noInlayHints",announcementMessage:b("accessibility.signals.noInlayHints","No Inlay Hints"),settingsKey:"accessibility.signals.noInlayHints"}),Nt.taskCompleted=Nt.register({name:b("accessibilitySignals.taskCompleted","Task Completed"),sound:ln.taskCompleted,legacySoundSettingsKey:"audioCues.taskCompleted",legacyAnnouncementSettingsKey:"accessibility.alert.taskCompleted",announcementMessage:b("accessibility.signals.taskCompleted","Task Completed"),settingsKey:"accessibility.signals.taskCompleted"}),Nt.taskFailed=Nt.register({name:b("accessibilitySignals.taskFailed","Task Failed"),sound:ln.taskFailed,legacySoundSettingsKey:"audioCues.taskFailed",legacyAnnouncementSettingsKey:"accessibility.alert.taskFailed",announcementMessage:b("accessibility.signals.taskFailed","Task Failed"),settingsKey:"accessibility.signals.taskFailed"}),Nt.terminalCommandFailed=Nt.register({name:b("accessibilitySignals.terminalCommandFailed","Terminal Command Failed"),sound:ln.error,legacySoundSettingsKey:"audioCues.terminalCommandFailed",legacyAnnouncementSettingsKey:"accessibility.alert.terminalCommandFailed",announcementMessage:b("accessibility.signals.terminalCommandFailed","Command Failed"),settingsKey:"accessibility.signals.terminalCommandFailed"}),Nt.terminalCommandSucceeded=Nt.register({name:b("accessibilitySignals.terminalCommandSucceeded","Terminal Command Succeeded"),sound:ln.success,announcementMessage:b("accessibility.signals.terminalCommandSucceeded","Command Succeeded"),settingsKey:"accessibility.signals.terminalCommandSucceeded"}),Nt.terminalBell=Nt.register({name:b("accessibilitySignals.terminalBell","Terminal Bell"),sound:ln.terminalBell,legacySoundSettingsKey:"audioCues.terminalBell",legacyAnnouncementSettingsKey:"accessibility.alert.terminalBell",announcementMessage:b("accessibility.signals.terminalBell","Terminal Bell"),settingsKey:"accessibility.signals.terminalBell"}),Nt.notebookCellCompleted=Nt.register({name:b("accessibilitySignals.notebookCellCompleted","Notebook Cell Completed"),sound:ln.taskCompleted,legacySoundSettingsKey:"audioCues.notebookCellCompleted",legacyAnnouncementSettingsKey:"accessibility.alert.notebookCellCompleted",announcementMessage:b("accessibility.signals.notebookCellCompleted","Notebook Cell Completed"),settingsKey:"accessibility.signals.notebookCellCompleted"}),Nt.notebookCellFailed=Nt.register({name:b("accessibilitySignals.notebookCellFailed","Notebook Cell Failed"),sound:ln.taskFailed,legacySoundSettingsKey:"audioCues.notebookCellFailed",legacyAnnouncementSettingsKey:"accessibility.alert.notebookCellFailed",announcementMessage:b("accessibility.signals.notebookCellFailed","Notebook Cell Failed"),settingsKey:"accessibility.signals.notebookCellFailed"}),Nt.diffLineInserted=Nt.register({name:b("accessibilitySignals.diffLineInserted","Diff Line Inserted"),sound:ln.diffLineInserted,legacySoundSettingsKey:"audioCues.diffLineInserted",settingsKey:"accessibility.signals.diffLineInserted"}),Nt.diffLineDeleted=Nt.register({name:b("accessibilitySignals.diffLineDeleted","Diff Line Deleted"),sound:ln.diffLineDeleted,legacySoundSettingsKey:"audioCues.diffLineDeleted",settingsKey:"accessibility.signals.diffLineDeleted"}),Nt.diffLineModified=Nt.register({name:b("accessibilitySignals.diffLineModified","Diff Line Modified"),sound:ln.diffLineModified,legacySoundSettingsKey:"audioCues.diffLineModified",settingsKey:"accessibility.signals.diffLineModified"}),Nt.chatRequestSent=Nt.register({name:b("accessibilitySignals.chatRequestSent","Chat Request Sent"),sound:ln.chatRequestSent,legacySoundSettingsKey:"audioCues.chatRequestSent",legacyAnnouncementSettingsKey:"accessibility.alert.chatRequestSent",announcementMessage:b("accessibility.signals.chatRequestSent","Chat Request Sent"),settingsKey:"accessibility.signals.chatRequestSent"}),Nt.chatResponseReceived=Nt.register({name:b("accessibilitySignals.chatResponseReceived","Chat Response Received"),legacySoundSettingsKey:"audioCues.chatResponseReceived",sound:{randomOneOf:[ln.chatResponseReceived1,ln.chatResponseReceived2,ln.chatResponseReceived3,ln.chatResponseReceived4]},settingsKey:"accessibility.signals.chatResponseReceived"}),Nt.progress=Nt.register({name:b("accessibilitySignals.progress","Progress"),sound:ln.progress,legacySoundSettingsKey:"audioCues.chatResponsePending",legacyAnnouncementSettingsKey:"accessibility.alert.progress",announcementMessage:b("accessibility.signals.progress","Progress"),settingsKey:"accessibility.signals.progress"}),Nt.clear=Nt.register({name:b("accessibilitySignals.clear","Clear"),sound:ln.clear,legacySoundSettingsKey:"audioCues.clear",legacyAnnouncementSettingsKey:"accessibility.alert.clear",announcementMessage:b("accessibility.signals.clear","Clear"),settingsKey:"accessibility.signals.clear"}),Nt.save=Nt.register({name:b("accessibilitySignals.save","Save"),sound:ln.save,legacySoundSettingsKey:"audioCues.save",legacyAnnouncementSettingsKey:"accessibility.alert.save",announcementMessage:b("accessibility.signals.save","Save"),settingsKey:"accessibility.signals.save"}),Nt.format=Nt.register({name:b("accessibilitySignals.format","Format"),sound:ln.format,legacySoundSettingsKey:"audioCues.format",legacyAnnouncementSettingsKey:"accessibility.alert.format",announcementMessage:b("accessibility.signals.format","Format"),settingsKey:"accessibility.signals.format"}),Nt.voiceRecordingStarted=Nt.register({name:b("accessibilitySignals.voiceRecordingStarted","Voice Recording Started"),sound:ln.voiceRecordingStarted,legacySoundSettingsKey:"audioCues.voiceRecordingStarted",settingsKey:"accessibility.signals.voiceRecordingStarted"}),Nt.voiceRecordingStopped=Nt.register({name:b("accessibilitySignals.voiceRecordingStopped","Voice Recording Stopped"),sound:ln.voiceRecordingStopped,legacySoundSettingsKey:"audioCues.voiceRecordingStopped",settingsKey:"accessibility.signals.voiceRecordingStopped"});let fl=Nt;class Z6e extends te{constructor(e,t=[]){super(),this.logger=new WAe([e,...t]),this._register(e.onDidChangeLogLevel(i=>this.setLevel(i)))}get onDidChangeLogLevel(){return this.logger.onDidChangeLogLevel}setLevel(e){this.logger.setLevel(e)}getLevel(){return this.logger.getLevel()}trace(e,...t){this.logger.trace(e,...t)}debug(e,...t){this.logger.debug(e,...t)}info(e,...t){this.logger.info(e,...t)}warn(e,...t){this.logger.warn(e,...t)}error(e,...t){this.logger.error(e,...t)}}const Mpe=[];function LS(s){Mpe.push(s)}function J6e(){return Mpe.slice(0)}class e8e{getParseResult(e){}}var Qh=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Xn=function(s,e){return function(t,i){e(t,i,s)}};class t8e{constructor(e){this.disposed=!1,this.model=e,this._onWillDispose=new Z}get textEditorModel(){return this.model}dispose(){this.disposed=!0,this._onWillDispose.fire()}}let uH=class{constructor(e){this.modelService=e}createModelReference(e){const t=this.modelService.getModel(e);return t?Promise.resolve(new KNe(new t8e(t))):Promise.reject(new Error("Model not found"))}};uH=Qh([Xn(0,Gi)],uH);const sO=class sO{show(){return sO.NULL_PROGRESS_RUNNER}async showWhile(e,t){await e}};sO.NULL_PROGRESS_RUNNER={done:()=>{},total:()=>{},worked:()=>{}};let hH=sO;class i8e{withProgress(e,t,i){return t({report:()=>{}})}}class n8e{constructor(){this.isExtensionDevelopment=!1,this.isBuilt=!1}}class s8e{async confirm(e){return{confirmed:this.doConfirm(e.message,e.detail),checkboxChecked:!1}}doConfirm(e,t){let i=e;return t&&(i=i+`

`+t),Ri.confirm(i)}async prompt(e){var n;let t;if(this.doConfirm(e.message,e.detail)){const r=[...e.buttons??[]];e.cancelButton&&typeof e.cancelButton!="string"&&typeof e.cancelButton!="boolean"&&r.push(e.cancelButton),t=await((n=r[0])==null?void 0:n.run({checkboxChecked:!1}))}return{result:t}}async error(e,t){await this.prompt({type:Hn.Error,message:e,detail:t})}}const xk=class xk{info(e){return this.notify({severity:Hn.Info,message:e})}warn(e){return this.notify({severity:Hn.Warning,message:e})}error(e){return this.notify({severity:Hn.Error,message:e})}notify(e){switch(e.severity){case Hn.Error:console.error(e.message);break;case Hn.Warning:console.warn(e.message);break;default:console.log(e.message);break}return xk.NO_OP}prompt(e,t,i,n){return xk.NO_OP}status(e,t){return te.None}};xk.NO_OP=new lOe;let fH=xk,gH=class{constructor(e){this._onWillExecuteCommand=new Z,this._onDidExecuteCommand=new Z,this.onDidExecuteCommand=this._onDidExecuteCommand.event,this._instantiationService=e}executeCommand(e,...t){const i=Gt.getCommand(e);if(!i)return Promise.reject(new Error(`command '${e}' not found`));try{this._onWillExecuteCommand.fire({commandId:e,args:t});const n=this._instantiationService.invokeFunction.apply(this._instantiationService,[i.handler,...t]);return this._onDidExecuteCommand.fire({commandId:e,args:t}),Promise.resolve(n)}catch(n){return Promise.reject(n)}}};gH=Qh([Xn(0,Xe)],gH);let N1=class extends L3e{constructor(e,t,i,n,r,o){super(e,t,i,n,r),this._cachedResolver=null,this._dynamicKeybindings=[],this._domNodeListeners=[];const a=g=>{const p=new ce;p.add(oe(g,Le.KEY_DOWN,_=>{const v=new Mi(_);this._dispatch(v,v.target)&&(v.preventDefault(),v.stopPropagation())})),p.add(oe(g,Le.KEY_UP,_=>{const v=new Mi(_);this._singleModifierDispatch(v,v.target)&&v.preventDefault()})),this._domNodeListeners.push(new r8e(g,p))},l=g=>{for(let p=0;p<this._domNodeListeners.length;p++){const _=this._domNodeListeners[p];_.domNode===g&&(this._domNodeListeners.splice(p,1),_.dispose())}},c=g=>{g.getOption(61)||a(g.getContainerDomNode())},d=g=>{g.getOption(61)||l(g.getContainerDomNode())};this._register(o.onCodeEditorAdd(c)),this._register(o.onCodeEditorRemove(d)),o.listCodeEditors().forEach(c);const u=g=>{a(g.getContainerDomNode())},h=g=>{l(g.getContainerDomNode())};this._register(o.onDiffEditorAdd(u)),this._register(o.onDiffEditorRemove(h)),o.listDiffEditors().forEach(u)}addDynamicKeybinding(e,t,i,n){return id(Gt.registerCommand(e,i),this.addDynamicKeybindings([{keybinding:t,command:e,when:n}]))}addDynamicKeybindings(e){const t=e.map(i=>({keybinding:HW(i.keybinding,Da),command:i.command??null,commandArgs:i.commandArgs,when:i.when,weight1:1e3,weight2:0,extensionId:null,isBuiltinExtension:!1}));return this._dynamicKeybindings=this._dynamicKeybindings.concat(t),this.updateResolver(),Ye(()=>{for(let i=0;i<this._dynamicKeybindings.length;i++)if(this._dynamicKeybindings[i]===t[0]){this._dynamicKeybindings.splice(i,t.length),this.updateResolver();return}})}updateResolver(){this._cachedResolver=null,this._onDidUpdateKeybindings.fire()}_getResolver(){if(!this._cachedResolver){const e=this._toNormalizedKeybindingItems(Io.getDefaultKeybindings(),!0),t=this._toNormalizedKeybindingItems(this._dynamicKeybindings,!1);this._cachedResolver=new ML(e,t,i=>this._log(i))}return this._cachedResolver}_documentHasFocus(){return Ri.document.hasFocus()}_toNormalizedKeybindingItems(e,t){const i=[];let n=0;for(const r of e){const o=r.when||void 0,a=r.keybinding;if(!a)i[n++]=new ene(void 0,r.command,r.commandArgs,o,t,null,!1);else{const l=CI.resolveKeybinding(a,Da);for(const c of l)i[n++]=new ene(c,r.command,r.commandArgs,o,t,null,!1)}}return i}resolveKeyboardEvent(e){const t=new yg(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,e.keyCode);return new CI([t],Da)}};N1=Qh([Xn(0,ct),Xn(1,Hi),Xn(2,Tr),Xn(3,jn),Xn(4,pr),Xn(5,ni)],N1);class r8e extends te{constructor(e,t){super(),this.domNode=e,this._register(t)}}function fse(s){return s&&typeof s=="object"&&(!s.overrideIdentifier||typeof s.overrideIdentifier=="string")&&(!s.resource||s.resource instanceof Je)}let JA=class{constructor(e){this.logService=e,this._onDidChangeConfiguration=new Z,this.onDidChangeConfiguration=this._onDidChangeConfiguration.event;const t=new Y6e(e);this._configuration=new OF(t.reload(),Qs.createEmptyModel(e),Qs.createEmptyModel(e),Qs.createEmptyModel(e),Qs.createEmptyModel(e),Qs.createEmptyModel(e),new Fs,Qs.createEmptyModel(e),new Fs,e),t.dispose()}getValue(e,t){const i=typeof e=="string"?e:void 0,n=fse(e)?e:fse(t)?t:{};return this._configuration.getValue(i,n,void 0)}updateValues(e){const t={data:this._configuration.toData()},i=[];for(const n of e){const[r,o]=n;this.getValue(r)!==o&&(this._configuration.updateValue(r,o),i.push(r))}if(i.length>0){const n=new w3e({keys:i,overrides:[]},t,this._configuration,void 0,this.logService);n.source=8,this._onDidChangeConfiguration.fire(n)}return Promise.resolve()}updateValue(e,t,i,n){return this.updateValues([[e,t]])}inspect(e,t={}){return this._configuration.inspect(e,t,void 0)}};JA=Qh([Xn(0,pr)],JA);let pH=class{constructor(e,t,i){this.configurationService=e,this.modelService=t,this.languageService=i,this._onDidChangeConfiguration=new Z,this.configurationService.onDidChangeConfiguration(n=>{this._onDidChangeConfiguration.fire({affectedKeys:n.affectedKeys,affectsConfiguration:(r,o)=>n.affectsConfiguration(o)})})}getValue(e,t,i){const n=X.isIPosition(t)?t:null,r=n?typeof i=="string"?i:void 0:typeof t=="string"?t:void 0,o=e?this.getLanguage(e,n):void 0;return typeof r>"u"?this.configurationService.getValue({resource:e,overrideIdentifier:o}):this.configurationService.getValue(r,{resource:e,overrideIdentifier:o})}getLanguage(e,t){const i=this.modelService.getModel(e);return i?t?i.getLanguageIdAtPosition(t.lineNumber,t.column):i.getLanguageId():this.languageService.guessLanguageIdByFilepathOrFirstLine(e)}};pH=Qh([Xn(0,At),Xn(1,Gi),Xn(2,un)],pH);let mH=class{constructor(e){this.configurationService=e}getEOL(e,t){const i=this.configurationService.getValue("files.eol",{overrideIdentifier:t,resource:e});return i&&typeof i=="string"&&i!=="auto"?i:Lo||Wt?`
`:`\r
`}};mH=Qh([Xn(0,At)],mH);class o8e{publicLog2(){}}const Lk=class Lk{constructor(){const e=Je.from({scheme:Lk.SCHEME,authority:"model",path:"/"});this.workspace={id:jfe,folders:[new B3e({uri:e,name:"",index:0})]}}getWorkspace(){return this.workspace}getWorkspaceFolder(e){return e&&e.scheme===Lk.SCHEME?this.workspace.folders[0]:null}};Lk.SCHEME="inmemory";let _H=Lk;function eP(s,e,t){if(!e||!(s instanceof JA))return;const i=[];Object.keys(e).forEach(n=>{p3e(n)&&i.push([`editor.${n}`,e[n]]),t&&m3e(n)&&i.push([`diffEditor.${n}`,e[n]])}),i.length>0&&s.updateValues(i)}let bH=class{constructor(e){this._modelService=e}hasPreviewHandler(){return!1}async apply(e,t){const i=Array.isArray(e)?e:TK.convert(e),n=new Map;for(const a of i){if(!(a instanceof um))throw new Error("bad edit - only text edits are supported");const l=this._modelService.getModel(a.resource);if(!l)throw new Error("bad edit - model not found");if(typeof a.versionId=="number"&&l.getVersionId()!==a.versionId)throw new Error("bad state - model changed in the meantime");let c=n.get(l);c||(c=[],n.set(l,c)),c.push(gn.replaceMove(F.lift(a.textEdit.range),a.textEdit.text))}let r=0,o=0;for(const[a,l]of n)a.pushStackElement(),a.pushEditOperations([],l,()=>[]),a.pushStackElement(),o+=1,r+=l.length;return{ariaSummary:lw(n8.bulkEditServiceSummary,r,o),isApplied:r>0}}};bH=Qh([Xn(0,Gi)],bH);class a8e{getUriLabel(e,t){return e.scheme==="file"?e.fsPath:e.path}getUriBasenameLabel(e){return Cc(e)}}let vH=class extends d3e{constructor(e,t){super(e),this._codeEditorService=t}showContextView(e,t,i){if(!t){const n=this._codeEditorService.getFocusedCodeEditor()||this._codeEditorService.getActiveCodeEditor();n&&(t=n.getContainerDomNode())}return super.showContextView(e,t,i)}};vH=Qh([Xn(0,g_),Xn(1,ni)],vH);class l8e{constructor(){this._neverEmitter=new Z,this.onDidChangeTrust=this._neverEmitter.event}isWorkspaceTrusted(){return!0}}class c8e extends c8{constructor(){super()}}class d8e extends Z6e{constructor(){super(new BAe)}}let wH=class extends v8{constructor(e,t,i,n,r,o){super(e,t,i,n,r,o),this.configure({blockMouse:!1})}};wH=Qh([Xn(0,Tr),Xn(1,jn),Xn(2,Fg),Xn(3,pi),Xn(4,Ol),Xn(5,ct)],wH);const CH={amdModuleId:"vs/editor/common/services/editorSimpleWorker",esmModuleLocation:void 0,label:"editorWorkerService"};let yH=class extends p6{constructor(e,t,i,n,r){super(CH,e,t,i,n,r)}};yH=Qh([Xn(0,Gi),Xn(1,vF),Xn(2,pr),Xn(3,bn),Xn(4,Be)],yH);class u8e{async playSignal(e,t){}}qt(pr,d8e,0);qt(At,JA,0);qt(vF,pH,0);qt(Whe,mH,0);qt(_w,_H,0);qt(x1,a8e,0);qt(Tr,o8e,0);qt(KE,s8e,0);qt(nK,n8e,0);qt(jn,fH,0);qt(Gh,yp,0);qt(un,c8e,0);qt(Wl,R6e,0);qt(Gi,A8,0);qt(BK,x8,0);qt(ct,dH,0);qt(Ufe,i8e,0);qt(m_,hH,0);qt(md,Z9e,0);qt(ca,yH,0);qt(ZE,bH,0);qt($fe,l8e,0);qt(oa,uH,0);qt(Wa,nH,0);qt(Ic,$We,0);qt(Hi,gH,0);qt(pi,N1,0);qt(kc,eH,0);qt(Fg,vH,0);qt(la,S8,0);qt(Wg,lH,0);qt(Ba,wH,0);qt(Ol,sH,0);qt(v_,u8e,0);qt(zge,e8e,0);var ut;(function(s){const e=new xS;for(const[l,c]of kte())e.set(l,c);const t=new ZA(e,!0);e.set(Xe,t);function i(l){n||o({});const c=e.get(l);if(!c)throw new Error("Missing service "+l);return c instanceof rh?t.invokeFunction(d=>d.get(l)):c}s.get=i;let n=!1;const r=new Z;function o(l){if(n)return t;n=!0;for(const[d,u]of kte())e.get(d)||e.set(d,u);for(const d in l)if(l.hasOwnProperty(d)){const u=Ht(d);e.get(u)instanceof rh&&e.set(u,l[d])}const c=J6e();for(const d of c)try{t.createInstance(d)}catch(u){ft(u)}return r.fire(),t}s.initialize=o;function a(l){if(n)return l();const c=new ce,d=c.add(r.event(()=>{d.dispose(),c.add(l())}));return c}s.withServices=a})(ut||(ut={}));function h8e(s,e){return new f8e(s,e)}class f8e extends nA{constructor(e,t){const i={amdModuleId:CH.amdModuleId,esmModuleLocation:CH.esmModuleLocation,label:t.label};super(i,t.keepIdleModels||!1,e),this._foreignModuleId=t.moduleId,this._foreignModuleCreateData=t.createData||null,this._foreignModuleHost=t.host||null,this._foreignProxy=null}fhr(e,t){if(!this._foreignModuleHost||typeof this._foreignModuleHost[e]!="function")return Promise.reject(new Error("Missing method "+e+" or missing main thread foreign host."));try{return Promise.resolve(this._foreignModuleHost[e].apply(this._foreignModuleHost,t))}catch(i){return Promise.reject(i)}}_getForeignProxy(){return this._foreignProxy||(this._foreignProxy=this._getProxy().then(e=>{const t=this._foreignModuleHost?A7(this._foreignModuleHost):[];return e.$loadForeignModule(this._foreignModuleId,this._foreignModuleCreateData,t).then(i=>{this._foreignModuleCreateData=null;const n=(a,l)=>e.$fmr(a,l),r=(a,l)=>function(){const c=Array.prototype.slice.call(arguments,0);return l(a,c)},o={};for(const a of i)o[a]=r(a,n);return o})})),this._foreignProxy}getProxy(){return this._getForeignProxy()}withSyncedResources(e){return this.workerWithSyncedResources(e).then(t=>this.getProxy())}}const cD={ICodeEditor:"vs.editor.ICodeEditor",IDiffEditor:"vs.editor.IDiffEditor"};class vo{constructor(e,t,i,n){this.startColumn=e,this.endColumn=t,this.className=i,this.type=n,this._lineDecorationBrand=void 0}static _equals(e,t){return e.startColumn===t.startColumn&&e.endColumn===t.endColumn&&e.className===t.className&&e.type===t.type}static equalsArr(e,t){const i=e.length,n=t.length;if(i!==n)return!1;for(let r=0;r<i;r++)if(!vo._equals(e[r],t[r]))return!1;return!0}static extractWrapped(e,t,i){if(e.length===0)return e;const n=t+1,r=i+1,o=i-t,a=[];let l=0;for(const c of e)c.endColumn<=n||c.startColumn>=r||(a[l++]=new vo(Math.max(1,c.startColumn-n+1),Math.min(o+1,c.endColumn-n+1),c.className,c.type));return a}static filter(e,t,i,n){if(e.length===0)return[];const r=[];let o=0;for(let a=0,l=e.length;a<l;a++){const c=e[a],d=c.range;if(d.endLineNumber<t||d.startLineNumber>t||d.isEmpty()&&(c.type===0||c.type===3))continue;const u=d.startLineNumber===t?d.startColumn:i,h=d.endLineNumber===t?d.endColumn:n;r[o++]=new vo(u,h,c.inlineClassName,c.type)}return r}static _typeCompare(e,t){const i=[2,0,1,3];return i[e]-i[t]}static compare(e,t){if(e.startColumn!==t.startColumn)return e.startColumn-t.startColumn;if(e.endColumn!==t.endColumn)return e.endColumn-t.endColumn;const i=vo._typeCompare(e.type,t.type);return i!==0?i:e.className!==t.className?e.className<t.className?-1:1:0}}class gse{constructor(e,t,i,n){this.startOffset=e,this.endOffset=t,this.className=i,this.metadata=n}}class tP{constructor(){this.stopOffsets=[],this.classNames=[],this.metadata=[],this.count=0}static _metadata(e){let t=0;for(let i=0,n=e.length;i<n;i++)t|=e[i];return t}consumeLowerThan(e,t,i){for(;this.count>0&&this.stopOffsets[0]<e;){let n=0;for(;n+1<this.count&&this.stopOffsets[n]===this.stopOffsets[n+1];)n++;i.push(new gse(t,this.stopOffsets[n],this.classNames.join(" "),tP._metadata(this.metadata))),t=this.stopOffsets[n]+1,this.stopOffsets.splice(0,n+1),this.classNames.splice(0,n+1),this.metadata.splice(0,n+1),this.count-=n+1}return this.count>0&&t<e&&(i.push(new gse(t,e-1,this.classNames.join(" "),tP._metadata(this.metadata))),t=e),t}insert(e,t,i){if(this.count===0||this.stopOffsets[this.count-1]<=e)this.stopOffsets.push(e),this.classNames.push(t),this.metadata.push(i);else for(let n=0;n<this.count;n++)if(this.stopOffsets[n]>=e){this.stopOffsets.splice(n,0,e),this.classNames.splice(n,0,t),this.metadata.splice(n,0,i);break}this.count++}}class g8e{static normalize(e,t){if(t.length===0)return[];const i=[],n=new tP;let r=0;for(let o=0,a=t.length;o<a;o++){const l=t[o];let c=l.startColumn,d=l.endColumn;const u=l.className,h=l.type===1?2:l.type===2?4:0;if(c>1){const _=e.charCodeAt(c-2);ws(_)&&c--}if(d>1){const _=e.charCodeAt(d-2);ws(_)&&d--}const g=c-1,p=d-2;r=n.consumeLowerThan(g,r,i),n.count===0&&(r=g),n.insert(p,u,h)}return n.consumeLowerThan(1073741824,r,i),i}}class Ps{constructor(e,t,i,n){this.endIndex=e,this.type=t,this.metadata=i,this.containsRTL=n,this._linePartBrand=void 0}isWhitespace(){return!!(this.metadata&1)}isPseudoAfter(){return!!(this.metadata&4)}}class Ope{constructor(e,t){this.startOffset=e,this.endOffset=t}equals(e){return this.startOffset===e.startOffset&&this.endOffset===e.endOffset}}class w_{constructor(e,t,i,n,r,o,a,l,c,d,u,h,g,p,_,v,C,y,x){this.useMonospaceOptimizations=e,this.canUseHalfwidthRightwardsArrow=t,this.lineContent=i,this.continuesWithWrappedLine=n,this.isBasicASCII=r,this.containsRTL=o,this.fauxIndentLength=a,this.lineTokens=l,this.lineDecorations=c.sort(vo.compare),this.tabSize=d,this.startVisibleColumn=u,this.spaceWidth=h,this.stopRenderingLineAfter=_,this.renderWhitespace=v==="all"?4:v==="boundary"?1:v==="selection"?2:v==="trailing"?3:0,this.renderControlCharacters=C,this.fontLigatures=y,this.selectionsOnLine=x&&x.sort((A,D)=>A.startOffset<D.startOffset?-1:1);const L=Math.abs(p-h),I=Math.abs(g-h);L<I?(this.renderSpaceWidth=p,this.renderSpaceCharCode=11825):(this.renderSpaceWidth=g,this.renderSpaceCharCode=183)}sameSelection(e){if(this.selectionsOnLine===null)return e===null;if(e===null||e.length!==this.selectionsOnLine.length)return!1;for(let t=0;t<this.selectionsOnLine.length;t++)if(!this.selectionsOnLine[t].equals(e[t]))return!1;return!0}equals(e){return this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineContent===e.lineContent&&this.continuesWithWrappedLine===e.continuesWithWrappedLine&&this.isBasicASCII===e.isBasicASCII&&this.containsRTL===e.containsRTL&&this.fauxIndentLength===e.fauxIndentLength&&this.tabSize===e.tabSize&&this.startVisibleColumn===e.startVisibleColumn&&this.spaceWidth===e.spaceWidth&&this.renderSpaceWidth===e.renderSpaceWidth&&this.renderSpaceCharCode===e.renderSpaceCharCode&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.fontLigatures===e.fontLigatures&&vo.equalsArr(this.lineDecorations,e.lineDecorations)&&this.lineTokens.equals(e.lineTokens)&&this.sameSelection(e.selectionsOnLine)}}class Fpe{constructor(e,t){this.partIndex=e,this.charIndex=t}}class oh{static getPartIndex(e){return(e&4294901760)>>>16}static getCharIndex(e){return(e&65535)>>>0}constructor(e,t){this.length=e,this._data=new Uint32Array(this.length),this._horizontalOffset=new Uint32Array(this.length)}setColumnInfo(e,t,i,n){const r=(t<<16|i<<0)>>>0;this._data[e-1]=r,this._horizontalOffset[e-1]=n}getHorizontalOffset(e){return this._horizontalOffset.length===0?0:this._horizontalOffset[e-1]}charOffsetToPartData(e){return this.length===0?0:e<0?this._data[0]:e>=this.length?this._data[this.length-1]:this._data[e]}getDomPosition(e){const t=this.charOffsetToPartData(e-1),i=oh.getPartIndex(t),n=oh.getCharIndex(t);return new Fpe(i,n)}getColumn(e,t){return this.partDataToCharOffset(e.partIndex,t,e.charIndex)+1}partDataToCharOffset(e,t,i){if(this.length===0)return 0;const n=(e<<16|i<<0)>>>0;let r=0,o=this.length-1;for(;r+1<o;){const _=r+o>>>1,v=this._data[_];if(v===n)return _;v>n?o=_:r=_}if(r===o)return r;const a=this._data[r],l=this._data[o];if(a===n)return r;if(l===n)return o;const c=oh.getPartIndex(a),d=oh.getCharIndex(a),u=oh.getPartIndex(l);let h;c!==u?h=t:h=oh.getCharIndex(l);const g=i-d,p=h-i;return g<=p?r:o}}class SH{constructor(e,t,i){this._renderLineOutputBrand=void 0,this.characterMapping=e,this.containsRTL=t,this.containsForeignElements=i}}function dD(s,e){if(s.lineContent.length===0){if(s.lineDecorations.length>0){e.appendString("<span>");let t=0,i=0,n=0;for(const o of s.lineDecorations)(o.type===1||o.type===2)&&(e.appendString('<span class="'),e.appendString(o.className),e.appendString('"></span>'),o.type===1&&(n|=1,t++),o.type===2&&(n|=2,i++));e.appendString("</span>");const r=new oh(1,t+i);return r.setColumnInfo(1,t,0,0),new SH(r,!1,n)}return e.appendString("<span><span></span></span>"),new SH(new oh(0,0),!1,0)}return S8e(_8e(s),e)}class p8e{constructor(e,t,i,n){this.characterMapping=e,this.html=t,this.containsRTL=i,this.containsForeignElements=n}}function JF(s){const e=new hS(1e4),t=dD(s,e);return new p8e(t.characterMapping,e.build(),t.containsRTL,t.containsForeignElements)}class m8e{constructor(e,t,i,n,r,o,a,l,c,d,u,h,g,p,_,v){this.fontIsMonospace=e,this.canUseHalfwidthRightwardsArrow=t,this.lineContent=i,this.len=n,this.isOverflowing=r,this.overflowingCharCount=o,this.parts=a,this.containsForeignElements=l,this.fauxIndentLength=c,this.tabSize=d,this.startVisibleColumn=u,this.containsRTL=h,this.spaceWidth=g,this.renderSpaceCharCode=p,this.renderWhitespace=_,this.renderControlCharacters=v}}function _8e(s){const e=s.lineContent;let t,i,n;s.stopRenderingLineAfter!==-1&&s.stopRenderingLineAfter<e.length?(t=!0,i=e.length-s.stopRenderingLineAfter,n=s.stopRenderingLineAfter):(t=!1,i=0,n=e.length);let r=b8e(e,s.containsRTL,s.lineTokens,s.fauxIndentLength,n);s.renderControlCharacters&&!s.isBasicASCII&&(r=w8e(e,r)),(s.renderWhitespace===4||s.renderWhitespace===1||s.renderWhitespace===2&&s.selectionsOnLine||s.renderWhitespace===3&&!s.continuesWithWrappedLine)&&(r=C8e(s,e,n,r));let o=0;if(s.lineDecorations.length>0){for(let a=0,l=s.lineDecorations.length;a<l;a++){const c=s.lineDecorations[a];c.type===3||c.type===1?o|=1:c.type===2&&(o|=2)}r=y8e(e,n,r,s.lineDecorations)}return s.containsRTL||(r=v8e(e,r,!s.isBasicASCII||s.fontLigatures)),new m8e(s.useMonospaceOptimizations,s.canUseHalfwidthRightwardsArrow,e,n,t,i,r,o,s.fauxIndentLength,s.tabSize,s.startVisibleColumn,s.containsRTL,s.spaceWidth,s.renderSpaceCharCode,s.renderWhitespace,s.renderControlCharacters)}function b8e(s,e,t,i,n){const r=[];let o=0;i>0&&(r[o++]=new Ps(i,"",0,!1));let a=i;for(let l=0,c=t.getCount();l<c;l++){const d=t.getEndOffset(l);if(d<=i)continue;const u=t.getClassName(l);if(d>=n){const g=e?h1(s.substring(a,n)):!1;r[o++]=new Ps(n,u,0,g);break}const h=e?h1(s.substring(a,d)):!1;r[o++]=new Ps(d,u,0,h),a=d}return r}function v8e(s,e,t){let i=0;const n=[];let r=0;if(t)for(let o=0,a=e.length;o<a;o++){const l=e[o],c=l.endIndex;if(i+50<c){const d=l.type,u=l.metadata,h=l.containsRTL;let g=-1,p=i;for(let _=i;_<c;_++)s.charCodeAt(_)===32&&(g=_),g!==-1&&_-p>=50&&(n[r++]=new Ps(g+1,d,u,h),p=g+1,g=-1);p!==c&&(n[r++]=new Ps(c,d,u,h))}else n[r++]=l;i=c}else for(let o=0,a=e.length;o<a;o++){const l=e[o],c=l.endIndex,d=c-i;if(d>50){const u=l.type,h=l.metadata,g=l.containsRTL,p=Math.ceil(d/50);for(let _=1;_<p;_++){const v=i+_*50;n[r++]=new Ps(v,u,h,g)}n[r++]=new Ps(c,u,h,g)}else n[r++]=l;i=c}return n}function Vpe(s){return s<32?s!==9:s===127||s>=8234&&s<=8238||s>=8294&&s<=8297||s>=8206&&s<=8207||s===1564}function w8e(s,e){const t=[];let i=new Ps(0,"",0,!1),n=0;for(const r of e){const o=r.endIndex;for(;n<o;n++){const a=s.charCodeAt(n);Vpe(a)&&(n>i.endIndex&&(i=new Ps(n,r.type,r.metadata,r.containsRTL),t.push(i)),i=new Ps(n+1,"mtkcontrol",r.metadata,!1),t.push(i))}n>i.endIndex&&(i=new Ps(o,r.type,r.metadata,r.containsRTL),t.push(i))}return t}function C8e(s,e,t,i){const n=s.continuesWithWrappedLine,r=s.fauxIndentLength,o=s.tabSize,a=s.startVisibleColumn,l=s.useMonospaceOptimizations,c=s.selectionsOnLine,d=s.renderWhitespace===1,u=s.renderWhitespace===3,h=s.renderSpaceWidth!==s.spaceWidth,g=[];let p=0,_=0,v=i[_].type,C=i[_].containsRTL,y=i[_].endIndex;const x=i.length;let L=!1,I=Zr(e),A;I===-1?(L=!0,I=t,A=t):A=nu(e);let D=!1,N=0,R=c&&c[N],W=a%o;for(let U=r;U<t;U++){const B=e.charCodeAt(U);R&&U>=R.endOffset&&(N++,R=c&&c[N]);let ee;if(U<I||U>A)ee=!0;else if(B===9)ee=!0;else if(B===32)if(d)if(D)ee=!0;else{const re=U+1<t?e.charCodeAt(U+1):0;ee=re===32||re===9}else ee=!0;else ee=!1;if(ee&&c&&(ee=!!R&&R.startOffset<=U&&R.endOffset>U),ee&&u&&(ee=L||U>A),ee&&C&&U>=I&&U<=A&&(ee=!1),D){if(!ee||!l&&W>=o){if(h){const re=p>0?g[p-1].endIndex:r;for(let pe=re+1;pe<=U;pe++)g[p++]=new Ps(pe,"mtkw",1,!1)}else g[p++]=new Ps(U,"mtkw",1,!1);W=W%o}}else(U===y||ee&&U>r)&&(g[p++]=new Ps(U,v,0,C),W=W%o);for(B===9?W=o:Um(B)?W+=2:W++,D=ee;U===y&&(_++,_<x);)v=i[_].type,C=i[_].containsRTL,y=i[_].endIndex}let H=!1;if(D)if(n&&d){const U=t>0?e.charCodeAt(t-1):0,B=t>1?e.charCodeAt(t-2):0;U===32&&B!==32&&B!==9||(H=!0)}else H=!0;if(H)if(h){const U=p>0?g[p-1].endIndex:r;for(let B=U+1;B<=t;B++)g[p++]=new Ps(B,"mtkw",1,!1)}else g[p++]=new Ps(t,"mtkw",1,!1);else g[p++]=new Ps(t,v,0,C);return g}function y8e(s,e,t,i){i.sort(vo.compare);const n=g8e.normalize(s,i),r=n.length;let o=0;const a=[];let l=0,c=0;for(let u=0,h=t.length;u<h;u++){const g=t[u],p=g.endIndex,_=g.type,v=g.metadata,C=g.containsRTL;for(;o<r&&n[o].startOffset<p;){const y=n[o];if(y.startOffset>c&&(c=y.startOffset,a[l++]=new Ps(c,_,v,C)),y.endOffset+1<=p)c=y.endOffset+1,a[l++]=new Ps(c,_+" "+y.className,v|y.metadata,C),o++;else{c=p,a[l++]=new Ps(c,_+" "+y.className,v|y.metadata,C);break}}p>c&&(c=p,a[l++]=new Ps(c,_,v,C))}const d=t[t.length-1].endIndex;if(o<r&&n[o].startOffset===d)for(;o<r&&n[o].startOffset===d;){const u=n[o];a[l++]=new Ps(c,u.className,u.metadata,!1),o++}return a}function S8e(s,e){const t=s.fontIsMonospace,i=s.canUseHalfwidthRightwardsArrow,n=s.containsForeignElements,r=s.lineContent,o=s.len,a=s.isOverflowing,l=s.overflowingCharCount,c=s.parts,d=s.fauxIndentLength,u=s.tabSize,h=s.startVisibleColumn,g=s.containsRTL,p=s.spaceWidth,_=s.renderSpaceCharCode,v=s.renderWhitespace,C=s.renderControlCharacters,y=new oh(o+1,c.length);let x=!1,L=0,I=h,A=0,D=0,N=0;g?e.appendString('<span dir="ltr">'):e.appendString("<span>");for(let R=0,W=c.length;R<W;R++){const H=c[R],U=H.endIndex,B=H.type,ee=H.containsRTL,re=v!==0&&H.isWhitespace(),pe=re&&!t&&(B==="mtkw"||!n),Ie=L===U&&H.isPseudoAfter();if(A=0,e.appendString("<span "),ee&&e.appendString('style="unicode-bidi:isolate" '),e.appendString('class="'),e.appendString(pe?"mtkz":B),e.appendASCIICharCode(34),re){let ge=0;{let _e=L,Re=I;for(;_e<U;_e++){const we=(r.charCodeAt(_e)===9?u-Re%u:1)|0;ge+=we,_e>=d&&(Re+=we)}}for(pe&&(e.appendString(' style="width:'),e.appendString(String(p*ge)),e.appendString('px"')),e.appendASCIICharCode(62);L<U;L++){y.setColumnInfo(L+1,R-N,A,D),N=0;const _e=r.charCodeAt(L);let Re,J;if(_e===9){Re=u-I%u|0,J=Re,!i||J>1?e.appendCharCode(8594):e.appendCharCode(65515);for(let we=2;we<=J;we++)e.appendCharCode(160)}else Re=2,J=1,e.appendCharCode(_),e.appendCharCode(8204);A+=Re,D+=J,L>=d&&(I+=J)}}else for(e.appendASCIICharCode(62);L<U;L++){y.setColumnInfo(L+1,R-N,A,D),N=0;const ge=r.charCodeAt(L);let _e=1,Re=1;switch(ge){case 9:_e=u-I%u,Re=_e;for(let J=1;J<=_e;J++)e.appendCharCode(160);break;case 32:e.appendCharCode(160);break;case 60:e.appendString("&lt;");break;case 62:e.appendString("&gt;");break;case 38:e.appendString("&amp;");break;case 0:C?e.appendCharCode(9216):e.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:e.appendCharCode(65533);break;default:Um(ge)&&Re++,C&&ge<32?e.appendCharCode(9216+ge):C&&ge===127?e.appendCharCode(9249):C&&Vpe(ge)?(e.appendString("[U+"),e.appendString(x8e(ge)),e.appendString("]"),_e=8,Re=_e):e.appendCharCode(ge)}A+=_e,D+=Re,L>=d&&(I+=Re)}Ie?N++:N=0,L>=o&&!x&&H.isPseudoAfter()&&(x=!0,y.setColumnInfo(L+1,R,A,D)),e.appendString("</span>")}return x||y.setColumnInfo(o+1,c.length-1,A,D),a&&(e.appendString('<span class="mtkoverflow">'),e.appendString(b("showMore","Show more ({0})",L8e(l))),e.appendString("</span>")),e.appendString("</span>"),new SH(y,g,n)}function x8e(s){return s.toString(16).toUpperCase().padStart(4,"0")}function L8e(s){return s<1024?b("overflow.chars","{0} chars",s):s<1024*1024?`${(s/1024).toFixed(1)} KB`:`${(s/1024/1024).toFixed(1)} MB`}class pse{constructor(e,t,i,n){this._viewportBrand=void 0,this.top=e|0,this.left=t|0,this.width=i|0,this.height=n|0}}class k8e{constructor(e,t){this.tabSize=e,this.data=t}}class bG{constructor(e,t,i,n,r,o,a){this._viewLineDataBrand=void 0,this.content=e,this.continuesWithWrappedLine=t,this.minColumn=i,this.maxColumn=n,this.startVisibleColumn=r,this.tokens=o,this.inlineDecorations=a}}class Pl{constructor(e,t,i,n,r,o,a,l,c,d){this.minColumn=e,this.maxColumn=t,this.content=i,this.continuesWithWrappedLine=n,this.isBasicASCII=Pl.isBasicASCII(i,o),this.containsRTL=Pl.containsRTL(i,this.isBasicASCII,r),this.tokens=a,this.inlineDecorations=l,this.tabSize=c,this.startVisibleColumn=d}static isBasicASCII(e,t){return t?zE(e):!0}static containsRTL(e,t,i){return!t&&i?h1(e):!1}}class KL{constructor(e,t,i){this.range=e,this.inlineClassName=t,this.type=i}}class I8e{constructor(e,t,i,n){this.startOffset=e,this.endOffset=t,this.inlineClassName=i,this.inlineClassNameAffectsLetterSpacing=n}toInlineDecoration(e){return new KL(new F(e,this.startOffset+1,e,this.endOffset+1),this.inlineClassName,this.inlineClassNameAffectsLetterSpacing?3:0)}}class Bpe{constructor(e,t){this._viewModelDecorationBrand=void 0,this.range=e,this.options=t}}class OI{constructor(e,t,i){this.color=e,this.zIndex=t,this.data=i}static compareByRenderingProps(e,t){return e.zIndex===t.zIndex?e.color<t.color?-1:e.color>t.color?1:0:e.zIndex-t.zIndex}static equals(e,t){return e.color===t.color&&e.zIndex===t.zIndex&&dn(e.data,t.data)}static equalsArr(e,t){return dn(e,t,OI.equals)}}function E8e(s){return Array.isArray(s)}function D8e(s){return!E8e(s)}function Wpe(s){return typeof s=="string"}function mse(s){return!Wpe(s)}function xb(s){return!s}function dg(s,e){return s.ignoreCase&&e?e.toLowerCase():e}function _se(s){return s.replace(/[&<>'"_]/g,"-")}function T8e(s,e){console.log(`${s.languageId}: ${e}`)}function Ji(s,e){return new Error(`${s.languageId}: ${e}`)}function Pp(s,e,t,i,n){const r=/\$((\$)|(#)|(\d\d?)|[sS](\d\d?)|@(\w+))/g;let o=null;return e.replace(r,function(a,l,c,d,u,h,g,p,_){return xb(c)?xb(d)?!xb(u)&&u<i.length?dg(s,i[u]):!xb(g)&&s&&typeof s[g]=="string"?s[g]:(o===null&&(o=n.split("."),o.unshift(n)),!xb(h)&&h<o.length?dg(s,o[h]):""):dg(s,t):"$"})}function N8e(s,e,t){const i=/\$[sS](\d\d?)/g;let n=null;return e.replace(i,function(r,o){return n===null&&(n=t.split("."),n.unshift(t)),!xb(o)&&o<n.length?dg(s,n[o]):""})}function EN(s,e){let t=e;for(;t&&t.length>0;){const i=s.tokenizer[t];if(i)return i;const n=t.lastIndexOf(".");n<0?t=null:t=t.substr(0,n)}return null}function R8e(s,e){let t=e;for(;t&&t.length>0;){if(s.stateNames[t])return!0;const n=t.lastIndexOf(".");n<0?t=null:t=t.substr(0,n)}return!1}var A8e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},P8e=function(s,e){return function(t,i){e(t,i,s)}},xH;const Hpe=5,rO=class rO{static create(e,t){return this._INSTANCE.create(e,t)}constructor(e){this._maxCacheDepth=e,this._entries=Object.create(null)}create(e,t){if(e!==null&&e.depth>=this._maxCacheDepth)return new Dy(e,t);let i=Dy.getStackElementId(e);i.length>0&&(i+="|"),i+=t;let n=this._entries[i];return n||(n=new Dy(e,t),this._entries[i]=n,n)}};rO._INSTANCE=new rO(Hpe);let FI=rO;class Dy{constructor(e,t){this.parent=e,this.state=t,this.depth=(this.parent?this.parent.depth:0)+1}static getStackElementId(e){let t="";for(;e!==null;)t.length>0&&(t+="|"),t+=e.state,e=e.parent;return t}static _equals(e,t){for(;e!==null&&t!==null;){if(e===t)return!0;if(e.state!==t.state)return!1;e=e.parent,t=t.parent}return e===null&&t===null}equals(e){return Dy._equals(this,e)}push(e){return FI.create(this,e)}pop(){return this.parent}popall(){let e=this;for(;e.parent;)e=e.parent;return e}switchTo(e){return FI.create(this.parent,e)}}class AC{constructor(e,t){this.languageId=e,this.state=t}equals(e){return this.languageId===e.languageId&&this.state.equals(e.state)}clone(){return this.state.clone()===this.state?this:new AC(this.languageId,this.state)}}const oO=class oO{static create(e,t){return this._INSTANCE.create(e,t)}constructor(e){this._maxCacheDepth=e,this._entries=Object.create(null)}create(e,t){if(t!==null)return new GL(e,t);if(e!==null&&e.depth>=this._maxCacheDepth)return new GL(e,t);const i=Dy.getStackElementId(e);let n=this._entries[i];return n||(n=new GL(e,null),this._entries[i]=n,n)}};oO._INSTANCE=new oO(Hpe);let Mp=oO;class GL{constructor(e,t){this.stack=e,this.embeddedLanguageData=t}clone(){return(this.embeddedLanguageData?this.embeddedLanguageData.clone():null)===this.embeddedLanguageData?this:Mp.create(this.stack,this.embeddedLanguageData)}equals(e){return!(e instanceof GL)||!this.stack.equals(e.stack)?!1:this.embeddedLanguageData===null&&e.embeddedLanguageData===null?!0:this.embeddedLanguageData===null||e.embeddedLanguageData===null?!1:this.embeddedLanguageData.equals(e.embeddedLanguageData)}}class M8e{constructor(){this._tokens=[],this._languageId=null,this._lastTokenType=null,this._lastTokenLanguage=null}enterLanguage(e){this._languageId=e}emit(e,t){this._lastTokenType===t&&this._lastTokenLanguage===this._languageId||(this._lastTokenType=t,this._lastTokenLanguage=this._languageId,this._tokens.push(new Yk(e,t,this._languageId)))}nestedLanguageTokenize(e,t,i,n){const r=i.languageId,o=i.state,a=Ln.get(r);if(!a)return this.enterLanguage(r),this.emit(n,""),o;const l=a.tokenize(e,t,o);if(n!==0)for(const c of l.tokens)this._tokens.push(new Yk(c.offset+n,c.type,c.language));else this._tokens=this._tokens.concat(l.tokens);return this._lastTokenType=null,this._lastTokenLanguage=null,this._languageId=null,l.endState}finalize(e){return new Iq(this._tokens,e)}}class iP{constructor(e,t){this._languageService=e,this._theme=t,this._prependTokens=null,this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0}enterLanguage(e){this._currentLanguageId=this._languageService.languageIdCodec.encodeLanguageId(e)}emit(e,t){const i=this._theme.match(this._currentLanguageId,t)|1024;this._lastTokenMetadata!==i&&(this._lastTokenMetadata=i,this._tokens.push(e),this._tokens.push(i))}static _merge(e,t,i){const n=e!==null?e.length:0,r=t.length,o=i!==null?i.length:0;if(n===0&&r===0&&o===0)return new Uint32Array(0);if(n===0&&r===0)return i;if(r===0&&o===0)return e;const a=new Uint32Array(n+r+o);e!==null&&a.set(e);for(let l=0;l<r;l++)a[n+l]=t[l];return i!==null&&a.set(i,n+r),a}nestedLanguageTokenize(e,t,i,n){const r=i.languageId,o=i.state,a=Ln.get(r);if(!a)return this.enterLanguage(r),this.emit(n,""),o;const l=a.tokenizeEncoded(e,t,o);if(n!==0)for(let c=0,d=l.tokens.length;c<d;c+=2)l.tokens[c]+=n;return this._prependTokens=iP._merge(this._prependTokens,this._tokens,l.tokens),this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0,l.endState}finalize(e){return new X4(iP._merge(this._prependTokens,this._tokens,null),e)}}let VI=xH=class extends te{constructor(e,t,i,n,r){super(),this._configurationService=r,this._languageService=e,this._standaloneThemeService=t,this._languageId=i,this._lexer=n,this._embeddedLanguages=Object.create(null),this.embeddedLoaded=Promise.resolve(void 0);let o=!1;this._register(Ln.onDidChange(a=>{if(o)return;let l=!1;for(let c=0,d=a.changedLanguages.length;c<d;c++){const u=a.changedLanguages[c];if(this._embeddedLanguages[u]){l=!0;break}}l&&(o=!0,Ln.handleChange([this._languageId]),o=!1)})),this._maxTokenizationLineLength=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:this._languageId}),this._register(this._configurationService.onDidChangeConfiguration(a=>{a.affectsConfiguration("editor.maxTokenizationLineLength")&&(this._maxTokenizationLineLength=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:this._languageId}))}))}getLoadStatus(){const e=[];for(const t in this._embeddedLanguages){const i=Ln.get(t);if(i){if(i instanceof xH){const n=i.getLoadStatus();n.loaded===!1&&e.push(n.promise)}continue}Ln.isResolved(t)||e.push(Ln.getOrCreate(t))}return e.length===0?{loaded:!0}:{loaded:!1,promise:Promise.all(e).then(t=>{})}}getInitialState(){const e=FI.create(null,this._lexer.start);return Mp.create(e,null)}tokenize(e,t,i){if(e.length>=this._maxTokenizationLineLength)return EK(this._languageId,i);const n=new M8e,r=this._tokenize(e,t,i,n);return n.finalize(r)}tokenizeEncoded(e,t,i){if(e.length>=this._maxTokenizationLineLength)return MF(this._languageService.languageIdCodec.encodeLanguageId(this._languageId),i);const n=new iP(this._languageService,this._standaloneThemeService.getColorTheme().tokenTheme),r=this._tokenize(e,t,i,n);return n.finalize(r)}_tokenize(e,t,i,n){return i.embeddedLanguageData?this._nestedTokenize(e,t,i,0,n):this._myTokenize(e,t,i,0,n)}_findLeavingNestedLanguageOffset(e,t){let i=this._lexer.tokenizer[t.stack.state];if(!i&&(i=EN(this._lexer,t.stack.state),!i))throw Ji(this._lexer,"tokenizer state is not defined: "+t.stack.state);let n=-1,r=!1;for(const o of i){if(!mse(o.action)||o.action.nextEmbedded!=="@pop")continue;r=!0;let a=o.resolveRegex(t.stack.state);const l=a.source;if(l.substr(0,4)==="^(?:"&&l.substr(l.length-1,1)===")"){const d=(a.ignoreCase?"i":"")+(a.unicode?"u":"");a=new RegExp(l.substr(4,l.length-5),d)}const c=e.search(a);c===-1||c!==0&&o.matchOnlyAtLineStart||(n===-1||c<n)&&(n=c)}if(!r)throw Ji(this._lexer,'no rule containing nextEmbedded: "@pop" in tokenizer embedded state: '+t.stack.state);return n}_nestedTokenize(e,t,i,n,r){const o=this._findLeavingNestedLanguageOffset(e,i);if(o===-1){const c=r.nestedLanguageTokenize(e,t,i.embeddedLanguageData,n);return Mp.create(i.stack,new AC(i.embeddedLanguageData.languageId,c))}const a=e.substring(0,o);a.length>0&&r.nestedLanguageTokenize(a,!1,i.embeddedLanguageData,n);const l=e.substring(o);return this._myTokenize(l,t,i,n+o,r)}_safeRuleName(e){return e?e.name:"(unknown)"}_myTokenize(e,t,i,n,r){r.enterLanguage(this._languageId);const o=e.length,a=t&&this._lexer.includeLF?e+`
`:e,l=a.length;let c=i.embeddedLanguageData,d=i.stack,u=0,h=null,g=!0;for(;g||u<l;){const p=u,_=d.depth,v=h?h.groups.length:0,C=d.state;let y=null,x=null,L=null,I=null,A=null;if(h){y=h.matches;const R=h.groups.shift();x=R.matched,L=R.action,I=h.rule,h.groups.length===0&&(h=null)}else{if(!g&&u>=l)break;g=!1;let R=this._lexer.tokenizer[C];if(!R&&(R=EN(this._lexer,C),!R))throw Ji(this._lexer,"tokenizer state is not defined: "+C);const W=a.substr(u);for(const H of R)if((u===0||!H.matchOnlyAtLineStart)&&(y=W.match(H.resolveRegex(C)),y)){x=y[0],L=H.action;break}}if(y||(y=[""],x=""),L||(u<l&&(y=[a.charAt(u)],x=y[0]),L=this._lexer.defaultToken),x===null)break;for(u+=x.length;D8e(L)&&mse(L)&&L.test;)L=L.test(x,y,C,u===l);let D=null;if(typeof L=="string"||Array.isArray(L))D=L;else if(L.group)D=L.group;else if(L.token!==null&&L.token!==void 0){if(L.tokenSubst?D=Pp(this._lexer,L.token,x,y,C):D=L.token,L.nextEmbedded)if(L.nextEmbedded==="@pop"){if(!c)throw Ji(this._lexer,"cannot pop embedded language if not inside one");c=null}else{if(c)throw Ji(this._lexer,"cannot enter embedded language from within an embedded language");A=Pp(this._lexer,L.nextEmbedded,x,y,C)}if(L.goBack&&(u=Math.max(0,u-L.goBack)),L.switchTo&&typeof L.switchTo=="string"){let R=Pp(this._lexer,L.switchTo,x,y,C);if(R[0]==="@"&&(R=R.substr(1)),EN(this._lexer,R))d=d.switchTo(R);else throw Ji(this._lexer,"trying to switch to a state '"+R+"' that is undefined in rule: "+this._safeRuleName(I))}else{if(L.transform&&typeof L.transform=="function")throw Ji(this._lexer,"action.transform not supported");if(L.next)if(L.next==="@push"){if(d.depth>=this._lexer.maxStack)throw Ji(this._lexer,"maximum tokenizer stack size reached: ["+d.state+","+d.parent.state+",...]");d=d.push(C)}else if(L.next==="@pop"){if(d.depth<=1)throw Ji(this._lexer,"trying to pop an empty stack in rule: "+this._safeRuleName(I));d=d.pop()}else if(L.next==="@popall")d=d.popall();else{let R=Pp(this._lexer,L.next,x,y,C);if(R[0]==="@"&&(R=R.substr(1)),EN(this._lexer,R))d=d.push(R);else throw Ji(this._lexer,"trying to set a next state '"+R+"' that is undefined in rule: "+this._safeRuleName(I))}}L.log&&typeof L.log=="string"&&T8e(this._lexer,this._lexer.languageId+": "+Pp(this._lexer,L.log,x,y,C))}if(D===null)throw Ji(this._lexer,"lexer rule has no well-defined action in rule: "+this._safeRuleName(I));const N=R=>{const W=this._languageService.getLanguageIdByLanguageName(R)||this._languageService.getLanguageIdByMimeType(R)||R,H=this._getNestedEmbeddedLanguageData(W);if(u<l){const U=e.substr(u);return this._nestedTokenize(U,t,Mp.create(d,H),n+u,r)}else return Mp.create(d,H)};if(Array.isArray(D)){if(h&&h.groups.length>0)throw Ji(this._lexer,"groups cannot be nested: "+this._safeRuleName(I));if(y.length!==D.length+1)throw Ji(this._lexer,"matched number of groups does not match the number of actions in rule: "+this._safeRuleName(I));let R=0;for(let W=1;W<y.length;W++)R+=y[W].length;if(R!==x.length)throw Ji(this._lexer,"with groups, all characters should be matched in consecutive groups in rule: "+this._safeRuleName(I));h={rule:I,matches:y,groups:[]};for(let W=0;W<D.length;W++)h.groups[W]={action:D[W],matched:y[W+1]};u-=x.length;continue}else{if(D==="@rematch"&&(u-=x.length,x="",y=null,D="",A!==null))return N(A);if(x.length===0){if(l===0||_!==d.depth||C!==d.state||(h?h.groups.length:0)!==v)continue;throw Ji(this._lexer,"no progress in tokenizer in rule: "+this._safeRuleName(I))}let R=null;if(Wpe(D)&&D.indexOf("@brackets")===0){const W=D.substr(9),H=O8e(this._lexer,x);if(!H)throw Ji(this._lexer,"@brackets token returned but no bracket defined as: "+x);R=_se(H.token+W)}else{const W=D===""?"":D+this._lexer.tokenPostfix;R=_se(W)}p<o&&r.emit(p+n,R)}if(A!==null)return N(A)}return Mp.create(d,c)}_getNestedEmbeddedLanguageData(e){if(!this._languageService.isRegisteredLanguageId(e))return new AC(e,S1);e!==this._languageId&&(this._languageService.requestBasicLanguageFeatures(e),Ln.getOrCreate(e),this._embeddedLanguages[e]=!0);const t=Ln.get(e);return t?new AC(e,t.getInitialState()):new AC(e,S1)}};VI=xH=A8e([P8e(4,At)],VI);function O8e(s,e){if(!e)return null;e=dg(s,e);const t=s.brackets;for(const i of t){if(i.open===e)return{token:i.token,bracketType:1};if(i.close===e)return{token:i.token,bracketType:-1}}return null}const iB=Og("standaloneColorizer",{createHTML:s=>s});class vG{static colorizeElement(e,t,i,n){n=n||{};const r=n.theme||"vs",o=n.mimeType||i.getAttribute("lang")||i.getAttribute("data-lang");if(!o)return console.error("Mode not detected"),Promise.resolve();const a=t.getLanguageIdByMimeType(o)||o;e.setTheme(r);const l=i.firstChild?i.firstChild.nodeValue:"";i.className+=" "+r;const c=d=>{const u=(iB==null?void 0:iB.createHTML(d))??d;i.innerHTML=u};return this.colorize(t,l||"",a,n).then(c,d=>console.error(d))}static async colorize(e,t,i,n){const r=e.languageIdCodec;let o=4;n&&typeof n.tabSize=="number"&&(o=n.tabSize),Pq(t)&&(t=t.substr(1));const a=Uh(t);if(!e.isRegisteredLanguageId(i))return bse(a,o,r);const l=await Ln.getOrCreate(i);return l?F8e(a,o,l,r):bse(a,o,r)}static colorizeLine(e,t,i,n,r=4){const o=Pl.isBasicASCII(e,t),a=Pl.containsRTL(e,o,i);return JF(new w_(!1,!0,e,!1,o,a,0,n,[],r,0,0,0,0,-1,"none",!1,!1,null)).html}static colorizeModelLine(e,t,i=4){const n=e.getLineContent(t);e.tokenization.forceTokenization(t);const o=e.tokenization.getLineTokens(t).inflate();return this.colorizeLine(n,e.mightContainNonBasicASCII(),e.mightContainRTL(),o,i)}}function F8e(s,e,t,i){return new Promise((n,r)=>{const o=()=>{const a=V8e(s,e,t,i);if(t instanceof VI){const l=t.getLoadStatus();if(l.loaded===!1){l.promise.then(o,r);return}}n(a)};o()})}function bse(s,e,t){let i=[];const r=new Uint32Array(2);r[0]=0,r[1]=33587200;for(let o=0,a=s.length;o<a;o++){const l=s[o];r[0]=l.length;const c=new Ws(r,l,t),d=Pl.isBasicASCII(l,!0),u=Pl.containsRTL(l,d,!0),h=JF(new w_(!1,!0,l,!1,d,u,0,c,[],e,0,0,0,0,-1,"none",!1,!1,null));i=i.concat(h.html),i.push("<br/>")}return i.join("")}function V8e(s,e,t,i){let n=[],r=t.getInitialState();for(let o=0,a=s.length;o<a;o++){const l=s[o],c=t.tokenizeEncoded(l,!0,r);Ws.convertToEndOffset(c.tokens,l.length);const d=new Ws(c.tokens,l,i),u=Pl.isBasicASCII(l,!0),h=Pl.containsRTL(l,u,!0),g=JF(new w_(!1,!0,l,!1,u,h,0,d.inflate(),[],e,0,0,0,0,-1,"none",!1,!1,null));n=n.concat(g.html),n.push("<br/>"),r=c.endState}return n.join("")}var B8e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},W8e=function(s,e){return function(t,i){e(t,i,s)}},By;let nP=(By=class{constructor(e,t){}dispose(){}},By.ID="editor.contrib.markerDecorations",By);nP=B8e([W8e(1,BK)],nP);Zt(nP.ID,nP,0);class zpe extends te{constructor(e,t){super(),this._onDidChange=this._register(new Z),this.onDidChange=this._onDidChange.event,this._referenceDomElement=e,this._width=-1,this._height=-1,this._resizeObserver=null,this.measureReferenceDomElement(!1,t)}dispose(){this.stopObserving(),super.dispose()}getWidth(){return this._width}getHeight(){return this._height}startObserving(){if(!this._resizeObserver&&this._referenceDomElement){let e=null;const t=()=>{e?this.observe({width:e.width,height:e.height}):this.observe()};let i=!1,n=!1;const r=()=>{if(i&&!n)try{i=!1,n=!0,t()}finally{Fa(nt(this._referenceDomElement),()=>{n=!1,r()})}};this._resizeObserver=new ResizeObserver(o=>{o&&o[0]&&o[0].contentRect?e={width:o[0].contentRect.width,height:o[0].contentRect.height}:e=null,i=!0,r()}),this._resizeObserver.observe(this._referenceDomElement)}}stopObserving(){this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null)}observe(e){this.measureReferenceDomElement(!0,e)}measureReferenceDomElement(e,t){let i=0,n=0;t?(i=t.width,n=t.height):this._referenceDomElement&&(i=this._referenceDomElement.clientWidth,n=this._referenceDomElement.clientHeight),i=Math.max(5,i),n=Math.max(5,n),(this._width!==i||this._height!==n)&&(this._width=i,this._height=n,e&&this._onDidChange.fire())}}const ey=class ey{constructor(e,t){this.key=e,this.migrate=t}apply(e){const t=ey._read(e,this.key),i=r=>ey._read(e,r),n=(r,o)=>ey._write(e,r,o);this.migrate(t,i,n)}static _read(e,t){if(typeof e>"u")return;const i=t.indexOf(".");if(i>=0){const n=t.substring(0,i);return this._read(e[n],t.substring(i+1))}return e[t]}static _write(e,t,i){const n=t.indexOf(".");if(n>=0){const r=t.substring(0,n);e[r]=e[r]||{},this._write(e[r],t.substring(n+1),i);return}e[t]=i}};ey.items=[];let BI=ey;function Cu(s,e){BI.items.push(new BI(s,e))}function Ha(s,e){Cu(s,(t,i,n)=>{if(typeof t<"u"){for(const[r,o]of e)if(t===r){n(s,o);return}}})}function H8e(s){BI.items.forEach(e=>e.apply(s))}Ha("wordWrap",[[!0,"on"],[!1,"off"]]);Ha("lineNumbers",[[!0,"on"],[!1,"off"]]);Ha("cursorBlinking",[["visible","solid"]]);Ha("renderWhitespace",[[!0,"boundary"],[!1,"none"]]);Ha("renderLineHighlight",[[!0,"line"],[!1,"none"]]);Ha("acceptSuggestionOnEnter",[[!0,"on"],[!1,"off"]]);Ha("tabCompletion",[[!1,"off"],[!0,"onlySnippets"]]);Ha("hover",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);Ha("parameterHints",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);Ha("autoIndent",[[!1,"advanced"],[!0,"full"]]);Ha("matchBrackets",[[!0,"always"],[!1,"never"]]);Ha("renderFinalNewline",[[!0,"on"],[!1,"off"]]);Ha("cursorSmoothCaretAnimation",[[!0,"on"],[!1,"off"]]);Ha("occurrencesHighlight",[[!0,"singleFile"],[!1,"off"]]);Ha("wordBasedSuggestions",[[!0,"matchingDocuments"],[!1,"off"]]);Cu("autoClosingBrackets",(s,e,t)=>{s===!1&&(t("autoClosingBrackets","never"),typeof e("autoClosingQuotes")>"u"&&t("autoClosingQuotes","never"),typeof e("autoSurround")>"u"&&t("autoSurround","never"))});Cu("renderIndentGuides",(s,e,t)=>{typeof s<"u"&&(t("renderIndentGuides",void 0),typeof e("guides.indentation")>"u"&&t("guides.indentation",!!s))});Cu("highlightActiveIndentGuide",(s,e,t)=>{typeof s<"u"&&(t("highlightActiveIndentGuide",void 0),typeof e("guides.highlightActiveIndentation")>"u"&&t("guides.highlightActiveIndentation",!!s))});const z8e={method:"showMethods",function:"showFunctions",constructor:"showConstructors",deprecated:"showDeprecated",field:"showFields",variable:"showVariables",class:"showClasses",struct:"showStructs",interface:"showInterfaces",module:"showModules",property:"showProperties",event:"showEvents",operator:"showOperators",unit:"showUnits",value:"showValues",constant:"showConstants",enum:"showEnums",enumMember:"showEnumMembers",keyword:"showKeywords",text:"showWords",color:"showColors",file:"showFiles",reference:"showReferences",folder:"showFolders",typeParameter:"showTypeParameters",snippet:"showSnippets"};Cu("suggest.filteredTypes",(s,e,t)=>{if(s&&typeof s=="object"){for(const i of Object.entries(z8e))s[i[0]]===!1&&typeof e(`suggest.${i[1]}`)>"u"&&t(`suggest.${i[1]}`,!1);t("suggest.filteredTypes",void 0)}});Cu("quickSuggestions",(s,e,t)=>{if(typeof s=="boolean"){const i=s?"on":"off";t("quickSuggestions",{comments:i,strings:i,other:i})}});Cu("experimental.stickyScroll.enabled",(s,e,t)=>{typeof s=="boolean"&&(t("experimental.stickyScroll.enabled",void 0),typeof e("stickyScroll.enabled")>"u"&&t("stickyScroll.enabled",s))});Cu("experimental.stickyScroll.maxLineCount",(s,e,t)=>{typeof s=="number"&&(t("experimental.stickyScroll.maxLineCount",void 0),typeof e("stickyScroll.maxLineCount")>"u"&&t("stickyScroll.maxLineCount",s))});Cu("codeActionsOnSave",(s,e,t)=>{if(s&&typeof s=="object"){let i=!1;const n={};for(const r of Object.entries(s))typeof r[1]=="boolean"?(i=!0,n[r[0]]=r[1]?"explicit":"never"):n[r[0]]=r[1];i&&t("codeActionsOnSave",n)}});Cu("codeActionWidget.includeNearbyQuickfixes",(s,e,t)=>{typeof s=="boolean"&&(t("codeActionWidget.includeNearbyQuickfixes",void 0),typeof e("codeActionWidget.includeNearbyQuickFixes")>"u"&&t("codeActionWidget.includeNearbyQuickFixes",s))});Cu("lightbulb.enabled",(s,e,t)=>{typeof s=="boolean"&&t("lightbulb.enabled",s?void 0:"off")});class U8e{constructor(){this._tabFocus=!1,this._onDidChangeTabFocus=new Z,this.onDidChangeTabFocus=this._onDidChangeTabFocus.event}getTabFocusMode(){return this._tabFocus}setTabFocusMode(e){this._tabFocus=e,this._onDidChangeTabFocus.fire(this._tabFocus)}}const R1=new U8e;var j8e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},$8e=function(s,e){return function(t,i){e(t,i,s)}};let LH=class extends te{constructor(e,t,i,n,r){super(),this._accessibilityService=r,this._onDidChange=this._register(new Z),this.onDidChange=this._onDidChange.event,this._onDidChangeFast=this._register(new Z),this.onDidChangeFast=this._onDidChangeFast.event,this._isDominatedByLongLines=!1,this._viewLineCount=1,this._lineNumbersDigitCount=1,this._reservedHeight=0,this._glyphMarginDecorationLaneCount=1,this._computeOptionsMemory=new cue,this.isSimpleWidget=e,this.contextMenuId=t,this._containerObserver=this._register(new zpe(n,i.dimension)),this._targetWindowId=nt(n).vscodeWindowId,this._rawOptions=vse(i),this._validatedOptions=Op.validateOptions(this._rawOptions),this.options=this._computeOptions(),this.options.get(13)&&this._containerObserver.startObserving(),this._register(oc.onDidChangeZoomLevel(()=>this._recomputeOptions())),this._register(R1.onDidChangeTabFocus(()=>this._recomputeOptions())),this._register(this._containerObserver.onDidChange(()=>this._recomputeOptions())),this._register(ZW.onDidChange(()=>this._recomputeOptions())),this._register(nI.getInstance(nt(n)).onDidChange(()=>this._recomputeOptions())),this._register(this._accessibilityService.onDidChangeScreenReaderOptimized(()=>this._recomputeOptions()))}_recomputeOptions(){const e=this._computeOptions(),t=Op.checkEquals(this.options,e);t!==null&&(this.options=e,this._onDidChangeFast.fire(t),this._onDidChange.fire(t))}_computeOptions(){const e=this._readEnvConfiguration(),t=Qb.createFromValidatedSettings(this._validatedOptions,e.pixelRatio,this.isSimpleWidget),i=this._readFontInfo(t),n={memory:this._computeOptionsMemory,outerWidth:e.outerWidth,outerHeight:e.outerHeight-this._reservedHeight,fontInfo:i,extraEditorClassName:e.extraEditorClassName,isDominatedByLongLines:this._isDominatedByLongLines,viewLineCount:this._viewLineCount,lineNumbersDigitCount:this._lineNumbersDigitCount,emptySelectionClipboard:e.emptySelectionClipboard,pixelRatio:e.pixelRatio,tabFocusMode:R1.getTabFocusMode(),accessibilitySupport:e.accessibilitySupport,glyphMarginDecorationLaneCount:this._glyphMarginDecorationLaneCount};return Op.computeOptions(this._validatedOptions,n)}_readEnvConfiguration(){return{extraEditorClassName:K8e(),outerWidth:this._containerObserver.getWidth(),outerHeight:this._containerObserver.getHeight(),emptySelectionClipboard:Z4||_c,pixelRatio:nI.getInstance(dte(this._targetWindowId,!0).window).value,accessibilitySupport:this._accessibilityService.isScreenReaderOptimized()?2:this._accessibilityService.getAccessibilitySupport()}}_readFontInfo(e){return ZW.readFontInfo(dte(this._targetWindowId,!0).window,e)}getRawOptions(){return this._rawOptions}updateOptions(e){const t=vse(e);Op.applyUpdate(this._rawOptions,t)&&(this._validatedOptions=Op.validateOptions(this._rawOptions),this._recomputeOptions())}observeContainer(e){this._containerObserver.observe(e)}setIsDominatedByLongLines(e){this._isDominatedByLongLines!==e&&(this._isDominatedByLongLines=e,this._recomputeOptions())}setModelLineCount(e){const t=q8e(e);this._lineNumbersDigitCount!==t&&(this._lineNumbersDigitCount=t,this._recomputeOptions())}setViewLineCount(e){this._viewLineCount!==e&&(this._viewLineCount=e,this._recomputeOptions())}setReservedHeight(e){this._reservedHeight!==e&&(this._reservedHeight=e,this._recomputeOptions())}setGlyphMarginDecorationLaneCount(e){this._glyphMarginDecorationLaneCount!==e&&(this._glyphMarginDecorationLaneCount=e,this._recomputeOptions())}};LH=j8e([$8e(4,Wa)],LH);function q8e(s){let e=0;for(;s;)s=Math.floor(s/10),e++;return e||1}function K8e(){let s="";return!jm&&!Oue&&(s+="no-user-select "),jm&&(s+="no-minimap-shadow ",s+="enable-user-select "),Wt&&(s+="mac "),s}class G8e{constructor(){this._values=[]}_read(e){return this._values[e]}get(e){return this._values[e]}_write(e,t){this._values[e]=t}}class Q8e{constructor(){this._values=[]}_read(e){if(e>=this._values.length)throw new Error("Cannot read uninitialized value");return this._values[e]}get(e){return this._read(e)}_write(e,t){this._values[e]=t}}class Op{static validateOptions(e){const t=new G8e;for(const i of yC){const n=i.name==="_never_"?void 0:e[i.name];t._write(i.id,i.validate(n))}return t}static computeOptions(e,t){const i=new Q8e;for(const n of yC)i._write(n.id,n.compute(t,i,e._read(n.id)));return i}static _deepEquals(e,t){if(typeof e!="object"||typeof t!="object"||!e||!t)return e===t;if(Array.isArray(e)||Array.isArray(t))return Array.isArray(e)&&Array.isArray(t)?dn(e,t):!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(!Op._deepEquals(e[i],t[i]))return!1;return!0}static checkEquals(e,t){const i=[];let n=!1;for(const r of yC){const o=!Op._deepEquals(e._read(r.id),t._read(r.id));i[r.id]=o,o&&(n=!0)}return n?new lue(i):null}static applyUpdate(e,t){let i=!1;for(const n of yC)if(t.hasOwnProperty(n.name)){const r=n.applyUpdate(e[n.name],t[n.name]);e[n.name]=r.newValue,i=i||r.didChange}return i}}function vse(s){const e=Ef(s);return H8e(e),e}var Qp;(function(s){const e={total:0,min:Number.MAX_VALUE,max:0},t={...e},i={...e},n={...e};let r=0;const o={keydown:0,input:0,render:0};function a(){C(),performance.mark("inputlatency/start"),performance.mark("keydown/start"),o.keydown=1,queueMicrotask(l)}s.onKeyDown=a;function l(){o.keydown===1&&(performance.mark("keydown/end"),o.keydown=2)}function c(){performance.mark("input/start"),o.input=1,v()}s.onBeforeInput=c;function d(){o.input===0&&c(),queueMicrotask(u)}s.onInput=d;function u(){o.input===1&&(performance.mark("input/end"),o.input=2)}function h(){C()}s.onKeyUp=h;function g(){C()}s.onSelectionChange=g;function p(){o.keydown===2&&o.input===2&&o.render===0&&(performance.mark("render/start"),o.render=1,queueMicrotask(_),v())}s.onRenderStart=p;function _(){o.render===1&&(performance.mark("render/end"),o.render=2)}function v(){setTimeout(C)}function C(){o.keydown===2&&o.input===2&&o.render===2&&(performance.mark("inputlatency/end"),performance.measure("keydown","keydown/start","keydown/end"),performance.measure("input","input/start","input/end"),performance.measure("render","render/start","render/end"),performance.measure("inputlatency","inputlatency/start","inputlatency/end"),y("keydown",e),y("input",t),y("render",i),y("inputlatency",n),r++,x())}function y(D,N){const R=performance.getEntriesByName(D)[0].duration;N.total+=R,N.min=Math.min(N.min,R),N.max=Math.max(N.max,R)}function x(){performance.clearMarks("keydown/start"),performance.clearMarks("keydown/end"),performance.clearMarks("input/start"),performance.clearMarks("input/end"),performance.clearMarks("render/start"),performance.clearMarks("render/end"),performance.clearMarks("inputlatency/start"),performance.clearMarks("inputlatency/end"),performance.clearMeasures("keydown"),performance.clearMeasures("input"),performance.clearMeasures("render"),performance.clearMeasures("inputlatency"),o.keydown=0,o.input=0,o.render=0}function L(){if(r===0)return;const D={keydown:I(e),input:I(t),render:I(i),total:I(n),sampleCount:r};return A(e),A(t),A(i),A(n),r=0,D}s.getAndClearMeasurements=L;function I(D){return{average:D.total/r,max:D.max,min:D.min}}function A(D){D.total=0,D.min=Number.MAX_VALUE,D.max=0}})(Qp||(Qp={}));class e5{constructor(e,t){this.x=e,this.y=t,this._pageCoordinatesBrand=void 0}toClientCoordinates(e){return new Upe(this.x-e.scrollX,this.y-e.scrollY)}}class Upe{constructor(e,t){this.clientX=e,this.clientY=t,this._clientCoordinatesBrand=void 0}toPageCoordinates(e){return new e5(this.clientX+e.scrollX,this.clientY+e.scrollY)}}class Y8e{constructor(e,t,i,n){this.x=e,this.y=t,this.width=i,this.height=n,this._editorPagePositionBrand=void 0}}class X8e{constructor(e,t){this.x=e,this.y=t,this._positionRelativeToEditorBrand=void 0}}function wG(s){const e=Pn(s);return new Y8e(e.left,e.top,e.width,e.height)}function CG(s,e,t){const i=e.width/s.offsetWidth,n=e.height/s.offsetHeight,r=(t.x-e.x)/i,o=(t.y-e.y)/n;return new X8e(r,o)}class Jm extends Xc{constructor(e,t,i){super(nt(i),e),this._editorMouseEventBrand=void 0,this.isFromPointerCapture=t,this.pos=new e5(this.posx,this.posy),this.editorPos=wG(i),this.relativePos=CG(i,this.editorPos,this.pos)}}class Z8e{constructor(e){this._editorViewDomNode=e}_create(e){return new Jm(e,!1,this._editorViewDomNode)}onContextMenu(e,t){return oe(e,"contextmenu",i=>{t(this._create(i))})}onMouseUp(e,t){return oe(e,"mouseup",i=>{t(this._create(i))})}onMouseDown(e,t){return oe(e,Le.MOUSE_DOWN,i=>{t(this._create(i))})}onPointerDown(e,t){return oe(e,Le.POINTER_DOWN,i=>{t(this._create(i),i.pointerId)})}onMouseLeave(e,t){return oe(e,Le.MOUSE_LEAVE,i=>{t(this._create(i))})}onMouseMove(e,t){return oe(e,"mousemove",i=>t(this._create(i)))}}class J8e{constructor(e){this._editorViewDomNode=e}_create(e){return new Jm(e,!1,this._editorViewDomNode)}onPointerUp(e,t){return oe(e,"pointerup",i=>{t(this._create(i))})}onPointerDown(e,t){return oe(e,Le.POINTER_DOWN,i=>{t(this._create(i),i.pointerId)})}onPointerLeave(e,t){return oe(e,Le.POINTER_LEAVE,i=>{t(this._create(i))})}onPointerMove(e,t){return oe(e,"pointermove",i=>t(this._create(i)))}}class eHe extends te{constructor(e){super(),this._editorViewDomNode=e,this._globalPointerMoveMonitor=this._register(new pS),this._keydownListener=null}startMonitoring(e,t,i,n,r){this._keydownListener=yn(e.ownerDocument,"keydown",o=>{o.toKeyCodeChord().isModifierKey()||this._globalPointerMoveMonitor.stopMonitoring(!0,o.browserEvent)},!0),this._globalPointerMoveMonitor.startMonitoring(e,t,i,o=>{n(new Jm(o,!0,this._editorViewDomNode))},o=>{this._keydownListener.dispose(),r(o)})}stopMonitoring(){this._globalPointerMoveMonitor.stopMonitoring(!0)}}const aO=class aO{constructor(e){this._editor=e,this._instanceId=++aO._idPool,this._counter=0,this._rules=new Map,this._garbageCollectionScheduler=new xi(()=>this.garbageCollect(),1e3)}createClassNameRef(e){const t=this.getOrCreateRule(e);return t.increaseRefCount(),{className:t.className,dispose:()=>{t.decreaseRefCount(),this._garbageCollectionScheduler.schedule()}}}getOrCreateRule(e){const t=this.computeUniqueKey(e);let i=this._rules.get(t);if(!i){const n=this._counter++;i=new tHe(t,`dyn-rule-${this._instanceId}-${n}`,$2(this._editor.getContainerDomNode())?this._editor.getContainerDomNode():void 0,e),this._rules.set(t,i)}return i}computeUniqueKey(e){return JSON.stringify(e)}garbageCollect(){for(const e of this._rules.values())e.hasReferences()||(this._rules.delete(e.key),e.dispose())}};aO._idPool=0;let sP=aO;class tHe{constructor(e,t,i,n){this.key=e,this.className=t,this.properties=n,this._referenceCount=0,this._styleElementDisposables=new ce,this._styleElement=Rl(i,void 0,this._styleElementDisposables),this._styleElement.textContent=this.getCssText(this.className,this.properties)}getCssText(e,t){let i=`.${e} {`;for(const n in t){const r=t[n];let o;typeof r=="object"?o=Fe(r.id):o=r;const a=iHe(n);i+=`
	${a}: ${o};`}return i+=`
}`,i}dispose(){this._styleElementDisposables.dispose(),this._styleElement=void 0}increaseRefCount(){this._referenceCount++}decreaseRefCount(){this._referenceCount--}hasReferences(){return this._referenceCount>0}}function iHe(s){return s.replace(/(^[A-Z])/,([e])=>e.toLowerCase()).replace(/([A-Z])/g,([e])=>`-${e.toLowerCase()}`)}class uD extends te{constructor(){super(),this._shouldRender=!0}shouldRender(){return this._shouldRender}forceShouldRender(){this._shouldRender=!0}setShouldRender(){this._shouldRender=!0}onDidRender(){this._shouldRender=!1}onCompositionStart(e){return!1}onCompositionEnd(e){return!1}onConfigurationChanged(e){return!1}onCursorStateChanged(e){return!1}onDecorationsChanged(e){return!1}onFlushed(e){return!1}onFocusChanged(e){return!1}onLanguageConfigurationChanged(e){return!1}onLineMappingChanged(e){return!1}onLinesChanged(e){return!1}onLinesDeleted(e){return!1}onLinesInserted(e){return!1}onRevealRangeRequest(e){return!1}onScrollChanged(e){return!1}onThemeChanged(e){return!1}onTokensChanged(e){return!1}onTokensColorsChanged(e){return!1}onZonesChanged(e){return!1}handleEvents(e){let t=!1;for(let i=0,n=e.length;i<n;i++){const r=e[i];switch(r.type){case 0:this.onCompositionStart(r)&&(t=!0);break;case 1:this.onCompositionEnd(r)&&(t=!0);break;case 2:this.onConfigurationChanged(r)&&(t=!0);break;case 3:this.onCursorStateChanged(r)&&(t=!0);break;case 4:this.onDecorationsChanged(r)&&(t=!0);break;case 5:this.onFlushed(r)&&(t=!0);break;case 6:this.onFocusChanged(r)&&(t=!0);break;case 7:this.onLanguageConfigurationChanged(r)&&(t=!0);break;case 8:this.onLineMappingChanged(r)&&(t=!0);break;case 9:this.onLinesChanged(r)&&(t=!0);break;case 10:this.onLinesDeleted(r)&&(t=!0);break;case 11:this.onLinesInserted(r)&&(t=!0);break;case 12:this.onRevealRangeRequest(r)&&(t=!0);break;case 13:this.onScrollChanged(r)&&(t=!0);break;case 15:this.onTokensChanged(r)&&(t=!0);break;case 14:this.onThemeChanged(r)&&(t=!0);break;case 16:this.onTokensColorsChanged(r)&&(t=!0);break;case 17:this.onZonesChanged(r)&&(t=!0);break;default:console.info("View received unknown event: "),console.info(r)}}t&&(this._shouldRender=!0)}}class za extends uD{constructor(e){super(),this._context=e,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}}class mu{static write(e,t){e.setAttribute("data-mprt",String(t))}static read(e){const t=e.getAttribute("data-mprt");return t===null?0:parseInt(t,10)}static collect(e,t){const i=[];let n=0;for(;e&&e!==e.ownerDocument.body&&e!==t;)e.nodeType===e.ELEMENT_NODE&&(i[n++]=this.read(e)),e=e.parentElement;const r=new Uint8Array(n);for(let o=0;o<n;o++)r[o]=i[n-o-1];return r}}class nHe{constructor(e,t){this._restrictedRenderingContextBrand=void 0,this._viewLayout=e,this.viewportData=t,this.scrollWidth=this._viewLayout.getScrollWidth(),this.scrollHeight=this._viewLayout.getScrollHeight(),this.visibleRange=this.viewportData.visibleRange,this.bigNumbersDelta=this.viewportData.bigNumbersDelta;const i=this._viewLayout.getCurrentViewport();this.scrollTop=i.top,this.scrollLeft=i.left,this.viewportWidth=i.width,this.viewportHeight=i.height}getScrolledTopFromAbsoluteTop(e){return e-this.scrollTop}getVerticalOffsetForLineNumber(e,t){return this._viewLayout.getVerticalOffsetForLineNumber(e,t)}getVerticalOffsetAfterLineNumber(e,t){return this._viewLayout.getVerticalOffsetAfterLineNumber(e,t)}getDecorationsInViewport(){return this.viewportData.getDecorationsInViewport()}}class sHe extends nHe{constructor(e,t,i){super(e,t),this._renderingContextBrand=void 0,this._viewLines=i}linesVisibleRangesForRange(e,t){return this._viewLines.linesVisibleRangesForRange(e,t)}visibleRangeForPosition(e){return this._viewLines.visibleRangeForPosition(e)}}class rHe{constructor(e,t,i,n){this.outsideRenderedLine=e,this.lineNumber=t,this.ranges=i,this.continuesOnNextLine=n}}class t5{static from(e){const t=new Array(e.length);for(let i=0,n=e.length;i<n;i++){const r=e[i];t[i]=new t5(r.left,r.width)}return t}constructor(e,t){this._horizontalRangeBrand=void 0,this.left=Math.round(e),this.width=Math.round(t)}toString(){return`[${this.left},${this.width}]`}}class nv{constructor(e,t){this._floatHorizontalRangeBrand=void 0,this.left=e,this.width=t}toString(){return`[${this.left},${this.width}]`}static compare(e,t){return e.left-t.left}}class oHe{constructor(e,t){this.outsideRenderedLine=e,this.originalLeft=t,this.left=Math.round(this.originalLeft)}}class wse{constructor(e,t){this.outsideRenderedLine=e,this.ranges=t}}class zR{static _createRange(){return this._handyReadyRange||(this._handyReadyRange=document.createRange()),this._handyReadyRange}static _detachRange(e,t){e.selectNodeContents(t)}static _readClientRects(e,t,i,n,r){const o=this._createRange();try{return o.setStart(e,t),o.setEnd(i,n),o.getClientRects()}catch{return null}finally{this._detachRange(o,r)}}static _mergeAdjacentRanges(e){if(e.length===1)return e;e.sort(nv.compare);const t=[];let i=0,n=e[0];for(let r=1,o=e.length;r<o;r++){const a=e[r];n.left+n.width+.9>=a.left?n.width=Math.max(n.width,a.left+a.width-n.left):(t[i++]=n,n=a)}return t[i++]=n,t}static _createHorizontalRangesFromClientRects(e,t,i){if(!e||e.length===0)return null;const n=[];for(let r=0,o=e.length;r<o;r++){const a=e[r];n[r]=new nv(Math.max(0,(a.left-t)/i),a.width/i)}return this._mergeAdjacentRanges(n)}static readHorizontalRanges(e,t,i,n,r,o){const l=e.children.length-1;if(0>l)return null;if(t=Math.min(l,Math.max(0,t)),n=Math.min(l,Math.max(0,n)),t===n&&i===r&&i===0&&!e.children[t].firstChild){const h=e.children[t].getClientRects();return o.markDidDomLayout(),this._createHorizontalRangesFromClientRects(h,o.clientRectDeltaLeft,o.clientRectScale)}t!==n&&n>0&&r===0&&(n--,r=1073741824);let c=e.children[t].firstChild,d=e.children[n].firstChild;if((!c||!d)&&(!c&&i===0&&t>0&&(c=e.children[t-1].firstChild,i=1073741824),!d&&r===0&&n>0&&(d=e.children[n-1].firstChild,r=1073741824)),!c||!d)return null;i=Math.min(c.textContent.length,Math.max(0,i)),r=Math.min(d.textContent.length,Math.max(0,r));const u=this._readClientRects(c,i,d,r,o.endNode);return o.markDidDomLayout(),this._createHorizontalRangesFromClientRects(u,o.clientRectDeltaLeft,o.clientRectScale)}}const aHe=function(){return Th?!0:!(Lo||_c||jm)}();let Ty=!0;class Cse{constructor(e,t){this.themeType=t;const i=e.options,n=i.get(50);i.get(38)==="off"?this.renderWhitespace=i.get(100):this.renderWhitespace="none",this.renderControlCharacters=i.get(95),this.spaceWidth=n.spaceWidth,this.middotWidth=n.middotWidth,this.wsmiddotWidth=n.wsmiddotWidth,this.useMonospaceOptimizations=n.isMonospace&&!i.get(33),this.canUseHalfwidthRightwardsArrow=n.canUseHalfwidthRightwardsArrow,this.lineHeight=i.get(67),this.stopRenderingLineAfter=i.get(118),this.fontLigatures=i.get(51)}equals(e){return this.themeType===e.themeType&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineHeight===e.lineHeight&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.fontLigatures===e.fontLigatures}}const lO=class lO{constructor(e){this._options=e,this._isMaybeInvalid=!0,this._renderedViewLine=null}getDomNode(){return this._renderedViewLine&&this._renderedViewLine.domNode?this._renderedViewLine.domNode.domNode:null}setDomNode(e){if(this._renderedViewLine)this._renderedViewLine.domNode=gi(e);else throw new Error("I have no rendered view line to set the dom node to...")}onContentChanged(){this._isMaybeInvalid=!0}onTokensChanged(){this._isMaybeInvalid=!0}onDecorationsChanged(){this._isMaybeInvalid=!0}onOptionsChanged(e){this._isMaybeInvalid=!0,this._options=e}onSelectionChanged(){return su(this._options.themeType)||this._options.renderWhitespace==="selection"?(this._isMaybeInvalid=!0,!0):!1}renderLine(e,t,i,n,r){if(this._isMaybeInvalid===!1)return!1;this._isMaybeInvalid=!1;const o=n.getViewLineRenderingData(e),a=this._options,l=vo.filter(o.inlineDecorations,e,o.minColumn,o.maxColumn);let c=null;if(su(a.themeType)||this._options.renderWhitespace==="selection"){const g=n.selections;for(const p of g){if(p.endLineNumber<e||p.startLineNumber>e)continue;const _=p.startLineNumber===e?p.startColumn:o.minColumn,v=p.endLineNumber===e?p.endColumn:o.maxColumn;_<v&&(su(a.themeType)&&l.push(new vo(_,v,"inline-selected-text",0)),this._options.renderWhitespace==="selection"&&(c||(c=[]),c.push(new Ope(_-1,v-1))))}}const d=new w_(a.useMonospaceOptimizations,a.canUseHalfwidthRightwardsArrow,o.content,o.continuesWithWrappedLine,o.isBasicASCII,o.containsRTL,o.minColumn-1,o.tokens,l,o.tabSize,o.startVisibleColumn,a.spaceWidth,a.middotWidth,a.wsmiddotWidth,a.stopRenderingLineAfter,a.renderWhitespace,a.renderControlCharacters,a.fontLigatures!==Bm.OFF,c);if(this._renderedViewLine&&this._renderedViewLine.input.equals(d))return!1;r.appendString('<div style="top:'),r.appendString(String(t)),r.appendString("px;height:"),r.appendString(String(i)),r.appendString('px;" class="'),r.appendString(lO.CLASS_NAME),r.appendString('">');const u=dD(d,r);r.appendString("</div>");let h=null;return Ty&&aHe&&o.isBasicASCII&&a.useMonospaceOptimizations&&u.containsForeignElements===0&&(h=new DN(this._renderedViewLine?this._renderedViewLine.domNode:null,d,u.characterMapping)),h||(h=$pe(this._renderedViewLine?this._renderedViewLine.domNode:null,d,u.characterMapping,u.containsRTL,u.containsForeignElements)),this._renderedViewLine=h,!0}layoutLine(e,t,i){this._renderedViewLine&&this._renderedViewLine.domNode&&(this._renderedViewLine.domNode.setTop(t),this._renderedViewLine.domNode.setHeight(i))}getWidth(e){return this._renderedViewLine?this._renderedViewLine.getWidth(e):0}getWidthIsFast(){return this._renderedViewLine?this._renderedViewLine.getWidthIsFast():!0}needsMonospaceFontCheck(){return this._renderedViewLine?this._renderedViewLine instanceof DN:!1}monospaceAssumptionsAreValid(){return this._renderedViewLine&&this._renderedViewLine instanceof DN?this._renderedViewLine.monospaceAssumptionsAreValid():Ty}onMonospaceAssumptionsInvalidated(){this._renderedViewLine&&this._renderedViewLine instanceof DN&&(this._renderedViewLine=this._renderedViewLine.toSlowRenderedLine())}getVisibleRangesForRange(e,t,i,n){if(!this._renderedViewLine)return null;t=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,t)),i=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,i));const r=this._renderedViewLine.input.stopRenderingLineAfter;if(r!==-1&&t>r+1&&i>r+1)return new wse(!0,[new nv(this.getWidth(n),0)]);r!==-1&&t>r+1&&(t=r+1),r!==-1&&i>r+1&&(i=r+1);const o=this._renderedViewLine.getVisibleRangesForRange(e,t,i,n);return o&&o.length>0?new wse(!1,o):null}getColumnOfNodeOffset(e,t){return this._renderedViewLine?this._renderedViewLine.getColumnOfNodeOffset(e,t):1}};lO.CLASS_NAME="view-line";let Wf=lO;class DN{constructor(e,t,i){this._cachedWidth=-1,this.domNode=e,this.input=t;const n=Math.floor(t.lineContent.length/300);if(n>0){this._keyColumnPixelOffsetCache=new Float32Array(n);for(let r=0;r<n;r++)this._keyColumnPixelOffsetCache[r]=-1}else this._keyColumnPixelOffsetCache=null;this._characterMapping=i,this._charWidth=t.spaceWidth}getWidth(e){if(!this.domNode||this.input.lineContent.length<300){const t=this._characterMapping.getHorizontalOffset(this._characterMapping.length);return Math.round(this._charWidth*t)}return this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,e==null||e.markDidDomLayout()),this._cachedWidth}getWidthIsFast(){return this.input.lineContent.length<300||this._cachedWidth!==-1}monospaceAssumptionsAreValid(){if(!this.domNode)return Ty;if(this.input.lineContent.length<300){const e=this.getWidth(null),t=this.domNode.domNode.firstChild.offsetWidth;Math.abs(e-t)>=2&&(console.warn("monospace assumptions have been violated, therefore disabling monospace optimizations!"),Ty=!1)}return Ty}toSlowRenderedLine(){return $pe(this.domNode,this.input,this._characterMapping,!1,0)}getVisibleRangesForRange(e,t,i,n){const r=this._getColumnPixelOffset(e,t,n),o=this._getColumnPixelOffset(e,i,n);return[new nv(r,o-r)]}_getColumnPixelOffset(e,t,i){if(t<=300){const c=this._characterMapping.getHorizontalOffset(t);return this._charWidth*c}const n=Math.floor((t-1)/300)-1,r=(n+1)*300+1;let o=-1;if(this._keyColumnPixelOffsetCache&&(o=this._keyColumnPixelOffsetCache[n],o===-1&&(o=this._actualReadPixelOffset(e,r,i),this._keyColumnPixelOffsetCache[n]=o)),o===-1){const c=this._characterMapping.getHorizontalOffset(t);return this._charWidth*c}const a=this._characterMapping.getHorizontalOffset(r),l=this._characterMapping.getHorizontalOffset(t);return o+this._charWidth*(l-a)}_getReadingTarget(e){return e.domNode.firstChild}_actualReadPixelOffset(e,t,i){if(!this.domNode)return-1;const n=this._characterMapping.getDomPosition(t),r=zR.readHorizontalRanges(this._getReadingTarget(this.domNode),n.partIndex,n.charIndex,n.partIndex,n.charIndex,i);return!r||r.length===0?-1:r[0].left}getColumnOfNodeOffset(e,t){return yG(this._characterMapping,e,t)}}class jpe{constructor(e,t,i,n,r){if(this.domNode=e,this.input=t,this._characterMapping=i,this._isWhitespaceOnly=/^\s*$/.test(t.lineContent),this._containsForeignElements=r,this._cachedWidth=-1,this._pixelOffsetCache=null,!n||this._characterMapping.length===0){this._pixelOffsetCache=new Float32Array(Math.max(2,this._characterMapping.length+1));for(let o=0,a=this._characterMapping.length;o<=a;o++)this._pixelOffsetCache[o]=-1}}_getReadingTarget(e){return e.domNode.firstChild}getWidth(e){return this.domNode?(this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,e==null||e.markDidDomLayout()),this._cachedWidth):0}getWidthIsFast(){return this._cachedWidth!==-1}getVisibleRangesForRange(e,t,i,n){if(!this.domNode)return null;if(this._pixelOffsetCache!==null){const r=this._readPixelOffset(this.domNode,e,t,n);if(r===-1)return null;const o=this._readPixelOffset(this.domNode,e,i,n);return o===-1?null:[new nv(r,o-r)]}return this._readVisibleRangesForRange(this.domNode,e,t,i,n)}_readVisibleRangesForRange(e,t,i,n,r){if(i===n){const o=this._readPixelOffset(e,t,i,r);return o===-1?null:[new nv(o,0)]}else return this._readRawVisibleRangesForRange(e,i,n,r)}_readPixelOffset(e,t,i,n){if(this._characterMapping.length===0){if(this._containsForeignElements===0||this._containsForeignElements===2)return 0;if(this._containsForeignElements===1)return this.getWidth(n);const r=this._getReadingTarget(e);return r.firstChild?(n.markDidDomLayout(),r.firstChild.offsetWidth):0}if(this._pixelOffsetCache!==null){const r=this._pixelOffsetCache[i];if(r!==-1)return r;const o=this._actualReadPixelOffset(e,t,i,n);return this._pixelOffsetCache[i]=o,o}return this._actualReadPixelOffset(e,t,i,n)}_actualReadPixelOffset(e,t,i,n){if(this._characterMapping.length===0){const l=zR.readHorizontalRanges(this._getReadingTarget(e),0,0,0,0,n);return!l||l.length===0?-1:l[0].left}if(i===this._characterMapping.length&&this._isWhitespaceOnly&&this._containsForeignElements===0)return this.getWidth(n);const r=this._characterMapping.getDomPosition(i),o=zR.readHorizontalRanges(this._getReadingTarget(e),r.partIndex,r.charIndex,r.partIndex,r.charIndex,n);if(!o||o.length===0)return-1;const a=o[0].left;if(this.input.isBasicASCII){const l=this._characterMapping.getHorizontalOffset(i),c=Math.round(this.input.spaceWidth*l);if(Math.abs(c-a)<=1)return c}return a}_readRawVisibleRangesForRange(e,t,i,n){if(t===1&&i===this._characterMapping.length)return[new nv(0,this.getWidth(n))];const r=this._characterMapping.getDomPosition(t),o=this._characterMapping.getDomPosition(i);return zR.readHorizontalRanges(this._getReadingTarget(e),r.partIndex,r.charIndex,o.partIndex,o.charIndex,n)}getColumnOfNodeOffset(e,t){return yG(this._characterMapping,e,t)}}class lHe extends jpe{_readVisibleRangesForRange(e,t,i,n,r){const o=super._readVisibleRangesForRange(e,t,i,n,r);if(!o||o.length===0||i===n||i===1&&n===this._characterMapping.length)return o;if(!this.input.containsRTL){const a=this._readPixelOffset(e,t,n,r);if(a!==-1){const l=o[o.length-1];l.left<a&&(l.width=a-l.left)}}return o}}const $pe=function(){return Z4?cHe:dHe}();function cHe(s,e,t,i,n){return new lHe(s,e,t,i,n)}function dHe(s,e,t,i,n){return new jpe(s,e,t,i,n)}function yG(s,e,t){const i=e.textContent.length;let n=-1;for(;e;)e=e.previousSibling,n++;return s.getColumn(new Fpe(n,t),i)}class WI{static whitespaceVisibleColumn(e,t,i){const n=e.length;let r=0,o=-1,a=-1;for(let l=0;l<n;l++){if(l===t)return[o,a,r];switch(r%i===0&&(o=l,a=r),e.charCodeAt(l)){case 32:r+=1;break;case 9:r=hs.nextRenderTabStop(r,i);break;default:return[-1,-1,-1]}}return t===n?[o,a,r]:[-1,-1,-1]}static atomicPosition(e,t,i,n){const r=e.length,[o,a,l]=WI.whitespaceVisibleColumn(e,t,i);if(l===-1)return-1;let c;switch(n){case 0:c=!0;break;case 1:c=!1;break;case 2:if(l%i===0)return t;c=l%i<=i/2;break}if(c){if(o===-1)return-1;let h=a;for(let g=o;g<r;++g){if(h===a+i)return o;switch(e.charCodeAt(g)){case 32:h+=1;break;case 9:h=hs.nextRenderTabStop(h,i);break;default:return-1}}return h===a+i?o:-1}const d=hs.nextRenderTabStop(l,i);let u=l;for(let h=t;h<r;h++){if(u===d)return h;switch(e.charCodeAt(h)){case 32:u+=1;break;case 9:u=hs.nextRenderTabStop(u,i);break;default:return-1}}return u===d?r:-1}}class wp{constructor(e=null){this.hitTarget=e,this.type=0}}class qpe{get hitTarget(){return this.spanNode}constructor(e,t,i){this.position=e,this.spanNode=t,this.injectedText=i,this.type=1}}var Lb;(function(s){function e(t,i,n){const r=t.getPositionFromDOMInfo(i,n);return r?new qpe(r,i,null):new wp(i)}s.createFromDOMInfo=e})(Lb||(Lb={}));class uHe{constructor(e,t){this.lastViewCursorsRenderData=e,this.lastTextareaPosition=t}}class $r{static _deduceRage(e,t=null){return!t&&e?new F(e.lineNumber,e.column,e.lineNumber,e.column):t??null}static createUnknown(e,t,i){return{type:0,element:e,mouseColumn:t,position:i,range:this._deduceRage(i)}}static createTextarea(e,t){return{type:1,element:e,mouseColumn:t,position:null,range:null}}static createMargin(e,t,i,n,r,o){return{type:e,element:t,mouseColumn:i,position:n,range:r,detail:o}}static createViewZone(e,t,i,n,r){return{type:e,element:t,mouseColumn:i,position:n,range:this._deduceRage(n),detail:r}}static createContentText(e,t,i,n,r){return{type:6,element:e,mouseColumn:t,position:i,range:this._deduceRage(i,n),detail:r}}static createContentEmpty(e,t,i,n){return{type:7,element:e,mouseColumn:t,position:i,range:this._deduceRage(i),detail:n}}static createContentWidget(e,t,i){return{type:9,element:e,mouseColumn:t,position:null,range:null,detail:i}}static createScrollbar(e,t,i){return{type:11,element:e,mouseColumn:t,position:i,range:this._deduceRage(i)}}static createOverlayWidget(e,t,i){return{type:12,element:e,mouseColumn:t,position:null,range:null,detail:i}}static createOutsideEditor(e,t,i,n){return{type:13,element:null,mouseColumn:e,position:t,range:this._deduceRage(t),outsidePosition:i,outsideDistance:n}}static _typeToString(e){return e===1?"TEXTAREA":e===2?"GUTTER_GLYPH_MARGIN":e===3?"GUTTER_LINE_NUMBERS":e===4?"GUTTER_LINE_DECORATIONS":e===5?"GUTTER_VIEW_ZONE":e===6?"CONTENT_TEXT":e===7?"CONTENT_EMPTY":e===8?"CONTENT_VIEW_ZONE":e===9?"CONTENT_WIDGET":e===10?"OVERVIEW_RULER":e===11?"SCROLLBAR":e===12?"OVERLAY_WIDGET":"UNKNOWN"}static toString(e){return this._typeToString(e.type)+": "+e.position+" - "+e.range+" - "+JSON.stringify(e.detail)}}class lo{static isTextArea(e){return e.length===2&&e[0]===3&&e[1]===7}static isChildOfViewLines(e){return e.length>=4&&e[0]===3&&e[3]===8}static isStrictChildOfViewLines(e){return e.length>4&&e[0]===3&&e[3]===8}static isChildOfScrollableElement(e){return e.length>=2&&e[0]===3&&e[1]===6}static isChildOfMinimap(e){return e.length>=2&&e[0]===3&&e[1]===9}static isChildOfContentWidgets(e){return e.length>=4&&e[0]===3&&e[3]===1}static isChildOfOverflowGuard(e){return e.length>=1&&e[0]===3}static isChildOfOverflowingContentWidgets(e){return e.length>=1&&e[0]===2}static isChildOfOverlayWidgets(e){return e.length>=2&&e[0]===3&&e[1]===4}static isChildOfOverflowingOverlayWidgets(e){return e.length>=1&&e[0]===5}}class A1{constructor(e,t,i){this.viewModel=e.viewModel;const n=e.configuration.options;this.layoutInfo=n.get(146),this.viewDomNode=t.viewDomNode,this.lineHeight=n.get(67),this.stickyTabStops=n.get(117),this.typicalHalfwidthCharacterWidth=n.get(50).typicalHalfwidthCharacterWidth,this.lastRenderData=i,this._context=e,this._viewHelper=t}getZoneAtCoord(e){return A1.getZoneAtCoord(this._context,e)}static getZoneAtCoord(e,t){const i=e.viewLayout.getWhitespaceAtVerticalOffset(t);if(i){const n=i.verticalOffset+i.height/2,r=e.viewModel.getLineCount();let o=null,a,l=null;return i.afterLineNumber!==r&&(l=new X(i.afterLineNumber+1,1)),i.afterLineNumber>0&&(o=new X(i.afterLineNumber,e.viewModel.getLineMaxColumn(i.afterLineNumber))),l===null?a=o:o===null?a=l:t<n?a=o:a=l,{viewZoneId:i.id,afterLineNumber:i.afterLineNumber,positionBefore:o,positionAfter:l,position:a}}return null}getFullLineRangeAtCoord(e){if(this._context.viewLayout.isAfterLines(e)){const n=this._context.viewModel.getLineCount(),r=this._context.viewModel.getLineMaxColumn(n);return{range:new F(n,r,n,r),isAfterLines:!0}}const t=this._context.viewLayout.getLineNumberAtVerticalOffset(e),i=this._context.viewModel.getLineMaxColumn(t);return{range:new F(t,1,t,i),isAfterLines:!1}}getLineNumberAtVerticalOffset(e){return this._context.viewLayout.getLineNumberAtVerticalOffset(e)}isAfterLines(e){return this._context.viewLayout.isAfterLines(e)}isInTopPadding(e){return this._context.viewLayout.isInTopPadding(e)}isInBottomPadding(e){return this._context.viewLayout.isInBottomPadding(e)}getVerticalOffsetForLineNumber(e){return this._context.viewLayout.getVerticalOffsetForLineNumber(e)}findAttribute(e,t){return A1._findAttribute(e,t,this._viewHelper.viewDomNode)}static _findAttribute(e,t,i){for(;e&&e!==e.ownerDocument.body;){if(e.hasAttribute&&e.hasAttribute(t))return e.getAttribute(t);if(e===i)return null;e=e.parentNode}return null}getLineWidth(e){return this._viewHelper.getLineWidth(e)}visibleRangeForPosition(e,t){return this._viewHelper.visibleRangeForPosition(e,t)}getPositionFromDOMInfo(e,t){return this._viewHelper.getPositionFromDOMInfo(e,t)}getCurrentScrollTop(){return this._context.viewLayout.getCurrentScrollTop()}getCurrentScrollLeft(){return this._context.viewLayout.getCurrentScrollLeft()}}class hHe{constructor(e,t,i,n){this.editorPos=t,this.pos=i,this.relativePos=n,this.mouseVerticalOffset=Math.max(0,e.getCurrentScrollTop()+this.relativePos.y),this.mouseContentHorizontalOffset=e.getCurrentScrollLeft()+this.relativePos.x-e.layoutInfo.contentLeft,this.isInMarginArea=this.relativePos.x<e.layoutInfo.contentLeft&&this.relativePos.x>=e.layoutInfo.glyphMarginLeft,this.isInContentArea=!this.isInMarginArea,this.mouseColumn=Math.max(0,Ur._getMouseColumn(this.mouseContentHorizontalOffset,e.typicalHalfwidthCharacterWidth))}}class fHe extends hHe{get target(){return this._useHitTestTarget?this.hitTestResult.value.hitTarget:this._eventTarget}get targetPath(){return this._targetPathCacheElement!==this.target&&(this._targetPathCacheElement=this.target,this._targetPathCacheValue=mu.collect(this.target,this._ctx.viewDomNode)),this._targetPathCacheValue}constructor(e,t,i,n,r){super(e,t,i,n),this.hitTestResult=new uu(()=>Ur.doHitTest(this._ctx,this)),this._targetPathCacheElement=null,this._targetPathCacheValue=new Uint8Array(0),this._ctx=e,this._eventTarget=r;const o=!!this._eventTarget;this._useHitTestTarget=!o}toString(){return`pos(${this.pos.x},${this.pos.y}), editorPos(${this.editorPos.x},${this.editorPos.y}), relativePos(${this.relativePos.x},${this.relativePos.y}), mouseVerticalOffset: ${this.mouseVerticalOffset}, mouseContentHorizontalOffset: ${this.mouseContentHorizontalOffset}
	target: ${this.target?this.target.outerHTML:null}`}get wouldBenefitFromHitTestTargetSwitch(){return!this._useHitTestTarget&&this.hitTestResult.value.hitTarget!==null&&this.target!==this.hitTestResult.value.hitTarget}switchToHitTestTarget(){this._useHitTestTarget=!0}_getMouseColumn(e=null){return e&&e.column<this._ctx.viewModel.getLineMaxColumn(e.lineNumber)?hs.visibleColumnFromColumn(this._ctx.viewModel.getLineContent(e.lineNumber),e.column,this._ctx.viewModel.model.getOptions().tabSize)+1:this.mouseColumn}fulfillUnknown(e=null){return $r.createUnknown(this.target,this._getMouseColumn(e),e)}fulfillTextarea(){return $r.createTextarea(this.target,this._getMouseColumn())}fulfillMargin(e,t,i,n){return $r.createMargin(e,this.target,this._getMouseColumn(t),t,i,n)}fulfillViewZone(e,t,i){return $r.createViewZone(e,this.target,this._getMouseColumn(t),t,i)}fulfillContentText(e,t,i){return $r.createContentText(this.target,this._getMouseColumn(e),e,t,i)}fulfillContentEmpty(e,t){return $r.createContentEmpty(this.target,this._getMouseColumn(e),e,t)}fulfillContentWidget(e){return $r.createContentWidget(this.target,this._getMouseColumn(),e)}fulfillScrollbar(e){return $r.createScrollbar(this.target,this._getMouseColumn(e),e)}fulfillOverlayWidget(e){return $r.createOverlayWidget(this.target,this._getMouseColumn(),e)}}const yse={isAfterLines:!0};function nB(s){return{isAfterLines:!1,horizontalDistanceToText:s}}class Ur{constructor(e,t){this._context=e,this._viewHelper=t}mouseTargetIsWidget(e){const t=e.target,i=mu.collect(t,this._viewHelper.viewDomNode);return!!(lo.isChildOfContentWidgets(i)||lo.isChildOfOverflowingContentWidgets(i)||lo.isChildOfOverlayWidgets(i)||lo.isChildOfOverflowingOverlayWidgets(i))}createMouseTarget(e,t,i,n,r){const o=new A1(this._context,this._viewHelper,e),a=new fHe(o,t,i,n,r);try{const l=Ur._createMouseTarget(o,a);if(l.type===6&&o.stickyTabStops&&l.position!==null){const c=Ur._snapToSoftTabBoundary(l.position,o.viewModel),d=F.fromPositions(c,c).plusRange(l.range);return a.fulfillContentText(c,d,l.detail)}return l}catch{return a.fulfillUnknown()}}static _createMouseTarget(e,t){if(t.target===null)return t.fulfillUnknown();const i=t;let n=null;return!lo.isChildOfOverflowGuard(t.targetPath)&&!lo.isChildOfOverflowingContentWidgets(t.targetPath)&&!lo.isChildOfOverflowingOverlayWidgets(t.targetPath)&&(n=n||t.fulfillUnknown()),n=n||Ur._hitTestContentWidget(e,i),n=n||Ur._hitTestOverlayWidget(e,i),n=n||Ur._hitTestMinimap(e,i),n=n||Ur._hitTestScrollbarSlider(e,i),n=n||Ur._hitTestViewZone(e,i),n=n||Ur._hitTestMargin(e,i),n=n||Ur._hitTestViewCursor(e,i),n=n||Ur._hitTestTextArea(e,i),n=n||Ur._hitTestViewLines(e,i),n=n||Ur._hitTestScrollbar(e,i),n||t.fulfillUnknown()}static _hitTestContentWidget(e,t){if(lo.isChildOfContentWidgets(t.targetPath)||lo.isChildOfOverflowingContentWidgets(t.targetPath)){const i=e.findAttribute(t.target,"widgetId");return i?t.fulfillContentWidget(i):t.fulfillUnknown()}return null}static _hitTestOverlayWidget(e,t){if(lo.isChildOfOverlayWidgets(t.targetPath)||lo.isChildOfOverflowingOverlayWidgets(t.targetPath)){const i=e.findAttribute(t.target,"widgetId");return i?t.fulfillOverlayWidget(i):t.fulfillUnknown()}return null}static _hitTestViewCursor(e,t){if(t.target){const i=e.lastRenderData.lastViewCursorsRenderData;for(const n of i)if(t.target===n.domNode)return t.fulfillContentText(n.position,null,{mightBeForeignElement:!1,injectedText:null})}if(t.isInContentArea){const i=e.lastRenderData.lastViewCursorsRenderData,n=t.mouseContentHorizontalOffset,r=t.mouseVerticalOffset;for(const o of i){if(n<o.contentLeft||n>o.contentLeft+o.width)continue;const a=e.getVerticalOffsetForLineNumber(o.position.lineNumber);if(a<=r&&r<=a+o.height)return t.fulfillContentText(o.position,null,{mightBeForeignElement:!1,injectedText:null})}}return null}static _hitTestViewZone(e,t){const i=e.getZoneAtCoord(t.mouseVerticalOffset);if(i){const n=t.isInContentArea?8:5;return t.fulfillViewZone(n,i.position,i)}return null}static _hitTestTextArea(e,t){return lo.isTextArea(t.targetPath)?e.lastRenderData.lastTextareaPosition?t.fulfillContentText(e.lastRenderData.lastTextareaPosition,null,{mightBeForeignElement:!1,injectedText:null}):t.fulfillTextarea():null}static _hitTestMargin(e,t){if(t.isInMarginArea){const i=e.getFullLineRangeAtCoord(t.mouseVerticalOffset),n=i.range.getStartPosition();let r=Math.abs(t.relativePos.x);const o={isAfterLines:i.isAfterLines,glyphMarginLeft:e.layoutInfo.glyphMarginLeft,glyphMarginWidth:e.layoutInfo.glyphMarginWidth,lineNumbersWidth:e.layoutInfo.lineNumbersWidth,offsetX:r};if(r-=e.layoutInfo.glyphMarginLeft,r<=e.layoutInfo.glyphMarginWidth){const a=e.viewModel.coordinatesConverter.convertViewPositionToModelPosition(i.range.getStartPosition()),l=e.viewModel.glyphLanes.getLanesAtLine(a.lineNumber);return o.glyphMarginLane=l[Math.floor(r/e.lineHeight)],t.fulfillMargin(2,n,i.range,o)}return r-=e.layoutInfo.glyphMarginWidth,r<=e.layoutInfo.lineNumbersWidth?t.fulfillMargin(3,n,i.range,o):(r-=e.layoutInfo.lineNumbersWidth,t.fulfillMargin(4,n,i.range,o))}return null}static _hitTestViewLines(e,t){if(!lo.isChildOfViewLines(t.targetPath))return null;if(e.isInTopPadding(t.mouseVerticalOffset))return t.fulfillContentEmpty(new X(1,1),yse);if(e.isAfterLines(t.mouseVerticalOffset)||e.isInBottomPadding(t.mouseVerticalOffset)){const n=e.viewModel.getLineCount(),r=e.viewModel.getLineMaxColumn(n);return t.fulfillContentEmpty(new X(n,r),yse)}if(lo.isStrictChildOfViewLines(t.targetPath)){const n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset);if(e.viewModel.getLineLength(n)===0){const o=e.getLineWidth(n),a=nB(t.mouseContentHorizontalOffset-o);return t.fulfillContentEmpty(new X(n,1),a)}const r=e.getLineWidth(n);if(t.mouseContentHorizontalOffset>=r){const o=nB(t.mouseContentHorizontalOffset-r),a=new X(n,e.viewModel.getLineMaxColumn(n));return t.fulfillContentEmpty(a,o)}}const i=t.hitTestResult.value;return i.type===1?Ur.createMouseTargetFromHitTestPosition(e,t,i.spanNode,i.position,i.injectedText):t.wouldBenefitFromHitTestTargetSwitch?(t.switchToHitTestTarget(),this._createMouseTarget(e,t)):t.fulfillUnknown()}static _hitTestMinimap(e,t){if(lo.isChildOfMinimap(t.targetPath)){const i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),n=e.viewModel.getLineMaxColumn(i);return t.fulfillScrollbar(new X(i,n))}return null}static _hitTestScrollbarSlider(e,t){if(lo.isChildOfScrollableElement(t.targetPath)&&t.target&&t.target.nodeType===1){const i=t.target.className;if(i&&/\b(slider|scrollbar)\b/.test(i)){const n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),r=e.viewModel.getLineMaxColumn(n);return t.fulfillScrollbar(new X(n,r))}}return null}static _hitTestScrollbar(e,t){if(lo.isChildOfScrollableElement(t.targetPath)){const i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),n=e.viewModel.getLineMaxColumn(i);return t.fulfillScrollbar(new X(i,n))}return null}getMouseColumn(e){const t=this._context.configuration.options,i=t.get(146),n=this._context.viewLayout.getCurrentScrollLeft()+e.x-i.contentLeft;return Ur._getMouseColumn(n,t.get(50).typicalHalfwidthCharacterWidth)}static _getMouseColumn(e,t){return e<0?1:Math.round(e/t)+1}static createMouseTargetFromHitTestPosition(e,t,i,n,r){const o=n.lineNumber,a=n.column,l=e.getLineWidth(o);if(t.mouseContentHorizontalOffset>l){const C=nB(t.mouseContentHorizontalOffset-l);return t.fulfillContentEmpty(n,C)}const c=e.visibleRangeForPosition(o,a);if(!c)return t.fulfillUnknown(n);const d=c.left;if(Math.abs(t.mouseContentHorizontalOffset-d)<1)return t.fulfillContentText(n,null,{mightBeForeignElement:!!r,injectedText:r});const u=[];if(u.push({offset:c.left,column:a}),a>1){const C=e.visibleRangeForPosition(o,a-1);C&&u.push({offset:C.left,column:a-1})}const h=e.viewModel.getLineMaxColumn(o);if(a<h){const C=e.visibleRangeForPosition(o,a+1);C&&u.push({offset:C.left,column:a+1})}u.sort((C,y)=>C.offset-y.offset);const g=t.pos.toClientCoordinates(nt(e.viewDomNode)),p=i.getBoundingClientRect(),_=p.left<=g.clientX&&g.clientX<=p.right;let v=null;for(let C=1;C<u.length;C++){const y=u[C-1],x=u[C];if(y.offset<=t.mouseContentHorizontalOffset&&t.mouseContentHorizontalOffset<=x.offset){v=new F(o,y.column,o,x.column);const L=Math.abs(y.offset-t.mouseContentHorizontalOffset),I=Math.abs(x.offset-t.mouseContentHorizontalOffset);n=L<I?new X(o,y.column):new X(o,x.column);break}}return t.fulfillContentText(n,v,{mightBeForeignElement:!_||!!r,injectedText:r})}static _doHitTestWithCaretRangeFromPoint(e,t){const i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),n=e.getVerticalOffsetForLineNumber(i),r=n+e.lineHeight;if(!(i===e.viewModel.getLineCount()&&t.mouseVerticalOffset>r)){const a=Math.floor((n+r)/2);let l=t.pos.y+(a-t.mouseVerticalOffset);l<=t.editorPos.y&&(l=t.editorPos.y+1),l>=t.editorPos.y+t.editorPos.height&&(l=t.editorPos.y+t.editorPos.height-1);const c=new e5(t.pos.x,l),d=this._actualDoHitTestWithCaretRangeFromPoint(e,c.toClientCoordinates(nt(e.viewDomNode)));if(d.type===1)return d}return this._actualDoHitTestWithCaretRangeFromPoint(e,t.pos.toClientCoordinates(nt(e.viewDomNode)))}static _actualDoHitTestWithCaretRangeFromPoint(e,t){const i=uw(e.viewDomNode);let n;if(i?typeof i.caretRangeFromPoint>"u"?n=gHe(i,t.clientX,t.clientY):n=i.caretRangeFromPoint(t.clientX,t.clientY):n=e.viewDomNode.ownerDocument.caretRangeFromPoint(t.clientX,t.clientY),!n||!n.startContainer)return new wp;const r=n.startContainer;if(r.nodeType===r.TEXT_NODE){const o=r.parentNode,a=o?o.parentNode:null,l=a?a.parentNode:null;return(l&&l.nodeType===l.ELEMENT_NODE?l.className:null)===Wf.CLASS_NAME?Lb.createFromDOMInfo(e,o,n.startOffset):new wp(r.parentNode)}else if(r.nodeType===r.ELEMENT_NODE){const o=r.parentNode,a=o?o.parentNode:null;return(a&&a.nodeType===a.ELEMENT_NODE?a.className:null)===Wf.CLASS_NAME?Lb.createFromDOMInfo(e,r,r.textContent.length):new wp(r)}return new wp}static _doHitTestWithCaretPositionFromPoint(e,t){const i=e.viewDomNode.ownerDocument.caretPositionFromPoint(t.clientX,t.clientY);if(i.offsetNode.nodeType===i.offsetNode.TEXT_NODE){const n=i.offsetNode.parentNode,r=n?n.parentNode:null,o=r?r.parentNode:null;return(o&&o.nodeType===o.ELEMENT_NODE?o.className:null)===Wf.CLASS_NAME?Lb.createFromDOMInfo(e,i.offsetNode.parentNode,i.offset):new wp(i.offsetNode.parentNode)}if(i.offsetNode.nodeType===i.offsetNode.ELEMENT_NODE){const n=i.offsetNode.parentNode,r=n&&n.nodeType===n.ELEMENT_NODE?n.className:null,o=n?n.parentNode:null,a=o&&o.nodeType===o.ELEMENT_NODE?o.className:null;if(r===Wf.CLASS_NAME){const l=i.offsetNode.childNodes[Math.min(i.offset,i.offsetNode.childNodes.length-1)];if(l)return Lb.createFromDOMInfo(e,l,0)}else if(a===Wf.CLASS_NAME)return Lb.createFromDOMInfo(e,i.offsetNode,0)}return new wp(i.offsetNode)}static _snapToSoftTabBoundary(e,t){const i=t.getLineContent(e.lineNumber),{tabSize:n}=t.model.getOptions(),r=WI.atomicPosition(i,e.column-1,n,2);return r!==-1?new X(e.lineNumber,r+1):e}static doHitTest(e,t){let i=new wp;if(typeof e.viewDomNode.ownerDocument.caretRangeFromPoint=="function"?i=this._doHitTestWithCaretRangeFromPoint(e,t):e.viewDomNode.ownerDocument.caretPositionFromPoint&&(i=this._doHitTestWithCaretPositionFromPoint(e,t.pos.toClientCoordinates(nt(e.viewDomNode)))),i.type===1){const n=e.viewModel.getInjectedTextAt(i.position),r=e.viewModel.normalizePosition(i.position,2);(n||!r.equals(i.position))&&(i=new qpe(r,i.spanNode,n))}return i}}function gHe(s,e,t){const i=document.createRange();let n=s.elementFromPoint(e,t);if(n!==null){for(;n&&n.firstChild&&n.firstChild.nodeType!==n.firstChild.TEXT_NODE&&n.lastChild&&n.lastChild.firstChild;)n=n.lastChild;const r=n.getBoundingClientRect(),o=nt(n),a=o.getComputedStyle(n,null).getPropertyValue("font-style"),l=o.getComputedStyle(n,null).getPropertyValue("font-variant"),c=o.getComputedStyle(n,null).getPropertyValue("font-weight"),d=o.getComputedStyle(n,null).getPropertyValue("font-size"),u=o.getComputedStyle(n,null).getPropertyValue("line-height"),h=o.getComputedStyle(n,null).getPropertyValue("font-family"),g=`${a} ${l} ${c} ${d}/${u} ${h}`,p=n.innerText;let _=r.left,v=0,C;if(e>r.left+r.width)v=p.length;else{const y=kH.getInstance();for(let x=0;x<p.length+1;x++){if(C=y.getCharWidth(p.charAt(x),g)/2,_+=C,e<_){v=x;break}_+=C}}i.setStart(n.firstChild,v),i.setEnd(n.firstChild,v)}return i}const Rb=class Rb{static getInstance(){return Rb._INSTANCE||(Rb._INSTANCE=new Rb),Rb._INSTANCE}constructor(){this._cache={},this._canvas=document.createElement("canvas")}getCharWidth(e,t){const i=e+t;if(this._cache[i])return this._cache[i];const n=this._canvas.getContext("2d");n.font=t;const o=n.measureText(e).width;return this._cache[i]=o,o}};Rb._INSTANCE=null;let kH=Rb;class SG extends uD{constructor(e,t,i){super(),this._mouseLeaveMonitor=null,this._context=e,this.viewController=t,this.viewHelper=i,this.mouseTargetFactory=new Ur(this._context,i),this._mouseDownOperation=this._register(new pHe(this._context,this.viewController,this.viewHelper,this.mouseTargetFactory,(o,a)=>this._createMouseTarget(o,a),o=>this._getMouseColumn(o))),this.lastMouseLeaveTime=-1,this._height=this._context.configuration.options.get(146).height;const n=new Z8e(this.viewHelper.viewDomNode);this._register(n.onContextMenu(this.viewHelper.viewDomNode,o=>this._onContextMenu(o,!0))),this._register(n.onMouseMove(this.viewHelper.viewDomNode,o=>{this._onMouseMove(o),this._mouseLeaveMonitor||(this._mouseLeaveMonitor=oe(this.viewHelper.viewDomNode.ownerDocument,"mousemove",a=>{this.viewHelper.viewDomNode.contains(a.target)||this._onMouseLeave(new Jm(a,!1,this.viewHelper.viewDomNode))}))})),this._register(n.onMouseUp(this.viewHelper.viewDomNode,o=>this._onMouseUp(o))),this._register(n.onMouseLeave(this.viewHelper.viewDomNode,o=>this._onMouseLeave(o)));let r=0;this._register(n.onPointerDown(this.viewHelper.viewDomNode,(o,a)=>{r=a})),this._register(oe(this.viewHelper.viewDomNode,Le.POINTER_UP,o=>{this._mouseDownOperation.onPointerUp()})),this._register(n.onMouseDown(this.viewHelper.viewDomNode,o=>this._onMouseDown(o,r))),this._setupMouseWheelZoomListener(),this._context.addEventHandler(this)}_setupMouseWheelZoomListener(){const e=uA.INSTANCE;let t=0,i=oc.getZoomLevel(),n=!1,r=0;const o=l=>{if(this.viewController.emitMouseWheel(l),!this._context.configuration.options.get(76))return;const c=new dw(l);if(e.acceptStandardWheelEvent(c),e.isPhysicalMouseWheel()){if(a(l)){const d=oc.getZoomLevel(),u=c.deltaY>0?1:-1;oc.setZoomLevel(d+u),c.preventDefault(),c.stopPropagation()}}else Date.now()-t>50&&(i=oc.getZoomLevel(),n=a(l),r=0),t=Date.now(),r+=c.deltaY,n&&(oc.setZoomLevel(i+r/5),c.preventDefault(),c.stopPropagation())};this._register(oe(this.viewHelper.viewDomNode,Le.MOUSE_WHEEL,o,{capture:!0,passive:!1}));function a(l){return Wt?(l.metaKey||l.ctrlKey)&&!l.shiftKey&&!l.altKey:l.ctrlKey&&!l.metaKey&&!l.shiftKey&&!l.altKey}}dispose(){this._context.removeEventHandler(this),this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),super.dispose()}onConfigurationChanged(e){if(e.hasChanged(146)){const t=this._context.configuration.options.get(146).height;this._height!==t&&(this._height=t,this._mouseDownOperation.onHeightChanged())}return!1}onCursorStateChanged(e){return this._mouseDownOperation.onCursorStateChanged(e),!1}onFocusChanged(e){return!1}getTargetAtClientPoint(e,t){const n=new Upe(e,t).toPageCoordinates(nt(this.viewHelper.viewDomNode)),r=wG(this.viewHelper.viewDomNode);if(n.y<r.y||n.y>r.y+r.height||n.x<r.x||n.x>r.x+r.width)return null;const o=CG(this.viewHelper.viewDomNode,r,n);return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),r,n,o,null)}_createMouseTarget(e,t){let i=e.target;if(!this.viewHelper.viewDomNode.contains(i)){const n=uw(this.viewHelper.viewDomNode);n&&(i=n.elementsFromPoint(e.posx,e.posy).find(r=>this.viewHelper.viewDomNode.contains(r)))}return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),e.editorPos,e.pos,e.relativePos,t?i:null)}_getMouseColumn(e){return this.mouseTargetFactory.getMouseColumn(e.relativePos)}_onContextMenu(e,t){this.viewController.emitContextMenu({event:e,target:this._createMouseTarget(e,t)})}_onMouseMove(e){this.mouseTargetFactory.mouseTargetIsWidget(e)||e.preventDefault(),!(this._mouseDownOperation.isActive()||e.timestamp<this.lastMouseLeaveTime)&&this.viewController.emitMouseMove({event:e,target:this._createMouseTarget(e,!0)})}_onMouseLeave(e){this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),this.lastMouseLeaveTime=new Date().getTime(),this.viewController.emitMouseLeave({event:e,target:null})}_onMouseUp(e){this.viewController.emitMouseUp({event:e,target:this._createMouseTarget(e,!0)})}_onMouseDown(e,t){const i=this._createMouseTarget(e,!0),n=i.type===6||i.type===7,r=i.type===2||i.type===3||i.type===4,o=i.type===3,a=this._context.configuration.options.get(110),l=i.type===8||i.type===5,c=i.type===9;let d=e.leftButton||e.middleButton;Wt&&e.leftButton&&e.ctrlKey&&(d=!1);const u=()=>{e.preventDefault(),this.viewHelper.focusTextArea()};if(d&&(n||o&&a))u(),this._mouseDownOperation.start(i.type,e,t);else if(r)e.preventDefault();else if(l){const h=i.detail;d&&this.viewHelper.shouldSuppressMouseDownOnViewZone(h.viewZoneId)&&(u(),this._mouseDownOperation.start(i.type,e,t),e.preventDefault())}else c&&this.viewHelper.shouldSuppressMouseDownOnWidget(i.detail)&&(u(),e.preventDefault());this.viewController.emitMouseDown({event:e,target:i})}}class pHe extends te{constructor(e,t,i,n,r,o){super(),this._context=e,this._viewController=t,this._viewHelper=i,this._mouseTargetFactory=n,this._createMouseTarget=r,this._getMouseColumn=o,this._mouseMoveMonitor=this._register(new eHe(this._viewHelper.viewDomNode)),this._topBottomDragScrolling=this._register(new mHe(this._context,this._viewHelper,this._mouseTargetFactory,(a,l,c)=>this._dispatchMouse(a,l,c))),this._mouseState=new IH,this._currentSelection=new Ue(1,1,1,1),this._isActive=!1,this._lastMouseEvent=null}dispose(){super.dispose()}isActive(){return this._isActive}_onMouseDownThenMove(e){this._lastMouseEvent=e,this._mouseState.setModifiers(e);const t=this._findMousePosition(e,!1);t&&(this._mouseState.isDragAndDrop?this._viewController.emitMouseDrag({event:e,target:t}):t.type===13&&(t.outsidePosition==="above"||t.outsidePosition==="below")?this._topBottomDragScrolling.start(t,e):(this._topBottomDragScrolling.stop(),this._dispatchMouse(t,!0,1)))}start(e,t,i){this._lastMouseEvent=t,this._mouseState.setStartedOnLineNumbers(e===3),this._mouseState.setStartButtons(t),this._mouseState.setModifiers(t);const n=this._findMousePosition(t,!0);if(!n||!n.position)return;this._mouseState.trySetCount(t.detail,n.position),t.detail=this._mouseState.count;const r=this._context.configuration.options;if(!r.get(92)&&r.get(35)&&!r.get(22)&&!this._mouseState.altKey&&t.detail<2&&!this._isActive&&!this._currentSelection.isEmpty()&&n.type===6&&n.position&&this._currentSelection.containsPosition(n.position)){this._mouseState.isDragAndDrop=!0,this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,i,t.buttons,o=>this._onMouseDownThenMove(o),o=>{const a=this._findMousePosition(this._lastMouseEvent,!1);Df(o)?this._viewController.emitMouseDropCanceled():this._viewController.emitMouseDrop({event:this._lastMouseEvent,target:a?this._createMouseTarget(this._lastMouseEvent,!0):null}),this._stop()});return}this._mouseState.isDragAndDrop=!1,this._dispatchMouse(n,t.shiftKey,1),this._isActive||(this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,i,t.buttons,o=>this._onMouseDownThenMove(o),()=>this._stop()))}_stop(){this._isActive=!1,this._topBottomDragScrolling.stop()}onHeightChanged(){this._mouseMoveMonitor.stopMonitoring()}onPointerUp(){this._mouseMoveMonitor.stopMonitoring()}onCursorStateChanged(e){this._currentSelection=e.selections[0]}_getPositionOutsideEditor(e){const t=e.editorPos,i=this._context.viewModel,n=this._context.viewLayout,r=this._getMouseColumn(e);if(e.posy<t.y){const a=t.y-e.posy,l=Math.max(n.getCurrentScrollTop()-a,0),c=A1.getZoneAtCoord(this._context,l);if(c){const u=this._helpPositionJumpOverViewZone(c);if(u)return $r.createOutsideEditor(r,u,"above",a)}const d=n.getLineNumberAtVerticalOffset(l);return $r.createOutsideEditor(r,new X(d,1),"above",a)}if(e.posy>t.y+t.height){const a=e.posy-t.y-t.height,l=n.getCurrentScrollTop()+e.relativePos.y,c=A1.getZoneAtCoord(this._context,l);if(c){const u=this._helpPositionJumpOverViewZone(c);if(u)return $r.createOutsideEditor(r,u,"below",a)}const d=n.getLineNumberAtVerticalOffset(l);return $r.createOutsideEditor(r,new X(d,i.getLineMaxColumn(d)),"below",a)}const o=n.getLineNumberAtVerticalOffset(n.getCurrentScrollTop()+e.relativePos.y);if(e.posx<t.x){const a=t.x-e.posx;return $r.createOutsideEditor(r,new X(o,1),"left",a)}if(e.posx>t.x+t.width){const a=e.posx-t.x-t.width;return $r.createOutsideEditor(r,new X(o,i.getLineMaxColumn(o)),"right",a)}return null}_findMousePosition(e,t){const i=this._getPositionOutsideEditor(e);if(i)return i;const n=this._createMouseTarget(e,t);if(!n.position)return null;if(n.type===8||n.type===5){const o=this._helpPositionJumpOverViewZone(n.detail);if(o)return $r.createViewZone(n.type,n.element,n.mouseColumn,o,n.detail)}return n}_helpPositionJumpOverViewZone(e){const t=new X(this._currentSelection.selectionStartLineNumber,this._currentSelection.selectionStartColumn),i=e.positionBefore,n=e.positionAfter;return i&&n?i.isBefore(t)?i:n:null}_dispatchMouse(e,t,i){e.position&&this._viewController.dispatchMouse({position:e.position,mouseColumn:e.mouseColumn,startedOnLineNumbers:this._mouseState.startedOnLineNumbers,revealType:i,inSelectionMode:t,mouseDownCount:this._mouseState.count,altKey:this._mouseState.altKey,ctrlKey:this._mouseState.ctrlKey,metaKey:this._mouseState.metaKey,shiftKey:this._mouseState.shiftKey,leftButton:this._mouseState.leftButton,middleButton:this._mouseState.middleButton,onInjectedText:e.type===6&&e.detail.injectedText!==null})}}class mHe extends te{constructor(e,t,i,n){super(),this._context=e,this._viewHelper=t,this._mouseTargetFactory=i,this._dispatchMouse=n,this._operation=null}dispose(){super.dispose(),this.stop()}start(e,t){this._operation?this._operation.setPosition(e,t):this._operation=new _He(this._context,this._viewHelper,this._mouseTargetFactory,this._dispatchMouse,e,t)}stop(){this._operation&&(this._operation.dispose(),this._operation=null)}}class _He extends te{constructor(e,t,i,n,r,o){super(),this._context=e,this._viewHelper=t,this._mouseTargetFactory=i,this._dispatchMouse=n,this._position=r,this._mouseEvent=o,this._lastTime=Date.now(),this._animationFrameDisposable=Fa(nt(o.browserEvent),()=>this._execute())}dispose(){this._animationFrameDisposable.dispose(),super.dispose()}setPosition(e,t){this._position=e,this._mouseEvent=t}_tick(){const e=Date.now(),t=e-this._lastTime;return this._lastTime=e,t}_getScrollSpeed(){const e=this._context.configuration.options.get(67),t=this._context.configuration.options.get(146).height/e,i=this._position.outsideDistance/e;return i<=1.5?Math.max(30,t*(1+i)):i<=3?Math.max(60,t*(2+i)):Math.max(200,t*(7+i))}_execute(){const e=this._context.configuration.options.get(67),t=this._getScrollSpeed(),i=this._tick(),n=t*(i/1e3)*e,r=this._position.outsidePosition==="above"?-n:n;this._context.viewModel.viewLayout.deltaScrollNow(0,r),this._viewHelper.renderNow();const o=this._context.viewLayout.getLinesViewportData(),a=this._position.outsidePosition==="above"?o.startLineNumber:o.endLineNumber;let l;{const c=wG(this._viewHelper.viewDomNode),d=this._context.configuration.options.get(146).horizontalScrollbarHeight,u=new e5(this._mouseEvent.pos.x,c.y+c.height-d-.1),h=CG(this._viewHelper.viewDomNode,c,u);l=this._mouseTargetFactory.createMouseTarget(this._viewHelper.getLastRenderData(),c,u,h,null)}(!l.position||l.position.lineNumber!==a)&&(this._position.outsidePosition==="above"?l=$r.createOutsideEditor(this._position.mouseColumn,new X(a,1),"above",this._position.outsideDistance):l=$r.createOutsideEditor(this._position.mouseColumn,new X(a,this._context.viewModel.getLineMaxColumn(a)),"below",this._position.outsideDistance)),this._dispatchMouse(l,!0,2),this._animationFrameDisposable=Fa(nt(l.element),()=>this._execute())}}const cO=class cO{get altKey(){return this._altKey}get ctrlKey(){return this._ctrlKey}get metaKey(){return this._metaKey}get shiftKey(){return this._shiftKey}get leftButton(){return this._leftButton}get middleButton(){return this._middleButton}get startedOnLineNumbers(){return this._startedOnLineNumbers}constructor(){this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._leftButton=!1,this._middleButton=!1,this._startedOnLineNumbers=!1,this._lastMouseDownPosition=null,this._lastMouseDownPositionEqualCount=0,this._lastMouseDownCount=0,this._lastSetMouseDownCountTime=0,this.isDragAndDrop=!1}get count(){return this._lastMouseDownCount}setModifiers(e){this._altKey=e.altKey,this._ctrlKey=e.ctrlKey,this._metaKey=e.metaKey,this._shiftKey=e.shiftKey}setStartButtons(e){this._leftButton=e.leftButton,this._middleButton=e.middleButton}setStartedOnLineNumbers(e){this._startedOnLineNumbers=e}trySetCount(e,t){const i=new Date().getTime();i-this._lastSetMouseDownCountTime>cO.CLEAR_MOUSE_DOWN_COUNT_TIME&&(e=1),this._lastSetMouseDownCountTime=i,e>this._lastMouseDownCount+1&&(e=this._lastMouseDownCount+1),this._lastMouseDownPosition&&this._lastMouseDownPosition.equals(t)?this._lastMouseDownPositionEqualCount++:this._lastMouseDownPositionEqualCount=1,this._lastMouseDownPosition=t,this._lastMouseDownCount=Math.min(e,this._lastMouseDownPositionEqualCount)}};cO.CLEAR_MOUSE_DOWN_COUNT_TIME=400;let IH=cO;const ty=class ty{constructor(e,t,i,n,r){this.value=e,this.selectionStart=t,this.selectionEnd=i,this.selection=n,this.newlineCountBeforeSelection=r}toString(){return`[ <${this.value}>, selectionStart: ${this.selectionStart}, selectionEnd: ${this.selectionEnd}]`}static readFromTextArea(e,t){const i=e.getValue(),n=e.getSelectionStart(),r=e.getSelectionEnd();let o;if(t){const a=i.substring(0,n),l=t.value.substring(0,t.selectionStart);a===l&&(o=t.newlineCountBeforeSelection)}return new ty(i,n,r,null,o)}collapseSelection(){return this.selectionStart===this.value.length?this:new ty(this.value,this.value.length,this.value.length,null,void 0)}writeToTextArea(e,t,i){t.setValue(e,this.value),i&&t.setSelectionRange(e,this.selectionStart,this.selectionEnd)}deduceEditorPosition(e){var n,r,o,a;if(e<=this.selectionStart){const l=this.value.substring(e,this.selectionStart);return this._finishDeduceEditorPosition(((n=this.selection)==null?void 0:n.getStartPosition())??null,l,-1)}if(e>=this.selectionEnd){const l=this.value.substring(this.selectionEnd,e);return this._finishDeduceEditorPosition(((r=this.selection)==null?void 0:r.getEndPosition())??null,l,1)}const t=this.value.substring(this.selectionStart,e);if(t.indexOf("…")===-1)return this._finishDeduceEditorPosition(((o=this.selection)==null?void 0:o.getStartPosition())??null,t,1);const i=this.value.substring(e,this.selectionEnd);return this._finishDeduceEditorPosition(((a=this.selection)==null?void 0:a.getEndPosition())??null,i,-1)}_finishDeduceEditorPosition(e,t,i){let n=0,r=-1;for(;(r=t.indexOf(`
`,r+1))!==-1;)n++;return[e,i*t.length,n]}static deduceInput(e,t,i){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};const n=Math.min(zm(e.value,t.value),e.selectionStart,t.selectionStart),r=Math.min(B2(e.value,t.value),e.value.length-e.selectionEnd,t.value.length-t.selectionEnd);e.value.substring(n,e.value.length-r);const o=t.value.substring(n,t.value.length-r),a=e.selectionStart-n,l=e.selectionEnd-n,c=t.selectionStart-n,d=t.selectionEnd-n;if(c===d){const h=e.selectionStart-n;return{text:o,replacePrevCharCnt:h,replaceNextCharCnt:0,positionDelta:0}}const u=l-a;return{text:o,replacePrevCharCnt:u,replaceNextCharCnt:0,positionDelta:0}}static deduceAndroidCompositionInput(e,t){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};if(e.value===t.value)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:t.selectionEnd-e.selectionEnd};const i=Math.min(zm(e.value,t.value),e.selectionEnd),n=Math.min(B2(e.value,t.value),e.value.length-e.selectionEnd),r=e.value.substring(i,e.value.length-n),o=t.value.substring(i,t.value.length-n);e.selectionStart-i;const a=e.selectionEnd-i;t.selectionStart-i;const l=t.selectionEnd-i;return{text:o,replacePrevCharCnt:a,replaceNextCharCnt:r.length-a,positionDelta:l-o.length}}};ty.EMPTY=new ty("",0,0,null,void 0);let qr=ty;class PC{static _getPageOfLine(e,t){return Math.floor((e-1)/t)}static _getRangeForPage(e,t){const i=e*t,n=i+1,r=i+t;return new F(n,1,r+1,1)}static fromEditorSelection(e,t,i,n){const o=PC._getPageOfLine(t.startLineNumber,i),a=PC._getRangeForPage(o,i),l=PC._getPageOfLine(t.endLineNumber,i),c=PC._getRangeForPage(l,i);let d=a.intersectRanges(new F(1,1,t.startLineNumber,t.startColumn));if(n&&e.getValueLengthInRange(d,1)>500){const C=e.modifyPosition(d.getEndPosition(),-500);d=F.fromPositions(C,d.getEndPosition())}const u=e.getValueInRange(d,1),h=e.getLineCount(),g=e.getLineMaxColumn(h);let p=c.intersectRanges(new F(t.endLineNumber,t.endColumn,h,g));if(n&&e.getValueLengthInRange(p,1)>500){const C=e.modifyPosition(p.getStartPosition(),500);p=F.fromPositions(p.getStartPosition(),C)}const _=e.getValueInRange(p,1);let v;if(o===l||o+1===l)v=e.getValueInRange(t,1);else{const C=a.intersectRanges(t),y=c.intersectRanges(t);v=e.getValueInRange(C,1)+"…"+e.getValueInRange(y,1)}return n&&v.length>2*500&&(v=v.substring(0,500)+"…"+v.substring(v.length-500,v.length)),new qr(u+v+_,u.length,u.length+v.length,t,d.endLineNumber-d.startLineNumber)}}var bHe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Sse=function(s,e){return function(t,i){e(t,i,s)}},rP;(function(s){s.Tap="-monaco-textarea-synthetic-tap"})(rP||(rP={}));const EH={forceCopyWithSyntaxHighlighting:!1},dO=class dO{constructor(){this._lastState=null}set(e,t){this._lastState={lastCopiedValue:e,data:t}}get(e){return this._lastState&&this._lastState.lastCopiedValue===e?this._lastState.data:(this._lastState=null,null)}};dO.INSTANCE=new dO;let HI=dO;class vHe{constructor(){this._lastTypeTextLength=0}handleCompositionUpdate(e){e=e||"";const t={text:e,replacePrevCharCnt:this._lastTypeTextLength,replaceNextCharCnt:0,positionDelta:0};return this._lastTypeTextLength=e.length,t}}let DH=class extends te{get textAreaState(){return this._textAreaState}constructor(e,t,i,n,r,o){super(),this._host=e,this._textArea=t,this._OS=i,this._browser=n,this._accessibilityService=r,this._logService=o,this._onFocus=this._register(new Z),this.onFocus=this._onFocus.event,this._onBlur=this._register(new Z),this.onBlur=this._onBlur.event,this._onKeyDown=this._register(new Z),this.onKeyDown=this._onKeyDown.event,this._onKeyUp=this._register(new Z),this.onKeyUp=this._onKeyUp.event,this._onCut=this._register(new Z),this.onCut=this._onCut.event,this._onPaste=this._register(new Z),this.onPaste=this._onPaste.event,this._onType=this._register(new Z),this.onType=this._onType.event,this._onCompositionStart=this._register(new Z),this.onCompositionStart=this._onCompositionStart.event,this._onCompositionUpdate=this._register(new Z),this.onCompositionUpdate=this._onCompositionUpdate.event,this._onCompositionEnd=this._register(new Z),this.onCompositionEnd=this._onCompositionEnd.event,this._onSelectionChangeRequest=this._register(new Z),this.onSelectionChangeRequest=this._onSelectionChangeRequest.event,this._asyncFocusGainWriteScreenReaderContent=this._register(new Es),this._asyncTriggerCut=this._register(new xi(()=>this._onCut.fire(),0)),this._textAreaState=qr.EMPTY,this._selectionChangeListener=null,this._accessibilityService.isScreenReaderOptimized()&&this.writeNativeTextAreaContent("ctor"),this._register(De.runAndSubscribe(this._accessibilityService.onDidChangeScreenReaderOptimized,()=>{this._accessibilityService.isScreenReaderOptimized()&&!this._asyncFocusGainWriteScreenReaderContent.value?this._asyncFocusGainWriteScreenReaderContent.value=this._register(new xi(()=>this.writeNativeTextAreaContent("asyncFocusGain"),0)):this._asyncFocusGainWriteScreenReaderContent.clear()})),this._hasFocus=!1,this._currentComposition=null;let a=null;this._register(this._textArea.onKeyDown(l=>{const c=new Mi(l);(c.keyCode===114||this._currentComposition&&c.keyCode===1)&&c.stopPropagation(),c.equals(9)&&c.preventDefault(),a=c,this._onKeyDown.fire(c)})),this._register(this._textArea.onKeyUp(l=>{const c=new Mi(l);this._onKeyUp.fire(c)})),this._register(this._textArea.onCompositionStart(l=>{const c=new vHe;if(this._currentComposition){this._currentComposition=c;return}if(this._currentComposition=c,this._OS===2&&a&&a.equals(114)&&this._textAreaState.selectionStart===this._textAreaState.selectionEnd&&this._textAreaState.selectionStart>0&&this._textAreaState.value.substr(this._textAreaState.selectionStart-1,1)===l.data&&(a.code==="ArrowRight"||a.code==="ArrowLeft")){c.handleCompositionUpdate("x"),this._onCompositionStart.fire({data:l.data});return}if(this._browser.isAndroid){this._onCompositionStart.fire({data:l.data});return}this._onCompositionStart.fire({data:l.data})})),this._register(this._textArea.onCompositionUpdate(l=>{const c=this._currentComposition;if(!c)return;if(this._browser.isAndroid){const u=qr.readFromTextArea(this._textArea,this._textAreaState),h=qr.deduceAndroidCompositionInput(this._textAreaState,u);this._textAreaState=u,this._onType.fire(h),this._onCompositionUpdate.fire(l);return}const d=c.handleCompositionUpdate(l.data);this._textAreaState=qr.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(d),this._onCompositionUpdate.fire(l)})),this._register(this._textArea.onCompositionEnd(l=>{const c=this._currentComposition;if(!c)return;if(this._currentComposition=null,this._browser.isAndroid){const u=qr.readFromTextArea(this._textArea,this._textAreaState),h=qr.deduceAndroidCompositionInput(this._textAreaState,u);this._textAreaState=u,this._onType.fire(h),this._onCompositionEnd.fire();return}const d=c.handleCompositionUpdate(l.data);this._textAreaState=qr.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(d),this._onCompositionEnd.fire()})),this._register(this._textArea.onInput(l=>{if(this._textArea.setIgnoreSelectionChangeTime("received input event"),this._currentComposition)return;const c=qr.readFromTextArea(this._textArea,this._textAreaState),d=qr.deduceInput(this._textAreaState,c,this._OS===2);d.replacePrevCharCnt===0&&d.text.length===1&&(ws(d.text.charCodeAt(0))||d.text.charCodeAt(0)===127)||(this._textAreaState=c,(d.text!==""||d.replacePrevCharCnt!==0||d.replaceNextCharCnt!==0||d.positionDelta!==0)&&this._onType.fire(d))})),this._register(this._textArea.onCut(l=>{this._textArea.setIgnoreSelectionChangeTime("received cut event"),this._ensureClipboardGetsEditorSelection(l),this._asyncTriggerCut.schedule()})),this._register(this._textArea.onCopy(l=>{this._ensureClipboardGetsEditorSelection(l)})),this._register(this._textArea.onPaste(l=>{if(this._textArea.setIgnoreSelectionChangeTime("received paste event"),l.preventDefault(),!l.clipboardData)return;let[c,d]=TH.getTextData(l.clipboardData);c&&(d=d||HI.INSTANCE.get(c),this._onPaste.fire({text:c,metadata:d}))})),this._register(this._textArea.onFocus(()=>{const l=this._hasFocus;this._setHasFocus(!0),this._accessibilityService.isScreenReaderOptimized()&&this._browser.isSafari&&!l&&this._hasFocus&&(this._asyncFocusGainWriteScreenReaderContent.value||(this._asyncFocusGainWriteScreenReaderContent.value=new xi(()=>this.writeNativeTextAreaContent("asyncFocusGain"),0)),this._asyncFocusGainWriteScreenReaderContent.value.schedule())})),this._register(this._textArea.onBlur(()=>{this._currentComposition&&(this._currentComposition=null,this.writeNativeTextAreaContent("blurWithoutCompositionEnd"),this._onCompositionEnd.fire()),this._setHasFocus(!1)})),this._register(this._textArea.onSyntheticTap(()=>{this._browser.isAndroid&&this._currentComposition&&(this._currentComposition=null,this.writeNativeTextAreaContent("tapWithoutCompositionEnd"),this._onCompositionEnd.fire())}))}_installSelectionChangeListener(){let e=0;return oe(this._textArea.ownerDocument,"selectionchange",t=>{if(Qp.onSelectionChange(),!this._hasFocus||this._currentComposition||!this._browser.isChrome)return;const i=Date.now(),n=i-e;if(e=i,n<5)return;const r=i-this._textArea.getIgnoreSelectionChangeTime();if(this._textArea.resetSelectionChangeTime(),r<100||!this._textAreaState.selection)return;const o=this._textArea.getValue();if(this._textAreaState.value!==o)return;const a=this._textArea.getSelectionStart(),l=this._textArea.getSelectionEnd();if(this._textAreaState.selectionStart===a&&this._textAreaState.selectionEnd===l)return;const c=this._textAreaState.deduceEditorPosition(a),d=this._host.deduceModelPosition(c[0],c[1],c[2]),u=this._textAreaState.deduceEditorPosition(l),h=this._host.deduceModelPosition(u[0],u[1],u[2]),g=new Ue(d.lineNumber,d.column,h.lineNumber,h.column);this._onSelectionChangeRequest.fire(g)})}dispose(){super.dispose(),this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null)}focusTextArea(){this._setHasFocus(!0),this.refreshFocusState()}isFocused(){return this._hasFocus}refreshFocusState(){this._setHasFocus(this._textArea.hasFocus())}_setHasFocus(e){this._hasFocus!==e&&(this._hasFocus=e,this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null),this._hasFocus&&(this._selectionChangeListener=this._installSelectionChangeListener()),this._hasFocus&&this.writeNativeTextAreaContent("focusgain"),this._hasFocus?this._onFocus.fire():this._onBlur.fire())}_setAndWriteTextAreaState(e,t){this._hasFocus||(t=t.collapseSelection()),t.writeToTextArea(e,this._textArea,this._hasFocus),this._textAreaState=t}writeNativeTextAreaContent(e){!this._accessibilityService.isScreenReaderOptimized()&&e==="render"||this._currentComposition||(this._logService.trace(`writeTextAreaState(reason: ${e})`),this._setAndWriteTextAreaState(e,this._host.getScreenReaderContent()))}_ensureClipboardGetsEditorSelection(e){const t=this._host.getDataToCopy(),i={version:1,isFromEmptySelection:t.isFromEmptySelection,multicursorText:t.multicursorText,mode:t.mode};HI.INSTANCE.set(this._browser.isFirefox?t.text.replace(/\r\n/g,`
`):t.text,i),e.preventDefault(),e.clipboardData&&TH.setTextData(e.clipboardData,t.text,t.html,i)}};DH=bHe([Sse(4,Wa),Sse(5,pr)],DH);const TH={getTextData(s){const e=s.getData(An.text);let t=null;const i=s.getData("vscode-editor-data");if(typeof i=="string")try{t=JSON.parse(i),t.version!==1&&(t=null)}catch{}return e.length===0&&t===null&&s.files.length>0?[Array.prototype.slice.call(s.files,0).map(r=>r.name).join(`
`),null]:[e,t]},setTextData(s,e,t,i){s.setData(An.text,e),typeof t=="string"&&s.setData("text/html",t),s.setData("vscode-editor-data",JSON.stringify(i))}};class wHe extends te{get ownerDocument(){return this._actual.ownerDocument}constructor(e){super(),this._actual=e,this.onKeyDown=this._register(new Ut(this._actual,"keydown")).event,this.onKeyUp=this._register(new Ut(this._actual,"keyup")).event,this.onCompositionStart=this._register(new Ut(this._actual,"compositionstart")).event,this.onCompositionUpdate=this._register(new Ut(this._actual,"compositionupdate")).event,this.onCompositionEnd=this._register(new Ut(this._actual,"compositionend")).event,this.onBeforeInput=this._register(new Ut(this._actual,"beforeinput")).event,this.onInput=this._register(new Ut(this._actual,"input")).event,this.onCut=this._register(new Ut(this._actual,"cut")).event,this.onCopy=this._register(new Ut(this._actual,"copy")).event,this.onPaste=this._register(new Ut(this._actual,"paste")).event,this.onFocus=this._register(new Ut(this._actual,"focus")).event,this.onBlur=this._register(new Ut(this._actual,"blur")).event,this._onSyntheticTap=this._register(new Z),this.onSyntheticTap=this._onSyntheticTap.event,this._ignoreSelectionChangeTime=0,this._register(this.onKeyDown(()=>Qp.onKeyDown())),this._register(this.onBeforeInput(()=>Qp.onBeforeInput())),this._register(this.onInput(()=>Qp.onInput())),this._register(this.onKeyUp(()=>Qp.onKeyUp())),this._register(oe(this._actual,rP.Tap,()=>this._onSyntheticTap.fire()))}hasFocus(){const e=uw(this._actual);return e?e.activeElement===this._actual:this._actual.isConnected?hr()===this._actual:!1}setIgnoreSelectionChangeTime(e){this._ignoreSelectionChangeTime=Date.now()}getIgnoreSelectionChangeTime(){return this._ignoreSelectionChangeTime}resetSelectionChangeTime(){this._ignoreSelectionChangeTime=0}getValue(){return this._actual.value}setValue(e,t){const i=this._actual;i.value!==t&&(this.setIgnoreSelectionChangeTime("setValue"),i.value=t)}getSelectionStart(){return this._actual.selectionDirection==="backward"?this._actual.selectionEnd:this._actual.selectionStart}getSelectionEnd(){return this._actual.selectionDirection==="backward"?this._actual.selectionStart:this._actual.selectionEnd}setSelectionRange(e,t,i){const n=this._actual;let r=null;const o=uw(n);o?r=o.activeElement:r=hr();const a=nt(r),l=r===n,c=n.selectionStart,d=n.selectionEnd;if(l&&c===t&&d===i){_c&&a.parent!==a&&n.focus();return}if(l){this.setIgnoreSelectionChangeTime("setSelectionRange"),n.setSelectionRange(t,i),_c&&a.parent!==a&&n.focus();return}try{const u=iAe(n);this.setIgnoreSelectionChangeTime("setSelectionRange"),n.focus(),n.setSelectionRange(t,i),nAe(n,u)}catch{}}}class CHe extends SG{constructor(e,t,i){super(e,t,i),this._register(Er.addTarget(this.viewHelper.linesContentDomNode)),this._register(oe(this.viewHelper.linesContentDomNode,Vi.Tap,r=>this.onTap(r))),this._register(oe(this.viewHelper.linesContentDomNode,Vi.Change,r=>this.onChange(r))),this._register(oe(this.viewHelper.linesContentDomNode,Vi.Contextmenu,r=>this._onContextMenu(new Jm(r,!1,this.viewHelper.viewDomNode),!1))),this._lastPointerType="mouse",this._register(oe(this.viewHelper.linesContentDomNode,"pointerdown",r=>{const o=r.pointerType;if(o==="mouse"){this._lastPointerType="mouse";return}else o==="touch"?this._lastPointerType="touch":this._lastPointerType="pen"}));const n=new J8e(this.viewHelper.viewDomNode);this._register(n.onPointerMove(this.viewHelper.viewDomNode,r=>this._onMouseMove(r))),this._register(n.onPointerUp(this.viewHelper.viewDomNode,r=>this._onMouseUp(r))),this._register(n.onPointerLeave(this.viewHelper.viewDomNode,r=>this._onMouseLeave(r))),this._register(n.onPointerDown(this.viewHelper.viewDomNode,(r,o)=>this._onMouseDown(r,o)))}onTap(e){!e.initialTarget||!this.viewHelper.linesContentDomNode.contains(e.initialTarget)||(e.preventDefault(),this.viewHelper.focusTextArea(),this._dispatchGesture(e,!1))}onChange(e){this._lastPointerType==="touch"&&this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX,-e.translationY),this._lastPointerType==="pen"&&this._dispatchGesture(e,!0)}_dispatchGesture(e,t){const i=this._createMouseTarget(new Jm(e,!1,this.viewHelper.viewDomNode),!1);i.position&&this.viewController.dispatchMouse({position:i.position,mouseColumn:i.position.column,startedOnLineNumbers:!1,revealType:1,mouseDownCount:e.tapCount,inSelectionMode:t,altKey:!1,ctrlKey:!1,metaKey:!1,shiftKey:!1,leftButton:!1,middleButton:!1,onInjectedText:i.type===6&&i.detail.injectedText!==null})}_onMouseDown(e,t){e.browserEvent.pointerType!=="touch"&&super._onMouseDown(e,t)}}class yHe extends SG{constructor(e,t,i){super(e,t,i),this._register(Er.addTarget(this.viewHelper.linesContentDomNode)),this._register(oe(this.viewHelper.linesContentDomNode,Vi.Tap,n=>this.onTap(n))),this._register(oe(this.viewHelper.linesContentDomNode,Vi.Change,n=>this.onChange(n))),this._register(oe(this.viewHelper.linesContentDomNode,Vi.Contextmenu,n=>this._onContextMenu(new Jm(n,!1,this.viewHelper.viewDomNode),!1)))}onTap(e){e.preventDefault(),this.viewHelper.focusTextArea();const t=this._createMouseTarget(new Jm(e,!1,this.viewHelper.viewDomNode),!1);if(t.position){const i=document.createEvent("CustomEvent");i.initEvent(rP.Tap,!1,!0),this.viewHelper.dispatchTextAreaEvent(i),this.viewController.moveTo(t.position,1)}}onChange(e){this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX,-e.translationY)}}class SHe extends te{constructor(e,t,i){super(),(du||QTe&&nue)&&Mq.pointerEvents?this.handler=this._register(new CHe(e,t,i)):Ri.TouchEvent?this.handler=this._register(new yHe(e,t,i)):this.handler=this._register(new SG(e,t,i))}getTargetAtClientPoint(e,t){return this.handler.getTargetAtClientPoint(e,t)}}class Jw extends uD{}const uO=class uO extends Jw{constructor(e){super(),this._context=e,this._readConfig(),this._lastCursorModelPosition=new X(1,1),this._renderResult=null,this._activeLineNumber=1,this._context.addEventHandler(this)}_readConfig(){const e=this._context.configuration.options;this._lineHeight=e.get(67);const t=e.get(68);this._renderLineNumbers=t.renderType,this._renderCustomLineNumbers=t.renderFn,this._renderFinalNewline=e.get(96);const i=e.get(146);this._lineNumbersLeft=i.lineNumbersLeft,this._lineNumbersWidth=i.lineNumbersWidth}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return this._readConfig(),!0}onCursorStateChanged(e){const t=e.selections[0].getPosition();this._lastCursorModelPosition=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(t);let i=!1;return this._activeLineNumber!==t.lineNumber&&(this._activeLineNumber=t.lineNumber,i=!0),(this._renderLineNumbers===2||this._renderLineNumbers===3)&&(i=!0),i}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onDecorationsChanged(e){return e.affectsLineNumber}_getLineRenderLineNumber(e){const t=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new X(e,1));if(t.column!==1)return"";const i=t.lineNumber;if(this._renderCustomLineNumbers)return this._renderCustomLineNumbers(i);if(this._renderLineNumbers===2){const n=Math.abs(this._lastCursorModelPosition.lineNumber-i);return n===0?'<span class="relative-current-line-number">'+i+"</span>":String(n)}if(this._renderLineNumbers===3){if(this._lastCursorModelPosition.lineNumber===i||i%10===0)return String(i);const n=this._context.viewModel.getLineCount();return i===n?String(i):""}return String(i)}prepareRender(e){if(this._renderLineNumbers===0){this._renderResult=null;return}const t=Lo?this._lineHeight%2===0?" lh-even":" lh-odd":"",i=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,r=this._context.viewModel.getDecorationsInViewport(e.visibleRange).filter(c=>!!c.options.lineNumberClassName);r.sort((c,d)=>F.compareRangesUsingEnds(c.range,d.range));let o=0;const a=this._context.viewModel.getLineCount(),l=[];for(let c=i;c<=n;c++){const d=c-i;let u=this._getLineRenderLineNumber(c),h="";for(;o<r.length&&r[o].range.endLineNumber<c;)o++;for(let g=o;g<r.length;g++){const{range:p,options:_}=r[g];p.startLineNumber<=c&&(h+=" "+_.lineNumberClassName)}if(!u&&!h){l[d]="";continue}c===a&&this._context.viewModel.getLineLength(c)===0&&(this._renderFinalNewline==="off"&&(u=""),this._renderFinalNewline==="dimmed"&&(h+=" dimmed-line-number")),c===this._activeLineNumber&&(h+=" active-line-number"),l[d]=`<div class="${uO.CLASS_NAME}${t}${h}" style="left:${this._lineNumbersLeft}px;width:${this._lineNumbersWidth}px;">${u}</div>`}this._renderResult=l}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}};uO.CLASS_NAME="line-numbers";let oP=uO;Lc((s,e)=>{const t=s.getColor(fVe),i=s.getColor(IVe);i?e.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${i}; }`):t&&e.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${t.transparent(.4)}; }`)});const iy=class iy extends za{constructor(e){super(e);const t=this._context.configuration.options,i=t.get(146);this._canUseLayerHinting=!t.get(32),this._contentLeft=i.contentLeft,this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._domNode=gi(document.createElement("div")),this._domNode.setClassName(iy.OUTER_CLASS_NAME),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._glyphMarginBackgroundDomNode=gi(document.createElement("div")),this._glyphMarginBackgroundDomNode.setClassName(iy.CLASS_NAME),this._domNode.appendChild(this._glyphMarginBackgroundDomNode)}dispose(){super.dispose()}getDomNode(){return this._domNode}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(146);return this._canUseLayerHinting=!t.get(32),this._contentLeft=i.contentLeft,this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollTopChanged}prepareRender(e){}render(e){this._domNode.setLayerHinting(this._canUseLayerHinting),this._domNode.setContain("strict");const t=e.scrollTop-e.bigNumbersDelta;this._domNode.setTop(-t);const i=Math.min(e.scrollHeight,1e6);this._domNode.setHeight(i),this._domNode.setWidth(this._contentLeft),this._glyphMarginBackgroundDomNode.setLeft(this._glyphMarginLeft),this._glyphMarginBackgroundDomNode.setWidth(this._glyphMarginWidth),this._glyphMarginBackgroundDomNode.setHeight(i)}};iy.CLASS_NAME="glyph-margin",iy.OUTER_CLASS_NAME="margin";let aP=iy;const Ny="monaco-mouse-cursor-text";var xHe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},xse=function(s,e){return function(t,i){e(t,i,s)}};class LHe{constructor(e,t,i,n,r){this._context=e,this.modelLineNumber=t,this.distanceToModelLineStart=i,this.widthOfHiddenLineTextBefore=n,this.distanceToModelLineEnd=r,this._visibleTextAreaBrand=void 0,this.startPosition=null,this.endPosition=null,this.visibleTextareaStart=null,this.visibleTextareaEnd=null,this._previousPresentation=null}prepareRender(e){const t=new X(this.modelLineNumber,this.distanceToModelLineStart+1),i=new X(this.modelLineNumber,this._context.viewModel.model.getLineMaxColumn(this.modelLineNumber)-this.distanceToModelLineEnd);this.startPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(t),this.endPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(i),this.startPosition.lineNumber===this.endPosition.lineNumber?(this.visibleTextareaStart=e.visibleRangeForPosition(this.startPosition),this.visibleTextareaEnd=e.visibleRangeForPosition(this.endPosition)):(this.visibleTextareaStart=null,this.visibleTextareaEnd=null)}definePresentation(e){return this._previousPresentation||(e?this._previousPresentation=e:this._previousPresentation={foreground:1,italic:!1,bold:!1,underline:!1,strikethrough:!1}),this._previousPresentation}}const sB=_c;let NH=class extends za{constructor(e,t,i,n,r){super(e),this._keybindingService=n,this._instantiationService=r,this._primaryCursorPosition=new X(1,1),this._primaryCursorVisibleRange=null,this._viewController=t,this._visibleRangeProvider=i,this._scrollLeft=0,this._scrollTop=0;const o=this._context.configuration.options,a=o.get(146);this._setAccessibilityOptions(o),this._contentLeft=a.contentLeft,this._contentWidth=a.contentWidth,this._contentHeight=a.height,this._fontInfo=o.get(50),this._lineHeight=o.get(67),this._emptySelectionClipboard=o.get(37),this._copyWithSyntaxHighlighting=o.get(25),this._visibleTextArea=null,this._selections=[new Ue(1,1,1,1)],this._modelSelections=[new Ue(1,1,1,1)],this._lastRenderPosition=null,this.textArea=gi(document.createElement("textarea")),mu.write(this.textArea,7),this.textArea.setClassName(`inputarea ${Ny}`),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");const{tabSize:l}=this._context.viewModel.model.getOptions();this.textArea.domNode.style.tabSize=`${l*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("autocorrect","off"),this.textArea.setAttribute("autocapitalize","off"),this.textArea.setAttribute("autocomplete","off"),this.textArea.setAttribute("spellcheck","false"),this.textArea.setAttribute("aria-label",this._getAriaLabel(o)),this.textArea.setAttribute("aria-required",o.get(5)?"true":"false"),this.textArea.setAttribute("tabindex",String(o.get(125))),this.textArea.setAttribute("role","textbox"),this.textArea.setAttribute("aria-roledescription",b("editor","editor")),this.textArea.setAttribute("aria-multiline","true"),this.textArea.setAttribute("aria-autocomplete",o.get(92)?"none":"both"),this._ensureReadOnlyAttribute(),this.textAreaCover=gi(document.createElement("div")),this.textAreaCover.setPosition("absolute");const c={getLineCount:()=>this._context.viewModel.getLineCount(),getLineMaxColumn:h=>this._context.viewModel.getLineMaxColumn(h),getValueInRange:(h,g)=>this._context.viewModel.getValueInRange(h,g),getValueLengthInRange:(h,g)=>this._context.viewModel.getValueLengthInRange(h,g),modifyPosition:(h,g)=>this._context.viewModel.modifyPosition(h,g)},d={getDataToCopy:()=>{const h=this._context.viewModel.getPlainTextToCopy(this._modelSelections,this._emptySelectionClipboard,gr),g=this._context.viewModel.model.getEOL(),p=this._emptySelectionClipboard&&this._modelSelections.length===1&&this._modelSelections[0].isEmpty(),_=Array.isArray(h)?h:null,v=Array.isArray(h)?h.join(g):h;let C,y=null;if(EH.forceCopyWithSyntaxHighlighting||this._copyWithSyntaxHighlighting&&v.length<65536){const x=this._context.viewModel.getRichTextToCopy(this._modelSelections,this._emptySelectionClipboard);x&&(C=x.html,y=x.mode)}return{isFromEmptySelection:p,multicursorText:_,text:v,html:C,mode:y}},getScreenReaderContent:()=>{if(this._accessibilitySupport===1){const h=this._selections[0];if(Wt&&h.isEmpty()){const p=h.getStartPosition();let _=this._getWordBeforePosition(p);if(_.length===0&&(_=this._getCharacterBeforePosition(p)),_.length>0)return new qr(_,_.length,_.length,F.fromPositions(p),0)}if(Wt&&!h.isEmpty()&&c.getValueLengthInRange(h,0)<500){const p=c.getValueInRange(h,0);return new qr(p,0,p.length,h,0)}if(jm&&!h.isEmpty()){const p="vscode-placeholder";return new qr(p,0,p.length,null,void 0)}return qr.EMPTY}if(Jee){const h=this._selections[0];if(h.isEmpty()){const g=h.getStartPosition(),[p,_]=this._getAndroidWordAtPosition(g);if(p.length>0)return new qr(p,_,_,F.fromPositions(g),0)}return qr.EMPTY}return PC.fromEditorSelection(c,this._selections[0],this._accessibilityPageSize,this._accessibilitySupport===0)},deduceModelPosition:(h,g,p)=>this._context.viewModel.deduceModelPositionRelativeToViewPosition(h,g,p)},u=this._register(new wHe(this.textArea.domNode));this._textAreaInput=this._register(this._instantiationService.createInstance(DH,d,u,Da,{isAndroid:Jee,isChrome:UE,isFirefox:_c,isSafari:jm})),this._register(this._textAreaInput.onKeyDown(h=>{this._viewController.emitKeyDown(h)})),this._register(this._textAreaInput.onKeyUp(h=>{this._viewController.emitKeyUp(h)})),this._register(this._textAreaInput.onPaste(h=>{let g=!1,p=null,_=null;h.metadata&&(g=this._emptySelectionClipboard&&!!h.metadata.isFromEmptySelection,p=typeof h.metadata.multicursorText<"u"?h.metadata.multicursorText:null,_=h.metadata.mode),this._viewController.paste(h.text,g,p,_)})),this._register(this._textAreaInput.onCut(()=>{this._viewController.cut()})),this._register(this._textAreaInput.onType(h=>{h.replacePrevCharCnt||h.replaceNextCharCnt||h.positionDelta?this._viewController.compositionType(h.text,h.replacePrevCharCnt,h.replaceNextCharCnt,h.positionDelta):this._viewController.type(h.text)})),this._register(this._textAreaInput.onSelectionChangeRequest(h=>{this._viewController.setSelection(h)})),this._register(this._textAreaInput.onCompositionStart(h=>{const g=this.textArea.domNode,p=this._modelSelections[0],{distanceToModelLineStart:_,widthOfHiddenTextBefore:v}=(()=>{const y=g.value.substring(0,Math.min(g.selectionStart,g.selectionEnd)),x=y.lastIndexOf(`
`),L=y.substring(x+1),I=L.lastIndexOf("	"),A=L.length-I-1,D=p.getStartPosition(),N=Math.min(D.column-1,A),R=D.column-1-N,W=L.substring(0,L.length-N),{tabSize:H}=this._context.viewModel.model.getOptions(),U=kHe(this.textArea.domNode.ownerDocument,W,this._fontInfo,H);return{distanceToModelLineStart:R,widthOfHiddenTextBefore:U}})(),{distanceToModelLineEnd:C}=(()=>{const y=g.value.substring(Math.max(g.selectionStart,g.selectionEnd)),x=y.indexOf(`
`),L=x===-1?y:y.substring(0,x),I=L.indexOf("	"),A=I===-1?L.length:L.length-I-1,D=p.getEndPosition(),N=Math.min(this._context.viewModel.model.getLineMaxColumn(D.lineNumber)-D.column,A);return{distanceToModelLineEnd:this._context.viewModel.model.getLineMaxColumn(D.lineNumber)-D.column-N}})();this._context.viewModel.revealRange("keyboard",!0,F.fromPositions(this._selections[0].getStartPosition()),0,1),this._visibleTextArea=new LHe(this._context,p.startLineNumber,_,v,C),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render(),this.textArea.setClassName(`inputarea ${Ny} ime-input`),this._viewController.compositionStart(),this._context.viewModel.onCompositionStart()})),this._register(this._textAreaInput.onCompositionUpdate(h=>{this._visibleTextArea&&(this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render())})),this._register(this._textAreaInput.onCompositionEnd(()=>{this._visibleTextArea=null,this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._render(),this.textArea.setClassName(`inputarea ${Ny}`),this._viewController.compositionEnd(),this._context.viewModel.onCompositionEnd()})),this._register(this._textAreaInput.onFocus(()=>{this._context.viewModel.setHasFocus(!0)})),this._register(this._textAreaInput.onBlur(()=>{this._context.viewModel.setHasFocus(!1)})),this._register(PL.onDidChange(()=>{this._ensureReadOnlyAttribute()}))}writeScreenReaderContent(e){this._textAreaInput.writeNativeTextAreaContent(e)}dispose(){super.dispose()}_getAndroidWordAtPosition(e){const t='`~!@#$%^&*()-=+[{]}\\|;:",.<>/?',i=this._context.viewModel.getLineContent(e.lineNumber),n=wc(t,[]);let r=!0,o=e.column,a=!0,l=e.column,c=0;for(;c<50&&(r||a);){if(r&&o<=1&&(r=!1),r){const d=i.charCodeAt(o-2);n.get(d)!==0?r=!1:o--}if(a&&l>i.length&&(a=!1),a){const d=i.charCodeAt(l-1);n.get(d)!==0?a=!1:l++}c++}return[i.substring(o-1,l-1),e.column-o]}_getWordBeforePosition(e){const t=this._context.viewModel.getLineContent(e.lineNumber),i=wc(this._context.configuration.options.get(132),[]);let n=e.column,r=0;for(;n>1;){const o=t.charCodeAt(n-2);if(i.get(o)!==0||r>50)return t.substring(n-1,e.column-1);r++,n--}return t.substring(0,e.column-1)}_getCharacterBeforePosition(e){if(e.column>1){const i=this._context.viewModel.getLineContent(e.lineNumber).charAt(e.column-2);if(!ws(i.charCodeAt(0)))return i}return""}_getAriaLabel(e){var i,n,r;if(e.get(2)===1){const o=(i=this._keybindingService.lookupKeybinding("editor.action.toggleScreenReaderAccessibilityMode"))==null?void 0:i.getAriaLabel(),a=(n=this._keybindingService.lookupKeybinding("workbench.action.showCommands"))==null?void 0:n.getAriaLabel(),l=(r=this._keybindingService.lookupKeybinding("workbench.action.openGlobalKeybindings"))==null?void 0:r.getAriaLabel(),c=b("accessibilityModeOff","The editor is not accessible at this time.");return o?b("accessibilityOffAriaLabel","{0} To enable screen reader optimized mode, use {1}",c,o):a?b("accessibilityOffAriaLabelNoKb","{0} To enable screen reader optimized mode, open the quick pick with {1} and run the command Toggle Screen Reader Accessibility Mode, which is currently not triggerable via keyboard.",c,a):l?b("accessibilityOffAriaLabelNoKbs","{0} Please assign a keybinding for the command Toggle Screen Reader Accessibility Mode by accessing the keybindings editor with {1} and run it.",c,l):c}return e.get(4)}_setAccessibilityOptions(e){this._accessibilitySupport=e.get(2);const t=e.get(3);this._accessibilitySupport===2&&t===bu.accessibilityPageSize.defaultValue?this._accessibilityPageSize=500:this._accessibilityPageSize=t;const n=e.get(146).wrappingColumn;if(n!==-1&&this._accessibilitySupport!==1){const r=e.get(50);this._textAreaWrapping=!0,this._textAreaWidth=Math.round(n*r.typicalHalfwidthCharacterWidth)}else this._textAreaWrapping=!1,this._textAreaWidth=sB?0:1}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(146);this._setAccessibilityOptions(t),this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._contentHeight=i.height,this._fontInfo=t.get(50),this._lineHeight=t.get(67),this._emptySelectionClipboard=t.get(37),this._copyWithSyntaxHighlighting=t.get(25),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");const{tabSize:n}=this._context.viewModel.model.getOptions();return this.textArea.domNode.style.tabSize=`${n*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("aria-label",this._getAriaLabel(t)),this.textArea.setAttribute("aria-required",t.get(5)?"true":"false"),this.textArea.setAttribute("tabindex",String(t.get(125))),(e.hasChanged(34)||e.hasChanged(92))&&this._ensureReadOnlyAttribute(),e.hasChanged(2)&&this._textAreaInput.writeNativeTextAreaContent("strategy changed"),!0}onCursorStateChanged(e){return this._selections=e.selections.slice(0),this._modelSelections=e.modelSelections.slice(0),this._textAreaInput.writeNativeTextAreaContent("selection changed"),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return this._scrollLeft=e.scrollLeft,this._scrollTop=e.scrollTop,!0}onZonesChanged(e){return!0}isFocused(){return this._textAreaInput.isFocused()}focusTextArea(){this._textAreaInput.focusTextArea()}getLastRenderData(){return this._lastRenderPosition}setAriaOptions(e){e.activeDescendant?(this.textArea.setAttribute("aria-haspopup","true"),this.textArea.setAttribute("aria-autocomplete","list"),this.textArea.setAttribute("aria-activedescendant",e.activeDescendant)):(this.textArea.setAttribute("aria-haspopup","false"),this.textArea.setAttribute("aria-autocomplete","both"),this.textArea.removeAttribute("aria-activedescendant")),e.role&&this.textArea.setAttribute("role",e.role)}_ensureReadOnlyAttribute(){const e=this._context.configuration.options;!PL.enabled||e.get(34)&&e.get(92)?this.textArea.setAttribute("readonly","true"):this.textArea.removeAttribute("readonly")}prepareRender(e){var t;this._primaryCursorPosition=new X(this._selections[0].positionLineNumber,this._selections[0].positionColumn),this._primaryCursorVisibleRange=e.visibleRangeForPosition(this._primaryCursorPosition),(t=this._visibleTextArea)==null||t.prepareRender(e)}render(e){this._textAreaInput.writeNativeTextAreaContent("render"),this._render()}_render(){if(this._visibleTextArea){const i=this._visibleTextArea.visibleTextareaStart,n=this._visibleTextArea.visibleTextareaEnd,r=this._visibleTextArea.startPosition,o=this._visibleTextArea.endPosition;if(r&&o&&i&&n&&n.left>=this._scrollLeft&&i.left<=this._scrollLeft+this._contentWidth){const a=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primaryCursorPosition.lineNumber)-this._scrollTop,l=this._newlinecount(this.textArea.domNode.value.substr(0,this.textArea.domNode.selectionStart));let c=this._visibleTextArea.widthOfHiddenLineTextBefore,d=this._contentLeft+i.left-this._scrollLeft,u=n.left-i.left+1;if(d<this._contentLeft){const C=this._contentLeft-d;d+=C,c+=C,u-=C}u>this._contentWidth&&(u=this._contentWidth);const h=this._context.viewModel.getViewLineData(r.lineNumber),g=h.tokens.findTokenIndexAtOffset(r.column-1),p=h.tokens.findTokenIndexAtOffset(o.column-1),_=g===p,v=this._visibleTextArea.definePresentation(_?h.tokens.getPresentation(g):null);this.textArea.domNode.scrollTop=l*this._lineHeight,this.textArea.domNode.scrollLeft=c,this._doRender({lastRenderPosition:null,top:a,left:d,width:u,height:this._lineHeight,useCover:!1,color:(Ln.getColorMap()||[])[v.foreground],italic:v.italic,bold:v.bold,underline:v.underline,strikethrough:v.strikethrough})}return}if(!this._primaryCursorVisibleRange){this._renderAtTopLeft();return}const e=this._contentLeft+this._primaryCursorVisibleRange.left-this._scrollLeft;if(e<this._contentLeft||e>this._contentLeft+this._contentWidth){this._renderAtTopLeft();return}const t=this._context.viewLayout.getVerticalOffsetForLineNumber(this._selections[0].positionLineNumber)-this._scrollTop;if(t<0||t>this._contentHeight){this._renderAtTopLeft();return}if(Wt||this._accessibilitySupport===2){this._doRender({lastRenderPosition:this._primaryCursorPosition,top:t,left:this._textAreaWrapping?this._contentLeft:e,width:this._textAreaWidth,height:this._lineHeight,useCover:!1}),this.textArea.domNode.scrollLeft=this._primaryCursorVisibleRange.left;const i=this._textAreaInput.textAreaState.newlineCountBeforeSelection??this._newlinecount(this.textArea.domNode.value.substr(0,this.textArea.domNode.selectionStart));this.textArea.domNode.scrollTop=i*this._lineHeight;return}this._doRender({lastRenderPosition:this._primaryCursorPosition,top:t,left:this._textAreaWrapping?this._contentLeft:e,width:this._textAreaWidth,height:sB?0:1,useCover:!1})}_newlinecount(e){let t=0,i=-1;do{if(i=e.indexOf(`
`,i+1),i===-1)break;t++}while(!0);return t}_renderAtTopLeft(){this._doRender({lastRenderPosition:null,top:0,left:0,width:this._textAreaWidth,height:sB?0:1,useCover:!0})}_doRender(e){this._lastRenderPosition=e.lastRenderPosition;const t=this.textArea,i=this.textAreaCover;Zs(t,this._fontInfo),t.setTop(e.top),t.setLeft(e.left),t.setWidth(e.width),t.setHeight(e.height),t.setColor(e.color?fe.Format.CSS.formatHex(e.color):""),t.setFontStyle(e.italic?"italic":""),e.bold&&t.setFontWeight("bold"),t.setTextDecoration(`${e.underline?" underline":""}${e.strikethrough?" line-through":""}`),i.setTop(e.useCover?e.top:0),i.setLeft(e.useCover?e.left:0),i.setWidth(e.useCover?e.width:0),i.setHeight(e.useCover?e.height:0);const n=this._context.configuration.options;n.get(57)?i.setClassName("monaco-editor-background textAreaCover "+aP.OUTER_CLASS_NAME):n.get(68).renderType!==0?i.setClassName("monaco-editor-background textAreaCover "+oP.CLASS_NAME):i.setClassName("monaco-editor-background textAreaCover")}};NH=xHe([xse(3,pi),xse(4,Xe)],NH);function kHe(s,e,t,i){if(e.length===0)return 0;const n=s.createElement("div");n.style.position="absolute",n.style.top="-50000px",n.style.width="50000px";const r=s.createElement("span");Zs(r,t),r.style.whiteSpace="pre",r.style.tabSize=`${i*t.spaceWidth}px`,r.append(e),n.appendChild(r),s.body.appendChild(n);const o=r.offsetWidth;return n.remove(),o}const IHe=()=>!0,EHe=()=>!1,DHe=s=>s===" "||s==="	";class Q0{static shouldRecreate(e){return e.hasChanged(146)||e.hasChanged(132)||e.hasChanged(37)||e.hasChanged(77)||e.hasChanged(79)||e.hasChanged(80)||e.hasChanged(6)||e.hasChanged(7)||e.hasChanged(11)||e.hasChanged(9)||e.hasChanged(10)||e.hasChanged(14)||e.hasChanged(129)||e.hasChanged(50)||e.hasChanged(92)||e.hasChanged(131)}constructor(e,t,i,n){this.languageConfigurationService=n,this._cursorMoveConfigurationBrand=void 0,this._languageId=e;const r=i.options,o=r.get(146),a=r.get(50);this.readOnly=r.get(92),this.tabSize=t.tabSize,this.indentSize=t.indentSize,this.insertSpaces=t.insertSpaces,this.stickyTabStops=r.get(117),this.lineHeight=a.lineHeight,this.typicalHalfwidthCharacterWidth=a.typicalHalfwidthCharacterWidth,this.pageSize=Math.max(1,Math.floor(o.height/this.lineHeight)-2),this.useTabStops=r.get(129),this.wordSeparators=r.get(132),this.emptySelectionClipboard=r.get(37),this.copyWithSyntaxHighlighting=r.get(25),this.multiCursorMergeOverlapping=r.get(77),this.multiCursorPaste=r.get(79),this.multiCursorLimit=r.get(80),this.autoClosingBrackets=r.get(6),this.autoClosingComments=r.get(7),this.autoClosingQuotes=r.get(11),this.autoClosingDelete=r.get(9),this.autoClosingOvertype=r.get(10),this.autoSurround=r.get(14),this.autoIndent=r.get(12),this.wordSegmenterLocales=r.get(131),this.surroundingPairs={},this._electricChars=null,this.shouldAutoCloseBefore={quote:this._getShouldAutoClose(e,this.autoClosingQuotes,!0),comment:this._getShouldAutoClose(e,this.autoClosingComments,!1),bracket:this._getShouldAutoClose(e,this.autoClosingBrackets,!1)},this.autoClosingPairs=this.languageConfigurationService.getLanguageConfiguration(e).getAutoClosingPairs();const l=this.languageConfigurationService.getLanguageConfiguration(e).getSurroundingPairs();if(l)for(const d of l)this.surroundingPairs[d.open]=d.close;const c=this.languageConfigurationService.getLanguageConfiguration(e).comments;this.blockCommentStartToken=(c==null?void 0:c.blockCommentStartToken)??null}get electricChars(){var e;if(!this._electricChars){this._electricChars={};const t=(e=this.languageConfigurationService.getLanguageConfiguration(this._languageId).electricCharacter)==null?void 0:e.getElectricCharacters();if(t)for(const i of t)this._electricChars[i]=!0}return this._electricChars}onElectricCharacter(e,t,i){const n=Vb(t,i-1),r=this.languageConfigurationService.getLanguageConfiguration(n.languageId).electricCharacter;return r?r.onElectricCharacter(e,n,i-n.firstCharOffset):null}normalizeIndentation(e){return WK(e,this.indentSize,this.insertSpaces)}_getShouldAutoClose(e,t,i){switch(t){case"beforeWhitespace":return DHe;case"languageDefined":return this._getLanguageDefinedShouldAutoClose(e,i);case"always":return IHe;case"never":return EHe}}_getLanguageDefinedShouldAutoClose(e,t){const i=this.languageConfigurationService.getLanguageConfiguration(e).getAutoCloseBeforeSet(t);return n=>i.indexOf(n)!==-1}visibleColumnFromColumn(e,t){return hs.visibleColumnFromColumn(e.getLineContent(t.lineNumber),t.column,this.tabSize)}columnFromVisibleColumn(e,t,i){const n=hs.columnFromVisibleColumn(e.getLineContent(t),i,this.tabSize),r=e.getLineMinColumn(t);if(n<r)return r;const o=e.getLineMaxColumn(t);return n>o?o:n}}let ti=class Kpe{static fromModelState(e){return new THe(e)}static fromViewState(e){return new NHe(e)}static fromModelSelection(e){const t=Ue.liftSelection(e),i=new Ks(F.fromPositions(t.getSelectionStart()),0,0,t.getPosition(),0);return Kpe.fromModelState(i)}static fromModelSelections(e){const t=[];for(let i=0,n=e.length;i<n;i++)t[i]=this.fromModelSelection(e[i]);return t}constructor(e,t){this._cursorStateBrand=void 0,this.modelState=e,this.viewState=t}equals(e){return this.viewState.equals(e.viewState)&&this.modelState.equals(e.modelState)}};class THe{constructor(e){this.modelState=e,this.viewState=null}}class NHe{constructor(e){this.modelState=null,this.viewState=e}}class Ks{constructor(e,t,i,n,r){this.selectionStart=e,this.selectionStartKind=t,this.selectionStartLeftoverVisibleColumns=i,this.position=n,this.leftoverVisibleColumns=r,this._singleCursorStateBrand=void 0,this.selection=Ks._computeSelection(this.selectionStart,this.position)}equals(e){return this.selectionStartLeftoverVisibleColumns===e.selectionStartLeftoverVisibleColumns&&this.leftoverVisibleColumns===e.leftoverVisibleColumns&&this.selectionStartKind===e.selectionStartKind&&this.position.equals(e.position)&&this.selectionStart.equalsRange(e.selectionStart)}hasSelection(){return!this.selection.isEmpty()||!this.selectionStart.isEmpty()}move(e,t,i,n){return e?new Ks(this.selectionStart,this.selectionStartKind,this.selectionStartLeftoverVisibleColumns,new X(t,i),n):new Ks(new F(t,i,t,i),0,n,new X(t,i),n)}static _computeSelection(e,t){return e.isEmpty()||!t.isBeforeOrEqual(e.getStartPosition())?Ue.fromPositions(e.getStartPosition(),t):Ue.fromPositions(e.getEndPosition(),t)}}class na{constructor(e,t,i){this._editOperationResultBrand=void 0,this.type=e,this.commands=t,this.shouldPushStackElementBefore=i.shouldPushStackElementBefore,this.shouldPushStackElementAfter=i.shouldPushStackElementAfter}}function e_(s){return s==="'"||s==='"'||s==="`"}class kb{static columnSelect(e,t,i,n,r,o){const a=Math.abs(r-i)+1,l=i>r,c=n>o,d=n<o,u=[];for(let h=0;h<a;h++){const g=i+(l?-h:h),p=e.columnFromVisibleColumn(t,g,n),_=e.columnFromVisibleColumn(t,g,o),v=e.visibleColumnFromColumn(t,new X(g,p)),C=e.visibleColumnFromColumn(t,new X(g,_));d&&(v>o||C<n)||c&&(C>n||v<o)||u.push(new Ks(new F(g,p,g,p),0,0,new X(g,_),0))}if(u.length===0)for(let h=0;h<a;h++){const g=i+(l?-h:h),p=t.getLineMaxColumn(g);u.push(new Ks(new F(g,p,g,p),0,0,new X(g,p),0))}return{viewStates:u,reversed:l,fromLineNumber:i,fromVisualColumn:n,toLineNumber:r,toVisualColumn:o}}static columnSelectLeft(e,t,i){let n=i.toViewVisualColumn;return n>0&&n--,kb.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,i.toViewLineNumber,n)}static columnSelectRight(e,t,i){let n=0;const r=Math.min(i.fromViewLineNumber,i.toViewLineNumber),o=Math.max(i.fromViewLineNumber,i.toViewLineNumber);for(let l=r;l<=o;l++){const c=t.getLineMaxColumn(l),d=e.visibleColumnFromColumn(t,new X(l,c));n=Math.max(n,d)}let a=i.toViewVisualColumn;return a<n&&a++,this.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,i.toViewLineNumber,a)}static columnSelectUp(e,t,i,n){const r=n?e.pageSize:1,o=Math.max(1,i.toViewLineNumber-r);return this.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,o,i.toViewVisualColumn)}static columnSelectDown(e,t,i,n){const r=n?e.pageSize:1,o=Math.min(t.getLineCount(),i.toViewLineNumber+r);return this.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,o,i.toViewVisualColumn)}}class dr{constructor(e,t,i=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=i}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return Ue.fromPositions(n.getEndPosition())}}class RHe{constructor(e,t){this._range=e,this._text=t}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return Ue.fromRange(n,0)}}class UR{constructor(e,t,i=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=i}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return Ue.fromPositions(n.getStartPosition())}}class lP{constructor(e,t,i,n,r=!1){this._range=e,this._text=t,this._columnDeltaOffset=n,this._lineNumberDeltaOffset=i,this.insertsAutoWhitespace=r}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return Ue.fromPositions(n.getEndPosition().delta(this._lineNumberDeltaOffset,this._columnDeltaOffset))}}class xG{constructor(e,t,i,n=!1){this._range=e,this._text=t,this._initialSelection=i,this._forceMoveMarkers=n,this._selectionId=null}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text,this._forceMoveMarkers),this._selectionId=t.trackSelection(this._initialSelection)}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}}class rB{constructor(e,t,i){this._cursorPositionBrand=void 0,this.lineNumber=e,this.column=t,this.leftoverVisibleColumns=i}}class vi{static leftPosition(e,t){if(t.column>e.getLineMinColumn(t.lineNumber))return t.delta(void 0,-Tue(e.getLineContent(t.lineNumber),t.column-1));if(t.lineNumber>1){const i=t.lineNumber-1;return new X(i,e.getLineMaxColumn(i))}else return t}static leftPositionAtomicSoftTabs(e,t,i){if(t.column<=e.getLineIndentColumn(t.lineNumber)){const n=e.getLineMinColumn(t.lineNumber),r=e.getLineContent(t.lineNumber),o=WI.atomicPosition(r,t.column-1,i,0);if(o!==-1&&o+1>=n)return new X(t.lineNumber,o+1)}return this.leftPosition(e,t)}static left(e,t,i){const n=e.stickyTabStops?vi.leftPositionAtomicSoftTabs(t,i,e.tabSize):vi.leftPosition(t,i);return new rB(n.lineNumber,n.column,0)}static moveLeft(e,t,i,n,r){let o,a;if(i.hasSelection()&&!n)o=i.selection.startLineNumber,a=i.selection.startColumn;else{const l=i.position.delta(void 0,-(r-1)),c=t.normalizePosition(vi.clipPositionColumn(l,t),0),d=vi.left(e,t,c);o=d.lineNumber,a=d.column}return i.move(n,o,a,0)}static clipPositionColumn(e,t){return new X(e.lineNumber,vi.clipRange(e.column,t.getLineMinColumn(e.lineNumber),t.getLineMaxColumn(e.lineNumber)))}static clipRange(e,t,i){return e<t?t:e>i?i:e}static rightPosition(e,t,i){return i<e.getLineMaxColumn(t)?i=i+Rq(e.getLineContent(t),i-1):t<e.getLineCount()&&(t=t+1,i=e.getLineMinColumn(t)),new X(t,i)}static rightPositionAtomicSoftTabs(e,t,i,n,r){if(i<e.getLineIndentColumn(t)){const o=e.getLineContent(t),a=WI.atomicPosition(o,i-1,n,1);if(a!==-1)return new X(t,a+1)}return this.rightPosition(e,t,i)}static right(e,t,i){const n=e.stickyTabStops?vi.rightPositionAtomicSoftTabs(t,i.lineNumber,i.column,e.tabSize,e.indentSize):vi.rightPosition(t,i.lineNumber,i.column);return new rB(n.lineNumber,n.column,0)}static moveRight(e,t,i,n,r){let o,a;if(i.hasSelection()&&!n)o=i.selection.endLineNumber,a=i.selection.endColumn;else{const l=i.position.delta(void 0,r-1),c=t.normalizePosition(vi.clipPositionColumn(l,t),1),d=vi.right(e,t,c);o=d.lineNumber,a=d.column}return i.move(n,o,a,0)}static vertical(e,t,i,n,r,o,a,l){const c=hs.visibleColumnFromColumn(t.getLineContent(i),n,e.tabSize)+r,d=t.getLineCount(),u=i===1&&n===1,h=i===d&&n===t.getLineMaxColumn(i),g=o<i?u:h;if(i=o,i<1?(i=1,a?n=t.getLineMinColumn(i):n=Math.min(t.getLineMaxColumn(i),n)):i>d?(i=d,a?n=t.getLineMaxColumn(i):n=Math.min(t.getLineMaxColumn(i),n)):n=e.columnFromVisibleColumn(t,i,c),g?r=0:r=c-hs.visibleColumnFromColumn(t.getLineContent(i),n,e.tabSize),l!==void 0){const p=new X(i,n),_=t.normalizePosition(p,l);r=r+(n-_.column),i=_.lineNumber,n=_.column}return new rB(i,n,r)}static down(e,t,i,n,r,o,a){return this.vertical(e,t,i,n,r,i+o,a,4)}static moveDown(e,t,i,n,r){let o,a;i.hasSelection()&&!n?(o=i.selection.endLineNumber,a=i.selection.endColumn):(o=i.position.lineNumber,a=i.position.column);let l=0,c;do if(c=vi.down(e,t,o+l,a,i.leftoverVisibleColumns,r,!0),t.normalizePosition(new X(c.lineNumber,c.column),2).lineNumber>o)break;while(l++<10&&o+l<t.getLineCount());return i.move(n,c.lineNumber,c.column,c.leftoverVisibleColumns)}static translateDown(e,t,i){const n=i.selection,r=vi.down(e,t,n.selectionStartLineNumber,n.selectionStartColumn,i.selectionStartLeftoverVisibleColumns,1,!1),o=vi.down(e,t,n.positionLineNumber,n.positionColumn,i.leftoverVisibleColumns,1,!1);return new Ks(new F(r.lineNumber,r.column,r.lineNumber,r.column),0,r.leftoverVisibleColumns,new X(o.lineNumber,o.column),o.leftoverVisibleColumns)}static up(e,t,i,n,r,o,a){return this.vertical(e,t,i,n,r,i-o,a,3)}static moveUp(e,t,i,n,r){let o,a;i.hasSelection()&&!n?(o=i.selection.startLineNumber,a=i.selection.startColumn):(o=i.position.lineNumber,a=i.position.column);const l=vi.up(e,t,o,a,i.leftoverVisibleColumns,r,!0);return i.move(n,l.lineNumber,l.column,l.leftoverVisibleColumns)}static translateUp(e,t,i){const n=i.selection,r=vi.up(e,t,n.selectionStartLineNumber,n.selectionStartColumn,i.selectionStartLeftoverVisibleColumns,1,!1),o=vi.up(e,t,n.positionLineNumber,n.positionColumn,i.leftoverVisibleColumns,1,!1);return new Ks(new F(r.lineNumber,r.column,r.lineNumber,r.column),0,r.leftoverVisibleColumns,new X(o.lineNumber,o.column),o.leftoverVisibleColumns)}static _isBlankLine(e,t){return e.getLineFirstNonWhitespaceColumn(t)===0}static moveToPrevBlankLine(e,t,i,n){let r=i.position.lineNumber;for(;r>1&&this._isBlankLine(t,r);)r--;for(;r>1&&!this._isBlankLine(t,r);)r--;return i.move(n,r,t.getLineMinColumn(r),0)}static moveToNextBlankLine(e,t,i,n){const r=t.getLineCount();let o=i.position.lineNumber;for(;o<r&&this._isBlankLine(t,o);)o++;for(;o<r&&!this._isBlankLine(t,o);)o++;return i.move(n,o,t.getLineMinColumn(o),0)}static moveToBeginningOfLine(e,t,i,n){const r=i.position.lineNumber,o=t.getLineMinColumn(r),a=t.getLineFirstNonWhitespaceColumn(r)||o;let l;return i.position.column===a?l=o:l=a,i.move(n,r,l,0)}static moveToEndOfLine(e,t,i,n,r){const o=i.position.lineNumber,a=t.getLineMaxColumn(o);return i.move(n,o,a,r?1073741824-a:0)}static moveToBeginningOfBuffer(e,t,i,n){return i.move(n,1,1,0)}static moveToEndOfBuffer(e,t,i,n){const r=t.getLineCount(),o=t.getLineMaxColumn(r);return i.move(n,r,o,0)}}class yw{static deleteRight(e,t,i,n){const r=[];let o=e!==3;for(let a=0,l=n.length;a<l;a++){const c=n[a];let d=c;if(d.isEmpty()){const u=c.getPosition(),h=vi.right(t,i,u);d=new F(h.lineNumber,h.column,u.lineNumber,u.column)}if(d.isEmpty()){r[a]=null;continue}d.startLineNumber!==d.endLineNumber&&(o=!0),r[a]=new dr(d,"")}return[o,r]}static isAutoClosingPairDelete(e,t,i,n,r,o,a){if(t==="never"&&i==="never"||e==="never")return!1;for(let l=0,c=o.length;l<c;l++){const d=o[l],u=d.getPosition();if(!d.isEmpty())return!1;const h=r.getLineContent(u.lineNumber);if(u.column<2||u.column>=h.length+1)return!1;const g=h.charAt(u.column-2),p=n.get(g);if(!p)return!1;if(e_(g)){if(i==="never")return!1}else if(t==="never")return!1;const _=h.charAt(u.column-1);let v=!1;for(const C of p)C.open===g&&C.close===_&&(v=!0);if(!v)return!1;if(e==="auto"){let C=!1;for(let y=0,x=a.length;y<x;y++){const L=a[y];if(u.lineNumber===L.startLineNumber&&u.column===L.startColumn){C=!0;break}}if(!C)return!1}}return!0}static _runAutoClosingPairDelete(e,t,i){const n=[];for(let r=0,o=i.length;r<o;r++){const a=i[r].getPosition(),l=new F(a.lineNumber,a.column-1,a.lineNumber,a.column+1);n[r]=new dr(l,"")}return[!0,n]}static deleteLeft(e,t,i,n,r){if(this.isAutoClosingPairDelete(t.autoClosingDelete,t.autoClosingBrackets,t.autoClosingQuotes,t.autoClosingPairs.autoClosingPairsOpenByEnd,i,n,r))return this._runAutoClosingPairDelete(t,i,n);const o=[];let a=e!==2;for(let l=0,c=n.length;l<c;l++){const d=yw.getDeleteRange(n[l],i,t);if(d.isEmpty()){o[l]=null;continue}d.startLineNumber!==d.endLineNumber&&(a=!0),o[l]=new dr(d,"")}return[a,o]}static getDeleteRange(e,t,i){if(!e.isEmpty())return e;const n=e.getPosition();if(i.useTabStops&&n.column>1){const r=t.getLineContent(n.lineNumber),o=Zr(r),a=o===-1?r.length+1:o+1;if(n.column<=a){const l=i.visibleColumnFromColumn(t,n),c=hs.prevIndentTabStop(l,i.indentSize),d=i.columnFromVisibleColumn(t,n.lineNumber,c);return new F(n.lineNumber,d,n.lineNumber,n.column)}}return F.fromPositions(yw.getPositionAfterDeleteLeft(n,t),n)}static getPositionAfterDeleteLeft(e,t){if(e.column>1){const i=QRe(e.column-1,t.getLineContent(e.lineNumber));return e.with(void 0,i+1)}else if(e.lineNumber>1){const i=e.lineNumber-1;return new X(i,t.getLineMaxColumn(i))}else return e}static cut(e,t,i){const n=[];let r=null;i.sort((o,a)=>X.compare(o.getStartPosition(),a.getEndPosition()));for(let o=0,a=i.length;o<a;o++){const l=i[o];if(l.isEmpty())if(e.emptySelectionClipboard){const c=l.getPosition();let d,u,h,g;c.lineNumber<t.getLineCount()?(d=c.lineNumber,u=1,h=c.lineNumber+1,g=1):c.lineNumber>1&&(r==null?void 0:r.endLineNumber)!==c.lineNumber?(d=c.lineNumber-1,u=t.getLineMaxColumn(c.lineNumber-1),h=c.lineNumber,g=t.getLineMaxColumn(c.lineNumber)):(d=c.lineNumber,u=1,h=c.lineNumber,g=t.getLineMaxColumn(c.lineNumber));const p=new F(d,u,h,g);r=p,p.isEmpty()?n[o]=null:n[o]=new dr(p,"")}else n[o]=null;else n[o]=new dr(l,"")}return new na(0,n,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}}class hi{static _createWord(e,t,i,n,r){return{start:n,end:r,wordType:t,nextCharClass:i}}static _createIntlWord(e,t){return{start:e.index,end:e.index+e.segment.length,wordType:1,nextCharClass:t}}static _findPreviousWordOnLine(e,t,i){const n=t.getLineContent(i.lineNumber);return this._doFindPreviousWordOnLine(n,e,i)}static _doFindPreviousWordOnLine(e,t,i){let n=0;const r=t.findPrevIntlWordBeforeOrAtOffset(e,i.column-2);for(let o=i.column-2;o>=0;o--){const a=e.charCodeAt(o),l=t.get(a);if(r&&o===r.index)return this._createIntlWord(r,l);if(l===0){if(n===2)return this._createWord(e,n,l,o+1,this._findEndOfWord(e,t,n,o+1));n=1}else if(l===2){if(n===1)return this._createWord(e,n,l,o+1,this._findEndOfWord(e,t,n,o+1));n=2}else if(l===1&&n!==0)return this._createWord(e,n,l,o+1,this._findEndOfWord(e,t,n,o+1))}return n!==0?this._createWord(e,n,1,0,this._findEndOfWord(e,t,n,0)):null}static _findEndOfWord(e,t,i,n){const r=t.findNextIntlWordAtOrAfterOffset(e,n),o=e.length;for(let a=n;a<o;a++){const l=e.charCodeAt(a),c=t.get(l);if(r&&a===r.index+r.segment.length||c===1||i===1&&c===2||i===2&&c===0)return a}return o}static _findNextWordOnLine(e,t,i){const n=t.getLineContent(i.lineNumber);return this._doFindNextWordOnLine(n,e,i)}static _doFindNextWordOnLine(e,t,i){let n=0;const r=e.length,o=t.findNextIntlWordAtOrAfterOffset(e,i.column-1);for(let a=i.column-1;a<r;a++){const l=e.charCodeAt(a),c=t.get(l);if(o&&a===o.index)return this._createIntlWord(o,c);if(c===0){if(n===2)return this._createWord(e,n,c,this._findStartOfWord(e,t,n,a-1),a);n=1}else if(c===2){if(n===1)return this._createWord(e,n,c,this._findStartOfWord(e,t,n,a-1),a);n=2}else if(c===1&&n!==0)return this._createWord(e,n,c,this._findStartOfWord(e,t,n,a-1),a)}return n!==0?this._createWord(e,n,1,this._findStartOfWord(e,t,n,r-1),r):null}static _findStartOfWord(e,t,i,n){const r=t.findPrevIntlWordBeforeOrAtOffset(e,n);for(let o=n;o>=0;o--){const a=e.charCodeAt(o),l=t.get(a);if(r&&o===r.index)return o;if(l===1||i===1&&l===2||i===2&&l===0)return o+1}return 0}static moveWordLeft(e,t,i,n,r){let o=i.lineNumber,a=i.column;a===1&&o>1&&(o=o-1,a=t.getLineMaxColumn(o));let l=hi._findPreviousWordOnLine(e,t,new X(o,a));if(n===0)return new X(o,l?l.start+1:1);if(n===1)return!r&&l&&l.wordType===2&&l.end-l.start===1&&l.nextCharClass===0&&(l=hi._findPreviousWordOnLine(e,t,new X(o,l.start+1))),new X(o,l?l.start+1:1);if(n===3){for(;l&&l.wordType===2;)l=hi._findPreviousWordOnLine(e,t,new X(o,l.start+1));return new X(o,l?l.start+1:1)}return l&&a<=l.end+1&&(l=hi._findPreviousWordOnLine(e,t,new X(o,l.start+1))),new X(o,l?l.end+1:1)}static _moveWordPartLeft(e,t){const i=t.lineNumber,n=e.getLineMaxColumn(i);if(t.column===1)return i>1?new X(i-1,e.getLineMaxColumn(i-1)):t;const r=e.getLineContent(i);for(let o=t.column-1;o>1;o--){const a=r.charCodeAt(o-2),l=r.charCodeAt(o-1);if(a===95&&l!==95)return new X(i,o);if(a===45&&l!==45)return new X(i,o);if((zp(a)||XT(a))&&sh(l))return new X(i,o);if(sh(a)&&sh(l)&&o+1<n){const c=r.charCodeAt(o);if(zp(c)||XT(c))return new X(i,o)}}return new X(i,1)}static moveWordRight(e,t,i,n){let r=i.lineNumber,o=i.column,a=!1;o===t.getLineMaxColumn(r)&&r<t.getLineCount()&&(a=!0,r=r+1,o=1);let l=hi._findNextWordOnLine(e,t,new X(r,o));if(n===2)l&&l.wordType===2&&l.end-l.start===1&&l.nextCharClass===0&&(l=hi._findNextWordOnLine(e,t,new X(r,l.end+1))),l?o=l.end+1:o=t.getLineMaxColumn(r);else if(n===3){for(a&&(o=0);l&&(l.wordType===2||l.start+1<=o);)l=hi._findNextWordOnLine(e,t,new X(r,l.end+1));l?o=l.start+1:o=t.getLineMaxColumn(r)}else l&&!a&&o>=l.start+1&&(l=hi._findNextWordOnLine(e,t,new X(r,l.end+1))),l?o=l.start+1:o=t.getLineMaxColumn(r);return new X(r,o)}static _moveWordPartRight(e,t){const i=t.lineNumber,n=e.getLineMaxColumn(i);if(t.column===n)return i<e.getLineCount()?new X(i+1,1):t;const r=e.getLineContent(i);for(let o=t.column+1;o<n;o++){const a=r.charCodeAt(o-2),l=r.charCodeAt(o-1);if(a!==95&&l===95)return new X(i,o);if(a!==45&&l===45)return new X(i,o);if((zp(a)||XT(a))&&sh(l))return new X(i,o);if(sh(a)&&sh(l)&&o+1<n){const c=r.charCodeAt(o);if(zp(c)||XT(c))return new X(i,o)}}return new X(i,n)}static _deleteWordLeftWhitespace(e,t){const i=e.getLineContent(t.lineNumber),n=t.column-2,r=nu(i,n);return r+1<n?new F(t.lineNumber,r+2,t.lineNumber,t.column):null}static deleteWordLeft(e,t){const i=e.wordSeparators,n=e.model,r=e.selection,o=e.whitespaceHeuristics;if(!r.isEmpty())return r;if(yw.isAutoClosingPairDelete(e.autoClosingDelete,e.autoClosingBrackets,e.autoClosingQuotes,e.autoClosingPairs.autoClosingPairsOpenByEnd,e.model,[e.selection],e.autoClosedCharacters)){const u=e.selection.getPosition();return new F(u.lineNumber,u.column-1,u.lineNumber,u.column+1)}const a=new X(r.positionLineNumber,r.positionColumn);let l=a.lineNumber,c=a.column;if(l===1&&c===1)return null;if(o){const u=this._deleteWordLeftWhitespace(n,a);if(u)return u}let d=hi._findPreviousWordOnLine(i,n,a);return t===0?d?c=d.start+1:c>1?c=1:(l--,c=n.getLineMaxColumn(l)):(d&&c<=d.end+1&&(d=hi._findPreviousWordOnLine(i,n,new X(l,d.start+1))),d?c=d.end+1:c>1?c=1:(l--,c=n.getLineMaxColumn(l))),new F(l,c,a.lineNumber,a.column)}static deleteInsideWord(e,t,i){if(!i.isEmpty())return i;const n=new X(i.positionLineNumber,i.positionColumn),r=this._deleteInsideWordWhitespace(t,n);return r||this._deleteInsideWordDetermineDeleteRange(e,t,n)}static _charAtIsWhitespace(e,t){const i=e.charCodeAt(t);return i===32||i===9}static _deleteInsideWordWhitespace(e,t){const i=e.getLineContent(t.lineNumber),n=i.length;if(n===0)return null;let r=Math.max(t.column-2,0);if(!this._charAtIsWhitespace(i,r))return null;let o=Math.min(t.column-1,n-1);if(!this._charAtIsWhitespace(i,o))return null;for(;r>0&&this._charAtIsWhitespace(i,r-1);)r--;for(;o+1<n&&this._charAtIsWhitespace(i,o+1);)o++;return new F(t.lineNumber,r+1,t.lineNumber,o+2)}static _deleteInsideWordDetermineDeleteRange(e,t,i){const n=t.getLineContent(i.lineNumber),r=n.length;if(r===0)return i.lineNumber>1?new F(i.lineNumber-1,t.getLineMaxColumn(i.lineNumber-1),i.lineNumber,1):i.lineNumber<t.getLineCount()?new F(i.lineNumber,1,i.lineNumber+1,1):new F(i.lineNumber,1,i.lineNumber,1);const o=u=>u.start+1<=i.column&&i.column<=u.end+1,a=(u,h)=>(u=Math.min(u,i.column),h=Math.max(h,i.column),new F(i.lineNumber,u,i.lineNumber,h)),l=u=>{let h=u.start+1,g=u.end+1,p=!1;for(;g-1<r&&this._charAtIsWhitespace(n,g-1);)p=!0,g++;if(!p)for(;h>1&&this._charAtIsWhitespace(n,h-2);)h--;return a(h,g)},c=hi._findPreviousWordOnLine(e,t,i);if(c&&o(c))return l(c);const d=hi._findNextWordOnLine(e,t,i);return d&&o(d)?l(d):c&&d?a(c.end+1,d.start+1):c?a(c.start+1,c.end+1):d?a(d.start+1,d.end+1):a(1,r+1)}static _deleteWordPartLeft(e,t){if(!t.isEmpty())return t;const i=t.getPosition(),n=hi._moveWordPartLeft(e,i);return new F(i.lineNumber,i.column,n.lineNumber,n.column)}static _findFirstNonWhitespaceChar(e,t){const i=e.length;for(let n=t;n<i;n++){const r=e.charAt(n);if(r!==" "&&r!=="	")return n}return i}static _deleteWordRightWhitespace(e,t){const i=e.getLineContent(t.lineNumber),n=t.column-1,r=this._findFirstNonWhitespaceChar(i,n);return n+1<r?new F(t.lineNumber,t.column,t.lineNumber,r+1):null}static deleteWordRight(e,t){const i=e.wordSeparators,n=e.model,r=e.selection,o=e.whitespaceHeuristics;if(!r.isEmpty())return r;const a=new X(r.positionLineNumber,r.positionColumn);let l=a.lineNumber,c=a.column;const d=n.getLineCount(),u=n.getLineMaxColumn(l);if(l===d&&c===u)return null;if(o){const g=this._deleteWordRightWhitespace(n,a);if(g)return g}let h=hi._findNextWordOnLine(i,n,a);return t===2?h?c=h.end+1:c<u||l===d?c=u:(l++,h=hi._findNextWordOnLine(i,n,new X(l,1)),h?c=h.start+1:c=n.getLineMaxColumn(l)):(h&&c>=h.start+1&&(h=hi._findNextWordOnLine(i,n,new X(l,h.end+1))),h?c=h.start+1:c<u||l===d?c=u:(l++,h=hi._findNextWordOnLine(i,n,new X(l,1)),h?c=h.start+1:c=n.getLineMaxColumn(l))),new F(l,c,a.lineNumber,a.column)}static _deleteWordPartRight(e,t){if(!t.isEmpty())return t;const i=t.getPosition(),n=hi._moveWordPartRight(e,i);return new F(i.lineNumber,i.column,n.lineNumber,n.column)}static _createWordAtPosition(e,t,i){const n=new F(t,i.start+1,t,i.end+1);return{word:e.getValueInRange(n),startColumn:n.startColumn,endColumn:n.endColumn}}static getWordAtPosition(e,t,i,n){const r=wc(t,i),o=hi._findPreviousWordOnLine(r,e,n);if(o&&o.wordType===1&&o.start<=n.column-1&&n.column-1<=o.end)return hi._createWordAtPosition(e,n.lineNumber,o);const a=hi._findNextWordOnLine(r,e,n);return a&&a.wordType===1&&a.start<=n.column-1&&n.column-1<=a.end?hi._createWordAtPosition(e,n.lineNumber,a):null}static word(e,t,i,n,r){const o=wc(e.wordSeparators,e.wordSegmenterLocales),a=hi._findPreviousWordOnLine(o,t,r),l=hi._findNextWordOnLine(o,t,r);if(!n){let g,p;return a&&a.wordType===1&&a.start<=r.column-1&&r.column-1<=a.end?(g=a.start+1,p=a.end+1):l&&l.wordType===1&&l.start<=r.column-1&&r.column-1<=l.end?(g=l.start+1,p=l.end+1):(a?g=a.end+1:g=1,l?p=l.start+1:p=t.getLineMaxColumn(r.lineNumber)),new Ks(new F(r.lineNumber,g,r.lineNumber,p),1,0,new X(r.lineNumber,p),0)}let c,d;a&&a.wordType===1&&a.start<r.column-1&&r.column-1<a.end?(c=a.start+1,d=a.end+1):l&&l.wordType===1&&l.start<r.column-1&&r.column-1<l.end?(c=l.start+1,d=l.end+1):(c=r.column,d=r.column);const u=r.lineNumber;let h;if(i.selectionStart.containsPosition(r))h=i.selectionStart.endColumn;else if(r.isBeforeOrEqual(i.selectionStart.getStartPosition())){h=c;const g=new X(u,h);i.selectionStart.containsPosition(g)&&(h=i.selectionStart.endColumn)}else{h=d;const g=new X(u,h);i.selectionStart.containsPosition(g)&&(h=i.selectionStart.startColumn)}return i.move(!0,u,h,0)}}class i5 extends hi{static deleteWordPartLeft(e){const t=TN([hi.deleteWordLeft(e,0),hi.deleteWordLeft(e,2),hi._deleteWordPartLeft(e.model,e.selection)]);return t.sort(F.compareRangesUsingEnds),t[2]}static deleteWordPartRight(e){const t=TN([hi.deleteWordRight(e,0),hi.deleteWordRight(e,2),hi._deleteWordPartRight(e.model,e.selection)]);return t.sort(F.compareRangesUsingStarts),t[0]}static moveWordPartLeft(e,t,i,n){const r=TN([hi.moveWordLeft(e,t,i,0,n),hi.moveWordLeft(e,t,i,2,n),hi._moveWordPartLeft(t,i)]);return r.sort(X.compare),r[2]}static moveWordPartRight(e,t,i){const n=TN([hi.moveWordRight(e,t,i,0),hi.moveWordRight(e,t,i,2),hi._moveWordPartRight(t,i)]);return n.sort(X.compare),n[0]}}function TN(s){return s.filter(e=>!!e)}class $s{static addCursorDown(e,t,i){const n=[];let r=0;for(let o=0,a=t.length;o<a;o++){const l=t[o];n[r++]=new ti(l.modelState,l.viewState),i?n[r++]=ti.fromModelState(vi.translateDown(e.cursorConfig,e.model,l.modelState)):n[r++]=ti.fromViewState(vi.translateDown(e.cursorConfig,e,l.viewState))}return n}static addCursorUp(e,t,i){const n=[];let r=0;for(let o=0,a=t.length;o<a;o++){const l=t[o];n[r++]=new ti(l.modelState,l.viewState),i?n[r++]=ti.fromModelState(vi.translateUp(e.cursorConfig,e.model,l.modelState)):n[r++]=ti.fromViewState(vi.translateUp(e.cursorConfig,e,l.viewState))}return n}static moveToBeginningOfLine(e,t,i){const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r];n[r]=this._moveToLineStart(e,a,i)}return n}static _moveToLineStart(e,t,i){const n=t.viewState.position.column,r=t.modelState.position.column,o=n===r,a=t.viewState.position.lineNumber,l=e.getLineFirstNonWhitespaceColumn(a);return!o&&!(n===l)?this._moveToLineStartByView(e,t,i):this._moveToLineStartByModel(e,t,i)}static _moveToLineStartByView(e,t,i){return ti.fromViewState(vi.moveToBeginningOfLine(e.cursorConfig,e,t.viewState,i))}static _moveToLineStartByModel(e,t,i){return ti.fromModelState(vi.moveToBeginningOfLine(e.cursorConfig,e.model,t.modelState,i))}static moveToEndOfLine(e,t,i,n){const r=[];for(let o=0,a=t.length;o<a;o++){const l=t[o];r[o]=this._moveToLineEnd(e,l,i,n)}return r}static _moveToLineEnd(e,t,i,n){const r=t.viewState.position,o=e.getLineMaxColumn(r.lineNumber),a=r.column===o,l=t.modelState.position,c=e.model.getLineMaxColumn(l.lineNumber),d=o-r.column===c-l.column;return a||d?this._moveToLineEndByModel(e,t,i,n):this._moveToLineEndByView(e,t,i,n)}static _moveToLineEndByView(e,t,i,n){return ti.fromViewState(vi.moveToEndOfLine(e.cursorConfig,e,t.viewState,i,n))}static _moveToLineEndByModel(e,t,i,n){return ti.fromModelState(vi.moveToEndOfLine(e.cursorConfig,e.model,t.modelState,i,n))}static expandLineSelection(e,t){const i=[];for(let n=0,r=t.length;n<r;n++){const o=t[n],a=o.modelState.selection.startLineNumber,l=e.model.getLineCount();let c=o.modelState.selection.endLineNumber,d;c===l?d=e.model.getLineMaxColumn(l):(c++,d=1),i[n]=ti.fromModelState(new Ks(new F(a,1,a,1),0,0,new X(c,d),0))}return i}static moveToBeginningOfBuffer(e,t,i){const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r];n[r]=ti.fromModelState(vi.moveToBeginningOfBuffer(e.cursorConfig,e.model,a.modelState,i))}return n}static moveToEndOfBuffer(e,t,i){const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r];n[r]=ti.fromModelState(vi.moveToEndOfBuffer(e.cursorConfig,e.model,a.modelState,i))}return n}static selectAll(e,t){const i=e.model.getLineCount(),n=e.model.getLineMaxColumn(i);return ti.fromModelState(new Ks(new F(1,1,1,1),0,0,new X(i,n),0))}static line(e,t,i,n,r){const o=e.model.validatePosition(n),a=r?e.coordinatesConverter.validateViewPosition(new X(r.lineNumber,r.column),o):e.coordinatesConverter.convertModelPositionToViewPosition(o);if(!i){const c=e.model.getLineCount();let d=o.lineNumber+1,u=1;return d>c&&(d=c,u=e.model.getLineMaxColumn(d)),ti.fromModelState(new Ks(new F(o.lineNumber,1,d,u),2,0,new X(d,u),0))}const l=t.modelState.selectionStart.getStartPosition().lineNumber;if(o.lineNumber<l)return ti.fromViewState(t.viewState.move(!0,a.lineNumber,1,0));if(o.lineNumber>l){const c=e.getLineCount();let d=a.lineNumber+1,u=1;return d>c&&(d=c,u=e.getLineMaxColumn(d)),ti.fromViewState(t.viewState.move(!0,d,u,0))}else{const c=t.modelState.selectionStart.getEndPosition();return ti.fromModelState(t.modelState.move(!0,c.lineNumber,c.column,0))}}static word(e,t,i,n){const r=e.model.validatePosition(n);return ti.fromModelState(hi.word(e.cursorConfig,e.model,t.modelState,i,r))}static cancelSelection(e,t){if(!t.modelState.hasSelection())return new ti(t.modelState,t.viewState);const i=t.viewState.position.lineNumber,n=t.viewState.position.column;return ti.fromViewState(new Ks(new F(i,n,i,n),0,0,new X(i,n),0))}static moveTo(e,t,i,n,r){if(i){if(t.modelState.selectionStartKind===1)return this.word(e,t,i,n);if(t.modelState.selectionStartKind===2)return this.line(e,t,i,n,r)}const o=e.model.validatePosition(n),a=r?e.coordinatesConverter.validateViewPosition(new X(r.lineNumber,r.column),o):e.coordinatesConverter.convertModelPositionToViewPosition(o);return ti.fromViewState(t.viewState.move(i,a.lineNumber,a.column,0))}static simpleMove(e,t,i,n,r,o){switch(i){case 0:return o===4?this._moveHalfLineLeft(e,t,n):this._moveLeft(e,t,n,r);case 1:return o===4?this._moveHalfLineRight(e,t,n):this._moveRight(e,t,n,r);case 2:return o===2?this._moveUpByViewLines(e,t,n,r):this._moveUpByModelLines(e,t,n,r);case 3:return o===2?this._moveDownByViewLines(e,t,n,r):this._moveDownByModelLines(e,t,n,r);case 4:return o===2?t.map(a=>ti.fromViewState(vi.moveToPrevBlankLine(e.cursorConfig,e,a.viewState,n))):t.map(a=>ti.fromModelState(vi.moveToPrevBlankLine(e.cursorConfig,e.model,a.modelState,n)));case 5:return o===2?t.map(a=>ti.fromViewState(vi.moveToNextBlankLine(e.cursorConfig,e,a.viewState,n))):t.map(a=>ti.fromModelState(vi.moveToNextBlankLine(e.cursorConfig,e.model,a.modelState,n)));case 6:return this._moveToViewMinColumn(e,t,n);case 7:return this._moveToViewFirstNonWhitespaceColumn(e,t,n);case 8:return this._moveToViewCenterColumn(e,t,n);case 9:return this._moveToViewMaxColumn(e,t,n);case 10:return this._moveToViewLastNonWhitespaceColumn(e,t,n);default:return null}}static viewportMove(e,t,i,n,r){const o=e.getCompletelyVisibleViewRange(),a=e.coordinatesConverter.convertViewRangeToModelRange(o);switch(i){case 11:{const l=this._firstLineNumberInRange(e.model,a,r),c=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],n,l,c)]}case 13:{const l=this._lastLineNumberInRange(e.model,a,r),c=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],n,l,c)]}case 12:{const l=Math.round((a.startLineNumber+a.endLineNumber)/2),c=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],n,l,c)]}case 14:{const l=[];for(let c=0,d=t.length;c<d;c++){const u=t[c];l[c]=this.findPositionInViewportIfOutside(e,u,o,n)}return l}default:return null}}static findPositionInViewportIfOutside(e,t,i,n){const r=t.viewState.position.lineNumber;if(i.startLineNumber<=r&&r<=i.endLineNumber-1)return new ti(t.modelState,t.viewState);{let o;r>i.endLineNumber-1?o=i.endLineNumber-1:r<i.startLineNumber?o=i.startLineNumber:o=r;const a=vi.vertical(e.cursorConfig,e,r,t.viewState.position.column,t.viewState.leftoverVisibleColumns,o,!1);return ti.fromViewState(t.viewState.move(n,a.lineNumber,a.column,a.leftoverVisibleColumns))}}static _firstLineNumberInRange(e,t,i){let n=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(n)&&n++,Math.min(t.endLineNumber,n+i-1)}static _lastLineNumberInRange(e,t,i){let n=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(n)&&n++,Math.max(n,t.endLineNumber-i+1)}static _moveLeft(e,t,i,n){return t.map(r=>ti.fromViewState(vi.moveLeft(e.cursorConfig,e,r.viewState,i,n)))}static _moveHalfLineLeft(e,t,i){const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=a.viewState.position.lineNumber,c=Math.round(e.getLineLength(l)/2);n[r]=ti.fromViewState(vi.moveLeft(e.cursorConfig,e,a.viewState,i,c))}return n}static _moveRight(e,t,i,n){return t.map(r=>ti.fromViewState(vi.moveRight(e.cursorConfig,e,r.viewState,i,n)))}static _moveHalfLineRight(e,t,i){const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=a.viewState.position.lineNumber,c=Math.round(e.getLineLength(l)/2);n[r]=ti.fromViewState(vi.moveRight(e.cursorConfig,e,a.viewState,i,c))}return n}static _moveDownByViewLines(e,t,i,n){const r=[];for(let o=0,a=t.length;o<a;o++){const l=t[o];r[o]=ti.fromViewState(vi.moveDown(e.cursorConfig,e,l.viewState,i,n))}return r}static _moveDownByModelLines(e,t,i,n){const r=[];for(let o=0,a=t.length;o<a;o++){const l=t[o];r[o]=ti.fromModelState(vi.moveDown(e.cursorConfig,e.model,l.modelState,i,n))}return r}static _moveUpByViewLines(e,t,i,n){const r=[];for(let o=0,a=t.length;o<a;o++){const l=t[o];r[o]=ti.fromViewState(vi.moveUp(e.cursorConfig,e,l.viewState,i,n))}return r}static _moveUpByModelLines(e,t,i,n){const r=[];for(let o=0,a=t.length;o<a;o++){const l=t[o];r[o]=ti.fromModelState(vi.moveUp(e.cursorConfig,e.model,l.modelState,i,n))}return r}static _moveToViewPosition(e,t,i,n,r){return ti.fromViewState(t.viewState.move(i,n,r,0))}static _moveToModelPosition(e,t,i,n,r){return ti.fromModelState(t.modelState.move(i,n,r,0))}static _moveToViewMinColumn(e,t,i){const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=a.viewState.position.lineNumber,c=e.getLineMinColumn(l);n[r]=this._moveToViewPosition(e,a,i,l,c)}return n}static _moveToViewFirstNonWhitespaceColumn(e,t,i){const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=a.viewState.position.lineNumber,c=e.getLineFirstNonWhitespaceColumn(l);n[r]=this._moveToViewPosition(e,a,i,l,c)}return n}static _moveToViewCenterColumn(e,t,i){const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=a.viewState.position.lineNumber,c=Math.round((e.getLineMaxColumn(l)+e.getLineMinColumn(l))/2);n[r]=this._moveToViewPosition(e,a,i,l,c)}return n}static _moveToViewMaxColumn(e,t,i){const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=a.viewState.position.lineNumber,c=e.getLineMaxColumn(l);n[r]=this._moveToViewPosition(e,a,i,l,c)}return n}static _moveToViewLastNonWhitespaceColumn(e,t,i){const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=a.viewState.position.lineNumber,c=e.getLineLastNonWhitespaceColumn(l);n[r]=this._moveToViewPosition(e,a,i,l,c)}return n}}var cP;(function(s){const e=function(i){if(!Ms(i))return!1;const n=i;return!(!Zo(n.to)||!Yr(n.select)&&!Yde(n.select)||!Yr(n.by)&&!Zo(n.by)||!Yr(n.value)&&!Vm(n.value))};s.metadata={description:"Move cursor to a logical position in the view",args:[{name:"Cursor move argument object",description:`Property-value pairs that can be passed through this argument:
					* 'to': A mandatory logical position value providing where to move the cursor.
						\`\`\`
						'left', 'right', 'up', 'down', 'prevBlankLine', 'nextBlankLine',
						'wrappedLineStart', 'wrappedLineEnd', 'wrappedLineColumnCenter'
						'wrappedLineFirstNonWhitespaceCharacter', 'wrappedLineLastNonWhitespaceCharacter'
						'viewPortTop', 'viewPortCenter', 'viewPortBottom', 'viewPortIfOutside'
						\`\`\`
					* 'by': Unit to move. Default is computed based on 'to' value.
						\`\`\`
						'line', 'wrappedLine', 'character', 'halfLine'
						\`\`\`
					* 'value': Number of units to move. Default is '1'.
					* 'select': If 'true' makes the selection. Default is 'false'.
				`,constraint:e,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["left","right","up","down","prevBlankLine","nextBlankLine","wrappedLineStart","wrappedLineEnd","wrappedLineColumnCenter","wrappedLineFirstNonWhitespaceCharacter","wrappedLineLastNonWhitespaceCharacter","viewPortTop","viewPortCenter","viewPortBottom","viewPortIfOutside"]},by:{type:"string",enum:["line","wrappedLine","character","halfLine"]},value:{type:"number",default:1},select:{type:"boolean",default:!1}}}}]},s.RawDirection={Left:"left",Right:"right",Up:"up",Down:"down",PrevBlankLine:"prevBlankLine",NextBlankLine:"nextBlankLine",WrappedLineStart:"wrappedLineStart",WrappedLineFirstNonWhitespaceCharacter:"wrappedLineFirstNonWhitespaceCharacter",WrappedLineColumnCenter:"wrappedLineColumnCenter",WrappedLineEnd:"wrappedLineEnd",WrappedLineLastNonWhitespaceCharacter:"wrappedLineLastNonWhitespaceCharacter",ViewPortTop:"viewPortTop",ViewPortCenter:"viewPortCenter",ViewPortBottom:"viewPortBottom",ViewPortIfOutside:"viewPortIfOutside"},s.RawUnit={Line:"line",WrappedLine:"wrappedLine",Character:"character",HalfLine:"halfLine"};function t(i){if(!i.to)return null;let n;switch(i.to){case s.RawDirection.Left:n=0;break;case s.RawDirection.Right:n=1;break;case s.RawDirection.Up:n=2;break;case s.RawDirection.Down:n=3;break;case s.RawDirection.PrevBlankLine:n=4;break;case s.RawDirection.NextBlankLine:n=5;break;case s.RawDirection.WrappedLineStart:n=6;break;case s.RawDirection.WrappedLineFirstNonWhitespaceCharacter:n=7;break;case s.RawDirection.WrappedLineColumnCenter:n=8;break;case s.RawDirection.WrappedLineEnd:n=9;break;case s.RawDirection.WrappedLineLastNonWhitespaceCharacter:n=10;break;case s.RawDirection.ViewPortTop:n=11;break;case s.RawDirection.ViewPortBottom:n=13;break;case s.RawDirection.ViewPortCenter:n=12;break;case s.RawDirection.ViewPortIfOutside:n=14;break;default:return null}let r=0;switch(i.by){case s.RawUnit.Line:r=1;break;case s.RawUnit.WrappedLine:r=2;break;case s.RawUnit.Character:r=3;break;case s.RawUnit.HalfLine:r=4;break}return{direction:n,unit:r,select:!!i.select,value:i.value||1}}s.parse=t})(cP||(cP={}));class LG{constructor(e,t,i){this._indentRulesSupport=t,this._indentationLineProcessor=new Gpe(e,i)}shouldIncrease(e,t){const i=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIncrease(i)}shouldDecrease(e,t){const i=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldDecrease(i)}shouldIgnore(e,t){const i=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIgnore(i)}shouldIndentNextLine(e,t){const i=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIndentNextLine(i)}}class kG{constructor(e,t){this.model=e,this.indentationLineProcessor=new Gpe(e,t)}getProcessedTokenContextAroundRange(e){const t=this._getProcessedTokensBeforeRange(e),i=this._getProcessedTokensAfterRange(e),n=this._getProcessedPreviousLineTokens(e);return{beforeRangeProcessedTokens:t,afterRangeProcessedTokens:i,previousLineProcessedTokens:n}}_getProcessedTokensBeforeRange(e){this.model.tokenization.forceTokenization(e.startLineNumber);const t=this.model.tokenization.getLineTokens(e.startLineNumber),i=Vb(t,e.startColumn-1);let n;if(IG(this.model,e.getStartPosition())){const o=e.startColumn-1-i.firstCharOffset,a=i.firstCharOffset,l=a+o;n=t.sliceAndInflate(a,l,0)}else{const o=e.startColumn-1;n=t.sliceAndInflate(0,o,0)}return this.indentationLineProcessor.getProcessedTokens(n)}_getProcessedTokensAfterRange(e){const t=e.isEmpty()?e.getStartPosition():e.getEndPosition();this.model.tokenization.forceTokenization(t.lineNumber);const i=this.model.tokenization.getLineTokens(t.lineNumber),n=Vb(i,t.column-1),r=t.column-1-n.firstCharOffset,o=n.firstCharOffset+r,a=n.firstCharOffset+n.getLineLength(),l=i.sliceAndInflate(o,a,0);return this.indentationLineProcessor.getProcessedTokens(l)}_getProcessedPreviousLineTokens(e){const t=g=>{this.model.tokenization.forceTokenization(g);const p=this.model.tokenization.getLineTokens(g),_=this.model.getLineMaxColumn(g)-1;return Vb(p,_)};this.model.tokenization.forceTokenization(e.startLineNumber);const i=this.model.tokenization.getLineTokens(e.startLineNumber),n=Vb(i,e.startColumn-1),r=Ws.createEmpty("",n.languageIdCodec),o=e.startLineNumber-1;if(o===0||!(n.firstCharOffset===0))return r;const c=t(o);if(!(n.languageId===c.languageId))return r;const u=c.toIViewLineTokens();return this.indentationLineProcessor.getProcessedTokens(u)}}class Gpe{constructor(e,t){this.model=e,this.languageConfigurationService=t}getProcessedLine(e,t){var o,a;const i=(l,c)=>{const d=Ti(l);return c+l.substring(d.length)};(a=(o=this.model.tokenization).forceTokenization)==null||a.call(o,e);const n=this.model.tokenization.getLineTokens(e);let r=this.getProcessedTokens(n).getLineContent();return t!==void 0&&(r=i(r,t)),r}getProcessedTokens(e){const t=l=>l===2||l===3||l===1,i=e.getLanguageId(0),r=this.languageConfigurationService.getLanguageConfiguration(i).bracketsNew.getBracketRegExp({global:!0}),o=[];return e.forEach(l=>{const c=e.getStandardTokenType(l);let d=e.getTokenText(l);t(c)&&(d=d.replace(r,""));const u=e.getMetadata(l);o.push({text:d,metadata:u})}),Ws.createFromTextAndMetadata(o,e.languageIdCodec)}}function IG(s,e){s.tokenization.forceTokenization(e.lineNumber);const t=s.tokenization.getLineTokens(e.lineNumber),i=Vb(t,e.column-1),n=i.firstCharOffset===0,r=t.getLanguageId(0)===i.languageId;return!n&&!r}function Ry(s,e,t,i){e.tokenization.forceTokenization(t.startLineNumber);const n=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),r=i.getLanguageConfiguration(n);if(!r)return null;const a=new kG(e,i).getProcessedTokenContextAroundRange(t),l=a.previousLineProcessedTokens.getLineContent(),c=a.beforeRangeProcessedTokens.getLineContent(),d=a.afterRangeProcessedTokens.getLineContent(),u=r.onEnter(s,l,c,d);if(!u)return null;const h=u.indentAction;let g=u.appendText;const p=u.removeText||0;g?h===is.Indent&&(g="	"+g):h===is.Indent||h===is.IndentOutdent?g="	":g="";let _=Dhe(e,t.startLineNumber,t.startColumn);return p&&(_=_.substring(0,_.length-p)),{indentAction:h,appendText:g,removeText:p,indentation:_}}var AHe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},PHe=function(s,e){return function(t,i){e(t,i,s)}},jR;const oB=Object.create(null);function Q_(s,e){if(e<=0)return"";oB[s]||(oB[s]=["",s]);const t=oB[s];for(let i=t.length;i<=e;i++)t[i]=t[i-1]+s;return t[e]}let yc=jR=class{static unshiftIndent(e,t,i,n,r){const o=hs.visibleColumnFromColumn(e,t,i);if(r){const a=Q_(" ",n),c=hs.prevIndentTabStop(o,n)/n;return Q_(a,c)}else{const a="	",c=hs.prevRenderTabStop(o,i)/i;return Q_(a,c)}}static shiftIndent(e,t,i,n,r){const o=hs.visibleColumnFromColumn(e,t,i);if(r){const a=Q_(" ",n),c=hs.nextIndentTabStop(o,n)/n;return Q_(a,c)}else{const a="	",c=hs.nextRenderTabStop(o,i)/i;return Q_(a,c)}}constructor(e,t,i){this._languageConfigurationService=i,this._opts=t,this._selection=e,this._selectionId=null,this._useLastEditRangeForCursorEndPosition=!1,this._selectionStartColumnStaysPut=!1}_addEditOperation(e,t,i){this._useLastEditRangeForCursorEndPosition?e.addTrackedEditOperation(t,i):e.addEditOperation(t,i)}getEditOperations(e,t){const i=this._selection.startLineNumber;let n=this._selection.endLineNumber;this._selection.endColumn===1&&i!==n&&(n=n-1);const{tabSize:r,indentSize:o,insertSpaces:a}=this._opts,l=i===n;if(this._opts.useTabStops){this._selection.isEmpty()&&/^\s*$/.test(e.getLineContent(i))&&(this._useLastEditRangeForCursorEndPosition=!0);let c=0,d=0;for(let u=i;u<=n;u++,c=d){d=0;const h=e.getLineContent(u);let g=Zr(h);if(this._opts.isUnshift&&(h.length===0||g===0)||!l&&!this._opts.isUnshift&&h.length===0)continue;if(g===-1&&(g=h.length),u>1&&hs.visibleColumnFromColumn(h,g+1,r)%o!==0&&e.tokenization.isCheapToTokenize(u-1)){const v=Ry(this._opts.autoIndent,e,new F(u-1,e.getLineMaxColumn(u-1),u-1,e.getLineMaxColumn(u-1)),this._languageConfigurationService);if(v){if(d=c,v.appendText)for(let C=0,y=v.appendText.length;C<y&&d<o&&v.appendText.charCodeAt(C)===32;C++)d++;v.removeText&&(d=Math.max(0,d-v.removeText));for(let C=0;C<d&&!(g===0||h.charCodeAt(g-1)!==32);C++)g--}}if(this._opts.isUnshift&&g===0)continue;let p;this._opts.isUnshift?p=jR.unshiftIndent(h,g+1,r,o,a):p=jR.shiftIndent(h,g+1,r,o,a),this._addEditOperation(t,new F(u,1,u,g+1),p),u===i&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn<=g+1)}}else{!this._opts.isUnshift&&this._selection.isEmpty()&&e.getLineLength(i)===0&&(this._useLastEditRangeForCursorEndPosition=!0);const c=a?Q_(" ",o):"	";for(let d=i;d<=n;d++){const u=e.getLineContent(d);let h=Zr(u);if(!(this._opts.isUnshift&&(u.length===0||h===0))&&!(!l&&!this._opts.isUnshift&&u.length===0)&&(h===-1&&(h=u.length),!(this._opts.isUnshift&&h===0)))if(this._opts.isUnshift){h=Math.min(h,o);for(let g=0;g<h;g++)if(u.charCodeAt(g)===9){h=g+1;break}this._addEditOperation(t,new F(d,1,d,h+1),"")}else this._addEditOperation(t,new F(d,1,d,1),c),d===i&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn===1)}}this._selectionId=t.trackSelection(this._selection)}computeCursorState(e,t){if(this._useLastEditRangeForCursorEndPosition){const n=t.getInverseEditOperations()[0];return new Ue(n.range.endLineNumber,n.range.endColumn,n.range.endLineNumber,n.range.endColumn)}const i=t.getTrackedSelection(this._selectionId);if(this._selectionStartColumnStaysPut){const n=this._selection.startColumn;return i.startColumn<=n?i:i.getDirection()===0?new Ue(i.startLineNumber,n,i.endLineNumber,i.endColumn):new Ue(i.endLineNumber,i.endColumn,i.startLineNumber,n)}return i}};yc=jR=AHe([PHe(2,bn)],yc);class MHe{constructor(e,t,i){this._range=e,this._charBeforeSelection=t,this._charAfterSelection=i}getEditOperations(e,t){t.addTrackedEditOperation(new F(this._range.startLineNumber,this._range.startColumn,this._range.startLineNumber,this._range.startColumn),this._charBeforeSelection),t.addTrackedEditOperation(new F(this._range.endLineNumber,this._range.endColumn,this._range.endLineNumber,this._range.endColumn),this._charAfterSelection)}computeCursorState(e,t){const i=t.getInverseEditOperations(),n=i[0].range,r=i[1].range;return new Ue(n.endLineNumber,n.endColumn,r.endLineNumber,r.endColumn-this._charAfterSelection.length)}}class OHe{constructor(e,t,i){this._position=e,this._text=t,this._charAfter=i}getEditOperations(e,t){t.addTrackedEditOperation(new F(this._position.lineNumber,this._position.column,this._position.lineNumber,this._position.column),this._text+this._charAfter)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return new Ue(n.endLineNumber,n.startColumn,n.endLineNumber,n.endColumn-this._charAfter.length)}}function FHe(s,e,t){const i=s.tokenization.getLanguageIdAtPosition(e,0);if(e>1){let n,r=-1;for(n=e-1;n>=1;n--){if(s.tokenization.getLanguageIdAtPosition(n,0)!==i)return r;const o=s.getLineContent(n);if(t.shouldIgnore(n)||/^\s+$/.test(o)||o===""){r=n;continue}return n}}return-1}function zI(s,e,t,i=!0,n){if(s<4)return null;const r=n.getLanguageConfiguration(e.tokenization.getLanguageId()).indentRulesSupport;if(!r)return null;const o=new LG(e,r,n);if(t<=1)return{indentation:"",action:null};for(let l=t-1;l>0&&e.getLineContent(l)==="";l--)if(l===1)return{indentation:"",action:null};const a=FHe(e,t,o);if(a<0)return null;if(a<1)return{indentation:"",action:null};if(o.shouldIncrease(a)||o.shouldIndentNextLine(a)){const l=e.getLineContent(a);return{indentation:Ti(l),action:is.Indent,line:a}}else if(o.shouldDecrease(a)){const l=e.getLineContent(a);return{indentation:Ti(l),action:null,line:a}}else{if(a===1)return{indentation:Ti(e.getLineContent(a)),action:null,line:a};const l=a-1,c=r.getIndentMetadata(e.getLineContent(l));if(!(c&3)&&c&4){let d=0;for(let u=l-1;u>0;u--)if(!o.shouldIndentNextLine(u)){d=u;break}return{indentation:Ti(e.getLineContent(d+1)),action:null,line:d+1}}if(i)return{indentation:Ti(e.getLineContent(a)),action:null,line:a};for(let d=a;d>0;d--){if(o.shouldIncrease(d))return{indentation:Ti(e.getLineContent(d)),action:is.Indent,line:d};if(o.shouldIndentNextLine(d)){let u=0;for(let h=d-1;h>0;h--)if(!o.shouldIndentNextLine(d)){u=h;break}return{indentation:Ti(e.getLineContent(u+1)),action:null,line:u+1}}else if(o.shouldDecrease(d))return{indentation:Ti(e.getLineContent(d)),action:null,line:d}}return{indentation:Ti(e.getLineContent(1)),action:null,line:1}}}function QL(s,e,t,i,n,r){if(s<4)return null;const o=r.getLanguageConfiguration(t);if(!o)return null;const a=r.getLanguageConfiguration(t).indentRulesSupport;if(!a)return null;const l=new LG(e,a,r),c=zI(s,e,i,void 0,r);if(c){const d=c.line;if(d!==void 0){let u=!0;for(let h=d;h<i-1;h++)if(!/^\s*$/.test(e.getLineContent(h))){u=!1;break}if(u){const h=o.onEnter(s,"",e.getLineContent(d),"");if(h){let g=Ti(e.getLineContent(d));return h.removeText&&(g=g.substring(0,g.length-h.removeText)),h.indentAction===is.Indent||h.indentAction===is.IndentOutdent?g=n.shiftIndent(g):h.indentAction===is.Outdent&&(g=n.unshiftIndent(g)),l.shouldDecrease(i)&&(g=n.unshiftIndent(g)),h.appendText&&(g+=h.appendText),Ti(g)}}}return l.shouldDecrease(i)?c.action===is.Indent?c.indentation:n.unshiftIndent(c.indentation):c.action===is.Indent?n.shiftIndent(c.indentation):c.indentation}return null}function VHe(s,e,t,i,n){if(s<4)return null;const r=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),o=n.getLanguageConfiguration(r).indentRulesSupport;if(!o)return null;e.tokenization.forceTokenization(t.startLineNumber);const l=new kG(e,n).getProcessedTokenContextAroundRange(t),c=l.afterRangeProcessedTokens,d=l.beforeRangeProcessedTokens,u=Ti(d.getLineContent()),h=WHe(e,t.startLineNumber,d),g=IG(e,t.getStartPosition()),p=e.getLineContent(t.startLineNumber),_=Ti(p),v=zI(s,h,t.startLineNumber+1,void 0,n);if(!v){const y=g?_:u;return{beforeEnter:y,afterEnter:y}}let C=g?_:v.indentation;return v.action===is.Indent&&(C=i.shiftIndent(C)),o.shouldDecrease(c.getLineContent())&&(C=i.unshiftIndent(C)),{beforeEnter:g?_:u,afterEnter:C}}function BHe(s,e,t,i,n,r){const o=s.autoIndent;if(o<4||IG(e,t.getStartPosition()))return null;const l=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),c=r.getLanguageConfiguration(l).indentRulesSupport;if(!c)return null;const u=new kG(e,r).getProcessedTokenContextAroundRange(t),h=u.beforeRangeProcessedTokens.getLineContent(),g=u.afterRangeProcessedTokens.getLineContent(),p=h+g,_=h+i+g;if(!c.shouldDecrease(p)&&c.shouldDecrease(_)){const C=zI(o,e,t.startLineNumber,!1,r);if(!C)return null;let y=C.indentation;return C.action!==is.Indent&&(y=n.unshiftIndent(y)),y}const v=t.startLineNumber-1;if(v>0){const C=e.getLineContent(v);if(c.shouldIndentNextLine(C)&&c.shouldIncrease(_)){const y=zI(o,e,t.startLineNumber,!1,r),x=y==null?void 0:y.indentation;if(x!==void 0){const L=e.getLineContent(t.startLineNumber),I=Ti(L),D=n.shiftIndent(x)===I,N=/^\s*$/.test(p),R=s.autoClosingPairs.autoClosingPairsOpenByEnd.get(i),H=R&&R.length>0&&N;if(D&&H)return x}}}return null}function Qpe(s,e,t){const i=t.getLanguageConfiguration(s.getLanguageId()).indentRulesSupport;return!i||e<1||e>s.getLineCount()?null:i.getIndentMetadata(s.getLineContent(e))}function WHe(s,e,t){return{tokenization:{getLineTokens:n=>n===e?t:s.tokenization.getLineTokens(n),getLanguageId:()=>s.getLanguageId(),getLanguageIdAtPosition:(n,r)=>s.getLanguageIdAtPosition(n,r)},getLineContent:n=>n===e?t.getLineContent():s.getLineContent(n)}}class HHe{static getEdits(e,t,i,n,r){if(!r&&this._isAutoIndentType(e,t,i)){const o=[];for(const l of i){const c=this._findActualIndentationForSelection(e,t,l,n);if(c===null)return;o.push({selection:l,indentation:c})}const a=RH.getAutoClosingPairClose(e,t,i,n,!1);return this._getIndentationAndAutoClosingPairEdits(e,t,o,n,a)}}static _isAutoIndentType(e,t,i){if(e.autoIndent<4)return!1;for(let n=0,r=i.length;n<r;n++)if(!t.tokenization.isCheapToTokenize(i[n].getEndPosition().lineNumber))return!1;return!0}static _findActualIndentationForSelection(e,t,i,n){const r=BHe(e,t,i,n,{shiftIndent:a=>TG(e,a),unshiftIndent:a=>dP(e,a)},e.languageConfigurationService);if(r===null)return null;const o=Dhe(t,i.startLineNumber,i.startColumn);return r===e.normalizeIndentation(o)?null:r}static _getIndentationAndAutoClosingPairEdits(e,t,i,n,r){const o=i.map(({selection:l,indentation:c})=>{if(r!==null){const d=this._getEditFromIndentationAndSelection(e,t,c,l,n,!1);return new ZHe(d,l,n,r)}else{const d=this._getEditFromIndentationAndSelection(e,t,c,l,n,!0);return cb(d.range,d.text,!1)}}),a={shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1};return new na(4,o,a)}static _getEditFromIndentationAndSelection(e,t,i,n,r,o=!0){const a=n.startLineNumber,l=t.getLineFirstNonWhitespaceColumn(a);let c=e.normalizeIndentation(i);if(l!==0){const u=t.getLineContent(a);c+=u.substring(l-1,n.startColumn-1)}return c+=o?r:"",{range:new F(a,1,n.endLineNumber,n.endColumn),text:c}}}class zHe{static getEdits(e,t,i,n,r,o){if(Ype(t,i,n,r,o))return this._runAutoClosingOvertype(e,n,o)}static _runAutoClosingOvertype(e,t,i){const n=[];for(let r=0,o=t.length;r<o;r++){const l=t[r].getPosition(),c=new F(l.lineNumber,l.column,l.lineNumber,l.column+1);n[r]=new dr(c,i)}return new na(4,n,{shouldPushStackElementBefore:s5(e,4),shouldPushStackElementAfter:!1})}}class UHe{static getEdits(e,t,i,n,r){if(Ype(e,t,i,n,r)){const o=i.map(a=>new dr(new F(a.positionLineNumber,a.positionColumn,a.positionLineNumber,a.positionColumn+1),"",!1));return new na(4,o,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}}class RH{static getEdits(e,t,i,n,r,o){if(!o){const a=this.getAutoClosingPairClose(e,t,i,n,r);if(a!==null)return this._runAutoClosingOpenCharType(i,n,r,a)}}static _runAutoClosingOpenCharType(e,t,i,n){const r=[];for(let o=0,a=e.length;o<a;o++){const l=e[o];r[o]=new XHe(l,t,!i,n)}return new na(4,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}static getAutoClosingPairClose(e,t,i,n,r){for(const p of i)if(!p.isEmpty())return null;const o=i.map(p=>{const _=p.getPosition();return r?{lineNumber:_.lineNumber,beforeColumn:_.column-n.length,afterColumn:_.column}:{lineNumber:_.lineNumber,beforeColumn:_.column,afterColumn:_.column}}),a=this._findAutoClosingPairOpen(e,t,o.map(p=>new X(p.lineNumber,p.beforeColumn)),n);if(!a)return null;let l,c;if(e_(n)?(l=e.autoClosingQuotes,c=e.shouldAutoCloseBefore.quote):(e.blockCommentStartToken?a.open.includes(e.blockCommentStartToken):!1)?(l=e.autoClosingComments,c=e.shouldAutoCloseBefore.comment):(l=e.autoClosingBrackets,c=e.shouldAutoCloseBefore.bracket),l==="never")return null;const u=this._findContainedAutoClosingPair(e,a),h=u?u.close:"";let g=!0;for(const p of o){const{lineNumber:_,beforeColumn:v,afterColumn:C}=p,y=t.getLineContent(_),x=y.substring(0,v-1),L=y.substring(C-1);if(L.startsWith(h)||(g=!1),L.length>0){const N=L.charAt(0);if(!this._isBeforeClosingBrace(e,L)&&!c(N))return null}if(a.open.length===1&&(n==="'"||n==='"')&&l!=="always"){const N=wc(e.wordSeparators,[]);if(x.length>0){const R=x.charCodeAt(x.length-1);if(N.get(R)===0)return null}}if(!t.tokenization.isCheapToTokenize(_))return null;t.tokenization.forceTokenization(_);const I=t.tokenization.getLineTokens(_),A=Vb(I,v-1);if(!a.shouldAutoClose(A,v-A.firstCharOffset))return null;const D=a.findNeutralCharacter();if(D){const N=t.tokenization.getTokenTypeIfInsertingCharacter(_,v,D);if(!a.isOK(N))return null}}return g?a.close.substring(0,a.close.length-h.length):a.close}static _findContainedAutoClosingPair(e,t){if(t.open.length<=1)return null;const i=t.close.charAt(t.close.length-1),n=e.autoClosingPairs.autoClosingPairsCloseByEnd.get(i)||[];let r=null;for(const o of n)o.open!==t.open&&t.open.includes(o.open)&&t.close.endsWith(o.close)&&(!r||o.open.length>r.open.length)&&(r=o);return r}static _findAutoClosingPairOpen(e,t,i,n){const r=e.autoClosingPairs.autoClosingPairsOpenByEnd.get(n);if(!r)return null;let o=null;for(const a of r)if(o===null||a.open.length>o.open.length){let l=!0;for(const c of i)if(t.getValueInRange(new F(c.lineNumber,c.column-a.open.length+1,c.lineNumber,c.column))+n!==a.open){l=!1;break}l&&(o=a)}return o}static _isBeforeClosingBrace(e,t){const i=t.charAt(0),n=e.autoClosingPairs.autoClosingPairsOpenByStart.get(i)||[],r=e.autoClosingPairs.autoClosingPairsCloseByStart.get(i)||[],o=n.some(l=>t.startsWith(l.open)),a=r.some(l=>t.startsWith(l.close));return!o&&a}}class jHe{static getEdits(e,t,i,n,r){if(!r&&this._isSurroundSelectionType(e,t,i,n))return this._runSurroundSelectionType(e,i,n)}static _runSurroundSelectionType(e,t,i){const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=e.surroundingPairs[i];n[r]=new MHe(a,i,l)}return new na(0,n,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _isSurroundSelectionType(e,t,i,n){if(!Xpe(e,n)||!e.surroundingPairs.hasOwnProperty(n))return!1;const r=e_(n);for(const o of i){if(o.isEmpty())return!1;let a=!0;for(let l=o.startLineNumber;l<=o.endLineNumber;l++){const c=t.getLineContent(l),d=l===o.startLineNumber?o.startColumn-1:0,u=l===o.endLineNumber?o.endColumn-1:c.length,h=c.substring(d,u);if(/[^ \t]/.test(h)){a=!1;break}}if(a)return!1;if(r&&o.startLineNumber===o.endLineNumber&&o.startColumn+1===o.endColumn){const l=t.getValueInRange(o);if(e_(l))return!1}}return!0}}class $He{static getEdits(e,t,i,n,r,o){if(!o&&this._isTypeInterceptorElectricChar(t,i,n)){const a=this._typeInterceptorElectricChar(e,t,i,n[0],r);if(a)return a}}static _isTypeInterceptorElectricChar(e,t,i){return!!(i.length===1&&t.tokenization.isCheapToTokenize(i[0].getEndPosition().lineNumber))}static _typeInterceptorElectricChar(e,t,i,n,r){if(!t.electricChars.hasOwnProperty(r)||!n.isEmpty())return null;const o=n.getPosition();i.tokenization.forceTokenization(o.lineNumber);const a=i.tokenization.getLineTokens(o.lineNumber);let l;try{l=t.onElectricCharacter(r,a,o.column)}catch(c){return ft(c),null}if(!l)return null;if(l.matchOpenBracket){const c=(a.getLineContent()+r).lastIndexOf(l.matchOpenBracket)+1,d=i.bracketPairs.findMatchingBracketUp(l.matchOpenBracket,{lineNumber:o.lineNumber,column:c},500);if(d){if(d.startLineNumber===o.lineNumber)return null;const u=i.getLineContent(d.startLineNumber),h=Ti(u),g=t.normalizeIndentation(h),p=i.getLineContent(o.lineNumber),_=i.getLineFirstNonWhitespaceColumn(o.lineNumber)||o.column,v=p.substring(_-1,o.column-1),C=g+v+r,y=new F(o.lineNumber,1,o.lineNumber,o.column),x=new dr(y,C);return new na(DG(C,e),[x],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!0})}}return null}}class qHe{static getEdits(e,t,i){const n=[];for(let o=0,a=t.length;o<a;o++)n[o]=new dr(t[o],i);const r=DG(i,e);return new na(r,n,{shouldPushStackElementBefore:s5(e,r),shouldPushStackElementAfter:!1})}}class n5{static getEdits(e,t,i,n,r){if(!r&&n===`
`){const o=[];for(let a=0,l=i.length;a<l;a++)o[a]=this._enter(e,t,!1,i[a]);return new na(4,o,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}static _enter(e,t,i,n){if(e.autoIndent===0)return cb(n,`
`,i);if(!t.tokenization.isCheapToTokenize(n.getStartPosition().lineNumber)||e.autoIndent===1){const l=t.getLineContent(n.startLineNumber),c=Ti(l).substring(0,n.startColumn-1);return cb(n,`
`+e.normalizeIndentation(c),i)}const r=Ry(e.autoIndent,t,n,e.languageConfigurationService);if(r){if(r.indentAction===is.None)return cb(n,`
`+e.normalizeIndentation(r.indentation+r.appendText),i);if(r.indentAction===is.Indent)return cb(n,`
`+e.normalizeIndentation(r.indentation+r.appendText),i);if(r.indentAction===is.IndentOutdent){const l=e.normalizeIndentation(r.indentation),c=e.normalizeIndentation(r.indentation+r.appendText),d=`
`+c+`
`+l;return i?new UR(n,d,!0):new lP(n,d,-1,c.length-l.length,!0)}else if(r.indentAction===is.Outdent){const l=dP(e,r.indentation);return cb(n,`
`+e.normalizeIndentation(l+r.appendText),i)}}const o=t.getLineContent(n.startLineNumber),a=Ti(o).substring(0,n.startColumn-1);if(e.autoIndent>=4){const l=VHe(e.autoIndent,t,n,{unshiftIndent:c=>dP(e,c),shiftIndent:c=>TG(e,c),normalizeIndentation:c=>e.normalizeIndentation(c)},e.languageConfigurationService);if(l){let c=e.visibleColumnFromColumn(t,n.getEndPosition());const d=n.endColumn,u=t.getLineContent(n.endLineNumber),h=Zr(u);if(h>=0?n=n.setEndPosition(n.endLineNumber,Math.max(n.endColumn,h+1)):n=n.setEndPosition(n.endLineNumber,t.getLineMaxColumn(n.endLineNumber)),i)return new UR(n,`
`+e.normalizeIndentation(l.afterEnter),!0);{let g=0;return d<=h+1&&(e.insertSpaces||(c=Math.ceil(c/e.indentSize)),g=Math.min(c+1-e.normalizeIndentation(l.afterEnter).length-1,0)),new lP(n,`
`+e.normalizeIndentation(l.afterEnter),0,g,!0)}}}return cb(n,`
`+e.normalizeIndentation(a),i)}static lineInsertBefore(e,t,i){if(t===null||i===null)return[];const n=[];for(let r=0,o=i.length;r<o;r++){let a=i[r].positionLineNumber;if(a===1)n[r]=new UR(new F(1,1,1,1),`
`);else{a--;const l=t.getLineMaxColumn(a);n[r]=this._enter(e,t,!1,new F(a,l,a,l))}}return n}static lineInsertAfter(e,t,i){if(t===null||i===null)return[];const n=[];for(let r=0,o=i.length;r<o;r++){const a=i[r].positionLineNumber,l=t.getLineMaxColumn(a);n[r]=this._enter(e,t,!1,new F(a,l,a,l))}return n}static lineBreakInsert(e,t,i){const n=[];for(let r=0,o=i.length;r<o;r++)n[r]=this._enter(e,t,!0,i[r]);return n}}class KHe{static getEdits(e,t,i,n,r,o){const a=this._distributePasteToCursors(e,i,n,r,o);return a?(i=i.sort(F.compareRangesUsingStarts),this._distributedPaste(e,t,i,a)):this._simplePaste(e,t,i,n,r)}static _distributePasteToCursors(e,t,i,n,r){if(n||t.length===1)return null;if(r&&r.length===t.length)return r;if(e.multiCursorPaste==="spread"){i.charCodeAt(i.length-1)===10&&(i=i.substring(0,i.length-1)),i.charCodeAt(i.length-1)===13&&(i=i.substring(0,i.length-1));const o=Uh(i);if(o.length===t.length)return o}return null}static _distributedPaste(e,t,i,n){const r=[];for(let o=0,a=i.length;o<a;o++)r[o]=new dr(i[o],n[o]);return new na(0,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _simplePaste(e,t,i,n,r){const o=[];for(let a=0,l=i.length;a<l;a++){const c=i[a],d=c.getPosition();if(r&&!c.isEmpty()&&(r=!1),r&&n.indexOf(`
`)!==n.length-1&&(r=!1),r){const u=new F(d.lineNumber,1,d.lineNumber,1);o[a]=new xG(u,n,c,!0)}else o[a]=new dr(c,n)}return new na(0,o,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}}class GHe{static getEdits(e,t,i,n,r,o,a,l){const c=n.map(d=>this._compositionType(i,d,r,o,a,l));return new na(4,c,{shouldPushStackElementBefore:s5(e,4),shouldPushStackElementAfter:!1})}static _compositionType(e,t,i,n,r,o){if(!t.isEmpty())return null;const a=t.getPosition(),l=Math.max(1,a.column-n),c=Math.min(e.getLineMaxColumn(a.lineNumber),a.column+r),d=new F(a.lineNumber,l,a.lineNumber,c);return e.getValueInRange(d)===i&&o===0?null:new lP(d,i,0,o)}}class QHe{static getEdits(e,t,i){const n=[];for(let o=0,a=t.length;o<a;o++)n[o]=new dr(t[o],i);const r=DG(i,e);return new na(r,n,{shouldPushStackElementBefore:s5(e,r),shouldPushStackElementAfter:!1})}}class YHe{static getCommands(e,t,i){const n=[];for(let r=0,o=i.length;r<o;r++){const a=i[r];if(a.isEmpty()){const l=t.getLineContent(a.startLineNumber);if(/^\s*$/.test(l)&&t.tokenization.isCheapToTokenize(a.startLineNumber)){let c=this._goodIndentForLine(e,t,a.startLineNumber);c=c||"	";const d=e.normalizeIndentation(c);if(!l.startsWith(d)){n[r]=new dr(new F(a.startLineNumber,1,a.startLineNumber,l.length+1),d,!0);continue}}n[r]=this._replaceJumpToNextIndent(e,t,a,!0)}else{if(a.startLineNumber===a.endLineNumber){const l=t.getLineMaxColumn(a.startLineNumber);if(a.startColumn!==1||a.endColumn!==l){n[r]=this._replaceJumpToNextIndent(e,t,a,!1);continue}}n[r]=new yc(a,{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService)}}return n}static _goodIndentForLine(e,t,i){let n=null,r="";const o=zI(e.autoIndent,t,i,!1,e.languageConfigurationService);if(o)n=o.action,r=o.indentation;else if(i>1){let a;for(a=i-1;a>=1;a--){const d=t.getLineContent(a);if(nu(d)>=0)break}if(a<1)return null;const l=t.getLineMaxColumn(a),c=Ry(e.autoIndent,t,new F(a,l,a,l),e.languageConfigurationService);c&&(r=c.indentation+c.appendText)}return n&&(n===is.Indent&&(r=TG(e,r)),n===is.Outdent&&(r=dP(e,r)),r=e.normalizeIndentation(r)),r||null}static _replaceJumpToNextIndent(e,t,i,n){let r="";const o=i.getStartPosition();if(e.insertSpaces){const a=e.visibleColumnFromColumn(t,o),l=e.indentSize,c=l-a%l;for(let d=0;d<c;d++)r+=" "}else r="	";return new dr(i,r,n)}}class EG extends lP{constructor(e,t,i,n,r,o){super(e,t,i,n),this._openCharacter=r,this._closeCharacter=o,this.closeCharacterRange=null,this.enclosingRange=null}_computeCursorStateWithRange(e,t,i){return this.closeCharacterRange=new F(t.startLineNumber,t.endColumn-this._closeCharacter.length,t.endLineNumber,t.endColumn),this.enclosingRange=new F(t.startLineNumber,t.endColumn-this._openCharacter.length-this._closeCharacter.length,t.endLineNumber,t.endColumn),super.computeCursorState(e,i)}}class XHe extends EG{constructor(e,t,i,n){const r=(i?t:"")+n,o=0,a=-n.length;super(e,r,o,a,t,n)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return this._computeCursorStateWithRange(e,n,t)}}class ZHe extends EG{constructor(e,t,i,n){const r=i+n,o=0,a=i.length;super(t,r,o,a,i,n),this._autoIndentationEdit=e,this._autoClosingEdit={range:t,text:r}}getEditOperations(e,t){t.addTrackedEditOperation(this._autoIndentationEdit.range,this._autoIndentationEdit.text),t.addTrackedEditOperation(this._autoClosingEdit.range,this._autoClosingEdit.text)}computeCursorState(e,t){const i=t.getInverseEditOperations();if(i.length!==2)throw new Error("There should be two inverse edit operations!");const n=i[0].range,r=i[1].range,o=n.plusRange(r);return this._computeCursorStateWithRange(e,o,t)}}function DG(s,e){return s===" "?e===5||e===6?6:5:4}function s5(s,e){return kse(s)&&!kse(e)?!0:s===5?!1:Lse(s)!==Lse(e)}function Lse(s){return s===6||s===5?"space":s}function kse(s){return s===4||s===5||s===6}function Ype(s,e,t,i,n){if(s.autoClosingOvertype==="never"||!s.autoClosingPairs.autoClosingPairsCloseSingleChar.has(n))return!1;for(let r=0,o=t.length;r<o;r++){const a=t[r];if(!a.isEmpty())return!1;const l=a.getPosition(),c=e.getLineContent(l.lineNumber);if(c.charAt(l.column-1)!==n)return!1;const u=e_(n);if((l.column>2?c.charCodeAt(l.column-2):0)===92&&u)return!1;if(s.autoClosingOvertype==="auto"){let g=!1;for(let p=0,_=i.length;p<_;p++){const v=i[p];if(l.lineNumber===v.startLineNumber&&l.column===v.startColumn){g=!0;break}}if(!g)return!1}}return!0}function cb(s,e,t){return t?new UR(s,e,!0):new dr(s,e,!0)}function TG(s,e,t){return t=t||1,yc.shiftIndent(e,e.length+t,s.tabSize,s.indentSize,s.insertSpaces)}function dP(s,e,t){return t=t||1,yc.unshiftIndent(e,e.length+t,s.tabSize,s.indentSize,s.insertSpaces)}function Xpe(s,e){return e_(e)?s.autoSurround==="quotes"||s.autoSurround==="languageDefined":s.autoSurround==="brackets"||s.autoSurround==="languageDefined"}class Fp{static indent(e,t,i){if(t===null||i===null)return[];const n=[];for(let r=0,o=i.length;r<o;r++)n[r]=new yc(i[r],{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService);return n}static outdent(e,t,i){const n=[];for(let r=0,o=i.length;r<o;r++)n[r]=new yc(i[r],{isUnshift:!0,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService);return n}static paste(e,t,i,n,r,o){return KHe.getEdits(e,t,i,n,r,o)}static tab(e,t,i){return YHe.getCommands(e,t,i)}static compositionType(e,t,i,n,r,o,a,l){return GHe.getEdits(e,t,i,n,r,o,a,l)}static compositionEndWithInterceptors(e,t,i,n,r,o){if(!n)return null;let a=null;for(const h of n)if(a===null)a=h.insertedText;else if(a!==h.insertedText)return null;if(!a||a.length!==1)return null;const l=a;let c=!1;for(const h of n)if(h.deletedText.length!==0){c=!0;break}if(c){if(!Xpe(t,l)||!t.surroundingPairs.hasOwnProperty(l))return null;const h=e_(l);for(const _ of n)if(_.deletedSelectionStart!==0||_.deletedSelectionEnd!==_.deletedText.length||/^[ \t]+$/.test(_.deletedText)||h&&e_(_.deletedText))return null;const g=[];for(const _ of r){if(!_.isEmpty())return null;g.push(_.getPosition())}if(g.length!==n.length)return null;const p=[];for(let _=0,v=g.length;_<v;_++)p.push(new OHe(g[_],n[_].deletedText,t.surroundingPairs[l]));return new na(4,p,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}const d=UHe.getEdits(t,i,r,o,l);if(d!==void 0)return d;const u=RH.getEdits(t,i,r,l,!0,!1);return u!==void 0?u:null}static typeWithInterceptors(e,t,i,n,r,o,a){const l=n5.getEdits(i,n,r,a,e);if(l!==void 0)return l;const c=HHe.getEdits(i,n,r,a,e);if(c!==void 0)return c;const d=zHe.getEdits(t,i,n,r,o,a);if(d!==void 0)return d;const u=RH.getEdits(i,n,r,a,!1,e);if(u!==void 0)return u;const h=jHe.getEdits(i,n,r,a,e);if(h!==void 0)return h;const g=$He.getEdits(t,i,n,r,a,e);return g!==void 0?g:qHe.getEdits(t,r,a)}static typeWithoutInterceptors(e,t,i,n,r){return QHe.getEdits(e,n,r)}}class JHe{constructor(e,t,i,n,r,o){this.deletedText=e,this.deletedSelectionStart=t,this.deletedSelectionEnd=i,this.insertedText=n,this.insertedSelectionStart=r,this.insertedSelectionEnd=o}}var z;(function(s){s.editorSimpleInput=new Oe("editorSimpleInput",!1,!0),s.editorTextFocus=new Oe("editorTextFocus",!1,b("editorTextFocus","Whether the editor text has focus (cursor is blinking)")),s.focus=new Oe("editorFocus",!1,b("editorFocus","Whether the editor or an editor widget has focus (e.g. focus is in the find widget)")),s.textInputFocus=new Oe("textInputFocus",!1,b("textInputFocus","Whether an editor or a rich text input has focus (cursor is blinking)")),s.readOnly=new Oe("editorReadonly",!1,b("editorReadonly","Whether the editor is read-only")),s.inDiffEditor=new Oe("inDiffEditor",!1,b("inDiffEditor","Whether the context is a diff editor")),s.isEmbeddedDiffEditor=new Oe("isEmbeddedDiffEditor",!1,b("isEmbeddedDiffEditor","Whether the context is an embedded diff editor")),s.inMultiDiffEditor=new Oe("inMultiDiffEditor",!1,b("inMultiDiffEditor","Whether the context is a multi diff editor")),s.multiDiffEditorAllCollapsed=new Oe("multiDiffEditorAllCollapsed",void 0,b("multiDiffEditorAllCollapsed","Whether all files in multi diff editor are collapsed")),s.hasChanges=new Oe("diffEditorHasChanges",!1,b("diffEditorHasChanges","Whether the diff editor has changes")),s.comparingMovedCode=new Oe("comparingMovedCode",!1,b("comparingMovedCode","Whether a moved code block is selected for comparison")),s.accessibleDiffViewerVisible=new Oe("accessibleDiffViewerVisible",!1,b("accessibleDiffViewerVisible","Whether the accessible diff viewer is visible")),s.diffEditorRenderSideBySideInlineBreakpointReached=new Oe("diffEditorRenderSideBySideInlineBreakpointReached",!1,b("diffEditorRenderSideBySideInlineBreakpointReached","Whether the diff editor render side by side inline breakpoint is reached")),s.diffEditorInlineMode=new Oe("diffEditorInlineMode",!1,b("diffEditorInlineMode","Whether inline mode is active")),s.diffEditorOriginalWritable=new Oe("diffEditorOriginalWritable",!1,b("diffEditorOriginalWritable","Whether modified is writable in the diff editor")),s.diffEditorModifiedWritable=new Oe("diffEditorModifiedWritable",!1,b("diffEditorModifiedWritable","Whether modified is writable in the diff editor")),s.diffEditorOriginalUri=new Oe("diffEditorOriginalUri","",b("diffEditorOriginalUri","The uri of the original document")),s.diffEditorModifiedUri=new Oe("diffEditorModifiedUri","",b("diffEditorModifiedUri","The uri of the modified document")),s.columnSelection=new Oe("editorColumnSelection",!1,b("editorColumnSelection","Whether `editor.columnSelection` is enabled")),s.writable=s.readOnly.toNegated(),s.hasNonEmptySelection=new Oe("editorHasSelection",!1,b("editorHasSelection","Whether the editor has text selected")),s.hasOnlyEmptySelection=s.hasNonEmptySelection.toNegated(),s.hasMultipleSelections=new Oe("editorHasMultipleSelections",!1,b("editorHasMultipleSelections","Whether the editor has multiple selections")),s.hasSingleSelection=s.hasMultipleSelections.toNegated(),s.tabMovesFocus=new Oe("editorTabMovesFocus",!1,b("editorTabMovesFocus","Whether `Tab` will move focus out of the editor")),s.tabDoesNotMoveFocus=s.tabMovesFocus.toNegated(),s.isInEmbeddedEditor=new Oe("isInEmbeddedEditor",!1,!0),s.canUndo=new Oe("canUndo",!1,!0),s.canRedo=new Oe("canRedo",!1,!0),s.hoverVisible=new Oe("editorHoverVisible",!1,b("editorHoverVisible","Whether the editor hover is visible")),s.hoverFocused=new Oe("editorHoverFocused",!1,b("editorHoverFocused","Whether the editor hover is focused")),s.stickyScrollFocused=new Oe("stickyScrollFocused",!1,b("stickyScrollFocused","Whether the sticky scroll is focused")),s.stickyScrollVisible=new Oe("stickyScrollVisible",!1,b("stickyScrollVisible","Whether the sticky scroll is visible")),s.standaloneColorPickerVisible=new Oe("standaloneColorPickerVisible",!1,b("standaloneColorPickerVisible","Whether the standalone color picker is visible")),s.standaloneColorPickerFocused=new Oe("standaloneColorPickerFocused",!1,b("standaloneColorPickerFocused","Whether the standalone color picker is focused")),s.inCompositeEditor=new Oe("inCompositeEditor",void 0,b("inCompositeEditor","Whether the editor is part of a larger editor (e.g. notebooks)")),s.notInCompositeEditor=s.inCompositeEditor.toNegated(),s.languageId=new Oe("editorLangId","",b("editorLangId","The language identifier of the editor")),s.hasCompletionItemProvider=new Oe("editorHasCompletionItemProvider",!1,b("editorHasCompletionItemProvider","Whether the editor has a completion item provider")),s.hasCodeActionsProvider=new Oe("editorHasCodeActionsProvider",!1,b("editorHasCodeActionsProvider","Whether the editor has a code actions provider")),s.hasCodeLensProvider=new Oe("editorHasCodeLensProvider",!1,b("editorHasCodeLensProvider","Whether the editor has a code lens provider")),s.hasDefinitionProvider=new Oe("editorHasDefinitionProvider",!1,b("editorHasDefinitionProvider","Whether the editor has a definition provider")),s.hasDeclarationProvider=new Oe("editorHasDeclarationProvider",!1,b("editorHasDeclarationProvider","Whether the editor has a declaration provider")),s.hasImplementationProvider=new Oe("editorHasImplementationProvider",!1,b("editorHasImplementationProvider","Whether the editor has an implementation provider")),s.hasTypeDefinitionProvider=new Oe("editorHasTypeDefinitionProvider",!1,b("editorHasTypeDefinitionProvider","Whether the editor has a type definition provider")),s.hasHoverProvider=new Oe("editorHasHoverProvider",!1,b("editorHasHoverProvider","Whether the editor has a hover provider")),s.hasDocumentHighlightProvider=new Oe("editorHasDocumentHighlightProvider",!1,b("editorHasDocumentHighlightProvider","Whether the editor has a document highlight provider")),s.hasDocumentSymbolProvider=new Oe("editorHasDocumentSymbolProvider",!1,b("editorHasDocumentSymbolProvider","Whether the editor has a document symbol provider")),s.hasReferenceProvider=new Oe("editorHasReferenceProvider",!1,b("editorHasReferenceProvider","Whether the editor has a reference provider")),s.hasRenameProvider=new Oe("editorHasRenameProvider",!1,b("editorHasRenameProvider","Whether the editor has a rename provider")),s.hasSignatureHelpProvider=new Oe("editorHasSignatureHelpProvider",!1,b("editorHasSignatureHelpProvider","Whether the editor has a signature help provider")),s.hasInlayHintsProvider=new Oe("editorHasInlayHintsProvider",!1,b("editorHasInlayHintsProvider","Whether the editor has an inline hints provider")),s.hasDocumentFormattingProvider=new Oe("editorHasDocumentFormattingProvider",!1,b("editorHasDocumentFormattingProvider","Whether the editor has a document formatting provider")),s.hasDocumentSelectionFormattingProvider=new Oe("editorHasDocumentSelectionFormattingProvider",!1,b("editorHasDocumentSelectionFormattingProvider","Whether the editor has a document selection formatting provider")),s.hasMultipleDocumentFormattingProvider=new Oe("editorHasMultipleDocumentFormattingProvider",!1,b("editorHasMultipleDocumentFormattingProvider","Whether the editor has multiple document formatting providers")),s.hasMultipleDocumentSelectionFormattingProvider=new Oe("editorHasMultipleDocumentSelectionFormattingProvider",!1,b("editorHasMultipleDocumentSelectionFormattingProvider","Whether the editor has multiple document selection formatting providers"))})(z||(z={}));const ui=0;class Nn extends fs{runEditorCommand(e,t,i){const n=t._getViewModel();n&&this.runCoreEditorCommand(n,i||{})}}var sr;(function(s){const e=function(i){if(!Ms(i))return!1;const n=i;return!(!Zo(n.to)||!Yr(n.by)&&!Zo(n.by)||!Yr(n.value)&&!Vm(n.value)||!Yr(n.revealCursor)&&!Yde(n.revealCursor))};s.metadata={description:"Scroll editor in the given direction",args:[{name:"Editor scroll argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'to': A mandatory direction value.\n						```\n						'up', 'down'\n						```\n					* 'by': Unit to move. Default is computed based on 'to' value.\n						```\n						'line', 'wrappedLine', 'page', 'halfPage', 'editor'\n						```\n					* 'value': Number of units to move. Default is '1'.\n					* 'revealCursor': If 'true' reveals the cursor if it is outside view port.\n				",constraint:e,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["up","down"]},by:{type:"string",enum:["line","wrappedLine","page","halfPage","editor"]},value:{type:"number",default:1},revealCursor:{type:"boolean"}}}}]},s.RawDirection={Up:"up",Right:"right",Down:"down",Left:"left"},s.RawUnit={Line:"line",WrappedLine:"wrappedLine",Page:"page",HalfPage:"halfPage",Editor:"editor",Column:"column"};function t(i){let n;switch(i.to){case s.RawDirection.Up:n=1;break;case s.RawDirection.Right:n=2;break;case s.RawDirection.Down:n=3;break;case s.RawDirection.Left:n=4;break;default:return null}let r;switch(i.by){case s.RawUnit.Line:r=1;break;case s.RawUnit.WrappedLine:r=2;break;case s.RawUnit.Page:r=3;break;case s.RawUnit.HalfPage:r=4;break;case s.RawUnit.Editor:r=5;break;case s.RawUnit.Column:r=6;break;default:r=2}const o=Math.floor(i.value||1),a=!!i.revealCursor;return{direction:n,unit:r,value:o,revealCursor:a,select:!!i.select}}s.parse=t})(sr||(sr={}));var MC;(function(s){const e=function(t){if(!Ms(t))return!1;const i=t;return!(!Vm(i.lineNumber)&&!Zo(i.lineNumber)||!Yr(i.at)&&!Zo(i.at))};s.metadata={description:"Reveal the given line at the given logical position",args:[{name:"Reveal line argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'lineNumber': A mandatory line number value.\n					* 'at': Logical position at which line has to be revealed.\n						```\n						'top', 'center', 'bottom'\n						```\n				",constraint:e,schema:{type:"object",required:["lineNumber"],properties:{lineNumber:{type:["number","string"]},at:{type:"string",enum:["top","center","bottom"]}}}}]},s.RawAtArgument={Top:"top",Center:"center",Bottom:"bottom"}})(MC||(MC={}));class AH{constructor(e){e.addImplementation(1e4,"code-editor",(t,i)=>{const n=t.get(ni).getFocusedCodeEditor();return n&&n.hasTextFocus()?this._runEditorCommand(t,n,i):!1}),e.addImplementation(1e3,"generic-dom-input-textarea",(t,i)=>{const n=hr();return n&&["input","textarea"].indexOf(n.tagName.toLowerCase())>=0?(this.runDOMCommand(n),!0):!1}),e.addImplementation(0,"generic-dom",(t,i)=>{const n=t.get(ni).getActiveCodeEditor();return n?(n.focus(),this._runEditorCommand(t,n,i)):!1})}_runEditorCommand(e,t,i){const n=this.runEditorCommand(e,t,i);return n||!0}}var Ns;(function(s){class e extends Nn{constructor(y){super(y),this._inSelectionMode=y.inSelectionMode}runCoreEditorCommand(y,x){if(!x.position)return;y.model.pushStackElement(),y.setCursorStates(x.source,3,[$s.moveTo(y,y.getPrimaryCursorState(),this._inSelectionMode,x.position,x.viewPosition)])&&x.revealType!==2&&y.revealAllCursors(x.source,!0,!0)}}s.MoveTo=Me(new e({id:"_moveTo",inSelectionMode:!1,precondition:void 0})),s.MoveToSelect=Me(new e({id:"_moveToSelect",inSelectionMode:!0,precondition:void 0}));class t extends Nn{runCoreEditorCommand(y,x){y.model.pushStackElement();const L=this._getColumnSelectResult(y,y.getPrimaryCursorState(),y.getCursorColumnSelectData(),x);L!==null&&(y.setCursorStates(x.source,3,L.viewStates.map(I=>ti.fromViewState(I))),y.setCursorColumnSelectData({isReal:!0,fromViewLineNumber:L.fromLineNumber,fromViewVisualColumn:L.fromVisualColumn,toViewLineNumber:L.toLineNumber,toViewVisualColumn:L.toVisualColumn}),L.reversed?y.revealTopMostCursor(x.source):y.revealBottomMostCursor(x.source))}}s.ColumnSelect=Me(new class extends t{constructor(){super({id:"columnSelect",precondition:void 0})}_getColumnSelectResult(C,y,x,L){if(typeof L.position>"u"||typeof L.viewPosition>"u"||typeof L.mouseColumn>"u")return null;const I=C.model.validatePosition(L.position),A=C.coordinatesConverter.validateViewPosition(new X(L.viewPosition.lineNumber,L.viewPosition.column),I),D=L.doColumnSelect?x.fromViewLineNumber:A.lineNumber,N=L.doColumnSelect?x.fromViewVisualColumn:L.mouseColumn-1;return kb.columnSelect(C.cursorConfig,C,D,N,A.lineNumber,L.mouseColumn-1)}}),s.CursorColumnSelectLeft=Me(new class extends t{constructor(){super({id:"cursorColumnSelectLeft",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus,primary:3599,linux:{primary:0}}})}_getColumnSelectResult(C,y,x,L){return kb.columnSelectLeft(C.cursorConfig,C,x)}}),s.CursorColumnSelectRight=Me(new class extends t{constructor(){super({id:"cursorColumnSelectRight",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus,primary:3601,linux:{primary:0}}})}_getColumnSelectResult(C,y,x,L){return kb.columnSelectRight(C.cursorConfig,C,x)}});class i extends t{constructor(y){super(y),this._isPaged=y.isPaged}_getColumnSelectResult(y,x,L,I){return kb.columnSelectUp(y.cursorConfig,y,L,this._isPaged)}}s.CursorColumnSelectUp=Me(new i({isPaged:!1,id:"cursorColumnSelectUp",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus,primary:3600,linux:{primary:0}}})),s.CursorColumnSelectPageUp=Me(new i({isPaged:!0,id:"cursorColumnSelectPageUp",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus,primary:3595,linux:{primary:0}}}));class n extends t{constructor(y){super(y),this._isPaged=y.isPaged}_getColumnSelectResult(y,x,L,I){return kb.columnSelectDown(y.cursorConfig,y,L,this._isPaged)}}s.CursorColumnSelectDown=Me(new n({isPaged:!1,id:"cursorColumnSelectDown",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus,primary:3602,linux:{primary:0}}})),s.CursorColumnSelectPageDown=Me(new n({isPaged:!0,id:"cursorColumnSelectPageDown",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus,primary:3596,linux:{primary:0}}}));class r extends Nn{constructor(){super({id:"cursorMove",precondition:void 0,metadata:cP.metadata})}runCoreEditorCommand(y,x){const L=cP.parse(x);L&&this._runCursorMove(y,x.source,L)}_runCursorMove(y,x,L){y.model.pushStackElement(),y.setCursorStates(x,3,r._move(y,y.getCursorStates(),L)),y.revealAllCursors(x,!0)}static _move(y,x,L){const I=L.select,A=L.value;switch(L.direction){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:return $s.simpleMove(y,x,L.direction,I,A,L.unit);case 11:case 13:case 12:case 14:return $s.viewportMove(y,x,L.direction,I,A);default:return null}}}s.CursorMoveImpl=r,s.CursorMove=Me(new r);class o extends Nn{constructor(y){super(y),this._staticArgs=y.args}runCoreEditorCommand(y,x){let L=this._staticArgs;this._staticArgs.value===-1&&(L={direction:this._staticArgs.direction,unit:this._staticArgs.unit,select:this._staticArgs.select,value:x.pageSize||y.cursorConfig.pageSize}),y.model.pushStackElement(),y.setCursorStates(x.source,3,$s.simpleMove(y,y.getCursorStates(),L.direction,L.select,L.value,L.unit)),y.revealAllCursors(x.source,!0)}}s.CursorLeft=Me(new o({args:{direction:0,unit:0,select:!1,value:1},id:"cursorLeft",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus,primary:15,mac:{primary:15,secondary:[288]}}})),s.CursorLeftSelect=Me(new o({args:{direction:0,unit:0,select:!0,value:1},id:"cursorLeftSelect",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus,primary:1039}})),s.CursorRight=Me(new o({args:{direction:1,unit:0,select:!1,value:1},id:"cursorRight",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus,primary:17,mac:{primary:17,secondary:[292]}}})),s.CursorRightSelect=Me(new o({args:{direction:1,unit:0,select:!0,value:1},id:"cursorRightSelect",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus,primary:1041}})),s.CursorUp=Me(new o({args:{direction:2,unit:2,select:!1,value:1},id:"cursorUp",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus,primary:16,mac:{primary:16,secondary:[302]}}})),s.CursorUpSelect=Me(new o({args:{direction:2,unit:2,select:!0,value:1},id:"cursorUpSelect",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus,primary:1040,secondary:[3088],mac:{primary:1040},linux:{primary:1040}}})),s.CursorPageUp=Me(new o({args:{direction:2,unit:2,select:!1,value:-1},id:"cursorPageUp",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus,primary:11}})),s.CursorPageUpSelect=Me(new o({args:{direction:2,unit:2,select:!0,value:-1},id:"cursorPageUpSelect",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus,primary:1035}})),s.CursorDown=Me(new o({args:{direction:3,unit:2,select:!1,value:1},id:"cursorDown",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus,primary:18,mac:{primary:18,secondary:[300]}}})),s.CursorDownSelect=Me(new o({args:{direction:3,unit:2,select:!0,value:1},id:"cursorDownSelect",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus,primary:1042,secondary:[3090],mac:{primary:1042},linux:{primary:1042}}})),s.CursorPageDown=Me(new o({args:{direction:3,unit:2,select:!1,value:-1},id:"cursorPageDown",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus,primary:12}})),s.CursorPageDownSelect=Me(new o({args:{direction:3,unit:2,select:!0,value:-1},id:"cursorPageDownSelect",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus,primary:1036}})),s.CreateCursor=Me(new class extends Nn{constructor(){super({id:"createCursor",precondition:void 0})}runCoreEditorCommand(C,y){if(!y.position)return;let x;y.wholeLine?x=$s.line(C,C.getPrimaryCursorState(),!1,y.position,y.viewPosition):x=$s.moveTo(C,C.getPrimaryCursorState(),!1,y.position,y.viewPosition);const L=C.getCursorStates();if(L.length>1){const I=x.modelState?x.modelState.position:null,A=x.viewState?x.viewState.position:null;for(let D=0,N=L.length;D<N;D++){const R=L[D];if(!(I&&!R.modelState.selection.containsPosition(I))&&!(A&&!R.viewState.selection.containsPosition(A))){L.splice(D,1),C.model.pushStackElement(),C.setCursorStates(y.source,3,L);return}}}L.push(x),C.model.pushStackElement(),C.setCursorStates(y.source,3,L)}}),s.LastCursorMoveToSelect=Me(new class extends Nn{constructor(){super({id:"_lastCursorMoveToSelect",precondition:void 0})}runCoreEditorCommand(C,y){if(!y.position)return;const x=C.getLastAddedCursorIndex(),L=C.getCursorStates(),I=L.slice(0);I[x]=$s.moveTo(C,L[x],!0,y.position,y.viewPosition),C.model.pushStackElement(),C.setCursorStates(y.source,3,I)}});class a extends Nn{constructor(y){super(y),this._inSelectionMode=y.inSelectionMode}runCoreEditorCommand(y,x){y.model.pushStackElement(),y.setCursorStates(x.source,3,$s.moveToBeginningOfLine(y,y.getCursorStates(),this._inSelectionMode)),y.revealAllCursors(x.source,!0)}}s.CursorHome=Me(new a({inSelectionMode:!1,id:"cursorHome",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus,primary:14,mac:{primary:14,secondary:[2063]}}})),s.CursorHomeSelect=Me(new a({inSelectionMode:!0,id:"cursorHomeSelect",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus,primary:1038,mac:{primary:1038,secondary:[3087]}}}));class l extends Nn{constructor(y){super(y),this._inSelectionMode=y.inSelectionMode}runCoreEditorCommand(y,x){y.model.pushStackElement(),y.setCursorStates(x.source,3,this._exec(y.getCursorStates())),y.revealAllCursors(x.source,!0)}_exec(y){const x=[];for(let L=0,I=y.length;L<I;L++){const A=y[L],D=A.modelState.position.lineNumber;x[L]=ti.fromModelState(A.modelState.move(this._inSelectionMode,D,1,0))}return x}}s.CursorLineStart=Me(new l({inSelectionMode:!1,id:"cursorLineStart",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus,primary:0,mac:{primary:287}}})),s.CursorLineStartSelect=Me(new l({inSelectionMode:!0,id:"cursorLineStartSelect",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus,primary:0,mac:{primary:1311}}}));class c extends Nn{constructor(y){super(y),this._inSelectionMode=y.inSelectionMode}runCoreEditorCommand(y,x){y.model.pushStackElement(),y.setCursorStates(x.source,3,$s.moveToEndOfLine(y,y.getCursorStates(),this._inSelectionMode,x.sticky||!1)),y.revealAllCursors(x.source,!0)}}s.CursorEnd=Me(new c({inSelectionMode:!1,id:"cursorEnd",precondition:void 0,kbOpts:{args:{sticky:!1},weight:ui,kbExpr:z.textInputFocus,primary:13,mac:{primary:13,secondary:[2065]}},metadata:{description:"Go to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:b("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}})),s.CursorEndSelect=Me(new c({inSelectionMode:!0,id:"cursorEndSelect",precondition:void 0,kbOpts:{args:{sticky:!1},weight:ui,kbExpr:z.textInputFocus,primary:1037,mac:{primary:1037,secondary:[3089]}},metadata:{description:"Select to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:b("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}}));class d extends Nn{constructor(y){super(y),this._inSelectionMode=y.inSelectionMode}runCoreEditorCommand(y,x){y.model.pushStackElement(),y.setCursorStates(x.source,3,this._exec(y,y.getCursorStates())),y.revealAllCursors(x.source,!0)}_exec(y,x){const L=[];for(let I=0,A=x.length;I<A;I++){const D=x[I],N=D.modelState.position.lineNumber,R=y.model.getLineMaxColumn(N);L[I]=ti.fromModelState(D.modelState.move(this._inSelectionMode,N,R,0))}return L}}s.CursorLineEnd=Me(new d({inSelectionMode:!1,id:"cursorLineEnd",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus,primary:0,mac:{primary:291}}})),s.CursorLineEndSelect=Me(new d({inSelectionMode:!0,id:"cursorLineEndSelect",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus,primary:0,mac:{primary:1315}}}));class u extends Nn{constructor(y){super(y),this._inSelectionMode=y.inSelectionMode}runCoreEditorCommand(y,x){y.model.pushStackElement(),y.setCursorStates(x.source,3,$s.moveToBeginningOfBuffer(y,y.getCursorStates(),this._inSelectionMode)),y.revealAllCursors(x.source,!0)}}s.CursorTop=Me(new u({inSelectionMode:!1,id:"cursorTop",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus,primary:2062,mac:{primary:2064}}})),s.CursorTopSelect=Me(new u({inSelectionMode:!0,id:"cursorTopSelect",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus,primary:3086,mac:{primary:3088}}}));class h extends Nn{constructor(y){super(y),this._inSelectionMode=y.inSelectionMode}runCoreEditorCommand(y,x){y.model.pushStackElement(),y.setCursorStates(x.source,3,$s.moveToEndOfBuffer(y,y.getCursorStates(),this._inSelectionMode)),y.revealAllCursors(x.source,!0)}}s.CursorBottom=Me(new h({inSelectionMode:!1,id:"cursorBottom",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus,primary:2061,mac:{primary:2066}}})),s.CursorBottomSelect=Me(new h({inSelectionMode:!0,id:"cursorBottomSelect",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus,primary:3085,mac:{primary:3090}}}));class g extends Nn{constructor(){super({id:"editorScroll",precondition:void 0,metadata:sr.metadata})}determineScrollMethod(y){const x=[6],L=[1,2,3,4,5,6],I=[4,2],A=[1,3];return x.includes(y.unit)&&I.includes(y.direction)?this._runHorizontalEditorScroll.bind(this):L.includes(y.unit)&&A.includes(y.direction)?this._runVerticalEditorScroll.bind(this):null}runCoreEditorCommand(y,x){const L=sr.parse(x);if(!L)return;const I=this.determineScrollMethod(L);I&&I(y,x.source,L)}_runVerticalEditorScroll(y,x,L){const I=this._computeDesiredScrollTop(y,L);if(L.revealCursor){const A=y.getCompletelyVisibleViewRangeAtScrollTop(I);y.setCursorStates(x,3,[$s.findPositionInViewportIfOutside(y,y.getPrimaryCursorState(),A,L.select)])}y.viewLayout.setScrollPosition({scrollTop:I},0)}_computeDesiredScrollTop(y,x){if(x.unit===1){const A=y.viewLayout.getFutureViewport(),D=y.getCompletelyVisibleViewRangeAtScrollTop(A.top),N=y.coordinatesConverter.convertViewRangeToModelRange(D);let R;x.direction===1?R=Math.max(1,N.startLineNumber-x.value):R=Math.min(y.model.getLineCount(),N.startLineNumber+x.value);const W=y.coordinatesConverter.convertModelPositionToViewPosition(new X(R,1));return y.viewLayout.getVerticalOffsetForLineNumber(W.lineNumber)}if(x.unit===5){let A=0;return x.direction===3&&(A=y.model.getLineCount()-y.cursorConfig.pageSize),y.viewLayout.getVerticalOffsetForLineNumber(A)}let L;x.unit===3?L=y.cursorConfig.pageSize*x.value:x.unit===4?L=Math.round(y.cursorConfig.pageSize/2)*x.value:L=x.value;const I=(x.direction===1?-1:1)*L;return y.viewLayout.getCurrentScrollTop()+I*y.cursorConfig.lineHeight}_runHorizontalEditorScroll(y,x,L){const I=this._computeDesiredScrollLeft(y,L);y.viewLayout.setScrollPosition({scrollLeft:I},0)}_computeDesiredScrollLeft(y,x){const L=(x.direction===4?-1:1)*x.value;return y.viewLayout.getCurrentScrollLeft()+L*y.cursorConfig.typicalHalfwidthCharacterWidth}}s.EditorScrollImpl=g,s.EditorScroll=Me(new g),s.ScrollLineUp=Me(new class extends Nn{constructor(){super({id:"scrollLineUp",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus,primary:2064,mac:{primary:267}}})}runCoreEditorCommand(C,y){s.EditorScroll.runCoreEditorCommand(C,{to:sr.RawDirection.Up,by:sr.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:y.source})}}),s.ScrollPageUp=Me(new class extends Nn{constructor(){super({id:"scrollPageUp",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus,primary:2059,win:{primary:523},linux:{primary:523}}})}runCoreEditorCommand(C,y){s.EditorScroll.runCoreEditorCommand(C,{to:sr.RawDirection.Up,by:sr.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:y.source})}}),s.ScrollEditorTop=Me(new class extends Nn{constructor(){super({id:"scrollEditorTop",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus}})}runCoreEditorCommand(C,y){s.EditorScroll.runCoreEditorCommand(C,{to:sr.RawDirection.Up,by:sr.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:y.source})}}),s.ScrollLineDown=Me(new class extends Nn{constructor(){super({id:"scrollLineDown",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus,primary:2066,mac:{primary:268}}})}runCoreEditorCommand(C,y){s.EditorScroll.runCoreEditorCommand(C,{to:sr.RawDirection.Down,by:sr.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:y.source})}}),s.ScrollPageDown=Me(new class extends Nn{constructor(){super({id:"scrollPageDown",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus,primary:2060,win:{primary:524},linux:{primary:524}}})}runCoreEditorCommand(C,y){s.EditorScroll.runCoreEditorCommand(C,{to:sr.RawDirection.Down,by:sr.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:y.source})}}),s.ScrollEditorBottom=Me(new class extends Nn{constructor(){super({id:"scrollEditorBottom",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus}})}runCoreEditorCommand(C,y){s.EditorScroll.runCoreEditorCommand(C,{to:sr.RawDirection.Down,by:sr.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:y.source})}}),s.ScrollLeft=Me(new class extends Nn{constructor(){super({id:"scrollLeft",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus}})}runCoreEditorCommand(C,y){s.EditorScroll.runCoreEditorCommand(C,{to:sr.RawDirection.Left,by:sr.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:y.source})}}),s.ScrollRight=Me(new class extends Nn{constructor(){super({id:"scrollRight",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus}})}runCoreEditorCommand(C,y){s.EditorScroll.runCoreEditorCommand(C,{to:sr.RawDirection.Right,by:sr.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:y.source})}});class p extends Nn{constructor(y){super(y),this._inSelectionMode=y.inSelectionMode}runCoreEditorCommand(y,x){x.position&&(y.model.pushStackElement(),y.setCursorStates(x.source,3,[$s.word(y,y.getPrimaryCursorState(),this._inSelectionMode,x.position)]),x.revealType!==2&&y.revealAllCursors(x.source,!0,!0))}}s.WordSelect=Me(new p({inSelectionMode:!1,id:"_wordSelect",precondition:void 0})),s.WordSelectDrag=Me(new p({inSelectionMode:!0,id:"_wordSelectDrag",precondition:void 0})),s.LastCursorWordSelect=Me(new class extends Nn{constructor(){super({id:"lastCursorWordSelect",precondition:void 0})}runCoreEditorCommand(C,y){if(!y.position)return;const x=C.getLastAddedCursorIndex(),L=C.getCursorStates(),I=L.slice(0),A=L[x];I[x]=$s.word(C,A,A.modelState.hasSelection(),y.position),C.model.pushStackElement(),C.setCursorStates(y.source,3,I)}});class _ extends Nn{constructor(y){super(y),this._inSelectionMode=y.inSelectionMode}runCoreEditorCommand(y,x){x.position&&(y.model.pushStackElement(),y.setCursorStates(x.source,3,[$s.line(y,y.getPrimaryCursorState(),this._inSelectionMode,x.position,x.viewPosition)]),x.revealType!==2&&y.revealAllCursors(x.source,!1,!0))}}s.LineSelect=Me(new _({inSelectionMode:!1,id:"_lineSelect",precondition:void 0})),s.LineSelectDrag=Me(new _({inSelectionMode:!0,id:"_lineSelectDrag",precondition:void 0}));class v extends Nn{constructor(y){super(y),this._inSelectionMode=y.inSelectionMode}runCoreEditorCommand(y,x){if(!x.position)return;const L=y.getLastAddedCursorIndex(),I=y.getCursorStates(),A=I.slice(0);A[L]=$s.line(y,I[L],this._inSelectionMode,x.position,x.viewPosition),y.model.pushStackElement(),y.setCursorStates(x.source,3,A)}}s.LastCursorLineSelect=Me(new v({inSelectionMode:!1,id:"lastCursorLineSelect",precondition:void 0})),s.LastCursorLineSelectDrag=Me(new v({inSelectionMode:!0,id:"lastCursorLineSelectDrag",precondition:void 0})),s.CancelSelection=Me(new class extends Nn{constructor(){super({id:"cancelSelection",precondition:z.hasNonEmptySelection,kbOpts:{weight:ui,kbExpr:z.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(C,y){C.model.pushStackElement(),C.setCursorStates(y.source,3,[$s.cancelSelection(C,C.getPrimaryCursorState())]),C.revealAllCursors(y.source,!0)}}),s.RemoveSecondaryCursors=Me(new class extends Nn{constructor(){super({id:"removeSecondaryCursors",precondition:z.hasMultipleSelections,kbOpts:{weight:ui+1,kbExpr:z.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(C,y){C.model.pushStackElement(),C.setCursorStates(y.source,3,[C.getPrimaryCursorState()]),C.revealAllCursors(y.source,!0),Mh(b("removedCursor","Removed secondary cursors"))}}),s.RevealLine=Me(new class extends Nn{constructor(){super({id:"revealLine",precondition:void 0,metadata:MC.metadata})}runCoreEditorCommand(C,y){const x=y,L=x.lineNumber||0;let I=typeof L=="number"?L+1:parseInt(L)+1;I<1&&(I=1);const A=C.model.getLineCount();I>A&&(I=A);const D=new F(I,1,I,C.model.getLineMaxColumn(I));let N=0;if(x.at)switch(x.at){case MC.RawAtArgument.Top:N=3;break;case MC.RawAtArgument.Center:N=1;break;case MC.RawAtArgument.Bottom:N=4;break}const R=C.coordinatesConverter.convertModelRangeToViewRange(D);C.revealRange(y.source,!1,R,N,0)}}),s.SelectAll=new class extends AH{constructor(){super(jAe)}runDOMCommand(C){_c&&(C.focus(),C.select()),C.ownerDocument.execCommand("selectAll")}runEditorCommand(C,y,x){const L=y._getViewModel();L&&this.runCoreEditorCommand(L,x)}runCoreEditorCommand(C,y){C.model.pushStackElement(),C.setCursorStates("keyboard",3,[$s.selectAll(C,C.getPrimaryCursorState())])}},s.SetSelection=Me(new class extends Nn{constructor(){super({id:"setSelection",precondition:void 0})}runCoreEditorCommand(C,y){y.selection&&(C.model.pushStackElement(),C.setCursorStates(y.source,3,[ti.fromModelSelection(y.selection)]))}})})(Ns||(Ns={}));const eze=he.and(z.textInputFocus,z.columnSelection);function kS(s,e){Io.registerKeybindingRule({id:s,primary:e,when:eze,weight:ui+1})}kS(Ns.CursorColumnSelectLeft.id,1039);kS(Ns.CursorColumnSelectRight.id,1041);kS(Ns.CursorColumnSelectUp.id,1040);kS(Ns.CursorColumnSelectPageUp.id,1035);kS(Ns.CursorColumnSelectDown.id,1042);kS(Ns.CursorColumnSelectPageDown.id,1036);function Ise(s){return s.register(),s}var Ay;(function(s){class e extends fs{runEditorCommand(i,n,r){const o=n._getViewModel();o&&this.runCoreEditingCommand(n,o,r||{})}}s.CoreEditingCommand=e,s.LineBreakInsert=Me(new class extends e{constructor(){super({id:"lineBreakInsert",precondition:z.writable,kbOpts:{weight:ui,kbExpr:z.textInputFocus,primary:0,mac:{primary:301}}})}runCoreEditingCommand(t,i,n){t.pushUndoStop(),t.executeCommands(this.id,n5.lineBreakInsert(i.cursorConfig,i.model,i.getCursorStates().map(r=>r.modelState.selection)))}}),s.Outdent=Me(new class extends e{constructor(){super({id:"outdent",precondition:z.writable,kbOpts:{weight:ui,kbExpr:he.and(z.editorTextFocus,z.tabDoesNotMoveFocus),primary:1026}})}runCoreEditingCommand(t,i,n){t.pushUndoStop(),t.executeCommands(this.id,Fp.outdent(i.cursorConfig,i.model,i.getCursorStates().map(r=>r.modelState.selection))),t.pushUndoStop()}}),s.Tab=Me(new class extends e{constructor(){super({id:"tab",precondition:z.writable,kbOpts:{weight:ui,kbExpr:he.and(z.editorTextFocus,z.tabDoesNotMoveFocus),primary:2}})}runCoreEditingCommand(t,i,n){t.pushUndoStop(),t.executeCommands(this.id,Fp.tab(i.cursorConfig,i.model,i.getCursorStates().map(r=>r.modelState.selection))),t.pushUndoStop()}}),s.DeleteLeft=Me(new class extends e{constructor(){super({id:"deleteLeft",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus,primary:1,secondary:[1025],mac:{primary:1,secondary:[1025,294,257]}}})}runCoreEditingCommand(t,i,n){const[r,o]=yw.deleteLeft(i.getPrevEditOperationType(),i.cursorConfig,i.model,i.getCursorStates().map(a=>a.modelState.selection),i.getCursorAutoClosedCharacters());r&&t.pushUndoStop(),t.executeCommands(this.id,o),i.setPrevEditOperationType(2)}}),s.DeleteRight=Me(new class extends e{constructor(){super({id:"deleteRight",precondition:void 0,kbOpts:{weight:ui,kbExpr:z.textInputFocus,primary:20,mac:{primary:20,secondary:[290,276]}}})}runCoreEditingCommand(t,i,n){const[r,o]=yw.deleteRight(i.getPrevEditOperationType(),i.cursorConfig,i.model,i.getCursorStates().map(a=>a.modelState.selection));r&&t.pushUndoStop(),t.executeCommands(this.id,o),i.setPrevEditOperationType(3)}}),s.Undo=new class extends AH{constructor(){super(mhe)}runDOMCommand(t){t.ownerDocument.execCommand("undo")}runEditorCommand(t,i,n){if(!(!i.hasModel()||i.getOption(92)===!0))return i.getModel().undo()}},s.Redo=new class extends AH{constructor(){super(_he)}runDOMCommand(t){t.ownerDocument.execCommand("redo")}runEditorCommand(t,i,n){if(!(!i.hasModel()||i.getOption(92)===!0))return i.getModel().redo()}}})(Ay||(Ay={}));class Ese extends pF{constructor(e,t,i){super({id:e,precondition:void 0,metadata:i}),this._handlerId=t}runCommand(e,t){const i=e.get(ni).getFocusedCodeEditor();i&&i.trigger("keyboard",this._handlerId,t)}}function e0(s,e){Ise(new Ese("default:"+s,s)),Ise(new Ese(s,s,e))}e0("type",{description:"Type",args:[{name:"args",schema:{type:"object",required:["text"],properties:{text:{type:"string"}}}}]});e0("replacePreviousChar");e0("compositionType");e0("compositionStart");e0("compositionEnd");e0("paste");e0("cut");class tze{constructor(e,t,i,n){this.configuration=e,this.viewModel=t,this.userInputEvents=i,this.commandDelegate=n}paste(e,t,i,n){this.commandDelegate.paste(e,t,i,n)}type(e){this.commandDelegate.type(e)}compositionType(e,t,i,n){this.commandDelegate.compositionType(e,t,i,n)}compositionStart(){this.commandDelegate.startComposition()}compositionEnd(){this.commandDelegate.endComposition()}cut(){this.commandDelegate.cut()}setSelection(e){Ns.SetSelection.runCoreEditorCommand(this.viewModel,{source:"keyboard",selection:e})}_validateViewColumn(e){const t=this.viewModel.getLineMinColumn(e.lineNumber);return e.column<t?new X(e.lineNumber,t):e}_hasMulticursorModifier(e){switch(this.configuration.options.get(78)){case"altKey":return e.altKey;case"ctrlKey":return e.ctrlKey;case"metaKey":return e.metaKey;default:return!1}}_hasNonMulticursorModifier(e){switch(this.configuration.options.get(78)){case"altKey":return e.ctrlKey||e.metaKey;case"ctrlKey":return e.altKey||e.metaKey;case"metaKey":return e.ctrlKey||e.altKey;default:return!1}}dispatchMouse(e){const t=this.configuration.options,i=Lo&&t.get(108),n=t.get(22);e.middleButton&&!i?this._columnSelect(e.position,e.mouseColumn,e.inSelectionMode):e.startedOnLineNumbers?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelect(e.position,e.revealType):this._createCursor(e.position,!0):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount>=4?this._selectAll():e.mouseDownCount===3?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelectDrag(e.position,e.revealType):this._lastCursorLineSelect(e.position,e.revealType):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount===2?e.onInjectedText||(this._hasMulticursorModifier(e)?this._lastCursorWordSelect(e.position,e.revealType):e.inSelectionMode?this._wordSelectDrag(e.position,e.revealType):this._wordSelect(e.position,e.revealType)):this._hasMulticursorModifier(e)?this._hasNonMulticursorModifier(e)||(e.shiftKey?this._columnSelect(e.position,e.mouseColumn,!0):e.inSelectionMode?this._lastCursorMoveToSelect(e.position,e.revealType):this._createCursor(e.position,!1)):e.inSelectionMode?e.altKey?this._columnSelect(e.position,e.mouseColumn,!0):n?this._columnSelect(e.position,e.mouseColumn,!0):this._moveToSelect(e.position,e.revealType):this.moveTo(e.position,e.revealType)}_usualArgs(e,t){return e=this._validateViewColumn(e),{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,revealType:t}}moveTo(e,t){Ns.MoveTo.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_moveToSelect(e,t){Ns.MoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_columnSelect(e,t,i){e=this._validateViewColumn(e),Ns.ColumnSelect.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,mouseColumn:t,doColumnSelect:i})}_createCursor(e,t){e=this._validateViewColumn(e),Ns.CreateCursor.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,wholeLine:t})}_lastCursorMoveToSelect(e,t){Ns.LastCursorMoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelect(e,t){Ns.WordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelectDrag(e,t){Ns.WordSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorWordSelect(e,t){Ns.LastCursorWordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelect(e,t){Ns.LineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelectDrag(e,t){Ns.LineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelect(e,t){Ns.LastCursorLineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelectDrag(e,t){Ns.LastCursorLineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_selectAll(){Ns.SelectAll.runCoreEditorCommand(this.viewModel,{source:"mouse"})}_convertViewToModelPosition(e){return this.viewModel.coordinatesConverter.convertViewPositionToModelPosition(e)}emitKeyDown(e){this.userInputEvents.emitKeyDown(e)}emitKeyUp(e){this.userInputEvents.emitKeyUp(e)}emitContextMenu(e){this.userInputEvents.emitContextMenu(e)}emitMouseMove(e){this.userInputEvents.emitMouseMove(e)}emitMouseLeave(e){this.userInputEvents.emitMouseLeave(e)}emitMouseUp(e){this.userInputEvents.emitMouseUp(e)}emitMouseDown(e){this.userInputEvents.emitMouseDown(e)}emitMouseDrag(e){this.userInputEvents.emitMouseDrag(e)}emitMouseDrop(e){this.userInputEvents.emitMouseDrop(e)}emitMouseDropCanceled(){this.userInputEvents.emitMouseDropCanceled()}emitMouseWheel(e){this.userInputEvents.emitMouseWheel(e)}}class Zpe{constructor(e){this._lineFactory=e,this._set(1,[])}flush(){this._set(1,[])}_set(e,t){this._lines=t,this._rendLineNumberStart=e}_get(){return{rendLineNumberStart:this._rendLineNumberStart,lines:this._lines}}getStartLineNumber(){return this._rendLineNumberStart}getEndLineNumber(){return this._rendLineNumberStart+this._lines.length-1}getCount(){return this._lines.length}getLine(e){const t=e-this._rendLineNumberStart;if(t<0||t>=this._lines.length)throw new di("Illegal value for lineNumber");return this._lines[t]}onLinesDeleted(e,t){if(this.getCount()===0)return null;const i=this.getStartLineNumber(),n=this.getEndLineNumber();if(t<i){const l=t-e+1;return this._rendLineNumberStart-=l,null}if(e>n)return null;let r=0,o=0;for(let l=i;l<=n;l++){const c=l-this._rendLineNumberStart;e<=l&&l<=t&&(o===0?(r=c,o=1):o++)}if(e<i){let l=0;t<i?l=t-e+1:l=i-e,this._rendLineNumberStart-=l}return this._lines.splice(r,o)}onLinesChanged(e,t){const i=e+t-1;if(this.getCount()===0)return!1;const n=this.getStartLineNumber(),r=this.getEndLineNumber();let o=!1;for(let a=e;a<=i;a++)a>=n&&a<=r&&(this._lines[a-this._rendLineNumberStart].onContentChanged(),o=!0);return o}onLinesInserted(e,t){if(this.getCount()===0)return null;const i=t-e+1,n=this.getStartLineNumber(),r=this.getEndLineNumber();if(e<=n)return this._rendLineNumberStart+=i,null;if(e>r)return null;if(i+e>r)return this._lines.splice(e-this._rendLineNumberStart,r-e+1);const o=[];for(let u=0;u<i;u++)o[u]=this._lineFactory.createLine();const a=e-this._rendLineNumberStart,l=this._lines.slice(0,a),c=this._lines.slice(a,this._lines.length-i),d=this._lines.slice(this._lines.length-i,this._lines.length);return this._lines=l.concat(o).concat(c),d}onTokensChanged(e){if(this.getCount()===0)return!1;const t=this.getStartLineNumber(),i=this.getEndLineNumber();let n=!1;for(let r=0,o=e.length;r<o;r++){const a=e[r];if(a.toLineNumber<t||a.fromLineNumber>i)continue;const l=Math.max(t,a.fromLineNumber),c=Math.min(i,a.toLineNumber);for(let d=l;d<=c;d++){const u=d-this._rendLineNumberStart;this._lines[u].onTokensChanged(),n=!0}}return n}}class Jpe{constructor(e){this._lineFactory=e,this.domNode=this._createDomNode(),this._linesCollection=new Zpe(this._lineFactory)}_createDomNode(){const e=gi(document.createElement("div"));return e.setClassName("view-layer"),e.setPosition("absolute"),e.domNode.setAttribute("role","presentation"),e.domNode.setAttribute("aria-hidden","true"),e}onConfigurationChanged(e){return!!e.hasChanged(146)}onFlushed(e){return this._linesCollection.flush(),!0}onLinesChanged(e){return this._linesCollection.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){const t=this._linesCollection.onLinesDeleted(e.fromLineNumber,e.toLineNumber);if(t)for(let i=0,n=t.length;i<n;i++){const r=t[i].getDomNode();r==null||r.remove()}return!0}onLinesInserted(e){const t=this._linesCollection.onLinesInserted(e.fromLineNumber,e.toLineNumber);if(t)for(let i=0,n=t.length;i<n;i++){const r=t[i].getDomNode();r==null||r.remove()}return!0}onScrollChanged(e){return e.scrollTopChanged}onTokensChanged(e){return this._linesCollection.onTokensChanged(e.ranges)}onZonesChanged(e){return!0}getStartLineNumber(){return this._linesCollection.getStartLineNumber()}getEndLineNumber(){return this._linesCollection.getEndLineNumber()}getVisibleLine(e){return this._linesCollection.getLine(e)}renderLines(e){const t=this._linesCollection._get(),i=new PH(this.domNode.domNode,this._lineFactory,e),n={rendLineNumberStart:t.rendLineNumberStart,lines:t.lines,linesLength:t.lines.length},r=i.render(n,e.startLineNumber,e.endLineNumber,e.relativeVerticalOffset);this._linesCollection._set(r.rendLineNumberStart,r.lines)}}const If=class If{constructor(e,t,i){this._domNode=e,this._lineFactory=t,this._viewportData=i}render(e,t,i,n){const r={rendLineNumberStart:e.rendLineNumberStart,lines:e.lines.slice(0),linesLength:e.linesLength};if(r.rendLineNumberStart+r.linesLength-1<t||i<r.rendLineNumberStart){r.rendLineNumberStart=t,r.linesLength=i-t+1,r.lines=[];for(let o=t;o<=i;o++)r.lines[o-t]=this._lineFactory.createLine();return this._finishRendering(r,!0,n),r}if(this._renderUntouchedLines(r,Math.max(t-r.rendLineNumberStart,0),Math.min(i-r.rendLineNumberStart,r.linesLength-1),n,t),r.rendLineNumberStart>t){const o=t,a=Math.min(i,r.rendLineNumberStart-1);o<=a&&(this._insertLinesBefore(r,o,a,n,t),r.linesLength+=a-o+1)}else if(r.rendLineNumberStart<t){const o=Math.min(r.linesLength,t-r.rendLineNumberStart);o>0&&(this._removeLinesBefore(r,o),r.linesLength-=o)}if(r.rendLineNumberStart=t,r.rendLineNumberStart+r.linesLength-1<i){const o=r.rendLineNumberStart+r.linesLength,a=i;o<=a&&(this._insertLinesAfter(r,o,a,n,t),r.linesLength+=a-o+1)}else if(r.rendLineNumberStart+r.linesLength-1>i){const o=Math.max(0,i-r.rendLineNumberStart+1),l=r.linesLength-1-o+1;l>0&&(this._removeLinesAfter(r,l),r.linesLength-=l)}return this._finishRendering(r,!1,n),r}_renderUntouchedLines(e,t,i,n,r){const o=e.rendLineNumberStart,a=e.lines;for(let l=t;l<=i;l++){const c=o+l;a[l].layoutLine(c,n[c-r],this._viewportData.lineHeight)}}_insertLinesBefore(e,t,i,n,r){const o=[];let a=0;for(let l=t;l<=i;l++)o[a++]=this._lineFactory.createLine();e.lines=o.concat(e.lines)}_removeLinesBefore(e,t){for(let i=0;i<t;i++){const n=e.lines[i].getDomNode();n==null||n.remove()}e.lines.splice(0,t)}_insertLinesAfter(e,t,i,n,r){const o=[];let a=0;for(let l=t;l<=i;l++)o[a++]=this._lineFactory.createLine();e.lines=e.lines.concat(o)}_removeLinesAfter(e,t){const i=e.linesLength-t;for(let n=0;n<t;n++){const r=e.lines[i+n].getDomNode();r==null||r.remove()}e.lines.splice(i,t)}_finishRenderingNewLines(e,t,i,n){If._ttPolicy&&(i=If._ttPolicy.createHTML(i));const r=this._domNode.lastChild;t||!r?this._domNode.innerHTML=i:r.insertAdjacentHTML("afterend",i);let o=this._domNode.lastChild;for(let a=e.linesLength-1;a>=0;a--){const l=e.lines[a];n[a]&&(l.setDomNode(o),o=o.previousSibling)}}_finishRenderingInvalidLines(e,t,i){const n=document.createElement("div");If._ttPolicy&&(t=If._ttPolicy.createHTML(t)),n.innerHTML=t;for(let r=0;r<e.linesLength;r++){const o=e.lines[r];if(i[r]){const a=n.firstChild,l=o.getDomNode();l.parentNode.replaceChild(a,l),o.setDomNode(a)}}}_finishRendering(e,t,i){const n=If._sb,r=e.linesLength,o=e.lines,a=e.rendLineNumberStart,l=[];{n.reset();let c=!1;for(let d=0;d<r;d++){const u=o[d];l[d]=!1,!(u.getDomNode()||!u.renderLine(d+a,i[d],this._viewportData.lineHeight,this._viewportData,n))&&(l[d]=!0,c=!0)}c&&this._finishRenderingNewLines(e,t,n.build(),l)}{n.reset();let c=!1;const d=[];for(let u=0;u<r;u++){const h=o[u];d[u]=!1,!(l[u]||!h.renderLine(u+a,i[u],this._viewportData.lineHeight,this._viewportData,n))&&(d[u]=!0,c=!0)}c&&this._finishRenderingInvalidLines(e,n.build(),d)}}};If._ttPolicy=Og("editorViewLayer",{createHTML:e=>e}),If._sb=new hS(1e5);let PH=If;class eme extends za{constructor(e){super(e),this._dynamicOverlays=[],this._isFocused=!1,this._visibleLines=new Jpe({createLine:()=>new ize(this._dynamicOverlays)}),this.domNode=this._visibleLines.domNode;const i=this._context.configuration.options.get(50);Zs(this.domNode,i),this.domNode.setClassName("view-overlays")}shouldRender(){if(super.shouldRender())return!0;for(let e=0,t=this._dynamicOverlays.length;e<t;e++)if(this._dynamicOverlays[e].shouldRender())return!0;return!1}dispose(){super.dispose();for(let e=0,t=this._dynamicOverlays.length;e<t;e++)this._dynamicOverlays[e].dispose();this._dynamicOverlays=[]}getDomNode(){return this.domNode}addDynamicOverlay(e){this._dynamicOverlays.push(e)}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e);const i=this._context.configuration.options.get(50);return Zs(this.domNode,i),!0}onFlushed(e){return this._visibleLines.onFlushed(e)}onFocusChanged(e){return this._isFocused=e.isFocused,!0}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onScrollChanged(e){return this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._visibleLines.onZonesChanged(e)}prepareRender(e){const t=this._dynamicOverlays.filter(i=>i.shouldRender());for(let i=0,n=t.length;i<n;i++){const r=t[i];r.prepareRender(e),r.onDidRender()}}render(e){this._viewOverlaysRender(e),this.domNode.toggleClassName("focused",this._isFocused)}_viewOverlaysRender(e){this._visibleLines.renderLines(e.viewportData)}}class ize{constructor(e){this._dynamicOverlays=e,this._domNode=null,this._renderedContent=null}getDomNode(){return this._domNode?this._domNode.domNode:null}setDomNode(e){this._domNode=gi(e)}onContentChanged(){}onTokensChanged(){}renderLine(e,t,i,n,r){let o="";for(let a=0,l=this._dynamicOverlays.length;a<l;a++){const c=this._dynamicOverlays[a];o+=c.render(n.startLineNumber,e)}return this._renderedContent===o?!1:(this._renderedContent=o,r.appendString('<div style="top:'),r.appendString(String(t)),r.appendString("px;height:"),r.appendString(String(i)),r.appendString('px;">'),r.appendString(o),r.appendString("</div>"),!0)}layoutLine(e,t,i){this._domNode&&(this._domNode.setTop(t),this._domNode.setHeight(i))}}class nze extends eme{constructor(e){super(e);const i=this._context.configuration.options.get(146);this._contentWidth=i.contentWidth,this.domNode.setHeight(0)}onConfigurationChanged(e){const i=this._context.configuration.options.get(146);return this._contentWidth=i.contentWidth,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollWidthChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e),this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth))}}class sze extends eme{constructor(e){super(e);const t=this._context.configuration.options,i=t.get(146);this._contentLeft=i.contentLeft,this.domNode.setClassName("margin-view-overlays"),this.domNode.setWidth(1),Zs(this.domNode,t.get(50))}onConfigurationChanged(e){const t=this._context.configuration.options;Zs(this.domNode,t.get(50));const i=t.get(146);return this._contentLeft=i.contentLeft,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollHeightChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e);const t=Math.min(e.scrollHeight,1e6);this.domNode.setHeight(t),this.domNode.setWidth(this._contentLeft)}}class r5{constructor(e){this.onKeyDown=null,this.onKeyUp=null,this.onContextMenu=null,this.onMouseMove=null,this.onMouseLeave=null,this.onMouseDown=null,this.onMouseUp=null,this.onMouseDrag=null,this.onMouseDrop=null,this.onMouseDropCanceled=null,this.onMouseWheel=null,this._coordinatesConverter=e}emitKeyDown(e){var t;(t=this.onKeyDown)==null||t.call(this,e)}emitKeyUp(e){var t;(t=this.onKeyUp)==null||t.call(this,e)}emitContextMenu(e){var t;(t=this.onContextMenu)==null||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseMove(e){var t;(t=this.onMouseMove)==null||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseLeave(e){var t;(t=this.onMouseLeave)==null||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDown(e){var t;(t=this.onMouseDown)==null||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseUp(e){var t;(t=this.onMouseUp)==null||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDrag(e){var t;(t=this.onMouseDrag)==null||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDrop(e){var t;(t=this.onMouseDrop)==null||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDropCanceled(){var e;(e=this.onMouseDropCanceled)==null||e.call(this)}emitMouseWheel(e){var t;(t=this.onMouseWheel)==null||t.call(this,e)}_convertViewToModelMouseEvent(e){return e.target?{event:e.event,target:this._convertViewToModelMouseTarget(e.target)}:e}_convertViewToModelMouseTarget(e){return r5.convertViewToModelMouseTarget(e,this._coordinatesConverter)}static convertViewToModelMouseTarget(e,t){const i={...e};return i.position&&(i.position=t.convertViewPositionToModelPosition(i.position)),i.range&&(i.range=t.convertViewRangeToModelRange(i.range)),(i.type===5||i.type===8)&&(i.detail=this.convertViewToModelViewZoneData(i.detail,t)),i}static convertViewToModelViewZoneData(e,t){return{viewZoneId:e.viewZoneId,positionBefore:e.positionBefore?t.convertViewPositionToModelPosition(e.positionBefore):e.positionBefore,positionAfter:e.positionAfter?t.convertViewPositionToModelPosition(e.positionAfter):e.positionAfter,position:t.convertViewPositionToModelPosition(e.position),afterLineNumber:t.convertViewPositionToModelPosition(new X(e.afterLineNumber,1)).lineNumber}}}class rze extends za{constructor(e){super(e),this.blocks=[],this.contentWidth=-1,this.contentLeft=0,this.domNode=gi(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("blockDecorations-container"),this.update()}update(){let e=!1;const i=this._context.configuration.options.get(146),n=i.contentWidth-i.verticalScrollbarWidth;this.contentWidth!==n&&(this.contentWidth=n,e=!0);const r=i.contentLeft;return this.contentLeft!==r&&(this.contentLeft=r,e=!0),e}dispose(){super.dispose()}onConfigurationChanged(e){return this.update()}onScrollChanged(e){return e.scrollTopChanged||e.scrollLeftChanged}onDecorationsChanged(e){return!0}onZonesChanged(e){return!0}prepareRender(e){}render(e){let t=0;const i=e.getDecorationsInViewport();for(const n of i){if(!n.options.blockClassName)continue;let r=this.blocks[t];r||(r=this.blocks[t]=gi(document.createElement("div")),this.domNode.appendChild(r));let o,a;n.options.blockIsAfterEnd?(o=e.getVerticalOffsetAfterLineNumber(n.range.endLineNumber,!1),a=e.getVerticalOffsetAfterLineNumber(n.range.endLineNumber,!0)):(o=e.getVerticalOffsetForLineNumber(n.range.startLineNumber,!0),a=n.range.isEmpty()&&!n.options.blockDoesNotCollapse?e.getVerticalOffsetForLineNumber(n.range.startLineNumber,!1):e.getVerticalOffsetAfterLineNumber(n.range.endLineNumber,!0));const[l,c,d,u]=n.options.blockPadding??[0,0,0,0];r.setClassName("blockDecorations-block "+n.options.blockClassName),r.setLeft(this.contentLeft-u),r.setWidth(this.contentWidth+u+c),r.setTop(o-e.scrollTop-l),r.setHeight(a-o+l+d),t++}for(let n=t;n<this.blocks.length;n++)this.blocks[n].domNode.remove();this.blocks.length=t}}class oze extends za{constructor(e,t){super(e),this._viewDomNode=t,this._widgets={},this.domNode=gi(document.createElement("div")),mu.write(this.domNode,1),this.domNode.setClassName("contentWidgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this.overflowingContentWidgetsDomNode=gi(document.createElement("div")),mu.write(this.overflowingContentWidgetsDomNode,2),this.overflowingContentWidgetsDomNode.setClassName("overflowingContentWidgets")}dispose(){super.dispose(),this._widgets={}}onConfigurationChanged(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].onConfigurationChanged(e);return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLineMappingChanged(e){return this._updateAnchorsViewPositions(),!0}onLinesChanged(e){return this._updateAnchorsViewPositions(),!0}onLinesDeleted(e){return this._updateAnchorsViewPositions(),!0}onLinesInserted(e){return this._updateAnchorsViewPositions(),!0}onScrollChanged(e){return!0}onZonesChanged(e){return!0}_updateAnchorsViewPositions(){const e=Object.keys(this._widgets);for(const t of e)this._widgets[t].updateAnchorViewPosition()}addWidget(e){const t=new aze(this._context,this._viewDomNode,e);this._widgets[t.id]=t,t.allowEditorOverflow?this.overflowingContentWidgetsDomNode.appendChild(t.domNode):this.domNode.appendChild(t.domNode),this.setShouldRender()}setWidgetPosition(e,t,i,n,r){this._widgets[e.getId()].setPosition(t,i,n,r),this.setShouldRender()}removeWidget(e){const t=e.getId();if(this._widgets.hasOwnProperty(t)){const i=this._widgets[t];delete this._widgets[t];const n=i.domNode.domNode;n.remove(),n.removeAttribute("monaco-visible-content-widget"),this.setShouldRender()}}shouldSuppressMouseDownOnWidget(e){return this._widgets.hasOwnProperty(e)?this._widgets[e].suppressMouseDown:!1}onBeforeRender(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].onBeforeRender(e)}prepareRender(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].prepareRender(e)}render(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].render(e)}}class aze{constructor(e,t,i){this._primaryAnchor=new Px(null,null),this._secondaryAnchor=new Px(null,null),this._context=e,this._viewDomNode=t,this._actual=i,this.domNode=gi(this._actual.getDomNode()),this.id=this._actual.getId(),this.allowEditorOverflow=this._actual.allowEditorOverflow||!1,this.suppressMouseDown=this._actual.suppressMouseDown||!1;const n=this._context.configuration.options,r=n.get(146);this._fixedOverflowWidgets=n.get(42),this._contentWidth=r.contentWidth,this._contentLeft=r.contentLeft,this._lineHeight=n.get(67),this._affinity=null,this._preference=[],this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1,this._maxWidth=this._getMaxWidth(),this._isVisible=!1,this._renderData=null,this.domNode.setPosition(this._fixedOverflowWidgets&&this.allowEditorOverflow?"fixed":"absolute"),this.domNode.setDisplay("none"),this.domNode.setVisibility("hidden"),this.domNode.setAttribute("widgetId",this.id),this.domNode.setMaxWidth(this._maxWidth)}onConfigurationChanged(e){const t=this._context.configuration.options;if(this._lineHeight=t.get(67),e.hasChanged(146)){const i=t.get(146);this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._maxWidth=this._getMaxWidth()}}updateAnchorViewPosition(){this._setPosition(this._affinity,this._primaryAnchor.modelPosition,this._secondaryAnchor.modelPosition)}_setPosition(e,t,i){this._affinity=e,this._primaryAnchor=n(t,this._context.viewModel,this._affinity),this._secondaryAnchor=n(i,this._context.viewModel,this._affinity);function n(r,o,a){if(!r)return new Px(null,null);const l=o.model.validatePosition(r);if(o.coordinatesConverter.modelPositionIsVisible(l)){const c=o.coordinatesConverter.convertModelPositionToViewPosition(l,a??void 0);return new Px(r,c)}return new Px(r,null)}}_getMaxWidth(){const e=this.domNode.domNode.ownerDocument,t=e.defaultView;return this.allowEditorOverflow?(t==null?void 0:t.innerWidth)||e.documentElement.offsetWidth||e.body.offsetWidth:this._contentWidth}setPosition(e,t,i,n){this._setPosition(n,e,t),this._preference=i,this._primaryAnchor.viewPosition&&this._preference&&this._preference.length>0?this.domNode.setDisplay("block"):this.domNode.setDisplay("none"),this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1}_layoutBoxInViewport(e,t,i,n){const r=e.top,o=r,a=e.top+e.height,l=n.viewportHeight-a,c=r-i,d=o>=i,u=a,h=l>=i;let g=e.left;return g+t>n.scrollLeft+n.viewportWidth&&(g=n.scrollLeft+n.viewportWidth-t),g<n.scrollLeft&&(g=n.scrollLeft),{fitsAbove:d,aboveTop:c,fitsBelow:h,belowTop:u,left:g}}_layoutHorizontalSegmentInPage(e,t,i,n){const a=Math.max(15,t.left-n),l=Math.min(t.left+t.width+n,e.width-15),d=this._viewDomNode.domNode.ownerDocument.defaultView;let u=t.left+i-((d==null?void 0:d.scrollX)??0);if(u+n>l){const h=u-(l-n);u-=h,i-=h}if(u<a){const h=u-a;u-=h,i-=h}return[i,u]}_layoutBoxInPage(e,t,i,n){const r=e.top-i,o=e.top+e.height,a=Pn(this._viewDomNode.domNode),l=this._viewDomNode.domNode.ownerDocument,c=l.defaultView,d=a.top+r-((c==null?void 0:c.scrollY)??0),u=a.top+o-((c==null?void 0:c.scrollY)??0),h=qm(l.body),[g,p]=this._layoutHorizontalSegmentInPage(h,a,e.left-n.scrollLeft+this._contentLeft,t),_=22,v=22,C=d>=_,y=u+i<=h.height-v;return this._fixedOverflowWidgets?{fitsAbove:C,aboveTop:Math.max(d,_),fitsBelow:y,belowTop:u,left:p}:{fitsAbove:C,aboveTop:r,fitsBelow:y,belowTop:o,left:g}}_prepareRenderWidgetAtExactPositionOverflowing(e){return new Mx(e.top,e.left+this._contentLeft)}_getAnchorsCoordinates(e){var o,a;const t=r(this._primaryAnchor.viewPosition,this._affinity,this._lineHeight),i=((o=this._secondaryAnchor.viewPosition)==null?void 0:o.lineNumber)===((a=this._primaryAnchor.viewPosition)==null?void 0:a.lineNumber)?this._secondaryAnchor.viewPosition:null,n=r(i,this._affinity,this._lineHeight);return{primary:t,secondary:n};function r(l,c,d){if(!l)return null;const u=e.visibleRangeForPosition(l);if(!u)return null;const h=l.column===1&&c===3?0:u.left,g=e.getVerticalOffsetForLineNumber(l.lineNumber)-e.scrollTop;return new Dse(g,h,d)}}_reduceAnchorCoordinates(e,t,i){if(!t)return e;const n=this._context.configuration.options.get(50);let r=t.left;return r<e.left?r=Math.max(r,e.left-i+n.typicalFullwidthCharacterWidth):r=Math.min(r,e.left+i-n.typicalFullwidthCharacterWidth),new Dse(e.top,r,e.height)}_prepareRenderWidget(e){if(!this._preference||this._preference.length===0)return null;const{primary:t,secondary:i}=this._getAnchorsCoordinates(e);if(!t)return{kind:"offViewport",preserveFocus:this.domNode.domNode.contains(this.domNode.domNode.ownerDocument.activeElement)};if(this._cachedDomNodeOffsetWidth===-1||this._cachedDomNodeOffsetHeight===-1){let o=null;if(typeof this._actual.beforeRender=="function"&&(o=aB(this._actual.beforeRender,this._actual)),o)this._cachedDomNodeOffsetWidth=o.width,this._cachedDomNodeOffsetHeight=o.height;else{const l=this.domNode.domNode.getBoundingClientRect();this._cachedDomNodeOffsetWidth=Math.round(l.width),this._cachedDomNodeOffsetHeight=Math.round(l.height)}}const n=this._reduceAnchorCoordinates(t,i,this._cachedDomNodeOffsetWidth);let r;this.allowEditorOverflow?r=this._layoutBoxInPage(n,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,e):r=this._layoutBoxInViewport(n,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,e);for(let o=1;o<=2;o++)for(const a of this._preference)if(a===1){if(!r)return null;if(o===2||r.fitsAbove)return{kind:"inViewport",coordinate:new Mx(r.aboveTop,r.left),position:1}}else if(a===2){if(!r)return null;if(o===2||r.fitsBelow)return{kind:"inViewport",coordinate:new Mx(r.belowTop,r.left),position:2}}else return this.allowEditorOverflow?{kind:"inViewport",coordinate:this._prepareRenderWidgetAtExactPositionOverflowing(new Mx(n.top,n.left)),position:0}:{kind:"inViewport",coordinate:new Mx(n.top,n.left),position:0};return null}onBeforeRender(e){!this._primaryAnchor.viewPosition||!this._preference||this._primaryAnchor.viewPosition.lineNumber<e.startLineNumber||this._primaryAnchor.viewPosition.lineNumber>e.endLineNumber||this.domNode.setMaxWidth(this._maxWidth)}prepareRender(e){this._renderData=this._prepareRenderWidget(e)}render(e){var t;if(!this._renderData||this._renderData.kind==="offViewport"){this._isVisible&&(this.domNode.removeAttribute("monaco-visible-content-widget"),this._isVisible=!1,((t=this._renderData)==null?void 0:t.kind)==="offViewport"&&this._renderData.preserveFocus?this.domNode.setTop(-1e3):this.domNode.setVisibility("hidden")),typeof this._actual.afterRender=="function"&&aB(this._actual.afterRender,this._actual,null);return}this.allowEditorOverflow?(this.domNode.setTop(this._renderData.coordinate.top),this.domNode.setLeft(this._renderData.coordinate.left)):(this.domNode.setTop(this._renderData.coordinate.top+e.scrollTop-e.bigNumbersDelta),this.domNode.setLeft(this._renderData.coordinate.left)),this._isVisible||(this.domNode.setVisibility("inherit"),this.domNode.setAttribute("monaco-visible-content-widget","true"),this._isVisible=!0),typeof this._actual.afterRender=="function"&&aB(this._actual.afterRender,this._actual,this._renderData.position)}}class Px{constructor(e,t){this.modelPosition=e,this.viewPosition=t}}class Mx{constructor(e,t){this.top=e,this.left=t,this._coordinateBrand=void 0}}class Dse{constructor(e,t,i){this.top=e,this.left=t,this.height=i,this._anchorCoordinateBrand=void 0}}function aB(s,e,...t){try{return s.call(e,...t)}catch{return null}}class tme extends Jw{constructor(e){super(),this._context=e;const t=this._context.configuration.options,i=t.get(146);this._renderLineHighlight=t.get(97),this._renderLineHighlightOnlyWhenFocus=t.get(98),this._wordWrap=i.isViewportWrapping,this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._selectionIsEmpty=!0,this._focused=!1,this._cursorLineNumbers=[1],this._selections=[new Ue(1,1,1,1)],this._renderData=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}_readFromSelections(){let e=!1;const t=new Set;for(const r of this._selections)t.add(r.positionLineNumber);const i=Array.from(t);i.sort((r,o)=>r-o),dn(this._cursorLineNumbers,i)||(this._cursorLineNumbers=i,e=!0);const n=this._selections.every(r=>r.isEmpty());return this._selectionIsEmpty!==n&&(this._selectionIsEmpty=n,e=!0),e}onThemeChanged(e){return this._readFromSelections()}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(146);return this._renderLineHighlight=t.get(97),this._renderLineHighlightOnlyWhenFocus=t.get(98),this._wordWrap=i.isViewportWrapping,this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,!0}onCursorStateChanged(e){return this._selections=e.selections,this._readFromSelections()}onFlushed(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollWidthChanged||e.scrollTopChanged}onZonesChanged(e){return!0}onFocusChanged(e){return this._renderLineHighlightOnlyWhenFocus?(this._focused=e.isFocused,!0):!1}prepareRender(e){if(!this._shouldRenderThis()){this._renderData=null;return}const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=[];for(let o=t;o<=i;o++){const a=o-t;n[a]=""}if(this._wordWrap){const o=this._renderOne(e,!1);for(const a of this._cursorLineNumbers){const l=this._context.viewModel.coordinatesConverter,c=l.convertViewPositionToModelPosition(new X(a,1)).lineNumber,d=l.convertModelPositionToViewPosition(new X(c,1)).lineNumber,u=l.convertModelPositionToViewPosition(new X(c,this._context.viewModel.model.getLineMaxColumn(c))).lineNumber,h=Math.max(d,t),g=Math.min(u,i);for(let p=h;p<=g;p++){const _=p-t;n[_]=o}}}const r=this._renderOne(e,!0);for(const o of this._cursorLineNumbers){if(o<t||o>i)continue;const a=o-t;n[a]=r}this._renderData=n}render(e,t){if(!this._renderData)return"";const i=t-e;return i>=this._renderData.length?"":this._renderData[i]}_shouldRenderInMargin(){return(this._renderLineHighlight==="gutter"||this._renderLineHighlight==="all")&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}_shouldRenderInContent(){return(this._renderLineHighlight==="line"||this._renderLineHighlight==="all")&&this._selectionIsEmpty&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}}class lze extends tme{_renderOne(e,t){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-both":"")+(t?" current-line-exact":"")}" style="width:${Math.max(e.scrollWidth,this._contentWidth)}px;"></div>`}_shouldRenderThis(){return this._shouldRenderInContent()}_shouldRenderOther(){return this._shouldRenderInMargin()}}class cze extends tme{_renderOne(e,t){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-margin":"")+(this._shouldRenderOther()?" current-line-margin-both":"")+(this._shouldRenderInMargin()&&t?" current-line-exact-margin":"")}" style="width:${this._contentLeft}px"></div>`}_shouldRenderThis(){return!0}_shouldRenderOther(){return this._shouldRenderInContent()}}Lc((s,e)=>{const t=s.getColor(fge);if(t&&(e.addRule(`.monaco-editor .view-overlays .current-line { background-color: ${t}; }`),e.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { background-color: ${t}; border: none; }`)),!t||t.isTransparent()||s.defines(mne)){const i=s.getColor(mne);i&&(e.addRule(`.monaco-editor .view-overlays .current-line-exact { border: 2px solid ${i}; }`),e.addRule(`.monaco-editor .margin-view-overlays .current-line-exact-margin { border: 2px solid ${i}; }`),su(s.type)&&(e.addRule(".monaco-editor .view-overlays .current-line-exact { border-width: 1px; }"),e.addRule(".monaco-editor .margin-view-overlays .current-line-exact-margin { border-width: 1px; }")))}});class dze extends Jw{constructor(e){super(),this._context=e;const t=this._context.configuration.options;this._typicalHalfwidthCharacterWidth=t.get(50).typicalHalfwidthCharacterWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return this._typicalHalfwidthCharacterWidth=t.get(50).typicalHalfwidthCharacterWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}prepareRender(e){const t=e.getDecorationsInViewport();let i=[],n=0;for(let l=0,c=t.length;l<c;l++){const d=t[l];d.options.className&&(i[n++]=d)}i=i.sort((l,c)=>{if(l.options.zIndex<c.options.zIndex)return-1;if(l.options.zIndex>c.options.zIndex)return 1;const d=l.options.className,u=c.options.className;return d<u?-1:d>u?1:F.compareRangesUsingStarts(l.range,c.range)});const r=e.visibleRange.startLineNumber,o=e.visibleRange.endLineNumber,a=[];for(let l=r;l<=o;l++){const c=l-r;a[c]=""}this._renderWholeLineDecorations(e,i,a),this._renderNormalDecorations(e,i,a),this._renderResult=a}_renderWholeLineDecorations(e,t,i){const n=e.visibleRange.startLineNumber,r=e.visibleRange.endLineNumber;for(let o=0,a=t.length;o<a;o++){const l=t[o];if(!l.options.isWholeLine)continue;const c='<div class="cdr '+l.options.className+'" style="left:0;width:100%;"></div>',d=Math.max(l.range.startLineNumber,n),u=Math.min(l.range.endLineNumber,r);for(let h=d;h<=u;h++){const g=h-n;i[g]+=c}}}_renderNormalDecorations(e,t,i){const n=e.visibleRange.startLineNumber;let r=null,o=!1,a=null,l=!1;for(let c=0,d=t.length;c<d;c++){const u=t[c];if(u.options.isWholeLine)continue;const h=u.options.className,g=!!u.options.showIfCollapsed;let p=u.range;if(g&&p.endColumn===1&&p.endLineNumber!==p.startLineNumber&&(p=new F(p.startLineNumber,p.startColumn,p.endLineNumber-1,this._context.viewModel.getLineMaxColumn(p.endLineNumber-1))),r===h&&o===g&&F.areIntersectingOrTouching(a,p)){a=F.plusRange(a,p);continue}r!==null&&this._renderNormalDecoration(e,a,r,l,o,n,i),r=h,o=g,a=p,l=u.options.shouldFillLineOnLineBreak??!1}r!==null&&this._renderNormalDecoration(e,a,r,l,o,n,i)}_renderNormalDecoration(e,t,i,n,r,o,a){const l=e.linesVisibleRangesForRange(t,i==="findMatch");if(l)for(let c=0,d=l.length;c<d;c++){const u=l[c];if(u.outsideRenderedLine)continue;const h=u.lineNumber-o;if(r&&u.ranges.length===1){const g=u.ranges[0];if(g.width<this._typicalHalfwidthCharacterWidth){const p=Math.round(g.left+g.width/2),_=Math.max(0,Math.round(p-this._typicalHalfwidthCharacterWidth/2));u.ranges[0]=new t5(_,this._typicalHalfwidthCharacterWidth)}}for(let g=0,p=u.ranges.length;g<p;g++){const _=n&&u.continuesOnNextLine&&p===1,v=u.ranges[g],C='<div class="cdr '+i+'" style="left:'+String(v.left)+"px;width:"+(_?"100%;":String(v.width)+"px;")+'"></div>';a[h]+=C}}}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}class uze extends za{constructor(e,t,i,n){super(e);const r=this._context.configuration.options,o=r.get(104),a=r.get(75),l=r.get(40),c=r.get(107),d={listenOnDomNode:i.domNode,className:"editor-scrollable "+_6(e.theme.type),useShadows:!1,lazyRender:!0,vertical:o.vertical,horizontal:o.horizontal,verticalHasArrows:o.verticalHasArrows,horizontalHasArrows:o.horizontalHasArrows,verticalScrollbarSize:o.verticalScrollbarSize,verticalSliderSize:o.verticalSliderSize,horizontalScrollbarSize:o.horizontalScrollbarSize,horizontalSliderSize:o.horizontalSliderSize,handleMouseWheel:o.handleMouseWheel,alwaysConsumeMouseWheel:o.alwaysConsumeMouseWheel,arrowSize:o.arrowSize,mouseWheelScrollSensitivity:a,fastScrollSensitivity:l,scrollPredominantAxis:c,scrollByPage:o.scrollByPage};this.scrollbar=this._register(new DF(t.domNode,d,this._context.viewLayout.getScrollable())),mu.write(this.scrollbar.getDomNode(),6),this.scrollbarDomNode=gi(this.scrollbar.getDomNode()),this.scrollbarDomNode.setPosition("absolute"),this._setLayout();const u=(h,g,p)=>{const _={};{const v=h.scrollTop;v&&(_.scrollTop=this._context.viewLayout.getCurrentScrollTop()+v,h.scrollTop=0)}if(p){const v=h.scrollLeft;v&&(_.scrollLeft=this._context.viewLayout.getCurrentScrollLeft()+v,h.scrollLeft=0)}this._context.viewModel.viewLayout.setScrollPosition(_,1)};this._register(oe(i.domNode,"scroll",h=>u(i.domNode,!0,!0))),this._register(oe(t.domNode,"scroll",h=>u(t.domNode,!0,!1))),this._register(oe(n.domNode,"scroll",h=>u(n.domNode,!0,!1))),this._register(oe(this.scrollbarDomNode.domNode,"scroll",h=>u(this.scrollbarDomNode.domNode,!0,!1)))}dispose(){super.dispose()}_setLayout(){const e=this._context.configuration.options,t=e.get(146);this.scrollbarDomNode.setLeft(t.contentLeft),e.get(73).side==="right"?this.scrollbarDomNode.setWidth(t.contentWidth+t.minimap.minimapWidth):this.scrollbarDomNode.setWidth(t.contentWidth),this.scrollbarDomNode.setHeight(t.height)}getOverviewRulerLayoutInfo(){return this.scrollbar.getOverviewRulerLayoutInfo()}getDomNode(){return this.scrollbarDomNode}delegateVerticalScrollbarPointerDown(e){this.scrollbar.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){this.scrollbar.delegateScrollFromMouseWheelEvent(e)}onConfigurationChanged(e){if(e.hasChanged(104)||e.hasChanged(75)||e.hasChanged(40)){const t=this._context.configuration.options,i=t.get(104),n=t.get(75),r=t.get(40),o=t.get(107),a={vertical:i.vertical,horizontal:i.horizontal,verticalScrollbarSize:i.verticalScrollbarSize,horizontalScrollbarSize:i.horizontalScrollbarSize,scrollByPage:i.scrollByPage,handleMouseWheel:i.handleMouseWheel,mouseWheelScrollSensitivity:n,fastScrollSensitivity:r,scrollPredominantAxis:o};this.scrollbar.updateOptions(a)}return e.hasChanged(146)&&this._setLayout(),!0}onScrollChanged(e){return!0}onThemeChanged(e){return this.scrollbar.updateClassName("editor-scrollable "+_6(this._context.theme.type)),!0}prepareRender(e){}render(e){this.scrollbar.renderNow()}}class MH{constructor(e,t,i,n,r){this.startLineNumber=e,this.endLineNumber=t,this.className=i,this.tooltip=n,this._decorationToRenderBrand=void 0,this.zIndex=r??0}}class hze{constructor(e,t,i){this.className=e,this.zIndex=t,this.tooltip=i}}class fze{constructor(){this.decorations=[]}add(e){this.decorations.push(e)}getDecorations(){return this.decorations}}class ime extends Jw{_render(e,t,i){const n=[];for(let a=e;a<=t;a++){const l=a-e;n[l]=new fze}if(i.length===0)return n;i.sort((a,l)=>a.className===l.className?a.startLineNumber===l.startLineNumber?a.endLineNumber-l.endLineNumber:a.startLineNumber-l.startLineNumber:a.className<l.className?-1:1);let r=null,o=0;for(let a=0,l=i.length;a<l;a++){const c=i[a],d=c.className,u=c.zIndex;let h=Math.max(c.startLineNumber,e)-e;const g=Math.min(c.endLineNumber,t)-e;r===d?(h=Math.max(o+1,h),o=Math.max(o,g)):(r=d,o=g);for(let p=h;p<=o;p++)n[p].add(new hze(d,u,c.tooltip))}return n}}class gze extends za{constructor(e){super(e),this._widgets={},this._context=e;const t=this._context.configuration.options,i=t.get(146);this.domNode=gi(document.createElement("div")),this.domNode.setClassName("glyph-margin-widgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this._lineHeight=t.get(67),this._glyphMargin=t.get(57),this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._glyphMarginDecorationLaneCount=i.glyphMarginDecorationLaneCount,this._managedDomNodes=[],this._decorationGlyphsToRender=[]}dispose(){this._managedDomNodes=[],this._decorationGlyphsToRender=[],this._widgets={},super.dispose()}getWidgets(){return Object.values(this._widgets)}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(146);return this._lineHeight=t.get(67),this._glyphMargin=t.get(57),this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._glyphMarginDecorationLaneCount=i.glyphMarginDecorationLaneCount,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}addWidget(e){const t=gi(e.getDomNode());this._widgets[e.getId()]={widget:e,preference:e.getPosition(),domNode:t,renderInfo:null},t.setPosition("absolute"),t.setDisplay("none"),t.setAttribute("widgetId",e.getId()),this.domNode.appendChild(t),this.setShouldRender()}setWidgetPosition(e,t){const i=this._widgets[e.getId()];return i.preference.lane===t.lane&&i.preference.zIndex===t.zIndex&&F.equalsRange(i.preference.range,t.range)?!1:(i.preference=t,this.setShouldRender(),!0)}removeWidget(e){const t=e.getId();if(this._widgets[t]){const n=this._widgets[t].domNode.domNode;delete this._widgets[t],n.remove(),this.setShouldRender()}}_collectDecorationBasedGlyphRenderRequest(e,t){var o;const i=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,r=e.getDecorationsInViewport();for(const a of r){const l=a.options.glyphMarginClassName;if(!l)continue;const c=Math.max(a.range.startLineNumber,i),d=Math.min(a.range.endLineNumber,n),u=((o=a.options.glyphMargin)==null?void 0:o.position)??ld.Center,h=a.options.zIndex??0;for(let g=c;g<=d;g++){const p=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new X(g,0)),_=this._context.viewModel.glyphLanes.getLanesAtLine(p.lineNumber).indexOf(u);t.push(new pze(g,_,h,l))}}}_collectWidgetBasedGlyphRenderRequest(e,t){const i=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber;for(const r of Object.values(this._widgets)){const o=r.preference.range,{startLineNumber:a,endLineNumber:l}=this._context.viewModel.coordinatesConverter.convertModelRangeToViewRange(F.lift(o));if(!a||!l||l<i||a>n)continue;const c=Math.max(a,i),d=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new X(c,0)),u=this._context.viewModel.glyphLanes.getLanesAtLine(d.lineNumber).indexOf(r.preference.lane);t.push(new mze(c,u,r.preference.zIndex,r))}}_collectSortedGlyphRenderRequests(e){const t=[];return this._collectDecorationBasedGlyphRenderRequest(e,t),this._collectWidgetBasedGlyphRenderRequest(e,t),t.sort((i,n)=>i.lineNumber===n.lineNumber?i.laneIndex===n.laneIndex?i.zIndex===n.zIndex?n.type===i.type?i.type===0&&n.type===0?i.className<n.className?-1:1:0:n.type-i.type:n.zIndex-i.zIndex:i.laneIndex-n.laneIndex:i.lineNumber-n.lineNumber),t}prepareRender(e){if(!this._glyphMargin){this._decorationGlyphsToRender=[];return}for(const n of Object.values(this._widgets))n.renderInfo=null;const t=new Cg(this._collectSortedGlyphRenderRequests(e)),i=[];for(;t.length>0;){const n=t.peek();if(!n)break;const r=t.takeWhile(a=>a.lineNumber===n.lineNumber&&a.laneIndex===n.laneIndex);if(!r||r.length===0)break;const o=r[0];if(o.type===0){const a=[];for(const l of r){if(l.zIndex!==o.zIndex||l.type!==o.type)break;(a.length===0||a[a.length-1]!==l.className)&&a.push(l.className)}i.push(o.accept(a.join(" ")))}else o.widget.renderInfo={lineNumber:o.lineNumber,laneIndex:o.laneIndex}}this._decorationGlyphsToRender=i}render(e){if(!this._glyphMargin){for(const i of Object.values(this._widgets))i.domNode.setDisplay("none");for(;this._managedDomNodes.length>0;){const i=this._managedDomNodes.pop();i==null||i.domNode.remove()}return}const t=Math.round(this._glyphMarginWidth/this._glyphMarginDecorationLaneCount);for(const i of Object.values(this._widgets))if(!i.renderInfo)i.domNode.setDisplay("none");else{const n=e.viewportData.relativeVerticalOffset[i.renderInfo.lineNumber-e.viewportData.startLineNumber],r=this._glyphMarginLeft+i.renderInfo.laneIndex*this._lineHeight;i.domNode.setDisplay("block"),i.domNode.setTop(n),i.domNode.setLeft(r),i.domNode.setWidth(t),i.domNode.setHeight(this._lineHeight)}for(let i=0;i<this._decorationGlyphsToRender.length;i++){const n=this._decorationGlyphsToRender[i],r=e.viewportData.relativeVerticalOffset[n.lineNumber-e.viewportData.startLineNumber],o=this._glyphMarginLeft+n.laneIndex*this._lineHeight;let a;i<this._managedDomNodes.length?a=this._managedDomNodes[i]:(a=gi(document.createElement("div")),this._managedDomNodes.push(a),this.domNode.appendChild(a)),a.setClassName("cgmr codicon "+n.combinedClassName),a.setPosition("absolute"),a.setTop(r),a.setLeft(o),a.setWidth(t),a.setHeight(this._lineHeight)}for(;this._managedDomNodes.length>this._decorationGlyphsToRender.length;){const i=this._managedDomNodes.pop();i==null||i.domNode.remove()}}}class pze{constructor(e,t,i,n){this.lineNumber=e,this.laneIndex=t,this.zIndex=i,this.className=n,this.type=0}accept(e){return new _ze(this.lineNumber,this.laneIndex,e)}}class mze{constructor(e,t,i,n){this.lineNumber=e,this.laneIndex=t,this.zIndex=i,this.widget=n,this.type=1}}class _ze{constructor(e,t,i){this.lineNumber=e,this.laneIndex=t,this.combinedClassName=i}}class bze extends Jw{constructor(e){super(),this._context=e,this._primaryPosition=null;const t=this._context.configuration.options,i=t.get(147),n=t.get(50);this._spaceWidth=n.spaceWidth,this._maxIndentLeft=i.wrappingColumn===-1?-1:i.wrappingColumn*n.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=t.get(16),this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(147),n=t.get(50);return this._spaceWidth=n.spaceWidth,this._maxIndentLeft=i.wrappingColumn===-1?-1:i.wrappingColumn*n.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=t.get(16),!0}onCursorStateChanged(e){var n;const i=e.selections[0].getPosition();return(n=this._primaryPosition)!=null&&n.equals(i)?!1:(this._primaryPosition=i,!0)}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onLanguageConfigurationChanged(e){return!0}prepareRender(e){var l,c;if(!this._bracketPairGuideOptions.indentation&&this._bracketPairGuideOptions.bracketPairs===!1){this._renderResult=null;return}const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=e.scrollWidth,r=this._primaryPosition,o=this.getGuidesByLine(t,Math.min(i+1,this._context.viewModel.getLineCount()),r),a=[];for(let d=t;d<=i;d++){const u=d-t,h=o[u];let g="";const p=((l=e.visibleRangeForPosition(new X(d,1)))==null?void 0:l.left)??0;for(const _ of h){const v=_.column===-1?p+(_.visibleColumn-1)*this._spaceWidth:e.visibleRangeForPosition(new X(d,_.column)).left;if(v>n||this._maxIndentLeft>0&&v>this._maxIndentLeft)break;const C=_.horizontalLine?_.horizontalLine.top?"horizontal-top":"horizontal-bottom":"vertical",y=_.horizontalLine?(((c=e.visibleRangeForPosition(new X(d,_.horizontalLine.endColumn)))==null?void 0:c.left)??v+this._spaceWidth)-v:this._spaceWidth;g+=`<div class="core-guide ${_.className} ${C}" style="left:${v}px;width:${y}px"></div>`}a[u]=g}this._renderResult=a}getGuidesByLine(e,t,i){const n=this._bracketPairGuideOptions.bracketPairs!==!1?this._context.viewModel.getBracketGuidesInRangeByLine(e,t,i,{highlightActive:this._bracketPairGuideOptions.highlightActiveBracketPair,horizontalGuides:this._bracketPairGuideOptions.bracketPairsHorizontal===!0?Jb.Enabled:this._bracketPairGuideOptions.bracketPairsHorizontal==="active"?Jb.EnabledForActive:Jb.Disabled,includeInactive:this._bracketPairGuideOptions.bracketPairs===!0}):null,r=this._bracketPairGuideOptions.indentation?this._context.viewModel.getLinesIndentGuides(e,t):null;let o=0,a=0,l=0;if(this._bracketPairGuideOptions.highlightActiveIndentation!==!1&&i){const u=this._context.viewModel.getActiveIndentGuide(i.lineNumber,e,t);o=u.startLineNumber,a=u.endLineNumber,l=u.indent}const{indentSize:c}=this._context.viewModel.model.getOptions(),d=[];for(let u=e;u<=t;u++){const h=new Array;d.push(h);const g=n?n[u-e]:[],p=new Cg(g),_=r?r[u-e]:0;for(let v=1;v<=_;v++){const C=(v-1)*c+1,y=(this._bracketPairGuideOptions.highlightActiveIndentation==="always"||g.length===0)&&o<=u&&u<=a&&v===l;h.push(...p.takeWhile(L=>L.visibleColumn<C)||[]);const x=p.peek();(!x||x.visibleColumn!==C||x.horizontalLine)&&h.push(new Wb(C,-1,`core-guide-indent lvl-${(v-1)%30}`+(y?" indent-active":""),null,-1,-1))}h.push(...p.takeWhile(v=>!0)||[])}return d}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}function Y0(s){if(!(s&&s.isTransparent()))return s}Lc((s,e)=>{const t=[{bracketColor:_ge,guideColor:FVe,guideColorActive:UVe},{bracketColor:bge,guideColor:VVe,guideColorActive:jVe},{bracketColor:vge,guideColor:BVe,guideColorActive:$Ve},{bracketColor:wge,guideColor:WVe,guideColorActive:qVe},{bracketColor:Cge,guideColor:HVe,guideColorActive:KVe},{bracketColor:yge,guideColor:zVe,guideColorActive:GVe}],i=new Age,n=[{indentColor:oD,indentColorActive:aD},{indentColor:mVe,indentColorActive:CVe},{indentColor:_Ve,indentColorActive:yVe},{indentColor:bVe,indentColorActive:SVe},{indentColor:vVe,indentColorActive:xVe},{indentColor:wVe,indentColorActive:LVe}],r=t.map(a=>{const l=s.getColor(a.bracketColor),c=s.getColor(a.guideColor),d=s.getColor(a.guideColorActive),u=Y0(Y0(c)??(l==null?void 0:l.transparent(.3))),h=Y0(Y0(d)??l);if(!(!u||!h))return{guideColor:u,guideColorActive:h}}).filter(Ch),o=n.map(a=>{const l=s.getColor(a.indentColor),c=s.getColor(a.indentColorActive),d=Y0(l),u=Y0(c);if(!(!d||!u))return{indentColor:d,indentColorActive:u}}).filter(Ch);if(r.length>0){for(let a=0;a<30;a++){const l=r[a%r.length];e.addRule(`.monaco-editor .${i.getInlineClassNameOfLevel(a).replace(/ /g,".")} { --guide-color: ${l.guideColor}; --guide-color-active: ${l.guideColorActive}; }`)}e.addRule(".monaco-editor .vertical { box-shadow: 1px 0 0 0 var(--guide-color) inset; }"),e.addRule(".monaco-editor .horizontal-top { border-top: 1px solid var(--guide-color); }"),e.addRule(".monaco-editor .horizontal-bottom { border-bottom: 1px solid var(--guide-color); }"),e.addRule(`.monaco-editor .vertical.${i.activeClassName} { box-shadow: 1px 0 0 0 var(--guide-color-active) inset; }`),e.addRule(`.monaco-editor .horizontal-top.${i.activeClassName} { border-top: 1px solid var(--guide-color-active); }`),e.addRule(`.monaco-editor .horizontal-bottom.${i.activeClassName} { border-bottom: 1px solid var(--guide-color-active); }`)}if(o.length>0){for(let a=0;a<30;a++){const l=o[a%o.length];e.addRule(`.monaco-editor .lines-content .core-guide-indent.lvl-${a} { --indent-color: ${l.indentColor}; --indent-color-active: ${l.indentColorActive}; }`)}e.addRule(".monaco-editor .lines-content .core-guide-indent { box-shadow: 1px 0 0 0 var(--indent-color) inset; }"),e.addRule(".monaco-editor .lines-content .core-guide-indent.indent-active { box-shadow: 1px 0 0 0 var(--indent-color-active) inset; }")}});class lB{get didDomLayout(){return this._didDomLayout}readClientRect(){if(!this._clientRectRead){this._clientRectRead=!0;const e=this._domNode.getBoundingClientRect();this.markDidDomLayout(),this._clientRectDeltaLeft=e.left,this._clientRectScale=e.width/this._domNode.offsetWidth}}get clientRectDeltaLeft(){return this._clientRectRead||this.readClientRect(),this._clientRectDeltaLeft}get clientRectScale(){return this._clientRectRead||this.readClientRect(),this._clientRectScale}constructor(e,t){this._domNode=e,this.endNode=t,this._didDomLayout=!1,this._clientRectDeltaLeft=0,this._clientRectScale=1,this._clientRectRead=!1}markDidDomLayout(){this._didDomLayout=!0}}class vze{constructor(){this._currentVisibleRange=new F(1,1,1,1)}getCurrentVisibleRange(){return this._currentVisibleRange}setCurrentVisibleRange(e){this._currentVisibleRange=e}}class wze{constructor(e,t,i,n,r,o,a){this.minimalReveal=e,this.lineNumber=t,this.startColumn=i,this.endColumn=n,this.startScrollTop=r,this.stopScrollTop=o,this.scrollType=a,this.type="range",this.minLineNumber=t,this.maxLineNumber=t}}class Cze{constructor(e,t,i,n,r){this.minimalReveal=e,this.selections=t,this.startScrollTop=i,this.stopScrollTop=n,this.scrollType=r,this.type="selections";let o=t[0].startLineNumber,a=t[0].endLineNumber;for(let l=1,c=t.length;l<c;l++){const d=t[l];o=Math.min(o,d.startLineNumber),a=Math.max(a,d.endLineNumber)}this.minLineNumber=o,this.maxLineNumber=a}}const hO=class hO extends za{constructor(e,t){super(e);const i=this._context.configuration,n=this._context.configuration.options,r=n.get(50),o=n.get(147);this._lineHeight=n.get(67),this._typicalHalfwidthCharacterWidth=r.typicalHalfwidthCharacterWidth,this._isViewportWrapping=o.isViewportWrapping,this._revealHorizontalRightPadding=n.get(101),this._cursorSurroundingLines=n.get(29),this._cursorSurroundingLinesStyle=n.get(30),this._canUseLayerHinting=!n.get(32),this._viewLineOptions=new Cse(i,this._context.theme.type),this._linesContent=t,this._textRangeRestingSpot=document.createElement("div"),this._visibleLines=new Jpe({createLine:()=>new Wf(this._viewLineOptions)}),this.domNode=this._visibleLines.domNode,mu.write(this.domNode,8),this.domNode.setClassName(`view-lines ${Ny}`),Zs(this.domNode,r),this._maxLineWidth=0,this._asyncUpdateLineWidths=new xi(()=>{this._updateLineWidthsSlow()},200),this._asyncCheckMonospaceFontAssumptions=new xi(()=>{this._checkMonospaceFontAssumptions()},2e3),this._lastRenderedData=new vze,this._horizontalRevealRequest=null,this._stickyScrollEnabled=n.get(116).enabled,this._maxNumberStickyLines=n.get(116).maxLineCount}dispose(){this._asyncUpdateLineWidths.dispose(),this._asyncCheckMonospaceFontAssumptions.dispose(),super.dispose()}getDomNode(){return this.domNode}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e),e.hasChanged(147)&&(this._maxLineWidth=0);const t=this._context.configuration.options,i=t.get(50),n=t.get(147);return this._lineHeight=t.get(67),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._isViewportWrapping=n.isViewportWrapping,this._revealHorizontalRightPadding=t.get(101),this._cursorSurroundingLines=t.get(29),this._cursorSurroundingLinesStyle=t.get(30),this._canUseLayerHinting=!t.get(32),this._stickyScrollEnabled=t.get(116).enabled,this._maxNumberStickyLines=t.get(116).maxLineCount,Zs(this.domNode,i),this._onOptionsMaybeChanged(),e.hasChanged(146)&&(this._maxLineWidth=0),!0}_onOptionsMaybeChanged(){const e=this._context.configuration,t=new Cse(e,this._context.theme.type);if(!this._viewLineOptions.equals(t)){this._viewLineOptions=t;const i=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let r=i;r<=n;r++)this._visibleLines.getVisibleLine(r).onOptionsChanged(this._viewLineOptions);return!0}return!1}onCursorStateChanged(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();let n=!1;for(let r=t;r<=i;r++)n=this._visibleLines.getVisibleLine(r).onSelectionChanged()||n;return n}onDecorationsChanged(e){{const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let n=t;n<=i;n++)this._visibleLines.getVisibleLine(n).onDecorationsChanged()}return!0}onFlushed(e){const t=this._visibleLines.onFlushed(e);return this._maxLineWidth=0,t}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onRevealRangeRequest(e){const t=this._computeScrollTopToRevealRange(this._context.viewLayout.getFutureViewport(),e.source,e.minimalReveal,e.range,e.selections,e.verticalType);if(t===-1)return!1;let i=this._context.viewLayout.validateScrollPosition({scrollTop:t});e.revealHorizontal?e.range&&e.range.startLineNumber!==e.range.endLineNumber?i={scrollTop:i.scrollTop,scrollLeft:0}:e.range?this._horizontalRevealRequest=new wze(e.minimalReveal,e.range.startLineNumber,e.range.startColumn,e.range.endColumn,this._context.viewLayout.getCurrentScrollTop(),i.scrollTop,e.scrollType):e.selections&&e.selections.length>0&&(this._horizontalRevealRequest=new Cze(e.minimalReveal,e.selections,this._context.viewLayout.getCurrentScrollTop(),i.scrollTop,e.scrollType)):this._horizontalRevealRequest=null;const r=Math.abs(this._context.viewLayout.getCurrentScrollTop()-i.scrollTop)<=this._lineHeight?1:e.scrollType;return this._context.viewModel.viewLayout.setScrollPosition(i,r),!0}onScrollChanged(e){if(this._horizontalRevealRequest&&e.scrollLeftChanged&&(this._horizontalRevealRequest=null),this._horizontalRevealRequest&&e.scrollTopChanged){const t=Math.min(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop),i=Math.max(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop);(e.scrollTop<t||e.scrollTop>i)&&(this._horizontalRevealRequest=null)}return this.domNode.setWidth(e.scrollWidth),this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth),this._visibleLines.onZonesChanged(e)}onThemeChanged(e){return this._onOptionsMaybeChanged()}getPositionFromDOMInfo(e,t){const i=this._getViewLineDomNode(e);if(i===null)return null;const n=this._getLineNumberFor(i);if(n===-1||n<1||n>this._context.viewModel.getLineCount())return null;if(this._context.viewModel.getLineMaxColumn(n)===1)return new X(n,1);const r=this._visibleLines.getStartLineNumber(),o=this._visibleLines.getEndLineNumber();if(n<r||n>o)return null;let a=this._visibleLines.getVisibleLine(n).getColumnOfNodeOffset(e,t);const l=this._context.viewModel.getLineMinColumn(n);return a<l&&(a=l),new X(n,a)}_getViewLineDomNode(e){for(;e&&e.nodeType===1;){if(e.className===Wf.CLASS_NAME)return e;e=e.parentElement}return null}_getLineNumberFor(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let n=t;n<=i;n++){const r=this._visibleLines.getVisibleLine(n);if(e===r.getDomNode())return n}return-1}getLineWidth(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();if(e<t||e>i)return-1;const n=new lB(this.domNode.domNode,this._textRangeRestingSpot),r=this._visibleLines.getVisibleLine(e).getWidth(n);return this._updateLineWidthsSlowIfDomDidLayout(n),r}linesVisibleRangesForRange(e,t){if(this.shouldRender())return null;const i=e.endLineNumber,n=F.intersectRanges(e,this._lastRenderedData.getCurrentVisibleRange());if(!n)return null;const r=[];let o=0;const a=new lB(this.domNode.domNode,this._textRangeRestingSpot);let l=0;t&&(l=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new X(n.startLineNumber,1)).lineNumber);const c=this._visibleLines.getStartLineNumber(),d=this._visibleLines.getEndLineNumber();for(let u=n.startLineNumber;u<=n.endLineNumber;u++){if(u<c||u>d)continue;const h=u===n.startLineNumber?n.startColumn:1,g=u!==n.endLineNumber,p=g?this._context.viewModel.getLineMaxColumn(u):n.endColumn,_=this._visibleLines.getVisibleLine(u).getVisibleRangesForRange(u,h,p,a);if(_){if(t&&u<i){const v=l;l=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new X(u+1,1)).lineNumber,v!==l&&(_.ranges[_.ranges.length-1].width+=this._typicalHalfwidthCharacterWidth)}r[o++]=new rHe(_.outsideRenderedLine,u,t5.from(_.ranges),g)}}return this._updateLineWidthsSlowIfDomDidLayout(a),o===0?null:r}_visibleRangesForLineRange(e,t,i){if(this.shouldRender()||e<this._visibleLines.getStartLineNumber()||e>this._visibleLines.getEndLineNumber())return null;const n=new lB(this.domNode.domNode,this._textRangeRestingSpot),r=this._visibleLines.getVisibleLine(e).getVisibleRangesForRange(e,t,i,n);return this._updateLineWidthsSlowIfDomDidLayout(n),r}visibleRangeForPosition(e){const t=this._visibleRangesForLineRange(e.lineNumber,e.column,e.column);return t?new oHe(t.outsideRenderedLine,t.ranges[0].left):null}_updateLineWidthsFast(){return this._updateLineWidths(!0)}_updateLineWidthsSlow(){this._updateLineWidths(!1)}_updateLineWidthsSlowIfDomDidLayout(e){e.didDomLayout&&(this._asyncUpdateLineWidths.isScheduled()||(this._asyncUpdateLineWidths.cancel(),this._updateLineWidthsSlow()))}_updateLineWidths(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();let n=1,r=!0;for(let o=t;o<=i;o++){const a=this._visibleLines.getVisibleLine(o);if(e&&!a.getWidthIsFast()){r=!1;continue}n=Math.max(n,a.getWidth(null))}return r&&t===1&&i===this._context.viewModel.getLineCount()&&(this._maxLineWidth=0),this._ensureMaxLineWidth(n),r}_checkMonospaceFontAssumptions(){let e=-1,t=-1;const i=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let r=i;r<=n;r++){const o=this._visibleLines.getVisibleLine(r);if(o.needsMonospaceFontCheck()){const a=o.getWidth(null);a>t&&(t=a,e=r)}}if(e!==-1&&!this._visibleLines.getVisibleLine(e).monospaceAssumptionsAreValid())for(let r=i;r<=n;r++)this._visibleLines.getVisibleLine(r).onMonospaceAssumptionsInvalidated()}prepareRender(){throw new Error("Not supported")}render(){throw new Error("Not supported")}renderText(e){if(this._visibleLines.renderLines(e),this._lastRenderedData.setCurrentVisibleRange(e.visibleRange),this.domNode.setWidth(this._context.viewLayout.getScrollWidth()),this.domNode.setHeight(Math.min(this._context.viewLayout.getScrollHeight(),1e6)),this._horizontalRevealRequest){const i=this._horizontalRevealRequest;if(e.startLineNumber<=i.minLineNumber&&i.maxLineNumber<=e.endLineNumber){this._horizontalRevealRequest=null,this.onDidRender();const n=this._computeScrollLeftToReveal(i);n&&(this._isViewportWrapping||this._ensureMaxLineWidth(n.maxHorizontalOffset),this._context.viewModel.viewLayout.setScrollPosition({scrollLeft:n.scrollLeft},i.scrollType))}}if(this._updateLineWidthsFast()?this._asyncUpdateLineWidths.cancel():this._asyncUpdateLineWidths.schedule(),Lo&&!this._asyncCheckMonospaceFontAssumptions.isScheduled()){const i=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let r=i;r<=n;r++)if(this._visibleLines.getVisibleLine(r).needsMonospaceFontCheck()){this._asyncCheckMonospaceFontAssumptions.schedule();break}}this._linesContent.setLayerHinting(this._canUseLayerHinting),this._linesContent.setContain("strict");const t=this._context.viewLayout.getCurrentScrollTop()-e.bigNumbersDelta;this._linesContent.setTop(-t),this._linesContent.setLeft(-this._context.viewLayout.getCurrentScrollLeft())}_ensureMaxLineWidth(e){const t=Math.ceil(e);this._maxLineWidth<t&&(this._maxLineWidth=t,this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth))}_computeScrollTopToRevealRange(e,t,i,n,r,o){const a=e.top,l=e.height,c=a+l;let d,u,h;if(r&&r.length>0){let C=r[0].startLineNumber,y=r[0].endLineNumber;for(let x=1,L=r.length;x<L;x++){const I=r[x];C=Math.min(C,I.startLineNumber),y=Math.max(y,I.endLineNumber)}d=!1,u=this._context.viewLayout.getVerticalOffsetForLineNumber(C),h=this._context.viewLayout.getVerticalOffsetForLineNumber(y)+this._lineHeight}else if(n)d=!0,u=this._context.viewLayout.getVerticalOffsetForLineNumber(n.startLineNumber),h=this._context.viewLayout.getVerticalOffsetForLineNumber(n.endLineNumber)+this._lineHeight;else return-1;const g=(t==="mouse"||i)&&this._cursorSurroundingLinesStyle==="default";let p=0,_=0;if(g)i||(p=this._lineHeight);else{const C=l/this._lineHeight,y=Math.max(this._cursorSurroundingLines,this._stickyScrollEnabled?this._maxNumberStickyLines:0),x=Math.min(C/2,y);p=x*this._lineHeight,_=Math.max(0,x-1)*this._lineHeight}i||(o===0||o===4)&&(_+=this._lineHeight),u-=p,h+=_;let v;if(h-u>l){if(!d)return-1;v=u}else if(o===5||o===6)if(o===6&&a<=u&&h<=c)v=a;else{const C=Math.max(5*this._lineHeight,l*.2),y=u-C,x=h-l;v=Math.max(x,y)}else if(o===1||o===2)if(o===2&&a<=u&&h<=c)v=a;else{const C=(u+h)/2;v=Math.max(0,C-l/2)}else v=this._computeMinimumScrolling(a,c,u,h,o===3,o===4);return v}_computeScrollLeftToReveal(e){const t=this._context.viewLayout.getCurrentViewport(),i=this._context.configuration.options.get(146),n=t.left,r=n+t.width-i.verticalScrollbarWidth;let o=1073741824,a=0;if(e.type==="range"){const c=this._visibleRangesForLineRange(e.lineNumber,e.startColumn,e.endColumn);if(!c)return null;for(const d of c.ranges)o=Math.min(o,Math.round(d.left)),a=Math.max(a,Math.round(d.left+d.width))}else for(const c of e.selections){if(c.startLineNumber!==c.endLineNumber)return null;const d=this._visibleRangesForLineRange(c.startLineNumber,c.startColumn,c.endColumn);if(!d)return null;for(const u of d.ranges)o=Math.min(o,Math.round(u.left)),a=Math.max(a,Math.round(u.left+u.width))}return e.minimalReveal||(o=Math.max(0,o-hO.HORIZONTAL_EXTRA_PX),a+=this._revealHorizontalRightPadding),e.type==="selections"&&a-o>t.width?null:{scrollLeft:this._computeMinimumScrolling(n,r,o,a),maxHorizontalOffset:a}}_computeMinimumScrolling(e,t,i,n,r,o){e=e|0,t=t|0,i=i|0,n=n|0,r=!!r,o=!!o;const a=t-e;if(n-i<a){if(r)return i;if(o)return Math.max(0,n-a);if(i<e)return i;if(n>t)return Math.max(0,n-a)}else return i;return e}};hO.HORIZONTAL_EXTRA_PX=30;let OH=hO;class yze extends ime{constructor(e){super(),this._context=e;const i=this._context.configuration.options.get(146);this._decorationsLeft=i.decorationsLeft,this._decorationsWidth=i.decorationsWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const i=this._context.configuration.options.get(146);return this._decorationsLeft=i.decorationsLeft,this._decorationsWidth=i.decorationsWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){const t=e.getDecorationsInViewport(),i=[];let n=0;for(let r=0,o=t.length;r<o;r++){const a=t[r],l=a.options.linesDecorationsClassName,c=a.options.zIndex;l&&(i[n++]=new MH(a.range.startLineNumber,a.range.endLineNumber,l,a.options.linesDecorationsTooltip??null,c));const d=a.options.firstLineDecorationClassName;d&&(i[n++]=new MH(a.range.startLineNumber,a.range.startLineNumber,d,a.options.linesDecorationsTooltip??null,c))}return i}prepareRender(e){const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=this._render(t,i,this._getDecorations(e)),r=this._decorationsLeft.toString(),o=this._decorationsWidth.toString(),a='" style="left:'+r+"px;width:"+o+'px;"></div>',l=[];for(let c=t;c<=i;c++){const d=c-t,u=n[d].getDecorations();let h="";for(const g of u){let p='<div class="cldr '+g.className;g.tooltip!==null&&(p+='" title="'+g.tooltip),p+=a,h+=p}l[d]=h}this._renderResult=l}render(e,t){return this._renderResult?this._renderResult[t-e]:""}}class Sze extends ime{constructor(e){super(),this._context=e,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){const t=e.getDecorationsInViewport(),i=[];let n=0;for(let r=0,o=t.length;r<o;r++){const a=t[r],l=a.options.marginClassName,c=a.options.zIndex;l&&(i[n++]=new MH(a.range.startLineNumber,a.range.endLineNumber,l,null,c))}return i}prepareRender(e){const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=this._render(t,i,this._getDecorations(e)),r=[];for(let o=t;o<=i;o++){const a=o-t,l=n[a].getDecorations();let c="";for(const d of l)c+='<div class="cmdr '+d.className+'" style=""></div>';r[a]=c}this._renderResult=r}render(e,t){return this._renderResult?this._renderResult[t-e]:""}}const Lp=class Lp{constructor(e,t,i,n){this._rgba8Brand=void 0,this.r=Lp._clamp(e),this.g=Lp._clamp(t),this.b=Lp._clamp(i),this.a=Lp._clamp(n)}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}static _clamp(e){return e<0?0:e>255?255:e|0}};Lp.Empty=new Lp(0,0,0,0);let ug=Lp;const fO=class fO extends te{static getInstance(){return this._INSTANCE||(this._INSTANCE=new fO),this._INSTANCE}constructor(){super(),this._onDidChange=new Z,this.onDidChange=this._onDidChange.event,this._updateColorMap(),this._register(Ln.onDidChange(e=>{e.changedColorMap&&this._updateColorMap()}))}_updateColorMap(){const e=Ln.getColorMap();if(!e){this._colors=[ug.Empty],this._backgroundIsLight=!0;return}this._colors=[ug.Empty];for(let i=1;i<e.length;i++){const n=e[i].rgba;this._colors[i]=new ug(n.r,n.g,n.b,Math.round(n.a*255))}const t=e[2].getRelativeLuminance();this._backgroundIsLight=t>=.5,this._onDidChange.fire(void 0)}getColor(e){return(e<1||e>=this._colors.length)&&(e=2),this._colors[e]}backgroundIsLight(){return this._backgroundIsLight}};fO._INSTANCE=null;let uP=fO;const xze=(()=>{const s=[];for(let e=32;e<=126;e++)s.push(e);return s.push(65533),s})(),Lze=(s,e)=>(s-=32,s<0||s>96?e<=2?(s+96)%96:95:s);class UI{constructor(e,t){this.scale=t,this._minimapCharRendererBrand=void 0,this.charDataNormal=UI.soften(e,12/15),this.charDataLight=UI.soften(e,50/60)}static soften(e,t){const i=new Uint8ClampedArray(e.length);for(let n=0,r=e.length;n<r;n++)i[n]=X2(e[n]*t);return i}renderChar(e,t,i,n,r,o,a,l,c,d,u){const h=1*this.scale,g=2*this.scale,p=u?1:g;if(t+h>e.width||i+p>e.height){console.warn("bad render request outside image data");return}const _=d?this.charDataLight:this.charDataNormal,v=Lze(n,c),C=e.width*4,y=a.r,x=a.g,L=a.b,I=r.r-y,A=r.g-x,D=r.b-L,N=Math.max(o,l),R=e.data;let W=v*h*g,H=i*C+t*4;for(let U=0;U<p;U++){let B=H;for(let ee=0;ee<h;ee++){const re=_[W++]/255*(o/255);R[B++]=y+I*re,R[B++]=x+A*re,R[B++]=L+D*re,R[B++]=N}H+=C}}blockRenderChar(e,t,i,n,r,o,a,l){const c=1*this.scale,d=2*this.scale,u=l?1:d;if(t+c>e.width||i+u>e.height){console.warn("bad render request outside image data");return}const h=e.width*4,g=.5*(r/255),p=o.r,_=o.g,v=o.b,C=n.r-p,y=n.g-_,x=n.b-v,L=p+C*g,I=_+y*g,A=v+x*g,D=Math.max(r,a),N=e.data;let R=i*h+t*4;for(let W=0;W<u;W++){let H=R;for(let U=0;U<c;U++)N[H++]=L,N[H++]=I,N[H++]=A,N[H++]=D;R+=h}}}const Tse={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15},Nse=s=>{const e=new Uint8ClampedArray(s.length/2);for(let t=0;t<s.length;t+=2)e[t>>1]=Tse[s[t]]<<4|Tse[s[t+1]]&15;return e},Rse={1:Wm(()=>Nse("0000511D6300CF609C709645A78432005642574171487021003C451900274D35D762755E8B629C5BA856AF57BA649530C167D1512A272A3F6038604460398526BCA2A968DB6F8957C768BE5FBE2FB467CF5D8D5B795DC7625B5DFF50DE64C466DB2FC47CD860A65E9A2EB96CB54CE06DA763AB2EA26860524D3763536601005116008177A8705E53AB738E6A982F88BAA35B5F5B626D9C636B449B737E5B7B678598869A662F6B5B8542706C704C80736A607578685B70594A49715A4522E792")),2:Wm(()=>Nse("000000000000000055394F383D2800008B8B1F210002000081B1CBCBCC820000847AAF6B9AAF2119BE08B8881AD60000A44FD07DCCF107015338130C00000000385972265F390B406E2437634B4B48031B12B8A0847000001E15B29A402F0000000000004B33460B00007A752C2A0000000000004D3900000084394B82013400ABA5CFC7AD9C0302A45A3E5A98AB000089A43382D97900008BA54AA087A70A0248A6A7AE6DBE0000BF6F94987EA40A01A06DCFA7A7A9030496C32F77891D0000A99FB1A0AFA80603B29AB9CA75930D010C0948354D3900000C0948354F37460D0028BE673D8400000000AF9D7B6E00002B007AA8933400007AA642675C2700007984CFB9C3985B768772A8A6B7B20000CAAECAAFC4B700009F94A6009F840009D09F9BA4CA9C0000CC8FC76DC87F0000C991C472A2000000A894A48CA7B501079BA2C9C69BA20000B19A5D3FA89000005CA6009DA2960901B0A7F0669FB200009D009E00B7890000DAD0F5D092820000D294D4C48BD10000B5A7A4A3B1A50402CAB6CBA6A2000000B5A7A4A3B1A8044FCDADD19D9CB00000B7778F7B8AAE0803C9AB5D3F5D3F00009EA09EA0BAB006039EA0989A8C7900009B9EF4D6B7C00000A9A7816CACA80000ABAC84705D3F000096DA635CDC8C00006F486F266F263D4784006124097B00374F6D2D6D2D6D4A3A95872322000000030000000000008D8939130000000000002E22A5C9CBC70600AB25C0B5C9B400061A2DB04CA67001082AA6BEBEBFC606002321DACBC19E03087AA08B6768380000282FBAC0B8CA7A88AD25BBA5A29900004C396C5894A6000040485A6E356E9442A32CD17EADA70000B4237923628600003E2DE9C1D7B500002F25BBA5A2990000231DB6AFB4A804023025C0B5CAB588062B2CBDBEC0C706882435A75CA20000002326BD6A82A908048B4B9A5A668000002423A09CB4BB060025259C9D8A7900001C1FCAB2C7C700002A2A9387ABA200002626A4A47D6E9D14333163A0C87500004B6F9C2D643A257049364936493647358A34438355497F1A0000A24C1D590000D38DFFBDD4CD3126"))};class YL{static create(e,t){if(this.lastCreated&&e===this.lastCreated.scale&&t===this.lastFontFamily)return this.lastCreated;let i;return Rse[e]?i=new UI(Rse[e](),e):i=YL.createFromSampleData(YL.createSampleData(t).data,e),this.lastFontFamily=t,this.lastCreated=i,i}static createSampleData(e){const t=document.createElement("canvas"),i=t.getContext("2d");t.style.height="16px",t.height=16,t.width=96*10,t.style.width=96*10+"px",i.fillStyle="#ffffff",i.font=`bold 16px ${e}`,i.textBaseline="middle";let n=0;for(const r of xze)i.fillText(String.fromCharCode(r),n,16/2),n+=10;return i.getImageData(0,0,96*10,16)}static createFromSampleData(e,t){if(e.length!==61440)throw new Error("Unexpected source in MinimapCharRenderer");const n=YL._downsample(e,t);return new UI(n,t)}static _downsampleChar(e,t,i,n,r){const o=1*r,a=2*r;let l=n,c=0;for(let d=0;d<a;d++){const u=d/a*16,h=(d+1)/a*16;for(let g=0;g<o;g++){const p=g/o*10,_=(g+1)/o*10;let v=0,C=0;for(let x=u;x<h;x++){const L=t+Math.floor(x)*3840,I=1-(x-Math.floor(x));for(let A=p;A<_;A++){const D=1-(A-Math.floor(A)),N=L+Math.floor(A)*4,R=D*I;C+=R,v+=e[N]*e[N+3]/255*R}}const y=v/C;c=Math.max(c,y),i[l++]=X2(y)}}return c}static _downsample(e,t){const i=2*t*1*t,n=i*96,r=new Uint8ClampedArray(n);let o=0,a=0,l=0;for(let c=0;c<96;c++)l=Math.max(l,this._downsampleChar(e,a,r,o,t)),o+=i,a+=10*4;if(l>0){const c=255/l;for(let d=0;d<n;d++)r[d]*=c}return r}}const nme=gr?'"Segoe WPC", "Segoe UI", sans-serif':Wt?"-apple-system, BlinkMacSystemFont, sans-serif":'system-ui, "Ubuntu", "Droid Sans", sans-serif',kze=140,Ize=2;class Py{constructor(e,t,i){const n=e.options,r=n.get(144),o=n.get(146),a=o.minimap,l=n.get(50),c=n.get(73);this.renderMinimap=a.renderMinimap,this.size=c.size,this.minimapHeightIsEditorHeight=a.minimapHeightIsEditorHeight,this.scrollBeyondLastLine=n.get(106),this.paddingTop=n.get(84).top,this.paddingBottom=n.get(84).bottom,this.showSlider=c.showSlider,this.autohide=c.autohide,this.pixelRatio=r,this.typicalHalfwidthCharacterWidth=l.typicalHalfwidthCharacterWidth,this.lineHeight=n.get(67),this.minimapLeft=a.minimapLeft,this.minimapWidth=a.minimapWidth,this.minimapHeight=o.height,this.canvasInnerWidth=a.minimapCanvasInnerWidth,this.canvasInnerHeight=a.minimapCanvasInnerHeight,this.canvasOuterWidth=a.minimapCanvasOuterWidth,this.canvasOuterHeight=a.minimapCanvasOuterHeight,this.isSampling=a.minimapIsSampling,this.editorHeight=o.height,this.fontScale=a.minimapScale,this.minimapLineHeight=a.minimapLineHeight,this.minimapCharWidth=1*this.fontScale,this.sectionHeaderFontFamily=nme,this.sectionHeaderFontSize=c.sectionHeaderFontSize*r,this.sectionHeaderLetterSpacing=c.sectionHeaderLetterSpacing,this.sectionHeaderFontColor=Py._getSectionHeaderColor(t,i.getColor(1)),this.charRenderer=Wm(()=>YL.create(this.fontScale,l.fontFamily)),this.defaultBackgroundColor=i.getColor(2),this.backgroundColor=Py._getMinimapBackground(t,this.defaultBackgroundColor),this.foregroundAlpha=Py._getMinimapForegroundOpacity(t)}static _getMinimapBackground(e,t){const i=e.getColor(_4e);return i?new ug(i.rgba.r,i.rgba.g,i.rgba.b,Math.round(255*i.rgba.a)):t}static _getMinimapForegroundOpacity(e){const t=e.getColor(b4e);return t?ug._clamp(Math.round(255*t.rgba.a)):255}static _getSectionHeaderColor(e,t){const i=e.getColor(qh);return i?new ug(i.rgba.r,i.rgba.g,i.rgba.b,Math.round(255*i.rgba.a)):t}equals(e){return this.renderMinimap===e.renderMinimap&&this.size===e.size&&this.minimapHeightIsEditorHeight===e.minimapHeightIsEditorHeight&&this.scrollBeyondLastLine===e.scrollBeyondLastLine&&this.paddingTop===e.paddingTop&&this.paddingBottom===e.paddingBottom&&this.showSlider===e.showSlider&&this.autohide===e.autohide&&this.pixelRatio===e.pixelRatio&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.lineHeight===e.lineHeight&&this.minimapLeft===e.minimapLeft&&this.minimapWidth===e.minimapWidth&&this.minimapHeight===e.minimapHeight&&this.canvasInnerWidth===e.canvasInnerWidth&&this.canvasInnerHeight===e.canvasInnerHeight&&this.canvasOuterWidth===e.canvasOuterWidth&&this.canvasOuterHeight===e.canvasOuterHeight&&this.isSampling===e.isSampling&&this.editorHeight===e.editorHeight&&this.fontScale===e.fontScale&&this.minimapLineHeight===e.minimapLineHeight&&this.minimapCharWidth===e.minimapCharWidth&&this.sectionHeaderFontSize===e.sectionHeaderFontSize&&this.sectionHeaderLetterSpacing===e.sectionHeaderLetterSpacing&&this.defaultBackgroundColor&&this.defaultBackgroundColor.equals(e.defaultBackgroundColor)&&this.backgroundColor&&this.backgroundColor.equals(e.backgroundColor)&&this.foregroundAlpha===e.foregroundAlpha}}class XL{constructor(e,t,i,n,r,o,a,l,c){this.scrollTop=e,this.scrollHeight=t,this.sliderNeeded=i,this._computedSliderRatio=n,this.sliderTop=r,this.sliderHeight=o,this.topPaddingLineCount=a,this.startLineNumber=l,this.endLineNumber=c}getDesiredScrollTopFromDelta(e){return Math.round(this.scrollTop+e/this._computedSliderRatio)}getDesiredScrollTopFromTouchLocation(e){return Math.round((e-this.sliderHeight/2)/this._computedSliderRatio)}intersectWithViewport(e){const t=Math.max(this.startLineNumber,e.startLineNumber),i=Math.min(this.endLineNumber,e.endLineNumber);return t>i?null:[t,i]}getYForLineNumber(e,t){return+(e-this.startLineNumber+this.topPaddingLineCount)*t}static create(e,t,i,n,r,o,a,l,c,d,u){const h=e.pixelRatio,g=e.minimapLineHeight,p=Math.floor(e.canvasInnerHeight/g),_=e.lineHeight;if(e.minimapHeightIsEditorHeight){let A=l*e.lineHeight+e.paddingTop+e.paddingBottom;e.scrollBeyondLastLine&&(A+=Math.max(0,r-e.lineHeight-e.paddingBottom));const D=Math.max(1,Math.floor(r*r/A)),N=Math.max(0,e.minimapHeight-D),R=N/(d-r),W=c*R,H=N>0,U=Math.floor(e.canvasInnerHeight/e.minimapLineHeight),B=Math.floor(e.paddingTop/e.lineHeight);return new XL(c,d,H,R,W,D,B,1,Math.min(a,U))}let v;if(o&&i!==a){const A=i-t+1;v=Math.floor(A*g/h)}else{const A=r/_;v=Math.floor(A*g/h)}const C=Math.floor(e.paddingTop/_);let y=Math.floor(e.paddingBottom/_);if(e.scrollBeyondLastLine){const A=r/_;y=Math.max(y,A-1)}let x;if(y>0){const A=r/_;x=(C+a+y-A-1)*g/h}else x=Math.max(0,(C+a)*g/h-v);x=Math.min(e.minimapHeight-v,x);const L=x/(d-r),I=c*L;if(p>=C+a+y){const A=x>0;return new XL(c,d,A,L,I,v,C,1,a)}else{let A;t>1?A=t+C:A=Math.max(1,c/_);let D,N=Math.max(1,Math.floor(A-I*h/g));N<C?(D=C-N+1,N=1):(D=0,N=Math.max(1,N-C)),u&&u.scrollHeight===d&&(u.scrollTop>c&&(N=Math.min(N,u.startLineNumber),D=Math.max(D,u.topPaddingLineCount)),u.scrollTop<c&&(N=Math.max(N,u.startLineNumber),D=Math.min(D,u.topPaddingLineCount)));const R=Math.min(a,N-D+p-1),W=(c-n)/_;let H;return c>=e.paddingTop?H=(t-N+D+W)*g/h:H=c/e.paddingTop*(D+W)*g/h,new XL(c,d,!0,L,H,v,D,N,R)}}}const gO=class gO{constructor(e){this.dy=e}onContentChanged(){this.dy=-1}onTokensChanged(){this.dy=-1}};gO.INVALID=new gO(-1);let hP=gO;class Ase{constructor(e,t,i){this.renderedLayout=e,this._imageData=t,this._renderedLines=new Zpe({createLine:()=>hP.INVALID}),this._renderedLines._set(e.startLineNumber,i)}linesEquals(e){if(!this.scrollEquals(e))return!1;const i=this._renderedLines._get().lines;for(let n=0,r=i.length;n<r;n++)if(i[n].dy===-1)return!1;return!0}scrollEquals(e){return this.renderedLayout.startLineNumber===e.startLineNumber&&this.renderedLayout.endLineNumber===e.endLineNumber}_get(){const e=this._renderedLines._get();return{imageData:this._imageData,rendLineNumberStart:e.rendLineNumberStart,lines:e.lines}}onLinesChanged(e,t){return this._renderedLines.onLinesChanged(e,t)}onLinesDeleted(e,t){this._renderedLines.onLinesDeleted(e,t)}onLinesInserted(e,t){this._renderedLines.onLinesInserted(e,t)}onTokensChanged(e){return this._renderedLines.onTokensChanged(e)}}class NG{constructor(e,t,i,n){this._backgroundFillData=NG._createBackgroundFillData(t,i,n),this._buffers=[e.createImageData(t,i),e.createImageData(t,i)],this._lastUsedBuffer=0}getBuffer(){this._lastUsedBuffer=1-this._lastUsedBuffer;const e=this._buffers[this._lastUsedBuffer];return e.data.set(this._backgroundFillData),e}static _createBackgroundFillData(e,t,i){const n=i.r,r=i.g,o=i.b,a=i.a,l=new Uint8ClampedArray(e*t*4);let c=0;for(let d=0;d<t;d++)for(let u=0;u<e;u++)l[c]=n,l[c+1]=r,l[c+2]=o,l[c+3]=a,c+=4;return l}}class jI{static compute(e,t,i){if(e.renderMinimap===0||!e.isSampling)return[null,[]];const{minimapLineCount:n}=fy.computeContainedMinimapLineCount({viewLineCount:t,scrollBeyondLastLine:e.scrollBeyondLastLine,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:e.editorHeight,lineHeight:e.lineHeight,pixelRatio:e.pixelRatio}),r=t/n,o=r/2;if(!i||i.minimapLines.length===0){const v=[];if(v[0]=1,n>1){for(let C=0,y=n-1;C<y;C++)v[C]=Math.round(C*r+o);v[n-1]=t}return[new jI(r,v),[]]}const a=i.minimapLines,l=a.length,c=[];let d=0,u=0,h=1;const g=10;let p=[],_=null;for(let v=0;v<n;v++){const C=Math.max(h,Math.round(v*r)),y=Math.max(C,Math.round((v+1)*r));for(;d<l&&a[d]<C;){if(p.length<g){const L=d+1+u;_&&_.type==="deleted"&&_._oldIndex===d-1?_.deleteToLineNumber++:(_={type:"deleted",_oldIndex:d,deleteFromLineNumber:L,deleteToLineNumber:L},p.push(_)),u--}d++}let x;if(d<l&&a[d]<=y)x=a[d],d++;else if(v===0?x=1:v+1===n?x=t:x=Math.round(v*r+o),p.length<g){const L=d+1+u;_&&_.type==="inserted"&&_._i===v-1?_.insertToLineNumber++:(_={type:"inserted",_i:v,insertFromLineNumber:L,insertToLineNumber:L},p.push(_)),u++}c[v]=x,h=x}if(p.length<g)for(;d<l;){const v=d+1+u;_&&_.type==="deleted"&&_._oldIndex===d-1?_.deleteToLineNumber++:(_={type:"deleted",_oldIndex:d,deleteFromLineNumber:v,deleteToLineNumber:v},p.push(_)),u--,d++}else p=[{type:"flush"}];return[new jI(r,c),p]}constructor(e,t){this.samplingRatio=e,this.minimapLines=t}modelLineToMinimapLine(e){return Math.min(this.minimapLines.length,Math.max(1,Math.round(e/this.samplingRatio)))}modelLineRangeToMinimapLineRange(e,t){let i=this.modelLineToMinimapLine(e)-1;for(;i>0&&this.minimapLines[i-1]>=e;)i--;let n=this.modelLineToMinimapLine(t)-1;for(;n+1<this.minimapLines.length&&this.minimapLines[n+1]<=t;)n++;if(i===n){const r=this.minimapLines[i];if(r<e||r>t)return null}return[i+1,n+1]}decorationLineRangeToMinimapLineRange(e,t){let i=this.modelLineToMinimapLine(e),n=this.modelLineToMinimapLine(t);return e!==t&&n===i&&(n===this.minimapLines.length?i>1&&i--:n++),[i,n]}onLinesDeleted(e){const t=e.toLineNumber-e.fromLineNumber+1;let i=this.minimapLines.length,n=0;for(let r=this.minimapLines.length-1;r>=0&&!(this.minimapLines[r]<e.fromLineNumber);r--)this.minimapLines[r]<=e.toLineNumber?(this.minimapLines[r]=Math.max(1,e.fromLineNumber-1),i=Math.min(i,r),n=Math.max(n,r)):this.minimapLines[r]-=t;return[i,n]}onLinesInserted(e){const t=e.toLineNumber-e.fromLineNumber+1;for(let i=this.minimapLines.length-1;i>=0&&!(this.minimapLines[i]<e.fromLineNumber);i--)this.minimapLines[i]+=t}}class Eze extends za{constructor(e){super(e),this._sectionHeaderCache=new $h(10,1.5),this.tokensColorTracker=uP.getInstance(),this._selections=[],this._minimapSelections=null,this.options=new Py(this._context.configuration,this._context.theme,this.tokensColorTracker);const[t]=jI.compute(this.options,this._context.viewModel.getLineCount(),null);this._samplingState=t,this._shouldCheckSampling=!1,this._actual=new OC(e.theme,this)}dispose(){this._actual.dispose(),super.dispose()}getDomNode(){return this._actual.getDomNode()}_onOptionsMaybeChanged(){const e=new Py(this._context.configuration,this._context.theme,this.tokensColorTracker);return this.options.equals(e)?!1:(this.options=e,this._recreateLineSampling(),this._actual.onDidChangeOptions(),!0)}onConfigurationChanged(e){return this._onOptionsMaybeChanged()}onCursorStateChanged(e){return this._selections=e.selections,this._minimapSelections=null,this._actual.onSelectionChanged()}onDecorationsChanged(e){return e.affectsMinimap?this._actual.onDecorationsChanged():!1}onFlushed(e){return this._samplingState&&(this._shouldCheckSampling=!0),this._actual.onFlushed()}onLinesChanged(e){if(this._samplingState){const t=this._samplingState.modelLineRangeToMinimapLineRange(e.fromLineNumber,e.fromLineNumber+e.count-1);return t?this._actual.onLinesChanged(t[0],t[1]-t[0]+1):!1}else return this._actual.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){if(this._samplingState){const[t,i]=this._samplingState.onLinesDeleted(e);return t<=i&&this._actual.onLinesChanged(t+1,i-t+1),this._shouldCheckSampling=!0,!0}else return this._actual.onLinesDeleted(e.fromLineNumber,e.toLineNumber)}onLinesInserted(e){return this._samplingState?(this._samplingState.onLinesInserted(e),this._shouldCheckSampling=!0,!0):this._actual.onLinesInserted(e.fromLineNumber,e.toLineNumber)}onScrollChanged(e){return this._actual.onScrollChanged()}onThemeChanged(e){return this._actual.onThemeChanged(),this._onOptionsMaybeChanged(),!0}onTokensChanged(e){if(this._samplingState){const t=[];for(const i of e.ranges){const n=this._samplingState.modelLineRangeToMinimapLineRange(i.fromLineNumber,i.toLineNumber);n&&t.push({fromLineNumber:n[0],toLineNumber:n[1]})}return t.length?this._actual.onTokensChanged(t):!1}else return this._actual.onTokensChanged(e.ranges)}onTokensColorsChanged(e){return this._onOptionsMaybeChanged(),this._actual.onTokensColorsChanged()}onZonesChanged(e){return this._actual.onZonesChanged()}prepareRender(e){this._shouldCheckSampling&&(this._shouldCheckSampling=!1,this._recreateLineSampling())}render(e){let t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber;this._samplingState&&(t=this._samplingState.modelLineToMinimapLine(t),i=this._samplingState.modelLineToMinimapLine(i));const n={viewportContainsWhitespaceGaps:e.viewportData.whitespaceViewportData.length>0,scrollWidth:e.scrollWidth,scrollHeight:e.scrollHeight,viewportStartLineNumber:t,viewportEndLineNumber:i,viewportStartLineNumberVerticalOffset:e.getVerticalOffsetForLineNumber(t),scrollTop:e.scrollTop,scrollLeft:e.scrollLeft,viewportWidth:e.viewportWidth,viewportHeight:e.viewportHeight};this._actual.render(n)}_recreateLineSampling(){this._minimapSelections=null;const e=!!this._samplingState,[t,i]=jI.compute(this.options,this._context.viewModel.getLineCount(),this._samplingState);if(this._samplingState=t,e&&this._samplingState)for(const n of i)switch(n.type){case"deleted":this._actual.onLinesDeleted(n.deleteFromLineNumber,n.deleteToLineNumber);break;case"inserted":this._actual.onLinesInserted(n.insertFromLineNumber,n.insertToLineNumber);break;case"flush":this._actual.onFlushed();break}}getLineCount(){return this._samplingState?this._samplingState.minimapLines.length:this._context.viewModel.getLineCount()}getRealLineCount(){return this._context.viewModel.getLineCount()}getLineContent(e){return this._samplingState?this._context.viewModel.getLineContent(this._samplingState.minimapLines[e-1]):this._context.viewModel.getLineContent(e)}getLineMaxColumn(e){return this._samplingState?this._context.viewModel.getLineMaxColumn(this._samplingState.minimapLines[e-1]):this._context.viewModel.getLineMaxColumn(e)}getMinimapLinesRenderingData(e,t,i){if(this._samplingState){const n=[];for(let r=0,o=t-e+1;r<o;r++)i[r]?n[r]=this._context.viewModel.getViewLineData(this._samplingState.minimapLines[e+r-1]):n[r]=null;return n}return this._context.viewModel.getMinimapLinesRenderingData(e,t,i).data}getSelections(){if(this._minimapSelections===null)if(this._samplingState){this._minimapSelections=[];for(const e of this._selections){const[t,i]=this._samplingState.decorationLineRangeToMinimapLineRange(e.startLineNumber,e.endLineNumber);this._minimapSelections.push(new Ue(t,e.startColumn,i,e.endColumn))}}else this._minimapSelections=this._selections;return this._minimapSelections}getMinimapDecorationsInViewport(e,t){const i=this._getMinimapDecorationsInViewport(e,t).filter(n=>{var r;return!((r=n.options.minimap)!=null&&r.sectionHeaderStyle)});if(this._samplingState){const n=[];for(const r of i){if(!r.options.minimap)continue;const o=r.range,a=this._samplingState.modelLineToMinimapLine(o.startLineNumber),l=this._samplingState.modelLineToMinimapLine(o.endLineNumber);n.push(new Bpe(new F(a,o.startColumn,l,o.endColumn),r.options))}return n}return i}getSectionHeaderDecorationsInViewport(e,t){const i=this.options.minimapLineHeight,r=this.options.sectionHeaderFontSize/i;return e=Math.floor(Math.max(1,e-r)),this._getMinimapDecorationsInViewport(e,t).filter(o=>{var a;return!!((a=o.options.minimap)!=null&&a.sectionHeaderStyle)})}_getMinimapDecorationsInViewport(e,t){let i;if(this._samplingState){const n=this._samplingState.minimapLines[e-1],r=this._samplingState.minimapLines[t-1];i=new F(n,1,r,this._context.viewModel.getLineMaxColumn(r))}else i=new F(e,1,t,this._context.viewModel.getLineMaxColumn(t));return this._context.viewModel.getMinimapDecorationsInRange(i)}getSectionHeaderText(e,t){var o;const i=(o=e.options.minimap)==null?void 0:o.sectionHeaderText;if(!i)return null;const n=this._sectionHeaderCache.get(i);if(n)return n;const r=t(i);return this._sectionHeaderCache.set(i,r),r}getOptions(){return this._context.viewModel.model.getOptions()}revealLineNumber(e){this._samplingState&&(e=this._samplingState.minimapLines[e-1]),this._context.viewModel.revealRange("mouse",!1,new F(e,1,e,1),1,0)}setScrollTop(e){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:e},1)}}class OC extends te{constructor(e,t){super(),this._renderDecorations=!1,this._gestureInProgress=!1,this._theme=e,this._model=t,this._lastRenderData=null,this._buffers=null,this._selectionColor=this._theme.getColor(Die),this._domNode=gi(document.createElement("div")),mu.write(this._domNode,9),this._domNode.setClassName(this._getMinimapDomNodeClassName()),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._shadow=gi(document.createElement("div")),this._shadow.setClassName("minimap-shadow-hidden"),this._domNode.appendChild(this._shadow),this._canvas=gi(document.createElement("canvas")),this._canvas.setPosition("absolute"),this._canvas.setLeft(0),this._domNode.appendChild(this._canvas),this._decorationsCanvas=gi(document.createElement("canvas")),this._decorationsCanvas.setPosition("absolute"),this._decorationsCanvas.setClassName("minimap-decorations-layer"),this._decorationsCanvas.setLeft(0),this._domNode.appendChild(this._decorationsCanvas),this._slider=gi(document.createElement("div")),this._slider.setPosition("absolute"),this._slider.setClassName("minimap-slider"),this._slider.setLayerHinting(!0),this._slider.setContain("strict"),this._domNode.appendChild(this._slider),this._sliderHorizontal=gi(document.createElement("div")),this._sliderHorizontal.setPosition("absolute"),this._sliderHorizontal.setClassName("minimap-slider-horizontal"),this._slider.appendChild(this._sliderHorizontal),this._applyLayout(),this._pointerDownListener=yn(this._domNode.domNode,Le.POINTER_DOWN,i=>{if(i.preventDefault(),this._model.options.renderMinimap===0||!this._lastRenderData)return;if(this._model.options.size!=="proportional"){if(i.button===0&&this._lastRenderData){const c=Pn(this._slider.domNode),d=c.top+c.height/2;this._startSliderDragging(i,d,this._lastRenderData.renderedLayout)}return}const r=this._model.options.minimapLineHeight,o=this._model.options.canvasInnerHeight/this._model.options.canvasOuterHeight*i.offsetY;let l=Math.floor(o/r)+this._lastRenderData.renderedLayout.startLineNumber-this._lastRenderData.renderedLayout.topPaddingLineCount;l=Math.min(l,this._model.getLineCount()),this._model.revealLineNumber(l)}),this._sliderPointerMoveMonitor=new pS,this._sliderPointerDownListener=yn(this._slider.domNode,Le.POINTER_DOWN,i=>{i.preventDefault(),i.stopPropagation(),i.button===0&&this._lastRenderData&&this._startSliderDragging(i,i.pageY,this._lastRenderData.renderedLayout)}),this._gestureDisposable=Er.addTarget(this._domNode.domNode),this._sliderTouchStartListener=oe(this._domNode.domNode,Vi.Start,i=>{i.preventDefault(),i.stopPropagation(),this._lastRenderData&&(this._slider.toggleClassName("active",!0),this._gestureInProgress=!0,this.scrollDueToTouchEvent(i))},{passive:!1}),this._sliderTouchMoveListener=oe(this._domNode.domNode,Vi.Change,i=>{i.preventDefault(),i.stopPropagation(),this._lastRenderData&&this._gestureInProgress&&this.scrollDueToTouchEvent(i)},{passive:!1}),this._sliderTouchEndListener=yn(this._domNode.domNode,Vi.End,i=>{i.preventDefault(),i.stopPropagation(),this._gestureInProgress=!1,this._slider.toggleClassName("active",!1)})}_startSliderDragging(e,t,i){if(!e.target||!(e.target instanceof Element))return;const n=e.pageX;this._slider.toggleClassName("active",!0);const r=(o,a)=>{const l=Pn(this._domNode.domNode),c=Math.min(Math.abs(a-n),Math.abs(a-l.left),Math.abs(a-l.left-l.width));if(gr&&c>kze){this._model.setScrollTop(i.scrollTop);return}const d=o-t;this._model.setScrollTop(i.getDesiredScrollTopFromDelta(d))};e.pageY!==t&&r(e.pageY,n),this._sliderPointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,o=>r(o.pageY,o.pageX),()=>{this._slider.toggleClassName("active",!1)})}scrollDueToTouchEvent(e){const t=this._domNode.domNode.getBoundingClientRect().top,i=this._lastRenderData.renderedLayout.getDesiredScrollTopFromTouchLocation(e.pageY-t);this._model.setScrollTop(i)}dispose(){this._pointerDownListener.dispose(),this._sliderPointerMoveMonitor.dispose(),this._sliderPointerDownListener.dispose(),this._gestureDisposable.dispose(),this._sliderTouchStartListener.dispose(),this._sliderTouchMoveListener.dispose(),this._sliderTouchEndListener.dispose(),super.dispose()}_getMinimapDomNodeClassName(){const e=["minimap"];return this._model.options.showSlider==="always"?e.push("slider-always"):e.push("slider-mouseover"),this._model.options.autohide&&e.push("autohide"),e.join(" ")}getDomNode(){return this._domNode}_applyLayout(){this._domNode.setLeft(this._model.options.minimapLeft),this._domNode.setWidth(this._model.options.minimapWidth),this._domNode.setHeight(this._model.options.minimapHeight),this._shadow.setHeight(this._model.options.minimapHeight),this._canvas.setWidth(this._model.options.canvasOuterWidth),this._canvas.setHeight(this._model.options.canvasOuterHeight),this._canvas.domNode.width=this._model.options.canvasInnerWidth,this._canvas.domNode.height=this._model.options.canvasInnerHeight,this._decorationsCanvas.setWidth(this._model.options.canvasOuterWidth),this._decorationsCanvas.setHeight(this._model.options.canvasOuterHeight),this._decorationsCanvas.domNode.width=this._model.options.canvasInnerWidth,this._decorationsCanvas.domNode.height=this._model.options.canvasInnerHeight,this._slider.setWidth(this._model.options.minimapWidth)}_getBuffer(){return this._buffers||this._model.options.canvasInnerWidth>0&&this._model.options.canvasInnerHeight>0&&(this._buffers=new NG(this._canvas.domNode.getContext("2d"),this._model.options.canvasInnerWidth,this._model.options.canvasInnerHeight,this._model.options.backgroundColor)),this._buffers?this._buffers.getBuffer():null}onDidChangeOptions(){this._lastRenderData=null,this._buffers=null,this._applyLayout(),this._domNode.setClassName(this._getMinimapDomNodeClassName())}onSelectionChanged(){return this._renderDecorations=!0,!0}onDecorationsChanged(){return this._renderDecorations=!0,!0}onFlushed(){return this._lastRenderData=null,!0}onLinesChanged(e,t){return this._lastRenderData?this._lastRenderData.onLinesChanged(e,t):!1}onLinesDeleted(e,t){var i;return(i=this._lastRenderData)==null||i.onLinesDeleted(e,t),!0}onLinesInserted(e,t){var i;return(i=this._lastRenderData)==null||i.onLinesInserted(e,t),!0}onScrollChanged(){return this._renderDecorations=!0,!0}onThemeChanged(){return this._selectionColor=this._theme.getColor(Die),this._renderDecorations=!0,!0}onTokensChanged(e){return this._lastRenderData?this._lastRenderData.onTokensChanged(e):!1}onTokensColorsChanged(){return this._lastRenderData=null,this._buffers=null,!0}onZonesChanged(){return this._lastRenderData=null,!0}render(e){if(this._model.options.renderMinimap===0){this._shadow.setClassName("minimap-shadow-hidden"),this._sliderHorizontal.setWidth(0),this._sliderHorizontal.setHeight(0);return}e.scrollLeft+e.viewportWidth>=e.scrollWidth?this._shadow.setClassName("minimap-shadow-hidden"):this._shadow.setClassName("minimap-shadow-visible");const i=XL.create(this._model.options,e.viewportStartLineNumber,e.viewportEndLineNumber,e.viewportStartLineNumberVerticalOffset,e.viewportHeight,e.viewportContainsWhitespaceGaps,this._model.getLineCount(),this._model.getRealLineCount(),e.scrollTop,e.scrollHeight,this._lastRenderData?this._lastRenderData.renderedLayout:null);this._slider.setDisplay(i.sliderNeeded?"block":"none"),this._slider.setTop(i.sliderTop),this._slider.setHeight(i.sliderHeight),this._sliderHorizontal.setLeft(0),this._sliderHorizontal.setWidth(this._model.options.minimapWidth),this._sliderHorizontal.setTop(0),this._sliderHorizontal.setHeight(i.sliderHeight),this.renderDecorations(i),this._lastRenderData=this.renderLines(i)}renderDecorations(e){if(this._renderDecorations){this._renderDecorations=!1;const t=this._model.getSelections();t.sort(F.compareRangesUsingStarts);const i=this._model.getMinimapDecorationsInViewport(e.startLineNumber,e.endLineNumber);i.sort((h,g)=>(h.options.zIndex||0)-(g.options.zIndex||0));const{canvasInnerWidth:n,canvasInnerHeight:r}=this._model.options,o=this._model.options.minimapLineHeight,a=this._model.options.minimapCharWidth,l=this._model.getOptions().tabSize,c=this._decorationsCanvas.domNode.getContext("2d");c.clearRect(0,0,n,r);const d=new Pse(e.startLineNumber,e.endLineNumber,!1);this._renderSelectionLineHighlights(c,t,d,e,o),this._renderDecorationsLineHighlights(c,i,d,e,o);const u=new Pse(e.startLineNumber,e.endLineNumber,null);this._renderSelectionsHighlights(c,t,u,e,o,l,a,n),this._renderDecorationsHighlights(c,i,u,e,o,l,a,n),this._renderSectionHeaders(e)}}_renderSelectionLineHighlights(e,t,i,n,r){if(!this._selectionColor||this._selectionColor.isTransparent())return;e.fillStyle=this._selectionColor.transparent(.5).toString();let o=0,a=0;for(const l of t){const c=n.intersectWithViewport(l);if(!c)continue;const[d,u]=c;for(let p=d;p<=u;p++)i.set(p,!0);const h=n.getYForLineNumber(d,r),g=n.getYForLineNumber(u,r);a>=h||(a>o&&e.fillRect(Uu,o,e.canvas.width,a-o),o=h),a=g}a>o&&e.fillRect(Uu,o,e.canvas.width,a-o)}_renderDecorationsLineHighlights(e,t,i,n,r){const o=new Map;for(let a=t.length-1;a>=0;a--){const l=t[a],c=l.options.minimap;if(!c||c.position!==1)continue;const d=n.intersectWithViewport(l.range);if(!d)continue;const[u,h]=d,g=c.getColor(this._theme.value);if(!g||g.isTransparent())continue;let p=o.get(g.toString());p||(p=g.transparent(.5).toString(),o.set(g.toString(),p)),e.fillStyle=p;for(let _=u;_<=h;_++){if(i.has(_))continue;i.set(_,!0);const v=n.getYForLineNumber(u,r);e.fillRect(Uu,v,e.canvas.width,r)}}}_renderSelectionsHighlights(e,t,i,n,r,o,a,l){if(!(!this._selectionColor||this._selectionColor.isTransparent()))for(const c of t){const d=n.intersectWithViewport(c);if(!d)continue;const[u,h]=d;for(let g=u;g<=h;g++)this.renderDecorationOnLine(e,i,c,this._selectionColor,n,g,r,r,o,a,l)}}_renderDecorationsHighlights(e,t,i,n,r,o,a,l){for(const c of t){const d=c.options.minimap;if(!d)continue;const u=n.intersectWithViewport(c.range);if(!u)continue;const[h,g]=u,p=d.getColor(this._theme.value);if(!(!p||p.isTransparent()))for(let _=h;_<=g;_++)switch(d.position){case 1:this.renderDecorationOnLine(e,i,c.range,p,n,_,r,r,o,a,l);continue;case 2:{const v=n.getYForLineNumber(_,r);this.renderDecoration(e,p,2,v,Ize,r);continue}}}}renderDecorationOnLine(e,t,i,n,r,o,a,l,c,d,u){const h=r.getYForLineNumber(o,l);if(h+a<0||h>this._model.options.canvasInnerHeight)return;const{startLineNumber:g,endLineNumber:p}=i,_=g===o?i.startColumn:1,v=p===o?i.endColumn:this._model.getLineMaxColumn(o),C=this.getXOffsetForPosition(t,o,_,c,d,u),y=this.getXOffsetForPosition(t,o,v,c,d,u);this.renderDecoration(e,n,C,h,y-C,a)}getXOffsetForPosition(e,t,i,n,r,o){if(i===1)return Uu;if((i-1)*r>=o)return o;let l=e.get(t);if(!l){const c=this._model.getLineContent(t);l=[Uu];let d=Uu;for(let u=1;u<c.length+1;u++){const h=c.charCodeAt(u-1),g=h===9?n*r:Um(h)?2*r:r,p=d+g;if(p>=o){l[u]=o;break}l[u]=p,d=p}e.set(t,l)}return i-1<l.length?l[i-1]:o}renderDecoration(e,t,i,n,r,o){e.fillStyle=t&&t.toString()||"",e.fillRect(i,n,r,o)}_renderSectionHeaders(e){var _;const t=this._model.options.minimapLineHeight,i=this._model.options.sectionHeaderFontSize,n=this._model.options.sectionHeaderLetterSpacing,r=i*1.5,{canvasInnerWidth:o}=this._model.options,a=this._model.options.backgroundColor,l=`rgb(${a.r} ${a.g} ${a.b} / .7)`,c=this._model.options.sectionHeaderFontColor,d=`rgb(${c.r} ${c.g} ${c.b})`,u=d,h=this._decorationsCanvas.domNode.getContext("2d");h.letterSpacing=n+"px",h.font="500 "+i+"px "+this._model.options.sectionHeaderFontFamily,h.strokeStyle=u,h.lineWidth=.2;const g=this._model.getSectionHeaderDecorationsInViewport(e.startLineNumber,e.endLineNumber);g.sort((v,C)=>v.range.startLineNumber-C.range.startLineNumber);const p=OC._fitSectionHeader.bind(null,h,o-Uu);for(const v of g){const C=e.getYForLineNumber(v.range.startLineNumber,t)+i,y=C-i,x=y+2,L=this._model.getSectionHeaderText(v,p);OC._renderSectionLabel(h,L,((_=v.options.minimap)==null?void 0:_.sectionHeaderStyle)===2,l,d,o,y,r,C,x)}}static _fitSectionHeader(e,t,i){if(!i)return i;const n="…",r=e.measureText(i).width,o=e.measureText(n).width;if(r<=t||r<=o)return i;const a=i.length,l=r/i.length,c=Math.floor((t-o)/l)-1;let d=Math.ceil(c/2);for(;d>0&&/\s/.test(i[d-1]);)--d;return i.substring(0,d)+n+i.substring(a-(c-d))}static _renderSectionLabel(e,t,i,n,r,o,a,l,c,d){t&&(e.fillStyle=n,e.fillRect(0,a,o,l),e.fillStyle=r,e.fillText(t,Uu,c)),i&&(e.beginPath(),e.moveTo(0,d),e.lineTo(o,d),e.closePath(),e.stroke())}renderLines(e){const t=e.startLineNumber,i=e.endLineNumber,n=this._model.options.minimapLineHeight;if(this._lastRenderData&&this._lastRenderData.linesEquals(e)){const re=this._lastRenderData._get();return new Ase(e,re.imageData,re.lines)}const r=this._getBuffer();if(!r)return null;const[o,a,l]=OC._renderUntouchedLines(r,e.topPaddingLineCount,t,i,n,this._lastRenderData),c=this._model.getMinimapLinesRenderingData(t,i,l),d=this._model.getOptions().tabSize,u=this._model.options.defaultBackgroundColor,h=this._model.options.backgroundColor,g=this._model.options.foregroundAlpha,p=this._model.tokensColorTracker,_=p.backgroundIsLight(),v=this._model.options.renderMinimap,C=this._model.options.charRenderer(),y=this._model.options.fontScale,x=this._model.options.minimapCharWidth,I=(v===1?2:3)*y,A=n>I?Math.floor((n-I)/2):0,D=h.a/255,N=new ug(Math.round((h.r-u.r)*D+u.r),Math.round((h.g-u.g)*D+u.g),Math.round((h.b-u.b)*D+u.b),255);let R=e.topPaddingLineCount*n;const W=[];for(let re=0,pe=i-t+1;re<pe;re++)l[re]&&OC._renderLine(r,N,h.a,_,v,x,p,g,C,R,A,d,c[re],y,n),W[re]=new hP(R),R+=n;const H=o===-1?0:o,B=(a===-1?r.height:a)-H;return this._canvas.domNode.getContext("2d").putImageData(r,0,0,0,H,r.width,B),new Ase(e,r,W)}static _renderUntouchedLines(e,t,i,n,r,o){const a=[];if(!o){for(let R=0,W=n-i+1;R<W;R++)a[R]=!0;return[-1,-1,a]}const l=o._get(),c=l.imageData.data,d=l.rendLineNumberStart,u=l.lines,h=u.length,g=e.width,p=e.data,_=(n-i+1)*r*g*4;let v=-1,C=-1,y=-1,x=-1,L=-1,I=-1,A=t*r;for(let R=i;R<=n;R++){const W=R-i,H=R-d,U=H>=0&&H<h?u[H].dy:-1;if(U===-1){a[W]=!0,A+=r;continue}const B=U*g*4,ee=(U+r)*g*4,re=A*g*4,pe=(A+r)*g*4;x===B&&I===re?(x=ee,I=pe):(y!==-1&&(p.set(c.subarray(y,x),L),v===-1&&y===0&&y===L&&(v=x),C===-1&&x===_&&y===L&&(C=y)),y=B,x=ee,L=re,I=pe),a[W]=!1,A+=r}y!==-1&&(p.set(c.subarray(y,x),L),v===-1&&y===0&&y===L&&(v=x),C===-1&&x===_&&y===L&&(C=y));const D=v===-1?-1:v/(g*4),N=C===-1?-1:C/(g*4);return[D,N,a]}static _renderLine(e,t,i,n,r,o,a,l,c,d,u,h,g,p,_){const v=g.content,C=g.tokens,y=e.width-o,x=_===1;let L=Uu,I=0,A=0;for(let D=0,N=C.getCount();D<N;D++){const R=C.getEndOffset(D),W=C.getForeground(D),H=a.getColor(W);for(;I<R;I++){if(L>y)return;const U=v.charCodeAt(I);if(U===9){const B=h-(I+A)%h;A+=B-1,L+=B*o}else if(U===32)L+=o;else{const B=Um(U)?2:1;for(let ee=0;ee<B;ee++)if(r===2?c.blockRenderChar(e,L,d+u,H,l,t,i,x):c.renderChar(e,L,d+u,U,H,l,t,i,p,n,x),L+=o,L>y)return}}}}}class Pse{constructor(e,t,i){this._startLineNumber=e,this._endLineNumber=t,this._defaultValue=i,this._values=[];for(let n=0,r=this._endLineNumber-this._startLineNumber+1;n<r;n++)this._values[n]=i}has(e){return this.get(e)!==this._defaultValue}set(e,t){e<this._startLineNumber||e>this._endLineNumber||(this._values[e-this._startLineNumber]=t)}get(e){return e<this._startLineNumber||e>this._endLineNumber?this._defaultValue:this._values[e-this._startLineNumber]}}class Dze extends za{constructor(e,t){super(e),this._viewDomNode=t;const n=this._context.configuration.options.get(146);this._widgets={},this._verticalScrollbarWidth=n.verticalScrollbarWidth,this._minimapWidth=n.minimap.minimapWidth,this._horizontalScrollbarHeight=n.horizontalScrollbarHeight,this._editorHeight=n.height,this._editorWidth=n.width,this._viewDomNodeRect={top:0,left:0,width:0,height:0},this._domNode=gi(document.createElement("div")),mu.write(this._domNode,4),this._domNode.setClassName("overlayWidgets"),this.overflowingOverlayWidgetsDomNode=gi(document.createElement("div")),mu.write(this.overflowingOverlayWidgetsDomNode,5),this.overflowingOverlayWidgetsDomNode.setClassName("overflowingOverlayWidgets")}dispose(){super.dispose(),this._widgets={}}getDomNode(){return this._domNode}onConfigurationChanged(e){const i=this._context.configuration.options.get(146);return this._verticalScrollbarWidth=i.verticalScrollbarWidth,this._minimapWidth=i.minimap.minimapWidth,this._horizontalScrollbarHeight=i.horizontalScrollbarHeight,this._editorHeight=i.height,this._editorWidth=i.width,!0}addWidget(e){const t=gi(e.getDomNode());this._widgets[e.getId()]={widget:e,preference:null,domNode:t},t.setPosition("absolute"),t.setAttribute("widgetId",e.getId()),e.allowEditorOverflow?this.overflowingOverlayWidgetsDomNode.appendChild(t):this._domNode.appendChild(t),this.setShouldRender(),this._updateMaxMinWidth()}setWidgetPosition(e,t){const i=this._widgets[e.getId()],n=t?t.preference:null,r=t==null?void 0:t.stackOridinal;return i.preference===n&&i.stack===r?(this._updateMaxMinWidth(),!1):(i.preference=n,i.stack=r,this.setShouldRender(),this._updateMaxMinWidth(),!0)}removeWidget(e){const t=e.getId();if(this._widgets.hasOwnProperty(t)){const n=this._widgets[t].domNode.domNode;delete this._widgets[t],n.remove(),this.setShouldRender(),this._updateMaxMinWidth()}}_updateMaxMinWidth(){var i,n;let e=0;const t=Object.keys(this._widgets);for(let r=0,o=t.length;r<o;r++){const a=t[r],c=(n=(i=this._widgets[a].widget).getMinContentWidthInPx)==null?void 0:n.call(i);typeof c<"u"&&(e=Math.max(e,c))}this._context.viewLayout.setOverlayWidgetsMinWidth(e)}_renderWidget(e,t){const i=e.domNode;if(e.preference===null){i.setTop("");return}const n=2*this._verticalScrollbarWidth+this._minimapWidth;if(e.preference===0||e.preference===1){if(e.preference===1){const r=i.domNode.clientHeight;i.setTop(this._editorHeight-r-2*this._horizontalScrollbarHeight)}else i.setTop(0);e.stack!==void 0?(i.setTop(t[e.preference]),t[e.preference]+=i.domNode.clientWidth):i.setRight(n)}else if(e.preference===2)i.domNode.style.right="50%",e.stack!==void 0?(i.setTop(t[2]),t[2]+=i.domNode.clientHeight):i.setTop(0);else{const{top:r,left:o}=e.preference;if(this._context.configuration.options.get(42)&&e.widget.allowEditorOverflow){const l=this._viewDomNodeRect;i.setTop(r+l.top),i.setLeft(o+l.left),i.setPosition("fixed")}else i.setTop(r),i.setLeft(o),i.setPosition("absolute")}}prepareRender(e){this._viewDomNodeRect=Pn(this._viewDomNode.domNode)}render(e){this._domNode.setWidth(this._editorWidth);const t=Object.keys(this._widgets),i=Array.from({length:3},()=>0);t.sort((n,r)=>(this._widgets[n].stack||0)-(this._widgets[r].stack||0));for(let n=0,r=t.length;n<r;n++){const o=t[n];this._renderWidget(this._widgets[o],i)}}}class Tze{constructor(e,t){const i=e.options;this.lineHeight=i.get(67),this.pixelRatio=i.get(144),this.overviewRulerLanes=i.get(83),this.renderBorder=i.get(82);const n=t.getColor(EVe);this.borderColor=n?n.toString():null,this.hideCursor=i.get(59);const r=t.getColor(UF);this.cursorColorSingle=r?r.transparent(.7).toString():null;const o=t.getColor(gge);this.cursorColorPrimary=o?o.transparent(.7).toString():null;const a=t.getColor(pge);this.cursorColorSecondary=a?a.transparent(.7).toString():null,this.themeType=t.type;const l=i.get(73),c=l.enabled,d=l.side,u=t.getColor(DVe),h=Ln.getDefaultBackground();u?this.backgroundColor=u:c&&d==="right"?this.backgroundColor=h:this.backgroundColor=null;const p=i.get(146).overviewRuler;this.top=p.top,this.right=p.right,this.domWidth=p.width,this.domHeight=p.height,this.overviewRulerLanes===0?(this.canvasWidth=0,this.canvasHeight=0):(this.canvasWidth=this.domWidth*this.pixelRatio|0,this.canvasHeight=this.domHeight*this.pixelRatio|0);const[_,v]=this._initLanes(1,this.canvasWidth,this.overviewRulerLanes);this.x=_,this.w=v}_initLanes(e,t,i){const n=t-e;if(i>=3){const r=Math.floor(n/3),o=Math.floor(n/3),a=n-r-o,l=e,c=l+r,d=l+r+a;return[[0,l,c,l,d,l,c,l],[0,r,a,r+a,o,r+a+o,a+o,r+a+o]]}else if(i===2){const r=Math.floor(n/2),o=n-r,a=e,l=a+r;return[[0,a,a,a,l,a,a,a],[0,r,r,r,o,r+o,r+o,r+o]]}else{const r=e,o=n;return[[0,r,r,r,r,r,r,r],[0,o,o,o,o,o,o,o]]}}equals(e){return this.lineHeight===e.lineHeight&&this.pixelRatio===e.pixelRatio&&this.overviewRulerLanes===e.overviewRulerLanes&&this.renderBorder===e.renderBorder&&this.borderColor===e.borderColor&&this.hideCursor===e.hideCursor&&this.cursorColorSingle===e.cursorColorSingle&&this.cursorColorPrimary===e.cursorColorPrimary&&this.cursorColorSecondary===e.cursorColorSecondary&&this.themeType===e.themeType&&fe.equals(this.backgroundColor,e.backgroundColor)&&this.top===e.top&&this.right===e.right&&this.domWidth===e.domWidth&&this.domHeight===e.domHeight&&this.canvasWidth===e.canvasWidth&&this.canvasHeight===e.canvasHeight}}class Nze extends za{constructor(e){super(e),this._actualShouldRender=0,this._renderedDecorations=[],this._renderedCursorPositions=[],this._domNode=gi(document.createElement("canvas")),this._domNode.setClassName("decorationsOverviewRuler"),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._domNode.setAttribute("aria-hidden","true"),this._updateSettings(!1),this._tokensColorTrackerListener=Ln.onDidChange(t=>{t.changedColorMap&&this._updateSettings(!0)}),this._cursorPositions=[{position:new X(1,1),color:this._settings.cursorColorSingle}]}dispose(){super.dispose(),this._tokensColorTrackerListener.dispose()}_updateSettings(e){const t=new Tze(this._context.configuration,this._context.theme);return this._settings&&this._settings.equals(t)?!1:(this._settings=t,this._domNode.setTop(this._settings.top),this._domNode.setRight(this._settings.right),this._domNode.setWidth(this._settings.domWidth),this._domNode.setHeight(this._settings.domHeight),this._domNode.domNode.width=this._settings.canvasWidth,this._domNode.domNode.height=this._settings.canvasHeight,e&&this._render(),!0)}_markRenderingIsNeeded(){return this._actualShouldRender=2,!0}_markRenderingIsMaybeNeeded(){return this._actualShouldRender=1,!0}onConfigurationChanged(e){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}onCursorStateChanged(e){this._cursorPositions=[];for(let t=0,i=e.selections.length;t<i;t++){let n=this._settings.cursorColorSingle;i>1&&(n=t===0?this._settings.cursorColorPrimary:this._settings.cursorColorSecondary),this._cursorPositions.push({position:e.selections[t].getPosition(),color:n})}return this._cursorPositions.sort((t,i)=>X.compare(t.position,i.position)),this._markRenderingIsMaybeNeeded()}onDecorationsChanged(e){return e.affectsOverviewRuler?this._markRenderingIsMaybeNeeded():!1}onFlushed(e){return this._markRenderingIsNeeded()}onScrollChanged(e){return e.scrollHeightChanged?this._markRenderingIsNeeded():!1}onZonesChanged(e){return this._markRenderingIsNeeded()}onThemeChanged(e){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}getDomNode(){return this._domNode.domNode}prepareRender(e){}render(e){this._render(),this._actualShouldRender=0}_render(){const e=this._settings.backgroundColor;if(this._settings.overviewRulerLanes===0){this._domNode.setBackgroundColor(e?fe.Format.CSS.formatHexA(e):""),this._domNode.setDisplay("none");return}const t=this._context.viewModel.getAllOverviewRulerDecorations(this._context.theme);if(t.sort(OI.compareByRenderingProps),this._actualShouldRender===1&&!OI.equalsArr(this._renderedDecorations,t)&&(this._actualShouldRender=2),this._actualShouldRender===1&&!dn(this._renderedCursorPositions,this._cursorPositions,(p,_)=>p.position.lineNumber===_.position.lineNumber&&p.color===_.color)&&(this._actualShouldRender=2),this._actualShouldRender===1)return;this._renderedDecorations=t,this._renderedCursorPositions=this._cursorPositions,this._domNode.setDisplay("block");const i=this._settings.canvasWidth,n=this._settings.canvasHeight,r=this._settings.lineHeight,o=this._context.viewLayout,a=this._context.viewLayout.getScrollHeight(),l=n/a,c=6*this._settings.pixelRatio|0,d=c/2|0,u=this._domNode.domNode.getContext("2d");e?e.isOpaque()?(u.fillStyle=fe.Format.CSS.formatHexA(e),u.fillRect(0,0,i,n)):(u.clearRect(0,0,i,n),u.fillStyle=fe.Format.CSS.formatHexA(e),u.fillRect(0,0,i,n)):u.clearRect(0,0,i,n);const h=this._settings.x,g=this._settings.w;for(const p of t){const _=p.color,v=p.data;u.fillStyle=_;let C=0,y=0,x=0;for(let L=0,I=v.length/3;L<I;L++){const A=v[3*L],D=v[3*L+1],N=v[3*L+2];let R=o.getVerticalOffsetForLineNumber(D)*l|0,W=(o.getVerticalOffsetForLineNumber(N)+r)*l|0;if(W-R<c){let U=(R+W)/2|0;U<d?U=d:U+d>n&&(U=n-d),R=U-d,W=U+d}R>x+1||A!==C?(L!==0&&u.fillRect(h[C],y,g[C],x-y),C=A,y=R,x=W):W>x&&(x=W)}u.fillRect(h[C],y,g[C],x-y)}if(!this._settings.hideCursor){const p=2*this._settings.pixelRatio|0,_=p/2|0,v=this._settings.x[7],C=this._settings.w[7];let y=-100,x=-100,L=null;for(let I=0,A=this._cursorPositions.length;I<A;I++){const D=this._cursorPositions[I].color;if(!D)continue;const N=this._cursorPositions[I].position;let R=o.getVerticalOffsetForLineNumber(N.lineNumber)*l|0;R<_?R=_:R+_>n&&(R=n-_);const W=R-_,H=W+p;W>x+1||D!==L?(I!==0&&L&&u.fillRect(v,y,C,x-y),y=W,x=H):H>x&&(x=H),L=D,u.fillStyle=D}L&&u.fillRect(v,y,C,x-y)}this._settings.renderBorder&&this._settings.borderColor&&this._settings.overviewRulerLanes>0&&(u.beginPath(),u.lineWidth=1,u.strokeStyle=this._settings.borderColor,u.moveTo(0,0),u.lineTo(0,n),u.moveTo(1,0),u.lineTo(i,0),u.stroke())}}class Mse{constructor(e,t,i){this._colorZoneBrand=void 0,this.from=e|0,this.to=t|0,this.colorId=i|0}static compare(e,t){return e.colorId===t.colorId?e.from===t.from?e.to-t.to:e.from-t.from:e.colorId-t.colorId}}class sme{constructor(e,t,i,n){this._overviewRulerZoneBrand=void 0,this.startLineNumber=e,this.endLineNumber=t,this.heightInLines=i,this.color=n,this._colorZone=null}static compare(e,t){return e.color===t.color?e.startLineNumber===t.startLineNumber?e.heightInLines===t.heightInLines?e.endLineNumber-t.endLineNumber:e.heightInLines-t.heightInLines:e.startLineNumber-t.startLineNumber:e.color<t.color?-1:1}setColorZone(e){this._colorZone=e}getColorZones(){return this._colorZone}}class Rze{constructor(e){this._getVerticalOffsetForLine=e,this._zones=[],this._colorZonesInvalid=!1,this._lineHeight=0,this._domWidth=0,this._domHeight=0,this._outerHeight=0,this._pixelRatio=1,this._lastAssignedId=0,this._color2Id=Object.create(null),this._id2Color=[]}getId2Color(){return this._id2Color}setZones(e){this._zones=e,this._zones.sort(sme.compare)}setLineHeight(e){return this._lineHeight===e?!1:(this._lineHeight=e,this._colorZonesInvalid=!0,!0)}setPixelRatio(e){this._pixelRatio=e,this._colorZonesInvalid=!0}getDOMWidth(){return this._domWidth}getCanvasWidth(){return this._domWidth*this._pixelRatio}setDOMWidth(e){return this._domWidth===e?!1:(this._domWidth=e,this._colorZonesInvalid=!0,!0)}getDOMHeight(){return this._domHeight}getCanvasHeight(){return this._domHeight*this._pixelRatio}setDOMHeight(e){return this._domHeight===e?!1:(this._domHeight=e,this._colorZonesInvalid=!0,!0)}getOuterHeight(){return this._outerHeight}setOuterHeight(e){return this._outerHeight===e?!1:(this._outerHeight=e,this._colorZonesInvalid=!0,!0)}resolveColorZones(){const e=this._colorZonesInvalid,t=Math.floor(this._lineHeight),i=Math.floor(this.getCanvasHeight()),n=Math.floor(this._outerHeight),r=i/n,o=Math.floor(4*this._pixelRatio/2),a=[];for(let l=0,c=this._zones.length;l<c;l++){const d=this._zones[l];if(!e){const L=d.getColorZones();if(L){a.push(L);continue}}const u=this._getVerticalOffsetForLine(d.startLineNumber),h=d.heightInLines===0?this._getVerticalOffsetForLine(d.endLineNumber)+t:u+d.heightInLines*t,g=Math.floor(r*u),p=Math.floor(r*h);let _=Math.floor((g+p)/2),v=p-_;v<o&&(v=o),_-v<0&&(_=v),_+v>i&&(_=i-v);const C=d.color;let y=this._color2Id[C];y||(y=++this._lastAssignedId,this._color2Id[C]=y,this._id2Color[y]=C);const x=new Mse(_-v,_+v,y);d.setColorZone(x),a.push(x)}return this._colorZonesInvalid=!1,a.sort(Mse.compare),a}}class Aze extends uD{constructor(e,t){super(),this._context=e;const i=this._context.configuration.options;this._domNode=gi(document.createElement("canvas")),this._domNode.setClassName(t),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._zoneManager=new Rze(n=>this._context.viewLayout.getVerticalOffsetForLineNumber(n)),this._zoneManager.setDOMWidth(0),this._zoneManager.setDOMHeight(0),this._zoneManager.setOuterHeight(this._context.viewLayout.getScrollHeight()),this._zoneManager.setLineHeight(i.get(67)),this._zoneManager.setPixelRatio(i.get(144)),this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return e.hasChanged(67)&&(this._zoneManager.setLineHeight(t.get(67)),this._render()),e.hasChanged(144)&&(this._zoneManager.setPixelRatio(t.get(144)),this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render()),!0}onFlushed(e){return this._render(),!0}onScrollChanged(e){return e.scrollHeightChanged&&(this._zoneManager.setOuterHeight(e.scrollHeight),this._render()),!0}onZonesChanged(e){return this._render(),!0}getDomNode(){return this._domNode.domNode}setLayout(e){this._domNode.setTop(e.top),this._domNode.setRight(e.right);let t=!1;t=this._zoneManager.setDOMWidth(e.width)||t,t=this._zoneManager.setDOMHeight(e.height)||t,t&&(this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render())}setZones(e){this._zoneManager.setZones(e),this._render()}_render(){if(this._zoneManager.getOuterHeight()===0)return!1;const e=this._zoneManager.getCanvasWidth(),t=this._zoneManager.getCanvasHeight(),i=this._zoneManager.resolveColorZones(),n=this._zoneManager.getId2Color(),r=this._domNode.domNode.getContext("2d");return r.clearRect(0,0,e,t),i.length>0&&this._renderOneLane(r,i,n,e),!0}_renderOneLane(e,t,i,n){let r=0,o=0,a=0;for(const l of t){const c=l.colorId,d=l.from,u=l.to;c!==r?(e.fillRect(0,o,n,a-o),r=c,e.fillStyle=i[r],o=d,a=u):a>=d?a=Math.max(a,u):(e.fillRect(0,o,n,a-o),o=d,a=u)}e.fillRect(0,o,n,a-o)}}class Pze extends za{constructor(e){super(e),this.domNode=gi(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("view-rulers"),this._renderedRulers=[];const t=this._context.configuration.options;this._rulers=t.get(103),this._typicalHalfwidthCharacterWidth=t.get(50).typicalHalfwidthCharacterWidth}dispose(){super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return this._rulers=t.get(103),this._typicalHalfwidthCharacterWidth=t.get(50).typicalHalfwidthCharacterWidth,!0}onScrollChanged(e){return e.scrollHeightChanged}prepareRender(e){}_ensureRulersCount(){const e=this._renderedRulers.length,t=this._rulers.length;if(e===t)return;if(e<t){const{tabSize:n}=this._context.viewModel.model.getOptions(),r=n;let o=t-e;for(;o>0;){const a=gi(document.createElement("div"));a.setClassName("view-ruler"),a.setWidth(r),this.domNode.appendChild(a),this._renderedRulers.push(a),o--}return}let i=e-t;for(;i>0;){const n=this._renderedRulers.pop();this.domNode.removeChild(n),i--}}render(e){this._ensureRulersCount();for(let t=0,i=this._rulers.length;t<i;t++){const n=this._renderedRulers[t],r=this._rulers[t];n.setBoxShadow(r.color?`1px 0 0 0 ${r.color} inset`:""),n.setHeight(Math.min(e.scrollHeight,1e6)),n.setLeft(r.column*this._typicalHalfwidthCharacterWidth)}}}class Mze extends za{constructor(e){super(e),this._scrollTop=0,this._width=0,this._updateWidth(),this._shouldShow=!1;const i=this._context.configuration.options.get(104);this._useShadows=i.useShadows,this._domNode=gi(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true")}dispose(){super.dispose()}_updateShouldShow(){const e=this._useShadows&&this._scrollTop>0;return this._shouldShow!==e?(this._shouldShow=e,!0):!1}getDomNode(){return this._domNode}_updateWidth(){const t=this._context.configuration.options.get(146);t.minimap.renderMinimap===0||t.minimap.minimapWidth>0&&t.minimap.minimapLeft===0?this._width=t.width:this._width=t.width-t.verticalScrollbarWidth}onConfigurationChanged(e){const i=this._context.configuration.options.get(104);return this._useShadows=i.useShadows,this._updateWidth(),this._updateShouldShow(),!0}onScrollChanged(e){return this._scrollTop=e.scrollTop,this._updateShouldShow()}prepareRender(e){}render(e){this._domNode.setWidth(this._width),this._domNode.setClassName(this._shouldShow?"scroll-decoration":"")}}class Oze{constructor(e){this.left=e.left,this.width=e.width,this.startStyle=null,this.endStyle=null}}class Fze{constructor(e,t){this.lineNumber=e,this.ranges=t}}function Vze(s){return new Oze(s)}function Bze(s){return new Fze(s.lineNumber,s.ranges.map(Vze))}const Bn=class Bn extends Jw{constructor(e){super(),this._previousFrameVisibleRangesWithStyle=[],this._context=e;const t=this._context.configuration.options;this._roundedSelection=t.get(102),this._typicalHalfwidthCharacterWidth=t.get(50).typicalHalfwidthCharacterWidth,this._selections=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return this._roundedSelection=t.get(102),this._typicalHalfwidthCharacterWidth=t.get(50).typicalHalfwidthCharacterWidth,!0}onCursorStateChanged(e){return this._selections=e.selections.slice(0),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_visibleRangesHaveGaps(e){for(let t=0,i=e.length;t<i;t++)if(e[t].ranges.length>1)return!0;return!1}_enrichVisibleRangesWithStyle(e,t,i){const n=this._typicalHalfwidthCharacterWidth/4;let r=null,o=null;if(i&&i.length>0&&t.length>0){const a=t[0].lineNumber;if(a===e.startLineNumber)for(let c=0;!r&&c<i.length;c++)i[c].lineNumber===a&&(r=i[c].ranges[0]);const l=t[t.length-1].lineNumber;if(l===e.endLineNumber)for(let c=i.length-1;!o&&c>=0;c--)i[c].lineNumber===l&&(o=i[c].ranges[0]);r&&!r.startStyle&&(r=null),o&&!o.startStyle&&(o=null)}for(let a=0,l=t.length;a<l;a++){const c=t[a].ranges[0],d=c.left,u=c.left+c.width,h={top:0,bottom:0},g={top:0,bottom:0};if(a>0){const p=t[a-1].ranges[0].left,_=t[a-1].ranges[0].left+t[a-1].ranges[0].width;NN(d-p)<n?h.top=2:d>p&&(h.top=1),NN(u-_)<n?g.top=2:p<u&&u<_&&(g.top=1)}else r&&(h.top=r.startStyle.top,g.top=r.endStyle.top);if(a+1<l){const p=t[a+1].ranges[0].left,_=t[a+1].ranges[0].left+t[a+1].ranges[0].width;NN(d-p)<n?h.bottom=2:p<d&&d<_&&(h.bottom=1),NN(u-_)<n?g.bottom=2:u<_&&(g.bottom=1)}else o&&(h.bottom=o.startStyle.bottom,g.bottom=o.endStyle.bottom);c.startStyle=h,c.endStyle=g}}_getVisibleRangesWithStyle(e,t,i){const r=(t.linesVisibleRangesForRange(e,!0)||[]).map(Bze);return!this._visibleRangesHaveGaps(r)&&this._roundedSelection&&this._enrichVisibleRangesWithStyle(t.visibleRange,r,i),r}_createSelectionPiece(e,t,i,n,r){return'<div class="cslr '+i+'" style="top:'+e.toString()+"px;bottom:"+t.toString()+"px;left:"+n.toString()+"px;width:"+r.toString()+'px;"></div>'}_actualRenderOneSelection(e,t,i,n){if(n.length===0)return;const r=!!n[0].ranges[0].startStyle,o=n[0].lineNumber,a=n[n.length-1].lineNumber;for(let l=0,c=n.length;l<c;l++){const d=n[l],u=d.lineNumber,h=u-t,g=i&&u===o?1:0,p=i&&u!==o&&u===a?1:0;let _="",v="";for(let C=0,y=d.ranges.length;C<y;C++){const x=d.ranges[C];if(r){const I=x.startStyle,A=x.endStyle;if(I.top===1||I.bottom===1){_+=this._createSelectionPiece(g,p,Bn.SELECTION_CLASS_NAME,x.left-Bn.ROUNDED_PIECE_WIDTH,Bn.ROUNDED_PIECE_WIDTH);let D=Bn.EDITOR_BACKGROUND_CLASS_NAME;I.top===1&&(D+=" "+Bn.SELECTION_TOP_RIGHT),I.bottom===1&&(D+=" "+Bn.SELECTION_BOTTOM_RIGHT),_+=this._createSelectionPiece(g,p,D,x.left-Bn.ROUNDED_PIECE_WIDTH,Bn.ROUNDED_PIECE_WIDTH)}if(A.top===1||A.bottom===1){_+=this._createSelectionPiece(g,p,Bn.SELECTION_CLASS_NAME,x.left+x.width,Bn.ROUNDED_PIECE_WIDTH);let D=Bn.EDITOR_BACKGROUND_CLASS_NAME;A.top===1&&(D+=" "+Bn.SELECTION_TOP_LEFT),A.bottom===1&&(D+=" "+Bn.SELECTION_BOTTOM_LEFT),_+=this._createSelectionPiece(g,p,D,x.left+x.width,Bn.ROUNDED_PIECE_WIDTH)}}let L=Bn.SELECTION_CLASS_NAME;if(r){const I=x.startStyle,A=x.endStyle;I.top===0&&(L+=" "+Bn.SELECTION_TOP_LEFT),I.bottom===0&&(L+=" "+Bn.SELECTION_BOTTOM_LEFT),A.top===0&&(L+=" "+Bn.SELECTION_TOP_RIGHT),A.bottom===0&&(L+=" "+Bn.SELECTION_BOTTOM_RIGHT)}v+=this._createSelectionPiece(g,p,L,x.left,x.width)}e[h][0]+=_,e[h][1]+=v}}prepareRender(e){const t=[],i=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber;for(let o=i;o<=n;o++){const a=o-i;t[a]=["",""]}const r=[];for(let o=0,a=this._selections.length;o<a;o++){const l=this._selections[o];if(l.isEmpty()){r[o]=null;continue}const c=this._getVisibleRangesWithStyle(l,e,this._previousFrameVisibleRangesWithStyle[o]);r[o]=c,this._actualRenderOneSelection(t,i,this._selections.length>1,c)}this._previousFrameVisibleRangesWithStyle=r,this._renderResult=t.map(([o,a])=>o+a)}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}};Bn.SELECTION_CLASS_NAME="selected-text",Bn.SELECTION_TOP_LEFT="top-left-radius",Bn.SELECTION_BOTTOM_LEFT="bottom-left-radius",Bn.SELECTION_TOP_RIGHT="top-right-radius",Bn.SELECTION_BOTTOM_RIGHT="bottom-right-radius",Bn.EDITOR_BACKGROUND_CLASS_NAME="monaco-editor-background",Bn.ROUNDED_PIECE_WIDTH=10;let FH=Bn;Lc((s,e)=>{const t=s.getColor(QOe);t&&!t.isTransparent()&&e.addRule(`.monaco-editor .view-line span.inline-selected-text { color: ${t}; }`)});function NN(s){return s<0?-s:s}class Ose{constructor(e,t,i,n,r,o,a){this.top=e,this.left=t,this.paddingLeft=i,this.width=n,this.height=r,this.textContent=o,this.textContentClassName=a}}var Xf;(function(s){s[s.Single=0]="Single",s[s.MultiPrimary=1]="MultiPrimary",s[s.MultiSecondary=2]="MultiSecondary"})(Xf||(Xf={}));class Fse{constructor(e,t){this._context=e;const i=this._context.configuration.options,n=i.get(50);this._cursorStyle=i.get(28),this._lineHeight=i.get(67),this._typicalHalfwidthCharacterWidth=n.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(i.get(31),this._typicalHalfwidthCharacterWidth),this._isVisible=!0,this._domNode=gi(document.createElement("div")),this._domNode.setClassName(`cursor ${Ny}`),this._domNode.setHeight(this._lineHeight),this._domNode.setTop(0),this._domNode.setLeft(0),Zs(this._domNode,n),this._domNode.setDisplay("none"),this._position=new X(1,1),this._pluralityClass="",this.setPlurality(t),this._lastRenderedContent="",this._renderData=null}getDomNode(){return this._domNode}getPosition(){return this._position}setPlurality(e){switch(e){default:case Xf.Single:this._pluralityClass="";break;case Xf.MultiPrimary:this._pluralityClass="cursor-primary";break;case Xf.MultiSecondary:this._pluralityClass="cursor-secondary";break}}show(){this._isVisible||(this._domNode.setVisibility("inherit"),this._isVisible=!0)}hide(){this._isVisible&&(this._domNode.setVisibility("hidden"),this._isVisible=!1)}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(50);return this._cursorStyle=t.get(28),this._lineHeight=t.get(67),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(t.get(31),this._typicalHalfwidthCharacterWidth),Zs(this._domNode,i),!0}onCursorPositionChanged(e,t){return t?this._domNode.domNode.style.transitionProperty="none":this._domNode.domNode.style.transitionProperty="",this._position=e,!0}_getGraphemeAwarePosition(){const{lineNumber:e,column:t}=this._position,i=this._context.viewModel.getLineContent(e),[n,r]=URe(i,t-1);return[new X(e,n+1),i.substring(n,r)]}_prepareRender(e){let t="",i="";const[n,r]=this._getGraphemeAwarePosition();if(this._cursorStyle===Gs.Line||this._cursorStyle===Gs.LineThin){const h=e.visibleRangeForPosition(n);if(!h||h.outsideRenderedLine)return null;const g=nt(this._domNode.domNode);let p;this._cursorStyle===Gs.Line?(p=hte(g,this._lineCursorWidth>0?this._lineCursorWidth:2),p>2&&(t=r,i=this._getTokenClassName(n))):p=hte(g,1);let _=h.left,v=0;p>=2&&_>=1&&(v=1,_-=v);const C=e.getVerticalOffsetForLineNumber(n.lineNumber)-e.bigNumbersDelta;return new Ose(C,_,v,p,this._lineHeight,t,i)}const o=e.linesVisibleRangesForRange(new F(n.lineNumber,n.column,n.lineNumber,n.column+r.length),!1);if(!o||o.length===0)return null;const a=o[0];if(a.outsideRenderedLine||a.ranges.length===0)return null;const l=a.ranges[0],c=r==="	"?this._typicalHalfwidthCharacterWidth:l.width<1?this._typicalHalfwidthCharacterWidth:l.width;this._cursorStyle===Gs.Block&&(t=r,i=this._getTokenClassName(n));let d=e.getVerticalOffsetForLineNumber(n.lineNumber)-e.bigNumbersDelta,u=this._lineHeight;return(this._cursorStyle===Gs.Underline||this._cursorStyle===Gs.UnderlineThin)&&(d+=this._lineHeight-2,u=2),new Ose(d,l.left,0,c,u,t,i)}_getTokenClassName(e){const t=this._context.viewModel.getViewLineData(e.lineNumber),i=t.tokens.findTokenIndexAtOffset(e.column-1);return t.tokens.getClassName(i)}prepareRender(e){this._renderData=this._prepareRender(e)}render(e){return this._renderData?(this._lastRenderedContent!==this._renderData.textContent&&(this._lastRenderedContent=this._renderData.textContent,this._domNode.domNode.textContent=this._lastRenderedContent),this._domNode.setClassName(`cursor ${this._pluralityClass} ${Ny} ${this._renderData.textContentClassName}`),this._domNode.setDisplay("block"),this._domNode.setTop(this._renderData.top),this._domNode.setLeft(this._renderData.left),this._domNode.setPaddingLeft(this._renderData.paddingLeft),this._domNode.setWidth(this._renderData.width),this._domNode.setLineHeight(this._renderData.height),this._domNode.setHeight(this._renderData.height),{domNode:this._domNode.domNode,position:this._position,contentLeft:this._renderData.left,height:this._renderData.height,width:2}):(this._domNode.setDisplay("none"),null)}}const kk=class kk extends za{constructor(e){super(e);const t=this._context.configuration.options;this._readOnly=t.get(92),this._cursorBlinking=t.get(26),this._cursorStyle=t.get(28),this._cursorSmoothCaretAnimation=t.get(27),this._selectionIsEmpty=!0,this._isComposingInput=!1,this._isVisible=!1,this._primaryCursor=new Fse(this._context,Xf.Single),this._secondaryCursors=[],this._renderData=[],this._domNode=gi(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._updateDomClassName(),this._domNode.appendChild(this._primaryCursor.getDomNode()),this._startCursorBlinkAnimation=new gd,this._cursorFlatBlinkInterval=new Bq,this._blinkingEnabled=!1,this._editorHasFocus=!1,this._updateBlinking()}dispose(){super.dispose(),this._startCursorBlinkAnimation.dispose(),this._cursorFlatBlinkInterval.dispose()}getDomNode(){return this._domNode}onCompositionStart(e){return this._isComposingInput=!0,this._updateBlinking(),!0}onCompositionEnd(e){return this._isComposingInput=!1,this._updateBlinking(),!0}onConfigurationChanged(e){const t=this._context.configuration.options;this._readOnly=t.get(92),this._cursorBlinking=t.get(26),this._cursorStyle=t.get(28),this._cursorSmoothCaretAnimation=t.get(27),this._updateBlinking(),this._updateDomClassName(),this._primaryCursor.onConfigurationChanged(e);for(let i=0,n=this._secondaryCursors.length;i<n;i++)this._secondaryCursors[i].onConfigurationChanged(e);return!0}_onCursorPositionChanged(e,t,i){const n=this._secondaryCursors.length!==t.length||this._cursorSmoothCaretAnimation==="explicit"&&i!==3;if(this._primaryCursor.setPlurality(t.length?Xf.MultiPrimary:Xf.Single),this._primaryCursor.onCursorPositionChanged(e,n),this._updateBlinking(),this._secondaryCursors.length<t.length){const r=t.length-this._secondaryCursors.length;for(let o=0;o<r;o++){const a=new Fse(this._context,Xf.MultiSecondary);this._domNode.domNode.insertBefore(a.getDomNode().domNode,this._primaryCursor.getDomNode().domNode.nextSibling),this._secondaryCursors.push(a)}}else if(this._secondaryCursors.length>t.length){const r=this._secondaryCursors.length-t.length;for(let o=0;o<r;o++)this._domNode.removeChild(this._secondaryCursors[0].getDomNode()),this._secondaryCursors.splice(0,1)}for(let r=0;r<t.length;r++)this._secondaryCursors[r].onCursorPositionChanged(t[r],n)}onCursorStateChanged(e){const t=[];for(let n=0,r=e.selections.length;n<r;n++)t[n]=e.selections[n].getPosition();this._onCursorPositionChanged(t[0],t.slice(1),e.reason);const i=e.selections[0].isEmpty();return this._selectionIsEmpty!==i&&(this._selectionIsEmpty=i,this._updateDomClassName()),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onFocusChanged(e){return this._editorHasFocus=e.isFocused,this._updateBlinking(),!1}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return!0}onTokensChanged(e){const t=i=>{for(let n=0,r=e.ranges.length;n<r;n++)if(e.ranges[n].fromLineNumber<=i.lineNumber&&i.lineNumber<=e.ranges[n].toLineNumber)return!0;return!1};if(t(this._primaryCursor.getPosition()))return!0;for(const i of this._secondaryCursors)if(t(i.getPosition()))return!0;return!1}onZonesChanged(e){return!0}_getCursorBlinking(){return this._isComposingInput||!this._editorHasFocus?0:this._readOnly?5:this._cursorBlinking}_updateBlinking(){this._startCursorBlinkAnimation.cancel(),this._cursorFlatBlinkInterval.cancel();const e=this._getCursorBlinking(),t=e===0,i=e===5;t?this._hide():this._show(),this._blinkingEnabled=!1,this._updateDomClassName(),!t&&!i&&(e===1?this._cursorFlatBlinkInterval.cancelAndSet(()=>{this._isVisible?this._hide():this._show()},kk.BLINK_INTERVAL,nt(this._domNode.domNode)):this._startCursorBlinkAnimation.setIfNotSet(()=>{this._blinkingEnabled=!0,this._updateDomClassName()},kk.BLINK_INTERVAL))}_updateDomClassName(){this._domNode.setClassName(this._getClassName())}_getClassName(){let e="cursors-layer";switch(this._selectionIsEmpty||(e+=" has-selection"),this._cursorStyle){case Gs.Line:e+=" cursor-line-style";break;case Gs.Block:e+=" cursor-block-style";break;case Gs.Underline:e+=" cursor-underline-style";break;case Gs.LineThin:e+=" cursor-line-thin-style";break;case Gs.BlockOutline:e+=" cursor-block-outline-style";break;case Gs.UnderlineThin:e+=" cursor-underline-thin-style";break;default:e+=" cursor-line-style"}if(this._blinkingEnabled)switch(this._getCursorBlinking()){case 1:e+=" cursor-blink";break;case 2:e+=" cursor-smooth";break;case 3:e+=" cursor-phase";break;case 4:e+=" cursor-expand";break;case 5:e+=" cursor-solid";break;default:e+=" cursor-solid"}else e+=" cursor-solid";return(this._cursorSmoothCaretAnimation==="on"||this._cursorSmoothCaretAnimation==="explicit")&&(e+=" cursor-smooth-caret-animation"),e}_show(){this._primaryCursor.show();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].show();this._isVisible=!0}_hide(){this._primaryCursor.hide();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].hide();this._isVisible=!1}prepareRender(e){this._primaryCursor.prepareRender(e);for(let t=0,i=this._secondaryCursors.length;t<i;t++)this._secondaryCursors[t].prepareRender(e)}render(e){const t=[];let i=0;const n=this._primaryCursor.render(e);n&&(t[i++]=n);for(let r=0,o=this._secondaryCursors.length;r<o;r++){const a=this._secondaryCursors[r].render(e);a&&(t[i++]=a)}this._renderData=t}getLastRenderData(){return this._renderData}};kk.BLINK_INTERVAL=500;let VH=kk;Lc((s,e)=>{const t=[{class:".cursor",foreground:UF,background:FK},{class:".cursor-primary",foreground:gge,background:uVe},{class:".cursor-secondary",foreground:pge,background:hVe}];for(const i of t){const n=s.getColor(i.foreground);if(n){let r=s.getColor(i.background);r||(r=n.opposite()),e.addRule(`.monaco-editor .cursors-layer ${i.class} { background-color: ${n}; border-color: ${n}; color: ${r}; }`),su(s.type)&&e.addRule(`.monaco-editor .cursors-layer.has-selection ${i.class} { border-left: 1px solid ${r}; border-right: 1px solid ${r}; }`)}}});const cB=()=>{throw new Error("Invalid change accessor")};class Wze extends za{constructor(e){super(e);const t=this._context.configuration.options,i=t.get(146);this._lineHeight=t.get(67),this._contentWidth=i.contentWidth,this._contentLeft=i.contentLeft,this.domNode=gi(document.createElement("div")),this.domNode.setClassName("view-zones"),this.domNode.setPosition("absolute"),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.marginDomNode=gi(document.createElement("div")),this.marginDomNode.setClassName("margin-view-zones"),this.marginDomNode.setPosition("absolute"),this.marginDomNode.setAttribute("role","presentation"),this.marginDomNode.setAttribute("aria-hidden","true"),this._zones={}}dispose(){super.dispose(),this._zones={}}_recomputeWhitespacesProps(){const e=this._context.viewLayout.getWhitespaces(),t=new Map;for(const n of e)t.set(n.id,n);let i=!1;return this._context.viewModel.changeWhitespace(n=>{const r=Object.keys(this._zones);for(let o=0,a=r.length;o<a;o++){const l=r[o],c=this._zones[l],d=this._computeWhitespaceProps(c.delegate);c.isInHiddenArea=d.isInHiddenArea;const u=t.get(l);u&&(u.afterLineNumber!==d.afterViewLineNumber||u.height!==d.heightInPx)&&(n.changeOneWhitespace(l,d.afterViewLineNumber,d.heightInPx),this._safeCallOnComputedHeight(c.delegate,d.heightInPx),i=!0)}}),i}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(146);return this._lineHeight=t.get(67),this._contentWidth=i.contentWidth,this._contentLeft=i.contentLeft,e.hasChanged(67)&&this._recomputeWhitespacesProps(),!0}onLineMappingChanged(e){return this._recomputeWhitespacesProps()}onLinesDeleted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}onLinesInserted(e){return!0}_getZoneOrdinal(e){return e.ordinal??e.afterColumn??1e4}_computeWhitespaceProps(e){if(e.afterLineNumber===0)return{isInHiddenArea:!1,afterViewLineNumber:0,heightInPx:this._heightInPixels(e),minWidthInPx:this._minWidthInPixels(e)};let t;if(typeof e.afterColumn<"u")t=this._context.viewModel.model.validatePosition({lineNumber:e.afterLineNumber,column:e.afterColumn});else{const o=this._context.viewModel.model.validatePosition({lineNumber:e.afterLineNumber,column:1}).lineNumber;t=new X(o,this._context.viewModel.model.getLineMaxColumn(o))}let i;t.column===this._context.viewModel.model.getLineMaxColumn(t.lineNumber)?i=this._context.viewModel.model.validatePosition({lineNumber:t.lineNumber+1,column:1}):i=this._context.viewModel.model.validatePosition({lineNumber:t.lineNumber,column:t.column+1});const n=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(t,e.afterColumnAffinity,!0),r=e.showInHiddenAreas||this._context.viewModel.coordinatesConverter.modelPositionIsVisible(i);return{isInHiddenArea:!r,afterViewLineNumber:n.lineNumber,heightInPx:r?this._heightInPixels(e):0,minWidthInPx:this._minWidthInPixels(e)}}changeViewZones(e){let t=!1;return this._context.viewModel.changeWhitespace(i=>{const n={addZone:r=>(t=!0,this._addZone(i,r)),removeZone:r=>{r&&(t=this._removeZone(i,r)||t)},layoutZone:r=>{r&&(t=this._layoutZone(i,r)||t)}};Hze(e,n),n.addZone=cB,n.removeZone=cB,n.layoutZone=cB}),t}_addZone(e,t){const i=this._computeWhitespaceProps(t),r={whitespaceId:e.insertWhitespace(i.afterViewLineNumber,this._getZoneOrdinal(t),i.heightInPx,i.minWidthInPx),delegate:t,isInHiddenArea:i.isInHiddenArea,isVisible:!1,domNode:gi(t.domNode),marginDomNode:t.marginDomNode?gi(t.marginDomNode):null};return this._safeCallOnComputedHeight(r.delegate,i.heightInPx),r.domNode.setPosition("absolute"),r.domNode.domNode.style.width="100%",r.domNode.setDisplay("none"),r.domNode.setAttribute("monaco-view-zone",r.whitespaceId),this.domNode.appendChild(r.domNode),r.marginDomNode&&(r.marginDomNode.setPosition("absolute"),r.marginDomNode.domNode.style.width="100%",r.marginDomNode.setDisplay("none"),r.marginDomNode.setAttribute("monaco-view-zone",r.whitespaceId),this.marginDomNode.appendChild(r.marginDomNode)),this._zones[r.whitespaceId]=r,this.setShouldRender(),r.whitespaceId}_removeZone(e,t){if(this._zones.hasOwnProperty(t)){const i=this._zones[t];return delete this._zones[t],e.removeWhitespace(i.whitespaceId),i.domNode.removeAttribute("monaco-visible-view-zone"),i.domNode.removeAttribute("monaco-view-zone"),i.domNode.domNode.remove(),i.marginDomNode&&(i.marginDomNode.removeAttribute("monaco-visible-view-zone"),i.marginDomNode.removeAttribute("monaco-view-zone"),i.marginDomNode.domNode.remove()),this.setShouldRender(),!0}return!1}_layoutZone(e,t){if(this._zones.hasOwnProperty(t)){const i=this._zones[t],n=this._computeWhitespaceProps(i.delegate);return i.isInHiddenArea=n.isInHiddenArea,e.changeOneWhitespace(i.whitespaceId,n.afterViewLineNumber,n.heightInPx),this._safeCallOnComputedHeight(i.delegate,n.heightInPx),this.setShouldRender(),!0}return!1}shouldSuppressMouseDownOnViewZone(e){return this._zones.hasOwnProperty(e)?!!this._zones[e].delegate.suppressMouseDown:!1}_heightInPixels(e){return typeof e.heightInPx=="number"?e.heightInPx:typeof e.heightInLines=="number"?this._lineHeight*e.heightInLines:this._lineHeight}_minWidthInPixels(e){return typeof e.minWidthInPx=="number"?e.minWidthInPx:0}_safeCallOnComputedHeight(e,t){if(typeof e.onComputedHeight=="function")try{e.onComputedHeight(t)}catch(i){ft(i)}}_safeCallOnDomNodeTop(e,t){if(typeof e.onDomNodeTop=="function")try{e.onDomNodeTop(t)}catch(i){ft(i)}}prepareRender(e){}render(e){const t=e.viewportData.whitespaceViewportData,i={};let n=!1;for(const o of t)this._zones[o.id].isInHiddenArea||(i[o.id]=o,n=!0);const r=Object.keys(this._zones);for(let o=0,a=r.length;o<a;o++){const l=r[o],c=this._zones[l];let d=0,u=0,h="none";i.hasOwnProperty(l)?(d=i[l].verticalOffset-e.bigNumbersDelta,u=i[l].height,h="block",c.isVisible||(c.domNode.setAttribute("monaco-visible-view-zone","true"),c.isVisible=!0),this._safeCallOnDomNodeTop(c.delegate,e.getScrolledTopFromAbsoluteTop(i[l].verticalOffset))):(c.isVisible&&(c.domNode.removeAttribute("monaco-visible-view-zone"),c.isVisible=!1),this._safeCallOnDomNodeTop(c.delegate,e.getScrolledTopFromAbsoluteTop(-1e6))),c.domNode.setTop(d),c.domNode.setHeight(u),c.domNode.setDisplay(h),c.marginDomNode&&(c.marginDomNode.setTop(d),c.marginDomNode.setHeight(u),c.marginDomNode.setDisplay(h))}n&&(this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth)),this.marginDomNode.setWidth(this._contentLeft))}}function Hze(s,e){try{return s(e)}catch(t){ft(t)}}class zze extends Jw{constructor(e){super(),this._context=e,this._options=new Vse(this._context.configuration),this._selection=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=new Vse(this._context.configuration);return this._options.equals(t)?e.hasChanged(146):(this._options=t,!0)}onCursorStateChanged(e){return this._selection=e.selections,this._options.renderWhitespace==="selection"}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}prepareRender(e){if(this._options.renderWhitespace==="none"){this._renderResult=null;return}const t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber-t+1,r=new Array(n);for(let a=0;a<n;a++)r[a]=!0;const o=this._context.viewModel.getMinimapLinesRenderingData(e.viewportData.startLineNumber,e.viewportData.endLineNumber,r);this._renderResult=[];for(let a=e.viewportData.startLineNumber;a<=e.viewportData.endLineNumber;a++){const l=a-e.viewportData.startLineNumber,c=o.data[l];let d=null;if(this._options.renderWhitespace==="selection"){const u=this._selection;for(const h of u){if(h.endLineNumber<a||h.startLineNumber>a)continue;const g=h.startLineNumber===a?h.startColumn:c.minColumn,p=h.endLineNumber===a?h.endColumn:c.maxColumn;g<p&&(d||(d=[]),d.push(new Ope(g-1,p-1)))}}this._renderResult[l]=this._applyRenderWhitespace(e,a,d,c)}}_applyRenderWhitespace(e,t,i,n){if(this._options.renderWhitespace==="selection"&&!i||this._options.renderWhitespace==="trailing"&&n.continuesWithWrappedLine)return"";const r=this._context.theme.getColor(VK),o=this._options.renderWithSVG,a=n.content,l=this._options.stopRenderingLineAfter===-1?a.length:Math.min(this._options.stopRenderingLineAfter,a.length),c=n.continuesWithWrappedLine,d=n.minColumn-1,u=this._options.renderWhitespace==="boundary",h=this._options.renderWhitespace==="trailing",g=this._options.lineHeight,p=this._options.middotWidth,_=this._options.wsmiddotWidth,v=this._options.spaceWidth,C=Math.abs(_-v),y=Math.abs(p-v),x=C<y?11825:183,L=this._options.canUseHalfwidthRightwardsArrow;let I="",A=!1,D=Zr(a),N;D===-1?(A=!0,D=l,N=l):N=nu(a);let R=0,W=i&&i[R],H=0;for(let U=d;U<l;U++){const B=a.charCodeAt(U);if(W&&U>=W.endOffset&&(R++,W=i&&i[R]),B!==9&&B!==32||h&&!A&&U<=N)continue;if(u&&U>=D&&U<=N&&B===32){const re=U-1>=0?a.charCodeAt(U-1):0,pe=U+1<l?a.charCodeAt(U+1):0;if(re!==32&&pe!==32)continue}if(u&&c&&U===l-1){const re=U-1>=0?a.charCodeAt(U-1):0;if(B===32&&re!==32&&re!==9)continue}if(i&&(!W||W.startOffset>U||W.endOffset<=U))continue;const ee=e.visibleRangeForPosition(new X(t,U+1));ee&&(o?(H=Math.max(H,ee.left),B===9?I+=this._renderArrow(g,v,ee.left):I+=`<circle cx="${(ee.left+v/2).toFixed(2)}" cy="${(g/2).toFixed(2)}" r="${(v/7).toFixed(2)}" />`):B===9?I+=`<div class="mwh" style="left:${ee.left}px;height:${g}px;">${L?"￫":"→"}</div>`:I+=`<div class="mwh" style="left:${ee.left}px;height:${g}px;">${String.fromCharCode(x)}</div>`)}return o?(H=Math.round(H+v),`<svg style="bottom:0;position:absolute;width:${H}px;height:${g}px" viewBox="0 0 ${H} ${g}" xmlns="http://www.w3.org/2000/svg" fill="${r}">`+I+"</svg>"):I}_renderArrow(e,t,i){const n=t/7,r=t,o=e/2,a=i,l={x:0,y:n/2},c={x:100/125*r,y:l.y},d={x:c.x-.2*c.x,y:c.y+.2*c.x},u={x:d.x+.1*c.x,y:d.y+.1*c.x},h={x:u.x+.35*c.x,y:u.y-.35*c.x},g={x:h.x,y:-h.y},p={x:u.x,y:-u.y},_={x:d.x,y:-d.y},v={x:c.x,y:-c.y},C={x:l.x,y:-l.y};return`<path d="M ${[l,c,d,u,h,g,p,_,v,C].map(L=>`${(a+L.x).toFixed(2)} ${(o+L.y).toFixed(2)}`).join(" L ")}" />`}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}class Vse{constructor(e){const t=e.options,i=t.get(50),n=t.get(38);n==="off"?(this.renderWhitespace="none",this.renderWithSVG=!1):n==="svg"?(this.renderWhitespace=t.get(100),this.renderWithSVG=!0):(this.renderWhitespace=t.get(100),this.renderWithSVG=!1),this.spaceWidth=i.spaceWidth,this.middotWidth=i.middotWidth,this.wsmiddotWidth=i.wsmiddotWidth,this.canUseHalfwidthRightwardsArrow=i.canUseHalfwidthRightwardsArrow,this.lineHeight=t.get(67),this.stopRenderingLineAfter=t.get(118)}equals(e){return this.renderWhitespace===e.renderWhitespace&&this.renderWithSVG===e.renderWithSVG&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineHeight===e.lineHeight&&this.stopRenderingLineAfter===e.stopRenderingLineAfter}}class Uze{constructor(e,t,i,n){this.selections=e,this.startLineNumber=t.startLineNumber|0,this.endLineNumber=t.endLineNumber|0,this.relativeVerticalOffset=t.relativeVerticalOffset,this.bigNumbersDelta=t.bigNumbersDelta|0,this.lineHeight=t.lineHeight|0,this.whitespaceViewportData=i,this._model=n,this.visibleRange=new F(t.startLineNumber,this._model.getLineMinColumn(t.startLineNumber),t.endLineNumber,this._model.getLineMaxColumn(t.endLineNumber))}getViewLineRenderingData(e){return this._model.getViewportViewLineRenderingData(this.visibleRange,e)}getDecorationsInViewport(){return this._model.getDecorationsInViewport(this.visibleRange)}}class jze{get type(){return this._theme.type}get value(){return this._theme}constructor(e){this._theme=e}update(e){this._theme=e}getColor(e){return this._theme.getColor(e)}}class $ze{constructor(e,t,i){this.configuration=e,this.theme=new jze(t),this.viewModel=i,this.viewLayout=i.viewLayout}addEventHandler(e){this.viewModel.addViewEventHandler(e)}removeEventHandler(e){this.viewModel.removeViewEventHandler(e)}}var qze=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Kze=function(s,e){return function(t,i){e(t,i,s)}};let BH=class extends uD{constructor(e,t,i,n,r,o,a){super(),this._instantiationService=a,this._shouldRecomputeGlyphMarginLanes=!1,this._selections=[new Ue(1,1,1,1)],this._renderAnimationFrame=null;const l=new tze(t,n,r,e);this._context=new $ze(t,i,n),this._context.addEventHandler(this),this._viewParts=[],this._textAreaHandler=this._instantiationService.createInstance(NH,this._context,l,this._createTextAreaHandlerHelper()),this._viewParts.push(this._textAreaHandler),this._linesContent=gi(document.createElement("div")),this._linesContent.setClassName("lines-content monaco-editor-background"),this._linesContent.setPosition("absolute"),this.domNode=gi(document.createElement("div")),this.domNode.setClassName(this._getEditorClassName()),this.domNode.setAttribute("role","code"),this._overflowGuardContainer=gi(document.createElement("div")),mu.write(this._overflowGuardContainer,3),this._overflowGuardContainer.setClassName("overflow-guard"),this._scrollbar=new uze(this._context,this._linesContent,this.domNode,this._overflowGuardContainer),this._viewParts.push(this._scrollbar),this._viewLines=new OH(this._context,this._linesContent),this._viewZones=new Wze(this._context),this._viewParts.push(this._viewZones);const c=new Nze(this._context);this._viewParts.push(c);const d=new Mze(this._context);this._viewParts.push(d);const u=new nze(this._context);this._viewParts.push(u),u.addDynamicOverlay(new lze(this._context)),u.addDynamicOverlay(new FH(this._context)),u.addDynamicOverlay(new bze(this._context)),u.addDynamicOverlay(new dze(this._context)),u.addDynamicOverlay(new zze(this._context));const h=new sze(this._context);this._viewParts.push(h),h.addDynamicOverlay(new cze(this._context)),h.addDynamicOverlay(new Sze(this._context)),h.addDynamicOverlay(new yze(this._context)),h.addDynamicOverlay(new oP(this._context)),this._glyphMarginWidgets=new gze(this._context),this._viewParts.push(this._glyphMarginWidgets);const g=new aP(this._context);g.getDomNode().appendChild(this._viewZones.marginDomNode),g.getDomNode().appendChild(h.getDomNode()),g.getDomNode().appendChild(this._glyphMarginWidgets.domNode),this._viewParts.push(g),this._contentWidgets=new oze(this._context,this.domNode),this._viewParts.push(this._contentWidgets),this._viewCursors=new VH(this._context),this._viewParts.push(this._viewCursors),this._overlayWidgets=new Dze(this._context,this.domNode),this._viewParts.push(this._overlayWidgets);const p=new Pze(this._context);this._viewParts.push(p);const _=new rze(this._context);this._viewParts.push(_);const v=new Eze(this._context);if(this._viewParts.push(v),c){const C=this._scrollbar.getOverviewRulerLayoutInfo();C.parent.insertBefore(c.getDomNode(),C.insertBefore)}this._linesContent.appendChild(u.getDomNode()),this._linesContent.appendChild(p.domNode),this._linesContent.appendChild(this._viewZones.domNode),this._linesContent.appendChild(this._viewLines.getDomNode()),this._linesContent.appendChild(this._contentWidgets.domNode),this._linesContent.appendChild(this._viewCursors.getDomNode()),this._overflowGuardContainer.appendChild(g.getDomNode()),this._overflowGuardContainer.appendChild(this._scrollbar.getDomNode()),this._overflowGuardContainer.appendChild(d.getDomNode()),this._overflowGuardContainer.appendChild(this._textAreaHandler.textArea),this._overflowGuardContainer.appendChild(this._textAreaHandler.textAreaCover),this._overflowGuardContainer.appendChild(this._overlayWidgets.getDomNode()),this._overflowGuardContainer.appendChild(v.getDomNode()),this._overflowGuardContainer.appendChild(_.domNode),this.domNode.appendChild(this._overflowGuardContainer),o?(o.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode.domNode),o.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode.domNode)):(this.domNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode),this.domNode.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode)),this._applyLayout(),this._pointerHandler=this._register(new SHe(this._context,l,this._createPointerHandlerHelper()))}_computeGlyphMarginLanes(){const e=this._context.viewModel.model,t=this._context.viewModel.glyphLanes;let i=[],n=0;i=i.concat(e.getAllMarginDecorations().map(r=>{var a,l;const o=((a=r.options.glyphMargin)==null?void 0:a.position)??ld.Center;return n=Math.max(n,r.range.endLineNumber),{range:r.range,lane:o,persist:(l=r.options.glyphMargin)==null?void 0:l.persistLane}})),i=i.concat(this._glyphMarginWidgets.getWidgets().map(r=>{const o=e.validateRange(r.preference.range);return n=Math.max(n,o.endLineNumber),{range:o,lane:r.preference.lane}})),i.sort((r,o)=>F.compareRangesUsingStarts(r.range,o.range)),t.reset(n);for(const r of i)t.push(r.lane,r.range,r.persist);return t}_createPointerHandlerHelper(){return{viewDomNode:this.domNode.domNode,linesContentDomNode:this._linesContent.domNode,viewLinesDomNode:this._viewLines.getDomNode().domNode,focusTextArea:()=>{this.focus()},dispatchTextAreaEvent:e=>{this._textAreaHandler.textArea.domNode.dispatchEvent(e)},getLastRenderData:()=>{const e=this._viewCursors.getLastRenderData()||[],t=this._textAreaHandler.getLastRenderData();return new uHe(e,t)},renderNow:()=>{this.render(!0,!1)},shouldSuppressMouseDownOnViewZone:e=>this._viewZones.shouldSuppressMouseDownOnViewZone(e),shouldSuppressMouseDownOnWidget:e=>this._contentWidgets.shouldSuppressMouseDownOnWidget(e),getPositionFromDOMInfo:(e,t)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getPositionFromDOMInfo(e,t)),visibleRangeForPosition:(e,t)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(new X(e,t))),getLineWidth:e=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getLineWidth(e))}}_createTextAreaHandlerHelper(){return{visibleRangeForPosition:e=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(e))}}_applyLayout(){const t=this._context.configuration.options.get(146);this.domNode.setWidth(t.width),this.domNode.setHeight(t.height),this._overflowGuardContainer.setWidth(t.width),this._overflowGuardContainer.setHeight(t.height),this._linesContent.setWidth(16777216),this._linesContent.setHeight(16777216)}_getEditorClassName(){const e=this._textAreaHandler.isFocused()?" focused":"";return this._context.configuration.options.get(143)+" "+_6(this._context.theme.type)+e}handleEvents(e){super.handleEvents(e),this._scheduleRender()}onConfigurationChanged(e){return this.domNode.setClassName(this._getEditorClassName()),this._applyLayout(),!1}onCursorStateChanged(e){return this._selections=e.selections,!1}onDecorationsChanged(e){return e.affectsGlyphMargin&&(this._shouldRecomputeGlyphMarginLanes=!0),!1}onFocusChanged(e){return this.domNode.setClassName(this._getEditorClassName()),!1}onThemeChanged(e){return this._context.theme.update(e.theme),this.domNode.setClassName(this._getEditorClassName()),!1}dispose(){this._renderAnimationFrame!==null&&(this._renderAnimationFrame.dispose(),this._renderAnimationFrame=null),this._contentWidgets.overflowingContentWidgetsDomNode.domNode.remove(),this._context.removeEventHandler(this),this._viewLines.dispose();for(const e of this._viewParts)e.dispose();super.dispose()}_scheduleRender(){var e;if(this._store.isDisposed)throw new di;if(this._renderAnimationFrame===null){const t=this._createCoordinatedRendering();this._renderAnimationFrame=WH.INSTANCE.scheduleCoordinatedRendering({window:nt((e=this.domNode)==null?void 0:e.domNode),prepareRenderText:()=>{if(this._store.isDisposed)throw new di;try{return t.prepareRenderText()}finally{this._renderAnimationFrame=null}},renderText:()=>{if(this._store.isDisposed)throw new di;return t.renderText()},prepareRender:(i,n)=>{if(this._store.isDisposed)throw new di;return t.prepareRender(i,n)},render:(i,n)=>{if(this._store.isDisposed)throw new di;return t.render(i,n)}})}}_flushAccumulatedAndRenderNow(){const e=this._createCoordinatedRendering();Yp(()=>e.prepareRenderText());const t=Yp(()=>e.renderText());if(t){const[i,n]=t;Yp(()=>e.prepareRender(i,n)),Yp(()=>e.render(i,n))}}_getViewPartsToRender(){const e=[];let t=0;for(const i of this._viewParts)i.shouldRender()&&(e[t++]=i);return e}_createCoordinatedRendering(){return{prepareRenderText:()=>{if(this._shouldRecomputeGlyphMarginLanes){this._shouldRecomputeGlyphMarginLanes=!1;const e=this._computeGlyphMarginLanes();this._context.configuration.setGlyphMarginDecorationLaneCount(e.requiredLanes)}Qp.onRenderStart()},renderText:()=>{if(!this.domNode.domNode.isConnected)return null;let e=this._getViewPartsToRender();if(!this._viewLines.shouldRender()&&e.length===0)return null;const t=this._context.viewLayout.getLinesViewportData();this._context.viewModel.setViewport(t.startLineNumber,t.endLineNumber,t.centeredLineNumber);const i=new Uze(this._selections,t,this._context.viewLayout.getWhitespaceViewportData(),this._context.viewModel);return this._contentWidgets.shouldRender()&&this._contentWidgets.onBeforeRender(i),this._viewLines.shouldRender()&&(this._viewLines.renderText(i),this._viewLines.onDidRender(),e=this._getViewPartsToRender()),[e,new sHe(this._context.viewLayout,i,this._viewLines)]},prepareRender:(e,t)=>{for(const i of e)i.prepareRender(t)},render:(e,t)=>{for(const i of e)i.render(t),i.onDidRender()}}}delegateVerticalScrollbarPointerDown(e){this._scrollbar.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){this._scrollbar.delegateScrollFromMouseWheelEvent(e)}restoreState(e){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:e.scrollTop,scrollLeft:e.scrollLeft},1),this._context.viewModel.visibleLinesStabilized()}getOffsetForColumn(e,t){const i=this._context.viewModel.model.validatePosition({lineNumber:e,column:t}),n=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(i);this._flushAccumulatedAndRenderNow();const r=this._viewLines.visibleRangeForPosition(new X(n.lineNumber,n.column));return r?r.left:-1}getTargetAtClientPoint(e,t){const i=this._pointerHandler.getTargetAtClientPoint(e,t);return i?r5.convertViewToModelMouseTarget(i,this._context.viewModel.coordinatesConverter):null}createOverviewRuler(e){return new Aze(this._context,e)}change(e){this._viewZones.changeViewZones(e),this._scheduleRender()}render(e,t){if(t){this._viewLines.forceShouldRender();for(const i of this._viewParts)i.forceShouldRender()}e?this._flushAccumulatedAndRenderNow():this._scheduleRender()}writeScreenReaderContent(e){this._textAreaHandler.writeScreenReaderContent(e)}focus(){this._textAreaHandler.focusTextArea()}isFocused(){return this._textAreaHandler.isFocused()}setAriaOptions(e){this._textAreaHandler.setAriaOptions(e)}addContentWidget(e){this._contentWidgets.addWidget(e.widget),this.layoutContentWidget(e),this._scheduleRender()}layoutContentWidget(e){var t,i,n,r;this._contentWidgets.setWidgetPosition(e.widget,((t=e.position)==null?void 0:t.position)??null,((i=e.position)==null?void 0:i.secondaryPosition)??null,((n=e.position)==null?void 0:n.preference)??null,((r=e.position)==null?void 0:r.positionAffinity)??null),this._scheduleRender()}removeContentWidget(e){this._contentWidgets.removeWidget(e.widget),this._scheduleRender()}addOverlayWidget(e){this._overlayWidgets.addWidget(e.widget),this.layoutOverlayWidget(e),this._scheduleRender()}layoutOverlayWidget(e){this._overlayWidgets.setWidgetPosition(e.widget,e.position)&&this._scheduleRender()}removeOverlayWidget(e){this._overlayWidgets.removeWidget(e.widget),this._scheduleRender()}addGlyphMarginWidget(e){this._glyphMarginWidgets.addWidget(e.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}layoutGlyphMarginWidget(e){const t=e.position;this._glyphMarginWidgets.setWidgetPosition(e.widget,t)&&(this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender())}removeGlyphMarginWidget(e){this._glyphMarginWidgets.removeWidget(e.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}};BH=qze([Kze(6,Xe)],BH);function Yp(s){try{return s()}catch(e){return ft(e),null}}const pO=class pO{constructor(){this._coordinatedRenderings=[],this._animationFrameRunners=new Map}scheduleCoordinatedRendering(e){return this._coordinatedRenderings.push(e),this._scheduleRender(e.window),{dispose:()=>{const t=this._coordinatedRenderings.indexOf(e);if(t!==-1&&(this._coordinatedRenderings.splice(t,1),this._coordinatedRenderings.length===0)){for(const[i,n]of this._animationFrameRunners)n.dispose();this._animationFrameRunners.clear()}}}}_scheduleRender(e){if(!this._animationFrameRunners.has(e)){const t=()=>{this._animationFrameRunners.delete(e),this._onRenderScheduled()};this._animationFrameRunners.set(e,j2(e,t,100))}}_onRenderScheduled(){const e=this._coordinatedRenderings.slice(0);this._coordinatedRenderings=[];for(const i of e)Yp(()=>i.prepareRenderText());const t=[];for(let i=0,n=e.length;i<n;i++){const r=e[i];t[i]=Yp(()=>r.renderText())}for(let i=0,n=e.length;i<n;i++){const r=e[i],o=t[i];if(!o)continue;const[a,l]=o;Yp(()=>r.prepareRender(a,l))}for(let i=0,n=e.length;i<n;i++){const r=e[i],o=t[i];if(!o)continue;const[a,l]=o;Yp(()=>r.render(a,l))}}};pO.INSTANCE=new pO;let WH=pO;class ZL{constructor(e,t,i,n,r){this.injectionOffsets=e,this.injectionOptions=t,this.breakOffsets=i,this.breakOffsetsVisibleColumn=n,this.wrappedTextIndentLength=r}getOutputLineCount(){return this.breakOffsets.length}getMinOutputOffset(e){return e>0?this.wrappedTextIndentLength:0}getLineLength(e){const t=e>0?this.breakOffsets[e-1]:0;let n=this.breakOffsets[e]-t;return e>0&&(n+=this.wrappedTextIndentLength),n}getMaxOutputOffset(e){return this.getLineLength(e)}translateToInputOffset(e,t){e>0&&(t=Math.max(0,t-this.wrappedTextIndentLength));let n=e===0?t:this.breakOffsets[e-1]+t;if(this.injectionOffsets!==null)for(let r=0;r<this.injectionOffsets.length&&n>this.injectionOffsets[r];r++)n<this.injectionOffsets[r]+this.injectionOptions[r].content.length?n=this.injectionOffsets[r]:n-=this.injectionOptions[r].content.length;return n}translateToOutputPosition(e,t=2){let i=e;if(this.injectionOffsets!==null)for(let n=0;n<this.injectionOffsets.length&&!(e<this.injectionOffsets[n]||t!==1&&e===this.injectionOffsets[n]);n++)i+=this.injectionOptions[n].content.length;return this.offsetInInputWithInjectionsToOutputPosition(i,t)}offsetInInputWithInjectionsToOutputPosition(e,t=2){let i=0,n=this.breakOffsets.length-1,r=0,o=0;for(;i<=n;){r=i+(n-i)/2|0;const l=this.breakOffsets[r];if(o=r>0?this.breakOffsets[r-1]:0,t===0)if(e<=o)n=r-1;else if(e>l)i=r+1;else break;else if(e<o)n=r-1;else if(e>=l)i=r+1;else break}let a=e-o;return r>0&&(a+=this.wrappedTextIndentLength),new RN(r,a)}normalizeOutputPosition(e,t,i){if(this.injectionOffsets!==null){const n=this.outputPositionToOffsetInInputWithInjections(e,t),r=this.normalizeOffsetInInputWithInjectionsAroundInjections(n,i);if(r!==n)return this.offsetInInputWithInjectionsToOutputPosition(r,i)}if(i===0){if(e>0&&t===this.getMinOutputOffset(e))return new RN(e-1,this.getMaxOutputOffset(e-1))}else if(i===1){const n=this.getOutputLineCount()-1;if(e<n&&t===this.getMaxOutputOffset(e))return new RN(e+1,this.getMinOutputOffset(e+1))}return new RN(e,t)}outputPositionToOffsetInInputWithInjections(e,t){return e>0&&(t=Math.max(0,t-this.wrappedTextIndentLength)),(e>0?this.breakOffsets[e-1]:0)+t}normalizeOffsetInInputWithInjectionsAroundInjections(e,t){const i=this.getInjectedTextAtOffset(e);if(!i)return e;if(t===2){if(e===i.offsetInInputWithInjections+i.length&&Bse(this.injectionOptions[i.injectedTextIndex].cursorStops))return i.offsetInInputWithInjections+i.length;{let n=i.offsetInInputWithInjections;if(Wse(this.injectionOptions[i.injectedTextIndex].cursorStops))return n;let r=i.injectedTextIndex-1;for(;r>=0&&this.injectionOffsets[r]===this.injectionOffsets[i.injectedTextIndex]&&!(Bse(this.injectionOptions[r].cursorStops)||(n-=this.injectionOptions[r].content.length,Wse(this.injectionOptions[r].cursorStops)));)r--;return n}}else if(t===1||t===4){let n=i.offsetInInputWithInjections+i.length,r=i.injectedTextIndex;for(;r+1<this.injectionOffsets.length&&this.injectionOffsets[r+1]===this.injectionOffsets[r];)n+=this.injectionOptions[r+1].content.length,r++;return n}else if(t===0||t===3){let n=i.offsetInInputWithInjections,r=i.injectedTextIndex;for(;r-1>=0&&this.injectionOffsets[r-1]===this.injectionOffsets[r];)n-=this.injectionOptions[r-1].content.length,r--;return n}gF()}getInjectedText(e,t){const i=this.outputPositionToOffsetInInputWithInjections(e,t),n=this.getInjectedTextAtOffset(i);return n?{options:this.injectionOptions[n.injectedTextIndex]}:null}getInjectedTextAtOffset(e){const t=this.injectionOffsets,i=this.injectionOptions;if(t!==null){let n=0;for(let r=0;r<t.length;r++){const o=i[r].content.length,a=t[r]+n,l=t[r]+n+o;if(a>e)break;if(e<=l)return{injectedTextIndex:r,offsetInInputWithInjections:a,length:o};n+=o}}}}function Bse(s){return s==null?!0:s===Zc.Right||s===Zc.Both}function Wse(s){return s==null?!0:s===Zc.Left||s===Zc.Both}class RN{constructor(e,t){this.outputLineIndex=e,this.outputOffset=t}toString(){return`${this.outputLineIndex}:${this.outputOffset}`}toPosition(e){return new X(e+this.outputLineIndex,this.outputOffset+1)}}const dB=Og("domLineBreaksComputer",{createHTML:s=>s});class RG{static create(e){return new RG(new WeakRef(e))}constructor(e){this.targetWindow=e}createLineBreaksComputer(e,t,i,n,r){const o=[],a=[];return{addRequest:(l,c,d)=>{o.push(l),a.push(c)},finalize:()=>Gze(Hp(this.targetWindow.deref()),o,e,t,i,n,r,a)}}}function Gze(s,e,t,i,n,r,o,a){function l(R){const W=a[R];if(W){const H=fu.applyInjectedText(e[R],W),U=W.map(ee=>ee.options),B=W.map(ee=>ee.column-1);return new ZL(B,U,[H.length],[],0)}else return null}if(n===-1){const R=[];for(let W=0,H=e.length;W<H;W++)R[W]=l(W);return R}const c=Math.round(n*t.typicalHalfwidthCharacterWidth),u=Math.round(i*(r===3?2:r===2?1:0)),h=Math.ceil(t.spaceWidth*u),g=document.createElement("div");Zs(g,t);const p=new hS(1e4),_=[],v=[],C=[],y=[],x=[];for(let R=0;R<e.length;R++){const W=fu.applyInjectedText(e[R],a[R]);let H=0,U=0,B=c;if(r!==0)if(H=Zr(W),H===-1)H=0;else{for(let Ie=0;Ie<H;Ie++){const ge=W.charCodeAt(Ie)===9?i-U%i:1;U+=ge}const pe=Math.ceil(t.spaceWidth*U);pe+t.typicalFullwidthCharacterWidth>c?(H=0,U=0):B=c-pe}const ee=W.substr(H),re=Qze(ee,U,i,B,p,h);_[R]=H,v[R]=U,C[R]=ee,y[R]=re[0],x[R]=re[1]}const L=p.build(),I=(dB==null?void 0:dB.createHTML(L))??L;g.innerHTML=I,g.style.position="absolute",g.style.top="10000",o==="keepAll"?(g.style.wordBreak="keep-all",g.style.overflowWrap="anywhere"):(g.style.wordBreak="inherit",g.style.overflowWrap="break-word"),s.document.body.appendChild(g);const A=document.createRange(),D=Array.prototype.slice.call(g.children,0),N=[];for(let R=0;R<e.length;R++){const W=D[R],H=Yze(A,W,C[R],y[R]);if(H===null){N[R]=l(R);continue}const U=_[R],B=v[R]+u,ee=x[R],re=[];for(let _e=0,Re=H.length;_e<Re;_e++)re[_e]=ee[H[_e]];if(U!==0)for(let _e=0,Re=H.length;_e<Re;_e++)H[_e]+=U;let pe,Ie;const ge=a[R];ge?(pe=ge.map(_e=>_e.options),Ie=ge.map(_e=>_e.column-1)):(pe=null,Ie=null),N[R]=new ZL(Ie,pe,H,re,B)}return g.remove(),N}function Qze(s,e,t,i,n,r){if(r!==0){const h=String(r);n.appendString('<div style="text-indent: -'),n.appendString(h),n.appendString("px; padding-left: "),n.appendString(h),n.appendString("px; box-sizing: border-box; width:")}else n.appendString('<div style="width:');n.appendString(String(i)),n.appendString('px;">');const o=s.length;let a=e,l=0;const c=[],d=[];let u=0<o?s.charCodeAt(0):0;n.appendString("<span>");for(let h=0;h<o;h++){h!==0&&h%16384===0&&n.appendString("</span><span>"),c[h]=l,d[h]=a;const g=u;u=h+1<o?s.charCodeAt(h+1):0;let p=1,_=1;switch(g){case 9:p=t-a%t,_=p;for(let v=1;v<=p;v++)v<p?n.appendCharCode(160):n.appendASCIICharCode(32);break;case 32:u===32?n.appendCharCode(160):n.appendASCIICharCode(32);break;case 60:n.appendString("&lt;");break;case 62:n.appendString("&gt;");break;case 38:n.appendString("&amp;");break;case 0:n.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:n.appendCharCode(65533);break;default:Um(g)&&_++,g<32?n.appendCharCode(9216+g):n.appendCharCode(g)}l+=p,a+=_}return n.appendString("</span>"),c[s.length]=l,d[s.length]=a,n.appendString("</div>"),[c,d]}function Yze(s,e,t,i){if(t.length<=1)return null;const n=Array.prototype.slice.call(e.children,0),r=[];try{HH(s,n,i,0,null,t.length-1,null,r)}catch(o){return console.log(o),null}return r.length===0?null:(r.push(t.length),r)}function HH(s,e,t,i,n,r,o,a){if(i===r||(n=n||uB(s,e,t[i],t[i+1]),o=o||uB(s,e,t[r],t[r+1]),Math.abs(n[0].top-o[0].top)<=.1))return;if(i+1===r){a.push(r);return}const l=i+(r-i)/2|0,c=uB(s,e,t[l],t[l+1]);HH(s,e,t,i,n,l,c,a),HH(s,e,t,l,c,r,o,a)}function uB(s,e,t,i){return s.setStart(e[t/16384|0].firstChild,t%16384),s.setEnd(e[i/16384|0].firstChild,i%16384),s.getClientRects()}class Xze extends te{constructor(){super(),this._editor=null,this._instantiationService=null,this._instances=this._register(new Sq),this._pending=new Map,this._finishedInstantiation=[],this._finishedInstantiation[0]=!1,this._finishedInstantiation[1]=!1,this._finishedInstantiation[2]=!1,this._finishedInstantiation[3]=!1}initialize(e,t,i){this._editor=e,this._instantiationService=i;for(const n of t){if(this._pending.has(n.id)){ft(new Error(`Cannot have two contributions with the same id ${n.id}`));continue}this._pending.set(n.id,n)}this._instantiateSome(0),this._register(Xx(nt(this._editor.getDomNode()),()=>{this._instantiateSome(1)})),this._register(Xx(nt(this._editor.getDomNode()),()=>{this._instantiateSome(2)})),this._register(Xx(nt(this._editor.getDomNode()),()=>{this._instantiateSome(3)},5e3))}saveViewState(){const e={};for(const[t,i]of this._instances)typeof i.saveViewState=="function"&&(e[t]=i.saveViewState());return e}restoreViewState(e){for(const[t,i]of this._instances)typeof i.restoreViewState=="function"&&i.restoreViewState(e[t])}get(e){return this._instantiateById(e),this._instances.get(e)||null}onBeforeInteractionEvent(){this._instantiateSome(2)}onAfterModelAttached(){var e;return Xx(nt((e=this._editor)==null?void 0:e.getDomNode()),()=>{this._instantiateSome(1)},50)}_instantiateSome(e){if(this._finishedInstantiation[e])return;this._finishedInstantiation[e]=!0;const t=this._findPendingContributionsByInstantiation(e);for(const i of t)this._instantiateById(i.id)}_findPendingContributionsByInstantiation(e){const t=[];for(const[,i]of this._pending)i.instantiation===e&&t.push(i);return t}_instantiateById(e){const t=this._pending.get(e);if(t){if(this._pending.delete(e),!this._instantiationService||!this._editor)throw new Error("Cannot instantiate contributions before being initialized!");try{const i=this._instantiationService.createInstance(t.ctor,this._editor);this._instances.set(t.id,i),typeof i.restoreViewState=="function"&&t.instantiation!==0&&console.warn(`Editor contribution '${t.id}' should be eager instantiated because it uses saveViewState / restoreViewState.`)}catch(i){ft(i)}}}}class rme{constructor(e,t,i,n,r,o,a){this.id=e,this.label=t,this.alias=i,this.metadata=n,this._precondition=r,this._run=o,this._contextKeyService=a}isSupported(){return this._contextKeyService.contextMatchesRules(this._precondition)}run(e){return this.isSupported()?this._run(e):Promise.resolve(void 0)}}class AG{static create(e){return new AG(e.get(135),e.get(134))}constructor(e,t){this.classifier=new Zze(e,t)}createLineBreaksComputer(e,t,i,n,r){const o=[],a=[],l=[];return{addRequest:(c,d,u)=>{o.push(c),a.push(d),l.push(u)},finalize:()=>{const c=e.typicalFullwidthCharacterWidth/e.typicalHalfwidthCharacterWidth,d=[];for(let u=0,h=o.length;u<h;u++){const g=a[u],p=l[u];p&&!p.injectionOptions&&!g?d[u]=Jze(this.classifier,p,o[u],t,i,c,n,r):d[u]=eUe(this.classifier,o[u],g,t,i,c,n,r)}return zH.length=0,UH.length=0,d}}}}class Zze extends fS{constructor(e,t){super(0);for(let i=0;i<e.length;i++)this.set(e.charCodeAt(i),1);for(let i=0;i<t.length;i++)this.set(t.charCodeAt(i),2)}get(e){return e>=0&&e<256?this._asciiMap[e]:e>=12352&&e<=12543||e>=13312&&e<=19903||e>=19968&&e<=40959?3:this._map.get(e)||this._defaultValue}}let zH=[],UH=[];function Jze(s,e,t,i,n,r,o,a){if(n===-1)return null;const l=t.length;if(l<=1)return null;const c=a==="keepAll",d=e.breakOffsets,u=e.breakOffsetsVisibleColumn,h=ome(t,i,n,r,o),g=n-h,p=zH,_=UH;let v=0,C=0,y=0,x=n;const L=d.length;let I=0;if(I>=0){let A=Math.abs(u[I]-x);for(;I+1<L;){const D=Math.abs(u[I+1]-x);if(D>=A)break;A=D,I++}}for(;I<L;){let A=I<0?0:d[I],D=I<0?0:u[I];C>A&&(A=C,D=y);let N=0,R=0,W=0,H=0;if(D<=x){let B=D,ee=A===0?0:t.charCodeAt(A-1),re=A===0?0:s.get(ee),pe=!0;for(let Ie=A;Ie<l;Ie++){const ge=Ie,_e=t.charCodeAt(Ie);let Re,J;if(ws(_e)?(Ie++,Re=0,J=2):(Re=s.get(_e),J=JL(_e,B,i,r)),ge>C&&jH(ee,re,_e,Re,c)&&(N=ge,R=B),B+=J,B>x){ge>C?(W=ge,H=B-J):(W=Ie+1,H=B),B-R>g&&(N=0),pe=!1;break}ee=_e,re=Re}if(pe){v>0&&(p[v]=d[d.length-1],_[v]=u[d.length-1],v++);break}}if(N===0){let B=D,ee=t.charCodeAt(A),re=s.get(ee),pe=!1;for(let Ie=A-1;Ie>=C;Ie--){const ge=Ie+1,_e=t.charCodeAt(Ie);if(_e===9){pe=!0;break}let Re,J;if(cw(_e)?(Ie--,Re=0,J=2):(Re=s.get(_e),J=Um(_e)?r:1),B<=x){if(W===0&&(W=ge,H=B),B<=x-g)break;if(jH(_e,Re,ee,re,c)){N=ge,R=B;break}}B-=J,ee=_e,re=Re}if(N!==0){const Ie=g-(H-R);if(Ie<=i){const ge=t.charCodeAt(W);let _e;ws(ge)?_e=2:_e=JL(ge,H,i,r),Ie-_e<0&&(N=0)}}if(pe){I--;continue}}if(N===0&&(N=W,R=H),N<=C){const B=t.charCodeAt(C);ws(B)?(N=C+2,R=y+2):(N=C+1,R=y+JL(B,y,i,r))}for(C=N,p[v]=N,y=R,_[v]=R,v++,x=R+g;I<0||I<L&&u[I]<R;)I++;let U=Math.abs(u[I]-x);for(;I+1<L;){const B=Math.abs(u[I+1]-x);if(B>=U)break;U=B,I++}}return v===0?null:(p.length=v,_.length=v,zH=e.breakOffsets,UH=e.breakOffsetsVisibleColumn,e.breakOffsets=p,e.breakOffsetsVisibleColumn=_,e.wrappedTextIndentLength=h,e)}function eUe(s,e,t,i,n,r,o,a){const l=fu.applyInjectedText(e,t);let c,d;if(t&&t.length>0?(c=t.map(R=>R.options),d=t.map(R=>R.column-1)):(c=null,d=null),n===-1)return c?new ZL(d,c,[l.length],[],0):null;const u=l.length;if(u<=1)return c?new ZL(d,c,[l.length],[],0):null;const h=a==="keepAll",g=ome(l,i,n,r,o),p=n-g,_=[],v=[];let C=0,y=0,x=0,L=n,I=l.charCodeAt(0),A=s.get(I),D=JL(I,0,i,r),N=1;ws(I)&&(D+=1,I=l.charCodeAt(1),A=s.get(I),N++);for(let R=N;R<u;R++){const W=R,H=l.charCodeAt(R);let U,B;ws(H)?(R++,U=0,B=2):(U=s.get(H),B=JL(H,D,i,r)),jH(I,A,H,U,h)&&(y=W,x=D),D+=B,D>L&&((y===0||D-x>p)&&(y=W,x=D-B),_[C]=y,v[C]=x,C++,L=x+p,y=0),I=H,A=U}return C===0&&(!t||t.length===0)?null:(_[C]=u,v[C]=D,new ZL(d,c,_,v,g))}function JL(s,e,t,i){return s===9?t-e%t:Um(s)||s<32?i:1}function Hse(s,e){return e-s%e}function jH(s,e,t,i,n){return t!==32&&(e===2&&i!==2||e!==1&&i===1||!n&&e===3&&i!==2||!n&&i===3&&e!==1)}function ome(s,e,t,i,n){let r=0;if(n!==0){const o=Zr(s);if(o!==-1){for(let l=0;l<o;l++){const c=s.charCodeAt(l)===9?Hse(r,e):1;r+=c}const a=n===3?2:n===2?1:0;for(let l=0;l<a;l++){const c=Hse(r,e);r+=c}r+i>t&&(r=0)}}return r}class fP{constructor(e){this._selTrackedRange=null,this._trackSelection=!0,this._setState(e,new Ks(new F(1,1,1,1),0,0,new X(1,1),0),new Ks(new F(1,1,1,1),0,0,new X(1,1),0))}dispose(e){this._removeTrackedRange(e)}startTrackingSelection(e){this._trackSelection=!0,this._updateTrackedRange(e)}stopTrackingSelection(e){this._trackSelection=!1,this._removeTrackedRange(e)}_updateTrackedRange(e){this._trackSelection&&(this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,this.modelState.selection,0))}_removeTrackedRange(e){this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,null,0)}asCursorState(){return new ti(this.modelState,this.viewState)}readSelectionFromMarkers(e){const t=e.model._getTrackedRange(this._selTrackedRange);return this.modelState.selection.isEmpty()&&!t.isEmpty()?Ue.fromRange(t.collapseToEnd(),this.modelState.selection.getDirection()):Ue.fromRange(t,this.modelState.selection.getDirection())}ensureValidState(e){this._setState(e,this.modelState,this.viewState)}setState(e,t,i){this._setState(e,t,i)}static _validatePositionWithCache(e,t,i,n){return t.equals(i)?n:e.normalizePosition(t,2)}static _validateViewState(e,t){const i=t.position,n=t.selectionStart.getStartPosition(),r=t.selectionStart.getEndPosition(),o=e.normalizePosition(i,2),a=this._validatePositionWithCache(e,n,i,o),l=this._validatePositionWithCache(e,r,n,a);return i.equals(o)&&n.equals(a)&&r.equals(l)?t:new Ks(F.fromPositions(a,l),t.selectionStartKind,t.selectionStartLeftoverVisibleColumns+n.column-a.column,o,t.leftoverVisibleColumns+i.column-o.column)}_setState(e,t,i){if(i&&(i=fP._validateViewState(e.viewModel,i)),t){const n=e.model.validateRange(t.selectionStart),r=t.selectionStart.equalsRange(n)?t.selectionStartLeftoverVisibleColumns:0,o=e.model.validatePosition(t.position),a=t.position.equals(o)?t.leftoverVisibleColumns:0;t=new Ks(n,t.selectionStartKind,r,o,a)}else{if(!i)return;const n=e.model.validateRange(e.coordinatesConverter.convertViewRangeToModelRange(i.selectionStart)),r=e.model.validatePosition(e.coordinatesConverter.convertViewPositionToModelPosition(i.position));t=new Ks(n,i.selectionStartKind,i.selectionStartLeftoverVisibleColumns,r,i.leftoverVisibleColumns)}if(i){const n=e.coordinatesConverter.validateViewRange(i.selectionStart,t.selectionStart),r=e.coordinatesConverter.validateViewPosition(i.position,t.position);i=new Ks(n,t.selectionStartKind,t.selectionStartLeftoverVisibleColumns,r,t.leftoverVisibleColumns)}else{const n=e.coordinatesConverter.convertModelPositionToViewPosition(new X(t.selectionStart.startLineNumber,t.selectionStart.startColumn)),r=e.coordinatesConverter.convertModelPositionToViewPosition(new X(t.selectionStart.endLineNumber,t.selectionStart.endColumn)),o=new F(n.lineNumber,n.column,r.lineNumber,r.column),a=e.coordinatesConverter.convertModelPositionToViewPosition(t.position);i=new Ks(o,t.selectionStartKind,t.selectionStartLeftoverVisibleColumns,a,t.leftoverVisibleColumns)}this.modelState=t,this.viewState=i,this._updateTrackedRange(e)}}class zse{constructor(e){this.context=e,this.cursors=[new fP(e)],this.lastAddedCursorIndex=0}dispose(){for(const e of this.cursors)e.dispose(this.context)}startTrackingSelections(){for(const e of this.cursors)e.startTrackingSelection(this.context)}stopTrackingSelections(){for(const e of this.cursors)e.stopTrackingSelection(this.context)}updateContext(e){this.context=e}ensureValidState(){for(const e of this.cursors)e.ensureValidState(this.context)}readSelectionFromMarkers(){return this.cursors.map(e=>e.readSelectionFromMarkers(this.context))}getAll(){return this.cursors.map(e=>e.asCursorState())}getViewPositions(){return this.cursors.map(e=>e.viewState.position)}getTopMostViewPosition(){return hMe(this.cursors,Co(e=>e.viewState.position,X.compare)).viewState.position}getBottomMostViewPosition(){return uMe(this.cursors,Co(e=>e.viewState.position,X.compare)).viewState.position}getSelections(){return this.cursors.map(e=>e.modelState.selection)}getViewSelections(){return this.cursors.map(e=>e.viewState.selection)}setSelections(e){this.setStates(ti.fromModelSelections(e))}getPrimaryCursor(){return this.cursors[0].asCursorState()}setStates(e){e!==null&&(this.cursors[0].setState(this.context,e[0].modelState,e[0].viewState),this._setSecondaryStates(e.slice(1)))}_setSecondaryStates(e){const t=this.cursors.length-1,i=e.length;if(t<i){const n=i-t;for(let r=0;r<n;r++)this._addSecondaryCursor()}else if(t>i){const n=t-i;for(let r=0;r<n;r++)this._removeSecondaryCursor(this.cursors.length-2)}for(let n=0;n<i;n++)this.cursors[n+1].setState(this.context,e[n].modelState,e[n].viewState)}killSecondaryCursors(){this._setSecondaryStates([])}_addSecondaryCursor(){this.cursors.push(new fP(this.context)),this.lastAddedCursorIndex=this.cursors.length-1}getLastAddedCursorIndex(){return this.cursors.length===1||this.lastAddedCursorIndex===0?0:this.lastAddedCursorIndex}_removeSecondaryCursor(e){this.lastAddedCursorIndex>=e+1&&this.lastAddedCursorIndex--,this.cursors[e+1].dispose(this.context),this.cursors.splice(e+1,1)}normalize(){if(this.cursors.length===1)return;const e=this.cursors.slice(0),t=[];for(let i=0,n=e.length;i<n;i++)t.push({index:i,selection:e[i].modelState.selection});t.sort(Co(i=>i.selection,F.compareRangesUsingStarts));for(let i=0;i<t.length-1;i++){const n=t[i],r=t[i+1],o=n.selection,a=r.selection;if(!this.context.cursorConfig.multiCursorMergeOverlapping)continue;let l;if(a.isEmpty()||o.isEmpty()?l=a.getStartPosition().isBeforeOrEqual(o.getEndPosition()):l=a.getStartPosition().isBefore(o.getEndPosition()),l){const c=n.index<r.index?i:i+1,d=n.index<r.index?i+1:i,u=t[d].index,h=t[c].index,g=t[d].selection,p=t[c].selection;if(!g.equalsSelection(p)){const _=g.plusRange(p),v=g.selectionStartLineNumber===g.startLineNumber&&g.selectionStartColumn===g.startColumn,C=p.selectionStartLineNumber===p.startLineNumber&&p.selectionStartColumn===p.startColumn;let y;u===this.lastAddedCursorIndex?(y=v,this.lastAddedCursorIndex=h):y=C;let x;y?x=new Ue(_.startLineNumber,_.startColumn,_.endLineNumber,_.endColumn):x=new Ue(_.endLineNumber,_.endColumn,_.startLineNumber,_.startColumn),t[c].selection=x;const L=ti.fromModelSelection(x);e[h].setState(this.context,L.modelState,L.viewState)}for(const _ of t)_.index>u&&_.index--;e.splice(u,1),t.splice(d,1),this._removeSecondaryCursor(u-1),i--}}}}class Use{constructor(e,t,i,n){this._cursorContextBrand=void 0,this.model=e,this.viewModel=t,this.coordinatesConverter=i,this.cursorConfig=n}}class tUe{constructor(){this.type=0}}class iUe{constructor(){this.type=1}}class nUe{constructor(e){this.type=2,this._source=e}hasChanged(e){return this._source.hasChanged(e)}}class sUe{constructor(e,t,i){this.selections=e,this.modelSelections=t,this.reason=i,this.type=3}}class Y_{constructor(e){this.type=4,e?(this.affectsMinimap=e.affectsMinimap,this.affectsOverviewRuler=e.affectsOverviewRuler,this.affectsGlyphMargin=e.affectsGlyphMargin,this.affectsLineNumber=e.affectsLineNumber):(this.affectsMinimap=!0,this.affectsOverviewRuler=!0,this.affectsGlyphMargin=!0,this.affectsLineNumber=!0)}}class AN{constructor(){this.type=5}}class rUe{constructor(e){this.type=6,this.isFocused=e}}class oUe{constructor(){this.type=7}}class PN{constructor(){this.type=8}}class ame{constructor(e,t){this.fromLineNumber=e,this.count=t,this.type=9}}class $H{constructor(e,t){this.type=10,this.fromLineNumber=e,this.toLineNumber=t}}class qH{constructor(e,t){this.type=11,this.fromLineNumber=e,this.toLineNumber=t}}class ek{constructor(e,t,i,n,r,o,a){this.source=e,this.minimalReveal=t,this.range=i,this.selections=n,this.verticalType=r,this.revealHorizontal=o,this.scrollType=a,this.type=12}}class aUe{constructor(e){this.type=13,this.scrollWidth=e.scrollWidth,this.scrollLeft=e.scrollLeft,this.scrollHeight=e.scrollHeight,this.scrollTop=e.scrollTop,this.scrollWidthChanged=e.scrollWidthChanged,this.scrollLeftChanged=e.scrollLeftChanged,this.scrollHeightChanged=e.scrollHeightChanged,this.scrollTopChanged=e.scrollTopChanged}}class lUe{constructor(e){this.theme=e,this.type=14}}class cUe{constructor(e){this.type=15,this.ranges=e}}class dUe{constructor(){this.type=16}}let uUe=class{constructor(){this.type=17}};class hUe extends te{constructor(){super(),this._onEvent=this._register(new Z),this.onEvent=this._onEvent.event,this._eventHandlers=[],this._viewEventQueue=null,this._isConsumingViewEventQueue=!1,this._collector=null,this._collectorCnt=0,this._outgoingEvents=[]}emitOutgoingEvent(e){this._addOutgoingEvent(e),this._emitOutgoingEvents()}_addOutgoingEvent(e){for(let t=0,i=this._outgoingEvents.length;t<i;t++){const n=this._outgoingEvents[t].kind===e.kind?this._outgoingEvents[t].attemptToMerge(e):null;if(n){this._outgoingEvents[t]=n;return}}this._outgoingEvents.push(e)}_emitOutgoingEvents(){for(;this._outgoingEvents.length>0;){if(this._collector||this._isConsumingViewEventQueue)return;const e=this._outgoingEvents.shift();e.isNoOp()||this._onEvent.fire(e)}}addViewEventHandler(e){for(let t=0,i=this._eventHandlers.length;t<i;t++)this._eventHandlers[t]===e&&console.warn("Detected duplicate listener in ViewEventDispatcher",e);this._eventHandlers.push(e)}removeViewEventHandler(e){for(let t=0;t<this._eventHandlers.length;t++)if(this._eventHandlers[t]===e){this._eventHandlers.splice(t,1);break}}beginEmitViewEvents(){return this._collectorCnt++,this._collectorCnt===1&&(this._collector=new fUe),this._collector}endEmitViewEvents(){if(this._collectorCnt--,this._collectorCnt===0){const e=this._collector.outgoingEvents,t=this._collector.viewEvents;this._collector=null;for(const i of e)this._addOutgoingEvent(i);t.length>0&&this._emitMany(t)}this._emitOutgoingEvents()}emitSingleViewEvent(e){try{this.beginEmitViewEvents().emitViewEvent(e)}finally{this.endEmitViewEvents()}}_emitMany(e){this._viewEventQueue?this._viewEventQueue=this._viewEventQueue.concat(e):this._viewEventQueue=e,this._isConsumingViewEventQueue||this._consumeViewEventQueue()}_consumeViewEventQueue(){try{this._isConsumingViewEventQueue=!0,this._doConsumeQueue()}finally{this._isConsumingViewEventQueue=!1}}_doConsumeQueue(){for(;this._viewEventQueue;){const e=this._viewEventQueue;this._viewEventQueue=null;const t=this._eventHandlers.slice(0);for(const i of t)i.handleEvents(e)}}}class fUe{constructor(){this.viewEvents=[],this.outgoingEvents=[]}emitViewEvent(e){this.viewEvents.push(e)}emitOutgoingEvent(e){this.outgoingEvents.push(e)}}class PG{constructor(e,t,i,n){this.kind=0,this._oldContentWidth=e,this._oldContentHeight=t,this.contentWidth=i,this.contentHeight=n,this.contentWidthChanged=this._oldContentWidth!==this.contentWidth,this.contentHeightChanged=this._oldContentHeight!==this.contentHeight}isNoOp(){return!this.contentWidthChanged&&!this.contentHeightChanged}attemptToMerge(e){return e.kind!==this.kind?null:new PG(this._oldContentWidth,this._oldContentHeight,e.contentWidth,e.contentHeight)}}class MG{constructor(e,t){this.kind=1,this.oldHasFocus=e,this.hasFocus=t}isNoOp(){return this.oldHasFocus===this.hasFocus}attemptToMerge(e){return e.kind!==this.kind?null:new MG(this.oldHasFocus,e.hasFocus)}}class OG{constructor(e,t,i,n,r,o,a,l){this.kind=2,this._oldScrollWidth=e,this._oldScrollLeft=t,this._oldScrollHeight=i,this._oldScrollTop=n,this.scrollWidth=r,this.scrollLeft=o,this.scrollHeight=a,this.scrollTop=l,this.scrollWidthChanged=this._oldScrollWidth!==this.scrollWidth,this.scrollLeftChanged=this._oldScrollLeft!==this.scrollLeft,this.scrollHeightChanged=this._oldScrollHeight!==this.scrollHeight,this.scrollTopChanged=this._oldScrollTop!==this.scrollTop}isNoOp(){return!this.scrollWidthChanged&&!this.scrollLeftChanged&&!this.scrollHeightChanged&&!this.scrollTopChanged}attemptToMerge(e){return e.kind!==this.kind?null:new OG(this._oldScrollWidth,this._oldScrollLeft,this._oldScrollHeight,this._oldScrollTop,e.scrollWidth,e.scrollLeft,e.scrollHeight,e.scrollTop)}}class gUe{constructor(){this.kind=3}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}}class pUe{constructor(){this.kind=4}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}}class gP{constructor(e,t,i,n,r,o,a){this.kind=6,this.oldSelections=e,this.selections=t,this.oldModelVersionId=i,this.modelVersionId=n,this.source=r,this.reason=o,this.reachedMaxCursorCount=a}static _selectionsAreEqual(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;const i=e.length,n=t.length;if(i!==n)return!1;for(let r=0;r<i;r++)if(!e[r].equalsSelection(t[r]))return!1;return!0}isNoOp(){return gP._selectionsAreEqual(this.oldSelections,this.selections)&&this.oldModelVersionId===this.modelVersionId}attemptToMerge(e){return e.kind!==this.kind?null:new gP(this.oldSelections,e.selections,this.oldModelVersionId,e.modelVersionId,e.source,e.reason,this.reachedMaxCursorCount||e.reachedMaxCursorCount)}}class mUe{constructor(){this.kind=5}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}}class _Ue{constructor(e){this.event=e,this.kind=7}isNoOp(){return!1}attemptToMerge(e){return null}}class bUe{constructor(e){this.event=e,this.kind=8}isNoOp(){return!1}attemptToMerge(e){return null}}class vUe{constructor(e){this.event=e,this.kind=9}isNoOp(){return!1}attemptToMerge(e){return null}}class wUe{constructor(e){this.event=e,this.kind=10}isNoOp(){return!1}attemptToMerge(e){return null}}class CUe{constructor(e){this.event=e,this.kind=11}isNoOp(){return!1}attemptToMerge(e){return null}}class yUe{constructor(e){this.event=e,this.kind=12}isNoOp(){return!1}attemptToMerge(e){return null}}class SUe extends te{constructor(e,t,i,n){super(),this._model=e,this._knownModelVersionId=this._model.getVersionId(),this._viewModel=t,this._coordinatesConverter=i,this.context=new Use(this._model,this._viewModel,this._coordinatesConverter,n),this._cursors=new zse(this.context),this._hasFocus=!1,this._isHandling=!1,this._compositionState=null,this._columnSelectData=null,this._autoClosedActions=[],this._prevEditOperationType=0}dispose(){this._cursors.dispose(),this._autoClosedActions=Ni(this._autoClosedActions),super.dispose()}updateConfiguration(e){this.context=new Use(this._model,this._viewModel,this._coordinatesConverter,e),this._cursors.updateContext(this.context)}onLineMappingChanged(e){this._knownModelVersionId===this._model.getVersionId()&&this.setStates(e,"viewModel",0,this.getCursorStates())}setHasFocus(e){this._hasFocus=e}_validateAutoClosedActions(){if(this._autoClosedActions.length>0){const e=this._cursors.getSelections();for(let t=0;t<this._autoClosedActions.length;t++){const i=this._autoClosedActions[t];i.isValid(e)||(i.dispose(),this._autoClosedActions.splice(t,1),t--)}}}getPrimaryCursorState(){return this._cursors.getPrimaryCursor()}getLastAddedCursorIndex(){return this._cursors.getLastAddedCursorIndex()}getCursorStates(){return this._cursors.getAll()}setStates(e,t,i,n){let r=!1;const o=this.context.cursorConfig.multiCursorLimit;n!==null&&n.length>o&&(n=n.slice(0,o),r=!0);const a=tk.from(this._model,this);return this._cursors.setStates(n),this._cursors.normalize(),this._columnSelectData=null,this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,t,i,a,r)}setCursorColumnSelectData(e){this._columnSelectData=e}revealAll(e,t,i,n,r,o){const a=this._cursors.getViewPositions();let l=null,c=null;a.length>1?c=this._cursors.getViewSelections():l=F.fromPositions(a[0],a[0]),e.emitViewEvent(new ek(t,i,l,c,n,r,o))}revealPrimary(e,t,i,n,r,o){const l=[this._cursors.getPrimaryCursor().viewState.selection];e.emitViewEvent(new ek(t,i,null,l,n,r,o))}saveState(){const e=[],t=this._cursors.getSelections();for(let i=0,n=t.length;i<n;i++){const r=t[i];e.push({inSelectionMode:!r.isEmpty(),selectionStart:{lineNumber:r.selectionStartLineNumber,column:r.selectionStartColumn},position:{lineNumber:r.positionLineNumber,column:r.positionColumn}})}return e}restoreState(e,t){const i=[];for(let n=0,r=t.length;n<r;n++){const o=t[n];let a=1,l=1;o.position&&o.position.lineNumber&&(a=o.position.lineNumber),o.position&&o.position.column&&(l=o.position.column);let c=a,d=l;o.selectionStart&&o.selectionStart.lineNumber&&(c=o.selectionStart.lineNumber),o.selectionStart&&o.selectionStart.column&&(d=o.selectionStart.column),i.push({selectionStartLineNumber:c,selectionStartColumn:d,positionLineNumber:a,positionColumn:l})}this.setStates(e,"restoreState",0,ti.fromModelSelections(i)),this.revealAll(e,"restoreState",!1,0,!0,1)}onModelContentChanged(e,t){if(t instanceof Uge){if(this._isHandling)return;this._isHandling=!0;try{this.setStates(e,"modelChange",0,this.getCursorStates())}finally{this._isHandling=!1}}else{const i=t.rawContentChangedEvent;if(this._knownModelVersionId=i.versionId,this._isHandling)return;const n=i.containsEvent(1);if(this._prevEditOperationType=0,n)this._cursors.dispose(),this._cursors=new zse(this.context),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,"model",1,null,!1);else if(this._hasFocus&&i.resultingSelection&&i.resultingSelection.length>0){const r=ti.fromModelSelections(i.resultingSelection);this.setStates(e,"modelChange",i.isUndoing?5:i.isRedoing?6:2,r)&&this.revealAll(e,"modelChange",!1,0,!0,0)}else{const r=this._cursors.readSelectionFromMarkers();this.setStates(e,"modelChange",2,ti.fromModelSelections(r))}}}getSelection(){return this._cursors.getPrimaryCursor().modelState.selection}getTopMostViewPosition(){return this._cursors.getTopMostViewPosition()}getBottomMostViewPosition(){return this._cursors.getBottomMostViewPosition()}getCursorColumnSelectData(){if(this._columnSelectData)return this._columnSelectData;const e=this._cursors.getPrimaryCursor(),t=e.viewState.selectionStart.getStartPosition(),i=e.viewState.position;return{isReal:!1,fromViewLineNumber:t.lineNumber,fromViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,t),toViewLineNumber:i.lineNumber,toViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,i)}}getSelections(){return this._cursors.getSelections()}setSelections(e,t,i,n){this.setStates(e,t,n,ti.fromModelSelections(i))}getPrevEditOperationType(){return this._prevEditOperationType}setPrevEditOperationType(e){this._prevEditOperationType=e}_pushAutoClosedAction(e,t){const i=[],n=[];for(let a=0,l=e.length;a<l;a++)i.push({range:e[a],options:{description:"auto-closed-character",inlineClassName:"auto-closed-character",stickiness:1}}),n.push({range:t[a],options:{description:"auto-closed-enclosing",stickiness:1}});const r=this._model.deltaDecorations([],i),o=this._model.deltaDecorations([],n);this._autoClosedActions.push(new jse(this._model,r,o))}_executeEditOperation(e){if(!e)return;e.shouldPushStackElementBefore&&this._model.pushStackElement();const t=xUe.executeCommands(this._model,this._cursors.getSelections(),e.commands);if(t){this._interpretCommandResult(t);const i=[],n=[];for(let r=0;r<e.commands.length;r++){const o=e.commands[r];o instanceof EG&&o.enclosingRange&&o.closeCharacterRange&&(i.push(o.closeCharacterRange),n.push(o.enclosingRange))}i.length>0&&this._pushAutoClosedAction(i,n),this._prevEditOperationType=e.type}e.shouldPushStackElementAfter&&this._model.pushStackElement()}_interpretCommandResult(e){(!e||e.length===0)&&(e=this._cursors.readSelectionFromMarkers()),this._columnSelectData=null,this._cursors.setSelections(e),this._cursors.normalize()}_emitStateChangedIfNecessary(e,t,i,n,r){const o=tk.from(this._model,this);if(o.equals(n))return!1;const a=this._cursors.getSelections(),l=this._cursors.getViewSelections();if(e.emitViewEvent(new sUe(l,a,i)),!n||n.cursorState.length!==o.cursorState.length||o.cursorState.some((c,d)=>!c.modelState.equals(n.cursorState[d].modelState))){const c=n?n.cursorState.map(u=>u.modelState.selection):null,d=n?n.modelVersionId:0;e.emitOutgoingEvent(new gP(c,a,d,o.modelVersionId,t||"keyboard",i,r))}return!0}_findAutoClosingPairs(e){if(!e.length)return null;const t=[];for(let i=0,n=e.length;i<n;i++){const r=e[i];if(!r.text||r.text.indexOf(`
`)>=0)return null;const o=r.text.match(/([)\]}>'"`])([^)\]}>'"`]*)$/);if(!o)return null;const a=o[1],l=this.context.cursorConfig.autoClosingPairs.autoClosingPairsCloseSingleChar.get(a);if(!l||l.length!==1)return null;const c=l[0].open,d=r.text.length-o[2].length-1,u=r.text.lastIndexOf(c,d-1);if(u===-1)return null;t.push([u,d])}return t}executeEdits(e,t,i,n){let r=null;t==="snippet"&&(r=this._findAutoClosingPairs(i)),r&&(i[0]._isTracked=!0);const o=[],a=[],l=this._model.pushEditOperations(this.getSelections(),i,c=>{if(r)for(let u=0,h=r.length;u<h;u++){const[g,p]=r[u],_=c[u],v=_.range.startLineNumber,C=_.range.startColumn-1+g,y=_.range.startColumn-1+p;o.push(new F(v,y+1,v,y+2)),a.push(new F(v,C+1,v,y+2))}const d=n(c);return d&&(this._isHandling=!0),d});l&&(this._isHandling=!1,this.setSelections(e,t,l,0)),o.length>0&&this._pushAutoClosedAction(o,a)}_executeEdit(e,t,i,n=0){if(this.context.cursorConfig.readOnly)return;const r=tk.from(this._model,this);this._cursors.stopTrackingSelections(),this._isHandling=!0;try{this._cursors.ensureValidState(),e()}catch(o){ft(o)}this._isHandling=!1,this._cursors.startTrackingSelections(),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(t,i,n,r,!1)&&this.revealAll(t,i,!1,0,!0,0)}getAutoClosedCharacters(){return jse.getAllAutoClosedCharacters(this._autoClosedActions)}startComposition(e){this._compositionState=new ik(this._model,this.getSelections())}endComposition(e,t){const i=this._compositionState?this._compositionState.deduceOutcome(this._model,this.getSelections()):null;this._compositionState=null,this._executeEdit(()=>{t==="keyboard"&&this._executeEditOperation(Fp.compositionEndWithInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,i,this.getSelections(),this.getAutoClosedCharacters()))},e,t)}type(e,t,i){this._executeEdit(()=>{if(i==="keyboard"){const n=t.length;let r=0;for(;r<n;){const o=Rq(t,r),a=t.substr(r,o);this._executeEditOperation(Fp.typeWithInterceptors(!!this._compositionState,this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),this.getAutoClosedCharacters(),a)),r+=o}}else this._executeEditOperation(Fp.typeWithoutInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t))},e,i)}compositionType(e,t,i,n,r,o){if(t.length===0&&i===0&&n===0){if(r!==0){const a=this.getSelections().map(l=>{const c=l.getPosition();return new Ue(c.lineNumber,c.column+r,c.lineNumber,c.column+r)});this.setSelections(e,o,a,0)}return}this._executeEdit(()=>{this._executeEditOperation(Fp.compositionType(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t,i,n,r))},e,o)}paste(e,t,i,n,r){this._executeEdit(()=>{this._executeEditOperation(Fp.paste(this.context.cursorConfig,this._model,this.getSelections(),t,i,n||[]))},e,r,4)}cut(e,t){this._executeEdit(()=>{this._executeEditOperation(yw.cut(this.context.cursorConfig,this._model,this.getSelections()))},e,t)}executeCommand(e,t,i){this._executeEdit(()=>{this._cursors.killSecondaryCursors(),this._executeEditOperation(new na(0,[t],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},e,i)}executeCommands(e,t,i){this._executeEdit(()=>{this._executeEditOperation(new na(0,t,{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},e,i)}}class tk{static from(e,t){return new tk(e.getVersionId(),t.getCursorStates())}constructor(e,t){this.modelVersionId=e,this.cursorState=t}equals(e){if(!e||this.modelVersionId!==e.modelVersionId||this.cursorState.length!==e.cursorState.length)return!1;for(let t=0,i=this.cursorState.length;t<i;t++)if(!this.cursorState[t].equals(e.cursorState[t]))return!1;return!0}}class jse{static getAllAutoClosedCharacters(e){let t=[];for(const i of e)t=t.concat(i.getAutoClosedCharactersRanges());return t}constructor(e,t,i){this._model=e,this._autoClosedCharactersDecorations=t,this._autoClosedEnclosingDecorations=i}dispose(){this._autoClosedCharactersDecorations=this._model.deltaDecorations(this._autoClosedCharactersDecorations,[]),this._autoClosedEnclosingDecorations=this._model.deltaDecorations(this._autoClosedEnclosingDecorations,[])}getAutoClosedCharactersRanges(){const e=[];for(let t=0;t<this._autoClosedCharactersDecorations.length;t++){const i=this._model.getDecorationRange(this._autoClosedCharactersDecorations[t]);i&&e.push(i)}return e}isValid(e){const t=[];for(let i=0;i<this._autoClosedEnclosingDecorations.length;i++){const n=this._model.getDecorationRange(this._autoClosedEnclosingDecorations[i]);if(n&&(t.push(n),n.startLineNumber!==n.endLineNumber))return!1}t.sort(F.compareRangesUsingStarts),e.sort(F.compareRangesUsingStarts);for(let i=0;i<e.length;i++)if(i>=t.length||!t[i].strictContainsRange(e[i]))return!1;return!0}}class xUe{static executeCommands(e,t,i){const n={model:e,selectionsBefore:t,trackedRanges:[],trackedRangesDirection:[]},r=this._innerExecuteCommands(n,i);for(let o=0,a=n.trackedRanges.length;o<a;o++)n.model._setTrackedRange(n.trackedRanges[o],null,0);return r}static _innerExecuteCommands(e,t){if(this._arrayIsEmpty(t))return null;const i=this._getEditOperations(e,t);if(i.operations.length===0)return null;const n=i.operations,r=this._getLoserCursorMap(n);if(r.hasOwnProperty("0"))return console.warn("Ignoring commands"),null;const o=[];for(let c=0,d=n.length;c<d;c++)r.hasOwnProperty(n[c].identifier.major.toString())||o.push(n[c]);i.hadTrackedEditOperation&&o.length>0&&(o[0]._isTracked=!0);let a=e.model.pushEditOperations(e.selectionsBefore,o,c=>{const d=[];for(let g=0;g<e.selectionsBefore.length;g++)d[g]=[];for(const g of c)g.identifier&&d[g.identifier.major].push(g);const u=(g,p)=>g.identifier.minor-p.identifier.minor,h=[];for(let g=0;g<e.selectionsBefore.length;g++)d[g].length>0?(d[g].sort(u),h[g]=t[g].computeCursorState(e.model,{getInverseEditOperations:()=>d[g],getTrackedSelection:p=>{const _=parseInt(p,10),v=e.model._getTrackedRange(e.trackedRanges[_]);return e.trackedRangesDirection[_]===0?new Ue(v.startLineNumber,v.startColumn,v.endLineNumber,v.endColumn):new Ue(v.endLineNumber,v.endColumn,v.startLineNumber,v.startColumn)}})):h[g]=e.selectionsBefore[g];return h});a||(a=e.selectionsBefore);const l=[];for(const c in r)r.hasOwnProperty(c)&&l.push(parseInt(c,10));l.sort((c,d)=>d-c);for(const c of l)a.splice(c,1);return a}static _arrayIsEmpty(e){for(let t=0,i=e.length;t<i;t++)if(e[t])return!1;return!0}static _getEditOperations(e,t){let i=[],n=!1;for(let r=0,o=t.length;r<o;r++){const a=t[r];if(a){const l=this._getEditOperationsFromCommand(e,r,a);i=i.concat(l.operations),n=n||l.hadTrackedEditOperation}}return{operations:i,hadTrackedEditOperation:n}}static _getEditOperationsFromCommand(e,t,i){const n=[];let r=0;const o=(u,h,g=!1)=>{F.isEmpty(u)&&h===""||n.push({identifier:{major:t,minor:r++},range:u,text:h,forceMoveMarkers:g,isAutoWhitespaceEdit:i.insertsAutoWhitespace})};let a=!1;const d={addEditOperation:o,addTrackedEditOperation:(u,h,g)=>{a=!0,o(u,h,g)},trackSelection:(u,h)=>{const g=Ue.liftSelection(u);let p;if(g.isEmpty())if(typeof h=="boolean")h?p=2:p=3;else{const C=e.model.getLineMaxColumn(g.startLineNumber);g.startColumn===C?p=2:p=3}else p=1;const _=e.trackedRanges.length,v=e.model._setTrackedRange(null,g,p);return e.trackedRanges[_]=v,e.trackedRangesDirection[_]=g.getDirection(),_.toString()}};try{i.getEditOperations(e.model,d)}catch(u){return ft(u),{operations:[],hadTrackedEditOperation:!1}}return{operations:n,hadTrackedEditOperation:a}}static _getLoserCursorMap(e){e=e.slice(0),e.sort((i,n)=>-F.compareRangesUsingEnds(i.range,n.range));const t={};for(let i=1;i<e.length;i++){const n=e[i-1],r=e[i];if(F.getStartPosition(n.range).isBefore(F.getEndPosition(r.range))){let o;n.identifier.major>r.identifier.major?o=n.identifier.major:o=r.identifier.major,t[o.toString()]=!0;for(let a=0;a<e.length;a++)e[a].identifier.major===o&&(e.splice(a,1),a<i&&i--,a--);i>0&&i--}}return t}}class LUe{constructor(e,t,i){this.text=e,this.startSelection=t,this.endSelection=i}}class ik{static _capture(e,t){const i=[];for(const n of t){if(n.startLineNumber!==n.endLineNumber)return null;i.push(new LUe(e.getLineContent(n.startLineNumber),n.startColumn-1,n.endColumn-1))}return i}constructor(e,t){this._original=ik._capture(e,t)}deduceOutcome(e,t){if(!this._original)return null;const i=ik._capture(e,t);if(!i||this._original.length!==i.length)return null;const n=[];for(let r=0,o=this._original.length;r<o;r++)n.push(ik._deduceOutcome(this._original[r],i[r]));return n}static _deduceOutcome(e,t){const i=Math.min(e.startSelection,t.startSelection,zm(e.text,t.text)),n=Math.min(e.text.length-e.endSelection,t.text.length-t.endSelection,B2(e.text,t.text)),r=e.text.substring(i,e.text.length-n),o=t.text.substring(i,t.text.length-n);return new JHe(r,e.startSelection-i,e.endSelection-i,o,t.startSelection-i,t.endSelection-i)}}class kUe{constructor(){this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[]}insert(e){this._hasPending=!0,this._inserts.push(e)}change(e){this._hasPending=!0,this._changes.push(e)}remove(e){this._hasPending=!0,this._removes.push(e)}mustCommit(){return this._hasPending}commit(e){if(!this._hasPending)return;const t=this._inserts,i=this._changes,n=this._removes;this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[],e._commitPendingChanges(t,i,n)}}class IUe{constructor(e,t,i,n,r){this.id=e,this.afterLineNumber=t,this.ordinal=i,this.height=n,this.minWidth=r,this.prefixSum=0}}var pm;let EUe=(pm=class{constructor(e,t,i,n){this._instanceId=Aue(++pm.INSTANCE_COUNT),this._pendingChanges=new kUe,this._lastWhitespaceId=0,this._arr=[],this._prefixSumValidIndex=-1,this._minWidth=-1,this._lineCount=e,this._lineHeight=t,this._paddingTop=i,this._paddingBottom=n}static findInsertionIndex(e,t,i){let n=0,r=e.length;for(;n<r;){const o=n+r>>>1;t===e[o].afterLineNumber?i<e[o].ordinal?r=o:n=o+1:t<e[o].afterLineNumber?r=o:n=o+1}return n}setLineHeight(e){this._checkPendingChanges(),this._lineHeight=e}setPadding(e,t){this._paddingTop=e,this._paddingBottom=t}onFlushed(e){this._checkPendingChanges(),this._lineCount=e}changeWhitespace(e){let t=!1;try{e({insertWhitespace:(n,r,o,a)=>{t=!0,n=n|0,r=r|0,o=o|0,a=a|0;const l=this._instanceId+ ++this._lastWhitespaceId;return this._pendingChanges.insert(new IUe(l,n,r,o,a)),l},changeOneWhitespace:(n,r,o)=>{t=!0,r=r|0,o=o|0,this._pendingChanges.change({id:n,newAfterLineNumber:r,newHeight:o})},removeWhitespace:n=>{t=!0,this._pendingChanges.remove({id:n})}})}finally{this._pendingChanges.commit(this)}return t}_commitPendingChanges(e,t,i){if((e.length>0||i.length>0)&&(this._minWidth=-1),e.length+t.length+i.length<=1){for(const l of e)this._insertWhitespace(l);for(const l of t)this._changeOneWhitespace(l.id,l.newAfterLineNumber,l.newHeight);for(const l of i){const c=this._findWhitespaceIndex(l.id);c!==-1&&this._removeWhitespace(c)}return}const n=new Set;for(const l of i)n.add(l.id);const r=new Map;for(const l of t)r.set(l.id,l);const o=l=>{const c=[];for(const d of l)if(!n.has(d.id)){if(r.has(d.id)){const u=r.get(d.id);d.afterLineNumber=u.newAfterLineNumber,d.height=u.newHeight}c.push(d)}return c},a=o(this._arr).concat(o(e));a.sort((l,c)=>l.afterLineNumber===c.afterLineNumber?l.ordinal-c.ordinal:l.afterLineNumber-c.afterLineNumber),this._arr=a,this._prefixSumValidIndex=-1}_checkPendingChanges(){this._pendingChanges.mustCommit()&&this._pendingChanges.commit(this)}_insertWhitespace(e){const t=pm.findInsertionIndex(this._arr,e.afterLineNumber,e.ordinal);this._arr.splice(t,0,e),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,t-1)}_findWhitespaceIndex(e){const t=this._arr;for(let i=0,n=t.length;i<n;i++)if(t[i].id===e)return i;return-1}_changeOneWhitespace(e,t,i){const n=this._findWhitespaceIndex(e);if(n!==-1&&(this._arr[n].height!==i&&(this._arr[n].height=i,this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,n-1)),this._arr[n].afterLineNumber!==t)){const r=this._arr[n];this._removeWhitespace(n),r.afterLineNumber=t,this._insertWhitespace(r)}}_removeWhitespace(e){this._arr.splice(e,1),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,e-1)}onLinesDeleted(e,t){this._checkPendingChanges(),e=e|0,t=t|0,this._lineCount-=t-e+1;for(let i=0,n=this._arr.length;i<n;i++){const r=this._arr[i].afterLineNumber;e<=r&&r<=t?this._arr[i].afterLineNumber=e-1:r>t&&(this._arr[i].afterLineNumber-=t-e+1)}}onLinesInserted(e,t){this._checkPendingChanges(),e=e|0,t=t|0,this._lineCount+=t-e+1;for(let i=0,n=this._arr.length;i<n;i++){const r=this._arr[i].afterLineNumber;e<=r&&(this._arr[i].afterLineNumber+=t-e+1)}}getWhitespacesTotalHeight(){return this._checkPendingChanges(),this._arr.length===0?0:this.getWhitespacesAccumulatedHeight(this._arr.length-1)}getWhitespacesAccumulatedHeight(e){this._checkPendingChanges(),e=e|0;let t=Math.max(0,this._prefixSumValidIndex+1);t===0&&(this._arr[0].prefixSum=this._arr[0].height,t++);for(let i=t;i<=e;i++)this._arr[i].prefixSum=this._arr[i-1].prefixSum+this._arr[i].height;return this._prefixSumValidIndex=Math.max(this._prefixSumValidIndex,e),this._arr[e].prefixSum}getLinesTotalHeight(){this._checkPendingChanges();const e=this._lineHeight*this._lineCount,t=this.getWhitespacesTotalHeight();return e+t+this._paddingTop+this._paddingBottom}getWhitespaceAccumulatedHeightBeforeLineNumber(e){this._checkPendingChanges(),e=e|0;const t=this._findLastWhitespaceBeforeLineNumber(e);return t===-1?0:this.getWhitespacesAccumulatedHeight(t)}_findLastWhitespaceBeforeLineNumber(e){e=e|0;const t=this._arr;let i=0,n=t.length-1;for(;i<=n;){const o=(n-i|0)/2|0,a=i+o|0;if(t[a].afterLineNumber<e){if(a+1>=t.length||t[a+1].afterLineNumber>=e)return a;i=a+1|0}else n=a-1|0}return-1}_findFirstWhitespaceAfterLineNumber(e){e=e|0;const i=this._findLastWhitespaceBeforeLineNumber(e)+1;return i<this._arr.length?i:-1}getFirstWhitespaceIndexAfterLineNumber(e){return this._checkPendingChanges(),e=e|0,this._findFirstWhitespaceAfterLineNumber(e)}getVerticalOffsetForLineNumber(e,t=!1){this._checkPendingChanges(),e=e|0;let i;e>1?i=this._lineHeight*(e-1):i=0;const n=this.getWhitespaceAccumulatedHeightBeforeLineNumber(e-(t?1:0));return i+n+this._paddingTop}getVerticalOffsetAfterLineNumber(e,t=!1){this._checkPendingChanges(),e=e|0;const i=this._lineHeight*e,n=this.getWhitespaceAccumulatedHeightBeforeLineNumber(e+(t?1:0));return i+n+this._paddingTop}getWhitespaceMinWidth(){if(this._checkPendingChanges(),this._minWidth===-1){let e=0;for(let t=0,i=this._arr.length;t<i;t++)e=Math.max(e,this._arr[t].minWidth);this._minWidth=e}return this._minWidth}isAfterLines(e){this._checkPendingChanges();const t=this.getLinesTotalHeight();return e>t}isInTopPadding(e){return this._paddingTop===0?!1:(this._checkPendingChanges(),e<this._paddingTop)}isInBottomPadding(e){if(this._paddingBottom===0)return!1;this._checkPendingChanges();const t=this.getLinesTotalHeight();return e>=t-this._paddingBottom}getLineNumberAtOrAfterVerticalOffset(e){if(this._checkPendingChanges(),e=e|0,e<0)return 1;const t=this._lineCount|0,i=this._lineHeight;let n=1,r=t;for(;n<r;){const o=(n+r)/2|0,a=this.getVerticalOffsetForLineNumber(o)|0;if(e>=a+i)n=o+1;else{if(e>=a)return o;r=o}}return n>t?t:n}getLinesViewportData(e,t){this._checkPendingChanges(),e=e|0,t=t|0;const i=this._lineHeight,n=this.getLineNumberAtOrAfterVerticalOffset(e)|0,r=this.getVerticalOffsetForLineNumber(n)|0;let o=this._lineCount|0,a=this.getFirstWhitespaceIndexAfterLineNumber(n)|0;const l=this.getWhitespacesCount()|0;let c,d;a===-1?(a=l,d=o+1,c=0):(d=this.getAfterLineNumberForWhitespaceIndex(a)|0,c=this.getHeightForWhitespaceIndex(a)|0);let u=r,h=u;const g=5e5;let p=0;r>=g&&(p=Math.floor(r/g)*g,p=Math.floor(p/i)*i,h-=p);const _=[],v=e+(t-e)/2;let C=-1;for(let I=n;I<=o;I++){if(C===-1){const A=u,D=u+i;(A<=v&&v<D||A>v)&&(C=I)}for(u+=i,_[I-n]=h,h+=i;d===I;)h+=c,u+=c,a++,a>=l?d=o+1:(d=this.getAfterLineNumberForWhitespaceIndex(a)|0,c=this.getHeightForWhitespaceIndex(a)|0);if(u>=t){o=I;break}}C===-1&&(C=o);const y=this.getVerticalOffsetForLineNumber(o)|0;let x=n,L=o;return x<L&&r<e&&x++,x<L&&y+i>t&&L--,{bigNumbersDelta:p,startLineNumber:n,endLineNumber:o,relativeVerticalOffset:_,centeredLineNumber:C,completelyVisibleStartLineNumber:x,completelyVisibleEndLineNumber:L,lineHeight:this._lineHeight}}getVerticalOffsetForWhitespaceIndex(e){this._checkPendingChanges(),e=e|0;const t=this.getAfterLineNumberForWhitespaceIndex(e);let i;t>=1?i=this._lineHeight*t:i=0;let n;return e>0?n=this.getWhitespacesAccumulatedHeight(e-1):n=0,i+n+this._paddingTop}getWhitespaceIndexAtOrAfterVerticallOffset(e){this._checkPendingChanges(),e=e|0;let t=0,i=this.getWhitespacesCount()-1;if(i<0)return-1;const n=this.getVerticalOffsetForWhitespaceIndex(i),r=this.getHeightForWhitespaceIndex(i);if(e>=n+r)return-1;for(;t<i;){const o=Math.floor((t+i)/2),a=this.getVerticalOffsetForWhitespaceIndex(o),l=this.getHeightForWhitespaceIndex(o);if(e>=a+l)t=o+1;else{if(e>=a)return o;i=o}}return t}getWhitespaceAtVerticalOffset(e){this._checkPendingChanges(),e=e|0;const t=this.getWhitespaceIndexAtOrAfterVerticallOffset(e);if(t<0||t>=this.getWhitespacesCount())return null;const i=this.getVerticalOffsetForWhitespaceIndex(t);if(i>e)return null;const n=this.getHeightForWhitespaceIndex(t),r=this.getIdForWhitespaceIndex(t),o=this.getAfterLineNumberForWhitespaceIndex(t);return{id:r,afterLineNumber:o,verticalOffset:i,height:n}}getWhitespaceViewportData(e,t){this._checkPendingChanges(),e=e|0,t=t|0;const i=this.getWhitespaceIndexAtOrAfterVerticallOffset(e),n=this.getWhitespacesCount()-1;if(i<0)return[];const r=[];for(let o=i;o<=n;o++){const a=this.getVerticalOffsetForWhitespaceIndex(o),l=this.getHeightForWhitespaceIndex(o);if(a>=t)break;r.push({id:this.getIdForWhitespaceIndex(o),afterLineNumber:this.getAfterLineNumberForWhitespaceIndex(o),verticalOffset:a,height:l})}return r}getWhitespaces(){return this._checkPendingChanges(),this._arr.slice(0)}getWhitespacesCount(){return this._checkPendingChanges(),this._arr.length}getIdForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].id}getAfterLineNumberForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].afterLineNumber}getHeightForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].height}},pm.INSTANCE_COUNT=0,pm);const DUe=125;class lL{constructor(e,t,i,n){e=e|0,t=t|0,i=i|0,n=n|0,e<0&&(e=0),t<0&&(t=0),i<0&&(i=0),n<0&&(n=0),this.width=e,this.contentWidth=t,this.scrollWidth=Math.max(e,t),this.height=i,this.contentHeight=n,this.scrollHeight=Math.max(i,n)}equals(e){return this.width===e.width&&this.contentWidth===e.contentWidth&&this.height===e.height&&this.contentHeight===e.contentHeight}}class TUe extends te{constructor(e,t){super(),this._onDidContentSizeChange=this._register(new Z),this.onDidContentSizeChange=this._onDidContentSizeChange.event,this._dimensions=new lL(0,0,0,0),this._scrollable=this._register(new mS({forceIntegerValues:!0,smoothScrollDuration:e,scheduleAtNextAnimationFrame:t})),this.onDidScroll=this._scrollable.onScroll}getScrollable(){return this._scrollable}setSmoothScrollDuration(e){this._scrollable.setSmoothScrollDuration(e)}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}getScrollDimensions(){return this._dimensions}setScrollDimensions(e){if(this._dimensions.equals(e))return;const t=this._dimensions;this._dimensions=e,this._scrollable.setScrollDimensions({width:e.width,scrollWidth:e.scrollWidth,height:e.height,scrollHeight:e.scrollHeight},!0);const i=t.contentWidth!==e.contentWidth,n=t.contentHeight!==e.contentHeight;(i||n)&&this._onDidContentSizeChange.fire(new PG(t.contentWidth,t.contentHeight,e.contentWidth,e.contentHeight))}getFutureScrollPosition(){return this._scrollable.getFutureScrollPosition()}getCurrentScrollPosition(){return this._scrollable.getCurrentScrollPosition()}setScrollPositionNow(e){this._scrollable.setScrollPositionNow(e)}setScrollPositionSmooth(e){this._scrollable.setScrollPositionSmooth(e)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}}class NUe extends te{constructor(e,t,i){super(),this._configuration=e;const n=this._configuration.options,r=n.get(146),o=n.get(84);this._linesLayout=new EUe(t,n.get(67),o.top,o.bottom),this._maxLineWidth=0,this._overlayWidgetsMinWidth=0,this._scrollable=this._register(new TUe(0,i)),this._configureSmoothScrollDuration(),this._scrollable.setScrollDimensions(new lL(r.contentWidth,0,r.height,0)),this.onDidScroll=this._scrollable.onDidScroll,this.onDidContentSizeChange=this._scrollable.onDidContentSizeChange,this._updateHeight()}dispose(){super.dispose()}getScrollable(){return this._scrollable.getScrollable()}onHeightMaybeChanged(){this._updateHeight()}_configureSmoothScrollDuration(){this._scrollable.setSmoothScrollDuration(this._configuration.options.get(115)?DUe:0)}onConfigurationChanged(e){const t=this._configuration.options;if(e.hasChanged(67)&&this._linesLayout.setLineHeight(t.get(67)),e.hasChanged(84)){const i=t.get(84);this._linesLayout.setPadding(i.top,i.bottom)}if(e.hasChanged(146)){const i=t.get(146),n=i.contentWidth,r=i.height,o=this._scrollable.getScrollDimensions(),a=o.contentWidth;this._scrollable.setScrollDimensions(new lL(n,o.contentWidth,r,this._getContentHeight(n,r,a)))}else this._updateHeight();e.hasChanged(115)&&this._configureSmoothScrollDuration()}onFlushed(e){this._linesLayout.onFlushed(e)}onLinesDeleted(e,t){this._linesLayout.onLinesDeleted(e,t)}onLinesInserted(e,t){this._linesLayout.onLinesInserted(e,t)}_getHorizontalScrollbarHeight(e,t){const n=this._configuration.options.get(104);return n.horizontal===2||e>=t?0:n.horizontalScrollbarSize}_getContentHeight(e,t,i){const n=this._configuration.options;let r=this._linesLayout.getLinesTotalHeight();return n.get(106)?r+=Math.max(0,t-n.get(67)-n.get(84).bottom):n.get(104).ignoreHorizontalScrollbarInContentHeight||(r+=this._getHorizontalScrollbarHeight(e,i)),r}_updateHeight(){const e=this._scrollable.getScrollDimensions(),t=e.width,i=e.height,n=e.contentWidth;this._scrollable.setScrollDimensions(new lL(t,e.contentWidth,i,this._getContentHeight(t,i,n)))}getCurrentViewport(){const e=this._scrollable.getScrollDimensions(),t=this._scrollable.getCurrentScrollPosition();return new pse(t.scrollTop,t.scrollLeft,e.width,e.height)}getFutureViewport(){const e=this._scrollable.getScrollDimensions(),t=this._scrollable.getFutureScrollPosition();return new pse(t.scrollTop,t.scrollLeft,e.width,e.height)}_computeContentWidth(){const e=this._configuration.options,t=this._maxLineWidth,i=e.get(147),n=e.get(50),r=e.get(146);if(i.isViewportWrapping){const o=e.get(73);return t>r.contentWidth+n.typicalHalfwidthCharacterWidth&&o.enabled&&o.side==="right"?t+r.verticalScrollbarWidth:t}else{const o=e.get(105)*n.typicalHalfwidthCharacterWidth,a=this._linesLayout.getWhitespaceMinWidth();return Math.max(t+o+r.verticalScrollbarWidth,a,this._overlayWidgetsMinWidth)}}setMaxLineWidth(e){this._maxLineWidth=e,this._updateContentWidth()}setOverlayWidgetsMinWidth(e){this._overlayWidgetsMinWidth=e,this._updateContentWidth()}_updateContentWidth(){const e=this._scrollable.getScrollDimensions();this._scrollable.setScrollDimensions(new lL(e.width,this._computeContentWidth(),e.height,e.contentHeight)),this._updateHeight()}saveState(){const e=this._scrollable.getFutureScrollPosition(),t=e.scrollTop,i=this._linesLayout.getLineNumberAtOrAfterVerticalOffset(t),n=this._linesLayout.getWhitespaceAccumulatedHeightBeforeLineNumber(i);return{scrollTop:t,scrollTopWithoutViewZones:t-n,scrollLeft:e.scrollLeft}}changeWhitespace(e){const t=this._linesLayout.changeWhitespace(e);return t&&this.onHeightMaybeChanged(),t}getVerticalOffsetForLineNumber(e,t=!1){return this._linesLayout.getVerticalOffsetForLineNumber(e,t)}getVerticalOffsetAfterLineNumber(e,t=!1){return this._linesLayout.getVerticalOffsetAfterLineNumber(e,t)}isAfterLines(e){return this._linesLayout.isAfterLines(e)}isInTopPadding(e){return this._linesLayout.isInTopPadding(e)}isInBottomPadding(e){return this._linesLayout.isInBottomPadding(e)}getLineNumberAtVerticalOffset(e){return this._linesLayout.getLineNumberAtOrAfterVerticalOffset(e)}getWhitespaceAtVerticalOffset(e){return this._linesLayout.getWhitespaceAtVerticalOffset(e)}getLinesViewportData(){const e=this.getCurrentViewport();return this._linesLayout.getLinesViewportData(e.top,e.top+e.height)}getLinesViewportDataAtScrollTop(e){const t=this._scrollable.getScrollDimensions();return e+t.height>t.scrollHeight&&(e=t.scrollHeight-t.height),e<0&&(e=0),this._linesLayout.getLinesViewportData(e,e+t.height)}getWhitespaceViewportData(){const e=this.getCurrentViewport();return this._linesLayout.getWhitespaceViewportData(e.top,e.top+e.height)}getWhitespaces(){return this._linesLayout.getWhitespaces()}getContentWidth(){return this._scrollable.getScrollDimensions().contentWidth}getScrollWidth(){return this._scrollable.getScrollDimensions().scrollWidth}getContentHeight(){return this._scrollable.getScrollDimensions().contentHeight}getScrollHeight(){return this._scrollable.getScrollDimensions().scrollHeight}getCurrentScrollLeft(){return this._scrollable.getCurrentScrollPosition().scrollLeft}getCurrentScrollTop(){return this._scrollable.getCurrentScrollPosition().scrollTop}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}setScrollPosition(e,t){t===1?this._scrollable.setScrollPositionNow(e):this._scrollable.setScrollPositionSmooth(e)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}deltaScrollNow(e,t){const i=this._scrollable.getCurrentScrollPosition();this._scrollable.setScrollPositionNow({scrollLeft:i.scrollLeft+e,scrollTop:i.scrollTop+t})}}class RUe{constructor(e,t,i,n,r){this.editorId=e,this.model=t,this.configuration=i,this._linesCollection=n,this._coordinatesConverter=r,this._decorationsCache=Object.create(null),this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}_clearCachedModelDecorationsResolver(){this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}dispose(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}reset(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onModelDecorationsChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onLineMappingChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}_getOrCreateViewModelDecoration(e){const t=e.id;let i=this._decorationsCache[t];if(!i){const n=e.range,r=e.options;let o;if(r.isWholeLine){const a=this._coordinatesConverter.convertModelPositionToViewPosition(new X(n.startLineNumber,1),0,!1,!0),l=this._coordinatesConverter.convertModelPositionToViewPosition(new X(n.endLineNumber,this.model.getLineMaxColumn(n.endLineNumber)),1);o=new F(a.lineNumber,a.column,l.lineNumber,l.column)}else o=this._coordinatesConverter.convertModelRangeToViewRange(n,1);i=new Bpe(o,r),this._decorationsCache[t]=i}return i}getMinimapDecorationsInRange(e){return this._getDecorationsInRange(e,!0,!1).decorations}getDecorationsViewportData(e){let t=this._cachedModelDecorationsResolver!==null;return t=t&&e.equalsRange(this._cachedModelDecorationsResolverViewRange),t||(this._cachedModelDecorationsResolver=this._getDecorationsInRange(e,!1,!1),this._cachedModelDecorationsResolverViewRange=e),this._cachedModelDecorationsResolver}getInlineDecorationsOnLine(e,t=!1,i=!1){const n=new F(e,this._linesCollection.getViewLineMinColumn(e),e,this._linesCollection.getViewLineMaxColumn(e));return this._getDecorationsInRange(n,t,i).inlineDecorations[0]}_getDecorationsInRange(e,t,i){const n=this._linesCollection.getDecorationsInRange(e,this.editorId,N2(this.configuration.options),t,i),r=e.startLineNumber,o=e.endLineNumber,a=[];let l=0;const c=[];for(let d=r;d<=o;d++)c[d-r]=[];for(let d=0,u=n.length;d<u;d++){const h=n[d],g=h.options;if(!FG(this.model,h))continue;const p=this._getOrCreateViewModelDecoration(h),_=p.range;if(a[l++]=p,g.inlineClassName){const v=new KL(_,g.inlineClassName,g.inlineClassNameAffectsLetterSpacing?3:0),C=Math.max(r,_.startLineNumber),y=Math.min(o,_.endLineNumber);for(let x=C;x<=y;x++)c[x-r].push(v)}if(g.beforeContentClassName&&r<=_.startLineNumber&&_.startLineNumber<=o){const v=new KL(new F(_.startLineNumber,_.startColumn,_.startLineNumber,_.startColumn),g.beforeContentClassName,1);c[_.startLineNumber-r].push(v)}if(g.afterContentClassName&&r<=_.endLineNumber&&_.endLineNumber<=o){const v=new KL(new F(_.endLineNumber,_.endColumn,_.endLineNumber,_.endColumn),g.afterContentClassName,2);c[_.endLineNumber-r].push(v)}}return{decorations:a,inlineDecorations:c}}}function FG(s,e){return!(e.options.hideInCommentTokens&&VG(s,e)||e.options.hideInStringTokens&&BG(s,e))}function VG(s,e){return lme(s,e.range,t=>t===1)}function BG(s,e){return lme(s,e.range,t=>t===2)}function lme(s,e,t){for(let i=e.startLineNumber;i<=e.endLineNumber;i++){const n=s.tokenization.getLineTokens(i),r=i===e.startLineNumber,o=i===e.endLineNumber;let a=r?n.findTokenIndexAtOffset(e.startColumn-1):0;for(;a<n.getCount()&&!(o&&n.getStartOffset(a)>e.endColumn-1);){if(!t(n.getStandardTokenType(a)))return!1;a++}}return!0}function hB(s,e){return s===null?e?pP.INSTANCE:mP.INSTANCE:new AUe(s,e)}class AUe{constructor(e,t){this._projectionData=e,this._isVisible=t}isVisible(){return this._isVisible}setVisible(e){return this._isVisible=e,this}getProjectionData(){return this._projectionData}getViewLineCount(){return this._isVisible?this._projectionData.getOutputLineCount():0}getViewLineContent(e,t,i){this._assertVisible();const n=i>0?this._projectionData.breakOffsets[i-1]:0,r=this._projectionData.breakOffsets[i];let o;if(this._projectionData.injectionOffsets!==null){const a=this._projectionData.injectionOffsets.map((c,d)=>new fu(0,0,c+1,this._projectionData.injectionOptions[d],0));o=fu.applyInjectedText(e.getLineContent(t),a).substring(n,r)}else o=e.getValueInRange({startLineNumber:t,startColumn:n+1,endLineNumber:t,endColumn:r+1});return i>0&&(o=$se(this._projectionData.wrappedTextIndentLength)+o),o}getViewLineLength(e,t,i){return this._assertVisible(),this._projectionData.getLineLength(i)}getViewLineMinColumn(e,t,i){return this._assertVisible(),this._projectionData.getMinOutputOffset(i)+1}getViewLineMaxColumn(e,t,i){return this._assertVisible(),this._projectionData.getMaxOutputOffset(i)+1}getViewLineData(e,t,i){const n=new Array;return this.getViewLinesData(e,t,i,1,0,[!0],n),n[0]}getViewLinesData(e,t,i,n,r,o,a){this._assertVisible();const l=this._projectionData,c=l.injectionOffsets,d=l.injectionOptions;let u=null;if(c){u=[];let g=0,p=0;for(let _=0;_<l.getOutputLineCount();_++){const v=new Array;u[_]=v;const C=_>0?l.breakOffsets[_-1]:0,y=l.breakOffsets[_];for(;p<c.length;){const x=d[p].content.length,L=c[p]+g,I=L+x;if(L>y)break;if(C<I){const A=d[p];if(A.inlineClassName){const D=_>0?l.wrappedTextIndentLength:0,N=D+Math.max(L-C,0),R=D+Math.min(I-C,y-C);N!==R&&v.push(new I8e(N,R,A.inlineClassName,A.inlineClassNameAffectsLetterSpacing))}}if(I<=y)g+=x,p++;else break}}}let h;c?h=e.tokenization.getLineTokens(t).withInserted(c.map((g,p)=>({offset:g,text:d[p].content,tokenMetadata:Ws.defaultTokenMetadata}))):h=e.tokenization.getLineTokens(t);for(let g=i;g<i+n;g++){const p=r+g-i;if(!o[p]){a[p]=null;continue}a[p]=this._getViewLineData(h,u?u[g]:null,g)}}_getViewLineData(e,t,i){this._assertVisible();const n=this._projectionData,r=i>0?n.wrappedTextIndentLength:0,o=i>0?n.breakOffsets[i-1]:0,a=n.breakOffsets[i],l=e.sliceAndInflate(o,a,r);let c=l.getLineContent();i>0&&(c=$se(n.wrappedTextIndentLength)+c);const d=this._projectionData.getMinOutputOffset(i)+1,u=c.length+1,h=i+1<this.getViewLineCount(),g=i===0?0:n.breakOffsetsVisibleColumn[i-1];return new bG(c,h,d,u,g,l,t)}getModelColumnOfViewPosition(e,t){return this._assertVisible(),this._projectionData.translateToInputOffset(e,t-1)+1}getViewPositionOfModelPosition(e,t,i=2){return this._assertVisible(),this._projectionData.translateToOutputPosition(t-1,i).toPosition(e)}getViewLineNumberOfModelPosition(e,t){this._assertVisible();const i=this._projectionData.translateToOutputPosition(t-1);return e+i.outputLineIndex}normalizePosition(e,t,i){const n=t.lineNumber-e;return this._projectionData.normalizeOutputPosition(e,t.column-1,i).toPosition(n)}getInjectedTextAt(e,t){return this._projectionData.getInjectedText(e,t-1)}_assertVisible(){if(!this._isVisible)throw new Error("Not supported")}}const mO=class mO{constructor(){}isVisible(){return!0}setVisible(e){return e?this:mP.INSTANCE}getProjectionData(){return null}getViewLineCount(){return 1}getViewLineContent(e,t,i){return e.getLineContent(t)}getViewLineLength(e,t,i){return e.getLineLength(t)}getViewLineMinColumn(e,t,i){return e.getLineMinColumn(t)}getViewLineMaxColumn(e,t,i){return e.getLineMaxColumn(t)}getViewLineData(e,t,i){const n=e.tokenization.getLineTokens(t),r=n.getLineContent();return new bG(r,!1,1,r.length+1,0,n.inflate(),null)}getViewLinesData(e,t,i,n,r,o,a){if(!o[r]){a[r]=null;return}a[r]=this.getViewLineData(e,t,0)}getModelColumnOfViewPosition(e,t){return t}getViewPositionOfModelPosition(e,t){return new X(e,t)}getViewLineNumberOfModelPosition(e,t){return e}normalizePosition(e,t,i){return t}getInjectedTextAt(e,t){return null}};mO.INSTANCE=new mO;let pP=mO;const _O=class _O{constructor(){}isVisible(){return!1}setVisible(e){return e?pP.INSTANCE:this}getProjectionData(){return null}getViewLineCount(){return 0}getViewLineContent(e,t,i){throw new Error("Not supported")}getViewLineLength(e,t,i){throw new Error("Not supported")}getViewLineMinColumn(e,t,i){throw new Error("Not supported")}getViewLineMaxColumn(e,t,i){throw new Error("Not supported")}getViewLineData(e,t,i){throw new Error("Not supported")}getViewLinesData(e,t,i,n,r,o,a){throw new Error("Not supported")}getModelColumnOfViewPosition(e,t){throw new Error("Not supported")}getViewPositionOfModelPosition(e,t){throw new Error("Not supported")}getViewLineNumberOfModelPosition(e,t){throw new Error("Not supported")}normalizePosition(e,t,i){throw new Error("Not supported")}getInjectedTextAt(e,t){throw new Error("Not supported")}};_O.INSTANCE=new _O;let mP=_O;const fB=[""];function $se(s){if(s>=fB.length)for(let e=1;e<=s;e++)fB[e]=PUe(e);return fB[s]}function PUe(s){return new Array(s+1).join(" ")}class MUe{constructor(e,t,i,n,r,o,a,l,c,d){this._editorId=e,this.model=t,this._validModelVersionId=-1,this._domLineBreaksComputerFactory=i,this._monospaceLineBreaksComputerFactory=n,this.fontInfo=r,this.tabSize=o,this.wrappingStrategy=a,this.wrappingColumn=l,this.wrappingIndent=c,this.wordBreak=d,this._constructLines(!0,null)}dispose(){this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[])}createCoordinatesConverter(){return new FUe(this)}_constructLines(e,t){this.modelLineProjections=[],e&&(this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[]));const i=this.model.getLinesContent(),n=this.model.getInjectedTextDecorations(this._editorId),r=i.length,o=this.createLineBreaksComputer(),a=new Cg(fu.fromDecorations(n));for(let _=0;_<r;_++){const v=a.takeWhile(C=>C.lineNumber===_+1);o.addRequest(i[_],v,t?t[_]:null)}const l=o.finalize(),c=[],d=this.hiddenAreasDecorationIds.map(_=>this.model.getDecorationRange(_)).sort(F.compareRangesUsingStarts);let u=1,h=0,g=-1,p=g+1<d.length?h+1:r+2;for(let _=0;_<r;_++){const v=_+1;v===p&&(g++,u=d[g].startLineNumber,h=d[g].endLineNumber,p=g+1<d.length?h+1:r+2);const C=v>=u&&v<=h,y=hB(l[_],!C);c[_]=y.getViewLineCount(),this.modelLineProjections[_]=y}this._validModelVersionId=this.model.getVersionId(),this.projectedModelLineLineCounts=new YMe(c)}getHiddenAreas(){return this.hiddenAreasDecorationIds.map(e=>this.model.getDecorationRange(e))}setHiddenAreas(e){const t=e.map(h=>this.model.validateRange(h)),i=OUe(t),n=this.hiddenAreasDecorationIds.map(h=>this.model.getDecorationRange(h)).sort(F.compareRangesUsingStarts);if(i.length===n.length){let h=!1;for(let g=0;g<i.length;g++)if(!i[g].equalsRange(n[g])){h=!0;break}if(!h)return!1}const r=i.map(h=>({range:h,options:_t.EMPTY}));this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,r);const o=i;let a=1,l=0,c=-1,d=c+1<o.length?l+1:this.modelLineProjections.length+2,u=!1;for(let h=0;h<this.modelLineProjections.length;h++){const g=h+1;g===d&&(c++,a=o[c].startLineNumber,l=o[c].endLineNumber,d=c+1<o.length?l+1:this.modelLineProjections.length+2);let p=!1;if(g>=a&&g<=l?this.modelLineProjections[h].isVisible()&&(this.modelLineProjections[h]=this.modelLineProjections[h].setVisible(!1),p=!0):(u=!0,this.modelLineProjections[h].isVisible()||(this.modelLineProjections[h]=this.modelLineProjections[h].setVisible(!0),p=!0)),p){const _=this.modelLineProjections[h].getViewLineCount();this.projectedModelLineLineCounts.setValue(h,_)}}return u||this.setHiddenAreas([]),!0}modelPositionIsVisible(e,t){return e<1||e>this.modelLineProjections.length?!1:this.modelLineProjections[e-1].isVisible()}getModelLineViewLineCount(e){return e<1||e>this.modelLineProjections.length?1:this.modelLineProjections[e-1].getViewLineCount()}setTabSize(e){return this.tabSize===e?!1:(this.tabSize=e,this._constructLines(!1,null),!0)}setWrappingSettings(e,t,i,n,r){const o=this.fontInfo.equals(e),a=this.wrappingStrategy===t,l=this.wrappingColumn===i,c=this.wrappingIndent===n,d=this.wordBreak===r;if(o&&a&&l&&c&&d)return!1;const u=o&&a&&!l&&c&&d;this.fontInfo=e,this.wrappingStrategy=t,this.wrappingColumn=i,this.wrappingIndent=n,this.wordBreak=r;let h=null;if(u){h=[];for(let g=0,p=this.modelLineProjections.length;g<p;g++)h[g]=this.modelLineProjections[g].getProjectionData()}return this._constructLines(!1,h),!0}createLineBreaksComputer(){return(this.wrappingStrategy==="advanced"?this._domLineBreaksComputerFactory:this._monospaceLineBreaksComputerFactory).createLineBreaksComputer(this.fontInfo,this.tabSize,this.wrappingColumn,this.wrappingIndent,this.wordBreak)}onModelFlushed(){this._constructLines(!0,null)}onModelLinesDeleted(e,t,i){if(!e||e<=this._validModelVersionId)return null;const n=t===1?1:this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,r=this.projectedModelLineLineCounts.getPrefixSum(i);return this.modelLineProjections.splice(t-1,i-t+1),this.projectedModelLineLineCounts.removeValues(t-1,i-t+1),new $H(n,r)}onModelLinesInserted(e,t,i,n){if(!e||e<=this._validModelVersionId)return null;const r=t>2&&!this.modelLineProjections[t-2].isVisible(),o=t===1?1:this.projectedModelLineLineCounts.getPrefixSum(t-1)+1;let a=0;const l=[],c=[];for(let d=0,u=n.length;d<u;d++){const h=hB(n[d],!r);l.push(h);const g=h.getViewLineCount();a+=g,c[d]=g}return this.modelLineProjections=this.modelLineProjections.slice(0,t-1).concat(l).concat(this.modelLineProjections.slice(t-1)),this.projectedModelLineLineCounts.insertValues(t-1,c),new qH(o,o+a-1)}onModelLineChanged(e,t,i){if(e!==null&&e<=this._validModelVersionId)return[!1,null,null,null];const n=t-1,r=this.modelLineProjections[n].getViewLineCount(),o=this.modelLineProjections[n].isVisible(),a=hB(i,o);this.modelLineProjections[n]=a;const l=this.modelLineProjections[n].getViewLineCount();let c=!1,d=0,u=-1,h=0,g=-1,p=0,_=-1;r>l?(d=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,u=d+l-1,p=u+1,_=p+(r-l)-1,c=!0):r<l?(d=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,u=d+r-1,h=u+1,g=h+(l-r)-1,c=!0):(d=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,u=d+l-1),this.projectedModelLineLineCounts.setValue(n,l);const v=d<=u?new ame(d,u-d+1):null,C=h<=g?new qH(h,g):null,y=p<=_?new $H(p,_):null;return[c,v,C,y]}acceptVersionId(e){this._validModelVersionId=e,this.modelLineProjections.length===1&&!this.modelLineProjections[0].isVisible()&&this.setHiddenAreas([])}getViewLineCount(){return this.projectedModelLineLineCounts.getTotalSum()}_toValidViewLineNumber(e){if(e<1)return 1;const t=this.getViewLineCount();return e>t?t:e|0}getActiveIndentGuide(e,t,i){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t),i=this._toValidViewLineNumber(i);const n=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),r=this.convertViewPositionToModelPosition(t,this.getViewLineMinColumn(t)),o=this.convertViewPositionToModelPosition(i,this.getViewLineMinColumn(i)),a=this.model.guides.getActiveIndentGuide(n.lineNumber,r.lineNumber,o.lineNumber),l=this.convertModelPositionToViewPosition(a.startLineNumber,1),c=this.convertModelPositionToViewPosition(a.endLineNumber,this.model.getLineMaxColumn(a.endLineNumber));return{startLineNumber:l.lineNumber,endLineNumber:c.lineNumber,indent:a.indent}}getViewLineInfo(e){e=this._toValidViewLineNumber(e);const t=this.projectedModelLineLineCounts.getIndexOf(e-1),i=t.index,n=t.remainder;return new qse(i+1,n)}getMinColumnOfViewLine(e){return this.modelLineProjections[e.modelLineNumber-1].getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getMaxColumnOfViewLine(e){return this.modelLineProjections[e.modelLineNumber-1].getViewLineMaxColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getModelStartPositionOfViewLine(e){const t=this.modelLineProjections[e.modelLineNumber-1],i=t.getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx),n=t.getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,i);return new X(e.modelLineNumber,n)}getModelEndPositionOfViewLine(e){const t=this.modelLineProjections[e.modelLineNumber-1],i=t.getViewLineMaxColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx),n=t.getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,i);return new X(e.modelLineNumber,n)}getViewLineInfosGroupedByModelRanges(e,t){const i=this.getViewLineInfo(e),n=this.getViewLineInfo(t),r=new Array;let o=this.getModelStartPositionOfViewLine(i),a=new Array;for(let l=i.modelLineNumber;l<=n.modelLineNumber;l++){const c=this.modelLineProjections[l-1];if(c.isVisible()){const d=l===i.modelLineNumber?i.modelLineWrappedLineIdx:0,u=l===n.modelLineNumber?n.modelLineWrappedLineIdx+1:c.getViewLineCount();for(let h=d;h<u;h++)a.push(new qse(l,h))}if(!c.isVisible()&&o){const d=new X(l-1,this.model.getLineMaxColumn(l-1)+1),u=F.fromPositions(o,d);r.push(new Kse(u,a)),a=[],o=null}else c.isVisible()&&!o&&(o=new X(l,1))}if(o){const l=F.fromPositions(o,this.getModelEndPositionOfViewLine(n));r.push(new Kse(l,a))}return r}getViewLinesBracketGuides(e,t,i,n){const r=i?this.convertViewPositionToModelPosition(i.lineNumber,i.column):null,o=[];for(const a of this.getViewLineInfosGroupedByModelRanges(e,t)){const l=a.modelRange.startLineNumber,c=this.model.guides.getLinesBracketGuides(l,a.modelRange.endLineNumber,r,n);for(const d of a.viewLines){const h=c[d.modelLineNumber-l].map(g=>{if(g.forWrappedLinesAfterColumn!==-1&&this.modelLineProjections[d.modelLineNumber-1].getViewPositionOfModelPosition(0,g.forWrappedLinesAfterColumn).lineNumber>=d.modelLineWrappedLineIdx||g.forWrappedLinesBeforeOrAtColumn!==-1&&this.modelLineProjections[d.modelLineNumber-1].getViewPositionOfModelPosition(0,g.forWrappedLinesBeforeOrAtColumn).lineNumber<d.modelLineWrappedLineIdx)return;if(!g.horizontalLine)return g;let p=-1;if(g.column!==-1){const C=this.modelLineProjections[d.modelLineNumber-1].getViewPositionOfModelPosition(0,g.column);if(C.lineNumber===d.modelLineWrappedLineIdx)p=C.column;else if(C.lineNumber<d.modelLineWrappedLineIdx)p=this.getMinColumnOfViewLine(d);else if(C.lineNumber>d.modelLineWrappedLineIdx)return}const _=this.convertModelPositionToViewPosition(d.modelLineNumber,g.horizontalLine.endColumn),v=this.modelLineProjections[d.modelLineNumber-1].getViewPositionOfModelPosition(0,g.horizontalLine.endColumn);return v.lineNumber===d.modelLineWrappedLineIdx?new Wb(g.visibleColumn,p,g.className,new VL(g.horizontalLine.top,_.column),-1,-1):v.lineNumber<d.modelLineWrappedLineIdx||g.visibleColumn!==-1?void 0:new Wb(g.visibleColumn,p,g.className,new VL(g.horizontalLine.top,this.getMaxColumnOfViewLine(d)),-1,-1)});o.push(h.filter(g=>!!g))}}return o}getViewLinesIndentGuides(e,t){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);const i=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),n=this.convertViewPositionToModelPosition(t,this.getViewLineMaxColumn(t));let r=[];const o=[],a=[],l=i.lineNumber-1,c=n.lineNumber-1;let d=null;for(let p=l;p<=c;p++){const _=this.modelLineProjections[p];if(_.isVisible()){const v=_.getViewLineNumberOfModelPosition(0,p===l?i.column:1),C=_.getViewLineNumberOfModelPosition(0,this.model.getLineMaxColumn(p+1)),y=C-v+1;let x=0;y>1&&_.getViewLineMinColumn(this.model,p+1,C)===1&&(x=v===0?1:2),o.push(y),a.push(x),d===null&&(d=new X(p+1,0))}else d!==null&&(r=r.concat(this.model.guides.getLinesIndentGuides(d.lineNumber,p)),d=null)}d!==null&&(r=r.concat(this.model.guides.getLinesIndentGuides(d.lineNumber,n.lineNumber)),d=null);const u=t-e+1,h=new Array(u);let g=0;for(let p=0,_=r.length;p<_;p++){let v=r[p];const C=Math.min(u-g,o[p]),y=a[p];let x;y===2?x=0:y===1?x=1:x=C;for(let L=0;L<C;L++)L===x&&(v=0),h[g++]=v}return h}getViewLineContent(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineContent(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineLength(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineLength(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineMinColumn(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineMinColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineMaxColumn(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineMaxColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineData(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineData(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLinesData(e,t,i){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);const n=this.projectedModelLineLineCounts.getIndexOf(e-1);let r=e;const o=n.index,a=n.remainder,l=[];for(let c=o,d=this.model.getLineCount();c<d;c++){const u=this.modelLineProjections[c];if(!u.isVisible())continue;const h=c===o?a:0;let g=u.getViewLineCount()-h,p=!1;if(r+g>t&&(p=!0,g=t-r+1),u.getViewLinesData(this.model,c+1,h,g,r-e,i,l),r+=g,p)break}return l}validateViewPosition(e,t,i){e=this._toValidViewLineNumber(e);const n=this.projectedModelLineLineCounts.getIndexOf(e-1),r=n.index,o=n.remainder,a=this.modelLineProjections[r],l=a.getViewLineMinColumn(this.model,r+1,o),c=a.getViewLineMaxColumn(this.model,r+1,o);t<l&&(t=l),t>c&&(t=c);const d=a.getModelColumnOfViewPosition(o,t);return this.model.validatePosition(new X(r+1,d)).equals(i)?new X(e,t):this.convertModelPositionToViewPosition(i.lineNumber,i.column)}validateViewRange(e,t){const i=this.validateViewPosition(e.startLineNumber,e.startColumn,t.getStartPosition()),n=this.validateViewPosition(e.endLineNumber,e.endColumn,t.getEndPosition());return new F(i.lineNumber,i.column,n.lineNumber,n.column)}convertViewPositionToModelPosition(e,t){const i=this.getViewLineInfo(e),n=this.modelLineProjections[i.modelLineNumber-1].getModelColumnOfViewPosition(i.modelLineWrappedLineIdx,t);return this.model.validatePosition(new X(i.modelLineNumber,n))}convertViewRangeToModelRange(e){const t=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),i=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);return new F(t.lineNumber,t.column,i.lineNumber,i.column)}convertModelPositionToViewPosition(e,t,i=2,n=!1,r=!1){const o=this.model.validatePosition(new X(e,t)),a=o.lineNumber,l=o.column;let c=a-1,d=!1;if(r)for(;c<this.modelLineProjections.length&&!this.modelLineProjections[c].isVisible();)c++,d=!0;else for(;c>0&&!this.modelLineProjections[c].isVisible();)c--,d=!0;if(c===0&&!this.modelLineProjections[c].isVisible())return new X(n?0:1,1);const u=1+this.projectedModelLineLineCounts.getPrefixSum(c);let h;return d?r?h=this.modelLineProjections[c].getViewPositionOfModelPosition(u,1,i):h=this.modelLineProjections[c].getViewPositionOfModelPosition(u,this.model.getLineMaxColumn(c+1),i):h=this.modelLineProjections[a-1].getViewPositionOfModelPosition(u,l,i),h}convertModelRangeToViewRange(e,t=0){if(e.isEmpty()){const i=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn,t);return F.fromPositions(i)}else{const i=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn,1),n=this.convertModelPositionToViewPosition(e.endLineNumber,e.endColumn,0);return new F(i.lineNumber,i.column,n.lineNumber,n.column)}}getViewLineNumberOfModelPosition(e,t){let i=e-1;if(this.modelLineProjections[i].isVisible()){const r=1+this.projectedModelLineLineCounts.getPrefixSum(i);return this.modelLineProjections[i].getViewLineNumberOfModelPosition(r,t)}for(;i>0&&!this.modelLineProjections[i].isVisible();)i--;if(i===0&&!this.modelLineProjections[i].isVisible())return 1;const n=1+this.projectedModelLineLineCounts.getPrefixSum(i);return this.modelLineProjections[i].getViewLineNumberOfModelPosition(n,this.model.getLineMaxColumn(i+1))}getDecorationsInRange(e,t,i,n,r){const o=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),a=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);if(a.lineNumber-o.lineNumber<=e.endLineNumber-e.startLineNumber)return this.model.getDecorationsInRange(new F(o.lineNumber,1,a.lineNumber,a.column),t,i,n,r);let l=[];const c=o.lineNumber-1,d=a.lineNumber-1;let u=null;for(let _=c;_<=d;_++)if(this.modelLineProjections[_].isVisible())u===null&&(u=new X(_+1,_===c?o.column:1));else if(u!==null){const C=this.model.getLineMaxColumn(_);l=l.concat(this.model.getDecorationsInRange(new F(u.lineNumber,u.column,_,C),t,i,n)),u=null}u!==null&&(l=l.concat(this.model.getDecorationsInRange(new F(u.lineNumber,u.column,a.lineNumber,a.column),t,i,n)),u=null),l.sort((_,v)=>{const C=F.compareRangesUsingStarts(_.range,v.range);return C===0?_.id<v.id?-1:_.id>v.id?1:0:C});const h=[];let g=0,p=null;for(const _ of l){const v=_.id;p!==v&&(p=v,h[g++]=_)}return h}getInjectedTextAt(e){const t=this.getViewLineInfo(e.lineNumber);return this.modelLineProjections[t.modelLineNumber-1].getInjectedTextAt(t.modelLineWrappedLineIdx,e.column)}normalizePosition(e,t){const i=this.getViewLineInfo(e.lineNumber);return this.modelLineProjections[i.modelLineNumber-1].normalizePosition(i.modelLineWrappedLineIdx,e,t)}getLineIndentColumn(e){const t=this.getViewLineInfo(e);return t.modelLineWrappedLineIdx===0?this.model.getLineIndentColumn(t.modelLineNumber):0}}function OUe(s){if(s.length===0)return[];const e=s.slice();e.sort(F.compareRangesUsingStarts);const t=[];let i=e[0].startLineNumber,n=e[0].endLineNumber;for(let r=1,o=e.length;r<o;r++){const a=e[r];a.startLineNumber>n+1?(t.push(new F(i,1,n,1)),i=a.startLineNumber,n=a.endLineNumber):a.endLineNumber>n&&(n=a.endLineNumber)}return t.push(new F(i,1,n,1)),t}class qse{constructor(e,t){this.modelLineNumber=e,this.modelLineWrappedLineIdx=t}}class Kse{constructor(e,t){this.modelRange=e,this.viewLines=t}}class FUe{constructor(e){this._lines=e}convertViewPositionToModelPosition(e){return this._lines.convertViewPositionToModelPosition(e.lineNumber,e.column)}convertViewRangeToModelRange(e){return this._lines.convertViewRangeToModelRange(e)}validateViewPosition(e,t){return this._lines.validateViewPosition(e.lineNumber,e.column,t)}validateViewRange(e,t){return this._lines.validateViewRange(e,t)}convertModelPositionToViewPosition(e,t,i,n){return this._lines.convertModelPositionToViewPosition(e.lineNumber,e.column,t,i,n)}convertModelRangeToViewRange(e,t){return this._lines.convertModelRangeToViewRange(e,t)}modelPositionIsVisible(e){return this._lines.modelPositionIsVisible(e.lineNumber,e.column)}getModelLineViewLineCount(e){return this._lines.getModelLineViewLineCount(e)}getViewLineNumberOfModelPosition(e,t){return this._lines.getViewLineNumberOfModelPosition(e,t)}}class VUe{constructor(e){this.model=e}dispose(){}createCoordinatesConverter(){return new BUe(this)}getHiddenAreas(){return[]}setHiddenAreas(e){return!1}setTabSize(e){return!1}setWrappingSettings(e,t,i,n){return!1}createLineBreaksComputer(){const e=[];return{addRequest:(t,i,n)=>{e.push(null)},finalize:()=>e}}onModelFlushed(){}onModelLinesDeleted(e,t,i){return new $H(t,i)}onModelLinesInserted(e,t,i,n){return new qH(t,i)}onModelLineChanged(e,t,i){return[!1,new ame(t,1),null,null]}acceptVersionId(e){}getViewLineCount(){return this.model.getLineCount()}getActiveIndentGuide(e,t,i){return{startLineNumber:e,endLineNumber:e,indent:0}}getViewLinesBracketGuides(e,t,i){return new Array(t-e+1).fill([])}getViewLinesIndentGuides(e,t){const i=t-e+1,n=new Array(i);for(let r=0;r<i;r++)n[r]=0;return n}getViewLineContent(e){return this.model.getLineContent(e)}getViewLineLength(e){return this.model.getLineLength(e)}getViewLineMinColumn(e){return this.model.getLineMinColumn(e)}getViewLineMaxColumn(e){return this.model.getLineMaxColumn(e)}getViewLineData(e){const t=this.model.tokenization.getLineTokens(e),i=t.getLineContent();return new bG(i,!1,1,i.length+1,0,t.inflate(),null)}getViewLinesData(e,t,i){const n=this.model.getLineCount();e=Math.min(Math.max(1,e),n),t=Math.min(Math.max(1,t),n);const r=[];for(let o=e;o<=t;o++){const a=o-e;r[a]=i[a]?this.getViewLineData(o):null}return r}getDecorationsInRange(e,t,i,n,r){return this.model.getDecorationsInRange(e,t,i,n,r)}normalizePosition(e,t){return this.model.normalizePosition(e,t)}getLineIndentColumn(e){return this.model.getLineIndentColumn(e)}getInjectedTextAt(e){return null}}class BUe{constructor(e){this._lines=e}_validPosition(e){return this._lines.model.validatePosition(e)}_validRange(e){return this._lines.model.validateRange(e)}convertViewPositionToModelPosition(e){return this._validPosition(e)}convertViewRangeToModelRange(e){return this._validRange(e)}validateViewPosition(e,t){return this._validPosition(t)}validateViewRange(e,t){return this._validRange(t)}convertModelPositionToViewPosition(e){return this._validPosition(e)}convertModelRangeToViewRange(e){return this._validRange(e)}modelPositionIsVisible(e){const t=this._lines.model.getLineCount();return!(e.lineNumber<1||e.lineNumber>t)}getModelLineViewLineCount(e){return 1}getViewLineNumberOfModelPosition(e,t){return e}}const X_=ld.Right;class WUe{constructor(e){this.persist=0,this._requiredLanes=1,this.lanes=new Uint8Array(Math.ceil((e+1)*X_/8))}reset(e){const t=Math.ceil((e+1)*X_/8);this.lanes.length<t?this.lanes=new Uint8Array(t):this.lanes.fill(0),this._requiredLanes=1}get requiredLanes(){return this._requiredLanes}push(e,t,i){i&&(this.persist|=1<<e-1);for(let n=t.startLineNumber;n<=t.endLineNumber;n++){const r=X_*n+(e-1);this.lanes[r>>>3]|=1<<r%8,this._requiredLanes=Math.max(this._requiredLanes,this.countAtLine(n))}}getLanesAtLine(e){const t=[];let i=X_*e;for(let n=0;n<X_;n++)(this.persist&1<<n||this.lanes[i>>>3]&1<<i%8)&&t.push(n+1),i++;return t.length?t:[ld.Center]}countAtLine(e){let t=X_*e,i=0;for(let n=0;n<X_;n++)(this.persist&1<<n||this.lanes[t>>>3]&1<<t%8)&&i++,t++;return i}}let HUe=class extends te{constructor(e,t,i,n,r,o,a,l,c,d){if(super(),this.languageConfigurationService=a,this._themeService=l,this._attachedView=c,this._transactionalTarget=d,this.hiddenAreasModel=new UUe,this.previousHiddenAreas=[],this._editorId=e,this._configuration=t,this.model=i,this._eventDispatcher=new hUe,this.onEvent=this._eventDispatcher.onEvent,this.cursorConfig=new Q0(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._updateConfigurationViewLineCount=this._register(new xi(()=>this._updateConfigurationViewLineCountNow(),0)),this._hasFocus=!1,this._viewportStart=WG.create(this.model),this.glyphLanes=new WUe(0),this.model.isTooLargeForTokenization())this._lines=new VUe(this.model);else{const u=this._configuration.options,h=u.get(50),g=u.get(140),p=u.get(147),_=u.get(139),v=u.get(130);this._lines=new MUe(this._editorId,this.model,n,r,h,this.model.getOptions().tabSize,g,p.wrappingColumn,_,v)}this.coordinatesConverter=this._lines.createCoordinatesConverter(),this._cursor=this._register(new SUe(i,this,this.coordinatesConverter,this.cursorConfig)),this.viewLayout=this._register(new NUe(this._configuration,this.getLineCount(),o)),this._register(this.viewLayout.onDidScroll(u=>{u.scrollTopChanged&&this._handleVisibleLinesChanged(),u.scrollTopChanged&&this._viewportStart.invalidate(),this._eventDispatcher.emitSingleViewEvent(new aUe(u)),this._eventDispatcher.emitOutgoingEvent(new OG(u.oldScrollWidth,u.oldScrollLeft,u.oldScrollHeight,u.oldScrollTop,u.scrollWidth,u.scrollLeft,u.scrollHeight,u.scrollTop))})),this._register(this.viewLayout.onDidContentSizeChange(u=>{this._eventDispatcher.emitOutgoingEvent(u)})),this._decorations=new RUe(this._editorId,this.model,this._configuration,this._lines,this.coordinatesConverter),this._registerModelEvents(),this._register(this._configuration.onDidChangeFast(u=>{try{const h=this._eventDispatcher.beginEmitViewEvents();this._onConfigurationChanged(h,u)}finally{this._eventDispatcher.endEmitViewEvents()}})),this._register(uP.getInstance().onDidChange(()=>{this._eventDispatcher.emitSingleViewEvent(new dUe)})),this._register(this._themeService.onDidColorThemeChange(u=>{this._invalidateDecorationsColorCache(),this._eventDispatcher.emitSingleViewEvent(new lUe(u))})),this._updateConfigurationViewLineCountNow()}dispose(){super.dispose(),this._decorations.dispose(),this._lines.dispose(),this._viewportStart.dispose(),this._eventDispatcher.dispose()}createLineBreaksComputer(){return this._lines.createLineBreaksComputer()}addViewEventHandler(e){this._eventDispatcher.addViewEventHandler(e)}removeViewEventHandler(e){this._eventDispatcher.removeViewEventHandler(e)}_updateConfigurationViewLineCountNow(){this._configuration.setViewLineCount(this._lines.getViewLineCount())}getModelVisibleRanges(){const e=this.viewLayout.getLinesViewportData(),t=new F(e.startLineNumber,this.getLineMinColumn(e.startLineNumber),e.endLineNumber,this.getLineMaxColumn(e.endLineNumber));return this._toModelVisibleRanges(t)}visibleLinesStabilized(){const e=this.getModelVisibleRanges();this._attachedView.setVisibleLines(e,!0)}_handleVisibleLinesChanged(){const e=this.getModelVisibleRanges();this._attachedView.setVisibleLines(e,!1)}setHasFocus(e){this._hasFocus=e,this._cursor.setHasFocus(e),this._eventDispatcher.emitSingleViewEvent(new rUe(e)),this._eventDispatcher.emitOutgoingEvent(new MG(!e,e))}onCompositionStart(){this._eventDispatcher.emitSingleViewEvent(new tUe)}onCompositionEnd(){this._eventDispatcher.emitSingleViewEvent(new iUe)}_captureStableViewport(){if(this._viewportStart.isValid&&this.viewLayout.getCurrentScrollTop()>0){const e=new X(this._viewportStart.viewLineNumber,this.getLineMinColumn(this._viewportStart.viewLineNumber)),t=this.coordinatesConverter.convertViewPositionToModelPosition(e);return new Qse(t,this._viewportStart.startLineDelta)}return new Qse(null,0)}_onConfigurationChanged(e,t){const i=this._captureStableViewport(),n=this._configuration.options,r=n.get(50),o=n.get(140),a=n.get(147),l=n.get(139),c=n.get(130);this._lines.setWrappingSettings(r,o,a.wrappingColumn,l,c)&&(e.emitViewEvent(new AN),e.emitViewEvent(new PN),e.emitViewEvent(new Y_(null)),this._cursor.onLineMappingChanged(e),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this._updateConfigurationViewLineCount.schedule()),t.hasChanged(92)&&(this._decorations.reset(),e.emitViewEvent(new Y_(null))),t.hasChanged(99)&&(this._decorations.reset(),e.emitViewEvent(new Y_(null))),e.emitViewEvent(new nUe(t)),this.viewLayout.onConfigurationChanged(t),i.recoverViewportStart(this.coordinatesConverter,this.viewLayout),Q0.shouldRecreate(t)&&(this.cursorConfig=new Q0(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig))}_registerModelEvents(){this._register(this.model.onDidChangeContentOrInjectedText(e=>{try{const i=this._eventDispatcher.beginEmitViewEvents();let n=!1,r=!1;const o=e instanceof ev?e.rawContentChangedEvent.changes:e.changes,a=e instanceof ev?e.rawContentChangedEvent.versionId:null,l=this._lines.createLineBreaksComputer();for(const u of o)switch(u.changeType){case 4:{for(let h=0;h<u.detail.length;h++){const g=u.detail[h];let p=u.injectedTexts[h];p&&(p=p.filter(_=>!_.ownerId||_.ownerId===this._editorId)),l.addRequest(g,p,null)}break}case 2:{let h=null;u.injectedText&&(h=u.injectedText.filter(g=>!g.ownerId||g.ownerId===this._editorId)),l.addRequest(u.detail,h,null);break}}const c=l.finalize(),d=new Cg(c);for(const u of o)switch(u.changeType){case 1:{this._lines.onModelFlushed(),i.emitViewEvent(new AN),this._decorations.reset(),this.viewLayout.onFlushed(this.getLineCount()),n=!0;break}case 3:{const h=this._lines.onModelLinesDeleted(a,u.fromLineNumber,u.toLineNumber);h!==null&&(i.emitViewEvent(h),this.viewLayout.onLinesDeleted(h.fromLineNumber,h.toLineNumber)),n=!0;break}case 4:{const h=d.takeCount(u.detail.length),g=this._lines.onModelLinesInserted(a,u.fromLineNumber,u.toLineNumber,h);g!==null&&(i.emitViewEvent(g),this.viewLayout.onLinesInserted(g.fromLineNumber,g.toLineNumber)),n=!0;break}case 2:{const h=d.dequeue(),[g,p,_,v]=this._lines.onModelLineChanged(a,u.lineNumber,h);r=g,p&&i.emitViewEvent(p),_&&(i.emitViewEvent(_),this.viewLayout.onLinesInserted(_.fromLineNumber,_.toLineNumber)),v&&(i.emitViewEvent(v),this.viewLayout.onLinesDeleted(v.fromLineNumber,v.toLineNumber));break}case 5:break}a!==null&&this._lines.acceptVersionId(a),this.viewLayout.onHeightMaybeChanged(),!n&&r&&(i.emitViewEvent(new PN),i.emitViewEvent(new Y_(null)),this._cursor.onLineMappingChanged(i),this._decorations.onLineMappingChanged())}finally{this._eventDispatcher.endEmitViewEvents()}const t=this._viewportStart.isValid;if(this._viewportStart.invalidate(),this._configuration.setModelLineCount(this.model.getLineCount()),this._updateConfigurationViewLineCountNow(),!this._hasFocus&&this.model.getAttachedEditorCount()>=2&&t){const i=this.model._getTrackedRange(this._viewportStart.modelTrackedRange);if(i){const n=this.coordinatesConverter.convertModelPositionToViewPosition(i.getStartPosition()),r=this.viewLayout.getVerticalOffsetForLineNumber(n.lineNumber);this.viewLayout.setScrollPosition({scrollTop:r+this._viewportStart.startLineDelta},1)}}try{const i=this._eventDispatcher.beginEmitViewEvents();e instanceof ev&&i.emitOutgoingEvent(new wUe(e.contentChangedEvent)),this._cursor.onModelContentChanged(i,e)}finally{this._eventDispatcher.endEmitViewEvents()}this._handleVisibleLinesChanged()})),this._register(this.model.onDidChangeTokens(e=>{const t=[];for(let i=0,n=e.ranges.length;i<n;i++){const r=e.ranges[i],o=this.coordinatesConverter.convertModelPositionToViewPosition(new X(r.fromLineNumber,1)).lineNumber,a=this.coordinatesConverter.convertModelPositionToViewPosition(new X(r.toLineNumber,this.model.getLineMaxColumn(r.toLineNumber))).lineNumber;t[i]={fromLineNumber:o,toLineNumber:a}}this._eventDispatcher.emitSingleViewEvent(new cUe(t)),this._eventDispatcher.emitOutgoingEvent(new yUe(e))})),this._register(this.model.onDidChangeLanguageConfiguration(e=>{this._eventDispatcher.emitSingleViewEvent(new oUe),this.cursorConfig=new Q0(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new vUe(e))})),this._register(this.model.onDidChangeLanguage(e=>{this.cursorConfig=new Q0(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new bUe(e))})),this._register(this.model.onDidChangeOptions(e=>{if(this._lines.setTabSize(this.model.getOptions().tabSize)){try{const t=this._eventDispatcher.beginEmitViewEvents();t.emitViewEvent(new AN),t.emitViewEvent(new PN),t.emitViewEvent(new Y_(null)),this._cursor.onLineMappingChanged(t),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount())}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule()}this.cursorConfig=new Q0(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new CUe(e))})),this._register(this.model.onDidChangeDecorations(e=>{this._decorations.onModelDecorationsChanged(),this._eventDispatcher.emitSingleViewEvent(new Y_(e)),this._eventDispatcher.emitOutgoingEvent(new _Ue(e))}))}setHiddenAreas(e,t){var o;this.hiddenAreasModel.setHiddenAreas(t,e);const i=this.hiddenAreasModel.getMergedRanges();if(i===this.previousHiddenAreas)return;this.previousHiddenAreas=i;const n=this._captureStableViewport();let r=!1;try{const a=this._eventDispatcher.beginEmitViewEvents();r=this._lines.setHiddenAreas(i),r&&(a.emitViewEvent(new AN),a.emitViewEvent(new PN),a.emitViewEvent(new Y_(null)),this._cursor.onLineMappingChanged(a),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this.viewLayout.onHeightMaybeChanged());const l=(o=n.viewportStartModelPosition)==null?void 0:o.lineNumber;l&&i.some(d=>d.startLineNumber<=l&&l<=d.endLineNumber)||n.recoverViewportStart(this.coordinatesConverter,this.viewLayout)}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule(),r&&this._eventDispatcher.emitOutgoingEvent(new pUe)}getVisibleRangesPlusViewportAboveBelow(){const e=this._configuration.options.get(146),t=this._configuration.options.get(67),i=Math.max(20,Math.round(e.height/t)),n=this.viewLayout.getLinesViewportData(),r=Math.max(1,n.completelyVisibleStartLineNumber-i),o=Math.min(this.getLineCount(),n.completelyVisibleEndLineNumber+i);return this._toModelVisibleRanges(new F(r,this.getLineMinColumn(r),o,this.getLineMaxColumn(o)))}getVisibleRanges(){const e=this.getCompletelyVisibleViewRange();return this._toModelVisibleRanges(e)}getHiddenAreas(){return this._lines.getHiddenAreas()}_toModelVisibleRanges(e){const t=this.coordinatesConverter.convertViewRangeToModelRange(e),i=this._lines.getHiddenAreas();if(i.length===0)return[t];const n=[];let r=0,o=t.startLineNumber,a=t.startColumn;const l=t.endLineNumber,c=t.endColumn;for(let d=0,u=i.length;d<u;d++){const h=i[d].startLineNumber,g=i[d].endLineNumber;g<o||h>l||(o<h&&(n[r++]=new F(o,a,h-1,this.model.getLineMaxColumn(h-1))),o=g+1,a=1)}return(o<l||o===l&&a<c)&&(n[r++]=new F(o,a,l,c)),n}getCompletelyVisibleViewRange(){const e=this.viewLayout.getLinesViewportData(),t=e.completelyVisibleStartLineNumber,i=e.completelyVisibleEndLineNumber;return new F(t,this.getLineMinColumn(t),i,this.getLineMaxColumn(i))}getCompletelyVisibleViewRangeAtScrollTop(e){const t=this.viewLayout.getLinesViewportDataAtScrollTop(e),i=t.completelyVisibleStartLineNumber,n=t.completelyVisibleEndLineNumber;return new F(i,this.getLineMinColumn(i),n,this.getLineMaxColumn(n))}saveState(){const e=this.viewLayout.saveState(),t=e.scrollTop,i=this.viewLayout.getLineNumberAtVerticalOffset(t),n=this.coordinatesConverter.convertViewPositionToModelPosition(new X(i,this.getLineMinColumn(i))),r=this.viewLayout.getVerticalOffsetForLineNumber(i)-t;return{scrollLeft:e.scrollLeft,firstPosition:n,firstPositionDeltaTop:r}}reduceRestoreState(e){if(typeof e.firstPosition>"u")return this._reduceRestoreStateCompatibility(e);const t=this.model.validatePosition(e.firstPosition),i=this.coordinatesConverter.convertModelPositionToViewPosition(t),n=this.viewLayout.getVerticalOffsetForLineNumber(i.lineNumber)-e.firstPositionDeltaTop;return{scrollLeft:e.scrollLeft,scrollTop:n}}_reduceRestoreStateCompatibility(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTopWithoutViewZones}}getTabSize(){return this.model.getOptions().tabSize}getLineCount(){return this._lines.getViewLineCount()}setViewport(e,t,i){this._viewportStart.update(this,e)}getActiveIndentGuide(e,t,i){return this._lines.getActiveIndentGuide(e,t,i)}getLinesIndentGuides(e,t){return this._lines.getViewLinesIndentGuides(e,t)}getBracketGuidesInRangeByLine(e,t,i,n){return this._lines.getViewLinesBracketGuides(e,t,i,n)}getLineContent(e){return this._lines.getViewLineContent(e)}getLineLength(e){return this._lines.getViewLineLength(e)}getLineMinColumn(e){return this._lines.getViewLineMinColumn(e)}getLineMaxColumn(e){return this._lines.getViewLineMaxColumn(e)}getLineFirstNonWhitespaceColumn(e){const t=Zr(this.getLineContent(e));return t===-1?0:t+1}getLineLastNonWhitespaceColumn(e){const t=nu(this.getLineContent(e));return t===-1?0:t+2}getMinimapDecorationsInRange(e){return this._decorations.getMinimapDecorationsInRange(e)}getDecorationsInViewport(e){return this._decorations.getDecorationsViewportData(e).decorations}getInjectedTextAt(e){return this._lines.getInjectedTextAt(e)}getViewportViewLineRenderingData(e,t){const n=this._decorations.getDecorationsViewportData(e).inlineDecorations[t-e.startLineNumber];return this._getViewLineRenderingData(t,n)}getViewLineRenderingData(e){const t=this._decorations.getInlineDecorationsOnLine(e);return this._getViewLineRenderingData(e,t)}_getViewLineRenderingData(e,t){const i=this.model.mightContainRTL(),n=this.model.mightContainNonBasicASCII(),r=this.getTabSize(),o=this._lines.getViewLineData(e);return o.inlineDecorations&&(t=[...t,...o.inlineDecorations.map(a=>a.toInlineDecoration(e))]),new Pl(o.minColumn,o.maxColumn,o.content,o.continuesWithWrappedLine,i,n,o.tokens,t,r,o.startVisibleColumn)}getViewLineData(e){return this._lines.getViewLineData(e)}getMinimapLinesRenderingData(e,t,i){const n=this._lines.getViewLinesData(e,t,i);return new k8e(this.getTabSize(),n)}getAllOverviewRulerDecorations(e){const t=this.model.getOverviewRulerDecorations(this._editorId,N2(this._configuration.options)),i=new zUe;for(const n of t){const r=n.options,o=r.overviewRuler;if(!o)continue;const a=o.position;if(a===0)continue;const l=o.getColor(e.value),c=this.coordinatesConverter.getViewLineNumberOfModelPosition(n.range.startLineNumber,n.range.startColumn),d=this.coordinatesConverter.getViewLineNumberOfModelPosition(n.range.endLineNumber,n.range.endColumn);i.accept(l,r.zIndex,c,d,a)}return i.asArray}_invalidateDecorationsColorCache(){const e=this.model.getOverviewRulerDecorations();for(const t of e){const i=t.options.overviewRuler;i==null||i.invalidateCachedColor();const n=t.options.minimap;n==null||n.invalidateCachedColor()}}getValueInRange(e,t){const i=this.coordinatesConverter.convertViewRangeToModelRange(e);return this.model.getValueInRange(i,t)}getValueLengthInRange(e,t){const i=this.coordinatesConverter.convertViewRangeToModelRange(e);return this.model.getValueLengthInRange(i,t)}modifyPosition(e,t){const i=this.coordinatesConverter.convertViewPositionToModelPosition(e),n=this.model.modifyPosition(i,t);return this.coordinatesConverter.convertModelPositionToViewPosition(n)}deduceModelPositionRelativeToViewPosition(e,t,i){const n=this.coordinatesConverter.convertViewPositionToModelPosition(e);this.model.getEOL().length===2&&(t<0?t-=i:t+=i);const o=this.model.getOffsetAt(n)+t;return this.model.getPositionAt(o)}getPlainTextToCopy(e,t,i){const n=i?`\r
`:this.model.getEOL();e=e.slice(0),e.sort(F.compareRangesUsingStarts);let r=!1,o=!1;for(const l of e)l.isEmpty()?r=!0:o=!0;if(!o){if(!t)return"";const l=e.map(d=>d.startLineNumber);let c="";for(let d=0;d<l.length;d++)d>0&&l[d-1]===l[d]||(c+=this.model.getLineContent(l[d])+n);return c}if(r&&t){const l=[];let c=0;for(const d of e){const u=d.startLineNumber;d.isEmpty()?u!==c&&l.push(this.model.getLineContent(u)):l.push(this.model.getValueInRange(d,i?2:0)),c=u}return l.length===1?l[0]:l}const a=[];for(const l of e)l.isEmpty()||a.push(this.model.getValueInRange(l,i?2:0));return a.length===1?a[0]:a}getRichTextToCopy(e,t){const i=this.model.getLanguageId();if(i===So||e.length!==1)return null;let n=e[0];if(n.isEmpty()){if(!t)return null;const d=n.startLineNumber;n=new F(d,this.model.getLineMinColumn(d),d,this.model.getLineMaxColumn(d))}const r=this._configuration.options.get(50),o=this._getColorMap(),l=/[:;\\\/<>]/.test(r.fontFamily)||r.fontFamily===yo.fontFamily;let c;return l?c=yo.fontFamily:(c=r.fontFamily,c=c.replace(/"/g,"'"),/[,']/.test(c)||/[+ ]/.test(c)&&(c=`'${c}'`),c=`${c}, ${yo.fontFamily}`),{mode:i,html:`<div style="color: ${o[1]};background-color: ${o[2]};font-family: ${c};font-weight: ${r.fontWeight};font-size: ${r.fontSize}px;line-height: ${r.lineHeight}px;white-space: pre;">`+this._getHTMLToCopy(n,o)+"</div>"}}_getHTMLToCopy(e,t){const i=e.startLineNumber,n=e.startColumn,r=e.endLineNumber,o=e.endColumn,a=this.getTabSize();let l="";for(let c=i;c<=r;c++){const d=this.model.tokenization.getLineTokens(c),u=d.getLineContent(),h=c===i?n-1:0,g=c===r?o-1:u.length;u===""?l+="<br>":l+=e3e(u,d.inflate(),t,h,g,a,gr)}return l}_getColorMap(){const e=Ln.getColorMap(),t=["#000000"];if(e)for(let i=1,n=e.length;i<n;i++)t[i]=fe.Format.CSS.formatHex(e[i]);return t}getPrimaryCursorState(){return this._cursor.getPrimaryCursorState()}getLastAddedCursorIndex(){return this._cursor.getLastAddedCursorIndex()}getCursorStates(){return this._cursor.getCursorStates()}setCursorStates(e,t,i){return this._withViewEventsCollector(n=>this._cursor.setStates(n,e,t,i))}getCursorColumnSelectData(){return this._cursor.getCursorColumnSelectData()}getCursorAutoClosedCharacters(){return this._cursor.getAutoClosedCharacters()}setCursorColumnSelectData(e){this._cursor.setCursorColumnSelectData(e)}getPrevEditOperationType(){return this._cursor.getPrevEditOperationType()}setPrevEditOperationType(e){this._cursor.setPrevEditOperationType(e)}getSelection(){return this._cursor.getSelection()}getSelections(){return this._cursor.getSelections()}getPosition(){return this._cursor.getPrimaryCursorState().modelState.position}setSelections(e,t,i=0){this._withViewEventsCollector(n=>this._cursor.setSelections(n,e,t,i))}saveCursorState(){return this._cursor.saveState()}restoreCursorState(e){this._withViewEventsCollector(t=>this._cursor.restoreState(t,e))}_executeCursorEdit(e){if(this._cursor.context.cursorConfig.readOnly){this._eventDispatcher.emitOutgoingEvent(new mUe);return}this._withViewEventsCollector(e)}executeEdits(e,t,i){this._executeCursorEdit(n=>this._cursor.executeEdits(n,e,t,i))}startComposition(){this._executeCursorEdit(e=>this._cursor.startComposition(e))}endComposition(e){this._executeCursorEdit(t=>this._cursor.endComposition(t,e))}type(e,t){this._executeCursorEdit(i=>this._cursor.type(i,e,t))}compositionType(e,t,i,n,r){this._executeCursorEdit(o=>this._cursor.compositionType(o,e,t,i,n,r))}paste(e,t,i,n){this._executeCursorEdit(r=>this._cursor.paste(r,e,t,i,n))}cut(e){this._executeCursorEdit(t=>this._cursor.cut(t,e))}executeCommand(e,t){this._executeCursorEdit(i=>this._cursor.executeCommand(i,e,t))}executeCommands(e,t){this._executeCursorEdit(i=>this._cursor.executeCommands(i,e,t))}revealAllCursors(e,t,i=!1){this._withViewEventsCollector(n=>this._cursor.revealAll(n,e,i,0,t,0))}revealPrimaryCursor(e,t,i=!1){this._withViewEventsCollector(n=>this._cursor.revealPrimary(n,e,i,0,t,0))}revealTopMostCursor(e){const t=this._cursor.getTopMostViewPosition(),i=new F(t.lineNumber,t.column,t.lineNumber,t.column);this._withViewEventsCollector(n=>n.emitViewEvent(new ek(e,!1,i,null,0,!0,0)))}revealBottomMostCursor(e){const t=this._cursor.getBottomMostViewPosition(),i=new F(t.lineNumber,t.column,t.lineNumber,t.column);this._withViewEventsCollector(n=>n.emitViewEvent(new ek(e,!1,i,null,0,!0,0)))}revealRange(e,t,i,n,r){this._withViewEventsCollector(o=>o.emitViewEvent(new ek(e,!1,i,null,n,t,r)))}changeWhitespace(e){this.viewLayout.changeWhitespace(e)&&(this._eventDispatcher.emitSingleViewEvent(new uUe),this._eventDispatcher.emitOutgoingEvent(new gUe))}_withViewEventsCollector(e){return this._transactionalTarget.batchChanges(()=>{try{const t=this._eventDispatcher.beginEmitViewEvents();return e(t)}finally{this._eventDispatcher.endEmitViewEvents()}})}batchEvents(e){this._withViewEventsCollector(()=>{e()})}normalizePosition(e,t){return this._lines.normalizePosition(e,t)}getLineIndentColumn(e){return this._lines.getLineIndentColumn(e)}};class WG{static create(e){const t=e._setTrackedRange(null,new F(1,1,1,1),1);return new WG(e,1,!1,t,0)}get viewLineNumber(){return this._viewLineNumber}get isValid(){return this._isValid}get modelTrackedRange(){return this._modelTrackedRange}get startLineDelta(){return this._startLineDelta}constructor(e,t,i,n,r){this._model=e,this._viewLineNumber=t,this._isValid=i,this._modelTrackedRange=n,this._startLineDelta=r}dispose(){this._model._setTrackedRange(this._modelTrackedRange,null,1)}update(e,t){const i=e.coordinatesConverter.convertViewPositionToModelPosition(new X(t,e.getLineMinColumn(t))),n=e.model._setTrackedRange(this._modelTrackedRange,new F(i.lineNumber,i.column,i.lineNumber,i.column),1),r=e.viewLayout.getVerticalOffsetForLineNumber(t),o=e.viewLayout.getCurrentScrollTop();this._viewLineNumber=t,this._isValid=!0,this._modelTrackedRange=n,this._startLineDelta=o-r}invalidate(){this._isValid=!1}}class zUe{constructor(){this._asMap=Object.create(null),this.asArray=[]}accept(e,t,i,n,r){const o=this._asMap[e];if(o){const a=o.data,l=a[a.length-3],c=a[a.length-1];if(l===r&&c+1>=i){n>c&&(a[a.length-1]=n);return}a.push(r,i,n)}else{const a=new OI(e,t,[r,i,n]);this._asMap[e]=a,this.asArray.push(a)}}}class UUe{constructor(){this.hiddenAreas=new Map,this.shouldRecompute=!1,this.ranges=[]}setHiddenAreas(e,t){const i=this.hiddenAreas.get(e);i&&Gse(i,t)||(this.hiddenAreas.set(e,t),this.shouldRecompute=!0)}getMergedRanges(){if(!this.shouldRecompute)return this.ranges;this.shouldRecompute=!1;const e=Array.from(this.hiddenAreas.values()).reduce((t,i)=>jUe(t,i),[]);return Gse(this.ranges,e)?this.ranges:(this.ranges=e,this.ranges)}}function jUe(s,e){const t=[];let i=0,n=0;for(;i<s.length&&n<e.length;){const r=s[i],o=e[n];if(r.endLineNumber<o.startLineNumber-1)t.push(s[i++]);else if(o.endLineNumber<r.startLineNumber-1)t.push(e[n++]);else{const a=Math.min(r.startLineNumber,o.startLineNumber),l=Math.max(r.endLineNumber,o.endLineNumber);t.push(new F(a,1,l,1)),i++,n++}}for(;i<s.length;)t.push(s[i++]);for(;n<e.length;)t.push(e[n++]);return t}function Gse(s,e){if(s.length!==e.length)return!1;for(let t=0;t<s.length;t++)if(!s[t].equalsRange(e[t]))return!1;return!0}class Qse{constructor(e,t){this.viewportStartModelPosition=e,this.startLineDelta=t}recoverViewportStart(e,t){if(!this.viewportStartModelPosition)return;const i=e.convertModelPositionToViewPosition(this.viewportStartModelPosition),n=t.getVerticalOffsetForLineNumber(i.lineNumber);t.setScrollPosition({scrollTop:n+this.startLineDelta},1)}}var $Ue=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},ff=function(s,e){return function(t,i){e(t,i,s)}},db,fv;let $I=(fv=class extends te{get isSimpleWidget(){return this._configuration.isSimpleWidget}get contextMenuId(){return this._configuration.contextMenuId}constructor(e,t,i,n,r,o,a,l,c,d,u,h){super(),this.languageConfigurationService=u,this._deliveryQueue=JNe(),this._contributions=this._register(new Xze),this._onDidDispose=this._register(new Z),this.onDidDispose=this._onDidDispose.event,this._onDidChangeModelContent=this._register(new Z({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelContent=this._onDidChangeModelContent.event,this._onDidChangeModelLanguage=this._register(new Z({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelLanguage=this._onDidChangeModelLanguage.event,this._onDidChangeModelLanguageConfiguration=this._register(new Z({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelLanguageConfiguration=this._onDidChangeModelLanguageConfiguration.event,this._onDidChangeModelOptions=this._register(new Z({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelOptions=this._onDidChangeModelOptions.event,this._onDidChangeModelDecorations=this._register(new Z({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelDecorations=this._onDidChangeModelDecorations.event,this._onDidChangeModelTokens=this._register(new Z({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelTokens=this._onDidChangeModelTokens.event,this._onDidChangeConfiguration=this._register(new Z({deliveryQueue:this._deliveryQueue})),this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this._onWillChangeModel=this._register(new Z({deliveryQueue:this._deliveryQueue})),this.onWillChangeModel=this._onWillChangeModel.event,this._onDidChangeModel=this._register(new Z({deliveryQueue:this._deliveryQueue})),this.onDidChangeModel=this._onDidChangeModel.event,this._onDidChangeCursorPosition=this._register(new Z({deliveryQueue:this._deliveryQueue})),this.onDidChangeCursorPosition=this._onDidChangeCursorPosition.event,this._onDidChangeCursorSelection=this._register(new Z({deliveryQueue:this._deliveryQueue})),this.onDidChangeCursorSelection=this._onDidChangeCursorSelection.event,this._onDidAttemptReadOnlyEdit=this._register(new Wr(this._contributions,this._deliveryQueue)),this.onDidAttemptReadOnlyEdit=this._onDidAttemptReadOnlyEdit.event,this._onDidLayoutChange=this._register(new Z({deliveryQueue:this._deliveryQueue})),this.onDidLayoutChange=this._onDidLayoutChange.event,this._editorTextFocus=this._register(new Yse({deliveryQueue:this._deliveryQueue})),this.onDidFocusEditorText=this._editorTextFocus.onDidChangeToTrue,this.onDidBlurEditorText=this._editorTextFocus.onDidChangeToFalse,this._editorWidgetFocus=this._register(new Yse({deliveryQueue:this._deliveryQueue})),this.onDidFocusEditorWidget=this._editorWidgetFocus.onDidChangeToTrue,this.onDidBlurEditorWidget=this._editorWidgetFocus.onDidChangeToFalse,this._onWillType=this._register(new Wr(this._contributions,this._deliveryQueue)),this.onWillType=this._onWillType.event,this._onDidType=this._register(new Wr(this._contributions,this._deliveryQueue)),this.onDidType=this._onDidType.event,this._onDidCompositionStart=this._register(new Wr(this._contributions,this._deliveryQueue)),this.onDidCompositionStart=this._onDidCompositionStart.event,this._onDidCompositionEnd=this._register(new Wr(this._contributions,this._deliveryQueue)),this.onDidCompositionEnd=this._onDidCompositionEnd.event,this._onDidPaste=this._register(new Wr(this._contributions,this._deliveryQueue)),this.onDidPaste=this._onDidPaste.event,this._onMouseUp=this._register(new Wr(this._contributions,this._deliveryQueue)),this.onMouseUp=this._onMouseUp.event,this._onMouseDown=this._register(new Wr(this._contributions,this._deliveryQueue)),this.onMouseDown=this._onMouseDown.event,this._onMouseDrag=this._register(new Wr(this._contributions,this._deliveryQueue)),this.onMouseDrag=this._onMouseDrag.event,this._onMouseDrop=this._register(new Wr(this._contributions,this._deliveryQueue)),this.onMouseDrop=this._onMouseDrop.event,this._onMouseDropCanceled=this._register(new Wr(this._contributions,this._deliveryQueue)),this.onMouseDropCanceled=this._onMouseDropCanceled.event,this._onDropIntoEditor=this._register(new Wr(this._contributions,this._deliveryQueue)),this.onDropIntoEditor=this._onDropIntoEditor.event,this._onContextMenu=this._register(new Wr(this._contributions,this._deliveryQueue)),this.onContextMenu=this._onContextMenu.event,this._onMouseMove=this._register(new Wr(this._contributions,this._deliveryQueue)),this.onMouseMove=this._onMouseMove.event,this._onMouseLeave=this._register(new Wr(this._contributions,this._deliveryQueue)),this.onMouseLeave=this._onMouseLeave.event,this._onMouseWheel=this._register(new Wr(this._contributions,this._deliveryQueue)),this.onMouseWheel=this._onMouseWheel.event,this._onKeyUp=this._register(new Wr(this._contributions,this._deliveryQueue)),this.onKeyUp=this._onKeyUp.event,this._onKeyDown=this._register(new Wr(this._contributions,this._deliveryQueue)),this.onKeyDown=this._onKeyDown.event,this._onDidContentSizeChange=this._register(new Z({deliveryQueue:this._deliveryQueue})),this.onDidContentSizeChange=this._onDidContentSizeChange.event,this._onDidScrollChange=this._register(new Z({deliveryQueue:this._deliveryQueue})),this.onDidScrollChange=this._onDidScrollChange.event,this._onDidChangeViewZones=this._register(new Z({deliveryQueue:this._deliveryQueue})),this.onDidChangeViewZones=this._onDidChangeViewZones.event,this._onDidChangeHiddenAreas=this._register(new Z({deliveryQueue:this._deliveryQueue})),this.onDidChangeHiddenAreas=this._onDidChangeHiddenAreas.event,this._updateCounter=0,this._onBeginUpdate=this._register(new Z),this.onBeginUpdate=this._onBeginUpdate.event,this._onEndUpdate=this._register(new Z),this.onEndUpdate=this._onEndUpdate.event,this._actions=new Map,this._bannerDomNode=null,this._dropIntoEditorDecorations=this.createDecorationsCollection(),r.willCreateCodeEditor();const g={...t};this._domElement=e,this._overflowWidgetsDomNode=g.overflowWidgetsDomNode,delete g.overflowWidgetsDomNode,this._id=++qUe,this._decorationTypeKeysToIds={},this._decorationTypeSubtypes={},this._telemetryData=i.telemetryData,this._configuration=this._register(this._createConfiguration(i.isSimpleWidget||!1,i.contextMenuId??(i.isSimpleWidget?ze.SimpleEditorContext:ze.EditorContext),g,d)),this._register(this._configuration.onDidChange(v=>{this._onDidChangeConfiguration.fire(v);const C=this._configuration.options;if(v.hasChanged(146)){const y=C.get(146);this._onDidLayoutChange.fire(y)}})),this._contextKeyService=this._register(a.createScoped(this._domElement)),this._notificationService=c,this._codeEditorService=r,this._commandService=o,this._themeService=l,this._register(new GUe(this,this._contextKeyService)),this._register(new QUe(this,this._contextKeyService,h)),this._instantiationService=this._register(n.createChild(new xS([ct,this._contextKeyService]))),this._modelData=null,this._focusTracker=new YUe(e,this._overflowWidgetsDomNode),this._register(this._focusTracker.onChange(()=>{this._editorWidgetFocus.setValue(this._focusTracker.hasFocus())})),this._contentWidgets={},this._overlayWidgets={},this._glyphMarginWidgets={};let p;Array.isArray(i.contributions)?p=i.contributions:p=Xb.getEditorContributions(),this._contributions.initialize(this,p,this._instantiationService);for(const v of Xb.getEditorActions()){if(this._actions.has(v.id)){ft(new Error(`Cannot have two actions with the same id ${v.id}`));continue}const C=new rme(v.id,v.label,v.alias,v.metadata,v.precondition??void 0,y=>this._instantiationService.invokeFunction(x=>Promise.resolve(v.runEditorCommand(x,this,y))),this._contextKeyService);this._actions.set(C.id,C)}const _=()=>!this._configuration.options.get(92)&&this._configuration.options.get(36).enabled;this._register(new dAe(this._domElement,{onDragOver:v=>{if(!_())return;const C=this.getTargetAtClientPoint(v.clientX,v.clientY);C!=null&&C.position&&this.showDropIndicatorAt(C.position)},onDrop:async v=>{if(!_()||(this.removeDropIndicator(),!v.dataTransfer))return;const C=this.getTargetAtClientPoint(v.clientX,v.clientY);C!=null&&C.position&&this._onDropIntoEditor.fire({position:C.position,event:v})},onDragLeave:()=>{this.removeDropIndicator()},onDragEnd:()=>{this.removeDropIndicator()}})),this._codeEditorService.addCodeEditor(this)}writeScreenReaderContent(e){var t;(t=this._modelData)==null||t.view.writeScreenReaderContent(e)}_createConfiguration(e,t,i,n){return new LH(e,t,i,this._domElement,n)}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return cD.ICodeEditor}dispose(){this._codeEditorService.removeCodeEditor(this),this._focusTracker.dispose(),this._actions.clear(),this._contentWidgets={},this._overlayWidgets={},this._removeDecorationTypes(),this._postDetachModelCleanup(this._detachModel()),this._onDidDispose.fire(),super.dispose()}invokeWithinContext(e){return this._instantiationService.invokeFunction(e)}updateOptions(e){this._configuration.updateOptions(e||{})}getOptions(){return this._configuration.options}getOption(e){return this._configuration.options.get(e)}getRawOptions(){return this._configuration.getRawOptions()}getOverflowWidgetsDomNode(){return this._overflowWidgetsDomNode}getConfiguredWordAtPosition(e){return this._modelData?hi.getWordAtPosition(this._modelData.model,this._configuration.options.get(132),this._configuration.options.get(131),e):null}getValue(e=null){if(!this._modelData)return"";const t=!!(e&&e.preserveBOM);let i=0;return e&&e.lineEnding&&e.lineEnding===`
`?i=1:e&&e.lineEnding&&e.lineEnding===`\r
`&&(i=2),this._modelData.model.getValue(i,t)}setValue(e){try{if(this._beginUpdate(),!this._modelData)return;this._modelData.model.setValue(e)}finally{this._endUpdate()}}getModel(){return this._modelData?this._modelData.model:null}setModel(e=null){var t;try{this._beginUpdate();const i=e;if(this._modelData===null&&i===null||this._modelData&&this._modelData.model===i)return;const n={oldModelUrl:((t=this._modelData)==null?void 0:t.model.uri)||null,newModelUrl:(i==null?void 0:i.uri)||null};this._onWillChangeModel.fire(n);const r=this.hasTextFocus(),o=this._detachModel();this._attachModel(i),r&&this.hasModel()&&this.focus(),this._removeDecorationTypes(),this._onDidChangeModel.fire(n),this._postDetachModelCleanup(o),this._contributionsDisposable=this._contributions.onAfterModelAttached()}finally{this._endUpdate()}}_removeDecorationTypes(){if(this._decorationTypeKeysToIds={},this._decorationTypeSubtypes){for(const e in this._decorationTypeSubtypes){const t=this._decorationTypeSubtypes[e];for(const i in t)this._removeDecorationType(e+"-"+i)}this._decorationTypeSubtypes={}}}getVisibleRanges(){return this._modelData?this._modelData.viewModel.getVisibleRanges():[]}getVisibleRangesPlusViewportAboveBelow(){return this._modelData?this._modelData.viewModel.getVisibleRangesPlusViewportAboveBelow():[]}getWhitespaces(){return this._modelData?this._modelData.viewModel.viewLayout.getWhitespaces():[]}static _getVerticalOffsetAfterPosition(e,t,i,n){const r=e.model.validatePosition({lineNumber:t,column:i}),o=e.viewModel.coordinatesConverter.convertModelPositionToViewPosition(r);return e.viewModel.viewLayout.getVerticalOffsetAfterLineNumber(o.lineNumber,n)}getTopForLineNumber(e,t=!1){return this._modelData?db._getVerticalOffsetForPosition(this._modelData,e,1,t):-1}getTopForPosition(e,t){return this._modelData?db._getVerticalOffsetForPosition(this._modelData,e,t,!1):-1}static _getVerticalOffsetForPosition(e,t,i,n=!1){const r=e.model.validatePosition({lineNumber:t,column:i}),o=e.viewModel.coordinatesConverter.convertModelPositionToViewPosition(r);return e.viewModel.viewLayout.getVerticalOffsetForLineNumber(o.lineNumber,n)}getBottomForLineNumber(e,t=!1){if(!this._modelData)return-1;const i=this._modelData.model.getLineMaxColumn(e);return db._getVerticalOffsetAfterPosition(this._modelData,e,i,t)}setHiddenAreas(e,t){var i;(i=this._modelData)==null||i.viewModel.setHiddenAreas(e.map(n=>F.lift(n)),t)}getVisibleColumnFromPosition(e){if(!this._modelData)return e.column;const t=this._modelData.model.validatePosition(e),i=this._modelData.model.getOptions().tabSize;return hs.visibleColumnFromColumn(this._modelData.model.getLineContent(t.lineNumber),t.column,i)+1}getPosition(){return this._modelData?this._modelData.viewModel.getPosition():null}setPosition(e,t="api"){if(this._modelData){if(!X.isIPosition(e))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(t,[{selectionStartLineNumber:e.lineNumber,selectionStartColumn:e.column,positionLineNumber:e.lineNumber,positionColumn:e.column}])}}_sendRevealRange(e,t,i,n){if(!this._modelData)return;if(!F.isIRange(e))throw new Error("Invalid arguments");const r=this._modelData.model.validateRange(e),o=this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(r);this._modelData.viewModel.revealRange("api",i,o,t,n)}revealLine(e,t=0){this._revealLine(e,0,t)}revealLineInCenter(e,t=0){this._revealLine(e,1,t)}revealLineInCenterIfOutsideViewport(e,t=0){this._revealLine(e,2,t)}revealLineNearTop(e,t=0){this._revealLine(e,5,t)}_revealLine(e,t,i){if(typeof e!="number")throw new Error("Invalid arguments");this._sendRevealRange(new F(e,1,e,1),t,!1,i)}revealPosition(e,t=0){this._revealPosition(e,0,!0,t)}revealPositionInCenter(e,t=0){this._revealPosition(e,1,!0,t)}revealPositionInCenterIfOutsideViewport(e,t=0){this._revealPosition(e,2,!0,t)}revealPositionNearTop(e,t=0){this._revealPosition(e,5,!0,t)}_revealPosition(e,t,i,n){if(!X.isIPosition(e))throw new Error("Invalid arguments");this._sendRevealRange(new F(e.lineNumber,e.column,e.lineNumber,e.column),t,i,n)}getSelection(){return this._modelData?this._modelData.viewModel.getSelection():null}getSelections(){return this._modelData?this._modelData.viewModel.getSelections():null}setSelection(e,t="api"){const i=Ue.isISelection(e),n=F.isIRange(e);if(!i&&!n)throw new Error("Invalid arguments");if(i)this._setSelectionImpl(e,t);else if(n){const r={selectionStartLineNumber:e.startLineNumber,selectionStartColumn:e.startColumn,positionLineNumber:e.endLineNumber,positionColumn:e.endColumn};this._setSelectionImpl(r,t)}}_setSelectionImpl(e,t){if(!this._modelData)return;const i=new Ue(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn);this._modelData.viewModel.setSelections(t,[i])}revealLines(e,t,i=0){this._revealLines(e,t,0,i)}revealLinesInCenter(e,t,i=0){this._revealLines(e,t,1,i)}revealLinesInCenterIfOutsideViewport(e,t,i=0){this._revealLines(e,t,2,i)}revealLinesNearTop(e,t,i=0){this._revealLines(e,t,5,i)}_revealLines(e,t,i,n){if(typeof e!="number"||typeof t!="number")throw new Error("Invalid arguments");this._sendRevealRange(new F(e,1,t,1),i,!1,n)}revealRange(e,t=0,i=!1,n=!0){this._revealRange(e,i?1:0,n,t)}revealRangeInCenter(e,t=0){this._revealRange(e,1,!0,t)}revealRangeInCenterIfOutsideViewport(e,t=0){this._revealRange(e,2,!0,t)}revealRangeNearTop(e,t=0){this._revealRange(e,5,!0,t)}revealRangeNearTopIfOutsideViewport(e,t=0){this._revealRange(e,6,!0,t)}revealRangeAtTop(e,t=0){this._revealRange(e,3,!0,t)}_revealRange(e,t,i,n){if(!F.isIRange(e))throw new Error("Invalid arguments");this._sendRevealRange(F.lift(e),t,i,n)}setSelections(e,t="api",i=0){if(this._modelData){if(!e||e.length===0)throw new Error("Invalid arguments");for(let n=0,r=e.length;n<r;n++)if(!Ue.isISelection(e[n]))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(t,e,i)}}getContentWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getContentWidth():-1}getScrollWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollWidth():-1}getScrollLeft(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollLeft():-1}getContentHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getContentHeight():-1}getScrollHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollHeight():-1}getScrollTop(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollTop():-1}setScrollLeft(e,t=1){if(this._modelData){if(typeof e!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollLeft:e},t)}}setScrollTop(e,t=1){if(this._modelData){if(typeof e!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollTop:e},t)}}setScrollPosition(e,t=1){this._modelData&&this._modelData.viewModel.viewLayout.setScrollPosition(e,t)}hasPendingScrollAnimation(){return this._modelData?this._modelData.viewModel.viewLayout.hasPendingScrollAnimation():!1}saveViewState(){if(!this._modelData)return null;const e=this._contributions.saveViewState(),t=this._modelData.viewModel.saveCursorState(),i=this._modelData.viewModel.saveState();return{cursorState:t,viewState:i,contributionsState:e}}restoreViewState(e){if(!this._modelData||!this._modelData.hasRealView)return;const t=e;if(t&&t.cursorState&&t.viewState){const i=t.cursorState;Array.isArray(i)?i.length>0&&this._modelData.viewModel.restoreCursorState(i):this._modelData.viewModel.restoreCursorState([i]),this._contributions.restoreViewState(t.contributionsState||{});const n=this._modelData.viewModel.reduceRestoreState(t.viewState);this._modelData.view.restoreState(n)}}handleInitialized(){var e;(e=this._getViewModel())==null||e.visibleLinesStabilized()}getContribution(e){return this._contributions.get(e)}getActions(){return Array.from(this._actions.values())}getSupportedActions(){let e=this.getActions();return e=e.filter(t=>t.isSupported()),e}getAction(e){return this._actions.get(e)||null}trigger(e,t,i){i=i||{};try{switch(this._beginUpdate(),t){case"compositionStart":this._startComposition();return;case"compositionEnd":this._endComposition(e);return;case"type":{const r=i;this._type(e,r.text||"");return}case"replacePreviousChar":{const r=i;this._compositionType(e,r.text||"",r.replaceCharCnt||0,0,0);return}case"compositionType":{const r=i;this._compositionType(e,r.text||"",r.replacePrevCharCnt||0,r.replaceNextCharCnt||0,r.positionDelta||0);return}case"paste":{const r=i;this._paste(e,r.text||"",r.pasteOnNewLine||!1,r.multicursorText||null,r.mode||null,r.clipboardEvent);return}case"cut":this._cut(e);return}const n=this.getAction(t);if(n){Promise.resolve(n.run(i)).then(void 0,ft);return}if(!this._modelData||this._triggerEditorCommand(e,t,i))return;this._triggerCommand(t,i)}finally{this._endUpdate()}}_triggerCommand(e,t){this._commandService.executeCommand(e,t)}_startComposition(){this._modelData&&(this._modelData.viewModel.startComposition(),this._onDidCompositionStart.fire())}_endComposition(e){this._modelData&&(this._modelData.viewModel.endComposition(e),this._onDidCompositionEnd.fire())}_type(e,t){!this._modelData||t.length===0||(e==="keyboard"&&this._onWillType.fire(t),this._modelData.viewModel.type(t,e),e==="keyboard"&&this._onDidType.fire(t))}_compositionType(e,t,i,n,r){this._modelData&&this._modelData.viewModel.compositionType(t,i,n,r,e)}_paste(e,t,i,n,r,o){if(!this._modelData)return;const a=this._modelData.viewModel,l=a.getSelection().getStartPosition();a.paste(t,i,n,e);const c=a.getSelection().getStartPosition();e==="keyboard"&&this._onDidPaste.fire({clipboardEvent:o,range:new F(l.lineNumber,l.column,c.lineNumber,c.column),languageId:r})}_cut(e){this._modelData&&this._modelData.viewModel.cut(e)}_triggerEditorCommand(e,t,i){const n=Xb.getEditorCommand(t);return n?(i=i||{},i.source=e,this._instantiationService.invokeFunction(r=>{Promise.resolve(n.runEditorCommand(r,this,i)).then(void 0,ft)}),!0):!1}_getViewModel(){return this._modelData?this._modelData.viewModel:null}pushUndoStop(){return!this._modelData||this._configuration.options.get(92)?!1:(this._modelData.model.pushStackElement(),!0)}popUndoStop(){return!this._modelData||this._configuration.options.get(92)?!1:(this._modelData.model.popStackElement(),!0)}executeEdits(e,t,i){if(!this._modelData||this._configuration.options.get(92))return!1;let n;return i?Array.isArray(i)?n=()=>i:n=i:n=()=>null,this._modelData.viewModel.executeEdits(e,t,n),!0}executeCommand(e,t){this._modelData&&this._modelData.viewModel.executeCommand(t,e)}executeCommands(e,t){this._modelData&&this._modelData.viewModel.executeCommands(t,e)}createDecorationsCollection(e){return new XUe(this,e)}changeDecorations(e){return this._modelData?this._modelData.model.changeDecorations(e,this._id):null}getLineDecorations(e){return this._modelData?this._modelData.model.getLineDecorations(e,this._id,N2(this._configuration.options)):null}getDecorationsInRange(e){return this._modelData?this._modelData.model.getDecorationsInRange(e,this._id,N2(this._configuration.options)):null}deltaDecorations(e,t){return this._modelData?e.length===0&&t.length===0?e:this._modelData.model.deltaDecorations(e,t,this._id):[]}removeDecorations(e){!this._modelData||e.length===0||this._modelData.model.changeDecorations(t=>{t.deltaDecorations(e,[])})}removeDecorationsByType(e){const t=this._decorationTypeKeysToIds[e];t&&this.changeDecorations(i=>i.deltaDecorations(t,[])),this._decorationTypeKeysToIds.hasOwnProperty(e)&&delete this._decorationTypeKeysToIds[e],this._decorationTypeSubtypes.hasOwnProperty(e)&&delete this._decorationTypeSubtypes[e]}getLayoutInfo(){return this._configuration.options.get(146)}createOverviewRuler(e){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.createOverviewRuler(e)}getContainerDomNode(){return this._domElement}getDomNode(){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.domNode.domNode}delegateVerticalScrollbarPointerDown(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateScrollFromMouseWheelEvent(e)}layout(e,t=!1){this._configuration.observeContainer(e),t||this.render()}focus(){!this._modelData||!this._modelData.hasRealView||this._modelData.view.focus()}hasTextFocus(){return!this._modelData||!this._modelData.hasRealView?!1:this._modelData.view.isFocused()}hasWidgetFocus(){return this._focusTracker&&this._focusTracker.hasFocus()}addContentWidget(e){const t={widget:e,position:e.getPosition()};this._contentWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting a content widget with the same id:"+e.getId()),this._contentWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addContentWidget(t)}layoutContentWidget(e){const t=e.getId();if(this._contentWidgets.hasOwnProperty(t)){const i=this._contentWidgets[t];i.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutContentWidget(i)}}removeContentWidget(e){const t=e.getId();if(this._contentWidgets.hasOwnProperty(t)){const i=this._contentWidgets[t];delete this._contentWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeContentWidget(i)}}addOverlayWidget(e){const t={widget:e,position:e.getPosition()};this._overlayWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting an overlay widget with the same id."),this._overlayWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addOverlayWidget(t)}layoutOverlayWidget(e){const t=e.getId();if(this._overlayWidgets.hasOwnProperty(t)){const i=this._overlayWidgets[t];i.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutOverlayWidget(i)}}removeOverlayWidget(e){const t=e.getId();if(this._overlayWidgets.hasOwnProperty(t)){const i=this._overlayWidgets[t];delete this._overlayWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeOverlayWidget(i)}}addGlyphMarginWidget(e){const t={widget:e,position:e.getPosition()};this._glyphMarginWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting a glyph margin widget with the same id."),this._glyphMarginWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addGlyphMarginWidget(t)}layoutGlyphMarginWidget(e){const t=e.getId();if(this._glyphMarginWidgets.hasOwnProperty(t)){const i=this._glyphMarginWidgets[t];i.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutGlyphMarginWidget(i)}}removeGlyphMarginWidget(e){const t=e.getId();if(this._glyphMarginWidgets.hasOwnProperty(t)){const i=this._glyphMarginWidgets[t];delete this._glyphMarginWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeGlyphMarginWidget(i)}}changeViewZones(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.change(e)}getTargetAtClientPoint(e,t){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.getTargetAtClientPoint(e,t)}getScrolledVisiblePosition(e){if(!this._modelData||!this._modelData.hasRealView)return null;const t=this._modelData.model.validatePosition(e),i=this._configuration.options,n=i.get(146),r=db._getVerticalOffsetForPosition(this._modelData,t.lineNumber,t.column)-this.getScrollTop(),o=this._modelData.view.getOffsetForColumn(t.lineNumber,t.column)+n.glyphMarginWidth+n.lineNumbersWidth+n.decorationsWidth-this.getScrollLeft();return{top:r,left:o,height:i.get(67)}}getOffsetForColumn(e,t){return!this._modelData||!this._modelData.hasRealView?-1:this._modelData.view.getOffsetForColumn(e,t)}render(e=!1){!this._modelData||!this._modelData.hasRealView||this._modelData.viewModel.batchEvents(()=>{this._modelData.view.render(!0,e)})}setAriaOptions(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.setAriaOptions(e)}applyFontInfo(e){Zs(e,this._configuration.options.get(50))}setBanner(e,t){this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._bannerDomNode.remove(),this._bannerDomNode=e,this._configuration.setReservedHeight(e?t:0),this._bannerDomNode&&this._domElement.prepend(this._bannerDomNode)}_attachModel(e){if(!e){this._modelData=null;return}const t=[];this._domElement.setAttribute("data-mode-id",e.getLanguageId()),this._configuration.setIsDominatedByLongLines(e.isDominatedByLongLines()),this._configuration.setModelLineCount(e.getLineCount());const i=e.onBeforeAttached(),n=new HUe(this._id,this._configuration,e,RG.create(nt(this._domElement)),AG.create(this._configuration.options),a=>Fa(nt(this._domElement),a),this.languageConfigurationService,this._themeService,i,{batchChanges:a=>{try{return this._beginUpdate(),a()}finally{this._endUpdate()}}});t.push(e.onWillDispose(()=>this.setModel(null))),t.push(n.onEvent(a=>{switch(a.kind){case 0:this._onDidContentSizeChange.fire(a);break;case 1:this._editorTextFocus.setValue(a.hasFocus);break;case 2:this._onDidScrollChange.fire(a);break;case 3:this._onDidChangeViewZones.fire();break;case 4:this._onDidChangeHiddenAreas.fire();break;case 5:this._onDidAttemptReadOnlyEdit.fire();break;case 6:{if(a.reachedMaxCursorCount){const u=this.getOption(80),h=b("cursors.maximum","The number of cursors has been limited to {0}. Consider using [find and replace](https://code.visualstudio.com/docs/editor/codebasics#_find-and-replace) for larger changes or increase the editor multi cursor limit setting.",u);this._notificationService.prompt(wF.Warning,h,[{label:"Find and Replace",run:()=>{this._commandService.executeCommand("editor.action.startFindReplaceAction")}},{label:b("goToSetting","Increase Multi Cursor Limit"),run:()=>{this._commandService.executeCommand("workbench.action.openSettings2",{query:"editor.multiCursorLimit"})}}])}const l=[];for(let u=0,h=a.selections.length;u<h;u++)l[u]=a.selections[u].getPosition();const c={position:l[0],secondaryPositions:l.slice(1),reason:a.reason,source:a.source};this._onDidChangeCursorPosition.fire(c);const d={selection:a.selections[0],secondarySelections:a.selections.slice(1),modelVersionId:a.modelVersionId,oldSelections:a.oldSelections,oldModelVersionId:a.oldModelVersionId,source:a.source,reason:a.reason};this._onDidChangeCursorSelection.fire(d);break}case 7:this._onDidChangeModelDecorations.fire(a.event);break;case 8:this._domElement.setAttribute("data-mode-id",e.getLanguageId()),this._onDidChangeModelLanguage.fire(a.event);break;case 9:this._onDidChangeModelLanguageConfiguration.fire(a.event);break;case 10:this._onDidChangeModelContent.fire(a.event);break;case 11:this._onDidChangeModelOptions.fire(a.event);break;case 12:this._onDidChangeModelTokens.fire(a.event);break}}));const[r,o]=this._createView(n);if(o){this._domElement.appendChild(r.domNode.domNode);let a=Object.keys(this._contentWidgets);for(let l=0,c=a.length;l<c;l++){const d=a[l];r.addContentWidget(this._contentWidgets[d])}a=Object.keys(this._overlayWidgets);for(let l=0,c=a.length;l<c;l++){const d=a[l];r.addOverlayWidget(this._overlayWidgets[d])}a=Object.keys(this._glyphMarginWidgets);for(let l=0,c=a.length;l<c;l++){const d=a[l];r.addGlyphMarginWidget(this._glyphMarginWidgets[d])}r.render(!1,!0),r.domNode.domNode.setAttribute("data-uri",e.uri.toString())}this._modelData=new KUe(e,n,r,o,t,i)}_createView(e){let t;this.isSimpleWidget?t={paste:(r,o,a,l)=>{this._paste("keyboard",r,o,a,l)},type:r=>{this._type("keyboard",r)},compositionType:(r,o,a,l)=>{this._compositionType("keyboard",r,o,a,l)},startComposition:()=>{this._startComposition()},endComposition:()=>{this._endComposition("keyboard")},cut:()=>{this._cut("keyboard")}}:t={paste:(r,o,a,l)=>{const c={text:r,pasteOnNewLine:o,multicursorText:a,mode:l};this._commandService.executeCommand("paste",c)},type:r=>{const o={text:r};this._commandService.executeCommand("type",o)},compositionType:(r,o,a,l)=>{if(a||l){const c={text:r,replacePrevCharCnt:o,replaceNextCharCnt:a,positionDelta:l};this._commandService.executeCommand("compositionType",c)}else{const c={text:r,replaceCharCnt:o};this._commandService.executeCommand("replacePreviousChar",c)}},startComposition:()=>{this._commandService.executeCommand("compositionStart",{})},endComposition:()=>{this._commandService.executeCommand("compositionEnd",{})},cut:()=>{this._commandService.executeCommand("cut",{})}};const i=new r5(e.coordinatesConverter);return i.onKeyDown=r=>this._onKeyDown.fire(r),i.onKeyUp=r=>this._onKeyUp.fire(r),i.onContextMenu=r=>this._onContextMenu.fire(r),i.onMouseMove=r=>this._onMouseMove.fire(r),i.onMouseLeave=r=>this._onMouseLeave.fire(r),i.onMouseDown=r=>this._onMouseDown.fire(r),i.onMouseUp=r=>this._onMouseUp.fire(r),i.onMouseDrag=r=>this._onMouseDrag.fire(r),i.onMouseDrop=r=>this._onMouseDrop.fire(r),i.onMouseDropCanceled=r=>this._onMouseDropCanceled.fire(r),i.onMouseWheel=r=>this._onMouseWheel.fire(r),[new BH(t,this._configuration,this._themeService.getColorTheme(),e,i,this._overflowWidgetsDomNode,this._instantiationService),!0]}_postDetachModelCleanup(e){e==null||e.removeAllDecorationsWithOwnerId(this._id)}_detachModel(){var i;if((i=this._contributionsDisposable)==null||i.dispose(),this._contributionsDisposable=void 0,!this._modelData)return null;const e=this._modelData.model,t=this._modelData.hasRealView?this._modelData.view.domNode.domNode:null;return this._modelData.dispose(),this._modelData=null,this._domElement.removeAttribute("data-mode-id"),t&&this._domElement.contains(t)&&t.remove(),this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._bannerDomNode.remove(),e}_removeDecorationType(e){this._codeEditorService.removeDecorationType(e)}hasModel(){return this._modelData!==null}showDropIndicatorAt(e){const t=[{range:new F(e.lineNumber,e.column,e.lineNumber,e.column),options:db.dropIntoEditorDecorationOptions}];this._dropIntoEditorDecorations.set(t),this.revealPosition(e,1)}removeDropIndicator(){this._dropIntoEditorDecorations.clear()}setContextValue(e,t){this._contextKeyService.createKey(e,t)}_beginUpdate(){this._updateCounter++,this._updateCounter===1&&this._onBeginUpdate.fire()}_endUpdate(){this._updateCounter--,this._updateCounter===0&&this._onEndUpdate.fire()}},db=fv,fv.dropIntoEditorDecorationOptions=_t.register({description:"workbench-dnd-target",className:"dnd-target"}),fv);$I=db=$Ue([ff(3,Xe),ff(4,ni),ff(5,Hi),ff(6,ct),ff(7,gs),ff(8,jn),ff(9,Wa),ff(10,bn),ff(11,Be)],$I);let qUe=0;class KUe{constructor(e,t,i,n,r,o){this.model=e,this.viewModel=t,this.view=i,this.hasRealView=n,this.listenersToRemove=r,this.attachedView=o}dispose(){Ni(this.listenersToRemove),this.model.onBeforeDetached(this.attachedView),this.hasRealView&&this.view.dispose(),this.viewModel.dispose()}}class Yse extends te{constructor(e){super(),this._emitterOptions=e,this._onDidChangeToTrue=this._register(new Z(this._emitterOptions)),this.onDidChangeToTrue=this._onDidChangeToTrue.event,this._onDidChangeToFalse=this._register(new Z(this._emitterOptions)),this.onDidChangeToFalse=this._onDidChangeToFalse.event,this._value=0}setValue(e){const t=e?2:1;this._value!==t&&(this._value=t,this._value===2?this._onDidChangeToTrue.fire():this._value===1&&this._onDidChangeToFalse.fire())}}class Wr extends Z{constructor(e,t){super({deliveryQueue:t}),this._contributions=e}fire(e){this._contributions.onBeforeInteractionEvent(),super.fire(e)}}class GUe extends te{constructor(e,t){super(),this._editor=e,t.createKey("editorId",e.getId()),this._editorSimpleInput=z.editorSimpleInput.bindTo(t),this._editorFocus=z.focus.bindTo(t),this._textInputFocus=z.textInputFocus.bindTo(t),this._editorTextFocus=z.editorTextFocus.bindTo(t),this._tabMovesFocus=z.tabMovesFocus.bindTo(t),this._editorReadonly=z.readOnly.bindTo(t),this._inDiffEditor=z.inDiffEditor.bindTo(t),this._editorColumnSelection=z.columnSelection.bindTo(t),this._hasMultipleSelections=z.hasMultipleSelections.bindTo(t),this._hasNonEmptySelection=z.hasNonEmptySelection.bindTo(t),this._canUndo=z.canUndo.bindTo(t),this._canRedo=z.canRedo.bindTo(t),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromConfig())),this._register(this._editor.onDidChangeCursorSelection(()=>this._updateFromSelection())),this._register(this._editor.onDidFocusEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidFocusEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidChangeModel(()=>this._updateFromModel())),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromModel())),this._register(R1.onDidChangeTabFocus(i=>this._tabMovesFocus.set(i))),this._updateFromConfig(),this._updateFromSelection(),this._updateFromFocus(),this._updateFromModel(),this._editorSimpleInput.set(this._editor.isSimpleWidget)}_updateFromConfig(){const e=this._editor.getOptions();this._tabMovesFocus.set(R1.getTabFocusMode()),this._editorReadonly.set(e.get(92)),this._inDiffEditor.set(e.get(61)),this._editorColumnSelection.set(e.get(22))}_updateFromSelection(){const e=this._editor.getSelections();e?(this._hasMultipleSelections.set(e.length>1),this._hasNonEmptySelection.set(e.some(t=>!t.isEmpty()))):(this._hasMultipleSelections.reset(),this._hasNonEmptySelection.reset())}_updateFromFocus(){this._editorFocus.set(this._editor.hasWidgetFocus()&&!this._editor.isSimpleWidget),this._editorTextFocus.set(this._editor.hasTextFocus()&&!this._editor.isSimpleWidget),this._textInputFocus.set(this._editor.hasTextFocus())}_updateFromModel(){const e=this._editor.getModel();this._canUndo.set(!!(e&&e.canUndo())),this._canRedo.set(!!(e&&e.canRedo()))}}class QUe extends te{constructor(e,t,i){super(),this._editor=e,this._contextKeyService=t,this._languageFeaturesService=i,this._langId=z.languageId.bindTo(t),this._hasCompletionItemProvider=z.hasCompletionItemProvider.bindTo(t),this._hasCodeActionsProvider=z.hasCodeActionsProvider.bindTo(t),this._hasCodeLensProvider=z.hasCodeLensProvider.bindTo(t),this._hasDefinitionProvider=z.hasDefinitionProvider.bindTo(t),this._hasDeclarationProvider=z.hasDeclarationProvider.bindTo(t),this._hasImplementationProvider=z.hasImplementationProvider.bindTo(t),this._hasTypeDefinitionProvider=z.hasTypeDefinitionProvider.bindTo(t),this._hasHoverProvider=z.hasHoverProvider.bindTo(t),this._hasDocumentHighlightProvider=z.hasDocumentHighlightProvider.bindTo(t),this._hasDocumentSymbolProvider=z.hasDocumentSymbolProvider.bindTo(t),this._hasReferenceProvider=z.hasReferenceProvider.bindTo(t),this._hasRenameProvider=z.hasRenameProvider.bindTo(t),this._hasSignatureHelpProvider=z.hasSignatureHelpProvider.bindTo(t),this._hasInlayHintsProvider=z.hasInlayHintsProvider.bindTo(t),this._hasDocumentFormattingProvider=z.hasDocumentFormattingProvider.bindTo(t),this._hasDocumentSelectionFormattingProvider=z.hasDocumentSelectionFormattingProvider.bindTo(t),this._hasMultipleDocumentFormattingProvider=z.hasMultipleDocumentFormattingProvider.bindTo(t),this._hasMultipleDocumentSelectionFormattingProvider=z.hasMultipleDocumentSelectionFormattingProvider.bindTo(t),this._isInEmbeddedEditor=z.isInEmbeddedEditor.bindTo(t);const n=()=>this._update();this._register(e.onDidChangeModel(n)),this._register(e.onDidChangeModelLanguage(n)),this._register(i.completionProvider.onDidChange(n)),this._register(i.codeActionProvider.onDidChange(n)),this._register(i.codeLensProvider.onDidChange(n)),this._register(i.definitionProvider.onDidChange(n)),this._register(i.declarationProvider.onDidChange(n)),this._register(i.implementationProvider.onDidChange(n)),this._register(i.typeDefinitionProvider.onDidChange(n)),this._register(i.hoverProvider.onDidChange(n)),this._register(i.documentHighlightProvider.onDidChange(n)),this._register(i.documentSymbolProvider.onDidChange(n)),this._register(i.referenceProvider.onDidChange(n)),this._register(i.renameProvider.onDidChange(n)),this._register(i.documentFormattingEditProvider.onDidChange(n)),this._register(i.documentRangeFormattingEditProvider.onDidChange(n)),this._register(i.signatureHelpProvider.onDidChange(n)),this._register(i.inlayHintsProvider.onDidChange(n)),n()}dispose(){super.dispose()}reset(){this._contextKeyService.bufferChangeEvents(()=>{this._langId.reset(),this._hasCompletionItemProvider.reset(),this._hasCodeActionsProvider.reset(),this._hasCodeLensProvider.reset(),this._hasDefinitionProvider.reset(),this._hasDeclarationProvider.reset(),this._hasImplementationProvider.reset(),this._hasTypeDefinitionProvider.reset(),this._hasHoverProvider.reset(),this._hasDocumentHighlightProvider.reset(),this._hasDocumentSymbolProvider.reset(),this._hasReferenceProvider.reset(),this._hasRenameProvider.reset(),this._hasDocumentFormattingProvider.reset(),this._hasDocumentSelectionFormattingProvider.reset(),this._hasSignatureHelpProvider.reset(),this._isInEmbeddedEditor.reset()})}_update(){const e=this._editor.getModel();if(!e){this.reset();return}this._contextKeyService.bufferChangeEvents(()=>{this._langId.set(e.getLanguageId()),this._hasCompletionItemProvider.set(this._languageFeaturesService.completionProvider.has(e)),this._hasCodeActionsProvider.set(this._languageFeaturesService.codeActionProvider.has(e)),this._hasCodeLensProvider.set(this._languageFeaturesService.codeLensProvider.has(e)),this._hasDefinitionProvider.set(this._languageFeaturesService.definitionProvider.has(e)),this._hasDeclarationProvider.set(this._languageFeaturesService.declarationProvider.has(e)),this._hasImplementationProvider.set(this._languageFeaturesService.implementationProvider.has(e)),this._hasTypeDefinitionProvider.set(this._languageFeaturesService.typeDefinitionProvider.has(e)),this._hasHoverProvider.set(this._languageFeaturesService.hoverProvider.has(e)),this._hasDocumentHighlightProvider.set(this._languageFeaturesService.documentHighlightProvider.has(e)),this._hasDocumentSymbolProvider.set(this._languageFeaturesService.documentSymbolProvider.has(e)),this._hasReferenceProvider.set(this._languageFeaturesService.referenceProvider.has(e)),this._hasRenameProvider.set(this._languageFeaturesService.renameProvider.has(e)),this._hasSignatureHelpProvider.set(this._languageFeaturesService.signatureHelpProvider.has(e)),this._hasInlayHintsProvider.set(this._languageFeaturesService.inlayHintsProvider.has(e)),this._hasDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.has(e)||this._languageFeaturesService.documentRangeFormattingEditProvider.has(e)),this._hasDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.has(e)),this._hasMultipleDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.all(e).length+this._languageFeaturesService.documentRangeFormattingEditProvider.all(e).length>1),this._hasMultipleDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.all(e).length>1),this._isInEmbeddedEditor.set(e.uri.scheme===gt.walkThroughSnippet||e.uri.scheme===gt.vscodeChatCodeBlock)})}}class YUe extends te{constructor(e,t){super(),this._onChange=this._register(new Z),this.onChange=this._onChange.event,this._hadFocus=void 0,this._hasDomElementFocus=!1,this._domFocusTracker=this._register(hu(e)),this._overflowWidgetsDomNodeHasFocus=!1,this._register(this._domFocusTracker.onDidFocus(()=>{this._hasDomElementFocus=!0,this._update()})),this._register(this._domFocusTracker.onDidBlur(()=>{this._hasDomElementFocus=!1,this._update()})),t&&(this._overflowWidgetsDomNode=this._register(hu(t)),this._register(this._overflowWidgetsDomNode.onDidFocus(()=>{this._overflowWidgetsDomNodeHasFocus=!0,this._update()})),this._register(this._overflowWidgetsDomNode.onDidBlur(()=>{this._overflowWidgetsDomNodeHasFocus=!1,this._update()})))}_update(){const e=this._hasDomElementFocus||this._overflowWidgetsDomNodeHasFocus;this._hadFocus!==e&&(this._hadFocus=e,this._onChange.fire(void 0))}hasFocus(){return this._hadFocus??!1}}class XUe{get length(){return this._decorationIds.length}constructor(e,t){this._editor=e,this._decorationIds=[],this._isChangingDecorations=!1,Array.isArray(t)&&t.length>0&&this.set(t)}onDidChange(e,t,i){return this._editor.onDidChangeModelDecorations(n=>{this._isChangingDecorations||e.call(t,n)},i)}getRange(e){return!this._editor.hasModel()||e>=this._decorationIds.length?null:this._editor.getModel().getDecorationRange(this._decorationIds[e])}getRanges(){if(!this._editor.hasModel())return[];const e=this._editor.getModel(),t=[];for(const i of this._decorationIds){const n=e.getDecorationRange(i);n&&t.push(n)}return t}has(e){return this._decorationIds.includes(e.id)}clear(){this._decorationIds.length!==0&&this.set([])}set(e){try{this._isChangingDecorations=!0,this._editor.changeDecorations(t=>{this._decorationIds=t.deltaDecorations(this._decorationIds,e)})}finally{this._isChangingDecorations=!1}return this._decorationIds}append(e){let t=[];try{this._isChangingDecorations=!0,this._editor.changeDecorations(i=>{t=i.deltaDecorations([],e),this._decorationIds=this._decorationIds.concat(t)})}finally{this._isChangingDecorations=!1}return t}}const ZUe=encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='"),JUe=encodeURIComponent("'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>");function gB(s){return ZUe+encodeURIComponent(s.toString())+JUe}const eje=encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" height="3" width="12"><g fill="'),tje=encodeURIComponent('"><circle cx="1" cy="1" r="1"/><circle cx="5" cy="1" r="1"/><circle cx="9" cy="1" r="1"/></g></svg>');function ije(s){return eje+encodeURIComponent(s.toString())+tje}Lc((s,e)=>{const t=s.getColor(xF);t&&e.addRule(`.monaco-editor .squiggly-error { background: url("data:image/svg+xml,${gB(t)}") repeat-x bottom left; }`);const i=s.getColor(Lg);i&&e.addRule(`.monaco-editor .squiggly-warning { background: url("data:image/svg+xml,${gB(i)}") repeat-x bottom left; }`);const n=s.getColor(Ph);n&&e.addRule(`.monaco-editor .squiggly-info { background: url("data:image/svg+xml,${gB(n)}") repeat-x bottom left; }`);const r=s.getColor(KOe);r&&e.addRule(`.monaco-editor .squiggly-hint { background: url("data:image/svg+xml,${ije(r)}") no-repeat bottom left; }`);const o=s.getColor(TVe);o&&e.addRule(`.monaco-editor.showUnused .squiggly-inline-unnecessary { opacity: ${o.rgba.a}; }`)});class _u{static capture(e){if(e.getScrollTop()===0||e.hasPendingScrollAnimation())return new _u(e.getScrollTop(),e.getContentHeight(),null,0,null);let t=null,i=0;const n=e.getVisibleRanges();if(n.length>0){t=n[0].getStartPosition();const r=e.getTopForPosition(t.lineNumber,t.column);i=e.getScrollTop()-r}return new _u(e.getScrollTop(),e.getContentHeight(),t,i,e.getPosition())}constructor(e,t,i,n,r){this._initialScrollTop=e,this._initialContentHeight=t,this._visiblePosition=i,this._visiblePositionScrollDelta=n,this._cursorPosition=r}restore(e){if(!(this._initialContentHeight===e.getContentHeight()&&this._initialScrollTop===e.getScrollTop())&&this._visiblePosition){const t=e.getTopForPosition(this._visiblePosition.lineNumber,this._visiblePosition.column);e.setScrollTop(t+this._visiblePositionScrollDelta)}}restoreRelativeVerticalPositionOfCursor(e){if(this._initialContentHeight===e.getContentHeight()&&this._initialScrollTop===e.getScrollTop())return;const t=e.getPosition();if(!this._cursorPosition||!t)return;const i=e.getTopForLineNumber(t.lineNumber)-e.getTopForLineNumber(this._cursorPosition.lineNumber);e.setScrollTop(e.getScrollTop()+i,1)}}function nje(s,e,t,i){if(s.length===0)return e;if(e.length===0)return s;const n=[];let r=0,o=0;for(;r<s.length&&o<e.length;){const a=s[r],l=e[o],c=t(a),d=t(l);c<d?(n.push(a),r++):c>d?(n.push(l),o++):(n.push(i(a,l)),r++,o++)}for(;r<s.length;)n.push(s[r]),r++;for(;o<e.length;)n.push(e[o]),o++;return n}function _P(s,e){const t=new ce,i=s.createDecorationsCollection();return t.add(tD({debugName:()=>`Apply decorations from ${e.debugName}`},n=>{const r=e.read(n);i.set(r)})),t.add({dispose:()=>{i.clear()}}),t}function FC(s,e){return s.appendChild(e),Ye(()=>{e.remove()})}function sje(s,e){return s.prepend(e),Ye(()=>{e.remove()})}class cme extends te{get width(){return this._width}get height(){return this._height}get automaticLayout(){return this._automaticLayout}constructor(e,t){super(),this._automaticLayout=!1,this.elementSizeObserver=this._register(new zpe(e,t)),this._width=Rt(this,this.elementSizeObserver.getWidth()),this._height=Rt(this,this.elementSizeObserver.getHeight()),this._register(this.elementSizeObserver.onDidChange(i=>pn(n=>{this._width.set(this.elementSizeObserver.getWidth(),n),this._height.set(this.elementSizeObserver.getHeight(),n)})))}observe(e){this.elementSizeObserver.observe(e)}setAutomaticLayout(e){this._automaticLayout=e,e?this.elementSizeObserver.startObserving():this.elementSizeObserver.stopObserving()}}function Xse(s,e,t){let i=e.get(),n=i,r=i;const o=Rt("animatedValue",i);let a=-1;const l=300;let c;t.add(iD({createEmptyChangeSummary:()=>({animate:!1}),handleChange:(u,h)=>(u.didChange(e)&&(h.animate=h.animate||u.change),!0)},(u,h)=>{c!==void 0&&(s.cancelAnimationFrame(c),c=void 0),n=r,i=e.read(u),a=Date.now()-(h.animate?0:l),d()}));function d(){const u=Date.now()-a;r=Math.floor(rje(u,n,i-n,l)),u<l?c=s.requestAnimationFrame(d):r=i,o.set(r,void 0)}return o}function rje(s,e,t,i){return s===i?e+t:t*(-Math.pow(2,-10*s/i)+1)+e}class HG extends te{constructor(e,t,i){super(),this._register(new KH(e,i)),this._register(Ig(i,{height:t.actualHeight,top:t.actualTop}))}}class VC{get afterLineNumber(){return this._afterLineNumber.get()}constructor(e,t){this._afterLineNumber=e,this.heightInPx=t,this.domNode=document.createElement("div"),this._actualTop=Rt(this,void 0),this._actualHeight=Rt(this,void 0),this.actualTop=this._actualTop,this.actualHeight=this._actualHeight,this.showInHiddenAreas=!0,this.onChange=this._afterLineNumber,this.onDomNodeTop=i=>{this._actualTop.set(i,void 0)},this.onComputedHeight=i=>{this._actualHeight.set(i,void 0)}}}const bO=class bO{constructor(e,t){this._editor=e,this._domElement=t,this._overlayWidgetId=`managedOverlayWidget-${bO._counter++}`,this._overlayWidget={getId:()=>this._overlayWidgetId,getDomNode:()=>this._domElement,getPosition:()=>null},this._editor.addOverlayWidget(this._overlayWidget)}dispose(){this._editor.removeOverlayWidget(this._overlayWidget)}};bO._counter=0;let KH=bO;function Ig(s,e){return ht(t=>{for(let[i,n]of Object.entries(e))n&&typeof n=="object"&&"read"in n&&(n=n.read(t)),typeof n=="number"&&(n=`${n}px`),i=i.replace(/[A-Z]/g,r=>"-"+r.toLowerCase()),s.style[i]=n})}function bP(s,e,t,i){const n=new ce,r=[];return n.add(Jo((o,a)=>{const l=e.read(o),c=new Map,d=new Map;t&&t(!0),s.changeViewZones(u=>{for(const h of r)u.removeZone(h),i==null||i.delete(h);r.length=0;for(const h of l){const g=u.addZone(h);h.setZoneId&&h.setZoneId(g),r.push(g),i==null||i.add(g),c.set(h,g)}}),t&&t(!1),a.add(iD({createEmptyChangeSummary(){return{zoneIds:[]}},handleChange(u,h){const g=d.get(u.changedObservable);return g!==void 0&&h.zoneIds.push(g),!0}},(u,h)=>{for(const g of l)g.onChange&&(d.set(g.onChange,c.get(g)),g.onChange.read(u));t&&t(!0),s.changeViewZones(g=>{for(const p of h.zoneIds)g.layoutZone(p)}),t&&t(!1)}))})),n.add({dispose(){t&&t(!0),s.changeViewZones(o=>{for(const a of r)o.removeZone(a)}),i==null||i.clear(),t&&t(!1)}}),n}class oje extends mn{dispose(){super.dispose(!0)}}function Zse(s,e){const t=oI(e,n=>n.original.startLineNumber<=s.lineNumber);if(!t)return F.fromPositions(s);if(t.original.endLineNumberExclusive<=s.lineNumber){const n=s.lineNumber-t.original.endLineNumberExclusive+t.modified.endLineNumberExclusive;return F.fromPositions(new X(n,s.column))}if(!t.innerChanges)return F.fromPositions(new X(t.modified.startLineNumber,1));const i=oI(t.innerChanges,n=>n.originalRange.getStartPosition().isBeforeOrEqual(s));if(!i){const n=s.lineNumber-t.original.startLineNumber+t.modified.startLineNumber;return F.fromPositions(new X(n,s.column))}if(i.originalRange.containsPosition(s))return i.modifiedRange;{const n=aje(i.originalRange.getEndPosition(),s);return F.fromPositions(n.addToPosition(i.modifiedRange.getEndPosition()))}}function aje(s,e){return s.lineNumber===e.lineNumber?new cd(0,e.column-s.column):new cd(e.lineNumber-s.lineNumber,e.column-1)}function lje(s,e){let t;return s.filter(i=>{const n=e(i,t);return t=i,n})}class vP{static create(e,t=void 0){return new Jse(e,e,t)}static createWithDisposable(e,t,i=void 0){const n=new ce;return n.add(t),n.add(e),new Jse(e,n,i)}}class Jse extends vP{constructor(e,t,i){super(),this.object=e,this._disposable=t,this._debugOwner=i,this._refCount=1,this._isDisposed=!1,this._owners=[],i&&this._addOwner(i)}_addOwner(e){e&&this._owners.push(e)}createNewRef(e){return this._refCount++,e&&this._addOwner(e),new cje(this,e)}dispose(){this._isDisposed||(this._isDisposed=!0,this._decreaseRefCount(this._debugOwner))}_decreaseRefCount(e){if(this._refCount--,this._refCount===0&&this._disposable.dispose(),e){const t=this._owners.indexOf(e);t!==-1&&this._owners.splice(t,1)}}}class cje extends vP{constructor(e,t){super(),this._base=e,this._debugOwner=t,this._isDisposed=!1}get object(){return this._base.object}createNewRef(e){return this._base.createNewRef(e)}dispose(){this._isDisposed||(this._isDisposed=!0,this._base._decreaseRefCount(this._debugOwner))}}var zG=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},UG=function(s,e){return function(t,i){e(t,i,s)}};const dje=Qi("diff-review-insert",xe.add,b("accessibleDiffViewerInsertIcon","Icon for 'Insert' in accessible diff viewer.")),uje=Qi("diff-review-remove",xe.remove,b("accessibleDiffViewerRemoveIcon","Icon for 'Remove' in accessible diff viewer.")),hje=Qi("diff-review-close",xe.close,b("accessibleDiffViewerCloseIcon","Icon for 'Close' in accessible diff viewer."));var Wy;let zb=(Wy=class extends te{constructor(e,t,i,n,r,o,a,l,c){super(),this._parentNode=e,this._visible=t,this._setVisible=i,this._canClose=n,this._width=r,this._height=o,this._diffs=a,this._models=l,this._instantiationService=c,this._state=__(this,(d,u)=>{const h=this._visible.read(d);if(this._parentNode.style.visibility=h?"visible":"hidden",!h)return null;const g=u.add(this._instantiationService.createInstance(GH,this._diffs,this._models,this._setVisible,this._canClose)),p=u.add(this._instantiationService.createInstance(QH,this._parentNode,g,this._width,this._height,this._models));return{model:g,view:p}}).recomputeInitiallyAndOnChange(this._store)}next(){pn(e=>{const t=this._visible.get();this._setVisible(!0,e),t&&this._state.get().model.nextGroup(e)})}prev(){pn(e=>{this._setVisible(!0,e),this._state.get().model.previousGroup(e)})}close(){pn(e=>{this._setVisible(!1,e)})}},Wy._ttPolicy=Og("diffReview",{createHTML:e=>e}),Wy);zb=zG([UG(8,Xe)],zb);let GH=class extends te{constructor(e,t,i,n,r){super(),this._diffs=e,this._models=t,this._setVisible=i,this.canClose=n,this._accessibilitySignalService=r,this._groups=Rt(this,[]),this._currentGroupIdx=Rt(this,0),this._currentElementIdx=Rt(this,0),this.groups=this._groups,this.currentGroup=this._currentGroupIdx.map((o,a)=>this._groups.read(a)[o]),this.currentGroupIndex=this._currentGroupIdx,this.currentElement=this._currentElementIdx.map((o,a)=>{var l;return(l=this.currentGroup.read(a))==null?void 0:l.lines[o]}),this._register(ht(o=>{const a=this._diffs.read(o);if(!a){this._groups.set([],void 0);return}const l=fje(a,this._models.getOriginalModel().getLineCount(),this._models.getModifiedModel().getLineCount());pn(c=>{const d=this._models.getModifiedPosition();if(d){const u=l.findIndex(h=>(d==null?void 0:d.lineNumber)<h.range.modified.endLineNumberExclusive);u!==-1&&this._currentGroupIdx.set(u,c)}this._groups.set(l,c)})})),this._register(ht(o=>{const a=this.currentElement.read(o);(a==null?void 0:a.type)===go.Deleted?this._accessibilitySignalService.playSignal(fl.diffLineDeleted,{source:"accessibleDiffViewer.currentElementChanged"}):(a==null?void 0:a.type)===go.Added&&this._accessibilitySignalService.playSignal(fl.diffLineInserted,{source:"accessibleDiffViewer.currentElementChanged"})})),this._register(ht(o=>{const a=this.currentElement.read(o);if(a&&a.type!==go.Header){const l=a.modifiedLineNumber??a.diff.modified.startLineNumber;this._models.modifiedSetSelection(F.fromPositions(new X(l,1)))}}))}_goToGroupDelta(e,t){const i=this.groups.get();!i||i.length<=1||bw(t,n=>{this._currentGroupIdx.set(Mt.ofLength(i.length).clipCyclic(this._currentGroupIdx.get()+e),n),this._currentElementIdx.set(0,n)})}nextGroup(e){this._goToGroupDelta(1,e)}previousGroup(e){this._goToGroupDelta(-1,e)}_goToLineDelta(e){const t=this.currentGroup.get();!t||t.lines.length<=1||pn(i=>{this._currentElementIdx.set(Mt.ofLength(t.lines.length).clip(this._currentElementIdx.get()+e),i)})}goToNextLine(){this._goToLineDelta(1)}goToPreviousLine(){this._goToLineDelta(-1)}goToLine(e){const t=this.currentGroup.get();if(!t)return;const i=t.lines.indexOf(e);i!==-1&&pn(n=>{this._currentElementIdx.set(i,n)})}revealCurrentElementInEditor(){if(!this.canClose.get())return;this._setVisible(!1,void 0);const e=this.currentElement.get();e&&(e.type===go.Deleted?this._models.originalReveal(F.fromPositions(new X(e.originalLineNumber,1))):this._models.modifiedReveal(e.type!==go.Header?F.fromPositions(new X(e.modifiedLineNumber,1)):void 0))}close(){this.canClose.get()&&(this._setVisible(!1,void 0),this._models.modifiedFocus())}};GH=zG([UG(4,v_)],GH);const Ox=3;function fje(s,e,t){const i=[];for(const n of gq(s,(r,o)=>o.modified.startLineNumber-r.modified.endLineNumberExclusive<2*Ox)){const r=[];r.push(new pje);const o=new Ct(Math.max(1,n[0].original.startLineNumber-Ox),Math.min(n[n.length-1].original.endLineNumberExclusive+Ox,e+1)),a=new Ct(Math.max(1,n[0].modified.startLineNumber-Ox),Math.min(n[n.length-1].modified.endLineNumberExclusive+Ox,t+1));qde(n,(d,u)=>{const h=new Ct(d?d.original.endLineNumberExclusive:o.startLineNumber,u?u.original.startLineNumber:o.endLineNumberExclusive),g=new Ct(d?d.modified.endLineNumberExclusive:a.startLineNumber,u?u.modified.startLineNumber:a.endLineNumberExclusive);h.forEach(p=>{r.push(new bje(p,g.startLineNumber+(p-h.startLineNumber)))}),u&&(u.original.forEach(p=>{r.push(new mje(u,p))}),u.modified.forEach(p=>{r.push(new _je(u,p))}))});const l=n[0].modified.join(n[n.length-1].modified),c=n[0].original.join(n[n.length-1].original);i.push(new gje(new Qr(l,c),r))}return i}var go;(function(s){s[s.Header=0]="Header",s[s.Unchanged=1]="Unchanged",s[s.Deleted=2]="Deleted",s[s.Added=3]="Added"})(go||(go={}));class gje{constructor(e,t){this.range=e,this.lines=t}}class pje{constructor(){this.type=go.Header}}class mje{constructor(e,t){this.diff=e,this.originalLineNumber=t,this.type=go.Deleted,this.modifiedLineNumber=void 0}}class _je{constructor(e,t){this.diff=e,this.modifiedLineNumber=t,this.type=go.Added,this.originalLineNumber=void 0}}class bje{constructor(e,t){this.originalLineNumber=e,this.modifiedLineNumber=t,this.type=go.Unchanged}}let QH=class extends te{constructor(e,t,i,n,r,o){super(),this._element=e,this._model=t,this._width=i,this._height=n,this._models=r,this._languageService=o,this.domNode=this._element,this.domNode.className="monaco-component diff-review monaco-editor-background";const a=document.createElement("div");a.className="diff-review-actions",this._actionBar=this._register(new Dl(a)),this._register(ht(l=>{this._actionBar.clear(),this._model.canClose.read(l)&&this._actionBar.push(new Na("diffreview.close",b("label.close","Close"),"close-diff-review "+at.asClassName(hje),!0,async()=>t.close()),{label:!1,icon:!0})})),this._content=document.createElement("div"),this._content.className="diff-review-content",this._content.setAttribute("role","code"),this._scrollbar=this._register(new QE(this._content,{})),Xs(this.domNode,this._scrollbar.getDomNode(),a),this._register(ht(l=>{this._height.read(l),this._width.read(l),this._scrollbar.scanDomNode()})),this._register(Ye(()=>{Xs(this.domNode)})),this._register(Ig(this.domNode,{width:this._width,height:this._height})),this._register(Ig(this._content,{width:this._width,height:this._height})),this._register(Jo((l,c)=>{this._model.currentGroup.read(l),this._render(c)})),this._register(yn(this.domNode,"keydown",l=>{(l.equals(18)||l.equals(2066)||l.equals(530))&&(l.preventDefault(),this._model.goToNextLine()),(l.equals(16)||l.equals(2064)||l.equals(528))&&(l.preventDefault(),this._model.goToPreviousLine()),(l.equals(9)||l.equals(2057)||l.equals(521)||l.equals(1033))&&(l.preventDefault(),this._model.close()),(l.equals(10)||l.equals(3))&&(l.preventDefault(),this._model.revealCurrentElementInEditor())}))}_render(e){const t=this._models.getOriginalOptions(),i=this._models.getModifiedOptions(),n=document.createElement("div");n.className="diff-review-table",n.setAttribute("role","list"),n.setAttribute("aria-label",b("ariaLabel","Accessible Diff Viewer. Use arrow up and down to navigate.")),Zs(n,i.get(50)),Xs(this._content,n);const r=this._models.getOriginalModel(),o=this._models.getModifiedModel();if(!r||!o)return;const a=r.getOptions(),l=o.getOptions(),c=i.get(67),d=this._model.currentGroup.get();for(const u of(d==null?void 0:d.lines)||[]){if(!d)break;let h;if(u.type===go.Header){const p=document.createElement("div");p.className="diff-review-row",p.setAttribute("role","listitem");const _=d.range,v=this._model.currentGroupIndex.get(),C=this._model.groups.get().length,y=A=>A===0?b("no_lines_changed","no lines changed"):A===1?b("one_line_changed","1 line changed"):b("more_lines_changed","{0} lines changed",A),x=y(_.original.length),L=y(_.modified.length);p.setAttribute("aria-label",b({key:"header",comment:["This is the ARIA label for a git diff header.","A git diff header looks like this: @@ -154,12 +159,39 @@.","That encodes that at original line 154 (which is now line 159), 12 lines were removed/changed with 39 lines.","Variables 0 and 1 refer to the diff index out of total number of diffs.","Variables 2 and 4 will be numbers (a line number).",'Variables 3 and 5 will be "no lines changed", "1 line changed" or "X lines changed", localized separately.']},"Difference {0} of {1}: original line {2}, {3}, modified line {4}, {5}",v+1,C,_.original.startLineNumber,x,_.modified.startLineNumber,L));const I=document.createElement("div");I.className="diff-review-cell diff-review-summary",I.appendChild(document.createTextNode(`${v+1}/${C}: @@ -${_.original.startLineNumber},${_.original.length} +${_.modified.startLineNumber},${_.modified.length} @@`)),p.appendChild(I),h=p}else h=this._createRow(u,c,this._width.get(),t,r,a,i,o,l);n.appendChild(h);const g=qe(p=>this._model.currentElement.read(p)===u);e.add(ht(p=>{const _=g.read(p);h.tabIndex=_?0:-1,_&&h.focus()})),e.add(oe(h,"focus",()=>{this._model.goToLine(u)}))}this._scrollbar.scanDomNode()}_createRow(e,t,i,n,r,o,a,l,c){const d=n.get(146),u=d.glyphMarginWidth+d.lineNumbersWidth,h=a.get(146),g=10+h.glyphMarginWidth+h.lineNumbersWidth;let p="diff-review-row",_="";const v="diff-review-spacer";let C=null;switch(e.type){case go.Added:p="diff-review-row line-insert",_=" char-insert",C=dje;break;case go.Deleted:p="diff-review-row line-delete",_=" char-delete",C=uje;break}const y=document.createElement("div");y.style.minWidth=i+"px",y.className=p,y.setAttribute("role","listitem"),y.ariaLevel="";const x=document.createElement("div");x.className="diff-review-cell",x.style.height=`${t}px`,y.appendChild(x);const L=document.createElement("span");L.style.width=u+"px",L.style.minWidth=u+"px",L.className="diff-review-line-number"+_,e.originalLineNumber!==void 0?L.appendChild(document.createTextNode(String(e.originalLineNumber))):L.innerText=" ",x.appendChild(L);const I=document.createElement("span");I.style.width=g+"px",I.style.minWidth=g+"px",I.style.paddingRight="10px",I.className="diff-review-line-number"+_,e.modifiedLineNumber!==void 0?I.appendChild(document.createTextNode(String(e.modifiedLineNumber))):I.innerText=" ",x.appendChild(I);const A=document.createElement("span");if(A.className=v,C){const R=document.createElement("span");R.className=at.asClassName(C),R.innerText="  ",A.appendChild(R)}else A.innerText="  ";x.appendChild(A);let D;if(e.modifiedLineNumber!==void 0){let R=this._getLineHtml(l,a,c.tabSize,e.modifiedLineNumber,this._languageService.languageIdCodec);zb._ttPolicy&&(R=zb._ttPolicy.createHTML(R)),x.insertAdjacentHTML("beforeend",R),D=l.getLineContent(e.modifiedLineNumber)}else{let R=this._getLineHtml(r,n,o.tabSize,e.originalLineNumber,this._languageService.languageIdCodec);zb._ttPolicy&&(R=zb._ttPolicy.createHTML(R)),x.insertAdjacentHTML("beforeend",R),D=r.getLineContent(e.originalLineNumber)}D.length===0&&(D=b("blankLine","blank"));let N="";switch(e.type){case go.Unchanged:e.originalLineNumber===e.modifiedLineNumber?N=b({key:"unchangedLine",comment:["The placeholders are contents of the line and should not be translated."]},"{0} unchanged line {1}",D,e.originalLineNumber):N=b("equalLine","{0} original line {1} modified line {2}",D,e.originalLineNumber,e.modifiedLineNumber);break;case go.Added:N=b("insertLine","+ {0} modified line {1}",D,e.modifiedLineNumber);break;case go.Deleted:N=b("deleteLine","- {0} original line {1}",D,e.originalLineNumber);break}return y.setAttribute("aria-label",N),y}_getLineHtml(e,t,i,n,r){const o=e.getLineContent(n),a=t.get(50),l=Ws.createEmpty(o,r),c=Pl.isBasicASCII(o,e.mightContainNonBasicASCII()),d=Pl.containsRTL(o,c,e.mightContainRTL());return JF(new w_(a.isMonospace&&!t.get(33),a.canUseHalfwidthRightwardsArrow,o,!1,c,d,0,l,[],i,0,a.spaceWidth,a.middotWidth,a.wsmiddotWidth,t.get(118),t.get(100),t.get(95),t.get(51)!==Bm.OFF,null)).html}};QH=zG([UG(5,un)],QH);class vje{constructor(e){this.editors=e}getOriginalModel(){return this.editors.original.getModel()}getOriginalOptions(){return this.editors.original.getOptions()}originalReveal(e){this.editors.original.revealRange(e),this.editors.original.setSelection(e),this.editors.original.focus()}getModifiedModel(){return this.editors.modified.getModel()}getModifiedOptions(){return this.editors.modified.getOptions()}modifiedReveal(e){e&&(this.editors.modified.revealRange(e),this.editors.modified.setSelection(e)),this.editors.modified.focus()}modifiedSetSelection(e){this.editors.modified.setSelection(e)}modifiedFocus(){this.editors.modified.focus()}getModifiedPosition(){return this.editors.modified.getPosition()??void 0}}j("diffEditor.move.border","#8b8b8b9c",b("diffEditor.move.border","The border color for text that got moved in the diff editor."));j("diffEditor.moveActive.border","#FFA500",b("diffEditor.moveActive.border","The active border color for text that got moved in the diff editor."));j("diffEditor.unchangedRegionShadow",{dark:"#000000",light:"#737373BF",hcDark:"#000000",hcLight:"#737373BF"},b("diffEditor.unchangedRegionShadow","The color of the shadow around unchanged region widgets."));const wje=Qi("diff-insert",xe.add,b("diffInsertIcon","Line decoration for inserts in the diff editor.")),dme=Qi("diff-remove",xe.remove,b("diffRemoveIcon","Line decoration for removals in the diff editor.")),wP=_t.register({className:"line-insert",description:"line-insert",isWholeLine:!0,linesDecorationsClassName:"insert-sign "+at.asClassName(wje),marginClassName:"gutter-insert"}),qI=_t.register({className:"line-delete",description:"line-delete",isWholeLine:!0,linesDecorationsClassName:"delete-sign "+at.asClassName(dme),marginClassName:"gutter-delete"}),ere=_t.register({className:"line-insert",description:"line-insert",isWholeLine:!0,marginClassName:"gutter-insert"}),tre=_t.register({className:"line-delete",description:"line-delete",isWholeLine:!0,marginClassName:"gutter-delete"}),CP=_t.register({className:"char-insert",description:"char-insert",shouldFillLineOnLineBreak:!0}),jG=_t.register({className:"char-insert",description:"char-insert",isWholeLine:!0}),$G=_t.register({className:"char-insert diff-range-empty",description:"char-insert diff-range-empty"}),P1=_t.register({className:"char-delete",description:"char-delete",shouldFillLineOnLineBreak:!0}),qG=_t.register({className:"char-delete",description:"char-delete",isWholeLine:!0}),KG=_t.register({className:"char-delete diff-range-empty",description:"char-delete diff-range-empty"});var ume=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},YH=function(s,e){return function(t,i){e(t,i,s)}},ub;const hD=Ht("diffProviderFactoryService");let XH=class{constructor(e){this.instantiationService=e}createDiffProvider(e){return this.instantiationService.createInstance(ZH,e)}};XH=ume([YH(0,Xe)],XH);qt(hD,XH,1);var gv;let ZH=(gv=class{constructor(e,t,i){this.editorWorkerService=t,this.telemetryService=i,this.onDidChangeEventEmitter=new Z,this.onDidChange=this.onDidChangeEventEmitter.event,this.diffAlgorithm="advanced",this.diffAlgorithmOnDidChangeSubscription=void 0,this.setOptions(e)}dispose(){var e;(e=this.diffAlgorithmOnDidChangeSubscription)==null||e.dispose()}async computeDiff(e,t,i,n){if(typeof this.diffAlgorithm!="string")return this.diffAlgorithm.computeDiff(e,t,i,n);if(e.isDisposed()||t.isDisposed())return{changes:[],identical:!0,quitEarly:!1,moves:[]};if(e.getLineCount()===1&&e.getLineMaxColumn(1)===1)return t.getLineCount()===1&&t.getLineMaxColumn(1)===1?{changes:[],identical:!0,quitEarly:!1,moves:[]}:{changes:[new El(new Ct(1,2),new Ct(1,t.getLineCount()+1),[new hl(e.getFullModelRange(),t.getFullModelRange())])],identical:!1,quitEarly:!1,moves:[]};const r=JSON.stringify([e.uri.toString(),t.uri.toString()]),o=JSON.stringify([e.id,t.id,e.getAlternativeVersionId(),t.getAlternativeVersionId(),JSON.stringify(i)]),a=ub.diffCache.get(r);if(a&&a.context===o)return a.result;const l=Bs.create(),c=await this.editorWorkerService.computeDiff(e.uri,t.uri,i,this.diffAlgorithm),d=l.elapsed();if(this.telemetryService.publicLog2("diffEditor.computeDiff",{timeMs:d,timedOut:(c==null?void 0:c.quitEarly)??!0,detectedMoves:i.computeMoves?(c==null?void 0:c.moves.length)??0:-1}),n.isCancellationRequested)return{changes:[],identical:!1,quitEarly:!0,moves:[]};if(!c)throw new Error("no diff result available");return ub.diffCache.size>10&&ub.diffCache.delete(ub.diffCache.keys().next().value),ub.diffCache.set(r,{result:c,context:o}),c}setOptions(e){var i;let t=!1;e.diffAlgorithm&&this.diffAlgorithm!==e.diffAlgorithm&&((i=this.diffAlgorithmOnDidChangeSubscription)==null||i.dispose(),this.diffAlgorithmOnDidChangeSubscription=void 0,this.diffAlgorithm=e.diffAlgorithm,typeof e.diffAlgorithm!="string"&&(this.diffAlgorithmOnDidChangeSubscription=e.diffAlgorithm.onDidChange(()=>this.onDidChangeEventEmitter.fire())),t=!0),t&&this.onDidChangeEventEmitter.fire()}},ub=gv,gv.diffCache=new Map,gv);ZH=ub=ume([YH(1,ca),YH(2,Tr)],ZH);function o5(){return W7&&!!W7.VSCODE_DEV}function hme(s){if(o5()){const e=Cje();return e.add(s),{dispose(){e.delete(s)}}}else return{dispose(){}}}function Cje(){MN||(MN=new Set);const s=globalThis;return s.$hotReload_applyNewExports||(s.$hotReload_applyNewExports=e=>{const t={config:{mode:void 0},...e},i=[];for(const n of MN){const r=n(t);r&&i.push(r)}if(i.length>0)return n=>{let r=!1;for(const o of i)o(n)&&(r=!0);return r}}),MN}let MN;o5()&&hme(({oldExports:s,newSrc:e,config:t})=>{if(t.mode==="patch-prototype")return i=>{var n,r;for(const o in i){const a=i[o];if(console.log(`[hot-reload] Patching prototype methods of '${o}'`,{exportedItem:a}),typeof a=="function"&&a.prototype){const l=s[o];if(l){for(const c of Object.getOwnPropertyNames(a.prototype)){const d=Object.getOwnPropertyDescriptor(a.prototype,c),u=Object.getOwnPropertyDescriptor(l.prototype,c);((n=d==null?void 0:d.value)==null?void 0:n.toString())!==((r=u==null?void 0:u.value)==null?void 0:r.toString())&&console.log(`[hot-reload] Patching prototype method '${o}.${c}'`),Object.defineProperty(l.prototype,c,d)}i[o]=l}}}return!0}});function xa(s,e){return yje([s],e),s}function yje(s,e){o5()&&cr("reload",i=>hme(({oldExports:n})=>{if([...Object.values(n)].some(r=>s.includes(r)))return r=>(i(void 0),!0)})).read(e)}var Sje=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},xje=function(s,e){return function(t,i){e(t,i,s)}};let JH=class extends te{setActiveMovedText(e){this._activeMovedText.set(e,void 0)}constructor(e,t,i){super(),this.model=e,this._options=t,this._diffProviderFactoryService=i,this._isDiffUpToDate=Rt(this,!1),this.isDiffUpToDate=this._isDiffUpToDate,this._diff=Rt(this,void 0),this.diff=this._diff,this._unchangedRegions=Rt(this,void 0),this.unchangedRegions=qe(this,a=>{var l;return this._options.hideUnchangedRegions.read(a)?((l=this._unchangedRegions.read(a))==null?void 0:l.regions)??[]:(pn(c=>{var d;for(const u of((d=this._unchangedRegions.get())==null?void 0:d.regions)||[])u.collapseAll(c)}),[])}),this.movedTextToCompare=Rt(this,void 0),this._activeMovedText=Rt(this,void 0),this._hoveredMovedText=Rt(this,void 0),this.activeMovedText=qe(this,a=>this.movedTextToCompare.read(a)??this._hoveredMovedText.read(a)??this._activeMovedText.read(a)),this._cancellationTokenSource=new mn,this._diffProvider=qe(this,a=>{const l=this._diffProviderFactoryService.createDiffProvider({diffAlgorithm:this._options.diffAlgorithm.read(a)}),c=cr("onDidChange",l.onDidChange);return{diffProvider:l,onChangeSignal:c}}),this._register(Ye(()=>this._cancellationTokenSource.cancel()));const n=vS("contentChangedSignal"),r=this._register(new xi(()=>n.trigger(void 0),200));this._register(ht(a=>{const l=this._unchangedRegions.read(a);if(!l||l.regions.some(p=>p.isDragged.read(a)))return;const c=l.originalDecorationIds.map(p=>e.original.getDecorationRange(p)).map(p=>p?Ct.fromRangeInclusive(p):void 0),d=l.modifiedDecorationIds.map(p=>e.modified.getDecorationRange(p)).map(p=>p?Ct.fromRangeInclusive(p):void 0),u=l.regions.map((p,_)=>!c[_]||!d[_]?void 0:new Xp(c[_].startLineNumber,d[_].startLineNumber,c[_].length,p.visibleLineCountTop.read(a),p.visibleLineCountBottom.read(a))).filter(Ch),h=[];let g=!1;for(const p of gq(u,(_,v)=>_.getHiddenModifiedRange(a).endLineNumberExclusive===v.getHiddenModifiedRange(a).startLineNumber))if(p.length>1){g=!0;const _=p.reduce((C,y)=>C+y.lineCount,0),v=new Xp(p[0].originalLineNumber,p[0].modifiedLineNumber,_,p[0].visibleLineCountTop.get(),p[p.length-1].visibleLineCountBottom.get());h.push(v)}else h.push(p[0]);if(g){const p=e.original.deltaDecorations(l.originalDecorationIds,h.map(v=>({range:v.originalUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}}))),_=e.modified.deltaDecorations(l.modifiedDecorationIds,h.map(v=>({range:v.modifiedUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}})));pn(v=>{this._unchangedRegions.set({regions:h,originalDecorationIds:p,modifiedDecorationIds:_},v)})}}));const o=(a,l,c)=>{const d=Xp.fromDiffs(a.changes,e.original.getLineCount(),e.modified.getLineCount(),this._options.hideUnchangedRegionsMinimumLineCount.read(c),this._options.hideUnchangedRegionsContextLineCount.read(c));let u;const h=this._unchangedRegions.get();if(h){const v=h.originalDecorationIds.map(L=>e.original.getDecorationRange(L)).map(L=>L?Ct.fromRangeInclusive(L):void 0),C=h.modifiedDecorationIds.map(L=>e.modified.getDecorationRange(L)).map(L=>L?Ct.fromRangeInclusive(L):void 0);let x=lje(h.regions.map((L,I)=>{if(!v[I]||!C[I])return;const A=v[I].length;return new Xp(v[I].startLineNumber,C[I].startLineNumber,A,Math.min(L.visibleLineCountTop.get(),A),Math.min(L.visibleLineCountBottom.get(),A-L.visibleLineCountTop.get()))}).filter(Ch),(L,I)=>!I||L.modifiedLineNumber>=I.modifiedLineNumber+I.lineCount&&L.originalLineNumber>=I.originalLineNumber+I.lineCount).map(L=>new Qr(L.getHiddenOriginalRange(c),L.getHiddenModifiedRange(c)));x=Qr.clip(x,Ct.ofLength(1,e.original.getLineCount()),Ct.ofLength(1,e.modified.getLineCount())),u=Qr.inverse(x,e.original.getLineCount(),e.modified.getLineCount())}const g=[];if(u)for(const v of d){const C=u.filter(y=>y.original.intersectsStrict(v.originalUnchangedRange)&&y.modified.intersectsStrict(v.modifiedUnchangedRange));g.push(...v.setVisibleRanges(C,l))}else g.push(...d);const p=e.original.deltaDecorations((h==null?void 0:h.originalDecorationIds)||[],g.map(v=>({range:v.originalUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}}))),_=e.modified.deltaDecorations((h==null?void 0:h.modifiedDecorationIds)||[],g.map(v=>({range:v.modifiedUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}})));this._unchangedRegions.set({regions:g,originalDecorationIds:p,modifiedDecorationIds:_},l)};this._register(e.modified.onDidChangeContent(a=>{if(this._diff.get()){const c=Qf.fromModelContentChanges(a.changes);this._lastDiff,e.original,e.modified}this._isDiffUpToDate.set(!1,void 0),r.schedule()})),this._register(e.original.onDidChangeContent(a=>{if(this._diff.get()){const c=Qf.fromModelContentChanges(a.changes);this._lastDiff,e.original,e.modified}this._isDiffUpToDate.set(!1,void 0),r.schedule()})),this._register(Jo(async(a,l)=>{this._options.hideUnchangedRegionsMinimumLineCount.read(a),this._options.hideUnchangedRegionsContextLineCount.read(a),r.cancel(),n.read(a);const c=this._diffProvider.read(a);c.onChangeSignal.read(a),xa(Ohe,a),xa(f6,a),this._isDiffUpToDate.set(!1,void 0);let d=[];l.add(e.original.onDidChangeContent(g=>{const p=Qf.fromModelContentChanges(g.changes);d=AA(d,p)}));let u=[];l.add(e.modified.onDidChangeContent(g=>{const p=Qf.fromModelContentChanges(g.changes);u=AA(u,p)}));let h=await c.diffProvider.computeDiff(e.original,e.modified,{ignoreTrimWhitespace:this._options.ignoreTrimWhitespace.read(a),maxComputationTimeMs:this._options.maxComputationTimeMs.read(a),computeMoves:this._options.showMoves.read(a)},this._cancellationTokenSource.token);this._cancellationTokenSource.token.isCancellationRequested||e.original.isDisposed()||e.modified.isDisposed()||(h=Lje(h,e.original,e.modified),h=(e.original,e.modified,void 0)??h,h=(e.original,e.modified,void 0)??h,pn(g=>{o(h,g),this._lastDiff=h;const p=GG.fromDiffResult(h);this._diff.set(p,g),this._isDiffUpToDate.set(!0,g);const _=this.movedTextToCompare.get();this.movedTextToCompare.set(_?this._lastDiff.moves.find(v=>v.lineRangeMapping.modified.intersect(_.lineRangeMapping.modified)):void 0,g)}))}))}ensureModifiedLineIsVisible(e,t,i){var r,o;if(((r=this.diff.get())==null?void 0:r.mappings.length)===0)return;const n=((o=this._unchangedRegions.get())==null?void 0:o.regions)||[];for(const a of n)if(a.getHiddenModifiedRange(void 0).contains(e)){a.showModifiedLine(e,t,i);return}}ensureOriginalLineIsVisible(e,t,i){var r,o;if(((r=this.diff.get())==null?void 0:r.mappings.length)===0)return;const n=((o=this._unchangedRegions.get())==null?void 0:o.regions)||[];for(const a of n)if(a.getHiddenOriginalRange(void 0).contains(e)){a.showOriginalLine(e,t,i);return}}async waitForDiff(){await ege(this.isDiffUpToDate,e=>e)}serializeState(){const e=this._unchangedRegions.get();return{collapsedRegions:e==null?void 0:e.regions.map(t=>({range:t.getHiddenModifiedRange(void 0).serialize()}))}}restoreSerializedState(e){var n;const t=(n=e.collapsedRegions)==null?void 0:n.map(r=>Ct.deserialize(r.range)),i=this._unchangedRegions.get();!i||!t||pn(r=>{for(const o of i.regions)for(const a of t)if(o.modifiedUnchangedRange.intersect(a)){o.setHiddenModifiedRange(a,r);break}})}};JH=Sje([xje(2,hD)],JH);function Lje(s,e,t){return{changes:s.changes.map(i=>new El(i.original,i.modified,i.innerChanges?i.innerChanges.map(n=>kje(n,e,t)):void 0)),moves:s.moves,identical:s.identical,quitEarly:s.quitEarly}}function kje(s,e,t){let i=s.originalRange,n=s.modifiedRange;return i.startColumn===1&&n.startColumn===1&&(i.endColumn!==1||n.endColumn!==1)&&i.endColumn===e.getLineMaxColumn(i.endLineNumber)&&n.endColumn===t.getLineMaxColumn(n.endLineNumber)&&i.endLineNumber<e.getLineCount()&&n.endLineNumber<t.getLineCount()&&(i=i.setEndPosition(i.endLineNumber+1,1),n=n.setEndPosition(n.endLineNumber+1,1)),new hl(i,n)}class GG{static fromDiffResult(e){return new GG(e.changes.map(t=>new fme(t)),e.moves||[],e.identical,e.quitEarly)}constructor(e,t,i,n){this.mappings=e,this.movedTexts=t,this.identical=i,this.quitEarly=n}}class fme{constructor(e){this.lineRangeMapping=e}}class Xp{static fromDiffs(e,t,i,n,r){const o=El.inverse(e,t,i),a=[];for(const l of o){let c=l.original.startLineNumber,d=l.modified.startLineNumber,u=l.original.length;const h=c===1&&d===1,g=c+u===t+1&&d+u===i+1;(h||g)&&u>=r+n?(h&&!g&&(u-=r),g&&!h&&(c+=r,d+=r,u-=r),a.push(new Xp(c,d,u,0,0))):u>=r*2+n&&(c+=r,d+=r,u-=r*2,a.push(new Xp(c,d,u,0,0)))}return a}get originalUnchangedRange(){return Ct.ofLength(this.originalLineNumber,this.lineCount)}get modifiedUnchangedRange(){return Ct.ofLength(this.modifiedLineNumber,this.lineCount)}constructor(e,t,i,n,r){this.originalLineNumber=e,this.modifiedLineNumber=t,this.lineCount=i,this._visibleLineCountTop=Rt(this,0),this.visibleLineCountTop=this._visibleLineCountTop,this._visibleLineCountBottom=Rt(this,0),this.visibleLineCountBottom=this._visibleLineCountBottom,this._shouldHideControls=qe(this,l=>this.visibleLineCountTop.read(l)+this.visibleLineCountBottom.read(l)===this.lineCount&&!this.isDragged.read(l)),this.isDragged=Rt(this,void 0);const o=Math.max(Math.min(n,this.lineCount),0),a=Math.max(Math.min(r,this.lineCount-n),0);mte(n===o),mte(r===a),this._visibleLineCountTop.set(o,void 0),this._visibleLineCountBottom.set(a,void 0)}setVisibleRanges(e,t){const i=[],n=new lc(e.map(l=>l.modified)).subtractFrom(this.modifiedUnchangedRange);let r=this.originalLineNumber,o=this.modifiedLineNumber;const a=this.modifiedLineNumber+this.lineCount;if(n.ranges.length===0)this.showAll(t),i.push(this);else{let l=0;for(const c of n.ranges){const d=l===n.ranges.length-1;l++;const u=(d?a:c.endLineNumberExclusive)-o,h=new Xp(r,o,u,0,0);h.setHiddenModifiedRange(c,t),i.push(h),r=h.originalUnchangedRange.endLineNumberExclusive,o=h.modifiedUnchangedRange.endLineNumberExclusive}}return i}shouldHideControls(e){return this._shouldHideControls.read(e)}getHiddenOriginalRange(e){return Ct.ofLength(this.originalLineNumber+this._visibleLineCountTop.read(e),this.lineCount-this._visibleLineCountTop.read(e)-this._visibleLineCountBottom.read(e))}getHiddenModifiedRange(e){return Ct.ofLength(this.modifiedLineNumber+this._visibleLineCountTop.read(e),this.lineCount-this._visibleLineCountTop.read(e)-this._visibleLineCountBottom.read(e))}setHiddenModifiedRange(e,t){const i=e.startLineNumber-this.modifiedLineNumber,n=this.modifiedLineNumber+this.lineCount-e.endLineNumberExclusive;this.setState(i,n,t)}getMaxVisibleLineCountTop(){return this.lineCount-this._visibleLineCountBottom.get()}getMaxVisibleLineCountBottom(){return this.lineCount-this._visibleLineCountTop.get()}showMoreAbove(e=10,t){const i=this.getMaxVisibleLineCountTop();this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+e,i),t)}showMoreBelow(e=10,t){const i=this.lineCount-this._visibleLineCountTop.get();this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+e,i),t)}showAll(e){this._visibleLineCountBottom.set(this.lineCount-this._visibleLineCountTop.get(),e)}showModifiedLine(e,t,i){const n=e+1-(this.modifiedLineNumber+this._visibleLineCountTop.get()),r=this.modifiedLineNumber-this._visibleLineCountBottom.get()+this.lineCount-e;t===0&&n<r||t===1?this._visibleLineCountTop.set(this._visibleLineCountTop.get()+n,i):this._visibleLineCountBottom.set(this._visibleLineCountBottom.get()+r,i)}showOriginalLine(e,t,i){const n=e-this.originalLineNumber,r=this.originalLineNumber+this.lineCount-e;t===0&&n<r||t===1?this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+r-n,this.getMaxVisibleLineCountTop()),i):this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+n-r,this.getMaxVisibleLineCountBottom()),i)}collapseAll(e){this._visibleLineCountTop.set(0,e),this._visibleLineCountBottom.set(0,e)}setState(e,t,i){e=Math.max(Math.min(e,this.lineCount),0),t=Math.max(Math.min(t,this.lineCount-e),0),this._visibleLineCountTop.set(e,i),this._visibleLineCountBottom.set(t,i)}}class Ije extends te{get visibility(){return this._visibility}set visibility(e){this._visibility!==e&&(this._visibility=e,this._diffActions.style.visibility=e?"visible":"hidden")}constructor(e,t,i,n,r,o,a,l,c){super(),this._getViewZoneId=e,this._marginDomNode=t,this._modifiedEditor=i,this._diff=n,this._editor=r,this._viewLineCounts=o,this._originalTextModel=a,this._contextMenuService=l,this._clipboardService=c,this._visibility=!1,this._marginDomNode.style.zIndex="10",this._diffActions=document.createElement("div"),this._diffActions.className=at.asClassName(xe.lightBulb)+" lightbulb-glyph",this._diffActions.style.position="absolute";const d=this._modifiedEditor.getOption(67);this._diffActions.style.right="0px",this._diffActions.style.visibility="hidden",this._diffActions.style.height=`${d}px`,this._diffActions.style.lineHeight=`${d}px`,this._marginDomNode.appendChild(this._diffActions);let u=0;const h=i.getOption(128)&&!du,g=(p,_)=>{this._contextMenuService.showContextMenu({domForShadowRoot:h?i.getDomNode()??void 0:void 0,getAnchor:()=>({x:p,y:_}),getActions:()=>{const v=[],C=n.modified.isEmpty;return v.push(new Na("diff.clipboard.copyDeletedContent",C?n.original.length>1?b("diff.clipboard.copyDeletedLinesContent.label","Copy deleted lines"):b("diff.clipboard.copyDeletedLinesContent.single.label","Copy deleted line"):n.original.length>1?b("diff.clipboard.copyChangedLinesContent.label","Copy changed lines"):b("diff.clipboard.copyChangedLinesContent.single.label","Copy changed line"),void 0,!0,async()=>{const x=this._originalTextModel.getValueInRange(n.original.toExclusiveRange());await this._clipboardService.writeText(x)})),n.original.length>1&&v.push(new Na("diff.clipboard.copyDeletedLineContent",C?b("diff.clipboard.copyDeletedLineContent.label","Copy deleted line ({0})",n.original.startLineNumber+u):b("diff.clipboard.copyChangedLineContent.label","Copy changed line ({0})",n.original.startLineNumber+u),void 0,!0,async()=>{let x=this._originalTextModel.getLineContent(n.original.startLineNumber+u);x===""&&(x=this._originalTextModel.getEndOfLineSequence()===0?`
`:`\r
`),await this._clipboardService.writeText(x)})),i.getOption(92)||v.push(new Na("diff.inline.revertChange",b("diff.inline.revertChange.label","Revert this change"),void 0,!0,async()=>{this._editor.revert(this._diff)})),v},autoSelectFirstItem:!0})};this._register(yn(this._diffActions,"mousedown",p=>{if(!p.leftButton)return;const{top:_,height:v}=Pn(this._diffActions),C=Math.floor(d/3);p.preventDefault(),g(p.posx,_+v+C)})),this._register(i.onMouseMove(p=>{(p.target.type===8||p.target.type===5)&&p.target.detail.viewZoneId===this._getViewZoneId()?(u=this._updateLightBulbPosition(this._marginDomNode,p.event.browserEvent.y,d),this.visibility=!0):this.visibility=!1})),this._register(i.onMouseDown(p=>{p.event.leftButton&&(p.target.type===8||p.target.type===5)&&p.target.detail.viewZoneId===this._getViewZoneId()&&(p.event.preventDefault(),u=this._updateLightBulbPosition(this._marginDomNode,p.event.browserEvent.y,d),g(p.event.posx,p.event.posy+d))}))}_updateLightBulbPosition(e,t,i){const{top:n}=Pn(e),r=t-n,o=Math.floor(r/i),a=o*i;if(this._diffActions.style.top=`${a}px`,this._viewLineCounts){let l=0;for(let c=0;c<this._viewLineCounts.length;c++)if(l+=this._viewLineCounts[c],o<l)return c}return o}}const ire=Og("diffEditorWidget",{createHTML:s=>s});function Eje(s,e,t,i){Zs(i,e.fontInfo);const n=t.length>0,r=new hS(1e4);let o=0,a=0;const l=[];for(let h=0;h<s.lineTokens.length;h++){const g=h+1,p=s.lineTokens[h],_=s.lineBreakData[h],v=vo.filter(t,g,1,Number.MAX_SAFE_INTEGER);if(_){let C=0;for(const y of _.breakOffsets){const x=p.sliceAndInflate(C,y,0);o=Math.max(o,nre(a,x,vo.extractWrapped(v,C,y),n,s.mightContainNonBasicASCII,s.mightContainRTL,e,r)),a++,C=y}l.push(_.breakOffsets.length)}else l.push(1),o=Math.max(o,nre(a,p,v,n,s.mightContainNonBasicASCII,s.mightContainRTL,e,r)),a++}o+=e.scrollBeyondLastColumn;const c=r.build(),d=ire?ire.createHTML(c):c;i.innerHTML=d;const u=o*e.typicalHalfwidthCharacterWidth;return{heightInLines:a,minWidthInPx:u,viewLineCounts:l}}class Dje{constructor(e,t,i,n){this.lineTokens=e,this.lineBreakData=t,this.mightContainNonBasicASCII=i,this.mightContainRTL=n}}class QG{static fromEditor(e){var r;const t=e.getOptions(),i=t.get(50),n=t.get(146);return new QG(((r=e.getModel())==null?void 0:r.getOptions().tabSize)||0,i,t.get(33),i.typicalHalfwidthCharacterWidth,t.get(105),t.get(67),n.decorationsWidth,t.get(118),t.get(100),t.get(95),t.get(51))}constructor(e,t,i,n,r,o,a,l,c,d,u){this.tabSize=e,this.fontInfo=t,this.disableMonospaceOptimizations=i,this.typicalHalfwidthCharacterWidth=n,this.scrollBeyondLastColumn=r,this.lineHeight=o,this.lineDecorationsWidth=a,this.stopRenderingLineAfter=l,this.renderWhitespace=c,this.renderControlCharacters=d,this.fontLigatures=u}}function nre(s,e,t,i,n,r,o,a){a.appendString('<div class="view-line'),i||a.appendString(" char-delete"),a.appendString('" style="top:'),a.appendString(String(s*o.lineHeight)),a.appendString('px;width:1000000px;">');const l=e.getLineContent(),c=Pl.isBasicASCII(l,n),d=Pl.containsRTL(l,c,r),u=dD(new w_(o.fontInfo.isMonospace&&!o.disableMonospaceOptimizations,o.fontInfo.canUseHalfwidthRightwardsArrow,l,!1,c,d,0,e,t,o.tabSize,0,o.fontInfo.spaceWidth,o.fontInfo.middotWidth,o.fontInfo.wsmiddotWidth,o.stopRenderingLineAfter,o.renderWhitespace,o.renderControlCharacters,o.fontLigatures!==Bm.OFF,null),a);return a.appendString("</div>"),u.characterMapping.getHorizontalOffset(u.characterMapping.length)}var Tje=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},sre=function(s,e){return function(t,i){e(t,i,s)}};let ez=class extends te{constructor(e,t,i,n,r,o,a,l,c,d){super(),this._targetWindow=e,this._editors=t,this._diffModel=i,this._options=n,this._diffEditorWidget=r,this._canIgnoreViewZoneUpdateEvent=o,this._origViewZonesToIgnore=a,this._modViewZonesToIgnore=l,this._clipboardService=c,this._contextMenuService=d,this._originalTopPadding=Rt(this,0),this._originalScrollOffset=Rt(this,0),this._originalScrollOffsetAnimated=Xse(this._targetWindow,this._originalScrollOffset,this._store),this._modifiedTopPadding=Rt(this,0),this._modifiedScrollOffset=Rt(this,0),this._modifiedScrollOffsetAnimated=Xse(this._targetWindow,this._modifiedScrollOffset,this._store);const u=Rt("invalidateAlignmentsState",0),h=this._register(new xi(()=>{u.set(u.get()+1,void 0)},0));this._register(this._editors.original.onDidChangeViewZones(x=>{this._canIgnoreViewZoneUpdateEvent()||h.schedule()})),this._register(this._editors.modified.onDidChangeViewZones(x=>{this._canIgnoreViewZoneUpdateEvent()||h.schedule()})),this._register(this._editors.original.onDidChangeConfiguration(x=>{(x.hasChanged(147)||x.hasChanged(67))&&h.schedule()})),this._register(this._editors.modified.onDidChangeConfiguration(x=>{(x.hasChanged(147)||x.hasChanged(67))&&h.schedule()}));const g=this._diffModel.map(x=>x?wi(this,x.model.original.onDidChangeTokens,()=>x.model.original.tokenization.backgroundTokenizationState===2):void 0).map((x,L)=>x==null?void 0:x.read(L)),p=qe(x=>{const L=this._diffModel.read(x),I=L==null?void 0:L.diff.read(x);if(!L||!I)return null;u.read(x);const D=this._options.renderSideBySide.read(x);return rre(this._editors.original,this._editors.modified,I.mappings,this._origViewZonesToIgnore,this._modViewZonesToIgnore,D)}),_=qe(x=>{var A;const L=(A=this._diffModel.read(x))==null?void 0:A.movedTextToCompare.read(x);if(!L)return null;u.read(x);const I=L.changes.map(D=>new fme(D));return rre(this._editors.original,this._editors.modified,I,this._origViewZonesToIgnore,this._modViewZonesToIgnore,!0)});function v(){const x=document.createElement("div");return x.className="diagonal-fill",x}const C=this._register(new ce);this.viewZones=__(this,(x,L)=>{var _e,Re,J,we;C.clear();const I=p.read(x)||[],A=[],D=[],N=this._modifiedTopPadding.read(x);N>0&&D.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:N,showInHiddenAreas:!0,suppressMouseDown:!0});const R=this._originalTopPadding.read(x);R>0&&A.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:R,showInHiddenAreas:!0,suppressMouseDown:!0});const W=this._options.renderSideBySide.read(x),H=W||(_e=this._editors.modified._getViewModel())==null?void 0:_e.createLineBreaksComputer();if(H){const Ae=this._editors.original.getModel();for(const ot of I)if(ot.diff)for(let tt=ot.originalRange.startLineNumber;tt<ot.originalRange.endLineNumberExclusive;tt++){if(tt>Ae.getLineCount())return{orig:A,mod:D};H==null||H.addRequest(Ae.getLineContent(tt),null,null)}}const U=(H==null?void 0:H.finalize())??[];let B=0;const ee=this._editors.modified.getOption(67),re=(Re=this._diffModel.read(x))==null?void 0:Re.movedTextToCompare.read(x),pe=((J=this._editors.original.getModel())==null?void 0:J.mightContainNonBasicASCII())??!1,Ie=((we=this._editors.original.getModel())==null?void 0:we.mightContainRTL())??!1,ge=QG.fromEditor(this._editors.modified);for(const Ae of I)if(Ae.diff&&!W&&(!this._options.useTrueInlineDiffRendering.read(x)||!YG(Ae.diff))){if(!Ae.originalRange.isEmpty){g.read(x);const tt=document.createElement("div");tt.classList.add("view-lines","line-delete","monaco-mouse-cursor-text");const It=this._editors.original.getModel();if(Ae.originalRange.endLineNumberExclusive-1>It.getLineCount())return{orig:A,mod:D};const si=new Dje(Ae.originalRange.mapToLineArray(vn=>It.tokenization.getLineTokens(vn)),Ae.originalRange.mapToLineArray(vn=>U[B++]),pe,Ie),ai=[];for(const vn of Ae.diff.innerChanges||[])ai.push(new KL(vn.originalRange.delta(-(Ae.diff.original.startLineNumber-1)),P1.className,0));const Ii=Eje(si,ge,ai,tt),rn=document.createElement("div");if(rn.className="inline-deleted-margin-view-zone",Zs(rn,ge.fontInfo),this._options.renderIndicators.read(x))for(let vn=0;vn<Ii.heightInLines;vn++){const zs=document.createElement("div");zs.className=`delete-sign ${at.asClassName(dme)}`,zs.setAttribute("style",`position:absolute;top:${vn*ee}px;width:${ge.lineDecorationsWidth}px;height:${ee}px;right:0;`),rn.appendChild(zs)}let eo;C.add(new Ije(()=>Hp(eo),rn,this._editors.modified,Ae.diff,this._diffEditorWidget,Ii.viewLineCounts,this._editors.original.getModel(),this._contextMenuService,this._clipboardService));for(let vn=0;vn<Ii.viewLineCounts.length;vn++){const zs=Ii.viewLineCounts[vn];zs>1&&A.push({afterLineNumber:Ae.originalRange.startLineNumber+vn,domNode:v(),heightInPx:(zs-1)*ee,showInHiddenAreas:!0,suppressMouseDown:!0})}D.push({afterLineNumber:Ae.modifiedRange.startLineNumber-1,domNode:tt,heightInPx:Ii.heightInLines*ee,minWidthInPx:Ii.minWidthInPx,marginDomNode:rn,setZoneId(vn){eo=vn},showInHiddenAreas:!0,suppressMouseDown:!0})}const ot=document.createElement("div");ot.className="gutter-delete",A.push({afterLineNumber:Ae.originalRange.endLineNumberExclusive-1,domNode:v(),heightInPx:Ae.modifiedHeightInPx,marginDomNode:ot,showInHiddenAreas:!0,suppressMouseDown:!0})}else{const ot=Ae.modifiedHeightInPx-Ae.originalHeightInPx;if(ot>0){if(re!=null&&re.lineRangeMapping.original.delta(-1).deltaLength(2).contains(Ae.originalRange.endLineNumberExclusive-1))continue;A.push({afterLineNumber:Ae.originalRange.endLineNumberExclusive-1,domNode:v(),heightInPx:ot,showInHiddenAreas:!0,suppressMouseDown:!0})}else{let tt=function(){const si=document.createElement("div");return si.className="arrow-revert-change "+at.asClassName(xe.arrowRight),L.add(oe(si,"mousedown",ai=>ai.stopPropagation())),L.add(oe(si,"click",ai=>{ai.stopPropagation(),r.revert(Ae.diff)})),ke("div",{},si)};if(re!=null&&re.lineRangeMapping.modified.delta(-1).deltaLength(2).contains(Ae.modifiedRange.endLineNumberExclusive-1))continue;let It;Ae.diff&&Ae.diff.modified.isEmpty&&this._options.shouldRenderOldRevertArrows.read(x)&&(It=tt()),D.push({afterLineNumber:Ae.modifiedRange.endLineNumberExclusive-1,domNode:v(),heightInPx:-ot,marginDomNode:It,showInHiddenAreas:!0,suppressMouseDown:!0})}}for(const Ae of _.read(x)??[]){if(!(re!=null&&re.lineRangeMapping.original.intersect(Ae.originalRange))||!(re!=null&&re.lineRangeMapping.modified.intersect(Ae.modifiedRange)))continue;const ot=Ae.modifiedHeightInPx-Ae.originalHeightInPx;ot>0?A.push({afterLineNumber:Ae.originalRange.endLineNumberExclusive-1,domNode:v(),heightInPx:ot,showInHiddenAreas:!0,suppressMouseDown:!0}):D.push({afterLineNumber:Ae.modifiedRange.endLineNumberExclusive-1,domNode:v(),heightInPx:-ot,showInHiddenAreas:!0,suppressMouseDown:!0})}return{orig:A,mod:D}});let y=!1;this._register(this._editors.original.onDidScrollChange(x=>{x.scrollLeftChanged&&!y&&(y=!0,this._editors.modified.setScrollLeft(x.scrollLeft),y=!1)})),this._register(this._editors.modified.onDidScrollChange(x=>{x.scrollLeftChanged&&!y&&(y=!0,this._editors.original.setScrollLeft(x.scrollLeft),y=!1)})),this._originalScrollTop=wi(this._editors.original.onDidScrollChange,()=>this._editors.original.getScrollTop()),this._modifiedScrollTop=wi(this._editors.modified.onDidScrollChange,()=>this._editors.modified.getScrollTop()),this._register(ht(x=>{const L=this._originalScrollTop.read(x)-(this._originalScrollOffsetAnimated.get()-this._modifiedScrollOffsetAnimated.read(x))-(this._originalTopPadding.get()-this._modifiedTopPadding.read(x));L!==this._editors.modified.getScrollTop()&&this._editors.modified.setScrollTop(L,1)})),this._register(ht(x=>{const L=this._modifiedScrollTop.read(x)-(this._modifiedScrollOffsetAnimated.get()-this._originalScrollOffsetAnimated.read(x))-(this._modifiedTopPadding.get()-this._originalTopPadding.read(x));L!==this._editors.original.getScrollTop()&&this._editors.original.setScrollTop(L,1)})),this._register(ht(x=>{var A;const L=(A=this._diffModel.read(x))==null?void 0:A.movedTextToCompare.read(x);let I=0;if(L){const D=this._editors.original.getTopForLineNumber(L.lineRangeMapping.original.startLineNumber,!0)-this._originalTopPadding.get();I=this._editors.modified.getTopForLineNumber(L.lineRangeMapping.modified.startLineNumber,!0)-this._modifiedTopPadding.get()-D}I>0?(this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(I,void 0)):I<0?(this._modifiedTopPadding.set(-I,void 0),this._originalTopPadding.set(0,void 0)):setTimeout(()=>{this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(0,void 0)},400),this._editors.modified.hasTextFocus()?this._originalScrollOffset.set(this._modifiedScrollOffset.get()-I,void 0,!0):this._modifiedScrollOffset.set(this._originalScrollOffset.get()+I,void 0,!0)}))}};ez=Tje([sre(8,Wg),sre(9,Ba)],ez);function rre(s,e,t,i,n,r){const o=new Cg(ore(s,i)),a=new Cg(ore(e,n)),l=s.getOption(67),c=e.getOption(67),d=[];let u=0,h=0;function g(p,_){for(;;){let v=o.peek(),C=a.peek();if(v&&v.lineNumber>=p&&(v=void 0),C&&C.lineNumber>=_&&(C=void 0),!v&&!C)break;const y=v?v.lineNumber-u:Number.MAX_VALUE,x=C?C.lineNumber-h:Number.MAX_VALUE;y<x?(o.dequeue(),C={lineNumber:v.lineNumber-u+h,heightInPx:0}):y>x?(a.dequeue(),v={lineNumber:C.lineNumber-h+u,heightInPx:0}):(o.dequeue(),a.dequeue()),d.push({originalRange:Ct.ofLength(v.lineNumber,1),modifiedRange:Ct.ofLength(C.lineNumber,1),originalHeightInPx:l+v.heightInPx,modifiedHeightInPx:c+C.heightInPx,diff:void 0})}}for(const p of t){let x=function(L,I,A=!1){var H,U;if(L<y||I<C)return;if(v)v=!1;else if(!A&&(L===y||I===C))return;const D=new Ct(y,L),N=new Ct(C,I);if(D.isEmpty&&N.isEmpty)return;const R=((H=o.takeWhile(B=>B.lineNumber<L))==null?void 0:H.reduce((B,ee)=>B+ee.heightInPx,0))??0,W=((U=a.takeWhile(B=>B.lineNumber<I))==null?void 0:U.reduce((B,ee)=>B+ee.heightInPx,0))??0;d.push({originalRange:D,modifiedRange:N,originalHeightInPx:D.length*l+R,modifiedHeightInPx:N.length*c+W,diff:p.lineRangeMapping}),y=L,C=I};const _=p.lineRangeMapping;g(_.original.startLineNumber,_.modified.startLineNumber);let v=!0,C=_.modified.startLineNumber,y=_.original.startLineNumber;if(r)for(const L of _.innerChanges||[]){L.originalRange.startColumn>1&&L.modifiedRange.startColumn>1&&x(L.originalRange.startLineNumber,L.modifiedRange.startLineNumber);const I=s.getModel(),A=L.originalRange.endLineNumber<=I.getLineCount()?I.getLineMaxColumn(L.originalRange.endLineNumber):Number.MAX_SAFE_INTEGER;L.originalRange.endColumn<A&&x(L.originalRange.endLineNumber,L.modifiedRange.endLineNumber)}x(_.original.endLineNumberExclusive,_.modified.endLineNumberExclusive,!0),u=_.original.endLineNumberExclusive,h=_.modified.endLineNumberExclusive}return g(Number.MAX_VALUE,Number.MAX_VALUE),d}function ore(s,e){const t=[],i=[],n=s.getOption(147).wrappingColumn!==-1,r=s._getViewModel().coordinatesConverter,o=s.getOption(67);if(n)for(let l=1;l<=s.getModel().getLineCount();l++){const c=r.getModelLineViewLineCount(l);c>1&&i.push({lineNumber:l,heightInPx:o*(c-1)})}for(const l of s.getWhitespaces()){if(e.has(l.id))continue;const c=l.afterLineNumber===0?0:r.convertViewPositionToModelPosition(new X(l.afterLineNumber,1)).lineNumber;t.push({lineNumber:c,heightInPx:l.height})}return nje(t,i,l=>l.lineNumber,(l,c)=>({lineNumber:l.lineNumber,heightInPx:l.heightInPx+c.heightInPx}))}function YG(s){return s.innerChanges?s.innerChanges.every(e=>are(e.modifiedRange)&&are(e.originalRange)||e.originalRange.equalsRange(new F(1,1,1,1))):!1}function are(s){return s.startLineNumber===s.endLineNumber}const Ik=class Ik extends te{constructor(e,t,i,n,r){super(),this._rootElement=e,this._diffModel=t,this._originalEditorLayoutInfo=i,this._modifiedEditorLayoutInfo=n,this._editors=r,this._originalScrollTop=wi(this,this._editors.original.onDidScrollChange,()=>this._editors.original.getScrollTop()),this._modifiedScrollTop=wi(this,this._editors.modified.onDidScrollChange,()=>this._editors.modified.getScrollTop()),this._viewZonesChanged=cr("onDidChangeViewZones",this._editors.modified.onDidChangeViewZones),this.width=Rt(this,0),this._modifiedViewZonesChangedSignal=cr("modified.onDidChangeViewZones",this._editors.modified.onDidChangeViewZones),this._originalViewZonesChangedSignal=cr("original.onDidChangeViewZones",this._editors.original.onDidChangeViewZones),this._state=__(this,(d,u)=>{var D;this._element.replaceChildren();const h=this._diffModel.read(d),g=(D=h==null?void 0:h.diff.read(d))==null?void 0:D.movedTexts;if(!g||g.length===0){this.width.set(0,void 0);return}this._viewZonesChanged.read(d);const p=this._originalEditorLayoutInfo.read(d),_=this._modifiedEditorLayoutInfo.read(d);if(!p||!_){this.width.set(0,void 0);return}this._modifiedViewZonesChangedSignal.read(d),this._originalViewZonesChangedSignal.read(d);const v=g.map(N=>{function R(ge,_e){const Re=_e.getTopForLineNumber(ge.startLineNumber,!0),J=_e.getTopForLineNumber(ge.endLineNumberExclusive,!0);return(Re+J)/2}const W=R(N.lineRangeMapping.original,this._editors.original),H=this._originalScrollTop.read(d),U=R(N.lineRangeMapping.modified,this._editors.modified),B=this._modifiedScrollTop.read(d),ee=W-H,re=U-B,pe=Math.min(W,U),Ie=Math.max(W,U);return{range:new Mt(pe,Ie),from:ee,to:re,fromWithoutScroll:W,toWithoutScroll:U,move:N}});v.sort(TTe(Co(N=>N.fromWithoutScroll>N.toWithoutScroll,NTe),Co(N=>N.fromWithoutScroll>N.toWithoutScroll?N.fromWithoutScroll:-N.toWithoutScroll,td)));const C=XG.compute(v.map(N=>N.range)),y=10,x=p.verticalScrollbarWidth,L=(C.getTrackCount()-1)*10+y*2,I=x+L+(_.contentLeft-Ik.movedCodeBlockPadding);let A=0;for(const N of v){const R=C.getTrack(A),W=x+y+R*10,H=15,U=15,B=I,ee=_.glyphMarginWidth+_.lineNumbersWidth,re=18,pe=document.createElementNS("http://www.w3.org/2000/svg","rect");pe.classList.add("arrow-rectangle"),pe.setAttribute("x",`${B-ee}`),pe.setAttribute("y",`${N.to-re/2}`),pe.setAttribute("width",`${ee}`),pe.setAttribute("height",`${re}`),this._element.appendChild(pe);const Ie=document.createElementNS("http://www.w3.org/2000/svg","g"),ge=document.createElementNS("http://www.w3.org/2000/svg","path");ge.setAttribute("d",`M 0 ${N.from} L ${W} ${N.from} L ${W} ${N.to} L ${B-U} ${N.to}`),ge.setAttribute("fill","none"),Ie.appendChild(ge);const _e=document.createElementNS("http://www.w3.org/2000/svg","polygon");_e.classList.add("arrow"),u.add(ht(Re=>{ge.classList.toggle("currentMove",N.move===h.activeMovedText.read(Re)),_e.classList.toggle("currentMove",N.move===h.activeMovedText.read(Re))})),_e.setAttribute("points",`${B-U},${N.to-H/2} ${B},${N.to} ${B-U},${N.to+H/2}`),Ie.appendChild(_e),this._element.appendChild(Ie),A++}this.width.set(L,void 0)}),this._element=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._element.setAttribute("class","moved-blocks-lines"),this._rootElement.appendChild(this._element),this._register(Ye(()=>this._element.remove())),this._register(ht(d=>{const u=this._originalEditorLayoutInfo.read(d),h=this._modifiedEditorLayoutInfo.read(d);!u||!h||(this._element.style.left=`${u.width-u.verticalScrollbarWidth}px`,this._element.style.height=`${u.height}px`,this._element.style.width=`${u.verticalScrollbarWidth+u.contentLeft-Ik.movedCodeBlockPadding+this.width.read(d)}px`)})),this._register(wS(this._state));const o=qe(d=>{const u=this._diffModel.read(d),h=u==null?void 0:u.diff.read(d);return h?h.movedTexts.map(g=>({move:g,original:new VC(hc(g.lineRangeMapping.original.startLineNumber-1),18),modified:new VC(hc(g.lineRangeMapping.modified.startLineNumber-1),18)})):[]});this._register(bP(this._editors.original,o.map(d=>d.map(u=>u.original)))),this._register(bP(this._editors.modified,o.map(d=>d.map(u=>u.modified)))),this._register(Jo((d,u)=>{const h=o.read(d);for(const g of h)u.add(new lre(this._editors.original,g.original,g.move,"original",this._diffModel.get())),u.add(new lre(this._editors.modified,g.modified,g.move,"modified",this._diffModel.get()))}));const a=cr("original.onDidFocusEditorWidget",d=>this._editors.original.onDidFocusEditorWidget(()=>setTimeout(()=>d(void 0),0))),l=cr("modified.onDidFocusEditorWidget",d=>this._editors.modified.onDidFocusEditorWidget(()=>setTimeout(()=>d(void 0),0)));let c="modified";this._register(iD({createEmptyChangeSummary:()=>{},handleChange:(d,u)=>(d.didChange(a)&&(c="original"),d.didChange(l)&&(c="modified"),!0)},d=>{a.read(d),l.read(d);const u=this._diffModel.read(d);if(!u)return;const h=u.diff.read(d);let g;if(h&&c==="original"){const p=this._editors.originalCursor.read(d);p&&(g=h.movedTexts.find(_=>_.lineRangeMapping.original.contains(p.lineNumber)))}if(h&&c==="modified"){const p=this._editors.modifiedCursor.read(d);p&&(g=h.movedTexts.find(_=>_.lineRangeMapping.modified.contains(p.lineNumber)))}g!==u.movedTextToCompare.get()&&u.movedTextToCompare.set(void 0,void 0),u.setActiveMovedText(g)}))}};Ik.movedCodeBlockPadding=4;let My=Ik;class XG{static compute(e){const t=[],i=[];for(const n of e){let r=t.findIndex(o=>!o.intersectsStrict(n));r===-1&&(t.length>=6?r=fMe(t,Co(a=>a.intersectWithRangeLength(n),td)):(r=t.length,t.push(new Xq))),t[r].addRange(n),i.push(r)}return new XG(t.length,i)}constructor(e,t){this._trackCount=e,this.trackPerLineIdx=t}getTrack(e){return this.trackPerLineIdx[e]}getTrackCount(){return this._trackCount}}class lre extends HG{constructor(e,t,i,n,r){const o=Vt("div.diff-hidden-lines-widget");super(e,t,o.root),this._editor=e,this._move=i,this._kind=n,this._diffModel=r,this._nodes=Vt("div.diff-moved-code-block",{style:{marginRight:"4px"}},[Vt("div.text-content@textContent"),Vt("div.action-bar@actionBar")]),o.root.appendChild(this._nodes.root);const a=wi(this._editor.onDidLayoutChange,()=>this._editor.getLayoutInfo());this._register(Ig(this._nodes.root,{paddingRight:a.map(h=>h.verticalScrollbarWidth)}));let l;i.changes.length>0?l=this._kind==="original"?b("codeMovedToWithChanges","Code moved with changes to line {0}-{1}",this._move.lineRangeMapping.modified.startLineNumber,this._move.lineRangeMapping.modified.endLineNumberExclusive-1):b("codeMovedFromWithChanges","Code moved with changes from line {0}-{1}",this._move.lineRangeMapping.original.startLineNumber,this._move.lineRangeMapping.original.endLineNumberExclusive-1):l=this._kind==="original"?b("codeMovedTo","Code moved to line {0}-{1}",this._move.lineRangeMapping.modified.startLineNumber,this._move.lineRangeMapping.modified.endLineNumberExclusive-1):b("codeMovedFrom","Code moved from line {0}-{1}",this._move.lineRangeMapping.original.startLineNumber,this._move.lineRangeMapping.original.endLineNumberExclusive-1);const c=this._register(new Dl(this._nodes.actionBar,{highlightToggledItems:!0})),d=new Na("",l,"",!1);c.push(d,{icon:!1,label:!0});const u=new Na("","Compare",at.asClassName(xe.compareChanges),!0,()=>{this._editor.focus(),this._diffModel.movedTextToCompare.set(this._diffModel.movedTextToCompare.get()===i?void 0:this._move,void 0)});this._register(ht(h=>{const g=this._diffModel.movedTextToCompare.read(h)===i;u.checked=g})),c.push(u,{icon:!1,label:!0})}}class Nje extends te{constructor(e,t,i,n){super(),this._editors=e,this._diffModel=t,this._options=i,this._decorations=qe(this,r=>{const o=this._diffModel.read(r),a=o==null?void 0:o.diff.read(r);if(!a)return null;const l=this._diffModel.read(r).movedTextToCompare.read(r),c=this._options.renderIndicators.read(r),d=this._options.showEmptyDecorations.read(r),u=[],h=[];if(!l)for(const p of a.mappings)if(p.lineRangeMapping.original.isEmpty||u.push({range:p.lineRangeMapping.original.toInclusiveRange(),options:c?qI:tre}),p.lineRangeMapping.modified.isEmpty||h.push({range:p.lineRangeMapping.modified.toInclusiveRange(),options:c?wP:ere}),p.lineRangeMapping.modified.isEmpty||p.lineRangeMapping.original.isEmpty)p.lineRangeMapping.original.isEmpty||u.push({range:p.lineRangeMapping.original.toInclusiveRange(),options:qG}),p.lineRangeMapping.modified.isEmpty||h.push({range:p.lineRangeMapping.modified.toInclusiveRange(),options:jG});else{const _=this._options.useTrueInlineDiffRendering.read(r)&&YG(p.lineRangeMapping);for(const v of p.lineRangeMapping.innerChanges||[])if(p.lineRangeMapping.original.contains(v.originalRange.startLineNumber)&&u.push({range:v.originalRange,options:v.originalRange.isEmpty()&&d?KG:P1}),p.lineRangeMapping.modified.contains(v.modifiedRange.startLineNumber)&&h.push({range:v.modifiedRange,options:v.modifiedRange.isEmpty()&&d&&!_?$G:CP}),_){const C=o.model.original.getValueInRange(v.originalRange);h.push({range:v.modifiedRange,options:{description:"deleted-text",before:{content:C,inlineClassName:"inline-deleted-text"},zIndex:1e5,showIfCollapsed:!0}})}}if(l)for(const p of l.changes){const _=p.original.toInclusiveRange();_&&u.push({range:_,options:c?qI:tre});const v=p.modified.toInclusiveRange();v&&h.push({range:v,options:c?wP:ere});for(const C of p.innerChanges||[])u.push({range:C.originalRange,options:P1}),h.push({range:C.modifiedRange,options:CP})}const g=this._diffModel.read(r).activeMovedText.read(r);for(const p of a.movedTexts)u.push({range:p.lineRangeMapping.original.toInclusiveRange(),options:{description:"moved",blockClassName:"movedOriginal"+(p===g?" currentMove":""),blockPadding:[My.movedCodeBlockPadding,0,My.movedCodeBlockPadding,My.movedCodeBlockPadding]}}),h.push({range:p.lineRangeMapping.modified.toInclusiveRange(),options:{description:"moved",blockClassName:"movedModified"+(p===g?" currentMove":""),blockPadding:[4,0,4,4]}});return{originalDecorations:u,modifiedDecorations:h}}),this._register(_P(this._editors.original,this._decorations.map(r=>(r==null?void 0:r.originalDecorations)||[]))),this._register(_P(this._editors.modified,this._decorations.map(r=>(r==null?void 0:r.modifiedDecorations)||[])))}}class Rje{resetSash(){this._sashRatio.set(void 0,void 0)}constructor(e,t){this._options=e,this.dimensions=t,this.sashLeft=eD(this,i=>{const n=this._sashRatio.read(i)??this._options.splitViewDefaultRatio.read(i);return this._computeSashLeft(n,i)},(i,n)=>{const r=this.dimensions.width.get();this._sashRatio.set(i/r,n)}),this._sashRatio=Rt(this,void 0)}_computeSashLeft(e,t){const i=this.dimensions.width.read(t),n=Math.floor(this._options.splitViewDefaultRatio.read(t)*i),r=this._options.enableSplitViewResizing.read(t)?Math.floor(e*i):n,o=100;return i<=o*2?n:r<o?o:r>i-o?i-o:r}}class gme extends te{constructor(e,t,i,n,r,o){super(),this._domNode=e,this._dimensions=t,this._enabled=i,this._boundarySashes=n,this.sashLeft=r,this._resetSash=o,this._sash=this._register(new Sr(this._domNode,{getVerticalSashTop:a=>0,getVerticalSashLeft:a=>this.sashLeft.get(),getVerticalSashHeight:a=>this._dimensions.height.get()},{orientation:0})),this._startSashPosition=void 0,this._register(this._sash.onDidStart(()=>{this._startSashPosition=this.sashLeft.get()})),this._register(this._sash.onDidChange(a=>{this.sashLeft.set(this._startSashPosition+(a.currentX-a.startX),void 0)})),this._register(this._sash.onDidEnd(()=>this._sash.layout())),this._register(this._sash.onDidReset(()=>this._resetSash())),this._register(ht(a=>{const l=this._boundarySashes.read(a);l&&(this._sash.orthogonalEndSash=l.bottom)})),this._register(ht(a=>{const l=this._enabled.read(a);this._sash.state=l?3:0,this.sashLeft.read(a),this._dimensions.height.read(a),this._sash.layout()}))}}class Aje extends te{constructor(e,t,i){super(),this._editor=e,this._domNode=t,this.itemProvider=i,this.scrollTop=wi(this,this._editor.onDidScrollChange,o=>this._editor.getScrollTop()),this.isScrollTopZero=this.scrollTop.map(o=>o===0),this.modelAttached=wi(this,this._editor.onDidChangeModel,o=>this._editor.hasModel()),this.editorOnDidChangeViewZones=cr("onDidChangeViewZones",this._editor.onDidChangeViewZones),this.editorOnDidContentSizeChange=cr("onDidContentSizeChange",this._editor.onDidContentSizeChange),this.domNodeSizeChanged=vS("domNodeSizeChanged"),this.views=new Map,this._domNode.className="gutter monaco-editor";const n=this._domNode.appendChild(Vt("div.scroll-decoration",{role:"presentation",ariaHidden:"true",style:{width:"100%"}}).root),r=new ResizeObserver(()=>{pn(o=>{this.domNodeSizeChanged.trigger(o)})});r.observe(this._domNode),this._register(Ye(()=>r.disconnect())),this._register(ht(o=>{n.className=this.isScrollTopZero.read(o)?"":"scroll-decoration"})),this._register(ht(o=>this.render(o)))}dispose(){super.dispose(),Xs(this._domNode)}render(e){if(!this.modelAttached.read(e))return;this.domNodeSizeChanged.read(e),this.editorOnDidChangeViewZones.read(e),this.editorOnDidContentSizeChange.read(e);const t=this.scrollTop.read(e),i=this._editor.getVisibleRanges(),n=new Set(this.views.keys()),r=Mt.ofStartAndLength(0,this._domNode.clientHeight);if(!r.isEmpty)for(const o of i){const a=new Ct(o.startLineNumber,o.endLineNumber+1),l=this.itemProvider.getIntersectingGutterItems(a,e);pn(c=>{for(const d of l){if(!d.range.intersect(a))continue;n.delete(d.id);let u=this.views.get(d.id);if(u)u.item.set(d,c);else{const _=document.createElement("div");this._domNode.appendChild(_);const v=Rt("item",d),C=this.itemProvider.createView(v,_);u=new Pje(v,C,_),this.views.set(d.id,u)}const h=d.range.startLineNumber<=this._editor.getModel().getLineCount()?this._editor.getTopForLineNumber(d.range.startLineNumber,!0)-t:this._editor.getBottomForLineNumber(d.range.startLineNumber-1,!1)-t,p=(d.range.endLineNumberExclusive===1?Math.max(h,this._editor.getTopForLineNumber(d.range.startLineNumber,!1)-t):Math.max(h,this._editor.getBottomForLineNumber(d.range.endLineNumberExclusive-1,!0)-t))-h;u.domNode.style.top=`${h}px`,u.domNode.style.height=`${p}px`,u.gutterItemView.layout(Mt.ofStartAndLength(h,p),r)}})}for(const o of n){const a=this.views.get(o);a.gutterItemView.dispose(),a.domNode.remove(),this.views.delete(o)}}}class Pje{constructor(e,t,i){this.item=e,this.gutterItemView=t,this.domNode=i}}class pme extends hw{constructor(e){super(),this._getContext=e}runAction(e,t){const i=this._getContext();return super.runAction(e,i)}}class cre extends Ahe{constructor(e){super(),this._textModel=e}getValueOfRange(e){return this._textModel.getValueInRange(e)}get length(){const e=this._textModel.getLineCount(),t=this._textModel.getLineLength(e);return new cd(e-1,t)}}class Mje extends te{constructor(e,t,i={orientation:0}){super(),this.submenuActionViewItems=[],this.hasSecondaryActions=!1,this._onDidChangeDropdownVisibility=this._register(new tRe),this.onDidChangeDropdownVisibility=this._onDidChangeDropdownVisibility.event,this.disposables=this._register(new ce),i.hoverDelegate=i.hoverDelegate??this._register(k1()),this.options=i,this.toggleMenuAction=this._register(new KI(()=>{var n;return(n=this.toggleMenuActionViewItem)==null?void 0:n.show()},i.toggleMenuTitle)),this.element=document.createElement("div"),this.element.className="monaco-toolbar",e.appendChild(this.element),this.actionBar=this._register(new Dl(this.element,{orientation:i.orientation,ariaLabel:i.ariaLabel,actionRunner:i.actionRunner,allowContextMenu:i.allowContextMenu,highlightToggledItems:i.highlightToggledItems,hoverDelegate:i.hoverDelegate,actionViewItemProvider:(n,r)=>{if(n.id===KI.ID)return this.toggleMenuActionViewItem=new SA(n,n.menuActions,t,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:at.asClassNameArray(i.moreIcon??xe.toolBarMore),anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry,isMenu:!0,hoverDelegate:this.options.hoverDelegate}),this.toggleMenuActionViewItem.setActionContext(this.actionBar.context),this.disposables.add(this._onDidChangeDropdownVisibility.add(this.toggleMenuActionViewItem.onDidChangeVisibility)),this.toggleMenuActionViewItem;if(i.actionViewItemProvider){const o=i.actionViewItemProvider(n,r);if(o)return o}if(n instanceof f1){const o=new SA(n,n.actions,t,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:n.class,anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry,hoverDelegate:this.options.hoverDelegate});return o.setActionContext(this.actionBar.context),this.submenuActionViewItems.push(o),this.disposables.add(this._onDidChangeDropdownVisibility.add(o.onDidChangeVisibility)),o}}}))}set actionRunner(e){this.actionBar.actionRunner=e}get actionRunner(){return this.actionBar.actionRunner}getElement(){return this.element}getItemAction(e){return this.actionBar.getAction(e)}setActions(e,t){this.clear();const i=e?e.slice(0):[];this.hasSecondaryActions=!!(t&&t.length>0),this.hasSecondaryActions&&t&&(this.toggleMenuAction.menuActions=t.slice(0),i.push(this.toggleMenuAction)),i.forEach(n=>{this.actionBar.push(n,{icon:this.options.icon??!0,label:this.options.label??!1,keybinding:this.getKeybindingLabel(n)})})}getKeybindingLabel(e){var i,n;const t=(n=(i=this.options).getKeyBinding)==null?void 0:n.call(i,e);return(t==null?void 0:t.getLabel())??void 0}clear(){this.submenuActionViewItems=[],this.disposables.clear(),this.actionBar.clear()}dispose(){this.clear(),this.disposables.dispose(),super.dispose()}}const vO=class vO extends Na{constructor(e,t){t=t||b("moreActions","More Actions..."),super(vO.ID,t,void 0,!0),this._menuActions=[],this.toggleDropdownMenu=e}async run(){this.toggleDropdownMenu()}get menuActions(){return this._menuActions}set menuActions(e){this._menuActions=e}};vO.ID="toolbar.toggle.more";let KI=vO;var mme=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Gc=function(s,e){return function(t,i){e(t,i,s)}};let GI=class extends Mje{constructor(e,t,i,n,r,o,a,l){super(e,r,{getKeyBinding:d=>o.lookupKeybinding(d.id)??void 0,...t,allowContextMenu:!0,skipTelemetry:typeof(t==null?void 0:t.telemetrySource)=="string"}),this._options=t,this._menuService=i,this._contextKeyService=n,this._contextMenuService=r,this._keybindingService=o,this._commandService=a,this._sessionDisposables=this._store.add(new ce);const c=t==null?void 0:t.telemetrySource;c&&this._store.add(this.actionBar.onDidRun(d=>l.publicLog2("workbenchActionExecuted",{id:d.action.id,from:c})))}setActions(e,t=[],i){var d,u,h;this._sessionDisposables.clear();const n=e.slice(),r=t.slice(),o=[];let a=0;const l=[];let c=!1;if(((d=this._options)==null?void 0:d.hiddenItemStrategy)!==-1)for(let g=0;g<n.length;g++){const p=n[g];!(p instanceof Ra)&&!(p instanceof _y)||p.hideActions&&(o.push(p.hideActions.toggle),p.hideActions.toggle.checked&&a++,p.hideActions.isHidden&&(c=!0,n[g]=void 0,((u=this._options)==null?void 0:u.hiddenItemStrategy)!==0&&(l[g]=p)))}if(((h=this._options)==null?void 0:h.overflowBehavior)!==void 0){const g=YVe(new Set(this._options.overflowBehavior.exempted),Kt.map(n,v=>v==null?void 0:v.id)),p=this._options.overflowBehavior.maxItems-g.size;let _=0;for(let v=0;v<n.length;v++){const C=n[v];C&&(_++,!g.has(C.id)&&_>=p&&(n[v]=void 0,l[v]=C))}}Bee(n),Bee(l),super.setActions(n,ks.join(l,r)),(o.length>0||n.length>0)&&this._sessionDisposables.add(oe(this.getElement(),"contextmenu",g=>{var y,x,L,I,A;const p=new Xc(nt(this.getElement()),g),_=this.getItemAction(p.target);if(!_)return;p.preventDefault(),p.stopPropagation();const v=[];if(_ instanceof Ra&&_.menuKeybinding)v.push(_.menuKeybinding);else if(!(_ instanceof _y||_ instanceof KI)){const D=!!this._keybindingService.lookupKeybinding(_.id);v.push(Ape(this._commandService,this._keybindingService,_.id,void 0,D))}if(o.length>0){let D=!1;if(a===1&&((y=this._options)==null?void 0:y.hiddenItemStrategy)===0){D=!0;for(let N=0;N<o.length;N++)if(o[N].checked){o[N]=Yb({id:_.id,label:_.label,checked:!0,enabled:!1,run(){}});break}}if(!D&&(_ instanceof Ra||_ instanceof _y)){if(!_.hideActions)return;v.push(_.hideActions.hide)}else v.push(Yb({id:"label",label:b("hide","Hide"),enabled:!1,run(){}}))}const C=ks.join(v,o);(x=this._options)!=null&&x.resetMenu&&!i&&(i=[this._options.resetMenu]),c&&i&&(C.push(new ks),C.push(Yb({id:"resetThisMenu",label:b("resetThisMenu","Reset Menu"),run:()=>this._menuService.resetHiddenStates(i)}))),C.length!==0&&this._contextMenuService.showContextMenu({getAnchor:()=>p,getActions:()=>C,menuId:(L=this._options)==null?void 0:L.contextMenu,menuActionOptions:{renderShortTitle:!0,...(I=this._options)==null?void 0:I.menuOptions},skipTelemetry:typeof((A=this._options)==null?void 0:A.telemetrySource)=="string",contextKeyService:this._contextKeyService})}))}};GI=mme([Gc(2,Ol),Gc(3,ct),Gc(4,Ba),Gc(5,pi),Gc(6,Hi),Gc(7,Tr)],GI);let yP=class extends GI{constructor(e,t,i,n,r,o,a,l,c){super(e,{resetMenu:t,...i},n,r,o,a,l,c),this._onDidChangeMenuItems=this._store.add(new Z),this.onDidChangeMenuItems=this._onDidChangeMenuItems.event;const d=this._store.add(n.createMenu(t,r,{emitEventsForSubmenuChanges:!0})),u=()=>{var p,_,v;const h=[],g=[];zF(d,i==null?void 0:i.menuOptions,{primary:h,secondary:g},(p=i==null?void 0:i.toolbarOptions)==null?void 0:p.primaryGroup,(_=i==null?void 0:i.toolbarOptions)==null?void 0:_.shouldInlineSubmenu,(v=i==null?void 0:i.toolbarOptions)==null?void 0:v.useSeparatorsInPrimaryActions),e.classList.toggle("has-no-actions",h.length===0&&g.length===0),super.setActions(h,g)};this._store.add(d.onDidChange(()=>{u(),this._onDidChangeMenuItems.fire(this)})),u()}setActions(){throw new di("This toolbar is populated from a menu.")}};yP=mme([Gc(3,Ol),Gc(4,ct),Gc(5,Ba),Gc(6,pi),Gc(7,Hi),Gc(8,Tr)],yP);var _me=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},$R=function(s,e){return function(t,i){e(t,i,s)}};const pB=[],ON=35;let tz=class extends te{constructor(e,t,i,n,r,o,a,l,c){super(),this._diffModel=t,this._editors=i,this._options=n,this._sashLayout=r,this._boundarySashes=o,this._instantiationService=a,this._contextKeyService=l,this._menuService=c,this._menu=this._register(this._menuService.createMenu(ze.DiffEditorHunkToolbar,this._contextKeyService)),this._actions=wi(this,this._menu.onDidChange,()=>this._menu.getActions()),this._hasActions=this._actions.map(d=>d.length>0),this._showSash=qe(this,d=>this._options.renderSideBySide.read(d)&&this._hasActions.read(d)),this.width=qe(this,d=>this._hasActions.read(d)?ON:0),this.elements=Vt("div.gutter@gutter",{style:{position:"absolute",height:"100%",width:ON+"px"}},[]),this._currentDiff=qe(this,d=>{var p;const u=this._diffModel.read(d);if(!u)return;const h=(p=u.diff.read(d))==null?void 0:p.mappings,g=this._editors.modifiedCursor.read(d);if(g)return h==null?void 0:h.find(_=>_.lineRangeMapping.modified.contains(g.lineNumber))}),this._selectedDiffs=qe(this,d=>{const u=this._diffModel.read(d),h=u==null?void 0:u.diff.read(d);if(!h)return pB;const g=this._editors.modifiedSelections.read(d);if(g.every(C=>C.isEmpty()))return pB;const p=new lc(g.map(C=>Ct.fromRangeInclusive(C))),v=h.mappings.filter(C=>C.lineRangeMapping.innerChanges&&p.intersects(C.lineRangeMapping.modified)).map(C=>({mapping:C,rangeMappings:C.lineRangeMapping.innerChanges.filter(y=>g.some(x=>F.areIntersecting(y.modifiedRange,x)))}));return v.length===0||v.every(C=>C.rangeMappings.length===0)?pB:v}),this._register(sje(e,this.elements.root)),this._register(oe(this.elements.root,"click",()=>{this._editors.modified.focus()})),this._register(Ig(this.elements.root,{display:this._hasActions.map(d=>d?"block":"none")})),Kr(this,d=>this._showSash.read(d)?new gme(e,this._sashLayout.dimensions,this._options.enableSplitViewResizing,this._boundarySashes,eD(this,h=>this._sashLayout.sashLeft.read(h)-ON,(h,g)=>this._sashLayout.sashLeft.set(h+ON,g)),()=>this._sashLayout.resetSash()):void 0).recomputeInitiallyAndOnChange(this._store),this._register(new Aje(this._editors.modified,this.elements.root,{getIntersectingGutterItems:(d,u)=>{const h=this._diffModel.read(u);if(!h)return[];const g=h.diff.read(u);if(!g)return[];const p=this._selectedDiffs.read(u);if(p.length>0){const v=El.fromRangeMappings(p.flatMap(C=>C.rangeMappings));return[new dre(v,!0,ze.DiffEditorSelectionToolbar,void 0,h.model.original.uri,h.model.modified.uri)]}const _=this._currentDiff.read(u);return g.mappings.map(v=>new dre(v.lineRangeMapping.withInnerChangesFromLineRanges(),v.lineRangeMapping===(_==null?void 0:_.lineRangeMapping),ze.DiffEditorHunkToolbar,void 0,h.model.original.uri,h.model.modified.uri))},createView:(d,u)=>this._instantiationService.createInstance(iz,d,u,this)})),this._register(oe(this.elements.gutter,Le.MOUSE_WHEEL,d=>{this._editors.modified.getOption(104).handleMouseWheel&&this._editors.modified.delegateScrollFromMouseWheelEvent(d)},{passive:!1}))}computeStagedValue(e){const t=e.innerChanges??[],i=new cre(this._editors.modifiedModel.get()),n=new cre(this._editors.original.getModel());return new Jq(t.map(a=>a.toTextEdit(i))).apply(n)}layout(e){this.elements.gutter.style.left=e+"px"}};tz=_me([$R(6,Xe),$R(7,ct),$R(8,Ol)],tz);class dre{constructor(e,t,i,n,r,o){this.mapping=e,this.showAlways=t,this.menuId=i,this.rangeOverride=n,this.originalUri=r,this.modifiedUri=o}get id(){return this.mapping.modified.toString()}get range(){return this.rangeOverride??this.mapping.modified}}let iz=class extends te{constructor(e,t,i,n){super(),this._item=e,this._elements=Vt("div.gutterItem",{style:{height:"20px",width:"34px"}},[Vt("div.background@background",{},[]),Vt("div.buttons@buttons",{},[])]),this._showAlways=this._item.map(this,o=>o.showAlways),this._menuId=this._item.map(this,o=>o.menuId),this._isSmall=Rt(this,!1),this._lastItemRange=void 0,this._lastViewRange=void 0;const r=this._register(n.createInstance(v1,"element",!0,{position:{hoverPosition:1}}));this._register(FC(t,this._elements.root)),this._register(ht(o=>{const a=this._showAlways.read(o);this._elements.root.classList.toggle("noTransition",!0),this._elements.root.classList.toggle("showAlways",a),setTimeout(()=>{this._elements.root.classList.toggle("noTransition",!1)},0)})),this._register(Jo((o,a)=>{this._elements.buttons.replaceChildren();const l=a.add(n.createInstance(yP,this._elements.buttons,this._menuId.read(o),{orientation:1,hoverDelegate:r,toolbarOptions:{primaryGroup:c=>c.startsWith("primary")},overflowBehavior:{maxItems:this._isSmall.read(o)?1:3},hiddenItemStrategy:0,actionRunner:new pme(()=>{const c=this._item.get(),d=c.mapping;return{mapping:d,originalWithModifiedChanges:i.computeStagedValue(d),originalUri:c.originalUri,modifiedUri:c.modifiedUri}}),menuOptions:{shouldForwardArgs:!0}}));a.add(l.onDidChangeMenuItems(()=>{this._lastItemRange&&this.layout(this._lastItemRange,this._lastViewRange)}))}))}layout(e,t){this._lastItemRange=e,this._lastViewRange=t;let i=this._elements.buttons.clientHeight;this._isSmall.set(this._item.get().mapping.original.startLineNumber===1&&e.length<30,void 0),i=this._elements.buttons.clientHeight;const n=e.length/2-i/2,r=i;let o=e.start+n;const a=Mt.tryCreate(r,t.endExclusive-r-i),l=Mt.tryCreate(e.start+r,e.endExclusive-i-r);l&&a&&l.start<l.endExclusive&&(o=a.clip(o),o=l.clip(o)),this._elements.buttons.style.top=`${o-e.start}px`}};iz=_me([$R(3,Xe)],iz);function Ea(s){return nz.get(s)}const kp=class kp extends te{static get(e){let t=kp._map.get(e);if(!t){t=new kp(e),kp._map.set(e,t);const i=e.onDidDispose(()=>{const n=kp._map.get(e);n&&(kp._map.delete(e),n.dispose(),i.dispose())})}return t}_beginUpdate(){this._updateCounter++,this._updateCounter===1&&(this._currentTransaction=new bS(()=>{}))}_endUpdate(){if(this._updateCounter--,this._updateCounter===0){const e=this._currentTransaction;this._currentTransaction=void 0,e.finish()}}constructor(e){var t;super(),this.editor=e,this._updateCounter=0,this._currentTransaction=void 0,this._model=Rt(this,this.editor.getModel()),this.model=this._model,this.isReadonly=wi(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(92)),this._versionId=l8({owner:this,lazy:!0},((t=this.editor.getModel())==null?void 0:t.getVersionId())??null),this.versionId=this._versionId,this._selections=l8({owner:this,equalsFn:r8(wA(Ue.selectionsEqual)),lazy:!0},this.editor.getSelections()??null),this.selections=this._selections,this.isFocused=wi(this,i=>{const n=this.editor.onDidFocusEditorWidget(i),r=this.editor.onDidBlurEditorWidget(i);return{dispose(){n.dispose(),r.dispose()}}},()=>this.editor.hasWidgetFocus()),this.value=eD(this,i=>{var n;return this.versionId.read(i),((n=this.model.read(i))==null?void 0:n.getValue())??""},(i,n)=>{const r=this.model.get();r!==null&&i!==r.getValue()&&r.setValue(i)}),this.valueIsEmpty=qe(this,i=>{var n;return this.versionId.read(i),((n=this.editor.getModel())==null?void 0:n.getValueLength())===0}),this.cursorSelection=_l({owner:this,equalsFn:r8(Ue.selectionsEqual)},i=>{var n;return((n=this.selections.read(i))==null?void 0:n[0])??null}),this.onDidType=vS(this),this.scrollTop=wi(this.editor.onDidScrollChange,()=>this.editor.getScrollTop()),this.scrollLeft=wi(this.editor.onDidScrollChange,()=>this.editor.getScrollLeft()),this.layoutInfo=wi(this.editor.onDidLayoutChange,()=>this.editor.getLayoutInfo()),this.layoutInfoContentLeft=this.layoutInfo.map(i=>i.contentLeft),this.layoutInfoDecorationsLeft=this.layoutInfo.map(i=>i.decorationsLeft),this.contentWidth=wi(this.editor.onDidContentSizeChange,()=>this.editor.getContentWidth()),this._overlayWidgetCounter=0,this._register(this.editor.onBeginUpdate(()=>this._beginUpdate())),this._register(this.editor.onEndUpdate(()=>this._endUpdate())),this._register(this.editor.onDidChangeModel(()=>{this._beginUpdate();try{this._model.set(this.editor.getModel(),this._currentTransaction),this._forceUpdate()}finally{this._endUpdate()}})),this._register(this.editor.onDidType(i=>{this._beginUpdate();try{this._forceUpdate(),this.onDidType.trigger(this._currentTransaction,i)}finally{this._endUpdate()}})),this._register(this.editor.onDidChangeModelContent(i=>{var n;this._beginUpdate();try{this._versionId.set(((n=this.editor.getModel())==null?void 0:n.getVersionId())??null,this._currentTransaction,i),this._forceUpdate()}finally{this._endUpdate()}})),this._register(this.editor.onDidChangeCursorSelection(i=>{this._beginUpdate();try{this._selections.set(this.editor.getSelections(),this._currentTransaction,i),this._forceUpdate()}finally{this._endUpdate()}}))}forceUpdate(e){this._beginUpdate();try{return this._forceUpdate(),e?e(this._currentTransaction):void 0}finally{this._endUpdate()}}_forceUpdate(){var e;this._beginUpdate();try{this._model.set(this.editor.getModel(),this._currentTransaction),this._versionId.set(((e=this.editor.getModel())==null?void 0:e.getVersionId())??null,this._currentTransaction,void 0),this._selections.set(this.editor.getSelections(),this._currentTransaction,void 0)}finally{this._endUpdate()}}getOption(e){return wi(this,t=>this.editor.onDidChangeConfiguration(i=>{i.hasChanged(e)&&t(void 0)}),()=>this.editor.getOption(e))}setDecorations(e){const t=new ce,i=this.editor.createDecorationsCollection();return t.add(tD({owner:this,debugName:()=>`Apply decorations from ${e.debugName}`},n=>{const r=e.read(n);i.set(r)})),t.add({dispose:()=>{i.clear()}}),t}createOverlayWidget(e){const t="observableOverlayWidget"+this._overlayWidgetCounter++,i={getDomNode:()=>e.domNode,getPosition:()=>e.position.get(),getId:()=>t,allowEditorOverflow:e.allowEditorOverflow,getMinContentWidthInPx:()=>e.minContentWidthInPx.get()};this.editor.addOverlayWidget(i);const n=ht(r=>{e.position.read(r),e.minContentWidthInPx.read(r),this.editor.layoutOverlayWidget(i)});return Ye(()=>{n.dispose(),this.editor.removeOverlayWidget(i)})}};kp._map=new Map;let nz=kp;function sz(s,e){return o9e({createEmptyChangeSummary:()=>({deltas:[],didChange:!1}),handleChange:(t,i)=>{if(t.didChange(s)){const n=t.change;n!==void 0&&i.deltas.push(n),i.didChange=!0}return!0}},(t,i)=>{const n=s.read(t);i.didChange&&e(n,i.deltas)})}function Oje(s,e){const t=new ce,i=sz(s,(n,r)=>{t.clear(),e(n,r,t)});return{dispose(){i.dispose(),t.dispose()}}}var Fje=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Vje=function(s,e){return function(t,i){e(t,i,s)}},qR,pv;let SP=(pv=class extends te{static setBreadcrumbsSourceFactory(e){this._breadcrumbsSourceFactory.set(e,void 0)}get isUpdatingHiddenAreas(){return this._isUpdatingHiddenAreas}constructor(e,t,i,n){super(),this._editors=e,this._diffModel=t,this._options=i,this._instantiationService=n,this._modifiedOutlineSource=Kr(this,l=>{const c=this._editors.modifiedModel.read(l),d=qR._breadcrumbsSourceFactory.read(l);return!c||!d?void 0:d(c,this._instantiationService)}),this._isUpdatingHiddenAreas=!1,this._register(this._editors.original.onDidChangeCursorPosition(l=>{if(l.reason===1)return;const c=this._diffModel.get();pn(d=>{for(const u of this._editors.original.getSelections()||[])c==null||c.ensureOriginalLineIsVisible(u.getStartPosition().lineNumber,0,d),c==null||c.ensureOriginalLineIsVisible(u.getEndPosition().lineNumber,0,d)})})),this._register(this._editors.modified.onDidChangeCursorPosition(l=>{if(l.reason===1)return;const c=this._diffModel.get();pn(d=>{for(const u of this._editors.modified.getSelections()||[])c==null||c.ensureModifiedLineIsVisible(u.getStartPosition().lineNumber,0,d),c==null||c.ensureModifiedLineIsVisible(u.getEndPosition().lineNumber,0,d)})}));const r=this._diffModel.map((l,c)=>{var u;const d=(l==null?void 0:l.unchangedRegions.read(c))??[];return d.length===1&&d[0].modifiedLineNumber===1&&d[0].lineCount===((u=this._editors.modifiedModel.read(c))==null?void 0:u.getLineCount())?[]:d});this.viewZones=__(this,(l,c)=>{const d=this._modifiedOutlineSource.read(l);if(!d)return{origViewZones:[],modViewZones:[]};const u=[],h=[],g=this._options.renderSideBySide.read(l),p=this._options.compactMode.read(l),_=r.read(l);for(let v=0;v<_.length;v++){const C=_[v];if(!C.shouldHideControls(l)&&!(p&&(v===0||v===_.length-1)))if(p){{const y=qe(this,L=>C.getHiddenOriginalRange(L).startLineNumber-1),x=new VC(y,12);u.push(x),c.add(new ure(this._editors.original,x,C,!g))}{const y=qe(this,L=>C.getHiddenModifiedRange(L).startLineNumber-1),x=new VC(y,12);h.push(x),c.add(new ure(this._editors.modified,x,C))}}else{{const y=qe(this,L=>C.getHiddenOriginalRange(L).startLineNumber-1),x=new VC(y,24);u.push(x),c.add(new hre(this._editors.original,x,C,C.originalUnchangedRange,!g,d,L=>this._diffModel.get().ensureModifiedLineIsVisible(L,2,void 0),this._options))}{const y=qe(this,L=>C.getHiddenModifiedRange(L).startLineNumber-1),x=new VC(y,24);h.push(x),c.add(new hre(this._editors.modified,x,C,C.modifiedUnchangedRange,!1,d,L=>this._diffModel.get().ensureModifiedLineIsVisible(L,2,void 0),this._options))}}}return{origViewZones:u,modViewZones:h}});const o={description:"unchanged lines",className:"diff-unchanged-lines",isWholeLine:!0},a={description:"Fold Unchanged",glyphMarginHoverMessage:new Lr(void 0,{isTrusted:!0,supportThemeIcons:!0}).appendMarkdown(b("foldUnchanged","Fold Unchanged Region")),glyphMarginClassName:"fold-unchanged "+at.asClassName(xe.fold),zIndex:10001};this._register(_P(this._editors.original,qe(this,l=>{const c=r.read(l),d=c.map(u=>({range:u.originalUnchangedRange.toInclusiveRange(),options:o}));for(const u of c)u.shouldHideControls(l)&&d.push({range:F.fromPositions(new X(u.originalLineNumber,1)),options:a});return d}))),this._register(_P(this._editors.modified,qe(this,l=>{const c=r.read(l),d=c.map(u=>({range:u.modifiedUnchangedRange.toInclusiveRange(),options:o}));for(const u of c)u.shouldHideControls(l)&&d.push({range:Ct.ofLength(u.modifiedLineNumber,1).toInclusiveRange(),options:a});return d}))),this._register(ht(l=>{const c=r.read(l);this._isUpdatingHiddenAreas=!0;try{this._editors.original.setHiddenAreas(c.map(d=>d.getHiddenOriginalRange(l).toInclusiveRange()).filter(Ch)),this._editors.modified.setHiddenAreas(c.map(d=>d.getHiddenModifiedRange(l).toInclusiveRange()).filter(Ch))}finally{this._isUpdatingHiddenAreas=!1}})),this._register(this._editors.modified.onMouseUp(l=>{var c;if(!l.event.rightButton&&l.target.position&&((c=l.target.element)!=null&&c.className.includes("fold-unchanged"))){const d=l.target.position.lineNumber,u=this._diffModel.get();if(!u)return;const h=u.unchangedRegions.get().find(g=>g.modifiedUnchangedRange.includes(d));if(!h)return;h.collapseAll(void 0),l.event.stopPropagation(),l.event.preventDefault()}})),this._register(this._editors.original.onMouseUp(l=>{var c;if(!l.event.rightButton&&l.target.position&&((c=l.target.element)!=null&&c.className.includes("fold-unchanged"))){const d=l.target.position.lineNumber,u=this._diffModel.get();if(!u)return;const h=u.unchangedRegions.get().find(g=>g.originalUnchangedRange.includes(d));if(!h)return;h.collapseAll(void 0),l.event.stopPropagation(),l.event.preventDefault()}}))}},qR=pv,pv._breadcrumbsSourceFactory=Rt(qR,()=>({dispose(){},getBreadcrumbItems(e,t){return[]}})),pv);SP=qR=Fje([Vje(3,Xe)],SP);class ure extends HG{constructor(e,t,i,n=!1){const r=Vt("div.diff-hidden-lines-widget");super(e,t,r.root),this._unchangedRegion=i,this._hide=n,this._nodes=Vt("div.diff-hidden-lines-compact",[Vt("div.line-left",[]),Vt("div.text@text",[]),Vt("div.line-right",[])]),r.root.appendChild(this._nodes.root),this._hide&&this._nodes.root.replaceChildren(),this._register(ht(o=>{if(!this._hide){const a=this._unchangedRegion.getHiddenModifiedRange(o).length,l=b("hiddenLines","{0} hidden lines",a);this._nodes.text.innerText=l}}))}}class hre extends HG{constructor(e,t,i,n,r,o,a,l){const c=Vt("div.diff-hidden-lines-widget");super(e,t,c.root),this._editor=e,this._unchangedRegion=i,this._unchangedRegionRange=n,this._hide=r,this._modifiedOutlineSource=o,this._revealModifiedHiddenLine=a,this._options=l,this._nodes=Vt("div.diff-hidden-lines",[Vt("div.top@top",{title:b("diff.hiddenLines.top","Click or drag to show more above")}),Vt("div.center@content",{style:{display:"flex"}},[Vt("div@first",{style:{display:"flex",justifyContent:"center",alignItems:"center",flexShrink:"0"}},[ke("a",{title:b("showUnchangedRegion","Show Unchanged Region"),role:"button",onclick:()=>{this._unchangedRegion.showAll(void 0)}},...dm("$(unfold)"))]),Vt("div@others",{style:{display:"flex",justifyContent:"center",alignItems:"center"}})]),Vt("div.bottom@bottom",{title:b("diff.bottom","Click or drag to show more below"),role:"button"})]),c.root.appendChild(this._nodes.root),this._hide?Xs(this._nodes.first):this._register(Ig(this._nodes.first,{width:Ea(this._editor).layoutInfoContentLeft})),this._register(ht(u=>{const h=this._unchangedRegion.visibleLineCountTop.read(u)+this._unchangedRegion.visibleLineCountBottom.read(u)===this._unchangedRegion.lineCount;this._nodes.bottom.classList.toggle("canMoveTop",!h),this._nodes.bottom.classList.toggle("canMoveBottom",this._unchangedRegion.visibleLineCountBottom.read(u)>0),this._nodes.top.classList.toggle("canMoveTop",this._unchangedRegion.visibleLineCountTop.read(u)>0),this._nodes.top.classList.toggle("canMoveBottom",!h);const g=this._unchangedRegion.isDragged.read(u),p=this._editor.getDomNode();p&&(p.classList.toggle("draggingUnchangedRegion",!!g),g==="top"?(p.classList.toggle("canMoveTop",this._unchangedRegion.visibleLineCountTop.read(u)>0),p.classList.toggle("canMoveBottom",!h)):g==="bottom"?(p.classList.toggle("canMoveTop",!h),p.classList.toggle("canMoveBottom",this._unchangedRegion.visibleLineCountBottom.read(u)>0)):(p.classList.toggle("canMoveTop",!1),p.classList.toggle("canMoveBottom",!1)))}));const d=this._editor;this._register(oe(this._nodes.top,"mousedown",u=>{if(u.button!==0)return;this._nodes.top.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),u.preventDefault();const h=u.clientY;let g=!1;const p=this._unchangedRegion.visibleLineCountTop.get();this._unchangedRegion.isDragged.set("top",void 0);const _=nt(this._nodes.top),v=oe(_,"mousemove",y=>{const L=y.clientY-h;g=g||Math.abs(L)>2;const I=Math.round(L/d.getOption(67)),A=Math.max(0,Math.min(p+I,this._unchangedRegion.getMaxVisibleLineCountTop()));this._unchangedRegion.visibleLineCountTop.set(A,void 0)}),C=oe(_,"mouseup",y=>{g||this._unchangedRegion.showMoreAbove(this._options.hideUnchangedRegionsRevealLineCount.get(),void 0),this._nodes.top.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),this._unchangedRegion.isDragged.set(void 0,void 0),v.dispose(),C.dispose()})})),this._register(oe(this._nodes.bottom,"mousedown",u=>{if(u.button!==0)return;this._nodes.bottom.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),u.preventDefault();const h=u.clientY;let g=!1;const p=this._unchangedRegion.visibleLineCountBottom.get();this._unchangedRegion.isDragged.set("bottom",void 0);const _=nt(this._nodes.bottom),v=oe(_,"mousemove",y=>{const L=y.clientY-h;g=g||Math.abs(L)>2;const I=Math.round(L/d.getOption(67)),A=Math.max(0,Math.min(p-I,this._unchangedRegion.getMaxVisibleLineCountBottom())),D=this._unchangedRegionRange.endLineNumberExclusive>d.getModel().getLineCount()?d.getContentHeight():d.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);this._unchangedRegion.visibleLineCountBottom.set(A,void 0);const N=this._unchangedRegionRange.endLineNumberExclusive>d.getModel().getLineCount()?d.getContentHeight():d.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);d.setScrollTop(d.getScrollTop()+(N-D))}),C=oe(_,"mouseup",y=>{if(this._unchangedRegion.isDragged.set(void 0,void 0),!g){const x=d.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);this._unchangedRegion.showMoreBelow(this._options.hideUnchangedRegionsRevealLineCount.get(),void 0);const L=d.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);d.setScrollTop(d.getScrollTop()+(L-x))}this._nodes.bottom.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),v.dispose(),C.dispose()})})),this._register(ht(u=>{const h=[];if(!this._hide){const g=i.getHiddenModifiedRange(u).length,p=b("hiddenLines","{0} hidden lines",g),_=ke("span",{title:b("diff.hiddenLines.expandAll","Double click to unfold")},p);_.addEventListener("dblclick",y=>{y.button===0&&(y.preventDefault(),this._unchangedRegion.showAll(void 0))}),h.push(_);const v=this._unchangedRegion.getHiddenModifiedRange(u),C=this._modifiedOutlineSource.getBreadcrumbItems(v,u);if(C.length>0){h.push(ke("span",void 0,"  |  "));for(let y=0;y<C.length;y++){const x=C[y],L=O2.toIcon(x.kind),I=Vt("div.breadcrumb-item",{style:{display:"flex",alignItems:"center"}},[pw(L)," ",x.name,...y===C.length-1?[]:[pw(xe.chevronRight)]]).root;h.push(I),I.onclick=()=>{this._revealModifiedHiddenLine(x.startLineNumber)}}}}Xs(this._nodes.others,...h)}))}}var Bje=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Wje=function(s,e){return function(t,i){e(t,i,s)}},Pd,tg;let QI=(tg=class extends te{constructor(e,t,i,n,r,o,a){super(),this._editors=e,this._rootElement=t,this._diffModel=i,this._rootWidth=n,this._rootHeight=r,this._modifiedEditorLayoutInfo=o,this._themeService=a,this.width=Pd.ENTIRE_DIFF_OVERVIEW_WIDTH;const l=wi(this._themeService.onDidColorThemeChange,()=>this._themeService.getColorTheme()),c=qe(h=>{const g=l.read(h),p=g.getColor(o4e)||(g.getColor(s4e)||I6).transparent(2),_=g.getColor(a4e)||(g.getColor(r4e)||E6).transparent(2);return{insertColor:p,removeColor:_}}),d=gi(document.createElement("div"));d.setClassName("diffViewport"),d.setPosition("absolute");const u=Vt("div.diffOverview",{style:{position:"absolute",top:"0px",width:Pd.ENTIRE_DIFF_OVERVIEW_WIDTH+"px"}}).root;this._register(FC(u,d.domNode)),this._register(yn(u,Le.POINTER_DOWN,h=>{this._editors.modified.delegateVerticalScrollbarPointerDown(h)})),this._register(oe(u,Le.MOUSE_WHEEL,h=>{this._editors.modified.delegateScrollFromMouseWheelEvent(h)},{passive:!1})),this._register(FC(this._rootElement,u)),this._register(Jo((h,g)=>{const p=this._diffModel.read(h),_=this._editors.original.createOverviewRuler("original diffOverviewRuler");_&&(g.add(_),g.add(FC(u,_.getDomNode())));const v=this._editors.modified.createOverviewRuler("modified diffOverviewRuler");if(v&&(g.add(v),g.add(FC(u,v.getDomNode()))),!_||!v)return;const C=cr("viewZoneChanged",this._editors.original.onDidChangeViewZones),y=cr("viewZoneChanged",this._editors.modified.onDidChangeViewZones),x=cr("hiddenRangesChanged",this._editors.original.onDidChangeHiddenAreas),L=cr("hiddenRangesChanged",this._editors.modified.onDidChangeHiddenAreas);g.add(ht(I=>{var H;C.read(I),y.read(I),x.read(I),L.read(I);const A=c.read(I),D=(H=p==null?void 0:p.diff.read(I))==null?void 0:H.mappings;function N(U,B,ee){const re=ee._getViewModel();return re?U.filter(pe=>pe.length>0).map(pe=>{const Ie=re.coordinatesConverter.convertModelPositionToViewPosition(new X(pe.startLineNumber,1)),ge=re.coordinatesConverter.convertModelPositionToViewPosition(new X(pe.endLineNumberExclusive,1)),_e=ge.lineNumber-Ie.lineNumber;return new sme(Ie.lineNumber,ge.lineNumber,_e,B.toString())}):[]}const R=N((D||[]).map(U=>U.lineRangeMapping.original),A.removeColor,this._editors.original),W=N((D||[]).map(U=>U.lineRangeMapping.modified),A.insertColor,this._editors.modified);_==null||_.setZones(R),v==null||v.setZones(W)})),g.add(ht(I=>{const A=this._rootHeight.read(I),D=this._rootWidth.read(I),N=this._modifiedEditorLayoutInfo.read(I);if(N){const R=Pd.ENTIRE_DIFF_OVERVIEW_WIDTH-2*Pd.ONE_OVERVIEW_WIDTH;_.setLayout({top:0,height:A,right:R+Pd.ONE_OVERVIEW_WIDTH,width:Pd.ONE_OVERVIEW_WIDTH}),v.setLayout({top:0,height:A,right:0,width:Pd.ONE_OVERVIEW_WIDTH});const W=this._editors.modifiedScrollTop.read(I),H=this._editors.modifiedScrollHeight.read(I),U=this._editors.modified.getOption(104),B=new C1(U.verticalHasArrows?U.arrowSize:0,U.verticalScrollbarSize,0,N.height,H,W);d.setTop(B.getSliderPosition()),d.setHeight(B.getSliderSize())}else d.setTop(0),d.setHeight(0);u.style.height=A+"px",u.style.left=D-Pd.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",d.setWidth(Pd.ENTIRE_DIFF_OVERVIEW_WIDTH)}))}))}},Pd=tg,tg.ONE_OVERVIEW_WIDTH=15,tg.ENTIRE_DIFF_OVERVIEW_WIDTH=tg.ONE_OVERVIEW_WIDTH*2,tg);QI=Pd=Bje([Wje(6,gs)],QI);const mB=[];class Hje extends te{constructor(e,t,i,n){super(),this._editors=e,this._diffModel=t,this._options=i,this._widget=n,this._selectedDiffs=qe(this,r=>{const o=this._diffModel.read(r),a=o==null?void 0:o.diff.read(r);if(!a)return mB;const l=this._editors.modifiedSelections.read(r);if(l.every(h=>h.isEmpty()))return mB;const c=new lc(l.map(h=>Ct.fromRangeInclusive(h))),u=a.mappings.filter(h=>h.lineRangeMapping.innerChanges&&c.intersects(h.lineRangeMapping.modified)).map(h=>({mapping:h,rangeMappings:h.lineRangeMapping.innerChanges.filter(g=>l.some(p=>F.areIntersecting(g.modifiedRange,p)))}));return u.length===0||u.every(h=>h.rangeMappings.length===0)?mB:u}),this._register(Jo((r,o)=>{if(!this._options.shouldRenderOldRevertArrows.read(r))return;const a=this._diffModel.read(r),l=a==null?void 0:a.diff.read(r);if(!a||!l||a.movedTextToCompare.read(r))return;const c=[],d=this._selectedDiffs.read(r),u=new Set(d.map(h=>h.mapping));if(d.length>0){const h=this._editors.modifiedSelections.read(r),g=o.add(new xP(h[h.length-1].positionLineNumber,this._widget,d.flatMap(p=>p.rangeMappings),!0));this._editors.modified.addGlyphMarginWidget(g),c.push(g)}for(const h of l.mappings)if(!u.has(h)&&!h.lineRangeMapping.modified.isEmpty&&h.lineRangeMapping.innerChanges){const g=o.add(new xP(h.lineRangeMapping.modified.startLineNumber,this._widget,h.lineRangeMapping,!1));this._editors.modified.addGlyphMarginWidget(g),c.push(g)}o.add(Ye(()=>{for(const h of c)this._editors.modified.removeGlyphMarginWidget(h)}))}))}}const wO=class wO extends te{getId(){return this._id}constructor(e,t,i,n){super(),this._lineNumber=e,this._widget=t,this._diffs=i,this._revertSelection=n,this._id=`revertButton${wO.counter++}`,this._domNode=Vt("div.revertButton",{title:this._revertSelection?b("revertSelectedChanges","Revert Selected Changes"):b("revertChange","Revert Change")},[pw(xe.arrowRight)]).root,this._register(oe(this._domNode,Le.MOUSE_DOWN,r=>{r.button!==2&&(r.stopPropagation(),r.preventDefault())})),this._register(oe(this._domNode,Le.MOUSE_UP,r=>{r.stopPropagation(),r.preventDefault()})),this._register(oe(this._domNode,Le.CLICK,r=>{this._diffs instanceof Qr?this._widget.revert(this._diffs):this._widget.revertRangeMappings(this._diffs),r.stopPropagation(),r.preventDefault()}))}getDomNode(){return this._domNode}getPosition(){return{lane:ld.Right,range:{startColumn:1,startLineNumber:this._lineNumber,endColumn:1,endLineNumber:this._lineNumber},zIndex:10001}}};wO.counter=0;let xP=wO;function zje(s,e,t){return l9e({debugName:()=>`Configuration Key "${s}"`},i=>t.onDidChangeConfiguration(n=>{n.affectsConfiguration(s)&&i(n)}),()=>t.getValue(s)??e)}function Fd(s,e,t){const i=s.bindTo(e);return tD({debugName:()=>`Set Context Key "${s.key}"`},n=>{i.set(t(n))})}var Uje=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},fre=function(s,e){return function(t,i){e(t,i,s)}};let rz=class extends te{get onDidContentSizeChange(){return this._onDidContentSizeChange.event}constructor(e,t,i,n,r,o,a){super(),this.originalEditorElement=e,this.modifiedEditorElement=t,this._options=i,this._argCodeEditorWidgetOptions=n,this._createInnerEditor=r,this._instantiationService=o,this._keybindingService=a,this.original=this._register(this._createLeftHandSideEditor(this._options.editorOptions.get(),this._argCodeEditorWidgetOptions.originalEditor||{})),this.modified=this._register(this._createRightHandSideEditor(this._options.editorOptions.get(),this._argCodeEditorWidgetOptions.modifiedEditor||{})),this._onDidContentSizeChange=this._register(new Z),this.modifiedScrollTop=wi(this,this.modified.onDidScrollChange,()=>this.modified.getScrollTop()),this.modifiedScrollHeight=wi(this,this.modified.onDidScrollChange,()=>this.modified.getScrollHeight()),this.modifiedObs=Ea(this.modified),this.originalObs=Ea(this.original),this.modifiedModel=this.modifiedObs.model,this.modifiedSelections=wi(this,this.modified.onDidChangeCursorSelection,()=>this.modified.getSelections()??[]),this.modifiedCursor=_l({owner:this,equalsFn:X.equals},l=>{var c;return((c=this.modifiedSelections.read(l)[0])==null?void 0:c.getPosition())??new X(1,1)}),this.originalCursor=wi(this,this.original.onDidChangeCursorPosition,()=>this.original.getPosition()??new X(1,1)),this._argCodeEditorWidgetOptions=null,this._register(iD({createEmptyChangeSummary:()=>({}),handleChange:(l,c)=>(l.didChange(i.editorOptions)&&Object.assign(c,l.change.changedOptions),!0)},(l,c)=>{i.editorOptions.read(l),this._options.renderSideBySide.read(l),this.modified.updateOptions(this._adjustOptionsForRightHandSide(l,c)),this.original.updateOptions(this._adjustOptionsForLeftHandSide(l,c))}))}_createLeftHandSideEditor(e,t){const i=this._adjustOptionsForLeftHandSide(void 0,e),n=this._constructInnerEditor(this._instantiationService,this.originalEditorElement,i,t);return n.setContextValue("isInDiffLeftEditor",!0),n}_createRightHandSideEditor(e,t){const i=this._adjustOptionsForRightHandSide(void 0,e),n=this._constructInnerEditor(this._instantiationService,this.modifiedEditorElement,i,t);return n.setContextValue("isInDiffRightEditor",!0),n}_constructInnerEditor(e,t,i,n){const r=this._createInnerEditor(e,t,i,n);return this._register(r.onDidContentSizeChange(o=>{const a=this.original.getContentWidth()+this.modified.getContentWidth()+QI.ENTIRE_DIFF_OVERVIEW_WIDTH,l=Math.max(this.modified.getContentHeight(),this.original.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:l,contentWidth:a,contentHeightChanged:o.contentHeightChanged,contentWidthChanged:o.contentWidthChanged})})),r}_adjustOptionsForLeftHandSide(e,t){const i=this._adjustOptionsForSubEditor(t);return this._options.renderSideBySide.get()?(i.unicodeHighlight=this._options.editorOptions.get().unicodeHighlight||{},i.wordWrapOverride1=this._options.diffWordWrap.get()):(i.wordWrapOverride1="off",i.wordWrapOverride2="off",i.stickyScroll={enabled:!1},i.unicodeHighlight={nonBasicASCII:!1,ambiguousCharacters:!1,invisibleCharacters:!1}),i.glyphMargin=this._options.renderSideBySide.get(),t.originalAriaLabel&&(i.ariaLabel=t.originalAriaLabel),i.ariaLabel=this._updateAriaLabel(i.ariaLabel),i.readOnly=!this._options.originalEditable.get(),i.dropIntoEditor={enabled:!i.readOnly},i.extraEditorClassName="original-in-monaco-diff-editor",i}_adjustOptionsForRightHandSide(e,t){const i=this._adjustOptionsForSubEditor(t);return t.modifiedAriaLabel&&(i.ariaLabel=t.modifiedAriaLabel),i.ariaLabel=this._updateAriaLabel(i.ariaLabel),i.wordWrapOverride1=this._options.diffWordWrap.get(),i.revealHorizontalRightPadding=bu.revealHorizontalRightPadding.defaultValue+QI.ENTIRE_DIFF_OVERVIEW_WIDTH,i.scrollbar.verticalHasArrows=!1,i.extraEditorClassName="modified-in-monaco-diff-editor",i}_adjustOptionsForSubEditor(e){const t={...e,dimension:{height:0,width:0}};return t.inDiffEditor=!0,t.automaticLayout=!1,t.scrollbar={...t.scrollbar||{}},t.folding=!1,t.codeLens=this._options.diffCodeLens.get(),t.fixedOverflowWidgets=!0,t.minimap={...t.minimap||{}},t.minimap.enabled=!1,this._options.hideUnchangedRegions.get()?t.stickyScroll={enabled:!1}:t.stickyScroll=this._options.editorOptions.get().stickyScroll,t}_updateAriaLabel(e){var i;e||(e="");const t=b("diff-aria-navigation-tip"," use {0} to open the accessibility help.",(i=this._keybindingService.lookupKeybinding("editor.action.accessibilityHelp"))==null?void 0:i.getAriaLabel());return this._options.accessibilityVerbose.get()?e+t:e?e.replaceAll(t,""):""}};rz=Uje([fre(5,Xe),fre(6,pi)],rz);const CO=class CO extends te{constructor(){super(...arguments),this._id=++CO.idCounter,this._onDidDispose=this._register(new Z),this.onDidDispose=this._onDidDispose.event}getId(){return this.getEditorType()+":v2:"+this._id}getVisibleColumnFromPosition(e){return this._targetEditor.getVisibleColumnFromPosition(e)}getPosition(){return this._targetEditor.getPosition()}setPosition(e,t="api"){this._targetEditor.setPosition(e,t)}revealLine(e,t=0){this._targetEditor.revealLine(e,t)}revealLineInCenter(e,t=0){this._targetEditor.revealLineInCenter(e,t)}revealLineInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealLineInCenterIfOutsideViewport(e,t)}revealLineNearTop(e,t=0){this._targetEditor.revealLineNearTop(e,t)}revealPosition(e,t=0){this._targetEditor.revealPosition(e,t)}revealPositionInCenter(e,t=0){this._targetEditor.revealPositionInCenter(e,t)}revealPositionInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealPositionInCenterIfOutsideViewport(e,t)}revealPositionNearTop(e,t=0){this._targetEditor.revealPositionNearTop(e,t)}getSelection(){return this._targetEditor.getSelection()}getSelections(){return this._targetEditor.getSelections()}setSelection(e,t="api"){this._targetEditor.setSelection(e,t)}setSelections(e,t="api"){this._targetEditor.setSelections(e,t)}revealLines(e,t,i=0){this._targetEditor.revealLines(e,t,i)}revealLinesInCenter(e,t,i=0){this._targetEditor.revealLinesInCenter(e,t,i)}revealLinesInCenterIfOutsideViewport(e,t,i=0){this._targetEditor.revealLinesInCenterIfOutsideViewport(e,t,i)}revealLinesNearTop(e,t,i=0){this._targetEditor.revealLinesNearTop(e,t,i)}revealRange(e,t=0,i=!1,n=!0){this._targetEditor.revealRange(e,t,i,n)}revealRangeInCenter(e,t=0){this._targetEditor.revealRangeInCenter(e,t)}revealRangeInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealRangeInCenterIfOutsideViewport(e,t)}revealRangeNearTop(e,t=0){this._targetEditor.revealRangeNearTop(e,t)}revealRangeNearTopIfOutsideViewport(e,t=0){this._targetEditor.revealRangeNearTopIfOutsideViewport(e,t)}revealRangeAtTop(e,t=0){this._targetEditor.revealRangeAtTop(e,t)}getSupportedActions(){return this._targetEditor.getSupportedActions()}focus(){this._targetEditor.focus()}trigger(e,t,i){this._targetEditor.trigger(e,t,i)}createDecorationsCollection(e){return this._targetEditor.createDecorationsCollection(e)}changeDecorations(e){return this._targetEditor.changeDecorations(e)}};CO.idCounter=0;let oz=CO;var jje=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},$je=function(s,e){return function(t,i){e(t,i,s)}};let az=class{get editorOptions(){return this._options}constructor(e,t){this._accessibilityService=t,this._diffEditorWidth=Rt(this,0),this._screenReaderMode=wi(this,this._accessibilityService.onDidChangeScreenReaderOptimized,()=>this._accessibilityService.isScreenReaderOptimized()),this.couldShowInlineViewBecauseOfSize=qe(this,n=>this._options.read(n).renderSideBySide&&this._diffEditorWidth.read(n)<=this._options.read(n).renderSideBySideInlineBreakpoint),this.renderOverviewRuler=qe(this,n=>this._options.read(n).renderOverviewRuler),this.renderSideBySide=qe(this,n=>this.compactMode.read(n)&&this.shouldRenderInlineViewInSmartMode.read(n)?!1:this._options.read(n).renderSideBySide&&!(this._options.read(n).useInlineViewWhenSpaceIsLimited&&this.couldShowInlineViewBecauseOfSize.read(n)&&!this._screenReaderMode.read(n))),this.readOnly=qe(this,n=>this._options.read(n).readOnly),this.shouldRenderOldRevertArrows=qe(this,n=>!(!this._options.read(n).renderMarginRevertIcon||!this.renderSideBySide.read(n)||this.readOnly.read(n)||this.shouldRenderGutterMenu.read(n))),this.shouldRenderGutterMenu=qe(this,n=>this._options.read(n).renderGutterMenu),this.renderIndicators=qe(this,n=>this._options.read(n).renderIndicators),this.enableSplitViewResizing=qe(this,n=>this._options.read(n).enableSplitViewResizing),this.splitViewDefaultRatio=qe(this,n=>this._options.read(n).splitViewDefaultRatio),this.ignoreTrimWhitespace=qe(this,n=>this._options.read(n).ignoreTrimWhitespace),this.maxComputationTimeMs=qe(this,n=>this._options.read(n).maxComputationTime),this.showMoves=qe(this,n=>this._options.read(n).experimental.showMoves&&this.renderSideBySide.read(n)),this.isInEmbeddedEditor=qe(this,n=>this._options.read(n).isInEmbeddedEditor),this.diffWordWrap=qe(this,n=>this._options.read(n).diffWordWrap),this.originalEditable=qe(this,n=>this._options.read(n).originalEditable),this.diffCodeLens=qe(this,n=>this._options.read(n).diffCodeLens),this.accessibilityVerbose=qe(this,n=>this._options.read(n).accessibilityVerbose),this.diffAlgorithm=qe(this,n=>this._options.read(n).diffAlgorithm),this.showEmptyDecorations=qe(this,n=>this._options.read(n).experimental.showEmptyDecorations),this.onlyShowAccessibleDiffViewer=qe(this,n=>this._options.read(n).onlyShowAccessibleDiffViewer),this.compactMode=qe(this,n=>this._options.read(n).compactMode),this.trueInlineDiffRenderingEnabled=qe(this,n=>this._options.read(n).experimental.useTrueInlineView),this.useTrueInlineDiffRendering=qe(this,n=>!this.renderSideBySide.read(n)&&this.trueInlineDiffRenderingEnabled.read(n)),this.hideUnchangedRegions=qe(this,n=>this._options.read(n).hideUnchangedRegions.enabled),this.hideUnchangedRegionsRevealLineCount=qe(this,n=>this._options.read(n).hideUnchangedRegions.revealLineCount),this.hideUnchangedRegionsContextLineCount=qe(this,n=>this._options.read(n).hideUnchangedRegions.contextLineCount),this.hideUnchangedRegionsMinimumLineCount=qe(this,n=>this._options.read(n).hideUnchangedRegions.minimumLineCount),this._model=Rt(this,void 0),this.shouldRenderInlineViewInSmartMode=this._model.map(this,n=>h9e(this,r=>{const o=n==null?void 0:n.diff.read(r);return o?qje(o,this.trueInlineDiffRenderingEnabled.read(r)):void 0})).flatten().map(this,n=>!!n),this.inlineViewHideOriginalLineNumbers=this.compactMode;const i={...e,...gre(e,ir)};this._options=Rt(this,i)}updateOptions(e){const t=gre(e,this._options.get()),i={...this._options.get(),...e,...t};this._options.set(i,void 0,{changedOptions:e})}setWidth(e){this._diffEditorWidth.set(e,void 0)}setModel(e){this._model.set(e,void 0)}};az=jje([$je(1,Wa)],az);function qje(s,e){return s.mappings.every(t=>Kje(t.lineRangeMapping)||Gje(t.lineRangeMapping)||e&&YG(t.lineRangeMapping))}function Kje(s){return s.original.length===0}function Gje(s){return s.modified.length===0}function gre(s,e){var t,i,n,r,o,a,l,c;return{enableSplitViewResizing:Ke(s.enableSplitViewResizing,e.enableSplitViewResizing),splitViewDefaultRatio:ZTe(s.splitViewDefaultRatio,.5,.1,.9),renderSideBySide:Ke(s.renderSideBySide,e.renderSideBySide),renderMarginRevertIcon:Ke(s.renderMarginRevertIcon,e.renderMarginRevertIcon),maxComputationTime:nb(s.maxComputationTime,e.maxComputationTime,0,1073741824),maxFileSize:nb(s.maxFileSize,e.maxFileSize,0,1073741824),ignoreTrimWhitespace:Ke(s.ignoreTrimWhitespace,e.ignoreTrimWhitespace),renderIndicators:Ke(s.renderIndicators,e.renderIndicators),originalEditable:Ke(s.originalEditable,e.originalEditable),diffCodeLens:Ke(s.diffCodeLens,e.diffCodeLens),renderOverviewRuler:Ke(s.renderOverviewRuler,e.renderOverviewRuler),diffWordWrap:xn(s.diffWordWrap,e.diffWordWrap,["off","on","inherit"]),diffAlgorithm:xn(s.diffAlgorithm,e.diffAlgorithm,["legacy","advanced"],{smart:"legacy",experimental:"advanced"}),accessibilityVerbose:Ke(s.accessibilityVerbose,e.accessibilityVerbose),experimental:{showMoves:Ke((t=s.experimental)==null?void 0:t.showMoves,e.experimental.showMoves),showEmptyDecorations:Ke((i=s.experimental)==null?void 0:i.showEmptyDecorations,e.experimental.showEmptyDecorations),useTrueInlineView:Ke((n=s.experimental)==null?void 0:n.useTrueInlineView,e.experimental.useTrueInlineView)},hideUnchangedRegions:{enabled:Ke(((r=s.hideUnchangedRegions)==null?void 0:r.enabled)??((o=s.experimental)==null?void 0:o.collapseUnchangedRegions),e.hideUnchangedRegions.enabled),contextLineCount:nb((a=s.hideUnchangedRegions)==null?void 0:a.contextLineCount,e.hideUnchangedRegions.contextLineCount,0,1073741824),minimumLineCount:nb((l=s.hideUnchangedRegions)==null?void 0:l.minimumLineCount,e.hideUnchangedRegions.minimumLineCount,0,1073741824),revealLineCount:nb((c=s.hideUnchangedRegions)==null?void 0:c.revealLineCount,e.hideUnchangedRegions.revealLineCount,0,1073741824)},isInEmbeddedEditor:Ke(s.isInEmbeddedEditor,e.isInEmbeddedEditor),onlyShowAccessibleDiffViewer:Ke(s.onlyShowAccessibleDiffViewer,e.onlyShowAccessibleDiffViewer),renderSideBySideInlineBreakpoint:nb(s.renderSideBySideInlineBreakpoint,e.renderSideBySideInlineBreakpoint,0,1073741824),useInlineViewWhenSpaceIsLimited:Ke(s.useInlineViewWhenSpaceIsLimited,e.useInlineViewWhenSpaceIsLimited),renderGutterMenu:Ke(s.renderGutterMenu,e.renderGutterMenu),compactMode:Ke(s.compactMode,e.compactMode)}}var Qje=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Fx=function(s,e){return function(t,i){e(t,i,s)}};let Eg=class extends oz{get onDidContentSizeChange(){return this._editors.onDidContentSizeChange}constructor(e,t,i,n,r,o,a,l){super(),this._domElement=e,this._parentContextKeyService=n,this._parentInstantiationService=r,this._accessibilitySignalService=a,this._editorProgressService=l,this.elements=Vt("div.monaco-diff-editor.side-by-side",{style:{position:"relative",height:"100%"}},[Vt("div.editor.original@original",{style:{position:"absolute",height:"100%"}}),Vt("div.editor.modified@modified",{style:{position:"absolute",height:"100%"}}),Vt("div.accessibleDiffViewer@accessibleDiffViewer",{style:{position:"absolute",height:"100%"}})]),this._diffModelSrc=this._register(SI(this,void 0)),this._diffModel=qe(this,L=>{var I;return(I=this._diffModelSrc.read(L))==null?void 0:I.object}),this.onDidChangeModel=De.fromObservableLight(this._diffModel),this._contextKeyService=this._register(this._parentContextKeyService.createScoped(this._domElement)),this._instantiationService=this._register(this._parentInstantiationService.createChild(new xS([ct,this._contextKeyService]))),this._boundarySashes=Rt(this,void 0),this._accessibleDiffViewerShouldBeVisible=Rt(this,!1),this._accessibleDiffViewerVisible=qe(this,L=>this._options.onlyShowAccessibleDiffViewer.read(L)?!0:this._accessibleDiffViewerShouldBeVisible.read(L)),this._movedBlocksLinesPart=Rt(this,void 0),this._layoutInfo=qe(this,L=>{var Ie,ge;const I=this._rootSizeObserver.width.read(L),A=this._rootSizeObserver.height.read(L);this._rootSizeObserver.automaticLayout?this.elements.root.style.height="100%":this.elements.root.style.height=A+"px";const D=this._sash.read(L),N=this._gutter.read(L),R=(N==null?void 0:N.width.read(L))??0,W=((Ie=this._overviewRulerPart.read(L))==null?void 0:Ie.width)??0;let H,U,B,ee,re;if(!!D){const _e=D.sashLeft.read(L),Re=((ge=this._movedBlocksLinesPart.read(L))==null?void 0:ge.width.read(L))??0;H=0,U=_e-R-Re,re=_e-R,B=_e,ee=I-B-W}else{re=0;const _e=this._options.inlineViewHideOriginalLineNumbers.read(L);H=R,_e?U=0:U=Math.max(5,this._editors.originalObs.layoutInfoDecorationsLeft.read(L)),B=R+U,ee=I-B-W}return this.elements.original.style.left=H+"px",this.elements.original.style.width=U+"px",this._editors.original.layout({width:U,height:A},!0),N==null||N.layout(re),this.elements.modified.style.left=B+"px",this.elements.modified.style.width=ee+"px",this._editors.modified.layout({width:ee,height:A},!0),{modifiedEditor:this._editors.modified.getLayoutInfo(),originalEditor:this._editors.original.getLayoutInfo()}}),this._diffValue=this._diffModel.map((L,I)=>L==null?void 0:L.diff.read(I)),this.onDidUpdateDiff=De.fromObservableLight(this._diffValue),o.willCreateDiffEditor(),this._contextKeyService.createKey("isInDiffEditor",!0),this._domElement.appendChild(this.elements.root),this._register(Ye(()=>this.elements.root.remove())),this._rootSizeObserver=this._register(new cme(this.elements.root,t.dimension)),this._rootSizeObserver.setAutomaticLayout(t.automaticLayout??!1),this._options=this._instantiationService.createInstance(az,t),this._register(ht(L=>{this._options.setWidth(this._rootSizeObserver.width.read(L))})),this._contextKeyService.createKey(z.isEmbeddedDiffEditor.key,!1),this._register(Fd(z.isEmbeddedDiffEditor,this._contextKeyService,L=>this._options.isInEmbeddedEditor.read(L))),this._register(Fd(z.comparingMovedCode,this._contextKeyService,L=>{var I;return!!((I=this._diffModel.read(L))!=null&&I.movedTextToCompare.read(L))})),this._register(Fd(z.diffEditorRenderSideBySideInlineBreakpointReached,this._contextKeyService,L=>this._options.couldShowInlineViewBecauseOfSize.read(L))),this._register(Fd(z.diffEditorInlineMode,this._contextKeyService,L=>!this._options.renderSideBySide.read(L))),this._register(Fd(z.hasChanges,this._contextKeyService,L=>{var I,A;return(((A=(I=this._diffModel.read(L))==null?void 0:I.diff.read(L))==null?void 0:A.mappings.length)??0)>0})),this._editors=this._register(this._instantiationService.createInstance(rz,this.elements.original,this.elements.modified,this._options,i,(L,I,A,D)=>this._createInnerEditor(L,I,A,D))),this._register(Fd(z.diffEditorOriginalWritable,this._contextKeyService,L=>this._options.originalEditable.read(L))),this._register(Fd(z.diffEditorModifiedWritable,this._contextKeyService,L=>!this._options.readOnly.read(L))),this._register(Fd(z.diffEditorOriginalUri,this._contextKeyService,L=>{var I;return((I=this._diffModel.read(L))==null?void 0:I.model.original.uri.toString())??""})),this._register(Fd(z.diffEditorModifiedUri,this._contextKeyService,L=>{var I;return((I=this._diffModel.read(L))==null?void 0:I.model.modified.uri.toString())??""})),this._overviewRulerPart=Kr(this,L=>this._options.renderOverviewRuler.read(L)?this._instantiationService.createInstance(xa(QI,L),this._editors,this.elements.root,this._diffModel,this._rootSizeObserver.width,this._rootSizeObserver.height,this._layoutInfo.map(I=>I.modifiedEditor)):void 0).recomputeInitiallyAndOnChange(this._store);const c={height:this._rootSizeObserver.height,width:this._rootSizeObserver.width.map((L,I)=>{var A;return L-(((A=this._overviewRulerPart.read(I))==null?void 0:A.width)??0)})};this._sashLayout=new Rje(this._options,c),this._sash=Kr(this,L=>{const I=this._options.renderSideBySide.read(L);return this.elements.root.classList.toggle("side-by-side",I),I?new gme(this.elements.root,c,this._options.enableSplitViewResizing,this._boundarySashes,this._sashLayout.sashLeft,()=>this._sashLayout.resetSash()):void 0}).recomputeInitiallyAndOnChange(this._store);const d=Kr(this,L=>this._instantiationService.createInstance(xa(SP,L),this._editors,this._diffModel,this._options)).recomputeInitiallyAndOnChange(this._store);Kr(this,L=>this._instantiationService.createInstance(xa(Nje,L),this._editors,this._diffModel,this._options,this)).recomputeInitiallyAndOnChange(this._store);const u=new Set,h=new Set;let g=!1;const p=Kr(this,L=>this._instantiationService.createInstance(xa(ez,L),nt(this._domElement),this._editors,this._diffModel,this._options,this,()=>g||d.get().isUpdatingHiddenAreas,u,h)).recomputeInitiallyAndOnChange(this._store),_=qe(this,L=>{const I=p.read(L).viewZones.read(L).orig,A=d.read(L).viewZones.read(L).origViewZones;return I.concat(A)}),v=qe(this,L=>{const I=p.read(L).viewZones.read(L).mod,A=d.read(L).viewZones.read(L).modViewZones;return I.concat(A)});this._register(bP(this._editors.original,_,L=>{g=L},u));let C;this._register(bP(this._editors.modified,v,L=>{g=L,g?C=_u.capture(this._editors.modified):(C==null||C.restore(this._editors.modified),C=void 0)},h)),this._accessibleDiffViewer=Kr(this,L=>this._instantiationService.createInstance(xa(zb,L),this.elements.accessibleDiffViewer,this._accessibleDiffViewerVisible,(I,A)=>this._accessibleDiffViewerShouldBeVisible.set(I,A),this._options.onlyShowAccessibleDiffViewer.map(I=>!I),this._rootSizeObserver.width,this._rootSizeObserver.height,this._diffModel.map((I,A)=>{var D;return(D=I==null?void 0:I.diff.read(A))==null?void 0:D.mappings.map(N=>N.lineRangeMapping)}),new vje(this._editors))).recomputeInitiallyAndOnChange(this._store);const y=this._accessibleDiffViewerVisible.map(L=>L?"hidden":"visible");this._register(Ig(this.elements.modified,{visibility:y})),this._register(Ig(this.elements.original,{visibility:y})),this._createDiffEditorContributions(),o.addDiffEditor(this),this._gutter=Kr(this,L=>this._options.shouldRenderGutterMenu.read(L)?this._instantiationService.createInstance(xa(tz,L),this.elements.root,this._diffModel,this._editors,this._options,this._sashLayout,this._boundarySashes):void 0),this._register(wS(this._layoutInfo)),Kr(this,L=>new(xa(My,L))(this.elements.root,this._diffModel,this._layoutInfo.map(I=>I.originalEditor),this._layoutInfo.map(I=>I.modifiedEditor),this._editors)).recomputeInitiallyAndOnChange(this._store,L=>{this._movedBlocksLinesPart.set(L,void 0)}),this._register(De.runAndSubscribe(this._editors.modified.onDidChangeCursorPosition,L=>this._handleCursorPositionChange(L,!0))),this._register(De.runAndSubscribe(this._editors.original.onDidChangeCursorPosition,L=>this._handleCursorPositionChange(L,!1)));const x=this._diffModel.map(this,(L,I)=>{if(L)return L.diff.read(I)===void 0&&!L.isDiffUpToDate.read(I)});this._register(Jo((L,I)=>{if(x.read(L)===!0){const A=this._editorProgressService.show(!0,1e3);I.add(Ye(()=>A.done()))}})),this._register(Jo((L,I)=>{I.add(new(xa(Hje,L))(this._editors,this._diffModel,this._options,this))})),this._register(Jo((L,I)=>{const A=this._diffModel.read(L);if(A)for(const D of[A.model.original,A.model.modified])I.add(D.onWillDispose(N=>{ft(new di("TextModel got disposed before DiffEditorWidget model got reset")),this.setModel(null)}))})),this._register(ht(L=>{this._options.setModel(this._diffModel.read(L))}))}_createInnerEditor(e,t,i,n){return e.createInstance($I,t,i,n)}_createDiffEditorContributions(){const e=Xb.getDiffEditorContributions();for(const t of e)try{this._register(this._instantiationService.createInstance(t.ctor,this))}catch(i){ft(i)}}get _targetEditor(){return this._editors.modified}getEditorType(){return cD.IDiffEditor}layout(e){this._rootSizeObserver.observe(e)}hasTextFocus(){return this._editors.original.hasTextFocus()||this._editors.modified.hasTextFocus()}saveViewState(){var i;const e=this._editors.original.saveViewState(),t=this._editors.modified.saveViewState();return{original:e,modified:t,modelState:(i=this._diffModel.get())==null?void 0:i.serializeState()}}restoreViewState(e){var t;if(e&&e.original&&e.modified){const i=e;this._editors.original.restoreViewState(i.original),this._editors.modified.restoreViewState(i.modified),i.modelState&&((t=this._diffModel.get())==null||t.restoreSerializedState(i.modelState))}}handleInitialized(){this._editors.original.handleInitialized(),this._editors.modified.handleInitialized()}createViewModel(e){return this._instantiationService.createInstance(JH,e,this._options)}getModel(){var e;return((e=this._diffModel.get())==null?void 0:e.model)??null}setModel(e){const t=e?"model"in e?vP.create(e).createNewRef(this):vP.create(this.createViewModel(e),this):null;this.setDiffModel(t)}setDiffModel(e,t){const i=this._diffModel.get();!e&&i&&this._accessibleDiffViewer.get().close(),this._diffModel.get()!==(e==null?void 0:e.object)&&bw(t,n=>{var a;const r=e==null?void 0:e.object;wi.batchEventsGlobally(n,()=>{this._editors.original.setModel(r?r.model.original:null),this._editors.modified.setModel(r?r.model.modified:null)});const o=(a=this._diffModelSrc.get())==null?void 0:a.createNewRef(this);this._diffModelSrc.set(e==null?void 0:e.createNewRef(this),n),setTimeout(()=>{o==null||o.dispose()},0)})}updateOptions(e){this._options.updateOptions(e)}getContainerDomNode(){return this._domElement}getOriginalEditor(){return this._editors.original}getModifiedEditor(){return this._editors.modified}getLineChanges(){var t;const e=(t=this._diffModel.get())==null?void 0:t.diff.get();return e?Yje(e):null}revert(e){const t=this._diffModel.get();!t||!t.isDiffUpToDate.get()||this._editors.modified.executeEdits("diffEditor",[{range:e.modified.toExclusiveRange(),text:t.model.original.getValueInRange(e.original.toExclusiveRange())}])}revertRangeMappings(e){const t=this._diffModel.get();if(!t||!t.isDiffUpToDate.get())return;const i=e.map(n=>({range:n.modifiedRange,text:t.model.original.getValueInRange(n.originalRange)}));this._editors.modified.executeEdits("diffEditor",i)}_goTo(e){this._editors.modified.setPosition(new X(e.lineRangeMapping.modified.startLineNumber,1)),this._editors.modified.revealRangeInCenter(e.lineRangeMapping.modified.toExclusiveRange())}goToDiff(e){var r,o;const t=(o=(r=this._diffModel.get())==null?void 0:r.diff.get())==null?void 0:o.mappings;if(!t||t.length===0)return;const i=this._editors.modified.getPosition().lineNumber;let n;e==="next"?n=t.find(a=>a.lineRangeMapping.modified.startLineNumber>i)??t[0]:n=oI(t,a=>a.lineRangeMapping.modified.startLineNumber<i)??t[t.length-1],this._goTo(n),n.lineRangeMapping.modified.isEmpty?this._accessibilitySignalService.playSignal(fl.diffLineDeleted,{source:"diffEditor.goToDiff"}):n.lineRangeMapping.original.isEmpty?this._accessibilitySignalService.playSignal(fl.diffLineInserted,{source:"diffEditor.goToDiff"}):n&&this._accessibilitySignalService.playSignal(fl.diffLineModified,{source:"diffEditor.goToDiff"})}revealFirstDiff(){const e=this._diffModel.get();e&&this.waitForDiff().then(()=>{var i;const t=(i=e.diff.get())==null?void 0:i.mappings;!t||t.length===0||this._goTo(t[0])})}accessibleDiffViewerNext(){this._accessibleDiffViewer.get().next()}accessibleDiffViewerPrev(){this._accessibleDiffViewer.get().prev()}async waitForDiff(){const e=this._diffModel.get();e&&await e.waitForDiff()}mapToOtherSide(){var o,a;const e=this._editors.modified.hasWidgetFocus(),t=e?this._editors.modified:this._editors.original,i=e?this._editors.original:this._editors.modified;let n;const r=t.getSelection();if(r){const l=(a=(o=this._diffModel.get())==null?void 0:o.diff.get())==null?void 0:a.mappings.map(c=>e?c.lineRangeMapping.flip():c.lineRangeMapping);if(l){const c=Zse(r.getStartPosition(),l),d=Zse(r.getEndPosition(),l);n=F.plusRange(c,d)}}return{destination:i,destinationSelection:n}}switchSide(){const{destination:e,destinationSelection:t}=this.mapToOtherSide();e.focus(),t&&e.setSelection(t)}exitCompareMove(){const e=this._diffModel.get();e&&e.movedTextToCompare.set(void 0,void 0)}collapseAllUnchangedRegions(){var t;const e=(t=this._diffModel.get())==null?void 0:t.unchangedRegions.get();e&&pn(i=>{for(const n of e)n.collapseAll(i)})}showAllUnchangedRegions(){var t;const e=(t=this._diffModel.get())==null?void 0:t.unchangedRegions.get();e&&pn(i=>{for(const n of e)n.showAll(i)})}_handleCursorPositionChange(e,t){var i,n;if((e==null?void 0:e.reason)===3){const r=(n=(i=this._diffModel.get())==null?void 0:i.diff.get())==null?void 0:n.mappings.find(o=>t?o.lineRangeMapping.modified.contains(e.position.lineNumber):o.lineRangeMapping.original.contains(e.position.lineNumber));r!=null&&r.lineRangeMapping.modified.isEmpty?this._accessibilitySignalService.playSignal(fl.diffLineDeleted,{source:"diffEditor.cursorPositionChanged"}):r!=null&&r.lineRangeMapping.original.isEmpty?this._accessibilitySignalService.playSignal(fl.diffLineInserted,{source:"diffEditor.cursorPositionChanged"}):r&&this._accessibilitySignalService.playSignal(fl.diffLineModified,{source:"diffEditor.cursorPositionChanged"})}}};Eg=Qje([Fx(3,ct),Fx(4,Xe),Fx(5,ni),Fx(6,v_),Fx(7,m_)],Eg);function Yje(s){return s.mappings.map(e=>{const t=e.lineRangeMapping;let i,n,r,o,a=t.innerChanges;return t.original.isEmpty?(i=t.original.startLineNumber-1,n=0,a=void 0):(i=t.original.startLineNumber,n=t.original.endLineNumberExclusive-1),t.modified.isEmpty?(r=t.modified.startLineNumber-1,o=0,a=void 0):(r=t.modified.startLineNumber,o=t.modified.endLineNumberExclusive-1),{originalStartLineNumber:i,originalEndLineNumber:n,modifiedStartLineNumber:r,modifiedEndLineNumber:o,charChanges:a==null?void 0:a.map(l=>({originalStartLineNumber:l.originalRange.startLineNumber,originalStartColumn:l.originalRange.startColumn,originalEndLineNumber:l.originalRange.endLineNumber,originalEndColumn:l.originalRange.endColumn,modifiedStartLineNumber:l.modifiedRange.startLineNumber,modifiedStartColumn:l.modifiedRange.startColumn,modifiedEndLineNumber:l.modifiedRange.endLineNumber,modifiedEndColumn:l.modifiedRange.endColumn}))}})}var ZG=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Ui=function(s,e){return function(t,i){e(t,i,s)}};let Xje=0,pre=!1;function Zje(s){if(!s){if(pre)return;pre=!0}n3e(s||Ri.document.body)}let LP=class extends $I{constructor(e,t,i,n,r,o,a,l,c,d,u,h,g){const p={...t};p.ariaLabel=p.ariaLabel||t8.editorViewAccessibleLabel,super(e,p,{},i,n,r,o,c,d,u,h,g),l instanceof N1?this._standaloneKeybindingService=l:this._standaloneKeybindingService=null,Zje(p.ariaContainerElement),_9e((_,v)=>i.createInstance(v1,_,v,{})),b9e(a)}addCommand(e,t,i){if(!this._standaloneKeybindingService)return console.warn("Cannot add command because the editor is configured with an unrecognized KeybindingService"),null;const n="DYNAMIC_"+ ++Xje,r=he.deserialize(i);return this._standaloneKeybindingService.addDynamicKeybinding(n,e,t,r),n}createContextKey(e,t){return this._contextKeyService.createKey(e,t)}addAction(e){if(typeof e.id!="string"||typeof e.label!="string"||typeof e.run!="function")throw new Error("Invalid action descriptor, `id`, `label` and `run` are required properties!");if(!this._standaloneKeybindingService)return console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService"),te.None;const t=e.id,i=e.label,n=he.and(he.equals("editorId",this.getId()),he.deserialize(e.precondition)),r=e.keybindings,o=he.and(n,he.deserialize(e.keybindingContext)),a=e.contextMenuGroupId||null,l=e.contextMenuOrder||0,c=(g,...p)=>Promise.resolve(e.run(this,...p)),d=new ce,u=this.getId()+":"+t;if(d.add(Gt.registerCommand(u,c)),a){const g={command:{id:u,title:i},when:n,group:a,order:l};d.add(Os.appendMenuItem(ze.EditorContext,g))}if(Array.isArray(r))for(const g of r)d.add(this._standaloneKeybindingService.addDynamicKeybinding(u,g,c,o));const h=new rme(u,i,i,void 0,n,(...g)=>Promise.resolve(e.run(this,...g)),this._contextKeyService);return this._actions.set(t,h),d.add(Ye(()=>{this._actions.delete(t)})),d}_triggerCommand(e,t){if(this._codeEditorService instanceof sA)try{this._codeEditorService.setActiveCodeEditor(this),super._triggerCommand(e,t)}finally{this._codeEditorService.setActiveCodeEditor(null)}else super._triggerCommand(e,t)}};LP=ZG([Ui(2,Xe),Ui(3,ni),Ui(4,Hi),Ui(5,ct),Ui(6,Kh),Ui(7,pi),Ui(8,gs),Ui(9,jn),Ui(10,Wa),Ui(11,bn),Ui(12,Be)],LP);let lz=class extends LP{constructor(e,t,i,n,r,o,a,l,c,d,u,h,g,p,_,v){const C={...t};eP(u,C,!1);const y=c.registerEditorContainer(e);typeof C.theme=="string"&&c.setTheme(C.theme),typeof C.autoDetectHighContrast<"u"&&c.setAutoDetectHighContrast(!!C.autoDetectHighContrast);const x=C.model;delete C.model,super(e,C,i,n,r,o,a,l,c,d,h,_,v),this._configurationService=u,this._standaloneThemeService=c,this._register(y);let L;if(typeof x>"u"){const I=p.getLanguageIdByMimeType(C.language)||C.language||So;L=bme(g,p,C.value||"",I,void 0),this._ownsModel=!0}else L=x,this._ownsModel=!1;if(this._attachModel(L),L){const I={oldModelUrl:null,newModelUrl:L.uri};this._onDidChangeModel.fire(I)}}dispose(){super.dispose()}updateOptions(e){eP(this._configurationService,e,!1),typeof e.theme=="string"&&this._standaloneThemeService.setTheme(e.theme),typeof e.autoDetectHighContrast<"u"&&this._standaloneThemeService.setAutoDetectHighContrast(!!e.autoDetectHighContrast),super.updateOptions(e)}_postDetachModelCleanup(e){super._postDetachModelCleanup(e),e&&this._ownsModel&&(e.dispose(),this._ownsModel=!1)}};lz=ZG([Ui(2,Xe),Ui(3,ni),Ui(4,Hi),Ui(5,ct),Ui(6,Kh),Ui(7,pi),Ui(8,Wl),Ui(9,jn),Ui(10,At),Ui(11,Wa),Ui(12,Gi),Ui(13,un),Ui(14,bn),Ui(15,Be)],lz);let cz=class extends Eg{constructor(e,t,i,n,r,o,a,l,c,d,u,h){const g={...t};eP(l,g,!0);const p=o.registerEditorContainer(e);typeof g.theme=="string"&&o.setTheme(g.theme),typeof g.autoDetectHighContrast<"u"&&o.setAutoDetectHighContrast(!!g.autoDetectHighContrast),super(e,g,{},n,i,r,h,d),this._configurationService=l,this._standaloneThemeService=o,this._register(p)}dispose(){super.dispose()}updateOptions(e){eP(this._configurationService,e,!0),typeof e.theme=="string"&&this._standaloneThemeService.setTheme(e.theme),typeof e.autoDetectHighContrast<"u"&&this._standaloneThemeService.setAutoDetectHighContrast(!!e.autoDetectHighContrast),super.updateOptions(e)}_createInnerEditor(e,t,i){return e.createInstance(LP,t,i)}getOriginalEditor(){return super.getOriginalEditor()}getModifiedEditor(){return super.getModifiedEditor()}addCommand(e,t,i){return this.getModifiedEditor().addCommand(e,t,i)}createContextKey(e,t){return this.getModifiedEditor().createContextKey(e,t)}addAction(e){return this.getModifiedEditor().addAction(e)}};cz=ZG([Ui(2,Xe),Ui(3,ct),Ui(4,ni),Ui(5,Wl),Ui(6,jn),Ui(7,At),Ui(8,Ba),Ui(9,m_),Ui(10,Wg),Ui(11,v_)],cz);function bme(s,e,t,i,n){if(t=t||"",!i){const r=t.indexOf(`
`);let o=t;return r!==-1&&(o=t.substring(0,r)),mre(s,t,e.createByFilepathOrFirstLine(n||null,o),n)}return mre(s,t,e.createById(i),n)}function mre(s,e,t,i){return s.createModel(e,t,i)}var Jje=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},_re=function(s,e){return function(t,i){e(t,i,s)}};class e$e{constructor(e,t){this.viewModel=e,this.deltaScrollVertical=t}getId(){return this.viewModel}}let kP=class extends te{constructor(e,t,i,n,r){super(),this._container=e,this._overflowWidgetsDomNode=t,this._workbenchUIElementFactory=i,this._instantiationService=n,this._viewModel=Rt(this,void 0),this._collapsed=qe(this,l=>{var c;return(c=this._viewModel.read(l))==null?void 0:c.collapsed.read(l)}),this._editorContentHeight=Rt(this,500),this.contentHeight=qe(this,l=>(this._collapsed.read(l)?0:this._editorContentHeight.read(l))+this._outerEditorHeight),this._modifiedContentWidth=Rt(this,0),this._modifiedWidth=Rt(this,0),this._originalContentWidth=Rt(this,0),this._originalWidth=Rt(this,0),this.maxScroll=qe(this,l=>{const c=this._modifiedContentWidth.read(l)-this._modifiedWidth.read(l),d=this._originalContentWidth.read(l)-this._originalWidth.read(l);return c>d?{maxScroll:c,width:this._modifiedWidth.read(l)}:{maxScroll:d,width:this._originalWidth.read(l)}}),this._elements=Vt("div.multiDiffEntry",[Vt("div.header@header",[Vt("div.header-content",[Vt("div.collapse-button@collapseButton"),Vt("div.file-path",[Vt("div.title.modified.show-file-icons@primaryPath",[]),Vt("div.status.deleted@status",["R"]),Vt("div.title.original.show-file-icons@secondaryPath",[])]),Vt("div.actions@actions")])]),Vt("div.editorParent",[Vt("div.editorContainer@editor")])]),this.editor=this._register(this._instantiationService.createInstance(Eg,this._elements.editor,{overflowWidgetsDomNode:this._overflowWidgetsDomNode},{})),this.isModifedFocused=Ea(this.editor.getModifiedEditor()).isFocused,this.isOriginalFocused=Ea(this.editor.getOriginalEditor()).isFocused,this.isFocused=qe(this,l=>this.isModifedFocused.read(l)||this.isOriginalFocused.read(l)),this._resourceLabel=this._workbenchUIElementFactory.createResourceLabel?this._register(this._workbenchUIElementFactory.createResourceLabel(this._elements.primaryPath)):void 0,this._resourceLabel2=this._workbenchUIElementFactory.createResourceLabel?this._register(this._workbenchUIElementFactory.createResourceLabel(this._elements.secondaryPath)):void 0,this._dataStore=this._register(new ce),this._headerHeight=40,this._lastScrollTop=-1,this._isSettingScrollTop=!1;const o=new FA(this._elements.collapseButton,{});this._register(ht(l=>{o.element.className="",o.icon=this._collapsed.read(l)?xe.chevronRight:xe.chevronDown})),this._register(o.onDidClick(()=>{var l;(l=this._viewModel.get())==null||l.collapsed.set(!this._collapsed.get(),void 0)})),this._register(ht(l=>{this._elements.editor.style.display=this._collapsed.read(l)?"none":"block"})),this._register(this.editor.getModifiedEditor().onDidLayoutChange(l=>{const c=this.editor.getModifiedEditor().getLayoutInfo().contentWidth;this._modifiedWidth.set(c,void 0)})),this._register(this.editor.getOriginalEditor().onDidLayoutChange(l=>{const c=this.editor.getOriginalEditor().getLayoutInfo().contentWidth;this._originalWidth.set(c,void 0)})),this._register(this.editor.onDidContentSizeChange(l=>{nL(c=>{this._editorContentHeight.set(l.contentHeight,c),this._modifiedContentWidth.set(this.editor.getModifiedEditor().getContentWidth(),c),this._originalContentWidth.set(this.editor.getOriginalEditor().getContentWidth(),c)})})),this._register(this.editor.getOriginalEditor().onDidScrollChange(l=>{if(this._isSettingScrollTop||!l.scrollTopChanged||!this._data)return;const c=l.scrollTop-this._lastScrollTop;this._data.deltaScrollVertical(c)})),this._register(ht(l=>{var d;const c=(d=this._viewModel.read(l))==null?void 0:d.isActive.read(l);this._elements.root.classList.toggle("active",c)})),this._container.appendChild(this._elements.root),this._outerEditorHeight=this._headerHeight,this._contextKeyService=this._register(r.createScoped(this._elements.actions));const a=this._register(this._instantiationService.createChild(new xS([ct,this._contextKeyService])));this._register(a.createInstance(yP,this._elements.actions,ze.MultiDiffEditorFileToolbar,{actionRunner:this._register(new pme(()=>{var l;return(l=this._viewModel.get())==null?void 0:l.modifiedUri})),menuOptions:{shouldForwardArgs:!0},toolbarOptions:{primaryGroup:l=>l.startsWith("navigation")},actionViewItemProvider:(l,c)=>uge(a,l,c)}))}setScrollLeft(e){this._modifiedContentWidth.get()-this._modifiedWidth.get()>this._originalContentWidth.get()-this._originalWidth.get()?this.editor.getModifiedEditor().setScrollLeft(e):this.editor.getOriginalEditor().setScrollLeft(e)}setData(e){this._data=e;function t(n){return{...n,scrollBeyondLastLine:!1,hideUnchangedRegions:{enabled:!0},scrollbar:{vertical:"hidden",horizontal:"hidden",handleMouseWheel:!1,useShadows:!1},renderOverviewRuler:!1,fixedOverflowWidgets:!0,overviewRulerBorder:!1}}if(!e){nL(n=>{this._viewModel.set(void 0,n),this.editor.setDiffModel(null,n),this._dataStore.clear()});return}const i=e.viewModel.documentDiffItem;if(nL(n=>{var c,d;(c=this._resourceLabel)==null||c.setUri(e.viewModel.modifiedUri??e.viewModel.originalUri,{strikethrough:e.viewModel.modifiedUri===void 0});let r=!1,o=!1,a=!1,l="";e.viewModel.modifiedUri&&e.viewModel.originalUri&&e.viewModel.modifiedUri.path!==e.viewModel.originalUri.path?(l="R",r=!0):e.viewModel.modifiedUri?e.viewModel.originalUri||(l="A",a=!0):(l="D",o=!0),this._elements.status.classList.toggle("renamed",r),this._elements.status.classList.toggle("deleted",o),this._elements.status.classList.toggle("added",a),this._elements.status.innerText=l,(d=this._resourceLabel2)==null||d.setUri(r?e.viewModel.originalUri:void 0,{strikethrough:!0}),this._dataStore.clear(),this._viewModel.set(e.viewModel,n),this.editor.setDiffModel(e.viewModel.diffEditorViewModelRef,n),this.editor.updateOptions(t(i.options??{}))}),i.onOptionsDidChange&&this._dataStore.add(i.onOptionsDidChange(()=>{this.editor.updateOptions(t(i.options??{}))})),e.viewModel.isAlive.recomputeInitiallyAndOnChange(this._dataStore,n=>{n||this.setData(void 0)}),e.viewModel.documentDiffItem.contextKeys)for(const[n,r]of Object.entries(e.viewModel.documentDiffItem.contextKeys))this._contextKeyService.createKey(n,r)}render(e,t,i,n){this._elements.root.style.visibility="visible",this._elements.root.style.top=`${e.start}px`,this._elements.root.style.height=`${e.length}px`,this._elements.root.style.width=`${t}px`,this._elements.root.style.position="absolute";const r=e.length-this._headerHeight,o=Math.max(0,Math.min(n.start-e.start,r));this._elements.header.style.transform=`translateY(${o}px)`,nL(a=>{this.editor.layout({width:t-2*8-2*1,height:e.length-this._outerEditorHeight})});try{this._isSettingScrollTop=!0,this._lastScrollTop=i,this.editor.getOriginalEditor().setScrollTop(i)}finally{this._isSettingScrollTop=!1}this._elements.header.classList.toggle("shadow",o>0||i>0),this._elements.header.classList.toggle("collapsed",o===r)}hide(){this._elements.root.style.top="-100000px",this._elements.root.style.visibility="hidden"}};kP=Jje([_re(3,Xe),_re(4,ct)],kP);class t$e{constructor(e){this._create=e,this._unused=new Set,this._used=new Set,this._itemData=new Map}getUnusedObj(e){let t;if(this._unused.size===0)t=this._create(e),this._itemData.set(t,e);else{const i=[...this._unused.values()];t=i.find(n=>this._itemData.get(n).getId()===e.getId())??i[0],this._unused.delete(t),this._itemData.set(t,e),t.setData(e)}return this._used.add(t),{object:t,dispose:()=>{this._used.delete(t),this._unused.size>5?t.dispose():this._unused.add(t)}}}dispose(){for(const e of this._used)e.dispose();for(const e of this._unused)e.dispose();this._used.clear(),this._unused.clear()}}var i$e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},bre=function(s,e){return function(t,i){e(t,i,s)}};let dz=class extends te{constructor(e,t,i,n,r,o){super(),this._element=e,this._dimension=t,this._viewModel=i,this._workbenchUIElementFactory=n,this._parentContextKeyService=r,this._parentInstantiationService=o,this._scrollableElements=Vt("div.scrollContent",[Vt("div@content",{style:{overflow:"hidden"}}),Vt("div.monaco-editor@overflowWidgetsDomNode",{})]),this._scrollable=this._register(new mS({forceIntegerValues:!1,scheduleAtNextAnimationFrame:l=>Fa(nt(this._element),l),smoothScrollDuration:100})),this._scrollableElement=this._register(new DF(this._scrollableElements.root,{vertical:1,horizontal:1,useShadows:!1},this._scrollable)),this._elements=Vt("div.monaco-component.multiDiffEditor",{},[Vt("div",{},[this._scrollableElement.getDomNode()]),Vt("div.placeholder@placeholder",{},[Vt("div",[b("noChangedFiles","No Changed Files")])])]),this._sizeObserver=this._register(new cme(this._element,void 0)),this._objectPool=this._register(new t$e(l=>{const c=this._instantiationService.createInstance(kP,this._scrollableElements.content,this._scrollableElements.overflowWidgetsDomNode,this._workbenchUIElementFactory);return c.setData(l),c})),this.scrollTop=wi(this,this._scrollableElement.onScroll,()=>this._scrollableElement.getScrollPosition().scrollTop),this.scrollLeft=wi(this,this._scrollableElement.onScroll,()=>this._scrollableElement.getScrollPosition().scrollLeft),this._viewItemsInfo=__(this,(l,c)=>{const d=this._viewModel.read(l);if(!d)return{items:[],getItem:p=>{throw new di}};const u=d.items.read(l),h=new Map;return{items:u.map(p=>{var C;const _=c.add(new n$e(p,this._objectPool,this.scrollLeft,y=>{this._scrollableElement.setScrollPosition({scrollTop:this._scrollableElement.getScrollPosition().scrollTop+y})})),v=(C=this._lastDocStates)==null?void 0:C[_.getKey()];return v&&pn(y=>{_.setViewState(v,y)}),h.set(p,_),_}),getItem:p=>h.get(p)}}),this._viewItems=this._viewItemsInfo.map(this,l=>l.items),this._spaceBetweenPx=0,this._totalHeight=this._viewItems.map(this,(l,c)=>l.reduce((d,u)=>d+u.contentHeight.read(c)+this._spaceBetweenPx,0)),this._contextKeyService=this._register(this._parentContextKeyService.createScoped(this._element)),this._instantiationService=this._register(this._parentInstantiationService.createChild(new xS([ct,this._contextKeyService]))),this._lastDocStates={},this._contextKeyService.createKey(z.inMultiDiffEditor.key,!0),this._register(Jo((l,c)=>{const d=this._viewModel.read(l);if(d&&d.contextKeys)for(const[u,h]of Object.entries(d.contextKeys)){const g=this._contextKeyService.createKey(u,void 0);g.set(h),c.add(Ye(()=>g.reset()))}}));const a=this._parentContextKeyService.createKey(z.multiDiffEditorAllCollapsed.key,!1);this._register(ht(l=>{const c=this._viewModel.read(l);if(c){const d=c.items.read(l).every(u=>u.collapsed.read(l));a.set(d)}})),this._register(ht(l=>{const c=this._dimension.read(l);this._sizeObserver.observe(c)})),this._register(ht(l=>{const c=this._viewItems.read(l);this._elements.placeholder.classList.toggle("visible",c.length===0)})),this._scrollableElements.content.style.position="relative",this._register(ht(l=>{const c=this._sizeObserver.height.read(l);this._scrollableElements.root.style.height=`${c}px`;const d=this._totalHeight.read(l);this._scrollableElements.content.style.height=`${d}px`;const u=this._sizeObserver.width.read(l);let h=u;const g=this._viewItems.read(l),p=Zq(g,Co(_=>_.maxScroll.read(l).maxScroll,td));if(p){const _=p.maxScroll.read(l);h=u+_.maxScroll}this._scrollableElement.setScrollDimensions({width:u,height:c,scrollHeight:d,scrollWidth:h})})),e.replaceChildren(this._elements.root),this._register(Ye(()=>{e.replaceChildren()})),this._register(this._register(ht(l=>{nL(c=>{this.render(l)})})))}render(e){const t=this.scrollTop.read(e);let i=0,n=0,r=0;const o=this._sizeObserver.height.read(e),a=Mt.ofStartAndLength(t,o),l=this._sizeObserver.width.read(e);for(const c of this._viewItems.read(e)){const d=c.contentHeight.read(e),u=Math.min(d,o),h=Mt.ofStartAndLength(n,u),g=Mt.ofStartAndLength(r,d);if(g.isBefore(a))i-=d-u,c.hide();else if(g.isAfter(a))c.hide();else{const p=Math.max(0,Math.min(a.start-g.start,d-u));i-=p;const _=Mt.ofStartAndLength(t+i,o);c.render(h,p,l,_)}n+=u+this._spaceBetweenPx,r+=d+this._spaceBetweenPx}this._scrollableElements.content.style.transform=`translateY(${-(t+i)}px)`}};dz=i$e([bre(4,ct),bre(5,Xe)],dz);class n$e extends te{constructor(e,t,i,n){super(),this.viewModel=e,this._objectPool=t,this._scrollLeft=i,this._deltaScrollVertical=n,this._templateRef=this._register(SI(this,void 0)),this.contentHeight=qe(this,r=>{var o,a;return((a=(o=this._templateRef.read(r))==null?void 0:o.object.contentHeight)==null?void 0:a.read(r))??this.viewModel.lastTemplateData.read(r).contentHeight}),this.maxScroll=qe(this,r=>{var o;return((o=this._templateRef.read(r))==null?void 0:o.object.maxScroll.read(r))??{maxScroll:0,scrollWidth:0}}),this.template=qe(this,r=>{var o;return(o=this._templateRef.read(r))==null?void 0:o.object}),this._isHidden=Rt(this,!1),this._isFocused=qe(this,r=>{var o;return((o=this.template.read(r))==null?void 0:o.isFocused.read(r))??!1}),this.viewModel.setIsFocused(this._isFocused,void 0),this._register(ht(r=>{var a;const o=this._scrollLeft.read(r);(a=this._templateRef.read(r))==null||a.object.setScrollLeft(o)})),this._register(ht(r=>{const o=this._templateRef.read(r);!o||!this._isHidden.read(r)||o.object.isFocused.read(r)||this._clear()}))}dispose(){this._clear(),super.dispose()}toString(){var e;return`VirtualViewItem(${(e=this.viewModel.documentDiffItem.modified)==null?void 0:e.uri.toString()})`}getKey(){return this.viewModel.getKey()}setViewState(e,t){var o;this.viewModel.collapsed.set(e.collapsed,t),this._updateTemplateData(t);const i=this.viewModel.lastTemplateData.get(),n=(o=e.selections)==null?void 0:o.map(Ue.liftSelection);this.viewModel.lastTemplateData.set({...i,selections:n},t);const r=this._templateRef.get();r&&n&&r.object.editor.setSelections(n)}_updateTemplateData(e){const t=this._templateRef.get();t&&this.viewModel.lastTemplateData.set({contentHeight:t.object.contentHeight.get(),selections:t.object.editor.getSelections()??void 0},e)}_clear(){const e=this._templateRef.get();e&&pn(t=>{this._updateTemplateData(t),e.object.hide(),this._templateRef.set(void 0,t)})}hide(){this._isHidden.set(!0,void 0)}render(e,t,i,n){this._isHidden.set(!1,void 0);let r=this._templateRef.get();if(!r){r=this._objectPool.getUnusedObj(new e$e(this.viewModel,this._deltaScrollVertical)),this._templateRef.set(r,void 0);const o=this.viewModel.lastTemplateData.get().selections;o&&r.object.editor.setSelections(o)}r.object.render(e,i,t,n)}}j("multiDiffEditor.headerBackground",{dark:"#262626",light:"tab.inactiveBackground",hcDark:"tab.inactiveBackground",hcLight:"tab.inactiveBackground"},b("multiDiffEditor.headerBackground","The background color of the diff editor's header"));j("multiDiffEditor.background",dd,b("multiDiffEditor.background","The background color of the multi file diff editor"));j("multiDiffEditor.border",{dark:"sideBarSectionHeader.border",light:"#cccccc",hcDark:"sideBarSectionHeader.border",hcLight:"#cccccc"},b("multiDiffEditor.border","The border color of the multi file diff editor"));var s$e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},r$e=function(s,e){return function(t,i){e(t,i,s)}};let uz=class extends te{constructor(e,t,i){super(),this._element=e,this._workbenchUIElementFactory=t,this._instantiationService=i,this._dimension=Rt(this,void 0),this._viewModel=Rt(this,void 0),this._widgetImpl=__(this,(n,r)=>(xa(kP,n),r.add(this._instantiationService.createInstance(xa(dz,n),this._element,this._dimension,this._viewModel,this._workbenchUIElementFactory)))),this._register(wS(this._widgetImpl))}};uz=s$e([r$e(2,Xe)],uz);function o$e(s,e,t){return ut.initialize(t||{}).createInstance(lz,s,e)}function a$e(s){return ut.get(ni).onCodeEditorAdd(t=>{s(t)})}function l$e(s){return ut.get(ni).onDiffEditorAdd(t=>{s(t)})}function c$e(){return ut.get(ni).listCodeEditors()}function d$e(){return ut.get(ni).listDiffEditors()}function u$e(s,e,t){return ut.initialize(t||{}).createInstance(cz,s,e)}function h$e(s,e){const t=ut.initialize(e||{});return new uz(s,{},t)}function f$e(s){if(typeof s.id!="string"||typeof s.run!="function")throw new Error("Invalid command descriptor, `id` and `run` are required properties!");return Gt.registerCommand(s.id,s.run)}function g$e(s){if(typeof s.id!="string"||typeof s.label!="string"||typeof s.run!="function")throw new Error("Invalid action descriptor, `id`, `label` and `run` are required properties!");const e=he.deserialize(s.precondition),t=(n,...r)=>fs.runEditorCommand(n,r,e,(o,a,l)=>Promise.resolve(s.run(a,...l))),i=new ce;if(i.add(Gt.registerCommand(s.id,t)),s.contextMenuGroupId){const n={command:{id:s.id,title:s.label},when:e,group:s.contextMenuGroupId,order:s.contextMenuOrder||0};i.add(Os.appendMenuItem(ze.EditorContext,n))}if(Array.isArray(s.keybindings)){const n=ut.get(pi);if(!(n instanceof N1))console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService");else{const r=he.and(e,he.deserialize(s.keybindingContext));i.add(n.addDynamicKeybindings(s.keybindings.map(o=>({keybinding:o,command:s.id,when:r}))))}}return i}function p$e(s){return vme([s])}function vme(s){const e=ut.get(pi);return e instanceof N1?e.addDynamicKeybindings(s.map(t=>({keybinding:t.keybinding,command:t.command,commandArgs:t.commandArgs,when:he.deserialize(t.when)}))):(console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService"),te.None)}function m$e(s,e,t){const i=ut.get(un),n=i.getLanguageIdByMimeType(e)||e;return bme(ut.get(Gi),i,s,n,t)}function _$e(s,e){const t=ut.get(un),i=t.getLanguageIdByMimeType(e)||e||So;s.setLanguage(t.createById(i))}function b$e(s,e,t){s&&ut.get(Gh).changeOne(e,s.uri,t)}function v$e(s){ut.get(Gh).changeAll(s,[])}function w$e(s){return ut.get(Gh).read(s)}function C$e(s){return ut.get(Gh).onMarkerChanged(s)}function y$e(s){return ut.get(Gi).getModel(s)}function S$e(){return ut.get(Gi).getModels()}function x$e(s){return ut.get(Gi).onModelAdded(s)}function L$e(s){return ut.get(Gi).onModelRemoved(s)}function k$e(s){return ut.get(Gi).onModelLanguageChanged(t=>{s({model:t.model,oldLanguage:t.oldLanguageId})})}function I$e(s){return h8e(ut.get(Gi),s)}function E$e(s,e){const t=ut.get(un),i=ut.get(Wl);return vG.colorizeElement(i,t,s,e).then(()=>{i.registerEditorContainer(s)})}function D$e(s,e,t){const i=ut.get(un);return ut.get(Wl).registerEditorContainer(Ri.document.body),vG.colorize(i,s,e,t)}function T$e(s,e,t=4){return ut.get(Wl).registerEditorContainer(Ri.document.body),vG.colorizeModelLine(s,e,t)}function N$e(s){const e=Ln.get(s);return e||{getInitialState:()=>S1,tokenize:(t,i,n)=>EK(s,n)}}function R$e(s,e){Ln.getOrCreate(e);const t=N$e(e),i=Uh(s),n=[];let r=t.getInitialState();for(let o=0,a=i.length;o<a;o++){const l=i[o],c=t.tokenize(l,!0,r);n[o]=c.tokens,r=c.endState}return n}function A$e(s,e){ut.get(Wl).defineTheme(s,e)}function P$e(s){ut.get(Wl).setTheme(s)}function M$e(){ZW.clearAllFontInfos()}function O$e(s,e){return Gt.registerCommand({id:s,handler:e})}function F$e(s){return ut.get(la).registerOpener({async open(t){return typeof t=="string"&&(t=Je.parse(t)),s.open(t)}})}function V$e(s){return ut.get(ni).registerCodeEditorOpenHandler(async(t,i,n)=>{var a;if(!i)return null;const r=(a=t.options)==null?void 0:a.selection;let o;return r&&typeof r.endLineNumber=="number"&&typeof r.endColumn=="number"?o=r:r&&(o={lineNumber:r.startLineNumber,column:r.startColumn}),await s.openCodeEditor(i,t.resource,o)?i:null})}function B$e(){return{create:o$e,getEditors:c$e,getDiffEditors:d$e,onDidCreateEditor:a$e,onDidCreateDiffEditor:l$e,createDiffEditor:u$e,addCommand:f$e,addEditorAction:g$e,addKeybindingRule:p$e,addKeybindingRules:vme,createModel:m$e,setModelLanguage:_$e,setModelMarkers:b$e,getModelMarkers:w$e,removeAllMarkers:v$e,onDidChangeMarkers:C$e,getModels:S$e,getModel:y$e,onDidCreateModel:x$e,onWillDisposeModel:L$e,onDidChangeModelLanguage:k$e,createWebWorker:I$e,colorizeElement:E$e,colorize:D$e,colorizeModelLine:T$e,tokenize:R$e,defineTheme:A$e,setTheme:P$e,remeasureFonts:M$e,registerCommand:O$e,registerLinkOpener:F$e,registerEditorOpener:V$e,AccessibilitySupport:K7,ContentWidgetPositionPreference:J7,CursorChangeReason:eW,DefaultEndOfLine:tW,EditorAutoIndentStrategy:nW,EditorOption:sW,EndOfLinePreference:rW,EndOfLineSequence:oW,MinimapPosition:_W,MinimapSectionHeaderStyle:bW,MouseTargetType:vW,OverlayWidgetPositionPreference:yW,OverviewRulerLane:SW,GlyphMarginLane:aW,RenderLineNumbersType:kW,RenderMinimap:IW,ScrollbarVisibility:DW,ScrollType:EW,TextEditorCursorBlinkingStyle:MW,TextEditorCursorStyle:OW,TrackedRangeStickiness:FW,WrappingIndent:VW,InjectedTextCursorStops:dW,PositionAffinity:LW,ShowLightbulbIconMode:NW,ConfigurationChangedEvent:lue,BareFontInfo:Qb,FontInfo:XW,TextModelResolvedOptions:LR,FindMatch:rI,ApplyUpdateResult:EL,EditorZoom:oc,createMultiFileDiffEditor:h$e,EditorType:cD,EditorOptions:bu}}function W$e(s,e){if(!e||!Array.isArray(e))return!1;for(const t of e)if(!s(t))return!1;return!0}function FN(s,e){return typeof s=="boolean"?s:e}function vre(s,e){return typeof s=="string"?s:e}function H$e(s){const e={};for(const t of s)e[t]=!0;return e}function wre(s,e=!1){e&&(s=s.map(function(i){return i.toLowerCase()}));const t=H$e(s);return e?function(i){return t[i.toLowerCase()]!==void 0&&t.hasOwnProperty(i.toLowerCase())}:function(i){return t[i]!==void 0&&t.hasOwnProperty(i)}}function hz(s,e,t){e=e.replace(/@@/g,"");let i=0,n;do n=!1,e=e.replace(/@(\w+)/g,function(o,a){n=!0;let l="";if(typeof s[a]=="string")l=s[a];else if(s[a]&&s[a]instanceof RegExp)l=s[a].source;else throw s[a]===void 0?Ji(s,"language definition does not contain attribute '"+a+"', used at: "+e):Ji(s,"attribute reference '"+a+"' must be a string, used at: "+e);return xb(l)?"":"(?:"+l+")"}),i++;while(n&&i<5);e=e.replace(/\x01/g,"@");const r=(s.ignoreCase?"i":"")+(s.unicode?"u":"");if(t&&e.match(/\$[sS](\d\d?)/g)){let a=null,l=null;return c=>(l&&a===c||(a=c,l=new RegExp(N8e(s,e,c),r)),l)}return new RegExp(e,r)}function z$e(s,e,t,i){if(i<0)return s;if(i<e.length)return e[i];if(i>=100){i=i-100;const n=t.split(".");if(n.unshift(t),i<n.length)return n[i]}return null}function U$e(s,e,t,i){let n=-1,r=t,o=t.match(/^\$(([sS]?)(\d\d?)|#)(.*)$/);o&&(o[3]&&(n=parseInt(o[3]),o[2]&&(n=n+100)),r=o[4]);let a="~",l=r;!r||r.length===0?(a="!=",l=""):/^\w*$/.test(l)?a="==":(o=r.match(/^(@|!@|~|!~|==|!=)(.*)$/),o&&(a=o[1],l=o[2]));let c;if((a==="~"||a==="!~")&&/^(\w|\|)*$/.test(l)){const d=wre(l.split("|"),s.ignoreCase);c=function(u){return a==="~"?d(u):!d(u)}}else if(a==="@"||a==="!@"){const d=s[l];if(!d)throw Ji(s,"the @ match target '"+l+"' is not defined, in rule: "+e);if(!W$e(function(h){return typeof h=="string"},d))throw Ji(s,"the @ match target '"+l+"' must be an array of strings, in rule: "+e);const u=wre(d,s.ignoreCase);c=function(h){return a==="@"?u(h):!u(h)}}else if(a==="~"||a==="!~")if(l.indexOf("$")<0){const d=hz(s,"^"+l+"$",!1);c=function(u){return a==="~"?d.test(u):!d.test(u)}}else c=function(d,u,h,g){return hz(s,"^"+Pp(s,l,u,h,g)+"$",!1).test(d)};else if(l.indexOf("$")<0){const d=dg(s,l);c=function(u){return a==="=="?u===d:u!==d}}else{const d=dg(s,l);c=function(u,h,g,p,_){const v=Pp(s,d,h,g,p);return a==="=="?u===v:u!==v}}return n===-1?{name:t,value:i,test:function(d,u,h,g){return c(d,d,u,h,g)}}:{name:t,value:i,test:function(d,u,h,g){const p=z$e(d,u,h,n);return c(p||"",d,u,h,g)}}}function fz(s,e,t){if(t){if(typeof t=="string")return t;if(t.token||t.token===""){if(typeof t.token!="string")throw Ji(s,"a 'token' attribute must be of type string, in rule: "+e);{const i={token:t.token};if(t.token.indexOf("$")>=0&&(i.tokenSubst=!0),typeof t.bracket=="string")if(t.bracket==="@open")i.bracket=1;else if(t.bracket==="@close")i.bracket=-1;else throw Ji(s,"a 'bracket' attribute must be either '@open' or '@close', in rule: "+e);if(t.next){if(typeof t.next!="string")throw Ji(s,"the next state must be a string value in rule: "+e);{let n=t.next;if(!/^(@pop|@push|@popall)$/.test(n)&&(n[0]==="@"&&(n=n.substr(1)),n.indexOf("$")<0&&!R8e(s,Pp(s,n,"",[],""))))throw Ji(s,"the next state '"+t.next+"' is not defined in rule: "+e);i.next=n}}return typeof t.goBack=="number"&&(i.goBack=t.goBack),typeof t.switchTo=="string"&&(i.switchTo=t.switchTo),typeof t.log=="string"&&(i.log=t.log),typeof t.nextEmbedded=="string"&&(i.nextEmbedded=t.nextEmbedded,s.usesEmbedded=!0),i}}else if(Array.isArray(t)){const i=[];for(let n=0,r=t.length;n<r;n++)i[n]=fz(s,e,t[n]);return{group:i}}else if(t.cases){const i=[];for(const r in t.cases)if(t.cases.hasOwnProperty(r)){const o=fz(s,e,t.cases[r]);r==="@default"||r==="@"||r===""?i.push({test:void 0,value:o,name:r}):r==="@eos"?i.push({test:function(a,l,c,d){return d},value:o,name:r}):i.push(U$e(s,e,r,o))}const n=s.defaultToken;return{test:function(r,o,a,l){for(const c of i)if(!c.test||c.test(r,o,a,l))return c.value;return n}}}else throw Ji(s,"an action must be a string, an object with a 'token' or 'cases' attribute, or an array of actions; in rule: "+e)}else return{token:""}}class j$e{constructor(e){this.regex=new RegExp(""),this.action={token:""},this.matchOnlyAtLineStart=!1,this.name="",this.name=e}setRegex(e,t){let i;if(typeof t=="string")i=t;else if(t instanceof RegExp)i=t.source;else throw Ji(e,"rules must start with a match string or regular expression: "+this.name);this.matchOnlyAtLineStart=i.length>0&&i[0]==="^",this.name=this.name+": "+i,this.regex=hz(e,"^(?:"+(this.matchOnlyAtLineStart?i.substr(1):i)+")",!0)}setAction(e,t){this.action=fz(e,this.name,t)}resolveRegex(e){return this.regex instanceof RegExp?this.regex:this.regex(e)}}function wme(s,e){if(!e||typeof e!="object")throw new Error("Monarch: expecting a language definition object");const t={languageId:s,includeLF:FN(e.includeLF,!1),noThrow:!1,maxStack:100,start:typeof e.start=="string"?e.start:null,ignoreCase:FN(e.ignoreCase,!1),unicode:FN(e.unicode,!1),tokenPostfix:vre(e.tokenPostfix,"."+s),defaultToken:vre(e.defaultToken,"source"),usesEmbedded:!1,stateNames:{},tokenizer:{},brackets:[]},i=e;i.languageId=s,i.includeLF=t.includeLF,i.ignoreCase=t.ignoreCase,i.unicode=t.unicode,i.noThrow=t.noThrow,i.usesEmbedded=t.usesEmbedded,i.stateNames=e.tokenizer,i.defaultToken=t.defaultToken;function n(o,a,l){for(const c of l){let d=c.include;if(d){if(typeof d!="string")throw Ji(t,"an 'include' attribute must be a string at: "+o);if(d[0]==="@"&&(d=d.substr(1)),!e.tokenizer[d])throw Ji(t,"include target '"+d+"' is not defined at: "+o);n(o+"."+d,a,e.tokenizer[d])}else{const u=new j$e(o);if(Array.isArray(c)&&c.length>=1&&c.length<=3)if(u.setRegex(i,c[0]),c.length>=3)if(typeof c[1]=="string")u.setAction(i,{token:c[1],next:c[2]});else if(typeof c[1]=="object"){const h=c[1];h.next=c[2],u.setAction(i,h)}else throw Ji(t,"a next state as the last element of a rule can only be given if the action is either an object or a string, at: "+o);else u.setAction(i,c[1]);else{if(!c.regex)throw Ji(t,"a rule must either be an array, or an object with a 'regex' or 'include' field at: "+o);c.name&&typeof c.name=="string"&&(u.name=c.name),c.matchOnlyAtStart&&(u.matchOnlyAtLineStart=FN(c.matchOnlyAtLineStart,!1)),u.setRegex(i,c.regex),u.setAction(i,c.action)}a.push(u)}}}if(!e.tokenizer||typeof e.tokenizer!="object")throw Ji(t,"a language definition must define the 'tokenizer' attribute as an object");t.tokenizer=[];for(const o in e.tokenizer)if(e.tokenizer.hasOwnProperty(o)){t.start||(t.start=o);const a=e.tokenizer[o];t.tokenizer[o]=new Array,n("tokenizer."+o,t.tokenizer[o],a)}if(t.usesEmbedded=i.usesEmbedded,e.brackets){if(!Array.isArray(e.brackets))throw Ji(t,"the 'brackets' attribute must be defined as an array")}else e.brackets=[{open:"{",close:"}",token:"delimiter.curly"},{open:"[",close:"]",token:"delimiter.square"},{open:"(",close:")",token:"delimiter.parenthesis"},{open:"<",close:">",token:"delimiter.angle"}];const r=[];for(const o of e.brackets){let a=o;if(a&&Array.isArray(a)&&a.length===3&&(a={token:a[2],open:a[0],close:a[1]}),a.open===a.close)throw Ji(t,"open and close brackets in a 'brackets' attribute must be different: "+a.open+`
 hint: use the 'bracket' attribute if matching on equal brackets is required.`);if(typeof a.open=="string"&&typeof a.token=="string"&&typeof a.close=="string")r.push({token:a.token+t.tokenPostfix,open:dg(t,a.open),close:dg(t,a.close)});else throw Ji(t,"every element in the 'brackets' array must be a '{open,close,token}' object or array")}return t.brackets=r,t.noThrow=!0,t}function $$e(s){g1.registerLanguage(s)}function q$e(){let s=[];return s=s.concat(g1.getLanguages()),s}function K$e(s){return ut.get(un).languageIdCodec.encodeLanguageId(s)}function G$e(s,e){return ut.withServices(()=>{const i=ut.get(un).onDidRequestRichLanguageFeatures(n=>{n===s&&(i.dispose(),e())});return i})}function Q$e(s,e){return ut.withServices(()=>{const i=ut.get(un).onDidRequestBasicLanguageFeatures(n=>{n===s&&(i.dispose(),e())});return i})}function Y$e(s,e){if(!ut.get(un).isRegisteredLanguageId(s))throw new Error(`Cannot set configuration for unknown language ${s}`);return ut.get(bn).register(s,e,100)}class X$e{constructor(e,t){this._languageId=e,this._actual=t}dispose(){}getInitialState(){return this._actual.getInitialState()}tokenize(e,t,i){if(typeof this._actual.tokenize=="function")return YI.adaptTokenize(this._languageId,this._actual,e,i);throw new Error("Not supported!")}tokenizeEncoded(e,t,i){const n=this._actual.tokenizeEncoded(e,i);return new X4(n.tokens,n.endState)}}class YI{constructor(e,t,i,n){this._languageId=e,this._actual=t,this._languageService=i,this._standaloneThemeService=n}dispose(){}getInitialState(){return this._actual.getInitialState()}static _toClassicTokens(e,t){const i=[];let n=0;for(let r=0,o=e.length;r<o;r++){const a=e[r];let l=a.startIndex;r===0?l=0:l<n&&(l=n),i[r]=new Yk(l,a.scopes,t),n=l}return i}static adaptTokenize(e,t,i,n){const r=t.tokenize(i,n),o=YI._toClassicTokens(r.tokens,e);let a;return r.endState.equals(n)?a=n:a=r.endState,new Iq(o,a)}tokenize(e,t,i){return YI.adaptTokenize(this._languageId,this._actual,e,i)}_toBinaryTokens(e,t){const i=e.encodeLanguageId(this._languageId),n=this._standaloneThemeService.getColorTheme().tokenTheme,r=[];let o=0,a=0;for(let c=0,d=t.length;c<d;c++){const u=t[c],h=n.match(i,u.scopes)|1024;if(o>0&&r[o-1]===h)continue;let g=u.startIndex;c===0?g=0:g<a&&(g=a),r[o++]=g,r[o++]=h,a=g}const l=new Uint32Array(o);for(let c=0;c<o;c++)l[c]=r[c];return l}tokenizeEncoded(e,t,i){const n=this._actual.tokenize(e,i),r=this._toBinaryTokens(this._languageService.languageIdCodec,n.tokens);let o;return n.endState.equals(i)?o=i:o=n.endState,new X4(r,o)}}function Z$e(s){return typeof s.getInitialState=="function"}function J$e(s){return"tokenizeEncoded"in s}function Cme(s){return s&&typeof s.then=="function"}function eqe(s){const e=ut.get(Wl);if(s){const t=[null];for(let i=1,n=s.length;i<n;i++)t[i]=fe.fromHex(s[i]);e.setColorMapOverride(t)}else e.setColorMapOverride(null)}function yme(s,e){return J$e(e)?new X$e(s,e):new YI(s,e,ut.get(un),ut.get(Wl))}function JG(s,e){const t=new NRe(async()=>{const i=await Promise.resolve(e.create());return i?Z$e(i)?yme(s,i):new VI(ut.get(un),ut.get(Wl),s,wme(s,i),ut.get(At)):null});return Ln.registerFactory(s,t)}function tqe(s,e){if(!ut.get(un).isRegisteredLanguageId(s))throw new Error(`Cannot set tokens provider for unknown language ${s}`);return Cme(e)?JG(s,{create:()=>e}):Ln.register(s,yme(s,e))}function iqe(s,e){const t=i=>new VI(ut.get(un),ut.get(Wl),s,wme(s,i),ut.get(At));return Cme(e)?JG(s,{create:()=>e}):Ln.register(s,t(e))}function nqe(s,e){return ut.get(Be).referenceProvider.register(s,e)}function sqe(s,e){return ut.get(Be).renameProvider.register(s,e)}function rqe(s,e){return ut.get(Be).newSymbolNamesProvider.register(s,e)}function oqe(s,e){return ut.get(Be).signatureHelpProvider.register(s,e)}function aqe(s,e){return ut.get(Be).hoverProvider.register(s,{provideHover:async(i,n,r,o)=>{const a=i.getWordAtPosition(n);return Promise.resolve(e.provideHover(i,n,r,o)).then(l=>{if(l)return!l.range&&a&&(l.range=new F(n.lineNumber,a.startColumn,n.lineNumber,a.endColumn)),l.range||(l.range=new F(n.lineNumber,n.column,n.lineNumber,n.column)),l})}})}function lqe(s,e){return ut.get(Be).documentSymbolProvider.register(s,e)}function cqe(s,e){return ut.get(Be).documentHighlightProvider.register(s,e)}function dqe(s,e){return ut.get(Be).linkedEditingRangeProvider.register(s,e)}function uqe(s,e){return ut.get(Be).definitionProvider.register(s,e)}function hqe(s,e){return ut.get(Be).implementationProvider.register(s,e)}function fqe(s,e){return ut.get(Be).typeDefinitionProvider.register(s,e)}function gqe(s,e){return ut.get(Be).codeLensProvider.register(s,e)}function pqe(s,e,t){return ut.get(Be).codeActionProvider.register(s,{providedCodeActionKinds:t==null?void 0:t.providedCodeActionKinds,documentation:t==null?void 0:t.documentation,provideCodeActions:(n,r,o,a)=>{const c=ut.get(Gh).read({resource:n.uri}).filter(d=>F.areIntersectingOrTouching(d,r));return e.provideCodeActions(n,r,{markers:c,only:o.only,trigger:o.trigger},a)},resolveCodeAction:e.resolveCodeAction})}function mqe(s,e){return ut.get(Be).documentFormattingEditProvider.register(s,e)}function _qe(s,e){return ut.get(Be).documentRangeFormattingEditProvider.register(s,e)}function bqe(s,e){return ut.get(Be).onTypeFormattingEditProvider.register(s,e)}function vqe(s,e){return ut.get(Be).linkProvider.register(s,e)}function wqe(s,e){return ut.get(Be).completionProvider.register(s,e)}function Cqe(s,e){return ut.get(Be).colorProvider.register(s,e)}function yqe(s,e){return ut.get(Be).foldingRangeProvider.register(s,e)}function Sqe(s,e){return ut.get(Be).declarationProvider.register(s,e)}function xqe(s,e){return ut.get(Be).selectionRangeProvider.register(s,e)}function Lqe(s,e){return ut.get(Be).documentSemanticTokensProvider.register(s,e)}function kqe(s,e){return ut.get(Be).documentRangeSemanticTokensProvider.register(s,e)}function Iqe(s,e){return ut.get(Be).inlineCompletionsProvider.register(s,e)}function Eqe(s,e){return ut.get(Be).inlineEditProvider.register(s,e)}function Dqe(s,e){return ut.get(Be).inlayHintsProvider.register(s,e)}function Tqe(){return{register:$$e,getLanguages:q$e,onLanguage:G$e,onLanguageEncountered:Q$e,getEncodedLanguageId:K$e,setLanguageConfiguration:Y$e,setColorMap:eqe,registerTokensProviderFactory:JG,setTokensProvider:tqe,setMonarchTokensProvider:iqe,registerReferenceProvider:nqe,registerRenameProvider:sqe,registerNewSymbolNameProvider:rqe,registerCompletionItemProvider:wqe,registerSignatureHelpProvider:oqe,registerHoverProvider:aqe,registerDocumentSymbolProvider:lqe,registerDocumentHighlightProvider:cqe,registerLinkedEditingRangeProvider:dqe,registerDefinitionProvider:uqe,registerImplementationProvider:hqe,registerTypeDefinitionProvider:fqe,registerCodeLensProvider:gqe,registerCodeActionProvider:pqe,registerDocumentFormattingEditProvider:mqe,registerDocumentRangeFormattingEditProvider:_qe,registerOnTypeFormattingEditProvider:bqe,registerLinkProvider:vqe,registerColorProvider:Cqe,registerFoldingRangeProvider:yqe,registerDeclarationProvider:Sqe,registerSelectionRangeProvider:xqe,registerDocumentSemanticTokensProvider:Lqe,registerDocumentRangeSemanticTokensProvider:kqe,registerInlineCompletionsProvider:Iqe,registerInlineEditProvider:Eqe,registerInlayHintsProvider:Dqe,DocumentHighlightKind:iW,CompletionItemKind:Y7,CompletionItemTag:X7,CompletionItemInsertTextRule:Q7,SymbolKind:AW,SymbolTag:PW,IndentAction:cW,CompletionTriggerKind:Z7,SignatureHelpTriggerKind:RW,InlayHintKind:uW,InlineCompletionTriggerKind:hW,InlineEditTriggerKind:fW,CodeActionTriggerType:G7,NewSymbolNameTag:wW,NewSymbolNameTriggerKind:CW,PartialAcceptTriggerKind:xW,HoverVerbosityAction:lW,FoldingRangeKind:Hm,SelectedSuggestionInfo:xue}}const eQ=Ht("IEditorCancelService"),Sme=new Oe("cancellableOperation",!1,b("cancellableOperation","Whether the editor runs a cancellable operation, e.g. like 'Peek References'"));qt(eQ,class{constructor(){this._tokens=new WeakMap}add(s,e){let t=this._tokens.get(s);t||(t=s.invokeWithinContext(n=>{const r=Sme.bindTo(n.get(ct)),o=new _o;return{key:r,tokens:o}}),this._tokens.set(s,t));let i;return t.key.set(!0),i=t.tokens.push(e),()=>{i&&(i(),t.key.set(!t.tokens.isEmpty()),i=void 0)}}cancel(s){const e=this._tokens.get(s);if(!e)return;const t=e.tokens.pop();t&&(t.cancel(),e.key.set(!e.tokens.isEmpty()))}},1);class Nqe extends mn{constructor(e,t){super(t),this.editor=e,this._unregister=e.invokeWithinContext(i=>i.get(eQ).add(e,this))}dispose(){this._unregister(),super.dispose()}}Me(new class extends fs{constructor(){super({id:"editor.cancelOperation",kbOpts:{weight:100,primary:9},precondition:Sme})}runEditorCommand(s,e){s.get(eQ).cancel(e)}});let xme=class gz{constructor(e,t){if(this.flags=t,(this.flags&1)!==0){const i=e.getModel();this.modelVersionId=i?lw("{0}#{1}",i.uri.toString(),i.getVersionId()):null}else this.modelVersionId=null;(this.flags&4)!==0?this.position=e.getPosition():this.position=null,(this.flags&2)!==0?this.selection=e.getSelection():this.selection=null,(this.flags&8)!==0?(this.scrollLeft=e.getScrollLeft(),this.scrollTop=e.getScrollTop()):(this.scrollLeft=-1,this.scrollTop=-1)}_equals(e){if(!(e instanceof gz))return!1;const t=e;return!(this.modelVersionId!==t.modelVersionId||this.scrollLeft!==t.scrollLeft||this.scrollTop!==t.scrollTop||!this.position&&t.position||this.position&&!t.position||this.position&&t.position&&!this.position.equals(t.position)||!this.selection&&t.selection||this.selection&&!t.selection||this.selection&&t.selection&&!this.selection.equalsRange(t.selection))}validate(e){return this._equals(new gz(e,this.flags))}};class t_ extends Nqe{constructor(e,t,i,n){super(e,n),this._listener=new ce,t&4&&this._listener.add(e.onDidChangeCursorPosition(r=>{(!i||!F.containsPosition(i,r.position))&&this.cancel()})),t&2&&this._listener.add(e.onDidChangeCursorSelection(r=>{(!i||!F.containsRange(i,r.selection))&&this.cancel()})),t&8&&this._listener.add(e.onDidScrollChange(r=>this.cancel())),t&1&&(this._listener.add(e.onDidChangeModel(r=>this.cancel())),this._listener.add(e.onDidChangeModelContent(r=>this.cancel())))}dispose(){this._listener.dispose(),super.dispose()}}class tQ extends mn{constructor(e,t){super(t),this._listener=e.onDidChangeContent(()=>this.cancel())}dispose(){this._listener.dispose(),super.dispose()}}function Wh(s){return s&&typeof s.getEditorType=="function"?s.getEditorType()===cD.ICodeEditor:!1}function iQ(s){return s&&typeof s.getEditorType=="function"?s.getEditorType()===cD.IDiffEditor:!1}function Rqe(s){return!!s&&typeof s=="object"&&typeof s.onDidChangeActiveEditor=="function"}function Lme(s){return Wh(s)?s:iQ(s)?s.getModifiedEditor():Rqe(s)&&Wh(s.activeCodeEditor)?s.activeCodeEditor:null}class M1{static _handleEolEdits(e,t){let i;const n=[];for(const r of t)typeof r.eol=="number"&&(i=r.eol),r.range&&typeof r.text=="string"&&n.push(r);return typeof i=="number"&&e.hasModel()&&e.getModel().pushEOL(i),n}static _isFullModelReplaceEdit(e,t){if(!e.hasModel())return!1;const i=e.getModel(),n=i.validateRange(t.range);return i.getFullModelRange().equalsRange(n)}static execute(e,t,i){i&&e.pushUndoStop();const n=_u.capture(e),r=M1._handleEolEdits(e,t);r.length===1&&M1._isFullModelReplaceEdit(e,r[0])?e.executeEdits("formatEditsCommand",r.map(o=>gn.replace(F.lift(o.range),o.text))):e.executeEdits("formatEditsCommand",r.map(o=>gn.replaceMove(F.lift(o.range),o.text))),i&&e.pushUndoStop(),n.restoreRelativeVerticalPositionOfCursor(e)}}class Cre{constructor(e){this.value=e,this._lower=e.toLowerCase()}static toKey(e){return typeof e=="string"?e.toLowerCase():e._lower}}class Aqe{constructor(e){if(this._set=new Set,e)for(const t of e)this.add(t)}add(e){this._set.add(Cre.toKey(e))}has(e){return this._set.has(Cre.toKey(e))}}function kme(s,e,t){const i=[],n=new Aqe,r=s.ordered(t);for(const a of r)i.push(a),a.extensionId&&n.add(a.extensionId);const o=e.ordered(t);for(const a of o){if(a.extensionId){if(n.has(a.extensionId))continue;n.add(a.extensionId)}i.push({displayName:a.displayName,extensionId:a.extensionId,provideDocumentFormattingEdits(l,c,d){return a.provideDocumentRangeFormattingEdits(l,l.getFullModelRange(),c,d)}})}return i}const Ek=class Ek{static setFormatterSelector(e){return{dispose:Ek._selectors.unshift(e)}}static async select(e,t,i,n){if(e.length===0)return;const r=Kt.first(Ek._selectors);if(r)return await r(e,t,i,n)}};Ek._selectors=new _o;let XI=Ek;async function Ime(s,e,t,i,n,r,o){const a=s.get(Xe),{documentRangeFormattingEditProvider:l}=s.get(Be),c=Wh(e)?e.getModel():e,d=l.ordered(c),u=await XI.select(d,c,i,2);u&&(n.report(u),await a.invokeFunction(Pqe,u,e,t,r,o))}async function Pqe(s,e,t,i,n,r){var C,y;const o=s.get(ca),a=s.get(pr),l=s.get(v_);let c,d;Wh(t)?(c=t.getModel(),d=new t_(t,5,void 0,n)):(c=t,d=new tQ(t,n));const u=[];let h=0;for(const x of mq(i).sort(F.compareRangesUsingStarts))h>0&&F.areIntersectingOrTouching(u[h-1],x)?u[h-1]=F.fromPositions(u[h-1].getStartPosition(),x.getEndPosition()):h=u.push(x);const g=async x=>{var I,A;a.trace("[format][provideDocumentRangeFormattingEdits] (request)",(I=e.extensionId)==null?void 0:I.value,x);const L=await e.provideDocumentRangeFormattingEdits(c,x,c.getFormattingOptions(),d.token)||[];return a.trace("[format][provideDocumentRangeFormattingEdits] (response)",(A=e.extensionId)==null?void 0:A.value,L),L},p=(x,L)=>{if(!x.length||!L.length)return!1;const I=x.reduce((A,D)=>F.plusRange(A,D.range),x[0].range);if(!L.some(A=>F.intersectRanges(I,A.range)))return!1;for(const A of x)for(const D of L)if(F.intersectRanges(A.range,D.range))return!0;return!1},_=[],v=[];try{if(typeof e.provideDocumentRangesFormattingEdits=="function"){a.trace("[format][provideDocumentRangeFormattingEdits] (request)",(C=e.extensionId)==null?void 0:C.value,u);const x=await e.provideDocumentRangesFormattingEdits(c,u,c.getFormattingOptions(),d.token)||[];a.trace("[format][provideDocumentRangeFormattingEdits] (response)",(y=e.extensionId)==null?void 0:y.value,x),v.push(x)}else{for(const x of u){if(d.token.isCancellationRequested)return!0;v.push(await g(x))}for(let x=0;x<u.length;++x)for(let L=x+1;L<u.length;++L){if(d.token.isCancellationRequested)return!0;if(p(v[x],v[L])){const I=F.plusRange(u[x],u[L]),A=await g(I);u.splice(L,1),u.splice(x,1),u.push(I),v.splice(L,1),v.splice(x,1),v.push(A),x=0,L=0}}}for(const x of v){if(d.token.isCancellationRequested)return!0;const L=await o.computeMoreMinimalEdits(c.uri,x);L&&_.push(...L)}}finally{d.dispose()}if(_.length===0)return!1;if(Wh(t))M1.execute(t,_,!0),t.revealPositionInCenterIfOutsideViewport(t.getPosition(),1);else{const[{range:x}]=_,L=new Ue(x.startLineNumber,x.startColumn,x.endLineNumber,x.endColumn);c.pushEditOperations([L],_.map(I=>({text:I.text,range:F.lift(I.range),forceMoveMarkers:!0})),I=>{for(const{range:A}of I)if(F.areIntersectingOrTouching(A,L))return[new Ue(A.startLineNumber,A.startColumn,A.endLineNumber,A.endColumn)];return null})}return l.playSignal(fl.format,{userGesture:r}),!0}async function Mqe(s,e,t,i,n,r){const o=s.get(Xe),a=s.get(Be),l=Wh(e)?e.getModel():e,c=kme(a.documentFormattingEditProvider,a.documentRangeFormattingEditProvider,l),d=await XI.select(c,l,t,1);d&&(i.report(d),await o.invokeFunction(Oqe,d,e,t,n,r))}async function Oqe(s,e,t,i,n,r){const o=s.get(ca),a=s.get(v_);let l,c;Wh(t)?(l=t.getModel(),c=new t_(t,5,void 0,n)):(l=t,c=new tQ(t,n));let d;try{const u=await e.provideDocumentFormattingEdits(l,l.getFormattingOptions(),c.token);if(d=await o.computeMoreMinimalEdits(l.uri,u),c.token.isCancellationRequested)return!0}finally{c.dispose()}if(!d||d.length===0)return!1;if(Wh(t))M1.execute(t,d,i!==2),i!==2&&t.revealPositionInCenterIfOutsideViewport(t.getPosition(),1);else{const[{range:u}]=d,h=new Ue(u.startLineNumber,u.startColumn,u.endLineNumber,u.endColumn);l.pushEditOperations([h],d.map(g=>({text:g.text,range:F.lift(g.range),forceMoveMarkers:!0})),g=>{for(const{range:p}of g)if(F.areIntersectingOrTouching(p,h))return[new Ue(p.startLineNumber,p.startColumn,p.endLineNumber,p.endColumn)];return null})}return a.playSignal(fl.format,{userGesture:r}),!0}async function Fqe(s,e,t,i,n,r){const o=e.documentRangeFormattingEditProvider.ordered(t);for(const a of o){const l=await Promise.resolve(a.provideDocumentRangeFormattingEdits(t,i,n,r)).catch(Mn);if(Xr(l))return await s.computeMoreMinimalEdits(t.uri,l)}}async function Vqe(s,e,t,i,n){const r=kme(e.documentFormattingEditProvider,e.documentRangeFormattingEditProvider,t);for(const o of r){const a=await Promise.resolve(o.provideDocumentFormattingEdits(t,i,n)).catch(Mn);if(Xr(a))return await s.computeMoreMinimalEdits(t.uri,a)}}function Eme(s,e,t,i,n,r,o){const a=e.onTypeFormattingEditProvider.ordered(t);return a.length===0||a[0].autoFormatTriggerCharacters.indexOf(n)<0?Promise.resolve(void 0):Promise.resolve(a[0].provideOnTypeFormattingEdits(t,i,n,r,o)).catch(Mn).then(l=>s.computeMoreMinimalEdits(t.uri,l))}Gt.registerCommand("_executeFormatRangeProvider",async function(s,...e){const[t,i,n]=e;ii(Je.isUri(t)),ii(F.isIRange(i));const r=s.get(oa),o=s.get(ca),a=s.get(Be),l=await r.createModelReference(t);try{return Fqe(o,a,l.object.textEditorModel,F.lift(i),n,kt.None)}finally{l.dispose()}});Gt.registerCommand("_executeFormatDocumentProvider",async function(s,...e){const[t,i]=e;ii(Je.isUri(t));const n=s.get(oa),r=s.get(ca),o=s.get(Be),a=await n.createModelReference(t);try{return Vqe(r,o,a.object.textEditorModel,i,kt.None)}finally{a.dispose()}});Gt.registerCommand("_executeFormatOnTypeProvider",async function(s,...e){const[t,i,n,r]=e;ii(Je.isUri(t)),ii(X.isIPosition(i)),ii(typeof n=="string");const o=s.get(oa),a=s.get(ca),l=s.get(Be),c=await o.createModelReference(t);try{return Eme(a,l,c.object.textEditorModel,X.lift(i),n,r,kt.None)}finally{c.dispose()}});bu.wrappingIndent.defaultValue=0;bu.glyphMargin.defaultValue=!1;bu.autoIndent.defaultValue=3;bu.overviewRulerLanes.defaultValue=2;XI.setFormatterSelector((s,e,t)=>Promise.resolve(s[0]));const Ro=Lue();Ro.editor=B$e();Ro.languages=Tqe();const Bqe=Ro.CancellationTokenSource,Wqe=Ro.Emitter,Hqe=Ro.KeyCode,zqe=Ro.KeyMod,Uqe=Ro.Position,Dme=Ro.Range,jqe=Ro.Selection,$qe=Ro.SelectionDirection,qqe=Ro.MarkerSeverity,Kqe=Ro.MarkerTag,Gqe=Ro.Uri,Qqe=Ro.Token,Yqe=Ro.editor,Xqe=Ro.languages,_B=globalThis.MonacoEnvironment;(_B!=null&&_B.globalAPI||typeof define=="function"&&define.amd)&&(globalThis.monaco=Ro);typeof globalThis.require<"u"&&typeof globalThis.require.config=="function"&&globalThis.require.config({ignoreDuplicateModules:["vscode-languageserver-types","vscode-languageserver-types/main","vscode-languageserver-textdocument","vscode-languageserver-textdocument/main","vscode-nls","vscode-nls/vscode-nls","jsonc-parser","jsonc-parser/main","vscode-uri","vscode-uri/index","vs/basic-languages/typescript/typescript"]});const fD=Object.freeze(Object.defineProperty({__proto__:null,CancellationTokenSource:Bqe,Emitter:Wqe,KeyCode:Hqe,KeyMod:zqe,MarkerSeverity:qqe,MarkerTag:Kqe,Position:Uqe,Range:Dme,Selection:jqe,SelectionDirection:$qe,Token:Qqe,Uri:Gqe,editor:Yqe,languages:Xqe},Symbol.toStringTag,{value:"Module"}));/*!-----------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Version: 0.52.2(404545bded1df6ffa41ea0af4e8ddb219018c6c1)
 * Released under the MIT license
 * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt
 *-----------------------------------------------------------------------------*/var Zqe=Object.defineProperty,Jqe=Object.getOwnPropertyDescriptor,eKe=Object.getOwnPropertyNames,tKe=Object.prototype.hasOwnProperty,iKe=(s,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of eKe(e))!tKe.call(s,n)&&n!==t&&Zqe(s,n,{get:()=>e[n],enumerable:!(i=Jqe(e,n))||i.enumerable});return s},nKe=(s,e,t)=>(iKe(s,e,"default"),t),cL={};nKe(cL,fD);var Tme={},bB={},sKe=class Nme{static getOrCreate(e){return bB[e]||(bB[e]=new Nme(e)),bB[e]}constructor(e){this._languageId=e,this._loadingTriggered=!1,this._lazyLoadPromise=new Promise((t,i)=>{this._lazyLoadPromiseResolve=t,this._lazyLoadPromiseReject=i})}load(){return this._loadingTriggered||(this._loadingTriggered=!0,Tme[this._languageId].loader().then(e=>this._lazyLoadPromiseResolve(e),e=>this._lazyLoadPromiseReject(e))),this._lazyLoadPromise}};function st(s){const e=s.id;Tme[e]=s,cL.languages.register(s);const t=sKe.getOrCreate(e);cL.languages.registerTokensProviderFactory(e,{create:async()=>(await t.load()).language}),cL.languages.onLanguageEncountered(e,async()=>{const i=await t.load();cL.languages.setLanguageConfiguration(e,i.conf)})}st({id:"abap",extensions:[".abap"],aliases:["abap","ABAP"],loader:()=>et(()=>import("./abap-BrgZPUOV.js"),[])});st({id:"apex",extensions:[".cls"],aliases:["Apex","apex"],mimetypes:["text/x-apex-source","text/x-apex"],loader:()=>et(()=>import("./apex-DyP6w7ZV.js"),[])});st({id:"azcli",extensions:[".azcli"],aliases:["Azure CLI","azcli"],loader:()=>et(()=>import("./azcli-BaLxmfj-.js"),[])});st({id:"bat",extensions:[".bat",".cmd"],aliases:["Batch","bat"],loader:()=>et(()=>import("./bat-CFOPXBzS.js"),[])});st({id:"bicep",extensions:[".bicep"],aliases:["Bicep"],loader:()=>et(()=>import("./bicep-BfEKNvv3.js"),[])});st({id:"cameligo",extensions:[".mligo"],aliases:["Cameligo"],loader:()=>et(()=>import("./cameligo-BFG1Mk7z.js"),[])});st({id:"clojure",extensions:[".clj",".cljs",".cljc",".edn"],aliases:["clojure","Clojure"],loader:()=>et(()=>import("./clojure-DTECt2xU.js"),[])});st({id:"coffeescript",extensions:[".coffee"],aliases:["CoffeeScript","coffeescript","coffee"],mimetypes:["text/x-coffeescript","text/coffeescript"],loader:()=>et(()=>import("./coffee-CDGzqUPQ.js"),[])});st({id:"c",extensions:[".c",".h"],aliases:["C","c"],loader:()=>et(()=>import("./cpp-CLLBncYj.js"),[])});st({id:"cpp",extensions:[".cpp",".cc",".cxx",".hpp",".hh",".hxx"],aliases:["C++","Cpp","cpp"],loader:()=>et(()=>import("./cpp-CLLBncYj.js"),[])});st({id:"csharp",extensions:[".cs",".csx",".cake"],aliases:["C#","csharp"],loader:()=>et(()=>import("./csharp-dUCx_-0o.js"),[])});st({id:"csp",extensions:[".csp"],aliases:["CSP","csp"],loader:()=>et(()=>import("./csp-5Rap-vPy.js"),[])});st({id:"css",extensions:[".css"],aliases:["CSS","css"],mimetypes:["text/css"],loader:()=>et(()=>import("./css-D3h14YRZ.js"),[])});st({id:"cypher",extensions:[".cypher",".cyp"],aliases:["Cypher","OpenCypher"],loader:()=>et(()=>import("./cypher-DrQuvNYM.js"),[])});st({id:"dart",extensions:[".dart"],aliases:["Dart","dart"],mimetypes:["text/x-dart-source","text/x-dart"],loader:()=>et(()=>import("./dart-CFKIUWau.js"),[])});st({id:"dockerfile",extensions:[".dockerfile"],filenames:["Dockerfile"],aliases:["Dockerfile"],loader:()=>et(()=>import("./dockerfile-Zznr-cwX.js"),[])});st({id:"ecl",extensions:[".ecl"],aliases:["ECL","Ecl","ecl"],loader:()=>et(()=>import("./ecl-Ce3n6wWz.js"),[])});st({id:"elixir",extensions:[".ex",".exs"],aliases:["Elixir","elixir","ex"],loader:()=>et(()=>import("./elixir-deUWdS0T.js"),[])});st({id:"flow9",extensions:[".flow"],aliases:["Flow9","Flow","flow9","flow"],loader:()=>et(()=>import("./flow9-i9-g7ZhI.js"),[])});st({id:"fsharp",extensions:[".fs",".fsi",".ml",".mli",".fsx",".fsscript"],aliases:["F#","FSharp","fsharp"],loader:()=>et(()=>import("./fsharp-CzKuDChf.js"),[])});st({id:"freemarker2",extensions:[".ftl",".ftlh",".ftlx"],aliases:["FreeMarker2","Apache FreeMarker2"],loader:()=>et(()=>import("./freemarker2-dRp6bHWg.js"),[]).then(s=>s.TagAutoInterpolationDollar)});st({id:"freemarker2.tag-angle.interpolation-dollar",aliases:["FreeMarker2 (Angle/Dollar)","Apache FreeMarker2 (Angle/Dollar)"],loader:()=>et(()=>import("./freemarker2-dRp6bHWg.js"),[]).then(s=>s.TagAngleInterpolationDollar)});st({id:"freemarker2.tag-bracket.interpolation-dollar",aliases:["FreeMarker2 (Bracket/Dollar)","Apache FreeMarker2 (Bracket/Dollar)"],loader:()=>et(()=>import("./freemarker2-dRp6bHWg.js"),[]).then(s=>s.TagBracketInterpolationDollar)});st({id:"freemarker2.tag-angle.interpolation-bracket",aliases:["FreeMarker2 (Angle/Bracket)","Apache FreeMarker2 (Angle/Bracket)"],loader:()=>et(()=>import("./freemarker2-dRp6bHWg.js"),[]).then(s=>s.TagAngleInterpolationBracket)});st({id:"freemarker2.tag-bracket.interpolation-bracket",aliases:["FreeMarker2 (Bracket/Bracket)","Apache FreeMarker2 (Bracket/Bracket)"],loader:()=>et(()=>import("./freemarker2-dRp6bHWg.js"),[]).then(s=>s.TagBracketInterpolationBracket)});st({id:"freemarker2.tag-auto.interpolation-dollar",aliases:["FreeMarker2 (Auto/Dollar)","Apache FreeMarker2 (Auto/Dollar)"],loader:()=>et(()=>import("./freemarker2-dRp6bHWg.js"),[]).then(s=>s.TagAutoInterpolationDollar)});st({id:"freemarker2.tag-auto.interpolation-bracket",aliases:["FreeMarker2 (Auto/Bracket)","Apache FreeMarker2 (Auto/Bracket)"],loader:()=>et(()=>import("./freemarker2-dRp6bHWg.js"),[]).then(s=>s.TagAutoInterpolationBracket)});st({id:"go",extensions:[".go"],aliases:["Go"],loader:()=>et(()=>import("./go-Cphgjts3.js"),[])});st({id:"graphql",extensions:[".graphql",".gql"],aliases:["GraphQL","graphql","gql"],mimetypes:["application/graphql"],loader:()=>et(()=>import("./graphql-Cg7bfA9N.js"),[])});st({id:"handlebars",extensions:[".handlebars",".hbs"],aliases:["Handlebars","handlebars","hbs"],mimetypes:["text/x-handlebars-template"],loader:()=>et(()=>import("./handlebars-Do83o1De.js"),[])});st({id:"hcl",extensions:[".tf",".tfvars",".hcl"],aliases:["Terraform","tf","HCL","hcl"],loader:()=>et(()=>import("./hcl-0cvrggvQ.js"),[])});st({id:"html",extensions:[".html",".htm",".shtml",".xhtml",".mdoc",".jsp",".asp",".aspx",".jshtm"],aliases:["HTML","htm","html","xhtml"],mimetypes:["text/html","text/x-jshtm","text/template","text/ng-template"],loader:()=>et(()=>import("./html-BGyILVrE.js"),[])});st({id:"ini",extensions:[".ini",".properties",".gitconfig"],filenames:["config",".gitattributes",".gitconfig",".editorconfig"],aliases:["Ini","ini"],loader:()=>et(()=>import("./ini-Drc7WvVn.js"),[])});st({id:"java",extensions:[".java",".jav"],aliases:["Java","java"],mimetypes:["text/x-java-source","text/x-java"],loader:()=>et(()=>import("./java-B_fMsGYe.js"),[])});st({id:"javascript",extensions:[".js",".es6",".jsx",".mjs",".cjs"],firstLine:"^#!.*\\bnode",filenames:["jakefile"],aliases:["JavaScript","javascript","js"],mimetypes:["text/javascript"],loader:()=>et(()=>import("./javascript-CiXt6nTG.js"),__vite__mapDeps([0,1]))});st({id:"julia",extensions:[".jl"],aliases:["julia","Julia"],loader:()=>et(()=>import("./julia-Bqgm2twL.js"),[])});st({id:"kotlin",extensions:[".kt",".kts"],aliases:["Kotlin","kotlin"],mimetypes:["text/x-kotlin-source","text/x-kotlin"],loader:()=>et(()=>import("./kotlin-BSkB5QuD.js"),[])});st({id:"less",extensions:[".less"],aliases:["Less","less"],mimetypes:["text/x-less","text/less"],loader:()=>et(()=>import("./less-BsTHnhdd.js"),[])});st({id:"lexon",extensions:[".lex"],aliases:["Lexon"],loader:()=>et(()=>import("./lexon-YWi4-JPR.js"),[])});st({id:"lua",extensions:[".lua"],aliases:["Lua","lua"],loader:()=>et(()=>import("./lua-nf6ki56Z.js"),[])});st({id:"liquid",extensions:[".liquid",".html.liquid"],aliases:["Liquid","liquid"],mimetypes:["application/liquid"],loader:()=>et(()=>import("./liquid-B0JNiXVg.js"),[])});st({id:"m3",extensions:[".m3",".i3",".mg",".ig"],aliases:["Modula-3","Modula3","modula3","m3"],loader:()=>et(()=>import("./m3-Cpb6xl2v.js"),[])});st({id:"markdown",extensions:[".md",".markdown",".mdown",".mkdn",".mkd",".mdwn",".mdtxt",".mdtext"],aliases:["Markdown","markdown"],loader:()=>et(()=>import("./markdown-DSZPf7rp.js"),[])});st({id:"mdx",extensions:[".mdx"],aliases:["MDX","mdx"],loader:()=>et(()=>import("./mdx-Bw60F2Pg.js"),[])});st({id:"mips",extensions:[".s"],aliases:["MIPS","MIPS-V"],mimetypes:["text/x-mips","text/mips","text/plaintext"],loader:()=>et(()=>import("./mips-B_c3zf-v.js"),[])});st({id:"msdax",extensions:[".dax",".msdax"],aliases:["DAX","MSDAX"],loader:()=>et(()=>import("./msdax-rUNN04Wq.js"),[])});st({id:"mysql",extensions:[],aliases:["MySQL","mysql"],loader:()=>et(()=>import("./mysql-DDwshQtU.js"),[])});st({id:"objective-c",extensions:[".m"],aliases:["Objective-C"],loader:()=>et(()=>import("./objective-c-B5zXfXm9.js"),[])});st({id:"pascal",extensions:[".pas",".p",".pp"],aliases:["Pascal","pas"],mimetypes:["text/x-pascal-source","text/x-pascal"],loader:()=>et(()=>import("./pascal-CXOwvkN_.js"),[])});st({id:"pascaligo",extensions:[".ligo"],aliases:["Pascaligo","ligo"],loader:()=>et(()=>import("./pascaligo-Bc-ZgV77.js"),[])});st({id:"perl",extensions:[".pl",".pm"],aliases:["Perl","pl"],loader:()=>et(()=>import("./perl-CwNk8-XU.js"),[])});st({id:"pgsql",extensions:[],aliases:["PostgreSQL","postgres","pg","postgre"],loader:()=>et(()=>import("./pgsql-tGk8EFnU.js"),[])});st({id:"php",extensions:[".php",".php4",".php5",".phtml",".ctp"],aliases:["PHP","php"],mimetypes:["application/x-php"],loader:()=>et(()=>import("./php-CpIb_Oan.js"),[])});st({id:"pla",extensions:[".pla"],loader:()=>et(()=>import("./pla-B03wrqEc.js"),[])});st({id:"postiats",extensions:[".dats",".sats",".hats"],aliases:["ATS","ATS/Postiats"],loader:()=>et(()=>import("./postiats-BKlk5iyT.js"),[])});st({id:"powerquery",extensions:[".pq",".pqm"],aliases:["PQ","M","Power Query","Power Query M"],loader:()=>et(()=>import("./powerquery-Bhzvs7bI.js"),[])});st({id:"powershell",extensions:[".ps1",".psm1",".psd1"],aliases:["PowerShell","powershell","ps","ps1"],loader:()=>et(()=>import("./powershell-Dd3NCNK9.js"),[])});st({id:"proto",extensions:[".proto"],aliases:["protobuf","Protocol Buffers"],loader:()=>et(()=>import("./protobuf-COyEY5Pt.js"),[])});st({id:"pug",extensions:[".jade",".pug"],aliases:["Pug","Jade","jade"],loader:()=>et(()=>import("./pug-BaJupSGV.js"),[])});st({id:"python",extensions:[".py",".rpy",".pyw",".cpy",".gyp",".gypi"],aliases:["Python","py"],firstLine:"^#!/.*\\bpython[0-9.-]*\\b",loader:()=>et(()=>import("./python-QrPro_up.js"),[])});st({id:"qsharp",extensions:[".qs"],aliases:["Q#","qsharp"],loader:()=>et(()=>import("./qsharp-DXyYeYxl.js"),[])});st({id:"r",extensions:[".r",".rhistory",".rmd",".rprofile",".rt"],aliases:["R","r"],loader:()=>et(()=>import("./r-CdQndTaG.js"),[])});st({id:"razor",extensions:[".cshtml"],aliases:["Razor","razor"],mimetypes:["text/x-cshtml"],loader:()=>et(()=>import("./razor-Zi3MwsON.js"),[])});st({id:"redis",extensions:[".redis"],aliases:["redis"],loader:()=>et(()=>import("./redis-CVwtpugi.js"),[])});st({id:"redshift",extensions:[],aliases:["Redshift","redshift"],loader:()=>et(()=>import("./redshift-25W9uPmb.js"),[])});st({id:"restructuredtext",extensions:[".rst"],aliases:["reStructuredText","restructuredtext"],loader:()=>et(()=>import("./restructuredtext-DfzH4Xui.js"),[])});st({id:"ruby",extensions:[".rb",".rbx",".rjs",".gemspec",".pp"],filenames:["rakefile","Gemfile"],aliases:["Ruby","rb"],loader:()=>et(()=>import("./ruby-Cp1zYvxS.js"),[])});st({id:"rust",extensions:[".rs",".rlib"],aliases:["Rust","rust"],loader:()=>et(()=>import("./rust-D5C2fndG.js"),[])});st({id:"sb",extensions:[".sb"],aliases:["Small Basic","sb"],loader:()=>et(()=>import("./sb-CDntyWJ8.js"),[])});st({id:"scala",extensions:[".scala",".sc",".sbt"],aliases:["Scala","scala","SBT","Sbt","sbt","Dotty","dotty"],mimetypes:["text/x-scala-source","text/x-scala","text/x-sbt","text/x-dotty"],loader:()=>et(()=>import("./scala-BoFRg7Ot.js"),[])});st({id:"scheme",extensions:[".scm",".ss",".sch",".rkt"],aliases:["scheme","Scheme"],loader:()=>et(()=>import("./scheme-Bio4gycK.js"),[])});st({id:"scss",extensions:[".scss"],aliases:["Sass","sass","scss"],mimetypes:["text/x-scss","text/scss"],loader:()=>et(()=>import("./scss-4Ik7cdeQ.js"),[])});st({id:"shell",extensions:[".sh",".bash"],aliases:["Shell","sh"],loader:()=>et(()=>import("./shell-CX-rkNHf.js"),[])});st({id:"sol",extensions:[".sol"],aliases:["sol","solidity","Solidity"],loader:()=>et(()=>import("./solidity-Tw7wswEv.js"),[])});st({id:"aes",extensions:[".aes"],aliases:["aes","sophia","Sophia"],loader:()=>et(()=>import("./sophia-C5WLch3f.js"),[])});st({id:"sparql",extensions:[".rq"],aliases:["sparql","SPARQL"],loader:()=>et(()=>import("./sparql-DHaeiCBh.js"),[])});st({id:"sql",extensions:[".sql"],aliases:["SQL"],loader:()=>et(()=>import("./sql-CCSDG5nI.js"),[])});st({id:"st",extensions:[".st",".iecst",".iecplc",".lc3lib",".TcPOU",".TcDUT",".TcGVL",".TcIO"],aliases:["StructuredText","scl","stl"],loader:()=>et(()=>import("./st-pnP8ivHi.js"),[])});st({id:"swift",aliases:["Swift","swift"],extensions:[".swift"],mimetypes:["text/swift"],loader:()=>et(()=>import("./swift-DwJ7jVG9.js"),[])});st({id:"systemverilog",extensions:[".sv",".svh"],aliases:["SV","sv","SystemVerilog","systemverilog"],loader:()=>et(()=>import("./systemverilog-B9Xyijhd.js"),[])});st({id:"verilog",extensions:[".v",".vh"],aliases:["V","v","Verilog","verilog"],loader:()=>et(()=>import("./systemverilog-B9Xyijhd.js"),[])});st({id:"tcl",extensions:[".tcl"],aliases:["tcl","Tcl","tcltk","TclTk","tcl/tk","Tcl/Tk"],loader:()=>et(()=>import("./tcl-DnHyzjbg.js"),[])});st({id:"twig",extensions:[".twig"],aliases:["Twig","twig"],mimetypes:["text/x-twig"],loader:()=>et(()=>import("./twig-CPajHgWi.js"),[])});st({id:"typescript",extensions:[".ts",".tsx",".cts",".mts"],aliases:["TypeScript","ts","typescript"],mimetypes:["text/typescript"],loader:()=>et(()=>import("./typescript-Di23Ihxc.js"),[])});st({id:"typespec",extensions:[".tsp"],aliases:["TypeSpec"],loader:()=>et(()=>import("./typespec-D-MeaMDU.js"),[])});st({id:"vb",extensions:[".vb"],aliases:["Visual Basic","vb"],loader:()=>et(()=>import("./vb-DgyLZaXg.js"),[])});st({id:"wgsl",extensions:[".wgsl"],aliases:["WebGPU Shading Language","WGSL","wgsl"],loader:()=>et(()=>import("./wgsl-BIv9DU6q.js"),[])});st({id:"xml",extensions:[".xml",".xsd",".dtd",".ascx",".csproj",".config",".props",".targets",".wxi",".wxl",".wxs",".xaml",".svg",".svgz",".opf",".xslt",".xsl"],firstLine:"(\\<\\?xml.*)|(\\<svg)|(\\<\\!doctype\\s+svg)",aliases:["XML","xml"],mimetypes:["text/xml","application/xml","application/xaml+xml","application/xml-dtd"],loader:()=>et(()=>import("./xml-Bbn4HXVe.js"),[])});st({id:"yaml",extensions:[".yaml",".yml"],aliases:["YAML","yaml","YML","yml"],mimetypes:["application/x-yaml","text/x-yaml"],loader:()=>et(()=>import("./yaml-Cmr8nw87.js"),[])});/*!-----------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Version: 0.52.2(404545bded1df6ffa41ea0af4e8ddb219018c6c1)
 * Released under the MIT license
 * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt
 *-----------------------------------------------------------------------------*/var rKe=Object.defineProperty,oKe=Object.getOwnPropertyDescriptor,aKe=Object.getOwnPropertyNames,lKe=Object.prototype.hasOwnProperty,cKe=(s,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of aKe(e))!lKe.call(s,n)&&n!==t&&rKe(s,n,{get:()=>e[n],enumerable:!(i=oKe(e,n))||i.enumerable});return s},dKe=(s,e,t)=>(cKe(s,e,"default"),t),IS={};dKe(IS,fD);var nQ=class{constructor(e,t,i){this._onDidChange=new IS.Emitter,this._languageId=e,this.setOptions(t),this.setModeConfiguration(i)}get onDidChange(){return this._onDidChange.event}get languageId(){return this._languageId}get modeConfiguration(){return this._modeConfiguration}get diagnosticsOptions(){return this.options}get options(){return this._options}setOptions(e){this._options=e||Object.create(null),this._onDidChange.fire(this)}setDiagnosticsOptions(e){this.setOptions(e)}setModeConfiguration(e){this._modeConfiguration=e||Object.create(null),this._onDidChange.fire(this)}},sQ={validate:!0,lint:{compatibleVendorPrefixes:"ignore",vendorPrefix:"warning",duplicateProperties:"warning",emptyRules:"warning",importStatement:"ignore",boxModel:"ignore",universalSelector:"ignore",zeroUnits:"ignore",fontFaceProperties:"warning",hexColorLength:"error",argumentsInColorFunction:"error",unknownProperties:"warning",ieHack:"ignore",unknownVendorSpecificProperties:"ignore",propertyIgnoredDueToDisplay:"warning",important:"ignore",float:"ignore",idSelector:"ignore"},data:{useDefaultDataProvider:!0},format:{newlineBetweenSelectors:!0,newlineBetweenRules:!0,spaceAroundSelectorSeparator:!1,braceStyle:"collapse",maxPreserveNewLines:void 0,preserveNewLines:!0}},rQ={completionItems:!0,hovers:!0,documentSymbols:!0,definitions:!0,references:!0,documentHighlights:!0,rename:!0,colors:!0,foldingRanges:!0,diagnostics:!0,selectionRanges:!0,documentFormattingEdits:!0,documentRangeFormattingEdits:!0},Rme=new nQ("css",sQ,rQ),Ame=new nQ("scss",sQ,rQ),Pme=new nQ("less",sQ,rQ);IS.languages.css={cssDefaults:Rme,lessDefaults:Pme,scssDefaults:Ame};function oQ(){return et(()=>import("./cssMode-4siXFwHW.js"),[])}IS.languages.onLanguage("less",()=>{oQ().then(s=>s.setupMode(Pme))});IS.languages.onLanguage("scss",()=>{oQ().then(s=>s.setupMode(Ame))});IS.languages.onLanguage("css",()=>{oQ().then(s=>s.setupMode(Rme))});/*!-----------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Version: 0.52.2(404545bded1df6ffa41ea0af4e8ddb219018c6c1)
 * Released under the MIT license
 * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt
 *-----------------------------------------------------------------------------*/var uKe=Object.defineProperty,hKe=Object.getOwnPropertyDescriptor,fKe=Object.getOwnPropertyNames,gKe=Object.prototype.hasOwnProperty,pKe=(s,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of fKe(e))!gKe.call(s,n)&&n!==t&&uKe(s,n,{get:()=>e[n],enumerable:!(i=hKe(e,n))||i.enumerable});return s},mKe=(s,e,t)=>(pKe(s,e,"default"),t),a5={};mKe(a5,fD);var _Ke=class{constructor(e,t,i){this._onDidChange=new a5.Emitter,this._languageId=e,this.setOptions(t),this.setModeConfiguration(i)}get onDidChange(){return this._onDidChange.event}get languageId(){return this._languageId}get options(){return this._options}get modeConfiguration(){return this._modeConfiguration}setOptions(e){this._options=e||Object.create(null),this._onDidChange.fire(this)}setModeConfiguration(e){this._modeConfiguration=e||Object.create(null),this._onDidChange.fire(this)}},bKe={tabSize:4,insertSpaces:!1,wrapLineLength:120,unformatted:'default": "a, abbr, acronym, b, bdo, big, br, button, cite, code, dfn, em, i, img, input, kbd, label, map, object, q, samp, select, small, span, strong, sub, sup, textarea, tt, var',contentUnformatted:"pre",indentInnerHtml:!1,preserveNewLines:!0,maxPreserveNewLines:void 0,indentHandlebars:!1,endWithNewline:!1,extraLiners:"head, body, /html",wrapAttributes:"auto"},l5={format:bKe,suggest:{},data:{useDefaultDataProvider:!0}};function c5(s){return{completionItems:!0,hovers:!0,documentSymbols:!0,links:!0,documentHighlights:!0,rename:!0,colors:!0,foldingRanges:!0,selectionRanges:!0,diagnostics:s===nk,documentFormattingEdits:s===nk,documentRangeFormattingEdits:s===nk}}var nk="html",yre="handlebars",Sre="razor",Mme=d5(nk,l5,c5(nk)),vKe=Mme.defaults,Ome=d5(yre,l5,c5(yre)),wKe=Ome.defaults,Fme=d5(Sre,l5,c5(Sre)),CKe=Fme.defaults;a5.languages.html={htmlDefaults:vKe,razorDefaults:CKe,handlebarDefaults:wKe,htmlLanguageService:Mme,handlebarLanguageService:Ome,razorLanguageService:Fme,registerHTMLLanguageService:d5};function yKe(){return et(()=>import("./htmlMode-BEuag_Ja.js"),[])}function d5(s,e=l5,t=c5(s)){const i=new _Ke(s,e,t);let n;const r=a5.languages.onLanguage(s,async()=>{n=(await yKe()).setupMode(i)});return{defaults:i,dispose(){r.dispose(),n==null||n.dispose(),n=void 0}}}/*!-----------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Version: 0.52.2(404545bded1df6ffa41ea0af4e8ddb219018c6c1)
 * Released under the MIT license
 * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt
 *-----------------------------------------------------------------------------*/var SKe=Object.defineProperty,xKe=Object.getOwnPropertyDescriptor,LKe=Object.getOwnPropertyNames,kKe=Object.prototype.hasOwnProperty,IKe=(s,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of LKe(e))!kKe.call(s,n)&&n!==t&&SKe(s,n,{get:()=>e[n],enumerable:!(i=xKe(e,n))||i.enumerable});return s},EKe=(s,e,t)=>(IKe(s,e,"default"),t),gD={};EKe(gD,fD);var DKe=class{constructor(e,t,i){this._onDidChange=new gD.Emitter,this._languageId=e,this.setDiagnosticsOptions(t),this.setModeConfiguration(i)}get onDidChange(){return this._onDidChange.event}get languageId(){return this._languageId}get modeConfiguration(){return this._modeConfiguration}get diagnosticsOptions(){return this._diagnosticsOptions}setDiagnosticsOptions(e){this._diagnosticsOptions=e||Object.create(null),this._onDidChange.fire(this)}setModeConfiguration(e){this._modeConfiguration=e||Object.create(null),this._onDidChange.fire(this)}},TKe={validate:!0,allowComments:!0,schemas:[],enableSchemaRequest:!1,schemaRequest:"warning",schemaValidation:"warning",comments:"error",trailingCommas:"error"},NKe={documentFormattingEdits:!0,documentRangeFormattingEdits:!0,completionItems:!0,hovers:!0,documentSymbols:!0,tokens:!0,colors:!0,foldingRanges:!0,diagnostics:!0,selectionRanges:!0},Vme=new DKe("json",TKe,NKe),RKe=()=>Bme().then(s=>s.getWorker());gD.languages.json={jsonDefaults:Vme,getWorker:RKe};function Bme(){return et(()=>import("./jsonMode-BRhLu3Tg.js"),[])}gD.languages.register({id:"json",extensions:[".json",".bowerrc",".jshintrc",".jscsrc",".eslintrc",".babelrc",".har"],aliases:["JSON","json"],mimetypes:["application/json"]});gD.languages.onLanguage("json",()=>{Bme().then(s=>s.setupMode(Vme))});/*!-----------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Version: 0.52.2(404545bded1df6ffa41ea0af4e8ddb219018c6c1)
 * Released under the MIT license
 * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt
 *-----------------------------------------------------------------------------*/var AKe=Object.defineProperty,PKe=Object.getOwnPropertyDescriptor,MKe=Object.getOwnPropertyNames,OKe=Object.prototype.hasOwnProperty,FKe=(s,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of MKe(e))!OKe.call(s,n)&&n!==t&&AKe(s,n,{get:()=>e[n],enumerable:!(i=PKe(e,n))||i.enumerable});return s},VKe=(s,e,t)=>(FKe(s,e,"default"),t),BKe="5.4.5",O1={};VKe(O1,fD);var Wme=(s=>(s[s.None=0]="None",s[s.CommonJS=1]="CommonJS",s[s.AMD=2]="AMD",s[s.UMD=3]="UMD",s[s.System=4]="System",s[s.ES2015=5]="ES2015",s[s.ESNext=99]="ESNext",s))(Wme||{}),Hme=(s=>(s[s.None=0]="None",s[s.Preserve=1]="Preserve",s[s.React=2]="React",s[s.ReactNative=3]="ReactNative",s[s.ReactJSX=4]="ReactJSX",s[s.ReactJSXDev=5]="ReactJSXDev",s))(Hme||{}),zme=(s=>(s[s.CarriageReturnLineFeed=0]="CarriageReturnLineFeed",s[s.LineFeed=1]="LineFeed",s))(zme||{}),Ume=(s=>(s[s.ES3=0]="ES3",s[s.ES5=1]="ES5",s[s.ES2015=2]="ES2015",s[s.ES2016=3]="ES2016",s[s.ES2017=4]="ES2017",s[s.ES2018=5]="ES2018",s[s.ES2019=6]="ES2019",s[s.ES2020=7]="ES2020",s[s.ESNext=99]="ESNext",s[s.JSON=100]="JSON",s[s.Latest=99]="Latest",s))(Ume||{}),jme=(s=>(s[s.Classic=1]="Classic",s[s.NodeJs=2]="NodeJs",s))(jme||{}),$me=class{constructor(s,e,t,i,n){this._onDidChange=new O1.Emitter,this._onDidExtraLibsChange=new O1.Emitter,this._extraLibs=Object.create(null),this._removedExtraLibs=Object.create(null),this._eagerModelSync=!1,this.setCompilerOptions(s),this.setDiagnosticsOptions(e),this.setWorkerOptions(t),this.setInlayHintsOptions(i),this.setModeConfiguration(n),this._onDidExtraLibsChangeTimeout=-1}get onDidChange(){return this._onDidChange.event}get onDidExtraLibsChange(){return this._onDidExtraLibsChange.event}get modeConfiguration(){return this._modeConfiguration}get workerOptions(){return this._workerOptions}get inlayHintsOptions(){return this._inlayHintsOptions}getExtraLibs(){return this._extraLibs}addExtraLib(s,e){let t;if(typeof e>"u"?t=`ts:extralib-${Math.random().toString(36).substring(2,15)}`:t=e,this._extraLibs[t]&&this._extraLibs[t].content===s)return{dispose:()=>{}};let i=1;return this._removedExtraLibs[t]&&(i=this._removedExtraLibs[t]+1),this._extraLibs[t]&&(i=this._extraLibs[t].version+1),this._extraLibs[t]={content:s,version:i},this._fireOnDidExtraLibsChangeSoon(),{dispose:()=>{let n=this._extraLibs[t];n&&n.version===i&&(delete this._extraLibs[t],this._removedExtraLibs[t]=i,this._fireOnDidExtraLibsChangeSoon())}}}setExtraLibs(s){for(const e in this._extraLibs)this._removedExtraLibs[e]=this._extraLibs[e].version;if(this._extraLibs=Object.create(null),s&&s.length>0)for(const e of s){const t=e.filePath||`ts:extralib-${Math.random().toString(36).substring(2,15)}`,i=e.content;let n=1;this._removedExtraLibs[t]&&(n=this._removedExtraLibs[t]+1),this._extraLibs[t]={content:i,version:n}}this._fireOnDidExtraLibsChangeSoon()}_fireOnDidExtraLibsChangeSoon(){this._onDidExtraLibsChangeTimeout===-1&&(this._onDidExtraLibsChangeTimeout=window.setTimeout(()=>{this._onDidExtraLibsChangeTimeout=-1,this._onDidExtraLibsChange.fire(void 0)},0))}getCompilerOptions(){return this._compilerOptions}setCompilerOptions(s){this._compilerOptions=s||Object.create(null),this._onDidChange.fire(void 0)}getDiagnosticsOptions(){return this._diagnosticsOptions}setDiagnosticsOptions(s){this._diagnosticsOptions=s||Object.create(null),this._onDidChange.fire(void 0)}setWorkerOptions(s){this._workerOptions=s||Object.create(null),this._onDidChange.fire(void 0)}setInlayHintsOptions(s){this._inlayHintsOptions=s||Object.create(null),this._onDidChange.fire(void 0)}setMaximumWorkerIdleTime(s){}setEagerModelSync(s){this._eagerModelSync=s}getEagerModelSync(){return this._eagerModelSync}setModeConfiguration(s){this._modeConfiguration=s||Object.create(null),this._onDidChange.fire(void 0)}},WKe=BKe,qme={completionItems:!0,hovers:!0,documentSymbols:!0,definitions:!0,references:!0,documentHighlights:!0,rename:!0,diagnostics:!0,documentRangeFormattingEdits:!0,signatureHelp:!0,onTypeFormattingEdits:!0,codeActions:!0,inlayHints:!0},Kme=new $me({allowNonTsExtensions:!0,target:99},{noSemanticValidation:!1,noSyntaxValidation:!1,onlyVisible:!1},{},{},qme),Gme=new $me({allowNonTsExtensions:!0,allowJs:!0,target:99},{noSemanticValidation:!0,noSyntaxValidation:!1,onlyVisible:!1},{},{},qme),HKe=()=>u5().then(s=>s.getTypeScriptWorker()),zKe=()=>u5().then(s=>s.getJavaScriptWorker());O1.languages.typescript={ModuleKind:Wme,JsxEmit:Hme,NewLineKind:zme,ScriptTarget:Ume,ModuleResolutionKind:jme,typescriptVersion:WKe,typescriptDefaults:Kme,javascriptDefaults:Gme,getTypeScriptWorker:HKe,getJavaScriptWorker:zKe};function u5(){return et(()=>import("./tsMode-7t9cOSw2.js"),[])}O1.languages.onLanguage("typescript",()=>u5().then(s=>s.setupTypeScript(Kme)));O1.languages.onLanguage("javascript",()=>u5().then(s=>s.setupJavaScript(Gme)));class UKe extends To{constructor(){super({id:"diffEditor.toggleCollapseUnchangedRegions",title:dt("toggleCollapseUnchangedRegions","Toggle Collapse Unchanged Regions"),icon:xe.map,toggled:he.has("config.diffEditor.hideUnchangedRegions.enabled"),precondition:he.has("isInDiffEditor"),menu:{when:he.has("isInDiffEditor"),id:ze.EditorTitle,order:22,group:"navigation"}})}run(e,...t){const i=e.get(At),n=!i.getValue("diffEditor.hideUnchangedRegions.enabled");i.updateValue("diffEditor.hideUnchangedRegions.enabled",n)}}class Qme extends To{constructor(){super({id:"diffEditor.toggleShowMovedCodeBlocks",title:dt("toggleShowMovedCodeBlocks","Toggle Show Moved Code Blocks"),precondition:he.has("isInDiffEditor")})}run(e,...t){const i=e.get(At),n=!i.getValue("diffEditor.experimental.showMoves");i.updateValue("diffEditor.experimental.showMoves",n)}}class Yme extends To{constructor(){super({id:"diffEditor.toggleUseInlineViewWhenSpaceIsLimited",title:dt("toggleUseInlineViewWhenSpaceIsLimited","Toggle Use Inline View When Space Is Limited"),precondition:he.has("isInDiffEditor")})}run(e,...t){const i=e.get(At),n=!i.getValue("diffEditor.useInlineViewWhenSpaceIsLimited");i.updateValue("diffEditor.useInlineViewWhenSpaceIsLimited",n)}}const pD=dt("diffEditor","Diff Editor");class jKe extends vu{constructor(){super({id:"diffEditor.switchSide",title:dt("switchSide","Switch Side"),icon:xe.arrowSwap,precondition:he.has("isInDiffEditor"),f1:!0,category:pD})}runEditorCommand(e,t,i){const n=ES(e);if(n instanceof Eg){if(i&&i.dryRun)return{destinationSelection:n.mapToOtherSide().destinationSelection};n.switchSide()}}}class $Ke extends vu{constructor(){super({id:"diffEditor.exitCompareMove",title:dt("exitCompareMove","Exit Compare Move"),icon:xe.close,precondition:z.comparingMovedCode,f1:!1,category:pD,keybinding:{weight:1e4,primary:9}})}runEditorCommand(e,t,...i){const n=ES(e);n instanceof Eg&&n.exitCompareMove()}}class qKe extends vu{constructor(){super({id:"diffEditor.collapseAllUnchangedRegions",title:dt("collapseAllUnchangedRegions","Collapse All Unchanged Regions"),icon:xe.fold,precondition:he.has("isInDiffEditor"),f1:!0,category:pD})}runEditorCommand(e,t,...i){const n=ES(e);n instanceof Eg&&n.collapseAllUnchangedRegions()}}class KKe extends vu{constructor(){super({id:"diffEditor.showAllUnchangedRegions",title:dt("showAllUnchangedRegions","Show All Unchanged Regions"),icon:xe.unfold,precondition:he.has("isInDiffEditor"),f1:!0,category:pD})}runEditorCommand(e,t,...i){const n=ES(e);n instanceof Eg&&n.showAllUnchangedRegions()}}class pz extends To{constructor(){super({id:"diffEditor.revert",title:dt("revert","Revert"),f1:!1,category:pD})}run(e,t){const i=GKe(e,t.originalUri,t.modifiedUri);i instanceof Eg&&i.revertRangeMappings(t.mapping.innerChanges??[])}}const Xme=dt("accessibleDiffViewer","Accessible Diff Viewer"),yO=class yO extends To{constructor(){super({id:yO.id,title:dt("editor.action.accessibleDiffViewer.next","Go to Next Difference"),category:Xme,precondition:he.has("isInDiffEditor"),keybinding:{primary:65,weight:100},f1:!0})}run(e){const t=ES(e);t==null||t.accessibleDiffViewerNext()}};yO.id="editor.action.accessibleDiffViewer.next";let ZI=yO;const SO=class SO extends To{constructor(){super({id:SO.id,title:dt("editor.action.accessibleDiffViewer.prev","Go to Previous Difference"),category:Xme,precondition:he.has("isInDiffEditor"),keybinding:{primary:1089,weight:100},f1:!0})}run(e){const t=ES(e);t==null||t.accessibleDiffViewerPrev()}};SO.id="editor.action.accessibleDiffViewer.prev";let IP=SO;function GKe(s,e,t){return s.get(ni).listDiffEditors().find(r=>{var l,c;const o=r.getModifiedEditor(),a=r.getOriginalEditor();return o&&((l=o.getModel())==null?void 0:l.uri.toString())===t.toString()&&a&&((c=a.getModel())==null?void 0:c.uri.toString())===e.toString()})||null}function ES(s){const t=s.get(ni).listDiffEditors(),i=hr();if(i)for(const n of t){const r=n.getContainerDomNode();if(QKe(r,i))return n}return null}function QKe(s,e){let t=e;for(;t;){if(t===s)return!0;t=t.parentElement}return!1}Oi(UKe);Oi(Qme);Oi(Yme);Os.appendMenuItem(ze.EditorTitle,{command:{id:new Yme().desc.id,title:b("useInlineViewWhenSpaceIsLimited","Use Inline View When Space Is Limited"),toggled:he.has("config.diffEditor.useInlineViewWhenSpaceIsLimited"),precondition:he.has("isInDiffEditor")},order:11,group:"1_diff",when:he.and(z.diffEditorRenderSideBySideInlineBreakpointReached,he.has("isInDiffEditor"))});Os.appendMenuItem(ze.EditorTitle,{command:{id:new Qme().desc.id,title:b("showMoves","Show Moved Code Blocks"),icon:xe.move,toggled:dS.create("config.diffEditor.experimental.showMoves",!0),precondition:he.has("isInDiffEditor")},order:10,group:"1_diff",when:he.has("isInDiffEditor")});Oi(pz);for(const s of[{icon:xe.arrowRight,key:z.diffEditorInlineMode.toNegated()},{icon:xe.discard,key:z.diffEditorInlineMode}])Os.appendMenuItem(ze.DiffEditorHunkToolbar,{command:{id:new pz().desc.id,title:b("revertHunk","Revert Block"),icon:s.icon},when:he.and(z.diffEditorModifiedWritable,s.key),order:5,group:"primary"}),Os.appendMenuItem(ze.DiffEditorSelectionToolbar,{command:{id:new pz().desc.id,title:b("revertSelection","Revert Selection"),icon:s.icon},when:he.and(z.diffEditorModifiedWritable,s.key),order:5,group:"primary"});Oi(jKe);Oi($Ke);Oi(qKe);Oi(KKe);Os.appendMenuItem(ze.EditorTitle,{command:{id:ZI.id,title:b("Open Accessible Diff Viewer","Open Accessible Diff Viewer"),precondition:he.has("isInDiffEditor")},order:10,group:"2_diff",when:he.and(z.accessibleDiffViewerVisible.negate(),he.has("isInDiffEditor"))});Gt.registerCommandAlias("editor.action.diffReview.next",ZI.id);Oi(ZI);Gt.registerCommandAlias("editor.action.diffReview.prev",IP.id);Oi(IP);var YKe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},XKe=function(s,e){return function(t,i){e(t,i,s)}},mz;const h5=new Oe("selectionAnchorSet",!1);var mv;let i_=(mv=class{static get(e){return e.getContribution(mz.ID)}constructor(e,t){this.editor=e,this.selectionAnchorSetContextKey=h5.bindTo(t),this.modelChangeListener=e.onDidChangeModel(()=>this.selectionAnchorSetContextKey.reset())}setSelectionAnchor(){if(this.editor.hasModel()){const e=this.editor.getPosition();this.editor.changeDecorations(t=>{this.decorationId&&t.removeDecoration(this.decorationId),this.decorationId=t.addDecoration(Ue.fromPositions(e,e),{description:"selection-anchor",stickiness:1,hoverMessage:new Lr().appendText(b("selectionAnchor","Selection Anchor")),className:"selection-anchor"})}),this.selectionAnchorSetContextKey.set(!!this.decorationId),Eo(b("anchorSet","Anchor set at {0}:{1}",e.lineNumber,e.column))}}goToSelectionAnchor(){if(this.editor.hasModel()&&this.decorationId){const e=this.editor.getModel().getDecorationRange(this.decorationId);e&&this.editor.setPosition(e.getStartPosition())}}selectFromAnchorToCursor(){if(this.editor.hasModel()&&this.decorationId){const e=this.editor.getModel().getDecorationRange(this.decorationId);if(e){const t=this.editor.getPosition();this.editor.setSelection(Ue.fromPositions(e.getStartPosition(),t)),this.cancelSelectionAnchor()}}}cancelSelectionAnchor(){if(this.decorationId){const e=this.decorationId;this.editor.changeDecorations(t=>{t.removeDecoration(e),this.decorationId=void 0}),this.selectionAnchorSetContextKey.set(!1)}}dispose(){this.cancelSelectionAnchor(),this.modelChangeListener.dispose()}},mz=mv,mv.ID="editor.contrib.selectionAnchorController",mv);i_=mz=YKe([XKe(1,ct)],i_);class ZKe extends Ve{constructor(){super({id:"editor.action.setSelectionAnchor",label:b("setSelectionAnchor","Set Selection Anchor"),alias:"Set Selection Anchor",precondition:void 0,kbOpts:{kbExpr:z.editorTextFocus,primary:ns(2089,2080),weight:100}})}async run(e,t){var i;(i=i_.get(t))==null||i.setSelectionAnchor()}}class JKe extends Ve{constructor(){super({id:"editor.action.goToSelectionAnchor",label:b("goToSelectionAnchor","Go to Selection Anchor"),alias:"Go to Selection Anchor",precondition:h5})}async run(e,t){var i;(i=i_.get(t))==null||i.goToSelectionAnchor()}}class eGe extends Ve{constructor(){super({id:"editor.action.selectFromAnchorToCursor",label:b("selectFromAnchorToCursor","Select from Anchor to Cursor"),alias:"Select from Anchor to Cursor",precondition:h5,kbOpts:{kbExpr:z.editorTextFocus,primary:ns(2089,2089),weight:100}})}async run(e,t){var i;(i=i_.get(t))==null||i.selectFromAnchorToCursor()}}class tGe extends Ve{constructor(){super({id:"editor.action.cancelSelectionAnchor",label:b("cancelSelectionAnchor","Cancel Selection Anchor"),alias:"Cancel Selection Anchor",precondition:h5,kbOpts:{kbExpr:z.editorTextFocus,primary:9,weight:100}})}async run(e,t){var i;(i=i_.get(t))==null||i.cancelSelectionAnchor()}}Zt(i_.ID,i_,4);ye(ZKe);ye(JKe);ye(eGe);ye(tGe);const iGe=j("editorOverviewRuler.bracketMatchForeground","#A0A0A0",b("overviewRulerBracketMatchForeground","Overview ruler marker color for matching brackets."));class nGe extends Ve{constructor(){super({id:"editor.action.jumpToBracket",label:b("smartSelect.jumpBracket","Go to Bracket"),alias:"Go to Bracket",precondition:void 0,kbOpts:{kbExpr:z.editorTextFocus,primary:3165,weight:100}})}run(e,t){var i;(i=Sw.get(t))==null||i.jumpToBracket()}}class sGe extends Ve{constructor(){super({id:"editor.action.selectToBracket",label:b("smartSelect.selectToBracket","Select to Bracket"),alias:"Select to Bracket",precondition:void 0,metadata:{description:dt("smartSelect.selectToBracketDescription","Select the text inside and including the brackets or curly braces"),args:[{name:"args",schema:{type:"object",properties:{selectBrackets:{type:"boolean",default:!0}}}}]}})}run(e,t,i){var r;let n=!0;i&&i.selectBrackets===!1&&(n=!1),(r=Sw.get(t))==null||r.selectToBracket(n)}}class rGe extends Ve{constructor(){super({id:"editor.action.removeBrackets",label:b("smartSelect.removeBrackets","Remove Brackets"),alias:"Remove Brackets",precondition:void 0,kbOpts:{kbExpr:z.editorTextFocus,primary:2561,weight:100}})}run(e,t){var i;(i=Sw.get(t))==null||i.removeBrackets(this.id)}}class oGe{constructor(e,t,i){this.position=e,this.brackets=t,this.options=i}}const Ip=class Ip extends te{static get(e){return e.getContribution(Ip.ID)}constructor(e){super(),this._editor=e,this._lastBracketsData=[],this._lastVersionId=0,this._decorations=this._editor.createDecorationsCollection(),this._updateBracketsSoon=this._register(new xi(()=>this._updateBrackets(),50)),this._matchBrackets=this._editor.getOption(72),this._updateBracketsSoon.schedule(),this._register(e.onDidChangeCursorPosition(t=>{this._matchBrackets!=="never"&&this._updateBracketsSoon.schedule()})),this._register(e.onDidChangeModelContent(t=>{this._updateBracketsSoon.schedule()})),this._register(e.onDidChangeModel(t=>{this._lastBracketsData=[],this._updateBracketsSoon.schedule()})),this._register(e.onDidChangeModelLanguageConfiguration(t=>{this._lastBracketsData=[],this._updateBracketsSoon.schedule()})),this._register(e.onDidChangeConfiguration(t=>{t.hasChanged(72)&&(this._matchBrackets=this._editor.getOption(72),this._decorations.clear(),this._lastBracketsData=[],this._lastVersionId=0,this._updateBracketsSoon.schedule())})),this._register(e.onDidBlurEditorWidget(()=>{this._updateBracketsSoon.schedule()})),this._register(e.onDidFocusEditorWidget(()=>{this._updateBracketsSoon.schedule()}))}jumpToBracket(){if(!this._editor.hasModel())return;const e=this._editor.getModel(),t=this._editor.getSelections().map(i=>{const n=i.getStartPosition(),r=e.bracketPairs.matchBracket(n);let o=null;if(r)r[0].containsPosition(n)&&!r[1].containsPosition(n)?o=r[1].getStartPosition():r[1].containsPosition(n)&&(o=r[0].getStartPosition());else{const a=e.bracketPairs.findEnclosingBrackets(n);if(a)o=a[1].getStartPosition();else{const l=e.bracketPairs.findNextBracket(n);l&&l.range&&(o=l.range.getStartPosition())}}return o?new Ue(o.lineNumber,o.column,o.lineNumber,o.column):new Ue(n.lineNumber,n.column,n.lineNumber,n.column)});this._editor.setSelections(t),this._editor.revealRange(t[0])}selectToBracket(e){if(!this._editor.hasModel())return;const t=this._editor.getModel(),i=[];this._editor.getSelections().forEach(n=>{const r=n.getStartPosition();let o=t.bracketPairs.matchBracket(r);if(!o&&(o=t.bracketPairs.findEnclosingBrackets(r),!o)){const c=t.bracketPairs.findNextBracket(r);c&&c.range&&(o=t.bracketPairs.matchBracket(c.range.getStartPosition()))}let a=null,l=null;if(o){o.sort(F.compareRangesUsingStarts);const[c,d]=o;if(a=e?c.getStartPosition():c.getEndPosition(),l=e?d.getEndPosition():d.getStartPosition(),d.containsPosition(r)){const u=a;a=l,l=u}}a&&l&&i.push(new Ue(a.lineNumber,a.column,l.lineNumber,l.column))}),i.length>0&&(this._editor.setSelections(i),this._editor.revealRange(i[0]))}removeBrackets(e){if(!this._editor.hasModel())return;const t=this._editor.getModel();this._editor.getSelections().forEach(i=>{const n=i.getPosition();let r=t.bracketPairs.matchBracket(n);r||(r=t.bracketPairs.findEnclosingBrackets(n)),r&&(this._editor.pushUndoStop(),this._editor.executeEdits(e,[{range:r[0],text:""},{range:r[1],text:""}]),this._editor.pushUndoStop())})}_updateBrackets(){if(this._matchBrackets==="never")return;this._recomputeBrackets();const e=[];let t=0;for(const i of this._lastBracketsData){const n=i.brackets;n&&(e[t++]={range:n[0],options:i.options},e[t++]={range:n[1],options:i.options})}this._decorations.set(e)}_recomputeBrackets(){if(!this._editor.hasModel()||!this._editor.hasWidgetFocus()){this._lastBracketsData=[],this._lastVersionId=0;return}const e=this._editor.getSelections();if(e.length>100){this._lastBracketsData=[],this._lastVersionId=0;return}const t=this._editor.getModel(),i=t.getVersionId();let n=[];this._lastVersionId===i&&(n=this._lastBracketsData);const r=[];let o=0;for(let u=0,h=e.length;u<h;u++){const g=e[u];g.isEmpty()&&(r[o++]=g.getStartPosition())}r.length>1&&r.sort(X.compare);const a=[];let l=0,c=0;const d=n.length;for(let u=0,h=r.length;u<h;u++){const g=r[u];for(;c<d&&n[c].position.isBefore(g);)c++;if(c<d&&n[c].position.equals(g))a[l++]=n[c];else{let p=t.bracketPairs.matchBracket(g,20),_=Ip._DECORATION_OPTIONS_WITH_OVERVIEW_RULER;!p&&this._matchBrackets==="always"&&(p=t.bracketPairs.findEnclosingBrackets(g,20),_=Ip._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER),a[l++]=new oGe(g,p,_)}}this._lastBracketsData=a,this._lastVersionId=i}};Ip.ID="editor.contrib.bracketMatchingController",Ip._DECORATION_OPTIONS_WITH_OVERVIEW_RULER=_t.register({description:"bracket-match-overview",stickiness:1,className:"bracket-match",overviewRuler:{color:kn(iGe),position:Il.Center}}),Ip._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER=_t.register({description:"bracket-match-no-overview",stickiness:1,className:"bracket-match"});let Sw=Ip;Zt(Sw.ID,Sw,1);ye(sGe);ye(nGe);ye(rGe);Os.appendMenuItem(ze.MenubarGoMenu,{group:"5_infile_nav",command:{id:"editor.action.jumpToBracket",title:b({key:"miGoToBracket",comment:["&& denotes a mnemonic"]},"Go to &&Bracket")},order:2});class aGe{constructor(e,t){this._selection=e,this._isMovingLeft=t}getEditOperations(e,t){if(this._selection.startLineNumber!==this._selection.endLineNumber||this._selection.isEmpty())return;const i=this._selection.startLineNumber,n=this._selection.startColumn,r=this._selection.endColumn;if(!(this._isMovingLeft&&n===1)&&!(!this._isMovingLeft&&r===e.getLineMaxColumn(i)))if(this._isMovingLeft){const o=new F(i,n-1,i,n),a=e.getValueInRange(o);t.addEditOperation(o,null),t.addEditOperation(new F(i,r,i,r),a)}else{const o=new F(i,r,i,r+1),a=e.getValueInRange(o);t.addEditOperation(o,null),t.addEditOperation(new F(i,n,i,n),a)}}computeCursorState(e,t){return this._isMovingLeft?new Ue(this._selection.startLineNumber,this._selection.startColumn-1,this._selection.endLineNumber,this._selection.endColumn-1):new Ue(this._selection.startLineNumber,this._selection.startColumn+1,this._selection.endLineNumber,this._selection.endColumn+1)}}class Zme extends Ve{constructor(e,t){super(t),this.left=e}run(e,t){if(!t.hasModel())return;const i=[],n=t.getSelections();for(const r of n)i.push(new aGe(r,this.left));t.pushUndoStop(),t.executeCommands(this.id,i),t.pushUndoStop()}}class lGe extends Zme{constructor(){super(!0,{id:"editor.action.moveCarretLeftAction",label:b("caret.moveLeft","Move Selected Text Left"),alias:"Move Selected Text Left",precondition:z.writable})}}class cGe extends Zme{constructor(){super(!1,{id:"editor.action.moveCarretRightAction",label:b("caret.moveRight","Move Selected Text Right"),alias:"Move Selected Text Right",precondition:z.writable})}}ye(lGe);ye(cGe);class dGe extends Ve{constructor(){super({id:"editor.action.transposeLetters",label:b("transposeLetters.label","Transpose Letters"),alias:"Transpose Letters",precondition:z.writable,kbOpts:{kbExpr:z.textInputFocus,primary:0,mac:{primary:306},weight:100}})}run(e,t){if(!t.hasModel())return;const i=t.getModel(),n=[],r=t.getSelections();for(const o of r){if(!o.isEmpty())continue;const a=o.startLineNumber,l=o.startColumn,c=i.getLineMaxColumn(a);if(a===1&&(l===1||l===2&&c===2))continue;const d=l===c?o.getPosition():vi.rightPosition(i,o.getPosition().lineNumber,o.getPosition().column),u=vi.leftPosition(i,d),h=vi.leftPosition(i,u),g=i.getValueInRange(F.fromPositions(h,u)),p=i.getValueInRange(F.fromPositions(u,d)),_=F.fromPositions(h,d);n.push(new dr(_,p+g))}n.length>0&&(t.pushUndoStop(),t.executeCommands(this.id,n),t.pushUndoStop())}}ye(dGe);const f5=function(){if(typeof crypto=="object"&&typeof crypto.randomUUID=="function")return crypto.randomUUID.bind(crypto);let s;typeof crypto=="object"&&typeof crypto.getRandomValues=="function"?s=crypto.getRandomValues.bind(crypto):s=function(i){for(let n=0;n<i.length;n++)i[n]=Math.floor(Math.random()*256);return i};const e=new Uint8Array(16),t=[];for(let i=0;i<256;i++)t.push(i.toString(16).padStart(2,"0"));return function(){s(e),e[6]=e[6]&15|64,e[8]=e[8]&63|128;let n=0,r="";return r+=t[e[n++]],r+=t[e[n++]],r+=t[e[n++]],r+=t[e[n++]],r+="-",r+=t[e[n++]],r+=t[e[n++]],r+="-",r+=t[e[n++]],r+=t[e[n++]],r+="-",r+=t[e[n++]],r+=t[e[n++]],r+="-",r+=t[e[n++]],r+=t[e[n++]],r+=t[e[n++]],r+=t[e[n++]],r+=t[e[n++]],r+=t[e[n++]],r}}();function aQ(s){return{asString:async()=>s,asFile:()=>{},value:typeof s=="string"?s:void 0}}function uGe(s,e,t){const i={id:f5(),name:s,uri:e,data:t};return{asString:async()=>"",asFile:()=>i,value:void 0}}class Jme{constructor(){this._entries=new Map}get size(){let e=0;for(const t of this._entries)e++;return e}has(e){return this._entries.has(this.toKey(e))}matches(e){const t=[...this._entries.keys()];return Kt.some(this,([i,n])=>n.asFile())&&t.push("files"),t_e(EP(e),t)}get(e){var t;return(t=this._entries.get(this.toKey(e)))==null?void 0:t[0]}append(e,t){const i=this._entries.get(e);i?i.push(t):this._entries.set(this.toKey(e),[t])}replace(e,t){this._entries.set(this.toKey(e),[t])}delete(e){this._entries.delete(this.toKey(e))}*[Symbol.iterator](){for(const[e,t]of this._entries)for(const i of t)yield[e,i]}toKey(e){return EP(e)}}function EP(s){return s.toLowerCase()}function e_e(s,e){return t_e(EP(s),e.map(EP))}function t_e(s,e){if(s==="*/*")return e.length>0;if(e.includes(s))return!0;const t=s.match(/^([a-z]+)\/([a-z]+|\*)$/i);if(!t)return!1;const[i,n,r]=t;return r==="*"?e.some(o=>o.startsWith(n+"/")):!1}const g5=Object.freeze({create:s=>wg(s.map(e=>e.toString())).join(`\r
`),split:s=>s.split(`\r
`),parse:s=>g5.split(s).filter(e=>!e.startsWith("#"))}),Xu=class Xu{constructor(e){this.value=e}equals(e){return this.value===e.value}contains(e){return this.equals(e)||this.value===""||e.value.startsWith(this.value+Xu.sep)}intersects(e){return this.contains(e)||e.contains(this)}append(...e){return new Xu((this.value?[this.value,...e]:e).join(Xu.sep))}};Xu.sep=".",Xu.None=new Xu("@@none@@"),Xu.Empty=new Xu("");let cn=Xu;const xre={EDITORS:"CodeEditors",FILES:"CodeFiles"};class hGe{}const fGe={DragAndDropContribution:"workbench.contributions.dragAndDrop"};_n.add(fGe.DragAndDropContribution,new hGe);const Dk=class Dk{constructor(){}static getInstance(){return Dk.INSTANCE}hasData(e){return e&&e===this.proto}getData(e){if(this.hasData(e))return this.data}};Dk.INSTANCE=new Dk;let _z=Dk;function i_e(s){const e=new Jme;for(const t of s.items){const i=t.type;if(t.kind==="string"){const n=new Promise(r=>t.getAsString(r));e.append(i,aQ(n))}else if(t.kind==="file"){const n=t.getAsFile();n&&e.append(i,gGe(n))}}return e}function gGe(s){const e=s.path?Je.parse(s.path):void 0;return uGe(s.name,e,async()=>new Uint8Array(await s.arrayBuffer()))}const pGe=Object.freeze([xre.EDITORS,xre.FILES,xI.RESOURCES,xI.INTERNAL_URI_LIST]);function n_e(s,e=!1){const t=i_e(s),i=t.get(xI.INTERNAL_URI_LIST);if(i)t.replace(An.uriList,i);else if(e||!t.has(An.uriList)){const n=[];for(const r of s.items){const o=r.getAsFile();if(o){const a=o.path;try{a?n.push(Je.file(a).toString()):n.push(Je.parse(o.name,!0).toString())}catch{}}}n.length&&t.replace(An.uriList,aQ(g5.create(n)))}for(const n of pGe)t.delete(n);return t}var lQ=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},JI=function(s,e){return function(t,i){e(t,i,s)}};class cQ{async provideDocumentPasteEdits(e,t,i,n,r){const o=await this.getEdit(i,r);if(o)return{edits:[{insertText:o.insertText,title:o.title,kind:o.kind,handledMimeType:o.handledMimeType,yieldTo:o.yieldTo}],dispose(){}}}async provideDocumentDropEdits(e,t,i,n){const r=await this.getEdit(i,n);if(r)return{edits:[{insertText:r.insertText,title:r.title,kind:r.kind,handledMimeType:r.handledMimeType,yieldTo:r.yieldTo}],dispose(){}}}}const Tk=class Tk extends cQ{constructor(){super(...arguments),this.kind=Tk.kind,this.dropMimeTypes=[An.text],this.pasteMimeTypes=[An.text]}async getEdit(e,t){const i=e.get(An.text);if(!i||e.has(An.uriList))return;const n=await i.asString();return{handledMimeType:An.text,title:b("text.label","Insert Plain Text"),insertText:n,kind:this.kind}}};Tk.id="text",Tk.kind=new cn("text.plain");let xw=Tk;class s_e extends cQ{constructor(){super(...arguments),this.kind=new cn("uri.absolute"),this.dropMimeTypes=[An.uriList],this.pasteMimeTypes=[An.uriList]}async getEdit(e,t){const i=await r_e(e);if(!i.length||t.isCancellationRequested)return;let n=0;const r=i.map(({uri:a,originalText:l})=>a.scheme===gt.file?a.fsPath:(n++,l)).join(" ");let o;return n>0?o=i.length>1?b("defaultDropProvider.uriList.uris","Insert Uris"):b("defaultDropProvider.uriList.uri","Insert Uri"):o=i.length>1?b("defaultDropProvider.uriList.paths","Insert Paths"):b("defaultDropProvider.uriList.path","Insert Path"),{handledMimeType:An.uriList,insertText:r,title:o,kind:this.kind}}}let DP=class extends cQ{constructor(e){super(),this._workspaceContextService=e,this.kind=new cn("uri.relative"),this.dropMimeTypes=[An.uriList],this.pasteMimeTypes=[An.uriList]}async getEdit(e,t){const i=await r_e(e);if(!i.length||t.isCancellationRequested)return;const n=rd(i.map(({uri:r})=>{const o=this._workspaceContextService.getWorkspaceFolder(r);return o?w5e(o.uri,r):void 0}));if(n.length)return{handledMimeType:An.uriList,insertText:n.join(" "),title:i.length>1?b("defaultDropProvider.uriList.relativePaths","Insert Relative Paths"):b("defaultDropProvider.uriList.relativePath","Insert Relative Path"),kind:this.kind}}};DP=lQ([JI(0,_w)],DP);class mGe{constructor(){this.kind=new cn("html"),this.pasteMimeTypes=["text/html"],this._yieldTo=[{mimeType:An.text}]}async provideDocumentPasteEdits(e,t,i,n,r){var l;if(n.triggerKind!==Zk.PasteAs&&!((l=n.only)!=null&&l.contains(this.kind)))return;const o=i.get("text/html"),a=await(o==null?void 0:o.asString());if(!(!a||r.isCancellationRequested))return{dispose(){},edits:[{insertText:a,yieldTo:this._yieldTo,title:b("pasteHtmlLabel","Insert HTML"),kind:this.kind}]}}}async function r_e(s){const e=s.get(An.uriList);if(!e)return[];const t=await e.asString(),i=[];for(const n of g5.parse(t))try{i.push({uri:Je.parse(n),originalText:n})}catch{}return i}let bz=class extends te{constructor(e,t){super(),this._register(e.documentDropEditProvider.register("*",new xw)),this._register(e.documentDropEditProvider.register("*",new s_e)),this._register(e.documentDropEditProvider.register("*",new DP(t)))}};bz=lQ([JI(0,Be),JI(1,_w)],bz);let vz=class extends te{constructor(e,t){super(),this._register(e.documentPasteEditProvider.register("*",new xw)),this._register(e.documentPasteEditProvider.register("*",new s_e)),this._register(e.documentPasteEditProvider.register("*",new DP(t))),this._register(e.documentPasteEditProvider.register("*",new mGe))}};vz=lQ([JI(0,Be),JI(1,_w)],vz);const Uc=class Uc{constructor(){this.value="",this.pos=0}static isDigitCharacter(e){return e>=48&&e<=57}static isVariableCharacter(e){return e===95||e>=97&&e<=122||e>=65&&e<=90}text(e){this.value=e,this.pos=0}tokenText(e){return this.value.substr(e.pos,e.len)}next(){if(this.pos>=this.value.length)return{type:14,pos:this.pos,len:0};const e=this.pos;let t=0,i=this.value.charCodeAt(e),n;if(n=Uc._table[i],typeof n=="number")return this.pos+=1,{type:n,pos:e,len:1};if(Uc.isDigitCharacter(i)){n=8;do t+=1,i=this.value.charCodeAt(e+t);while(Uc.isDigitCharacter(i));return this.pos+=t,{type:n,pos:e,len:t}}if(Uc.isVariableCharacter(i)){n=9;do i=this.value.charCodeAt(e+ ++t);while(Uc.isVariableCharacter(i)||Uc.isDigitCharacter(i));return this.pos+=t,{type:n,pos:e,len:t}}n=10;do t+=1,i=this.value.charCodeAt(e+t);while(!isNaN(i)&&typeof Uc._table[i]>"u"&&!Uc.isDigitCharacter(i)&&!Uc.isVariableCharacter(i));return this.pos+=t,{type:n,pos:e,len:t}}};Uc._table={36:0,58:1,44:2,123:3,125:4,92:5,47:6,124:7,43:11,45:12,63:13};let wz=Uc;class DS{constructor(){this._children=[]}appendChild(e){return e instanceof po&&this._children[this._children.length-1]instanceof po?this._children[this._children.length-1].value+=e.value:(e.parent=this,this._children.push(e)),this}replace(e,t){const{parent:i}=e,n=i.children.indexOf(e),r=i.children.slice(0);r.splice(n,1,...t),i._children=r,function o(a,l){for(const c of a)c.parent=l,o(c.children,c)}(t,i)}get children(){return this._children}get rightMostDescendant(){return this._children.length>0?this._children[this._children.length-1].rightMostDescendant:this}get snippet(){let e=this;for(;;){if(!e)return;if(e instanceof mD)return e;e=e.parent}}toString(){return this.children.reduce((e,t)=>e+t.toString(),"")}len(){return 0}}class po extends DS{constructor(e){super(),this.value=e}toString(){return this.value}len(){return this.value.length}clone(){return new po(this.value)}}class o_e extends DS{}class sc extends o_e{static compareByIndex(e,t){return e.index===t.index?0:e.isFinalTabstop?1:t.isFinalTabstop||e.index<t.index?-1:e.index>t.index?1:0}constructor(e){super(),this.index=e}get isFinalTabstop(){return this.index===0}get choice(){return this._children.length===1&&this._children[0]instanceof TS?this._children[0]:void 0}clone(){const e=new sc(this.index);return this.transform&&(e.transform=this.transform.clone()),e._children=this.children.map(t=>t.clone()),e}}class TS extends DS{constructor(){super(...arguments),this.options=[]}appendChild(e){return e instanceof po&&(e.parent=this,this.options.push(e)),this}toString(){return this.options[0].value}len(){return this.options[0].len()}clone(){const e=new TS;return this.options.forEach(e.appendChild,e),e}}class dQ extends DS{constructor(){super(...arguments),this.regexp=new RegExp("")}resolve(e){const t=this;let i=!1,n=e.replace(this.regexp,function(){return i=!0,t._replace(Array.prototype.slice.call(arguments,0,-2))});return!i&&this._children.some(r=>r instanceof Ud&&!!r.elseValue)&&(n=this._replace([])),n}_replace(e){let t="";for(const i of this._children)if(i instanceof Ud){let n=e[i.index]||"";n=i.resolve(n),t+=n}else t+=i.toString();return t}toString(){return""}clone(){const e=new dQ;return e.regexp=new RegExp(this.regexp.source,(this.regexp.ignoreCase?"i":"")+(this.regexp.global?"g":"")),e._children=this.children.map(t=>t.clone()),e}}class Ud extends DS{constructor(e,t,i,n){super(),this.index=e,this.shorthandName=t,this.ifValue=i,this.elseValue=n}resolve(e){return this.shorthandName==="upcase"?e?e.toLocaleUpperCase():"":this.shorthandName==="downcase"?e?e.toLocaleLowerCase():"":this.shorthandName==="capitalize"?e?e[0].toLocaleUpperCase()+e.substr(1):"":this.shorthandName==="pascalcase"?e?this._toPascalCase(e):"":this.shorthandName==="camelcase"?e?this._toCamelCase(e):"":e&&typeof this.ifValue=="string"?this.ifValue:!e&&typeof this.elseValue=="string"?this.elseValue:e||""}_toPascalCase(e){const t=e.match(/[a-z0-9]+/gi);return t?t.map(i=>i.charAt(0).toUpperCase()+i.substr(1)).join(""):e}_toCamelCase(e){const t=e.match(/[a-z0-9]+/gi);return t?t.map((i,n)=>n===0?i.charAt(0).toLowerCase()+i.substr(1):i.charAt(0).toUpperCase()+i.substr(1)).join(""):e}clone(){return new Ud(this.index,this.shorthandName,this.ifValue,this.elseValue)}}class eE extends o_e{constructor(e){super(),this.name=e}resolve(e){let t=e.resolve(this);return this.transform&&(t=this.transform.resolve(t||"")),t!==void 0?(this._children=[new po(t)],!0):!1}clone(){const e=new eE(this.name);return this.transform&&(e.transform=this.transform.clone()),e._children=this.children.map(t=>t.clone()),e}}function Lre(s,e){const t=[...s];for(;t.length>0;){const i=t.shift();if(!e(i))break;t.unshift(...i.children)}}class mD extends DS{get placeholderInfo(){if(!this._placeholders){const e=[];let t;this.walk(function(i){return i instanceof sc&&(e.push(i),t=!t||t.index<i.index?i:t),!0}),this._placeholders={all:e,last:t}}return this._placeholders}get placeholders(){const{all:e}=this.placeholderInfo;return e}offset(e){let t=0,i=!1;return this.walk(n=>n===e?(i=!0,!1):(t+=n.len(),!0)),i?t:-1}fullLen(e){let t=0;return Lre([e],i=>(t+=i.len(),!0)),t}enclosingPlaceholders(e){const t=[];let{parent:i}=e;for(;i;)i instanceof sc&&t.push(i),i=i.parent;return t}resolveVariables(e){return this.walk(t=>(t instanceof eE&&t.resolve(e)&&(this._placeholders=void 0),!0)),this}appendChild(e){return this._placeholders=void 0,super.appendChild(e)}replace(e,t){return this._placeholders=void 0,super.replace(e,t)}clone(){const e=new mD;return this._children=this.children.map(t=>t.clone()),e}walk(e){Lre(this.children,e)}}class Lw{constructor(){this._scanner=new wz,this._token={type:14,pos:0,len:0}}static escape(e){return e.replace(/\$|}|\\/g,"\\$&")}static guessNeedsClipboard(e){return/\${?CLIPBOARD/.test(e)}parse(e,t,i){const n=new mD;return this.parseFragment(e,n),this.ensureFinalTabstop(n,i??!1,t??!1),n}parseFragment(e,t){const i=t.children.length;for(this._scanner.text(e),this._token=this._scanner.next();this._parse(t););const n=new Map,r=[];t.walk(l=>(l instanceof sc&&(l.isFinalTabstop?n.set(0,void 0):!n.has(l.index)&&l.children.length>0?n.set(l.index,l.children):r.push(l)),!0));const o=(l,c)=>{const d=n.get(l.index);if(!d)return;const u=new sc(l.index);u.transform=l.transform;for(const h of d){const g=h.clone();u.appendChild(g),g instanceof sc&&n.has(g.index)&&!c.has(g.index)&&(c.add(g.index),o(g,c),c.delete(g.index))}t.replace(l,[u])},a=new Set;for(const l of r)o(l,a);return t.children.slice(i)}ensureFinalTabstop(e,t,i){(t||i&&e.placeholders.length>0)&&(e.placeholders.find(r=>r.index===0)||e.appendChild(new sc(0)))}_accept(e,t){if(e===void 0||this._token.type===e){const i=t?this._scanner.tokenText(this._token):!0;return this._token=this._scanner.next(),i}return!1}_backTo(e){return this._scanner.pos=e.pos+e.len,this._token=e,!1}_until(e){const t=this._token;for(;this._token.type!==e;){if(this._token.type===14)return!1;if(this._token.type===5){const n=this._scanner.next();if(n.type!==0&&n.type!==4&&n.type!==5)return!1}this._token=this._scanner.next()}const i=this._scanner.value.substring(t.pos,this._token.pos).replace(/\\(\$|}|\\)/g,"$1");return this._token=this._scanner.next(),i}_parse(e){return this._parseEscaped(e)||this._parseTabstopOrVariableName(e)||this._parseComplexPlaceholder(e)||this._parseComplexVariable(e)||this._parseAnything(e)}_parseEscaped(e){let t;return(t=this._accept(5,!0))?(t=this._accept(0,!0)||this._accept(4,!0)||this._accept(5,!0)||t,e.appendChild(new po(t)),!0):!1}_parseTabstopOrVariableName(e){let t;const i=this._token;return this._accept(0)&&(t=this._accept(9,!0)||this._accept(8,!0))?(e.appendChild(/^\d+$/.test(t)?new sc(Number(t)):new eE(t)),!0):this._backTo(i)}_parseComplexPlaceholder(e){let t;const i=this._token;if(!(this._accept(0)&&this._accept(3)&&(t=this._accept(8,!0))))return this._backTo(i);const r=new sc(Number(t));if(this._accept(1))for(;;){if(this._accept(4))return e.appendChild(r),!0;if(!this._parse(r))return e.appendChild(new po("${"+t+":")),r.children.forEach(e.appendChild,e),!0}else if(r.index>0&&this._accept(7)){const o=new TS;for(;;){if(this._parseChoiceElement(o)){if(this._accept(2))continue;if(this._accept(7)&&(r.appendChild(o),this._accept(4)))return e.appendChild(r),!0}return this._backTo(i),!1}}else return this._accept(6)?this._parseTransform(r)?(e.appendChild(r),!0):(this._backTo(i),!1):this._accept(4)?(e.appendChild(r),!0):this._backTo(i)}_parseChoiceElement(e){const t=this._token,i=[];for(;!(this._token.type===2||this._token.type===7);){let n;if((n=this._accept(5,!0))?n=this._accept(2,!0)||this._accept(7,!0)||this._accept(5,!0)||n:n=this._accept(void 0,!0),!n)return this._backTo(t),!1;i.push(n)}return i.length===0?(this._backTo(t),!1):(e.appendChild(new po(i.join(""))),!0)}_parseComplexVariable(e){let t;const i=this._token;if(!(this._accept(0)&&this._accept(3)&&(t=this._accept(9,!0))))return this._backTo(i);const r=new eE(t);if(this._accept(1))for(;;){if(this._accept(4))return e.appendChild(r),!0;if(!this._parse(r))return e.appendChild(new po("${"+t+":")),r.children.forEach(e.appendChild,e),!0}else return this._accept(6)?this._parseTransform(r)?(e.appendChild(r),!0):(this._backTo(i),!1):this._accept(4)?(e.appendChild(r),!0):this._backTo(i)}_parseTransform(e){const t=new dQ;let i="",n="";for(;!this._accept(6);){let r;if(r=this._accept(5,!0)){r=this._accept(6,!0)||r,i+=r;continue}if(this._token.type!==14){i+=this._accept(void 0,!0);continue}return!1}for(;!this._accept(6);){let r;if(r=this._accept(5,!0)){r=this._accept(5,!0)||this._accept(6,!0)||r,t.appendChild(new po(r));continue}if(!(this._parseFormatString(t)||this._parseAnything(t)))return!1}for(;!this._accept(4);){if(this._token.type!==14){n+=this._accept(void 0,!0);continue}return!1}try{t.regexp=new RegExp(i,n)}catch{return!1}return e.transform=t,!0}_parseFormatString(e){const t=this._token;if(!this._accept(0))return!1;let i=!1;this._accept(3)&&(i=!0);const n=this._accept(8,!0);if(n)if(i){if(this._accept(4))return e.appendChild(new Ud(Number(n))),!0;if(!this._accept(1))return this._backTo(t),!1}else return e.appendChild(new Ud(Number(n))),!0;else return this._backTo(t),!1;if(this._accept(6)){const r=this._accept(9,!0);return!r||!this._accept(4)?(this._backTo(t),!1):(e.appendChild(new Ud(Number(n),r)),!0)}else if(this._accept(11)){const r=this._until(4);if(r)return e.appendChild(new Ud(Number(n),void 0,r,void 0)),!0}else if(this._accept(12)){const r=this._until(4);if(r)return e.appendChild(new Ud(Number(n),void 0,void 0,r)),!0}else if(this._accept(13)){const r=this._until(1);if(r){const o=this._until(4);if(o)return e.appendChild(new Ud(Number(n),void 0,r,o)),!0}}else{const r=this._until(4);if(r)return e.appendChild(new Ud(Number(n),void 0,void 0,r)),!0}return this._backTo(t),!1}_parseAnything(e){return this._token.type!==14?(e.appendChild(new po(this._scanner.tokenText(this._token))),this._accept(void 0),!0):!1}}function a_e(s,e,t){var i,n;return(typeof t.insertText=="string"?t.insertText==="":t.insertText.snippet==="")?{edits:((i=t.additionalEdit)==null?void 0:i.edits)??[]}:{edits:[...e.map(r=>new um(s,{range:r,text:typeof t.insertText=="string"?Lw.escape(t.insertText)+"$0":t.insertText.snippet,insertAsSnippet:!0})),...((n=t.additionalEdit)==null?void 0:n.edits)??[]]}}function l_e(s){function e(o,a){return"mimeType"in o?o.mimeType===a.handledMimeType:!!a.kind&&o.kind.contains(a.kind)}const t=new Map;for(const o of s)for(const a of o.yieldTo??[])for(const l of s)if(l!==o&&e(a,l)){let c=t.get(o);c||(c=[],t.set(o,c)),c.push(l)}if(!t.size)return Array.from(s);const i=new Set,n=[];function r(o){if(!o.length)return[];const a=o[0];if(n.includes(a))return console.warn("Yield to cycle detected",a),o;if(i.has(a))return r(o.slice(1));let l=[];const c=t.get(a);return c&&(n.push(a),l=r(c),n.pop()),i.add(a),[...l,a,...r(o.slice(1))]}return r(Array.from(s))}var _Ge=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},bGe=function(s,e){return function(t,i){e(t,i,s)}};const vGe=_t.register({description:"inline-progress-widget",stickiness:1,showIfCollapsed:!0,after:{content:Pue,inlineClassName:"inline-editor-progress-decoration",inlineClassNameAffectsLetterSpacing:!0}}),xO=class xO extends te{constructor(e,t,i,n,r){super(),this.typeId=e,this.editor=t,this.range=i,this.delegate=r,this.allowEditorOverflow=!1,this.suppressMouseDown=!0,this.create(n),this.editor.addContentWidget(this),this.editor.layoutContentWidget(this)}create(e){this.domNode=ke(".inline-progress-widget"),this.domNode.role="button",this.domNode.title=e;const t=ke("span.icon");this.domNode.append(t),t.classList.add(...at.asClassNameArray(xe.loading),"codicon-modifier-spin");const i=()=>{const n=this.editor.getOption(67);this.domNode.style.height=`${n}px`,this.domNode.style.width=`${Math.ceil(.8*n)}px`};i(),this._register(this.editor.onDidChangeConfiguration(n=>{(n.hasChanged(52)||n.hasChanged(67))&&i()})),this._register(oe(this.domNode,Le.CLICK,n=>{this.delegate.cancel()}))}getId(){return xO.baseId+"."+this.typeId}getDomNode(){return this.domNode}getPosition(){return{position:{lineNumber:this.range.startLineNumber,column:this.range.startColumn},preference:[0]}}dispose(){super.dispose(),this.editor.removeContentWidget(this)}};xO.baseId="editor.widget.inlineProgressWidget";let Cz=xO,TP=class extends te{constructor(e,t,i){super(),this.id=e,this._editor=t,this._instantiationService=i,this._showDelay=500,this._showPromise=this._register(new Es),this._currentWidget=this._register(new Es),this._operationIdPool=0,this._currentDecorations=t.createDecorationsCollection()}dispose(){super.dispose(),this._currentDecorations.clear()}async showWhile(e,t,i,n,r){const o=this._operationIdPool++;this._currentOperation=o,this.clear(),this._showPromise.value=$m(()=>{const a=F.fromPositions(e);this._currentDecorations.set([{range:a,options:vGe}]).length>0&&(this._currentWidget.value=this._instantiationService.createInstance(Cz,this.id,this._editor,a,t,n))},r??this._showDelay);try{return await i}finally{this._currentOperation===o&&(this.clear(),this._currentOperation=void 0)}}clear(){this._showPromise.clear(),this._currentDecorations.clear(),this._currentWidget.clear()}};TP=_Ge([bGe(2,Xe)],TP);var wGe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},kre=function(s,e){return function(t,i){e(t,i,s)}},KR,mm;let Aa=(mm=class{static get(e){return e.getContribution(KR.ID)}constructor(e,t,i){this._openerService=i,this._messageWidget=new Es,this._messageListeners=new ce,this._mouseOverMessage=!1,this._editor=e,this._visible=KR.MESSAGE_VISIBLE.bindTo(t)}dispose(){var e;(e=this._message)==null||e.dispose(),this._messageListeners.dispose(),this._messageWidget.dispose(),this._visible.reset()}showMessage(e,t){Eo(au(e)?e.value:e),this._visible.set(!0),this._messageWidget.clear(),this._messageListeners.clear(),this._message=au(e)?PF(e,{actionHandler:{callback:n=>{this.closeMessage(),DK(this._openerService,n,au(e)?e.isTrusted:void 0)},disposables:this._messageListeners}}):void 0,this._messageWidget.value=new Ire(this._editor,t,typeof e=="string"?e:this._message.element),this._messageListeners.add(De.debounce(this._editor.onDidBlurEditorText,(n,r)=>r,0)(()=>{this._mouseOverMessage||this._messageWidget.value&&ys(hr(),this._messageWidget.value.getDomNode())||this.closeMessage()})),this._messageListeners.add(this._editor.onDidChangeCursorPosition(()=>this.closeMessage())),this._messageListeners.add(this._editor.onDidDispose(()=>this.closeMessage())),this._messageListeners.add(this._editor.onDidChangeModel(()=>this.closeMessage())),this._messageListeners.add(oe(this._messageWidget.value.getDomNode(),Le.MOUSE_ENTER,()=>this._mouseOverMessage=!0,!0)),this._messageListeners.add(oe(this._messageWidget.value.getDomNode(),Le.MOUSE_LEAVE,()=>this._mouseOverMessage=!1,!0));let i;this._messageListeners.add(this._editor.onMouseMove(n=>{n.target.position&&(i?i.containsPosition(n.target.position)||this.closeMessage():i=new F(t.lineNumber-3,1,n.target.position.lineNumber+3,1))}))}closeMessage(){this._visible.reset(),this._messageListeners.clear(),this._messageWidget.value&&this._messageListeners.add(Ire.fadeOut(this._messageWidget.value))}},KR=mm,mm.ID="editor.contrib.messageController",mm.MESSAGE_VISIBLE=new Oe("messageVisible",!1,b("messageVisible","Whether the editor is currently showing an inline message")),mm);Aa=KR=wGe([kre(1,ct),kre(2,la)],Aa);const CGe=fs.bindToContribution(Aa.get);Me(new CGe({id:"leaveEditorMessage",precondition:Aa.MESSAGE_VISIBLE,handler:s=>s.closeMessage(),kbOpts:{weight:130,primary:9}}));let Ire=class{static fadeOut(e){const t=()=>{e.dispose(),clearTimeout(i),e.getDomNode().removeEventListener("animationend",t)},i=setTimeout(t,110);return e.getDomNode().addEventListener("animationend",t),e.getDomNode().classList.add("fadeOut"),{dispose:t}}constructor(e,{lineNumber:t,column:i},n){this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._editor=e,this._editor.revealLinesInCenterIfOutsideViewport(t,t,0),this._position={lineNumber:t,column:i},this._domNode=document.createElement("div"),this._domNode.classList.add("monaco-editor-overlaymessage"),this._domNode.style.marginLeft="-6px";const r=document.createElement("div");r.classList.add("anchor","top"),this._domNode.appendChild(r);const o=document.createElement("div");typeof n=="string"?(o.classList.add("message"),o.textContent=n):(n.classList.add("message"),o.appendChild(n)),this._domNode.appendChild(o);const a=document.createElement("div");a.classList.add("anchor","below"),this._domNode.appendChild(a),this._editor.addContentWidget(this),this._domNode.classList.add("fadeIn")}dispose(){this._editor.removeContentWidget(this)}getId(){return"messageoverlay"}getDomNode(){return this._domNode}getPosition(){return{position:this._position,preference:[1,2],positionAffinity:1}}afterRender(e){this._domNode.classList.toggle("below",e===2)}};Zt(Aa.ID,Aa,4);function vB(s,e){return e&&(s.stack||s.stacktrace)?b("stackTrace.format","{0}: {1}",Dre(s),Ere(s.stack)||Ere(s.stacktrace)):Dre(s)}function Ere(s){return Array.isArray(s)?s.join(`
`):s}function Dre(s){return s.code==="ERR_UNC_HOST_NOT_ALLOWED"?`${s.message}. Please update the 'security.allowedUNCHosts' setting if you want to allow this host.`:typeof s.code=="string"&&typeof s.errno=="number"&&typeof s.syscall=="string"?b("nodeExceptionMessage","A system error occurred ({0})",s.message):s.message||b("error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}function NP(s=null,e=!1){if(!s)return b("error.defaultMessage","An unknown error occurred. Please consult the log for more details.");if(Array.isArray(s)){const t=rd(s),i=NP(t[0],e);return t.length>1?b("error.moreErrors","{0} ({1} errors in total)",i,t.length):i}if(Zo(s))return s;if(s.detail){const t=s.detail;if(t.error)return vB(t.error,e);if(t.exception)return vB(t.exception,e)}return s.stack?vB(s,e):s.message?s.message:b("error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}var c_e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Oy=function(s,e){return function(t,i){e(t,i,s)}},yz,_v;let Sz=(_v=class extends te{constructor(e,t,i,n,r,o,a,l,c,d){super(),this.typeId=e,this.editor=t,this.showCommand=n,this.range=r,this.edits=o,this.onSelectNewEdit=a,this._contextMenuService=l,this._keybindingService=d,this.allowEditorOverflow=!0,this.suppressMouseDown=!0,this.create(),this.visibleContext=i.bindTo(c),this.visibleContext.set(!0),this._register(Ye(()=>this.visibleContext.reset())),this.editor.addContentWidget(this),this.editor.layoutContentWidget(this),this._register(Ye(()=>this.editor.removeContentWidget(this))),this._register(this.editor.onDidChangeCursorPosition(u=>{r.containsPosition(u.position)||this.dispose()})),this._register(De.runAndSubscribe(d.onDidUpdateKeybindings,()=>{this._updateButtonTitle()}))}_updateButtonTitle(){var t;const e=(t=this._keybindingService.lookupKeybinding(this.showCommand.id))==null?void 0:t.getLabel();this.button.element.title=this.showCommand.label+(e?` (${e})`:"")}create(){this.domNode=ke(".post-edit-widget"),this.button=this._register(new FA(this.domNode,{supportIcons:!0})),this.button.label="$(insert)",this._register(oe(this.domNode,Le.CLICK,()=>this.showSelector()))}getId(){return yz.baseId+"."+this.typeId}getDomNode(){return this.domNode}getPosition(){return{position:this.range.getEndPosition(),preference:[2]}}showSelector(){this._contextMenuService.showContextMenu({getAnchor:()=>{const e=Pn(this.button.element);return{x:e.left+e.width,y:e.top+e.height}},getActions:()=>this.edits.allEdits.map((e,t)=>Yb({id:"",label:e.title,checked:t===this.edits.activeEditIndex,run:()=>{if(t!==this.edits.activeEditIndex)return this.onSelectNewEdit(t)}}))})}},yz=_v,_v.baseId="editor.widget.postEditWidget",_v);Sz=yz=c_e([Oy(7,Ba),Oy(8,ct),Oy(9,pi)],Sz);let RP=class extends te{constructor(e,t,i,n,r,o,a){super(),this._id=e,this._editor=t,this._visibleContext=i,this._showCommand=n,this._instantiationService=r,this._bulkEditService=o,this._notificationService=a,this._currentWidget=this._register(new Es),this._register(De.any(t.onDidChangeModel,t.onDidChangeModelContent)(()=>this.clear()))}async applyEditAndShowIfNeeded(e,t,i,n,r){const o=this._editor.getModel();if(!o||!e.length)return;const a=t.allEdits.at(t.activeEditIndex);if(!a)return;const l=async v=>{const C=this._editor.getModel();C&&(await C.undo(),this.applyEditAndShowIfNeeded(e,{activeEditIndex:v,allEdits:t.allEdits},i,n,r))},c=(v,C)=>{xc(v)||(this._notificationService.error(C),i&&this.show(e[0],t,l))};let d;try{d=await n(a,r)}catch(v){return c(v,b("resolveError",`Error resolving edit '{0}':
{1}`,a.title,NP(v)))}if(r.isCancellationRequested)return;const u=a_e(o.uri,e,d),h=e[0],g=o.deltaDecorations([],[{range:h,options:{description:"paste-line-suffix",stickiness:0}}]);this._editor.focus();let p,_;try{p=await this._bulkEditService.apply(u,{editor:this._editor,token:r}),_=o.getDecorationRange(g[0])}catch(v){return c(v,b("applyError",`Error applying edit '{0}':
{1}`,a.title,NP(v)))}finally{o.deltaDecorations(g,[])}r.isCancellationRequested||i&&p.isApplied&&t.allEdits.length>1&&this.show(_??h,t,l)}show(e,t,i){this.clear(),this._editor.hasModel()&&(this._currentWidget.value=this._instantiationService.createInstance(Sz,this._id,this._editor,this._visibleContext,this._showCommand,e,t,i))}clear(){this._currentWidget.clear()}tryShowSelector(){var e;(e=this._currentWidget.value)==null||e.showSelector()}};RP=c_e([Oy(4,Xe),Oy(5,ZE),Oy(6,jn)],RP);var yGe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},X0=function(s,e){return function(t,i){e(t,i,s)}},hb;const d_e="editor.changePasteType",uQ=new Oe("pasteWidgetVisible",!1,b("pasteWidgetVisible","Whether the paste widget is showing")),wB="application/vnd.code.copyMetadata";var bv;let Dg=(bv=class extends te{static get(e){return e.getContribution(hb.ID)}constructor(e,t,i,n,r,o,a){super(),this._bulkEditService=i,this._clipboardService=n,this._languageFeaturesService=r,this._quickInputService=o,this._progressService=a,this._editor=e;const l=e.getContainerDomNode();this._register(oe(l,"copy",c=>this.handleCopy(c))),this._register(oe(l,"cut",c=>this.handleCopy(c))),this._register(oe(l,"paste",c=>this.handlePaste(c),!0)),this._pasteProgressManager=this._register(new TP("pasteIntoEditor",e,t)),this._postPasteWidgetManager=this._register(t.createInstance(RP,"pasteIntoEditor",e,uQ,{id:d_e,label:b("postPasteWidgetTitle","Show paste options...")}))}changePasteType(){this._postPasteWidgetManager.tryShowSelector()}pasteAs(e){this._editor.focus();try{this._pasteAsActionContext={preferred:e},cS().execCommand("paste")}finally{this._pasteAsActionContext=void 0}}clearWidgets(){this._postPasteWidgetManager.clear()}isPasteAsEnabled(){return this._editor.getOption(85).enabled}async finishedPaste(){await this._currentPasteOperation}handleCopy(e){var _,v,C,y;if(!this._editor.hasTextFocus()||((v=(_=this._clipboardService).clearInternalState)==null||v.call(_),!e.clipboardData||!this.isPasteAsEnabled()))return;const t=this._editor.getModel(),i=this._editor.getSelections();if(!t||!(i!=null&&i.length))return;const n=this._editor.getOption(37);let r=i;const o=i.length===1&&i[0].isEmpty();if(o){if(!n)return;r=[new F(r[0].startLineNumber,1,r[0].startLineNumber,1+t.getLineLength(r[0].startLineNumber))]}const a=(C=this._editor._getViewModel())==null?void 0:C.getPlainTextToCopy(i,n,gr),c={multicursorText:Array.isArray(a)?a:null,pasteOnNewLine:o,mode:null},d=this._languageFeaturesService.documentPasteEditProvider.ordered(t).filter(x=>!!x.prepareDocumentPaste);if(!d.length){this.setCopyMetadata(e.clipboardData,{defaultPastePayload:c});return}const u=i_e(e.clipboardData),h=d.flatMap(x=>x.copyMimeTypes??[]),g=f5();this.setCopyMetadata(e.clipboardData,{id:g,providerCopyMimeTypes:h,defaultPastePayload:c});const p=xs(async x=>{const L=rd(await Promise.all(d.map(async I=>{try{return await I.prepareDocumentPaste(t,r,u,x)}catch(A){console.error(A);return}})));L.reverse();for(const I of L)for(const[A,D]of I)u.replace(A,D);return u});(y=hb._currentCopyOperation)==null||y.dataTransferPromise.cancel(),hb._currentCopyOperation={handle:g,dataTransferPromise:p}}async handlePaste(e){var l,c,d;if(!e.clipboardData||!this._editor.hasTextFocus())return;(l=Aa.get(this._editor))==null||l.closeMessage(),(c=this._currentPasteOperation)==null||c.cancel(),this._currentPasteOperation=void 0;const t=this._editor.getModel(),i=this._editor.getSelections();if(!(i!=null&&i.length)||!t||this._editor.getOption(92)||!this.isPasteAsEnabled()&&!this._pasteAsActionContext)return;const n=this.fetchCopyMetadata(e),r=n_e(e.clipboardData);r.delete(wB);const o=[...e.clipboardData.types,...(n==null?void 0:n.providerCopyMimeTypes)??[],An.uriList],a=this._languageFeaturesService.documentPasteEditProvider.ordered(t).filter(u=>{var g,p;const h=(g=this._pasteAsActionContext)==null?void 0:g.preferred;return h&&u.providedPasteEditKinds&&!this.providerMatchesPreference(u,h)?!1:(p=u.pasteMimeTypes)==null?void 0:p.some(_=>e_e(_,o))});if(!a.length){(d=this._pasteAsActionContext)!=null&&d.preferred&&this.showPasteAsNoEditMessage(i,this._pasteAsActionContext.preferred);return}e.preventDefault(),e.stopImmediatePropagation(),this._pasteAsActionContext?this.showPasteAsPick(this._pasteAsActionContext.preferred,a,i,r,n):this.doPasteInline(a,i,r,n,e)}showPasteAsNoEditMessage(e,t){var i;(i=Aa.get(this._editor))==null||i.showMessage(b("pasteAsError","No paste edits for '{0}' found",t instanceof cn?t.value:t.providerId),e[0].getStartPosition())}doPasteInline(e,t,i,n,r){const o=this._editor;if(!o.hasModel())return;const a=new t_(o,3,void 0),l=xs(async c=>{const d=this._editor;if(!d.hasModel())return;const u=d.getModel(),h=new ce,g=h.add(new mn(c));h.add(a.token.onCancellationRequested(()=>g.cancel()));const p=g.token;try{if(await this.mergeInDataFromCopy(i,n,p),p.isCancellationRequested)return;const _=e.filter(y=>this.isSupportedPasteProvider(y,i));if(!_.length||_.length===1&&_[0]instanceof xw)return this.applyDefaultPasteHandler(i,n,p,r);const v={triggerKind:Zk.Automatic},C=await this.getPasteEdits(_,i,u,t,v,p);if(h.add(C),p.isCancellationRequested)return;if(C.edits.length===1&&C.edits[0].provider instanceof xw)return this.applyDefaultPasteHandler(i,n,p,r);if(C.edits.length){const y=d.getOption(85).showPasteSelector==="afterPaste";return this._postPasteWidgetManager.applyEditAndShowIfNeeded(t,{activeEditIndex:0,allEdits:C.edits},y,(x,L)=>new Promise((I,A)=>{(async()=>{var D,N;try{const R=(N=(D=x.provider).resolveDocumentPasteEdit)==null?void 0:N.call(D,x,L),W=new lS,H=R&&await this._pasteProgressManager.showWhile(t[0].getEndPosition(),b("resolveProcess","Resolving paste edit. Click to cancel"),Promise.race([W.p,R]),{cancel:()=>(W.cancel(),A(new od))},0);return H&&(x.additionalEdit=H.additionalEdit),I(x)}catch(R){return A(R)}})()}),p)}await this.applyDefaultPasteHandler(i,n,p,r)}finally{h.dispose(),this._currentPasteOperation===l&&(this._currentPasteOperation=void 0)}});this._pasteProgressManager.showWhile(t[0].getEndPosition(),b("pasteIntoEditorProgress","Running paste handlers. Click to cancel and do basic paste"),l,{cancel:async()=>{try{if(l.cancel(),a.token.isCancellationRequested)return;await this.applyDefaultPasteHandler(i,n,a.token,r)}finally{a.dispose()}}}).then(()=>{a.dispose()}),this._currentPasteOperation=l}showPasteAsPick(e,t,i,n,r){const o=xs(async a=>{const l=this._editor;if(!l.hasModel())return;const c=l.getModel(),d=new ce,u=d.add(new t_(l,3,void 0,a));try{if(await this.mergeInDataFromCopy(n,r,u.token),u.token.isCancellationRequested)return;let h=t.filter(C=>this.isSupportedPasteProvider(C,n,e));e&&(h=h.filter(C=>this.providerMatchesPreference(C,e)));const g={triggerKind:Zk.PasteAs,only:e&&e instanceof cn?e:void 0};let p=d.add(await this.getPasteEdits(h,n,c,i,g,u.token));if(u.token.isCancellationRequested)return;if(e&&(p={edits:p.edits.filter(C=>e instanceof cn?e.contains(C.kind):e.providerId===C.provider.id),dispose:p.dispose}),!p.edits.length){g.only&&this.showPasteAsNoEditMessage(i,g.only);return}let _;if(e)_=p.edits.at(0);else{const C=await this._quickInputService.pick(p.edits.map(y=>{var x;return{label:y.title,description:(x=y.kind)==null?void 0:x.value,edit:y}}),{placeHolder:b("pasteAsPickerPlaceholder","Select Paste Action")});_=C==null?void 0:C.edit}if(!_)return;const v=a_e(c.uri,i,_);await this._bulkEditService.apply(v,{editor:this._editor})}finally{d.dispose(),this._currentPasteOperation===o&&(this._currentPasteOperation=void 0)}});this._progressService.withProgress({location:10,title:b("pasteAsProgress","Running paste handlers")},()=>o)}setCopyMetadata(e,t){e.setData(wB,JSON.stringify(t))}fetchCopyMetadata(e){if(!e.clipboardData)return;const t=e.clipboardData.getData(wB);if(t)try{return JSON.parse(t)}catch{return}const[i,n]=TH.getTextData(e.clipboardData);if(n)return{defaultPastePayload:{mode:n.mode,multicursorText:n.multicursorText??null,pasteOnNewLine:!!n.isFromEmptySelection}}}async mergeInDataFromCopy(e,t,i){var n;if(t!=null&&t.id&&((n=hb._currentCopyOperation)==null?void 0:n.handle)===t.id){const r=await hb._currentCopyOperation.dataTransferPromise;if(i.isCancellationRequested)return;for(const[o,a]of r)e.replace(o,a)}if(!e.has(An.uriList)){const r=await this._clipboardService.readResources();if(i.isCancellationRequested)return;r.length&&e.append(An.uriList,aQ(g5.create(r)))}}async getPasteEdits(e,t,i,n,r,o){const a=new ce,l=await jE(Promise.all(e.map(async d=>{var u,h;try{const g=await((u=d.provideDocumentPasteEdits)==null?void 0:u.call(d,i,n,t,r,o));return g&&a.add(g),(h=g==null?void 0:g.edits)==null?void 0:h.map(p=>({...p,provider:d}))}catch(g){xc(g)||console.error(g);return}})),o),c=rd(l??[]).flat().filter(d=>!r.only||r.only.contains(d.kind));return{edits:l_e(c),dispose:()=>a.dispose()}}async applyDefaultPasteHandler(e,t,i,n){const r=e.get(An.text)??e.get("text"),o=await(r==null?void 0:r.asString())??"";if(i.isCancellationRequested)return;const a={clipboardEvent:n,text:o,pasteOnNewLine:(t==null?void 0:t.defaultPastePayload.pasteOnNewLine)??!1,multicursorText:(t==null?void 0:t.defaultPastePayload.multicursorText)??null,mode:null};this._editor.trigger("keyboard","paste",a)}isSupportedPasteProvider(e,t,i){var n;return(n=e.pasteMimeTypes)!=null&&n.some(r=>t.matches(r))?!i||this.providerMatchesPreference(e,i):!1}providerMatchesPreference(e,t){return t instanceof cn?e.providedPasteEditKinds?e.providedPasteEditKinds.some(i=>t.contains(i)):!0:e.id===t.providerId}},hb=bv,bv.ID="editor.contrib.copyPasteActionController",bv);Dg=hb=yGe([X0(1,Xe),X0(2,ZE),X0(3,Wg),X0(4,Be),X0(5,kc),X0(6,Ufe)],Dg);const kw="9_cutcopypaste",SGe=Th||document.queryCommandSupported("cut"),u_e=Th||document.queryCommandSupported("copy"),xGe=typeof navigator.clipboard>"u"||_c?document.queryCommandSupported("paste"):!0;function hQ(s){return s.register(),s}const LGe=SGe?hQ(new uS({id:"editor.action.clipboardCutAction",precondition:void 0,kbOpts:Th?{primary:2102,win:{primary:2102,secondary:[1044]},weight:100}:void 0,menuOpts:[{menuId:ze.MenubarEditMenu,group:"2_ccp",title:b({key:"miCut",comment:["&& denotes a mnemonic"]},"Cu&&t"),order:1},{menuId:ze.EditorContext,group:kw,title:b("actions.clipboard.cutLabel","Cut"),when:z.writable,order:1},{menuId:ze.CommandPalette,group:"",title:b("actions.clipboard.cutLabel","Cut"),order:1},{menuId:ze.SimpleEditorContext,group:kw,title:b("actions.clipboard.cutLabel","Cut"),when:z.writable,order:1}]})):void 0,kGe=u_e?hQ(new uS({id:"editor.action.clipboardCopyAction",precondition:void 0,kbOpts:Th?{primary:2081,win:{primary:2081,secondary:[2067]},weight:100}:void 0,menuOpts:[{menuId:ze.MenubarEditMenu,group:"2_ccp",title:b({key:"miCopy",comment:["&& denotes a mnemonic"]},"&&Copy"),order:2},{menuId:ze.EditorContext,group:kw,title:b("actions.clipboard.copyLabel","Copy"),order:2},{menuId:ze.CommandPalette,group:"",title:b("actions.clipboard.copyLabel","Copy"),order:1},{menuId:ze.SimpleEditorContext,group:kw,title:b("actions.clipboard.copyLabel","Copy"),order:2}]})):void 0;Os.appendMenuItem(ze.MenubarEditMenu,{submenu:ze.MenubarCopy,title:dt("copy as","Copy As"),group:"2_ccp",order:3});Os.appendMenuItem(ze.EditorContext,{submenu:ze.EditorContextCopy,title:dt("copy as","Copy As"),group:kw,order:3});Os.appendMenuItem(ze.EditorContext,{submenu:ze.EditorContextShare,title:dt("share","Share"),group:"11_share",order:-1,when:he.and(he.notEquals("resourceScheme","output"),z.editorTextFocus)});Os.appendMenuItem(ze.ExplorerContext,{submenu:ze.ExplorerContextShare,title:dt("share","Share"),group:"11_share",order:-1});const CB=xGe?hQ(new uS({id:"editor.action.clipboardPasteAction",precondition:void 0,kbOpts:Th?{primary:2100,win:{primary:2100,secondary:[1043]},linux:{primary:2100,secondary:[1043]},weight:100}:void 0,menuOpts:[{menuId:ze.MenubarEditMenu,group:"2_ccp",title:b({key:"miPaste",comment:["&& denotes a mnemonic"]},"&&Paste"),order:4},{menuId:ze.EditorContext,group:kw,title:b("actions.clipboard.pasteLabel","Paste"),when:z.writable,order:4},{menuId:ze.CommandPalette,group:"",title:b("actions.clipboard.pasteLabel","Paste"),order:1},{menuId:ze.SimpleEditorContext,group:kw,title:b("actions.clipboard.pasteLabel","Paste"),when:z.writable,order:4}]})):void 0;class IGe extends Ve{constructor(){super({id:"editor.action.clipboardCopyWithSyntaxHighlightingAction",label:b("actions.clipboard.copyWithSyntaxHighlightingLabel","Copy With Syntax Highlighting"),alias:"Copy With Syntax Highlighting",precondition:void 0,kbOpts:{kbExpr:z.textInputFocus,primary:0,weight:100}})}run(e,t){!t.hasModel()||!t.getOption(37)&&t.getSelection().isEmpty()||(EH.forceCopyWithSyntaxHighlighting=!0,t.focus(),t.getContainerDomNode().ownerDocument.execCommand("copy"),EH.forceCopyWithSyntaxHighlighting=!1)}}function h_e(s,e){s&&(s.addImplementation(1e4,"code-editor",(t,i)=>{const n=t.get(ni).getFocusedCodeEditor();if(n&&n.hasTextFocus()){const r=n.getOption(37),o=n.getSelection();return o&&o.isEmpty()&&!r||n.getContainerDomNode().ownerDocument.execCommand(e),!0}return!1}),s.addImplementation(0,"generic-dom",(t,i)=>(cS().execCommand(e),!0)))}h_e(LGe,"cut");h_e(kGe,"copy");CB&&(CB.addImplementation(1e4,"code-editor",(s,e)=>{var r;const t=s.get(ni),i=s.get(Wg),n=t.getFocusedCodeEditor();return n&&n.hasTextFocus()?n.getContainerDomNode().ownerDocument.execCommand("paste")?((r=Dg.get(n))==null?void 0:r.finishedPaste())??Promise.resolve():Uw?(async()=>{const a=await i.readText();if(a!==""){const l=HI.INSTANCE.get(a);let c=!1,d=null,u=null;l&&(c=n.getOption(37)&&!!l.isFromEmptySelection,d=typeof l.multicursorText<"u"?l.multicursorText:null,u=l.mode),n.trigger("keyboard","paste",{text:a,pasteOnNewLine:c,multicursorText:d,mode:u})}})():!0:!1}),CB.addImplementation(0,"generic-dom",(s,e)=>(cS().execCommand("paste"),!0)));u_e&&ye(IGe);const en=new class{constructor(){this.QuickFix=new cn("quickfix"),this.Refactor=new cn("refactor"),this.RefactorExtract=this.Refactor.append("extract"),this.RefactorInline=this.Refactor.append("inline"),this.RefactorMove=this.Refactor.append("move"),this.RefactorRewrite=this.Refactor.append("rewrite"),this.Notebook=new cn("notebook"),this.Source=new cn("source"),this.SourceOrganizeImports=this.Source.append("organizeImports"),this.SourceFixAll=this.Source.append("fixAll"),this.SurroundWith=this.Refactor.append("surround")}};var Va;(function(s){s.Refactor="refactor",s.RefactorPreview="refactor preview",s.Lightbulb="lightbulb",s.Default="other (default)",s.SourceAction="source action",s.QuickFix="quick fix action",s.FixAll="fix all",s.OrganizeImports="organize imports",s.AutoFix="auto fix",s.QuickFixHover="quick fix hover window",s.OnSave="save participants",s.ProblemsView="problems view"})(Va||(Va={}));function EGe(s,e){return!(s.include&&!s.include.intersects(e)||s.excludes&&s.excludes.some(t=>f_e(e,t,s.include))||!s.includeSourceActions&&en.Source.contains(e))}function DGe(s,e){const t=e.kind?new cn(e.kind):void 0;return!(s.include&&(!t||!s.include.contains(t))||s.excludes&&t&&s.excludes.some(i=>f_e(t,i,s.include))||!s.includeSourceActions&&t&&en.Source.contains(t)||s.onlyIncludePreferredActions&&!e.isPreferred)}function f_e(s,e,t){return!(!e.contains(s)||t&&e.contains(t))}class uh{static fromUser(e,t){return!e||typeof e!="object"?new uh(t.kind,t.apply,!1):new uh(uh.getKindFromUser(e,t.kind),uh.getApplyFromUser(e,t.apply),uh.getPreferredUser(e))}static getApplyFromUser(e,t){switch(typeof e.apply=="string"?e.apply.toLowerCase():""){case"first":return"first";case"never":return"never";case"ifsingle":return"ifSingle";default:return t}}static getKindFromUser(e,t){return typeof e.kind=="string"?new cn(e.kind):t}static getPreferredUser(e){return typeof e.preferred=="boolean"?e.preferred:!1}constructor(e,t,i){this.kind=e,this.apply=t,this.preferred=i}}class TGe{constructor(e,t,i){this.action=e,this.provider=t,this.highlightRange=i}async resolve(e){var t;if((t=this.provider)!=null&&t.resolveCodeAction&&!this.action.edit){let i;try{i=await this.provider.resolveCodeAction(this.action,e)}catch(n){Mn(n)}i&&(this.action.edit=i.edit)}return this}}const g_e="editor.action.codeAction",fQ="editor.action.quickFix",p_e="editor.action.autoFix",m_e="editor.action.refactor",__e="editor.action.sourceAction",xz="editor.action.organizeImports",Lz="editor.action.fixAll";class sk extends te{static codeActionsPreferredComparator(e,t){return e.isPreferred&&!t.isPreferred?-1:!e.isPreferred&&t.isPreferred?1:0}static codeActionsComparator({action:e},{action:t}){return e.isAI&&!t.isAI?1:!e.isAI&&t.isAI?-1:Xr(e.diagnostics)?Xr(t.diagnostics)?sk.codeActionsPreferredComparator(e,t):-1:Xr(t.diagnostics)?1:sk.codeActionsPreferredComparator(e,t)}constructor(e,t,i){super(),this.documentation=t,this._register(i),this.allActions=[...e].sort(sk.codeActionsComparator),this.validActions=this.allActions.filter(({action:n})=>!n.disabled)}get hasAutoFix(){return this.validActions.some(({action:e})=>!!e.kind&&en.QuickFix.contains(new cn(e.kind))&&!!e.isPreferred)}get hasAIFix(){return this.validActions.some(({action:e})=>!!e.isAI)}get allAIFixes(){return this.validActions.every(({action:e})=>!!e.isAI)}}const Tre={actions:[],documentation:void 0};async function BC(s,e,t,i,n,r){var _;const o=i.filter||{},a={...o,excludes:[...o.excludes||[],en.Notebook]},l={only:(_=o.include)==null?void 0:_.value,trigger:i.type},c=new tQ(e,r),d=i.type===2,u=NGe(s,e,d?a:o),h=new ce,g=u.map(async v=>{try{n.report(v);const C=await v.provideCodeActions(e,t,l,c.token);if(C&&h.add(C),c.token.isCancellationRequested)return Tre;const y=((C==null?void 0:C.actions)||[]).filter(L=>L&&DGe(o,L)),x=AGe(v,y,o.include);return{actions:y.map(L=>new TGe(L,v)),documentation:x}}catch(C){if(xc(C))throw C;return Mn(C),Tre}}),p=s.onDidChange(()=>{const v=s.all(e);dn(v,u)||c.cancel()});try{const v=await Promise.all(g),C=v.map(x=>x.actions).flat(),y=[...rd(v.map(x=>x.documentation)),...RGe(s,e,i,C)];return new sk(C,y,h)}finally{p.dispose(),c.dispose()}}function NGe(s,e,t){return s.all(e).filter(i=>i.providedCodeActionKinds?i.providedCodeActionKinds.some(n=>EGe(t,new cn(n))):!0)}function*RGe(s,e,t,i){var n,r,o;if(e&&i.length)for(const a of s.all(e))a._getAdditionalMenuItems&&(yield*(o=a._getAdditionalMenuItems)==null?void 0:o.call(a,{trigger:t.type,only:(r=(n=t.filter)==null?void 0:n.include)==null?void 0:r.value},i.map(l=>l.action)))}function AGe(s,e,t){if(!s.documentation)return;const i=s.documentation.map(n=>({kind:new cn(n.kind),command:n.command}));if(t){let n;for(const r of i)r.kind.contains(t)&&(n?n.kind.contains(r.kind)&&(n=r):n=r);if(n)return n==null?void 0:n.command}for(const n of e)if(n.kind){for(const r of i)if(r.kind.contains(new cn(n.kind)))return r.command}}var Ub;(function(s){s.OnSave="onSave",s.FromProblemsView="fromProblemsView",s.FromCodeActions="fromCodeActions",s.FromAILightbulb="fromAILightbulb"})(Ub||(Ub={}));async function PGe(s,e,t,i,n=kt.None){var c;const r=s.get(ZE),o=s.get(Hi),a=s.get(Tr),l=s.get(jn);if(a.publicLog2("codeAction.applyCodeAction",{codeActionTitle:e.action.title,codeActionKind:e.action.kind,codeActionIsPreferred:!!e.action.isPreferred,reason:t}),await e.resolve(n),!n.isCancellationRequested&&!((c=e.action.edit)!=null&&c.edits.length&&!(await r.apply(e.action.edit,{editor:i==null?void 0:i.editor,label:e.action.title,quotableLabel:e.action.title,code:"undoredo.codeAction",respectAutoSaveConfig:t!==Ub.OnSave,showPreview:i==null?void 0:i.preview})).isApplied)&&e.action.command)try{await o.executeCommand(e.action.command.id,...e.action.command.arguments||[])}catch(d){const u=MGe(d);l.error(typeof u=="string"?u:b("applyCodeActionFailed","An unknown error occurred while applying the code action"))}}function MGe(s){return typeof s=="string"?s:s instanceof Error&&typeof s.message=="string"?s.message:void 0}Gt.registerCommand("_executeCodeActionProvider",async function(s,e,t,i,n){if(!(e instanceof Je))throw fc();const{codeActionProvider:r}=s.get(Be),o=s.get(Gi).getModel(e);if(!o)throw fc();const a=Ue.isISelection(t)?Ue.liftSelection(t):F.isIRange(t)?o.validateRange(t):void 0;if(!a)throw fc();const l=typeof i=="string"?new cn(i):void 0,c=await BC(r,o,a,{type:1,triggerAction:Va.Default,filter:{includeSourceActions:!0,include:l}},Zd.None,kt.None),d=[],u=Math.min(c.validActions.length,typeof n=="number"?n:0);for(let h=0;h<u;h++)d.push(c.validActions[h].resolve(kt.None));try{return await Promise.all(d),c.validActions.map(h=>h.action)}finally{setTimeout(()=>c.dispose(),100)}});var OGe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},FGe=function(s,e){return function(t,i){e(t,i,s)}},kz,vv;let Iz=(vv=class{constructor(e){this.keybindingService=e}getResolver(){const e=new uu(()=>this.keybindingService.getKeybindings().filter(t=>kz.codeActionCommands.indexOf(t.command)>=0).filter(t=>t.resolvedKeybinding).map(t=>{let i=t.commandArgs;return t.command===xz?i={kind:en.SourceOrganizeImports.value}:t.command===Lz&&(i={kind:en.SourceFixAll.value}),{resolvedKeybinding:t.resolvedKeybinding,...uh.fromUser(i,{kind:cn.None,apply:"never"})}}));return t=>{if(t.kind){const i=this.bestKeybindingForCodeAction(t,e.value);return i==null?void 0:i.resolvedKeybinding}}}bestKeybindingForCodeAction(e,t){if(!e.kind)return;const i=new cn(e.kind);return t.filter(n=>n.kind.contains(i)).filter(n=>n.preferred?e.isPreferred:!0).reduceRight((n,r)=>n?n.kind.contains(r.kind)?r:n:r,void 0)}},kz=vv,vv.codeActionCommands=[m_e,g_e,__e,xz,Lz],vv);Iz=kz=OGe([FGe(0,pi)],Iz);j("symbolIcon.arrayForeground",Ot,b("symbolIcon.arrayForeground","The foreground color for array symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));j("symbolIcon.booleanForeground",Ot,b("symbolIcon.booleanForeground","The foreground color for boolean symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));j("symbolIcon.classForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},b("symbolIcon.classForeground","The foreground color for class symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));j("symbolIcon.colorForeground",Ot,b("symbolIcon.colorForeground","The foreground color for color symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));j("symbolIcon.constantForeground",Ot,b("symbolIcon.constantForeground","The foreground color for constant symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));j("symbolIcon.constructorForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},b("symbolIcon.constructorForeground","The foreground color for constructor symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));j("symbolIcon.enumeratorForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},b("symbolIcon.enumeratorForeground","The foreground color for enumerator symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));j("symbolIcon.enumeratorMemberForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},b("symbolIcon.enumeratorMemberForeground","The foreground color for enumerator member symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));j("symbolIcon.eventForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},b("symbolIcon.eventForeground","The foreground color for event symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));j("symbolIcon.fieldForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},b("symbolIcon.fieldForeground","The foreground color for field symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));j("symbolIcon.fileForeground",Ot,b("symbolIcon.fileForeground","The foreground color for file symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));j("symbolIcon.folderForeground",Ot,b("symbolIcon.folderForeground","The foreground color for folder symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));j("symbolIcon.functionForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},b("symbolIcon.functionForeground","The foreground color for function symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));j("symbolIcon.interfaceForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},b("symbolIcon.interfaceForeground","The foreground color for interface symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));j("symbolIcon.keyForeground",Ot,b("symbolIcon.keyForeground","The foreground color for key symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));j("symbolIcon.keywordForeground",Ot,b("symbolIcon.keywordForeground","The foreground color for keyword symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));j("symbolIcon.methodForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},b("symbolIcon.methodForeground","The foreground color for method symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));j("symbolIcon.moduleForeground",Ot,b("symbolIcon.moduleForeground","The foreground color for module symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));j("symbolIcon.namespaceForeground",Ot,b("symbolIcon.namespaceForeground","The foreground color for namespace symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));j("symbolIcon.nullForeground",Ot,b("symbolIcon.nullForeground","The foreground color for null symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));j("symbolIcon.numberForeground",Ot,b("symbolIcon.numberForeground","The foreground color for number symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));j("symbolIcon.objectForeground",Ot,b("symbolIcon.objectForeground","The foreground color for object symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));j("symbolIcon.operatorForeground",Ot,b("symbolIcon.operatorForeground","The foreground color for operator symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));j("symbolIcon.packageForeground",Ot,b("symbolIcon.packageForeground","The foreground color for package symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));j("symbolIcon.propertyForeground",Ot,b("symbolIcon.propertyForeground","The foreground color for property symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));j("symbolIcon.referenceForeground",Ot,b("symbolIcon.referenceForeground","The foreground color for reference symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));j("symbolIcon.snippetForeground",Ot,b("symbolIcon.snippetForeground","The foreground color for snippet symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));j("symbolIcon.stringForeground",Ot,b("symbolIcon.stringForeground","The foreground color for string symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));j("symbolIcon.structForeground",Ot,b("symbolIcon.structForeground","The foreground color for struct symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));j("symbolIcon.textForeground",Ot,b("symbolIcon.textForeground","The foreground color for text symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));j("symbolIcon.typeParameterForeground",Ot,b("symbolIcon.typeParameterForeground","The foreground color for type parameter symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));j("symbolIcon.unitForeground",Ot,b("symbolIcon.unitForeground","The foreground color for unit symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));j("symbolIcon.variableForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},b("symbolIcon.variableForeground","The foreground color for variable symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));const b_e=Object.freeze({kind:cn.Empty,title:b("codeAction.widget.id.more","More Actions...")}),VGe=Object.freeze([{kind:en.QuickFix,title:b("codeAction.widget.id.quickfix","Quick Fix")},{kind:en.RefactorExtract,title:b("codeAction.widget.id.extract","Extract"),icon:xe.wrench},{kind:en.RefactorInline,title:b("codeAction.widget.id.inline","Inline"),icon:xe.wrench},{kind:en.RefactorRewrite,title:b("codeAction.widget.id.convert","Rewrite"),icon:xe.wrench},{kind:en.RefactorMove,title:b("codeAction.widget.id.move","Move"),icon:xe.wrench},{kind:en.SurroundWith,title:b("codeAction.widget.id.surround","Surround With"),icon:xe.surroundWith},{kind:en.Source,title:b("codeAction.widget.id.source","Source Action"),icon:xe.symbolFile},b_e]);function BGe(s,e,t){if(!e)return s.map(r=>{var o;return{kind:"action",item:r,group:b_e,disabled:!!r.action.disabled,label:r.action.disabled||r.action.title,canPreview:!!((o=r.action.edit)!=null&&o.edits.length)}});const i=VGe.map(r=>({group:r,actions:[]}));for(const r of s){const o=r.action.kind?new cn(r.action.kind):cn.None;for(const a of i)if(a.group.kind.contains(o)){a.actions.push(r);break}}const n=[];for(const r of i)if(r.actions.length){n.push({kind:"header",group:r.group});for(const o of r.actions){const a=r.group;n.push({kind:"action",item:o,group:o.action.isAI?{title:a.title,kind:a.kind,icon:xe.sparkle}:a,label:o.action.title,disabled:!!o.action.disabled,keybinding:t(o.action)})}}return n}var WGe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},HGe=function(s,e){return function(t,i){e(t,i,s)}},pC;const Nre=Qi("gutter-lightbulb",xe.lightBulb,b("gutterLightbulbWidget","Icon which spawns code actions menu from the gutter when there is no space in the editor.")),Rre=Qi("gutter-lightbulb-auto-fix",xe.lightbulbAutofix,b("gutterLightbulbAutoFixWidget","Icon which spawns code actions menu from the gutter when there is no space in the editor and a quick fix is available.")),Are=Qi("gutter-lightbulb-sparkle",xe.lightbulbSparkle,b("gutterLightbulbAIFixWidget","Icon which spawns code actions menu from the gutter when there is no space in the editor and an AI fix is available.")),Pre=Qi("gutter-lightbulb-aifix-auto-fix",xe.lightbulbSparkleAutofix,b("gutterLightbulbAIFixAutoFixWidget","Icon which spawns code actions menu from the gutter when there is no space in the editor and an AI fix and a quick fix is available.")),Mre=Qi("gutter-lightbulb-sparkle-filled",xe.sparkleFilled,b("gutterLightbulbSparkleFilledWidget","Icon which spawns code actions menu from the gutter when there is no space in the editor and an AI fix and a quick fix is available."));var Vd;(function(s){s.Hidden={type:0};class e{constructor(i,n,r,o){this.actions=i,this.trigger=n,this.editorPosition=r,this.widgetPosition=o,this.type=1}}s.Showing=e})(Vd||(Vd={}));var ig;let tE=(ig=class extends te{constructor(e,t){super(),this._editor=e,this._keybindingService=t,this._onClick=this._register(new Z),this.onClick=this._onClick.event,this._state=Vd.Hidden,this._gutterState=Vd.Hidden,this._iconClasses=[],this.lightbulbClasses=["codicon-"+Nre.id,"codicon-"+Pre.id,"codicon-"+Rre.id,"codicon-"+Are.id,"codicon-"+Mre.id],this.gutterDecoration=pC.GUTTER_DECORATION,this._domNode=ke("div.lightBulbWidget"),this._domNode.role="listbox",this._register(Er.ignoreTarget(this._domNode)),this._editor.addContentWidget(this),this._register(this._editor.onDidChangeModelContent(i=>{const n=this._editor.getModel();(this.state.type!==1||!n||this.state.editorPosition.lineNumber>=n.getLineCount())&&this.hide(),(this.gutterState.type!==1||!n||this.gutterState.editorPosition.lineNumber>=n.getLineCount())&&this.gutterHide()})),this._register($2e(this._domNode,i=>{if(this.state.type!==1)return;this._editor.focus(),i.preventDefault();const{top:n,height:r}=Pn(this._domNode),o=this._editor.getOption(67);let a=Math.floor(o/3);this.state.widgetPosition.position!==null&&this.state.widgetPosition.position.lineNumber<this.state.editorPosition.lineNumber&&(a+=o),this._onClick.fire({x:i.posx,y:n+r+a,actions:this.state.actions,trigger:this.state.trigger})})),this._register(oe(this._domNode,"mouseenter",i=>{(i.buttons&1)===1&&this.hide()})),this._register(De.runAndSubscribe(this._keybindingService.onDidUpdateKeybindings,()=>{var i,n;this._preferredKbLabel=((i=this._keybindingService.lookupKeybinding(p_e))==null?void 0:i.getLabel())??void 0,this._quickFixKbLabel=((n=this._keybindingService.lookupKeybinding(fQ))==null?void 0:n.getLabel())??void 0,this._updateLightBulbTitleAndIcon()})),this._register(this._editor.onMouseDown(async i=>{if(!i.target.element||!this.lightbulbClasses.some(l=>i.target.element&&i.target.element.classList.contains(l))||this.gutterState.type!==1)return;this._editor.focus();const{top:n,height:r}=Pn(i.target.element),o=this._editor.getOption(67);let a=Math.floor(o/3);this.gutterState.widgetPosition.position!==null&&this.gutterState.widgetPosition.position.lineNumber<this.gutterState.editorPosition.lineNumber&&(a+=o),this._onClick.fire({x:i.event.posx,y:n+r+a,actions:this.gutterState.actions,trigger:this.gutterState.trigger})}))}dispose(){super.dispose(),this._editor.removeContentWidget(this),this._gutterDecorationID&&this._removeGutterDecoration(this._gutterDecorationID)}getId(){return"LightBulbWidget"}getDomNode(){return this._domNode}getPosition(){return this._state.type===1?this._state.widgetPosition:null}update(e,t,i){if(e.validActions.length<=0)return this.gutterHide(),this.hide();if(!this._editor.hasTextFocus())return this.gutterHide(),this.hide();if(!this._editor.getOptions().get(65).enabled)return this.gutterHide(),this.hide();const o=this._editor.getModel();if(!o)return this.gutterHide(),this.hide();const{lineNumber:a,column:l}=o.validatePosition(i),c=o.getOptions().tabSize,d=this._editor.getOptions().get(50),u=o.getLineContent(a),h=jF(u,c),g=d.spaceWidth*h>22,p=I=>I>2&&this._editor.getTopForLineNumber(I)===this._editor.getTopForLineNumber(I-1),_=this._editor.getLineDecorations(a);let v=!1;if(_)for(const I of _){const A=I.options.glyphMarginClassName;if(A&&!this.lightbulbClasses.some(D=>A.includes(D))){v=!0;break}}let C=a,y=1;if(!g){const I=A=>{const D=o.getLineContent(A);return/^\s*$|^\s+/.test(D)||D.length<=y};if(a>1&&!p(a-1)){const A=o.getLineCount(),D=a===A,N=a>1&&I(a-1),R=!D&&I(a+1),W=I(a),H=!R&&!N;if(!R&&!N&&!v)return this.gutterState=new Vd.Showing(e,t,i,{position:{lineNumber:C,column:y},preference:pC._posPref}),this.renderGutterLightbub(),this.hide();N||D||N&&!W?C-=1:(R||H&&W)&&(C+=1)}else if(a===1&&(a===o.getLineCount()||!I(a+1)&&!I(a)))if(this.gutterState=new Vd.Showing(e,t,i,{position:{lineNumber:C,column:y},preference:pC._posPref}),v)this.gutterHide();else return this.renderGutterLightbub(),this.hide();else if(a<o.getLineCount()&&!p(a+1))C+=1;else if(l*d.spaceWidth<22)return this.hide();y=/^\S\s*$/.test(o.getLineContent(C))?2:1}this.state=new Vd.Showing(e,t,i,{position:{lineNumber:C,column:y},preference:pC._posPref}),this._gutterDecorationID&&(this._removeGutterDecoration(this._gutterDecorationID),this.gutterHide());const x=e.validActions,L=e.validActions[0].action.kind;if(x.length!==1||!L){this._editor.layoutContentWidget(this);return}this._editor.layoutContentWidget(this)}hide(){this.state!==Vd.Hidden&&(this.state=Vd.Hidden,this._editor.layoutContentWidget(this))}gutterHide(){this.gutterState!==Vd.Hidden&&(this._gutterDecorationID&&this._removeGutterDecoration(this._gutterDecorationID),this.gutterState=Vd.Hidden)}get state(){return this._state}set state(e){this._state=e,this._updateLightBulbTitleAndIcon()}get gutterState(){return this._gutterState}set gutterState(e){this._gutterState=e,this._updateGutterLightBulbTitleAndIcon()}_updateLightBulbTitleAndIcon(){if(this._domNode.classList.remove(...this._iconClasses),this._iconClasses=[],this.state.type!==1)return;let e,t=!1;this.state.actions.allAIFixes?(e=xe.sparkleFilled,this.state.actions.validActions.length===1&&(t=!0)):this.state.actions.hasAutoFix?this.state.actions.hasAIFix?e=xe.lightbulbSparkleAutofix:e=xe.lightbulbAutofix:this.state.actions.hasAIFix?e=xe.lightbulbSparkle:e=xe.lightBulb,this._updateLightbulbTitle(this.state.actions.hasAutoFix,t),this._iconClasses=at.asClassNameArray(e),this._domNode.classList.add(...this._iconClasses)}_updateGutterLightBulbTitleAndIcon(){if(this.gutterState.type!==1)return;let e,t=!1;this.gutterState.actions.allAIFixes?(e=Mre,this.gutterState.actions.validActions.length===1&&(t=!0)):this.gutterState.actions.hasAutoFix?this.gutterState.actions.hasAIFix?e=Pre:e=Rre:this.gutterState.actions.hasAIFix?e=Are:e=Nre,this._updateLightbulbTitle(this.gutterState.actions.hasAutoFix,t);const i=_t.register({description:"codicon-gutter-lightbulb-decoration",glyphMarginClassName:at.asClassName(e),glyphMargin:{position:ld.Left},stickiness:1});this.gutterDecoration=i}renderGutterLightbub(){const e=this._editor.getSelection();e&&(this._gutterDecorationID===void 0?this._addGutterDecoration(e.startLineNumber):this._updateGutterDecoration(this._gutterDecorationID,e.startLineNumber))}_addGutterDecoration(e){this._editor.changeDecorations(t=>{this._gutterDecorationID=t.addDecoration(new F(e,0,e,0),this.gutterDecoration)})}_removeGutterDecoration(e){this._editor.changeDecorations(t=>{t.removeDecoration(e),this._gutterDecorationID=void 0})}_updateGutterDecoration(e,t){this._editor.changeDecorations(i=>{i.changeDecoration(e,new F(t,0,t,0)),i.changeDecorationOptions(e,this.gutterDecoration)})}_updateLightbulbTitle(e,t){this.state.type===1&&(t?this.title=b("codeActionAutoRun","Run: {0}",this.state.actions.validActions[0].action.title):e&&this._preferredKbLabel?this.title=b("preferredcodeActionWithKb","Show Code Actions. Preferred Quick Fix Available ({0})",this._preferredKbLabel):!e&&this._quickFixKbLabel?this.title=b("codeActionWithKb","Show Code Actions ({0})",this._quickFixKbLabel):e||(this.title=b("codeAction","Show Code Actions")))}set title(e){this._domNode.title=e}},pC=ig,ig.GUTTER_DECORATION=_t.register({description:"codicon-gutter-lightbulb-decoration",glyphMarginClassName:at.asClassName(xe.lightBulb),glyphMargin:{position:ld.Left},stickiness:1}),ig.ID="editor.contrib.lightbulbWidget",ig._posPref=[0],ig);tE=pC=WGe([HGe(1,pi)],tE);var v_e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Ez=function(s,e){return function(t,i){e(t,i,s)}};const w_e="acceptSelectedCodeAction",C_e="previewSelectedCodeAction";class zGe{get templateId(){return"header"}renderTemplate(e){e.classList.add("group-header");const t=document.createElement("span");return e.append(t),{container:e,text:t}}renderElement(e,t,i){var n;i.text.textContent=((n=e.group)==null?void 0:n.title)??""}disposeTemplate(e){}}let Dz=class{get templateId(){return"action"}constructor(e,t){this._supportsPreview=e,this._keybindingService=t}renderTemplate(e){e.classList.add(this.templateId);const t=document.createElement("div");t.className="icon",e.append(t);const i=document.createElement("span");i.className="title",e.append(i);const n=new SS(e,Da);return{container:e,icon:t,text:i,keybinding:n}}renderElement(e,t,i){var o,a,l;if((o=e.group)!=null&&o.icon?(i.icon.className=at.asClassName(e.group.icon),e.group.icon.color&&(i.icon.style.color=Fe(e.group.icon.color.id))):(i.icon.className=at.asClassName(xe.lightBulb),i.icon.style.color="var(--vscode-editorLightBulb-foreground)"),!e.item||!e.label)return;i.text.textContent=y_e(e.label),i.keybinding.set(e.keybinding),oAe(!!e.keybinding,i.keybinding.element);const n=(a=this._keybindingService.lookupKeybinding(w_e))==null?void 0:a.getLabel(),r=(l=this._keybindingService.lookupKeybinding(C_e))==null?void 0:l.getLabel();i.container.classList.toggle("option-disabled",e.disabled),e.disabled?i.container.title=e.label:n&&r?this._supportsPreview&&e.canPreview?i.container.title=b({key:"label-preview",comment:['placeholders are keybindings, e.g "F2 to Apply, Shift+F2 to Preview"']},"{0} to Apply, {1} to Preview",n,r):i.container.title=b({key:"label",comment:['placeholder is a keybinding, e.g "F2 to Apply"']},"{0} to Apply",n):i.container.title=""}disposeTemplate(e){e.keybinding.dispose()}};Dz=v_e([Ez(1,pi)],Dz);class UGe extends UIEvent{constructor(){super("acceptSelectedAction")}}class Ore extends UIEvent{constructor(){super("previewSelectedAction")}}function jGe(s){if(s.kind==="action")return s.label}let Tz=class extends te{constructor(e,t,i,n,r,o){super(),this._delegate=n,this._contextViewService=r,this._keybindingService=o,this._actionLineHeight=24,this._headerLineHeight=26,this.cts=this._register(new mn),this.domNode=document.createElement("div"),this.domNode.classList.add("actionList");const a={getHeight:l=>l.kind==="header"?this._headerLineHeight:this._actionLineHeight,getTemplateId:l=>l.kind};this._list=this._register(new Bl(e,this.domNode,a,[new Dz(t,this._keybindingService),new zGe],{keyboardSupport:!1,typeNavigationEnabled:!0,keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:jGe},accessibilityProvider:{getAriaLabel:l=>{if(l.kind==="action"){let c=l.label?y_e(l==null?void 0:l.label):"";return l.disabled&&(c=b({key:"customQuickFixWidget.labels",comment:["Action widget labels for accessibility."]},"{0}, Disabled Reason: {1}",c,l.disabled)),c}return null},getWidgetAriaLabel:()=>b({key:"customQuickFixWidget",comment:["An action widget option"]},"Action Widget"),getRole:l=>l.kind==="action"?"option":"separator",getWidgetRole:()=>"listbox"}})),this._list.style(Gw),this._register(this._list.onMouseClick(l=>this.onListClick(l))),this._register(this._list.onMouseOver(l=>this.onListHover(l))),this._register(this._list.onDidChangeFocus(()=>this.onFocus())),this._register(this._list.onDidChangeSelection(l=>this.onListSelection(l))),this._allMenuItems=i,this._list.splice(0,this._list.length,this._allMenuItems),this._list.length&&this.focusNext()}focusCondition(e){return!e.disabled&&e.kind==="action"}hide(e){this._delegate.onHide(e),this.cts.cancel(),this._contextViewService.hideContextView()}layout(e){const t=this._allMenuItems.filter(l=>l.kind==="header").length,n=this._allMenuItems.length*this._actionLineHeight+t*this._headerLineHeight-t*this._actionLineHeight;this._list.layout(n);let r=e;if(this._allMenuItems.length>=50)r=380;else{const l=this._allMenuItems.map((c,d)=>{const u=this.domNode.ownerDocument.getElementById(this._list.getElementID(d));if(u){u.style.width="auto";const h=u.getBoundingClientRect().width;return u.style.width="",h}return 0});r=Math.max(...l,e)}const a=Math.min(n,this.domNode.ownerDocument.body.clientHeight*.7);return this._list.layout(a,r),this.domNode.style.height=`${a}px`,this._list.domFocus(),r}focusPrevious(){this._list.focusPrevious(1,!0,void 0,this.focusCondition)}focusNext(){this._list.focusNext(1,!0,void 0,this.focusCondition)}acceptSelected(e){const t=this._list.getFocus();if(t.length===0)return;const i=t[0],n=this._list.element(i);if(!this.focusCondition(n))return;const r=e?new Ore:new UGe;this._list.setSelection([i],r)}onListSelection(e){if(!e.elements.length)return;const t=e.elements[0];t.item&&this.focusCondition(t)?this._delegate.onSelect(t.item,e.browserEvent instanceof Ore):this._list.setSelection([])}onFocus(){var n,r;const e=this._list.getFocus();if(e.length===0)return;const t=e[0],i=this._list.element(t);(r=(n=this._delegate).onFocus)==null||r.call(n,i.item)}async onListHover(e){const t=e.element;if(t&&t.item&&this.focusCondition(t)){if(this._delegate.onHover&&!t.disabled&&t.kind==="action"){const i=await this._delegate.onHover(t.item,this.cts.token);t.canPreview=i?i.canPreview:void 0}e.index&&this._list.splice(e.index,1,[t])}this._list.setFocus(typeof e.index=="number"?[e.index]:[])}onListClick(e){e.element&&this.focusCondition(e.element)&&this._list.setFocus([])}};Tz=v_e([Ez(4,Fg),Ez(5,pi)],Tz);function y_e(s){return s.replace(/\r\n|\r|\n/g," ")}var $Ge=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},yB=function(s,e){return function(t,i){e(t,i,s)}};j("actionBar.toggledBackground",GE,b("actionBar.toggledBackground","Background color for toggled action items in action bar."));const Iw={Visible:new Oe("codeActionMenuVisible",!1,b("codeActionMenuVisible","Whether the action widget list is visible"))},t0=Ht("actionWidgetService");let Ew=class extends te{get isVisible(){return Iw.Visible.getValue(this._contextKeyService)||!1}constructor(e,t,i){super(),this._contextViewService=e,this._contextKeyService=t,this._instantiationService=i,this._list=this._register(new Es)}show(e,t,i,n,r,o,a){const l=Iw.Visible.bindTo(this._contextKeyService),c=this._instantiationService.createInstance(Tz,e,t,i,n);this._contextViewService.showContextView({getAnchor:()=>r,render:d=>(l.set(!0),this._renderWidget(d,c,a??[])),onHide:d=>{l.reset(),this._onWidgetClosed(d)}},o,!1)}acceptSelected(e){var t;(t=this._list.value)==null||t.acceptSelected(e)}focusPrevious(){var e,t;(t=(e=this._list)==null?void 0:e.value)==null||t.focusPrevious()}focusNext(){var e,t;(t=(e=this._list)==null?void 0:e.value)==null||t.focusNext()}hide(e){var t;(t=this._list.value)==null||t.hide(e),this._list.clear()}_renderWidget(e,t,i){var g;const n=document.createElement("div");if(n.classList.add("action-widget"),e.appendChild(n),this._list.value=t,this._list.value)n.appendChild(this._list.value.domNode);else throw new Error("List has no value");const r=new ce,o=document.createElement("div"),a=e.appendChild(o);a.classList.add("context-view-block"),r.add(oe(a,Le.MOUSE_DOWN,p=>p.stopPropagation()));const l=document.createElement("div"),c=e.appendChild(l);c.classList.add("context-view-pointerBlock"),r.add(oe(c,Le.POINTER_MOVE,()=>c.remove())),r.add(oe(c,Le.MOUSE_DOWN,()=>c.remove()));let d=0;if(i.length){const p=this._createActionBar(".action-widget-action-bar",i);p&&(n.appendChild(p.getContainer().parentElement),r.add(p),d=p.getContainer().offsetWidth)}const u=(g=this._list.value)==null?void 0:g.layout(d);n.style.width=`${u}px`;const h=r.add(hu(e));return r.add(h.onDidBlur(()=>this.hide(!0))),r}_createActionBar(e,t){if(!t.length)return;const i=ke(e),n=new Dl(i);return n.push(t,{icon:!1,label:!0}),n}_onWidgetClosed(e){var t;(t=this._list.value)==null||t.hide(e)}};Ew=$Ge([yB(0,Fg),yB(1,ct),yB(2,Xe)],Ew);qt(t0,Ew,1);const _D=1100;Oi(class extends To{constructor(){super({id:"hideCodeActionWidget",title:dt("hideCodeActionWidget.title","Hide action widget"),precondition:Iw.Visible,keybinding:{weight:_D,primary:9,secondary:[1033]}})}run(s){s.get(t0).hide(!0)}});Oi(class extends To{constructor(){super({id:"selectPrevCodeAction",title:dt("selectPrevCodeAction.title","Select previous action"),precondition:Iw.Visible,keybinding:{weight:_D,primary:16,secondary:[2064],mac:{primary:16,secondary:[2064,302]}}})}run(s){const e=s.get(t0);e instanceof Ew&&e.focusPrevious()}});Oi(class extends To{constructor(){super({id:"selectNextCodeAction",title:dt("selectNextCodeAction.title","Select next action"),precondition:Iw.Visible,keybinding:{weight:_D,primary:18,secondary:[2066],mac:{primary:18,secondary:[2066,300]}}})}run(s){const e=s.get(t0);e instanceof Ew&&e.focusNext()}});Oi(class extends To{constructor(){super({id:w_e,title:dt("acceptSelected.title","Accept selected action"),precondition:Iw.Visible,keybinding:{weight:_D,primary:3,secondary:[2137]}})}run(s){const e=s.get(t0);e instanceof Ew&&e.acceptSelected()}});Oi(class extends To{constructor(){super({id:C_e,title:dt("previewSelected.title","Preview selected action"),precondition:Iw.Visible,keybinding:{weight:_D,primary:2051}})}run(s){const e=s.get(t0);e instanceof Ew&&e.acceptSelected(!0)}});const S_e=new Oe("supportedCodeAction",""),Fre="_typescript.applyFixAllCodeAction";class qGe extends te{constructor(e,t,i,n=250){super(),this._editor=e,this._markerService=t,this._signalChange=i,this._delay=n,this._autoTriggerTimer=this._register(new gd),this._register(this._markerService.onMarkerChanged(r=>this._onMarkerChanges(r))),this._register(this._editor.onDidChangeCursorPosition(()=>this._tryAutoTrigger()))}trigger(e){const t=this._getRangeOfSelectionUnlessWhitespaceEnclosed(e);this._signalChange(t?{trigger:e,selection:t}:void 0)}_onMarkerChanges(e){const t=this._editor.getModel();t&&e.some(i=>wI(i,t.uri))&&this._tryAutoTrigger()}_tryAutoTrigger(){this._autoTriggerTimer.cancelAndSet(()=>{this.trigger({type:2,triggerAction:Va.Default})},this._delay)}_getRangeOfSelectionUnlessWhitespaceEnclosed(e){if(!this._editor.hasModel())return;const t=this._editor.getSelection();if(e.type===1)return t;const i=this._editor.getOption(65).enabled;if(i!==qc.Off){{if(i===qc.On)return t;if(i===qc.OnCode){if(!t.isEmpty())return t;const r=this._editor.getModel(),{lineNumber:o,column:a}=t.getPosition(),l=r.getLineContent(o);if(l.length===0)return;if(a===1){if(/\s/.test(l[0]))return}else if(a===r.getLineMaxColumn(o)){if(/\s/.test(l[l.length-1]))return}else if(/\s/.test(l[a-2])&&/\s/.test(l[a-1]))return}}return t}}}var Ib;(function(s){s.Empty={type:0};class e{constructor(i,n,r){this.trigger=i,this.position=n,this._cancellablePromise=r,this.type=1,this.actions=r.catch(o=>{if(xc(o))return x_e;throw o})}cancel(){this._cancellablePromise.cancel()}}s.Triggered=e})(Ib||(Ib={}));const x_e=Object.freeze({allActions:[],validActions:[],dispose:()=>{},documentation:[],hasAutoFix:!1,hasAIFix:!1,allAIFixes:!1});class KGe extends te{constructor(e,t,i,n,r,o,a){super(),this._editor=e,this._registry=t,this._markerService=i,this._progressService=r,this._configurationService=o,this._telemetryService=a,this._codeActionOracle=this._register(new Es),this._state=Ib.Empty,this._onDidChangeState=this._register(new Z),this.onDidChangeState=this._onDidChangeState.event,this._disposed=!1,this._supportedCodeActions=S_e.bindTo(n),this._register(this._editor.onDidChangeModel(()=>this._update())),this._register(this._editor.onDidChangeModelLanguage(()=>this._update())),this._register(this._registry.onDidChange(()=>this._update())),this._register(this._editor.onDidChangeConfiguration(l=>{l.hasChanged(65)&&this._update()})),this._update()}dispose(){this._disposed||(this._disposed=!0,super.dispose(),this.setState(Ib.Empty,!0))}_settingEnabledNearbyQuickfixes(){var t;const e=(t=this._editor)==null?void 0:t.getModel();return this._configurationService?this._configurationService.getValue("editor.codeActionWidget.includeNearbyQuickFixes",{resource:e==null?void 0:e.uri}):!1}_update(){if(this._disposed)return;this._codeActionOracle.value=void 0,this.setState(Ib.Empty);const e=this._editor.getModel();if(e&&this._registry.has(e)&&!this._editor.getOption(92)){const t=this._registry.all(e).flatMap(i=>i.providedCodeActionKinds??[]);this._supportedCodeActions.set(t.join(" ")),this._codeActionOracle.value=new qGe(this._editor,this._markerService,i=>{var l;if(!i){this.setState(Ib.Empty);return}const n=i.selection.getStartPosition(),r=xs(async c=>{var d,u,h,g,p,_,v,C,y,x;if(this._settingEnabledNearbyQuickfixes()&&i.trigger.type===1&&(i.trigger.triggerAction===Va.QuickFix||(u=(d=i.trigger.filter)==null?void 0:d.include)!=null&&u.contains(en.QuickFix))){const L=await BC(this._registry,e,i.selection,i.trigger,Zd.None,c),I=[...L.allActions];if(c.isCancellationRequested)return x_e;const A=(h=L.validActions)==null?void 0:h.some(N=>N.action.kind?en.QuickFix.contains(new cn(N.action.kind)):!1),D=this._markerService.read({resource:e.uri});if(A){for(const N of L.validActions)(p=(g=N.action.command)==null?void 0:g.arguments)!=null&&p.some(R=>typeof R=="string"&&R.includes(Fre))&&(N.action.diagnostics=[...D.filter(R=>R.relatedInformation)]);return{validActions:L.validActions,allActions:I,documentation:L.documentation,hasAutoFix:L.hasAutoFix,hasAIFix:L.hasAIFix,allAIFixes:L.allAIFixes,dispose:()=>{L.dispose()}}}else if(!A&&D.length>0){const N=i.selection.getPosition();let R=N,W=Number.MAX_VALUE;const H=[...L.validActions];for(const B of D){const ee=B.endColumn,re=B.endLineNumber,pe=B.startLineNumber;if(re===N.lineNumber||pe===N.lineNumber){R=new X(re,ee);const Ie={type:i.trigger.type,triggerAction:i.trigger.triggerAction,filter:{include:(_=i.trigger.filter)!=null&&_.include?(v=i.trigger.filter)==null?void 0:v.include:en.QuickFix},autoApply:i.trigger.autoApply,context:{notAvailableMessage:((C=i.trigger.context)==null?void 0:C.notAvailableMessage)||"",position:R}},ge=new Ue(R.lineNumber,R.column,R.lineNumber,R.column),_e=await BC(this._registry,e,ge,Ie,Zd.None,c);if(_e.validActions.length!==0){for(const Re of _e.validActions)(x=(y=Re.action.command)==null?void 0:y.arguments)!=null&&x.some(J=>typeof J=="string"&&J.includes(Fre))&&(Re.action.diagnostics=[...D.filter(J=>J.relatedInformation)]);L.allActions.length===0&&I.push(..._e.allActions),Math.abs(N.column-ee)<W?H.unshift(..._e.validActions):H.push(..._e.validActions)}W=Math.abs(N.column-ee)}}const U=H.filter((B,ee,re)=>re.findIndex(pe=>pe.action.title===B.action.title)===ee);return U.sort((B,ee)=>B.action.isPreferred&&!ee.action.isPreferred?-1:!B.action.isPreferred&&ee.action.isPreferred||B.action.isAI&&!ee.action.isAI?1:!B.action.isAI&&ee.action.isAI?-1:0),{validActions:U,allActions:I,documentation:L.documentation,hasAutoFix:L.hasAutoFix,hasAIFix:L.hasAIFix,allAIFixes:L.allAIFixes,dispose:()=>{L.dispose()}}}}if(i.trigger.type===1){const L=new Bs,I=await BC(this._registry,e,i.selection,i.trigger,Zd.None,c);return this._telemetryService&&this._telemetryService.publicLog2("codeAction.invokedDurations",{codeActions:I.validActions.length,duration:L.elapsed()}),I}return BC(this._registry,e,i.selection,i.trigger,Zd.None,c)});i.trigger.type===1&&((l=this._progressService)==null||l.showWhile(r,250));const o=new Ib.Triggered(i.trigger,n,r);let a=!1;this._state.type===1&&(a=this._state.trigger.type===1&&o.type===1&&o.trigger.type===2&&this._state.position!==o.position),a?setTimeout(()=>{this.setState(o)},500):this.setState(o)},void 0),this._codeActionOracle.value.trigger({type:2,triggerAction:Va.Default})}else this._supportedCodeActions.reset()}trigger(e){var t;(t=this._codeActionOracle.value)==null||t.trigger(e)}setState(e,t){e!==this._state&&(this._state.type===1&&this._state.cancel(),this._state=e,!t&&!this._disposed&&this._onDidChangeState.fire(e))}}var GGe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Wu=function(s,e){return function(t,i){e(t,i,s)}},mC;const QGe="quickfix-edit-highlight";var _m;let F1=(_m=class extends te{static get(e){return e.getContribution(mC.ID)}constructor(e,t,i,n,r,o,a,l,c,d,u){super(),this._commandService=a,this._configurationService=l,this._actionWidgetService=c,this._instantiationService=d,this._telemetryService=u,this._activeCodeActions=this._register(new Es),this._showDisabled=!1,this._disposed=!1,this._editor=e,this._model=this._register(new KGe(this._editor,r.codeActionProvider,t,i,o,l,this._telemetryService)),this._register(this._model.onDidChangeState(h=>this.update(h))),this._lightBulbWidget=new uu(()=>{const h=this._editor.getContribution(tE.ID);return h&&this._register(h.onClick(g=>this.showCodeActionsFromLightbulb(g.actions,g))),h}),this._resolver=n.createInstance(Iz),this._register(this._editor.onDidLayoutChange(()=>this._actionWidgetService.hide()))}dispose(){this._disposed=!0,super.dispose()}async showCodeActionsFromLightbulb(e,t){if(e.allAIFixes&&e.validActions.length===1){const i=e.validActions[0],n=i.action.command;n&&n.id==="inlineChat.start"&&n.arguments&&n.arguments.length>=1&&(n.arguments[0]={...n.arguments[0],autoSend:!1}),await this._applyCodeAction(i,!1,!1,Ub.FromAILightbulb);return}await this.showCodeActionList(e,t,{includeDisabledActions:!1,fromLightbulb:!0})}showCodeActions(e,t,i){return this.showCodeActionList(t,i,{includeDisabledActions:!1,fromLightbulb:!1})}manualTriggerAtCurrentPosition(e,t,i,n){var o;if(!this._editor.hasModel())return;(o=Aa.get(this._editor))==null||o.closeMessage();const r=this._editor.getPosition();this._trigger({type:1,triggerAction:t,filter:i,autoApply:n,context:{notAvailableMessage:e,position:r}})}_trigger(e){return this._model.trigger(e)}async _applyCodeAction(e,t,i,n){try{await this._instantiationService.invokeFunction(PGe,e,n,{preview:i,editor:this._editor})}finally{t&&this._trigger({type:2,triggerAction:Va.QuickFix,filter:{}})}}hideLightBulbWidget(){var e,t;(e=this._lightBulbWidget.rawValue)==null||e.hide(),(t=this._lightBulbWidget.rawValue)==null||t.gutterHide()}async update(e){var n,r,o,a,l;if(e.type!==1){this.hideLightBulbWidget();return}let t;try{t=await e.actions}catch(c){ft(c);return}if(this._disposed)return;const i=this._editor.getSelection();if((i==null?void 0:i.startLineNumber)===e.position.lineNumber)if((n=this._lightBulbWidget.value)==null||n.update(t,e.trigger,e.position),e.trigger.type===1){if((r=e.trigger.filter)!=null&&r.include){const d=this.tryGetValidActionToApply(e.trigger,t);if(d){try{this.hideLightBulbWidget(),await this._applyCodeAction(d,!1,!1,Ub.FromCodeActions)}finally{t.dispose()}return}if(e.trigger.context){const u=this.getInvalidActionThatWouldHaveBeenApplied(e.trigger,t);if(u&&u.action.disabled){(o=Aa.get(this._editor))==null||o.showMessage(u.action.disabled,e.trigger.context.position),t.dispose();return}}}const c=!!((a=e.trigger.filter)!=null&&a.include);if(e.trigger.context&&(!t.allActions.length||!c&&!t.validActions.length)){(l=Aa.get(this._editor))==null||l.showMessage(e.trigger.context.notAvailableMessage,e.trigger.context.position),this._activeCodeActions.value=t,t.dispose();return}this._activeCodeActions.value=t,this.showCodeActionList(t,this.toCoords(e.position),{includeDisabledActions:c,fromLightbulb:!1})}else this._actionWidgetService.isVisible?t.dispose():this._activeCodeActions.value=t}getInvalidActionThatWouldHaveBeenApplied(e,t){if(t.allActions.length&&(e.autoApply==="first"&&t.validActions.length===0||e.autoApply==="ifSingle"&&t.allActions.length===1))return t.allActions.find(({action:i})=>i.disabled)}tryGetValidActionToApply(e,t){if(t.validActions.length&&(e.autoApply==="first"&&t.validActions.length>0||e.autoApply==="ifSingle"&&t.validActions.length===1))return t.validActions[0]}async showCodeActionList(e,t,i){const n=this._editor.createDecorationsCollection(),r=this._editor.getDomNode();if(!r)return;const o=i.includeDisabledActions&&(this._showDisabled||e.validActions.length===0)?e.allActions:e.validActions;if(!o.length)return;const a=X.isIPosition(t)?this.toCoords(t):t,l={onSelect:async(c,d)=>{this._applyCodeAction(c,!0,!!d,i.fromLightbulb?Ub.FromAILightbulb:Ub.FromCodeActions),this._actionWidgetService.hide(!1),n.clear()},onHide:c=>{var d;(d=this._editor)==null||d.focus(),n.clear()},onHover:async(c,d)=>{var g;if(d.isCancellationRequested)return;let u=!1;const h=c.action.kind;if(h){const p=new cn(h);u=[en.RefactorExtract,en.RefactorInline,en.RefactorRewrite,en.RefactorMove,en.Source].some(v=>v.contains(p))}return{canPreview:u||!!((g=c.action.edit)!=null&&g.edits.length)}},onFocus:c=>{var d,u;if(c&&c.action){const h=c.action.ranges,g=c.action.diagnostics;if(n.clear(),h&&h.length>0){const p=g&&(g==null?void 0:g.length)>1?g.map(_=>({range:_,options:mC.DECORATION})):h.map(_=>({range:_,options:mC.DECORATION}));n.set(p)}else if(g&&g.length>0){const p=g.map(v=>({range:v,options:mC.DECORATION}));n.set(p);const _=g[0];if(_.startLineNumber&&_.startColumn){const v=(u=(d=this._editor.getModel())==null?void 0:d.getWordAtPosition({lineNumber:_.startLineNumber,column:_.startColumn}))==null?void 0:u.word;Mh(b("editingNewSelection","Context: {0} at line {1} and column {2}.",v,_.startLineNumber,_.startColumn))}}}else n.clear()}};this._actionWidgetService.show("codeActionWidget",!0,BGe(o,this._shouldShowHeaders(),this._resolver.getResolver()),l,a,r,this._getActionBarActions(e,t,i))}toCoords(e){if(!this._editor.hasModel())return{x:0,y:0};this._editor.revealPosition(e,1),this._editor.render();const t=this._editor.getScrolledVisiblePosition(e),i=Pn(this._editor.getDomNode()),n=i.left+t.left,r=i.top+t.top+t.height;return{x:n,y:r}}_shouldShowHeaders(){var t;const e=(t=this._editor)==null?void 0:t.getModel();return this._configurationService.getValue("editor.codeActionWidget.showHeaders",{resource:e==null?void 0:e.uri})}_getActionBarActions(e,t,i){if(i.fromLightbulb)return[];const n=e.documentation.map(r=>({id:r.id,label:r.title,tooltip:r.tooltip??"",class:void 0,enabled:!0,run:()=>this._commandService.executeCommand(r.id,...r.arguments??[])}));return i.includeDisabledActions&&e.validActions.length>0&&e.allActions.length!==e.validActions.length&&n.push(this._showDisabled?{id:"hideMoreActions",label:b("hideMoreActions","Hide Disabled"),enabled:!0,tooltip:"",class:void 0,run:()=>(this._showDisabled=!1,this.showCodeActionList(e,t,i))}:{id:"showMoreActions",label:b("showMoreActions","Show Disabled"),enabled:!0,tooltip:"",class:void 0,run:()=>(this._showDisabled=!0,this.showCodeActionList(e,t,i))}),n}},mC=_m,_m.ID="editor.contrib.codeActionController",_m.DECORATION=_t.register({description:"quickfix-highlight",className:QGe}),_m);F1=mC=GGe([Wu(1,Gh),Wu(2,ct),Wu(3,Xe),Wu(4,Be),Wu(5,m_),Wu(6,Hi),Wu(7,At),Wu(8,t0),Wu(9,Xe),Wu(10,Tr)],F1);Lc((s,e)=>{((n,r)=>{r&&e.addRule(`.monaco-editor ${n} { background-color: ${r}; }`)})(".quickfix-edit-highlight",s.getColor(Gf));const i=s.getColor(jp);i&&e.addRule(`.monaco-editor .quickfix-edit-highlight { border: 1px ${su(s.type)?"dotted":"solid"} ${i}; box-sizing: border-box; }`)});function bD(s){return he.regex(S_e.keys()[0],new RegExp("(\\s|^)"+Nl(s.value)+"\\b"))}const gQ={type:"object",defaultSnippets:[{body:{kind:""}}],properties:{kind:{type:"string",description:b("args.schema.kind","Kind of the code action to run.")},apply:{type:"string",description:b("args.schema.apply","Controls when the returned actions are applied."),default:"ifSingle",enum:["first","ifSingle","never"],enumDescriptions:[b("args.schema.apply.first","Always apply the first returned code action."),b("args.schema.apply.ifSingle","Apply the first returned code action if it is the only one."),b("args.schema.apply.never","Do not apply the returned code actions.")]},preferred:{type:"boolean",default:!1,description:b("args.schema.preferred","Controls if only preferred code actions should be returned.")}}};function i0(s,e,t,i,n=Va.Default){if(s.hasModel()){const r=F1.get(s);r==null||r.manualTriggerAtCurrentPosition(e,n,t,i)}}class YGe extends Ve{constructor(){super({id:fQ,label:b("quickfix.trigger.label","Quick Fix..."),alias:"Quick Fix...",precondition:he.and(z.writable,z.hasCodeActionsProvider),kbOpts:{kbExpr:z.textInputFocus,primary:2137,weight:100}})}run(e,t){return i0(t,b("editor.action.quickFix.noneMessage","No code actions available"),void 0,void 0,Va.QuickFix)}}class XGe extends fs{constructor(){super({id:g_e,precondition:he.and(z.writable,z.hasCodeActionsProvider),metadata:{description:"Trigger a code action",args:[{name:"args",schema:gQ}]}})}runEditorCommand(e,t,i){const n=uh.fromUser(i,{kind:cn.Empty,apply:"ifSingle"});return i0(t,typeof(i==null?void 0:i.kind)=="string"?n.preferred?b("editor.action.codeAction.noneMessage.preferred.kind","No preferred code actions for '{0}' available",i.kind):b("editor.action.codeAction.noneMessage.kind","No code actions for '{0}' available",i.kind):n.preferred?b("editor.action.codeAction.noneMessage.preferred","No preferred code actions available"):b("editor.action.codeAction.noneMessage","No code actions available"),{include:n.kind,includeSourceActions:!0,onlyIncludePreferredActions:n.preferred},n.apply)}}class ZGe extends Ve{constructor(){super({id:m_e,label:b("refactor.label","Refactor..."),alias:"Refactor...",precondition:he.and(z.writable,z.hasCodeActionsProvider),kbOpts:{kbExpr:z.textInputFocus,primary:3120,mac:{primary:1328},weight:100},contextMenuOpts:{group:"1_modification",order:2,when:he.and(z.writable,bD(en.Refactor))},metadata:{description:"Refactor...",args:[{name:"args",schema:gQ}]}})}run(e,t,i){const n=uh.fromUser(i,{kind:en.Refactor,apply:"never"});return i0(t,typeof(i==null?void 0:i.kind)=="string"?n.preferred?b("editor.action.refactor.noneMessage.preferred.kind","No preferred refactorings for '{0}' available",i.kind):b("editor.action.refactor.noneMessage.kind","No refactorings for '{0}' available",i.kind):n.preferred?b("editor.action.refactor.noneMessage.preferred","No preferred refactorings available"):b("editor.action.refactor.noneMessage","No refactorings available"),{include:en.Refactor.contains(n.kind)?n.kind:cn.None,onlyIncludePreferredActions:n.preferred},n.apply,Va.Refactor)}}class JGe extends Ve{constructor(){super({id:__e,label:b("source.label","Source Action..."),alias:"Source Action...",precondition:he.and(z.writable,z.hasCodeActionsProvider),contextMenuOpts:{group:"1_modification",order:2.1,when:he.and(z.writable,bD(en.Source))},metadata:{description:"Source Action...",args:[{name:"args",schema:gQ}]}})}run(e,t,i){const n=uh.fromUser(i,{kind:en.Source,apply:"never"});return i0(t,typeof(i==null?void 0:i.kind)=="string"?n.preferred?b("editor.action.source.noneMessage.preferred.kind","No preferred source actions for '{0}' available",i.kind):b("editor.action.source.noneMessage.kind","No source actions for '{0}' available",i.kind):n.preferred?b("editor.action.source.noneMessage.preferred","No preferred source actions available"):b("editor.action.source.noneMessage","No source actions available"),{include:en.Source.contains(n.kind)?n.kind:cn.None,includeSourceActions:!0,onlyIncludePreferredActions:n.preferred},n.apply,Va.SourceAction)}}class eQe extends Ve{constructor(){super({id:xz,label:b("organizeImports.label","Organize Imports"),alias:"Organize Imports",precondition:he.and(z.writable,bD(en.SourceOrganizeImports)),kbOpts:{kbExpr:z.textInputFocus,primary:1581,weight:100}})}run(e,t){return i0(t,b("editor.action.organize.noneMessage","No organize imports action available"),{include:en.SourceOrganizeImports,includeSourceActions:!0},"ifSingle",Va.OrganizeImports)}}class tQe extends Ve{constructor(){super({id:Lz,label:b("fixAll.label","Fix All"),alias:"Fix All",precondition:he.and(z.writable,bD(en.SourceFixAll))})}run(e,t){return i0(t,b("fixAll.noneMessage","No fix all action available"),{include:en.SourceFixAll,includeSourceActions:!0},"ifSingle",Va.FixAll)}}class iQe extends Ve{constructor(){super({id:p_e,label:b("autoFix.label","Auto Fix..."),alias:"Auto Fix...",precondition:he.and(z.writable,bD(en.QuickFix)),kbOpts:{kbExpr:z.textInputFocus,primary:1625,mac:{primary:2649},weight:100}})}run(e,t){return i0(t,b("editor.action.autoFix.noneMessage","No auto fixes available"),{include:en.QuickFix,onlyIncludePreferredActions:!0},"ifSingle",Va.AutoFix)}}Zt(F1.ID,F1,3);Zt(tE.ID,tE,4);ye(YGe);ye(ZGe);ye(JGe);ye(eQe);ye(iQe);ye(tQe);Me(new XGe);_n.as(pd.Configuration).registerConfiguration({...JE,properties:{"editor.codeActionWidget.showHeaders":{type:"boolean",scope:5,description:b("showCodeActionHeaders","Enable/disable showing group headers in the Code Action menu."),default:!0}}});_n.as(pd.Configuration).registerConfiguration({...JE,properties:{"editor.codeActionWidget.includeNearbyQuickFixes":{type:"boolean",scope:5,description:b("includeNearbyQuickFixes","Enable/disable showing nearest Quick Fix within a line when not currently on a diagnostic."),default:!0}}});_n.as(pd.Configuration).registerConfiguration({...JE,properties:{"editor.codeActions.triggerOnFocusChange":{type:"boolean",scope:5,markdownDescription:b("triggerOnFocusChange","Enable triggering {0} when {1} is set to {2}. Code Actions must be set to {3} to be triggered for window and focus changes.","`#editor.codeActionsOnSave#`","`#files.autoSave#`","`afterDelay`","`always`"),default:!1}}});class Nz{constructor(){this.lenses=[],this._disposables=new ce}dispose(){this._disposables.dispose()}get isDisposed(){return this._disposables.isDisposed}add(e,t){this._disposables.add(e);for(const i of e.lenses)this.lenses.push({symbol:i,provider:t})}}async function L_e(s,e,t){const i=s.ordered(e),n=new Map,r=new Nz,o=i.map(async(a,l)=>{n.set(a,l);try{const c=await Promise.resolve(a.provideCodeLenses(e,t));c&&r.add(c,a)}catch(c){Mn(c)}});return await Promise.all(o),r.lenses=r.lenses.sort((a,l)=>a.symbol.range.startLineNumber<l.symbol.range.startLineNumber?-1:a.symbol.range.startLineNumber>l.symbol.range.startLineNumber?1:n.get(a.provider)<n.get(l.provider)?-1:n.get(a.provider)>n.get(l.provider)?1:a.symbol.range.startColumn<l.symbol.range.startColumn?-1:a.symbol.range.startColumn>l.symbol.range.startColumn?1:0),r}Gt.registerCommand("_executeCodeLensProvider",function(s,...e){let[t,i]=e;ii(Je.isUri(t)),ii(typeof i=="number"||!i);const{codeLensProvider:n}=s.get(Be),r=s.get(Gi).getModel(t);if(!r)throw fc();const o=[],a=new ce;return L_e(n,r,kt.None).then(l=>{a.add(l);const c=[];for(const d of l.lenses)i==null||d.symbol.command?o.push(d.symbol):i-- >0&&d.provider.resolveCodeLens&&c.push(Promise.resolve(d.provider.resolveCodeLens(r,d.symbol,kt.None)).then(u=>o.push(u||d.symbol)));return Promise.all(c)}).then(()=>o).finally(()=>{setTimeout(()=>a.dispose(),100)})});var nQe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},sQe=function(s,e){return function(t,i){e(t,i,s)}};const k_e=Ht("ICodeLensCache");class Vre{constructor(e,t){this.lineCount=e,this.data=t}}let Rz=class{constructor(e){this._fakeProvider=new class{provideCodeLenses(){throw new Error("not supported")}},this._cache=new $h(20,.75);const t="codelens/cache";Xx(Ri,()=>e.remove(t,1));const i="codelens/cache2",n=e.get(i,1,"{}");this._deserialize(n);const r=De.filter(e.onWillSaveState,o=>o.reason===kI.SHUTDOWN);De.once(r)(o=>{e.store(i,this._serialize(),1,1)})}put(e,t){const i=t.lenses.map(o=>{var a;return{range:o.symbol.range,command:o.symbol.command&&{id:"",title:(a=o.symbol.command)==null?void 0:a.title}}}),n=new Nz;n.add({lenses:i,dispose:()=>{}},this._fakeProvider);const r=new Vre(e.getLineCount(),n);this._cache.set(e.uri.toString(),r)}get(e){const t=this._cache.get(e.uri.toString());return t&&t.lineCount===e.getLineCount()?t.data:void 0}delete(e){this._cache.delete(e.uri.toString())}_serialize(){const e=Object.create(null);for(const[t,i]of this._cache){const n=new Set;for(const r of i.data.lenses)n.add(r.symbol.range.startLineNumber);e[t]={lineCount:i.lineCount,lines:[...n.values()]}}return JSON.stringify(e)}_deserialize(e){try{const t=JSON.parse(e);for(const i in t){const n=t[i],r=[];for(const a of n.lines)r.push({range:new F(a,1,a,11)});const o=new Nz;o.add({lenses:r,dispose(){}},this._fakeProvider),this._cache.set(i,new Vre(n.lineCount,o))}}catch{}}};Rz=nQe([sQe(0,md)],Rz);qt(k_e,Rz,1);class rQe{constructor(e,t,i){this.afterColumn=1073741824,this.afterLineNumber=e,this.heightInPx=t,this._onHeight=i,this.suppressMouseDown=!0,this.domNode=document.createElement("div")}onComputedHeight(e){this._lastHeight===void 0?this._lastHeight=e:this._lastHeight!==e&&(this._lastHeight=e,this._onHeight())}isVisible(){return this._lastHeight!==0&&this.domNode.hasAttribute("monaco-visible-view-zone")}}const Nk=class Nk{constructor(e,t){this.allowEditorOverflow=!1,this.suppressMouseDown=!0,this._commands=new Map,this._isEmpty=!0,this._editor=e,this._id=`codelens.widget-${Nk._idPool++}`,this.updatePosition(t),this._domNode=document.createElement("span"),this._domNode.className="codelens-decoration"}withCommands(e,t){this._commands.clear();const i=[];let n=!1;for(let r=0;r<e.length;r++){const o=e[r];if(o&&(n=!0,o.command)){const a=dm(o.command.title.trim());if(o.command.id){const l=`c${Nk._idPool++}`;i.push(ke("a",{id:l,title:o.command.tooltip,role:"button"},...a)),this._commands.set(l,o.command)}else i.push(ke("span",{title:o.command.tooltip},...a));r+1<e.length&&i.push(ke("span",void 0," | "))}}n?(Xs(this._domNode,...i),this._isEmpty&&t&&this._domNode.classList.add("fadein"),this._isEmpty=!1):Xs(this._domNode,ke("span",void 0,"no commands"))}getCommand(e){return e.parentElement===this._domNode?this._commands.get(e.id):void 0}getId(){return this._id}getDomNode(){return this._domNode}updatePosition(e){const t=this._editor.getModel().getLineFirstNonWhitespaceColumn(e);this._widgetPosition={position:{lineNumber:e,column:t},preference:[1]}}getPosition(){return this._widgetPosition||null}};Nk._idPool=0;let Az=Nk;class SB{constructor(){this._removeDecorations=[],this._addDecorations=[],this._addDecorationsCallbacks=[]}addDecoration(e,t){this._addDecorations.push(e),this._addDecorationsCallbacks.push(t)}removeDecoration(e){this._removeDecorations.push(e)}commit(e){const t=e.deltaDecorations(this._removeDecorations,this._addDecorations);for(let i=0,n=t.length;i<n;i++)this._addDecorationsCallbacks[i](t[i])}}const Bre=_t.register({collapseOnReplaceEdit:!0,description:"codelens"});class Wre{constructor(e,t,i,n,r,o){this._isDisposed=!1,this._editor=t,this._data=e,this._decorationIds=[];let a;const l=[];this._data.forEach((c,d)=>{c.symbol.command&&l.push(c.symbol),i.addDecoration({range:c.symbol.range,options:Bre},u=>this._decorationIds[d]=u),a?a=F.plusRange(a,c.symbol.range):a=F.lift(c.symbol.range)}),this._viewZone=new rQe(a.startLineNumber-1,r,o),this._viewZoneId=n.addZone(this._viewZone),l.length>0&&(this._createContentWidgetIfNecessary(),this._contentWidget.withCommands(l,!1))}_createContentWidgetIfNecessary(){this._contentWidget?this._editor.layoutContentWidget(this._contentWidget):(this._contentWidget=new Az(this._editor,this._viewZone.afterLineNumber+1),this._editor.addContentWidget(this._contentWidget))}dispose(e,t){this._decorationIds.forEach(e.removeDecoration,e),this._decorationIds=[],t==null||t.removeZone(this._viewZoneId),this._contentWidget&&(this._editor.removeContentWidget(this._contentWidget),this._contentWidget=void 0),this._isDisposed=!0}isDisposed(){return this._isDisposed}isValid(){return this._decorationIds.some((e,t)=>{const i=this._editor.getModel().getDecorationRange(e),n=this._data[t].symbol;return!!(i&&F.isEmpty(n.range)===i.isEmpty())})}updateCodeLensSymbols(e,t){this._decorationIds.forEach(t.removeDecoration,t),this._decorationIds=[],this._data=e,this._data.forEach((i,n)=>{t.addDecoration({range:i.symbol.range,options:Bre},r=>this._decorationIds[n]=r)})}updateHeight(e,t){this._viewZone.heightInPx=e,t.layoutZone(this._viewZoneId),this._contentWidget&&this._editor.layoutContentWidget(this._contentWidget)}computeIfNecessary(e){if(!this._viewZone.isVisible())return null;for(let t=0;t<this._decorationIds.length;t++){const i=e.getDecorationRange(this._decorationIds[t]);i&&(this._data[t].symbol.range=i)}return this._data}updateCommands(e){this._createContentWidgetIfNecessary(),this._contentWidget.withCommands(e,!0);for(let t=0;t<this._data.length;t++){const i=e[t];if(i){const{symbol:n}=this._data[t];n.command=i.command||n.command}}}getCommand(e){var t;return(t=this._contentWidget)==null?void 0:t.getCommand(e)}getLineNumber(){const e=this._editor.getModel().getDecorationRange(this._decorationIds[0]);return e?e.startLineNumber:-1}update(e){if(this.isValid()){const t=this._editor.getModel().getDecorationRange(this._decorationIds[0]);t&&(this._viewZone.afterLineNumber=t.startLineNumber-1,e.layoutZone(this._viewZoneId),this._contentWidget&&(this._contentWidget.updatePosition(t.startLineNumber),this._editor.layoutContentWidget(this._contentWidget)))}}}var oQe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Vx=function(s,e){return function(t,i){e(t,i,s)}},Hy;let iE=(Hy=class{constructor(e,t,i,n,r,o){this._editor=e,this._languageFeaturesService=t,this._commandService=n,this._notificationService=r,this._codeLensCache=o,this._disposables=new ce,this._localToDispose=new ce,this._lenses=[],this._oldCodeLensModels=new ce,this._provideCodeLensDebounce=i.for(t.codeLensProvider,"CodeLensProvide",{min:250}),this._resolveCodeLensesDebounce=i.for(t.codeLensProvider,"CodeLensResolve",{min:250,salt:"resolve"}),this._resolveCodeLensesScheduler=new xi(()=>this._resolveCodeLensesInViewport(),this._resolveCodeLensesDebounce.default()),this._disposables.add(this._editor.onDidChangeModel(()=>this._onModelChange())),this._disposables.add(this._editor.onDidChangeModelLanguage(()=>this._onModelChange())),this._disposables.add(this._editor.onDidChangeConfiguration(a=>{(a.hasChanged(50)||a.hasChanged(19)||a.hasChanged(18))&&this._updateLensStyle(),a.hasChanged(17)&&this._onModelChange()})),this._disposables.add(t.codeLensProvider.onDidChange(this._onModelChange,this)),this._onModelChange(),this._updateLensStyle()}dispose(){var e;this._localDispose(),this._disposables.dispose(),this._oldCodeLensModels.dispose(),(e=this._currentCodeLensModel)==null||e.dispose()}_getLayoutInfo(){const e=Math.max(1.3,this._editor.getOption(67)/this._editor.getOption(52));let t=this._editor.getOption(19);return(!t||t<5)&&(t=this._editor.getOption(52)*.9|0),{fontSize:t,codeLensHeight:t*e|0}}_updateLensStyle(){const{codeLensHeight:e,fontSize:t}=this._getLayoutInfo(),i=this._editor.getOption(18),n=this._editor.getOption(50),{style:r}=this._editor.getContainerDomNode();r.setProperty("--vscode-editorCodeLens-lineHeight",`${e}px`),r.setProperty("--vscode-editorCodeLens-fontSize",`${t}px`),r.setProperty("--vscode-editorCodeLens-fontFeatureSettings",n.fontFeatureSettings),i&&(r.setProperty("--vscode-editorCodeLens-fontFamily",i),r.setProperty("--vscode-editorCodeLens-fontFamilyDefault",yo.fontFamily)),this._editor.changeViewZones(o=>{for(const a of this._lenses)a.updateHeight(e,o)})}_localDispose(){var e,t,i;(e=this._getCodeLensModelPromise)==null||e.cancel(),this._getCodeLensModelPromise=void 0,(t=this._resolveCodeLensesPromise)==null||t.cancel(),this._resolveCodeLensesPromise=void 0,this._localToDispose.clear(),this._oldCodeLensModels.clear(),(i=this._currentCodeLensModel)==null||i.dispose()}_onModelChange(){this._localDispose();const e=this._editor.getModel();if(!e||!this._editor.getOption(17)||e.isTooLargeForTokenization())return;const t=this._codeLensCache.get(e);if(t&&this._renderCodeLensSymbols(t),!this._languageFeaturesService.codeLensProvider.has(e)){t&&$m(()=>{const n=this._codeLensCache.get(e);t===n&&(this._codeLensCache.delete(e),this._onModelChange())},30*1e3,this._localToDispose);return}for(const n of this._languageFeaturesService.codeLensProvider.all(e))if(typeof n.onDidChange=="function"){const r=n.onDidChange(()=>i.schedule());this._localToDispose.add(r)}const i=new xi(()=>{var r;const n=Date.now();(r=this._getCodeLensModelPromise)==null||r.cancel(),this._getCodeLensModelPromise=xs(o=>L_e(this._languageFeaturesService.codeLensProvider,e,o)),this._getCodeLensModelPromise.then(o=>{this._currentCodeLensModel&&this._oldCodeLensModels.add(this._currentCodeLensModel),this._currentCodeLensModel=o,this._codeLensCache.put(e,o);const a=this._provideCodeLensDebounce.update(e,Date.now()-n);i.delay=a,this._renderCodeLensSymbols(o),this._resolveCodeLensesInViewportSoon()},ft)},this._provideCodeLensDebounce.get(e));this._localToDispose.add(i),this._localToDispose.add(Ye(()=>this._resolveCodeLensesScheduler.cancel())),this._localToDispose.add(this._editor.onDidChangeModelContent(()=>{var n;this._editor.changeDecorations(r=>{this._editor.changeViewZones(o=>{const a=[];let l=-1;this._lenses.forEach(d=>{!d.isValid()||l===d.getLineNumber()?a.push(d):(d.update(o),l=d.getLineNumber())});const c=new SB;a.forEach(d=>{d.dispose(c,o),this._lenses.splice(this._lenses.indexOf(d),1)}),c.commit(r)})}),i.schedule(),this._resolveCodeLensesScheduler.cancel(),(n=this._resolveCodeLensesPromise)==null||n.cancel(),this._resolveCodeLensesPromise=void 0})),this._localToDispose.add(this._editor.onDidFocusEditorText(()=>{i.schedule()})),this._localToDispose.add(this._editor.onDidBlurEditorText(()=>{i.cancel()})),this._localToDispose.add(this._editor.onDidScrollChange(n=>{n.scrollTopChanged&&this._lenses.length>0&&this._resolveCodeLensesInViewportSoon()})),this._localToDispose.add(this._editor.onDidLayoutChange(()=>{this._resolveCodeLensesInViewportSoon()})),this._localToDispose.add(Ye(()=>{if(this._editor.getModel()){const n=_u.capture(this._editor);this._editor.changeDecorations(r=>{this._editor.changeViewZones(o=>{this._disposeAllLenses(r,o)})}),n.restore(this._editor)}else this._disposeAllLenses(void 0,void 0)})),this._localToDispose.add(this._editor.onMouseDown(n=>{if(n.target.type!==9)return;let r=n.target.element;if((r==null?void 0:r.tagName)==="SPAN"&&(r=r.parentElement),(r==null?void 0:r.tagName)==="A")for(const o of this._lenses){const a=o.getCommand(r);if(a){this._commandService.executeCommand(a.id,...a.arguments||[]).catch(l=>this._notificationService.error(l));break}}})),i.schedule()}_disposeAllLenses(e,t){const i=new SB;for(const n of this._lenses)n.dispose(i,t);e&&i.commit(e),this._lenses.length=0}_renderCodeLensSymbols(e){if(!this._editor.hasModel())return;const t=this._editor.getModel().getLineCount(),i=[];let n;for(const a of e.lenses){const l=a.symbol.range.startLineNumber;l<1||l>t||(n&&n[n.length-1].symbol.range.startLineNumber===l?n.push(a):(n=[a],i.push(n)))}if(!i.length&&!this._lenses.length)return;const r=_u.capture(this._editor),o=this._getLayoutInfo();this._editor.changeDecorations(a=>{this._editor.changeViewZones(l=>{const c=new SB;let d=0,u=0;for(;u<i.length&&d<this._lenses.length;){const h=i[u][0].symbol.range.startLineNumber,g=this._lenses[d].getLineNumber();g<h?(this._lenses[d].dispose(c,l),this._lenses.splice(d,1)):g===h?(this._lenses[d].updateCodeLensSymbols(i[u],c),u++,d++):(this._lenses.splice(d,0,new Wre(i[u],this._editor,c,l,o.codeLensHeight,()=>this._resolveCodeLensesInViewportSoon())),d++,u++)}for(;d<this._lenses.length;)this._lenses[d].dispose(c,l),this._lenses.splice(d,1);for(;u<i.length;)this._lenses.push(new Wre(i[u],this._editor,c,l,o.codeLensHeight,()=>this._resolveCodeLensesInViewportSoon())),u++;c.commit(a)})}),r.restore(this._editor)}_resolveCodeLensesInViewportSoon(){this._editor.getModel()&&this._resolveCodeLensesScheduler.schedule()}_resolveCodeLensesInViewport(){var o;(o=this._resolveCodeLensesPromise)==null||o.cancel(),this._resolveCodeLensesPromise=void 0;const e=this._editor.getModel();if(!e)return;const t=[],i=[];if(this._lenses.forEach(a=>{const l=a.computeIfNecessary(e);l&&(t.push(l),i.push(a))}),t.length===0)return;const n=Date.now(),r=xs(a=>{const l=t.map((c,d)=>{const u=new Array(c.length),h=c.map((g,p)=>!g.symbol.command&&typeof g.provider.resolveCodeLens=="function"?Promise.resolve(g.provider.resolveCodeLens(e,g.symbol,a)).then(_=>{u[p]=_},Mn):(u[p]=g.symbol,Promise.resolve(void 0)));return Promise.all(h).then(()=>{!a.isCancellationRequested&&!i[d].isDisposed()&&i[d].updateCommands(u)})});return Promise.all(l)});this._resolveCodeLensesPromise=r,this._resolveCodeLensesPromise.then(()=>{const a=this._resolveCodeLensesDebounce.update(e,Date.now()-n);this._resolveCodeLensesScheduler.delay=a,this._currentCodeLensModel&&this._codeLensCache.put(e,this._currentCodeLensModel),this._oldCodeLensModels.clear(),r===this._resolveCodeLensesPromise&&(this._resolveCodeLensesPromise=void 0)},a=>{ft(a),r===this._resolveCodeLensesPromise&&(this._resolveCodeLensesPromise=void 0)})}async getModel(){var e;return await this._getCodeLensModelPromise,await this._resolveCodeLensesPromise,(e=this._currentCodeLensModel)!=null&&e.isDisposed?void 0:this._currentCodeLensModel}},Hy.ID="css.editor.codeLens",Hy);iE=oQe([Vx(1,Be),Vx(2,Fl),Vx(3,Hi),Vx(4,jn),Vx(5,k_e)],iE);Zt(iE.ID,iE,1);ye(class extends Ve{constructor(){super({id:"codelens.showLensesInCurrentLine",precondition:z.hasCodeLensProvider,label:b("showLensOnLine","Show CodeLens Commands For Current Line"),alias:"Show CodeLens Commands For Current Line"})}async run(e,t){if(!t.hasModel())return;const i=e.get(kc),n=e.get(Hi),r=e.get(jn),o=t.getSelection().positionLineNumber,a=t.getContribution(iE.ID);if(!a)return;const l=await a.getModel();if(!l)return;const c=[];for(const h of l.lenses)h.symbol.command&&h.symbol.range.startLineNumber===o&&c.push({label:h.symbol.command.title,command:h.symbol.command});if(c.length===0)return;const d=await i.pick(c,{canPickMany:!1,placeHolder:b("placeHolder","Select a command")});if(!d)return;let u=d.command;if(l.isDisposed){const h=await a.getModel(),g=h==null?void 0:h.lenses.find(p=>{var _;return p.symbol.range.startLineNumber===o&&((_=p.symbol.command)==null?void 0:_.title)===u.title});if(!g||!g.symbol.command)return;u=g.symbol.command}try{await n.executeCommand(u.id,...u.arguments||[])}catch(h){r.error(h)}}});var I_e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Pz=function(s,e){return function(t,i){e(t,i,s)}};let nE=class{constructor(e){this._editorWorkerService=e}async provideDocumentColors(e,t){return this._editorWorkerService.computeDefaultDocumentColors(e.uri)}provideColorPresentations(e,t,i){const n=t.range,r=t.color,o=r.alpha,a=new fe(new Jt(Math.round(255*r.red),Math.round(255*r.green),Math.round(255*r.blue),o)),l=o?fe.Format.CSS.formatRGB(a):fe.Format.CSS.formatRGBA(a),c=o?fe.Format.CSS.formatHSL(a):fe.Format.CSS.formatHSLA(a),d=o?fe.Format.CSS.formatHex(a):fe.Format.CSS.formatHexA(a),u=[];return u.push({label:l,textEdit:{range:n,text:l}}),u.push({label:c,textEdit:{range:n,text:c}}),u.push({label:d,textEdit:{range:n,text:d}}),u}};nE=I_e([Pz(0,ca)],nE);let Mz=class extends te{constructor(e,t){super(),this._register(e.colorProvider.register("*",new nE(t)))}};Mz=I_e([Pz(0,Be),Pz(1,ca)],Mz);LS(Mz);async function E_e(s,e,t,i=!0){return pQ(new aQe,s,e,t,i)}function D_e(s,e,t,i){return Promise.resolve(t.provideColorPresentations(s,e,i))}class aQe{constructor(){}async compute(e,t,i,n){const r=await e.provideDocumentColors(t,i);if(Array.isArray(r))for(const o of r)n.push({colorInfo:o,provider:e});return Array.isArray(r)}}class lQe{constructor(){}async compute(e,t,i,n){const r=await e.provideDocumentColors(t,i);if(Array.isArray(r))for(const o of r)n.push({range:o.range,color:[o.color.red,o.color.green,o.color.blue,o.color.alpha]});return Array.isArray(r)}}class cQe{constructor(e){this.colorInfo=e}async compute(e,t,i,n){const r=await e.provideColorPresentations(t,this.colorInfo,kt.None);return Array.isArray(r)&&n.push(...r),Array.isArray(r)}}async function pQ(s,e,t,i,n){let r=!1,o;const a=[],l=e.ordered(t);for(let c=l.length-1;c>=0;c--){const d=l[c];if(d instanceof nE)o=d;else try{await s.compute(d,t,i,a)&&(r=!0)}catch(u){Mn(u)}}return r?a:o&&n?(await s.compute(o,t,i,a),a):[]}function T_e(s,e){const{colorProvider:t}=s.get(Be),i=s.get(Gi).getModel(e);if(!i)throw fc();const n=s.get(At).getValue("editor.defaultColorDecorators",{resource:e});return{model:i,colorProviderRegistry:t,isDefaultColorDecoratorsEnabled:n}}Gt.registerCommand("_executeDocumentColorProvider",function(s,...e){const[t]=e;if(!(t instanceof Je))throw fc();const{model:i,colorProviderRegistry:n,isDefaultColorDecoratorsEnabled:r}=T_e(s,t);return pQ(new lQe,n,i,kt.None,r)});Gt.registerCommand("_executeColorPresentationProvider",function(s,...e){const[t,i]=e,{uri:n,range:r}=i;if(!(n instanceof Je)||!Array.isArray(t)||t.length!==4||!F.isIRange(r))throw fc();const{model:o,colorProviderRegistry:a,isDefaultColorDecoratorsEnabled:l}=T_e(s,n),[c,d,u,h]=t;return pQ(new cQe({range:r,color:{red:c,green:d,blue:u,alpha:h}}),a,o,kt.None,l)});var dQe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},xB=function(s,e){return function(t,i){e(t,i,s)}},Oz;const N_e=Object.create({});var bm;let V1=(bm=class extends te{constructor(e,t,i,n){super(),this._editor=e,this._configurationService=t,this._languageFeaturesService=i,this._localToDispose=this._register(new ce),this._decorationsIds=[],this._colorDatas=new Map,this._colorDecoratorIds=this._editor.createDecorationsCollection(),this._ruleFactory=new sP(this._editor),this._decoratorLimitReporter=new uQe,this._colorDecorationClassRefs=this._register(new ce),this._debounceInformation=n.for(i.colorProvider,"Document Colors",{min:Oz.RECOMPUTE_TIME}),this._register(e.onDidChangeModel(()=>{this._isColorDecoratorsEnabled=this.isEnabled(),this.updateColors()})),this._register(e.onDidChangeModelLanguage(()=>this.updateColors())),this._register(i.colorProvider.onDidChange(()=>this.updateColors())),this._register(e.onDidChangeConfiguration(r=>{const o=this._isColorDecoratorsEnabled;this._isColorDecoratorsEnabled=this.isEnabled(),this._isDefaultColorDecoratorsEnabled=this._editor.getOption(148);const a=o!==this._isColorDecoratorsEnabled||r.hasChanged(21),l=r.hasChanged(148);(a||l)&&(this._isColorDecoratorsEnabled?this.updateColors():this.removeAllDecorations())})),this._timeoutTimer=null,this._computePromise=null,this._isColorDecoratorsEnabled=this.isEnabled(),this._isDefaultColorDecoratorsEnabled=this._editor.getOption(148),this.updateColors()}isEnabled(){const e=this._editor.getModel();if(!e)return!1;const t=e.getLanguageId(),i=this._configurationService.getValue(t);if(i&&typeof i=="object"){const n=i.colorDecorators;if(n&&n.enable!==void 0&&!n.enable)return n.enable}return this._editor.getOption(20)}static get(e){return e.getContribution(this.ID)}dispose(){this.stop(),this.removeAllDecorations(),super.dispose()}updateColors(){if(this.stop(),!this._isColorDecoratorsEnabled)return;const e=this._editor.getModel();!e||!this._languageFeaturesService.colorProvider.has(e)||(this._localToDispose.add(this._editor.onDidChangeModelContent(()=>{this._timeoutTimer||(this._timeoutTimer=new gd,this._timeoutTimer.cancelAndSet(()=>{this._timeoutTimer=null,this.beginCompute()},this._debounceInformation.get(e)))})),this.beginCompute())}async beginCompute(){this._computePromise=xs(async e=>{const t=this._editor.getModel();if(!t)return[];const i=new Bs(!1),n=await E_e(this._languageFeaturesService.colorProvider,t,e,this._isDefaultColorDecoratorsEnabled);return this._debounceInformation.update(t,i.elapsed()),n});try{const e=await this._computePromise;this.updateDecorations(e),this.updateColorDecorators(e),this._computePromise=null}catch(e){ft(e)}}stop(){this._timeoutTimer&&(this._timeoutTimer.cancel(),this._timeoutTimer=null),this._computePromise&&(this._computePromise.cancel(),this._computePromise=null),this._localToDispose.clear()}updateDecorations(e){const t=e.map(i=>({range:{startLineNumber:i.colorInfo.range.startLineNumber,startColumn:i.colorInfo.range.startColumn,endLineNumber:i.colorInfo.range.endLineNumber,endColumn:i.colorInfo.range.endColumn},options:_t.EMPTY}));this._editor.changeDecorations(i=>{this._decorationsIds=i.deltaDecorations(this._decorationsIds,t),this._colorDatas=new Map,this._decorationsIds.forEach((n,r)=>this._colorDatas.set(n,e[r]))})}updateColorDecorators(e){this._colorDecorationClassRefs.clear();const t=[],i=this._editor.getOption(21);for(let r=0;r<e.length&&t.length<i;r++){const{red:o,green:a,blue:l,alpha:c}=e[r].colorInfo.color,d=new Jt(Math.round(o*255),Math.round(a*255),Math.round(l*255),c),u=`rgba(${d.r}, ${d.g}, ${d.b}, ${d.a})`,h=this._colorDecorationClassRefs.add(this._ruleFactory.createClassNameRef({backgroundColor:u}));t.push({range:{startLineNumber:e[r].colorInfo.range.startLineNumber,startColumn:e[r].colorInfo.range.startColumn,endLineNumber:e[r].colorInfo.range.endLineNumber,endColumn:e[r].colorInfo.range.endColumn},options:{description:"colorDetector",before:{content:Pue,inlineClassName:`${h.className} colorpicker-color-decoration`,inlineClassNameAffectsLetterSpacing:!0,attachedData:N_e}}})}const n=i<e.length?i:!1;this._decoratorLimitReporter.update(e.length,n),this._colorDecoratorIds.set(t)}removeAllDecorations(){this._editor.removeDecorations(this._decorationsIds),this._decorationsIds=[],this._colorDecoratorIds.clear(),this._colorDecorationClassRefs.clear()}getColorData(e){const t=this._editor.getModel();if(!t)return null;const i=t.getDecorationsInRange(F.fromPositions(e,e)).filter(n=>this._colorDatas.has(n.id));return i.length===0?null:this._colorDatas.get(i[0].id)}isColorDecoration(e){return this._colorDecoratorIds.has(e)}},Oz=bm,bm.ID="editor.contrib.colorDetector",bm.RECOMPUTE_TIME=1e3,bm);V1=Oz=dQe([xB(1,At),xB(2,Be),xB(3,Fl)],V1);class uQe{constructor(){this._onDidChange=new Z,this._computed=0,this._limited=!1}update(e,t){(e!==this._computed||t!==this._limited)&&(this._computed=e,this._limited=t,this._onDidChange.fire())}}Zt(V1.ID,V1,1);class hQe{get color(){return this._color}set color(e){this._color.equals(e)||(this._color=e,this._onDidChangeColor.fire(e))}get presentation(){return this.colorPresentations[this.presentationIndex]}get colorPresentations(){return this._colorPresentations}set colorPresentations(e){this._colorPresentations=e,this.presentationIndex>e.length-1&&(this.presentationIndex=0),this._onDidChangePresentation.fire(this.presentation)}constructor(e,t,i){this.presentationIndex=i,this._onColorFlushed=new Z,this.onColorFlushed=this._onColorFlushed.event,this._onDidChangeColor=new Z,this.onDidChangeColor=this._onDidChangeColor.event,this._onDidChangePresentation=new Z,this.onDidChangePresentation=this._onDidChangePresentation.event,this.originalColor=e,this._color=e,this._colorPresentations=t}selectNextColorPresentation(){this.presentationIndex=(this.presentationIndex+1)%this.colorPresentations.length,this.flushColor(),this._onDidChangePresentation.fire(this.presentation)}guessColorPresentation(e,t){let i=-1;for(let n=0;n<this.colorPresentations.length;n++)if(t.toLowerCase()===this.colorPresentations[n].label){i=n;break}if(i===-1){const n=t.split("(")[0].toLowerCase();for(let r=0;r<this.colorPresentations.length;r++)if(this.colorPresentations[r].label.toLowerCase().startsWith(n)){i=r;break}}i!==-1&&i!==this.presentationIndex&&(this.presentationIndex=i,this._onDidChangePresentation.fire(this.presentation))}flushColor(){this._onColorFlushed.fire(this._color)}}const vl=ke;class fQe extends te{constructor(e,t,i,n=!1){super(),this.model=t,this.showingStandaloneColorPicker=n,this._closeButton=null,this._domNode=vl(".colorpicker-header"),me(e,this._domNode),this._pickedColorNode=me(this._domNode,vl(".picked-color")),me(this._pickedColorNode,vl("span.codicon.codicon-color-mode")),this._pickedColorPresentation=me(this._pickedColorNode,document.createElement("span")),this._pickedColorPresentation.classList.add("picked-color-presentation");const r=b("clickToToggleColorOptions","Click to toggle color options (rgb/hsl/hex)");this._pickedColorNode.setAttribute("title",r),this._originalColorNode=me(this._domNode,vl(".original-color")),this._originalColorNode.style.backgroundColor=fe.Format.CSS.format(this.model.originalColor)||"",this.backgroundColor=i.getColorTheme().getColor(cA)||fe.white,this._register(i.onDidColorThemeChange(o=>{this.backgroundColor=o.getColor(cA)||fe.white})),this._register(oe(this._pickedColorNode,Le.CLICK,()=>this.model.selectNextColorPresentation())),this._register(oe(this._originalColorNode,Le.CLICK,()=>{this.model.color=this.model.originalColor,this.model.flushColor()})),this._register(t.onDidChangeColor(this.onDidChangeColor,this)),this._register(t.onDidChangePresentation(this.onDidChangePresentation,this)),this._pickedColorNode.style.backgroundColor=fe.Format.CSS.format(t.color)||"",this._pickedColorNode.classList.toggle("light",t.color.rgba.a<.5?this.backgroundColor.isLighter():t.color.isLighter()),this.onDidChangeColor(this.model.color),this.showingStandaloneColorPicker&&(this._domNode.classList.add("standalone-colorpicker"),this._closeButton=this._register(new gQe(this._domNode)))}get closeButton(){return this._closeButton}get pickedColorNode(){return this._pickedColorNode}get originalColorNode(){return this._originalColorNode}onDidChangeColor(e){this._pickedColorNode.style.backgroundColor=fe.Format.CSS.format(e)||"",this._pickedColorNode.classList.toggle("light",e.rgba.a<.5?this.backgroundColor.isLighter():e.isLighter()),this.onDidChangePresentation()}onDidChangePresentation(){this._pickedColorPresentation.textContent=this.model.presentation?this.model.presentation.label:""}}class gQe extends te{constructor(e){super(),this._onClicked=this._register(new Z),this.onClicked=this._onClicked.event,this._button=document.createElement("div"),this._button.classList.add("close-button"),me(e,this._button);const t=document.createElement("div");t.classList.add("close-button-inner-div"),me(this._button,t),me(t,vl(".button"+at.asCSSSelector(Qi("color-picker-close",xe.close,b("closeIcon","Icon to close the color picker"))))).classList.add("close-icon"),this._register(oe(this._button,Le.CLICK,()=>{this._onClicked.fire()}))}}class pQe extends te{constructor(e,t,i,n=!1){super(),this.model=t,this.pixelRatio=i,this._insertButton=null,this._domNode=vl(".colorpicker-body"),me(e,this._domNode),this._saturationBox=new mQe(this._domNode,this.model,this.pixelRatio),this._register(this._saturationBox),this._register(this._saturationBox.onDidChange(this.onDidSaturationValueChange,this)),this._register(this._saturationBox.onColorFlushed(this.flushColor,this)),this._opacityStrip=new _Qe(this._domNode,this.model,n),this._register(this._opacityStrip),this._register(this._opacityStrip.onDidChange(this.onDidOpacityChange,this)),this._register(this._opacityStrip.onColorFlushed(this.flushColor,this)),this._hueStrip=new bQe(this._domNode,this.model,n),this._register(this._hueStrip),this._register(this._hueStrip.onDidChange(this.onDidHueChange,this)),this._register(this._hueStrip.onColorFlushed(this.flushColor,this)),n&&(this._insertButton=this._register(new vQe(this._domNode)),this._domNode.classList.add("standalone-colorpicker"))}flushColor(){this.model.flushColor()}onDidSaturationValueChange({s:e,v:t}){const i=this.model.color.hsva;this.model.color=new fe(new mh(i.h,e,t,i.a))}onDidOpacityChange(e){const t=this.model.color.hsva;this.model.color=new fe(new mh(t.h,t.s,t.v,e))}onDidHueChange(e){const t=this.model.color.hsva,i=(1-e)*360;this.model.color=new fe(new mh(i===360?0:i,t.s,t.v,t.a))}get domNode(){return this._domNode}get saturationBox(){return this._saturationBox}get enterButton(){return this._insertButton}layout(){this._saturationBox.layout(),this._opacityStrip.layout(),this._hueStrip.layout()}}class mQe extends te{constructor(e,t,i){super(),this.model=t,this.pixelRatio=i,this._onDidChange=new Z,this.onDidChange=this._onDidChange.event,this._onColorFlushed=new Z,this.onColorFlushed=this._onColorFlushed.event,this._domNode=vl(".saturation-wrap"),me(e,this._domNode),this._canvas=document.createElement("canvas"),this._canvas.className="saturation-box",me(this._domNode,this._canvas),this.selection=vl(".saturation-selection"),me(this._domNode,this.selection),this.layout(),this._register(oe(this._domNode,Le.POINTER_DOWN,n=>this.onPointerDown(n))),this._register(this.model.onDidChangeColor(this.onDidChangeColor,this)),this.monitor=null}get domNode(){return this._domNode}onPointerDown(e){if(!e.target||!(e.target instanceof Element))return;this.monitor=this._register(new pS);const t=Pn(this._domNode);e.target!==this.selection&&this.onDidChangePosition(e.offsetX,e.offsetY),this.monitor.startMonitoring(e.target,e.pointerId,e.buttons,n=>this.onDidChangePosition(n.pageX-t.left,n.pageY-t.top),()=>null);const i=oe(e.target.ownerDocument,Le.POINTER_UP,()=>{this._onColorFlushed.fire(),i.dispose(),this.monitor&&(this.monitor.stopMonitoring(!0),this.monitor=null)},!0)}onDidChangePosition(e,t){const i=Math.max(0,Math.min(1,e/this.width)),n=Math.max(0,Math.min(1,1-t/this.height));this.paintSelection(i,n),this._onDidChange.fire({s:i,v:n})}layout(){this.width=this._domNode.offsetWidth,this.height=this._domNode.offsetHeight,this._canvas.width=this.width*this.pixelRatio,this._canvas.height=this.height*this.pixelRatio,this.paint();const e=this.model.color.hsva;this.paintSelection(e.s,e.v)}paint(){const e=this.model.color.hsva,t=new fe(new mh(e.h,1,1,1)),i=this._canvas.getContext("2d"),n=i.createLinearGradient(0,0,this._canvas.width,0);n.addColorStop(0,"rgba(255, 255, 255, 1)"),n.addColorStop(.5,"rgba(255, 255, 255, 0.5)"),n.addColorStop(1,"rgba(255, 255, 255, 0)");const r=i.createLinearGradient(0,0,0,this._canvas.height);r.addColorStop(0,"rgba(0, 0, 0, 0)"),r.addColorStop(1,"rgba(0, 0, 0, 1)"),i.rect(0,0,this._canvas.width,this._canvas.height),i.fillStyle=fe.Format.CSS.format(t),i.fill(),i.fillStyle=n,i.fill(),i.fillStyle=r,i.fill()}paintSelection(e,t){this.selection.style.left=`${e*this.width}px`,this.selection.style.top=`${this.height-t*this.height}px`}onDidChangeColor(e){if(this.monitor&&this.monitor.isMonitoring())return;this.paint();const t=e.hsva;this.paintSelection(t.s,t.v)}}class R_e extends te{constructor(e,t,i=!1){super(),this.model=t,this._onDidChange=new Z,this.onDidChange=this._onDidChange.event,this._onColorFlushed=new Z,this.onColorFlushed=this._onColorFlushed.event,i?(this.domNode=me(e,vl(".standalone-strip")),this.overlay=me(this.domNode,vl(".standalone-overlay"))):(this.domNode=me(e,vl(".strip")),this.overlay=me(this.domNode,vl(".overlay"))),this.slider=me(this.domNode,vl(".slider")),this.slider.style.top="0px",this._register(oe(this.domNode,Le.POINTER_DOWN,n=>this.onPointerDown(n))),this._register(t.onDidChangeColor(this.onDidChangeColor,this)),this.layout()}layout(){this.height=this.domNode.offsetHeight-this.slider.offsetHeight;const e=this.getValue(this.model.color);this.updateSliderPosition(e)}onDidChangeColor(e){const t=this.getValue(e);this.updateSliderPosition(t)}onPointerDown(e){if(!e.target||!(e.target instanceof Element))return;const t=this._register(new pS),i=Pn(this.domNode);this.domNode.classList.add("grabbing"),e.target!==this.slider&&this.onDidChangeTop(e.offsetY),t.startMonitoring(e.target,e.pointerId,e.buttons,r=>this.onDidChangeTop(r.pageY-i.top),()=>null);const n=oe(e.target.ownerDocument,Le.POINTER_UP,()=>{this._onColorFlushed.fire(),n.dispose(),t.stopMonitoring(!0),this.domNode.classList.remove("grabbing")},!0)}onDidChangeTop(e){const t=Math.max(0,Math.min(1,1-e/this.height));this.updateSliderPosition(t),this._onDidChange.fire(t)}updateSliderPosition(e){this.slider.style.top=`${(1-e)*this.height}px`}}class _Qe extends R_e{constructor(e,t,i=!1){super(e,t,i),this.domNode.classList.add("opacity-strip"),this.onDidChangeColor(this.model.color)}onDidChangeColor(e){super.onDidChangeColor(e);const{r:t,g:i,b:n}=e.rgba,r=new fe(new Jt(t,i,n,1)),o=new fe(new Jt(t,i,n,0));this.overlay.style.background=`linear-gradient(to bottom, ${r} 0%, ${o} 100%)`}getValue(e){return e.hsva.a}}class bQe extends R_e{constructor(e,t,i=!1){super(e,t,i),this.domNode.classList.add("hue-strip")}getValue(e){return 1-e.hsva.h/360}}class vQe extends te{constructor(e){super(),this._onClicked=this._register(new Z),this.onClicked=this._onClicked.event,this._button=me(e,document.createElement("button")),this._button.classList.add("insert-button"),this._button.textContent="Insert",this._register(oe(this._button,Le.CLICK,()=>{this._onClicked.fire()}))}get button(){return this._button}}class wQe extends Vl{constructor(e,t,i,n,r=!1){super(),this.model=t,this.pixelRatio=i,this._register(nI.getInstance(nt(e)).onDidChange(()=>this.layout())),this._domNode=vl(".colorpicker-widget"),e.appendChild(this._domNode),this.header=this._register(new fQe(this._domNode,this.model,n,r)),this.body=this._register(new pQe(this._domNode,this.model,this.pixelRatio,r))}layout(){this.body.layout()}get domNode(){return this._domNode}}class LB{constructor(e,t,i,n){this.priority=e,this.range=t,this.initialMousePosX=i,this.initialMousePosY=n,this.type=1}equals(e){return e.type===1&&this.range.equalsRange(e.range)}canAdoptVisibleHover(e,t){return e.type===1&&t.lineNumber===this.range.startLineNumber}}class GR{constructor(e,t,i,n,r,o){this.priority=e,this.owner=t,this.range=i,this.initialMousePosX=n,this.initialMousePosY=r,this.supportsMarkerHover=o,this.type=2}equals(e){return e.type===2&&this.owner===e.owner}canAdoptVisibleHover(e,t){return e.type===2&&this.owner===e.owner}}class Dw{constructor(e){this.renderedHoverParts=e}dispose(){for(const e of this.renderedHoverParts)e.dispose()}}const n0=new class{constructor(){this._participants=[]}register(e){this._participants.push(e)}getAll(){return this._participants}};var A_e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},P_e=function(s,e){return function(t,i){e(t,i,s)}};class CQe{constructor(e,t,i,n){this.owner=e,this.range=t,this.model=i,this.provider=n,this.forceShowAtRange=!0}isValidForHoverAnchor(e){return e.type===1&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}let sE=class{constructor(e,t){this._editor=e,this._themeService=t,this.hoverOrdinal=2}computeSync(e,t){return[]}computeAsync(e,t,i){return Cl.fromPromise(this._computeAsync(e,t,i))}async _computeAsync(e,t,i){if(!this._editor.hasModel())return[];const n=V1.get(this._editor);if(!n)return[];for(const r of t){if(!n.isColorDecoration(r))continue;const o=n.getColorData(r.range.getStartPosition());if(o)return[await M_e(this,this._editor.getModel(),o.colorInfo,o.provider)]}return[]}renderHoverParts(e,t){const i=O_e(this,this._editor,this._themeService,t,e);if(!i)return new Dw([]);this._colorPicker=i.colorPicker;const n={hoverPart:i.hoverPart,hoverElement:this._colorPicker.domNode,dispose(){i.disposables.dispose()}};return new Dw([n])}handleResize(){var e;(e=this._colorPicker)==null||e.layout()}isColorPickerVisible(){return!!this._colorPicker}};sE=A_e([P_e(1,gs)],sE);class yQe{constructor(e,t,i,n){this.owner=e,this.range=t,this.model=i,this.provider=n}}let rE=class{constructor(e,t){this._editor=e,this._themeService=t,this._color=null}async createColorHover(e,t,i){if(!this._editor.hasModel()||!V1.get(this._editor))return null;const r=await E_e(i,this._editor.getModel(),kt.None);let o=null,a=null;for(const u of r){const h=u.colorInfo;F.containsRange(h.range,e.range)&&(o=h,a=u.provider)}const l=o??e,c=a??t,d=!!o;return{colorHover:await M_e(this,this._editor.getModel(),l,c),foundInEditor:d}}async updateEditorModel(e){if(!this._editor.hasModel())return;const t=e.model;let i=new F(e.range.startLineNumber,e.range.startColumn,e.range.endLineNumber,e.range.endColumn);this._color&&(await QR(this._editor.getModel(),t,this._color,i,e),i=F_e(this._editor,i,t))}renderHoverParts(e,t){return O_e(this,this._editor,this._themeService,t,e)}set color(e){this._color=e}get color(){return this._color}};rE=A_e([P_e(1,gs)],rE);async function M_e(s,e,t,i){const n=e.getValueInRange(t.range),{red:r,green:o,blue:a,alpha:l}=t.color,c=new Jt(Math.round(r*255),Math.round(o*255),Math.round(a*255),l),d=new fe(c),u=await D_e(e,t,i,kt.None),h=new hQe(d,[],0);return h.colorPresentations=u||[],h.guessColorPresentation(d,n),s instanceof sE?new CQe(s,F.lift(t.range),h,i):new yQe(s,F.lift(t.range),h,i)}function O_e(s,e,t,i,n){if(i.length===0||!e.hasModel())return;if(n.setMinimumDimensions){const h=e.getOption(67)+8;n.setMinimumDimensions(new Ci(302,h))}const r=new ce,o=i[0],a=e.getModel(),l=o.model,c=r.add(new wQe(n.fragment,l,e.getOption(144),t,s instanceof rE));let d=!1,u=new F(o.range.startLineNumber,o.range.startColumn,o.range.endLineNumber,o.range.endColumn);if(s instanceof rE){const h=o.model.color;s.color=h,QR(a,l,h,u,o),r.add(l.onColorFlushed(g=>{s.color=g}))}else r.add(l.onColorFlushed(async h=>{await QR(a,l,h,u,o),d=!0,u=F_e(e,u,l)}));return r.add(l.onDidChangeColor(h=>{QR(a,l,h,u,o)})),r.add(e.onDidChangeModelContent(h=>{d?d=!1:(n.hide(),e.focus())})),{hoverPart:o,colorPicker:c,disposables:r}}function F_e(s,e,t){const i=[],n=t.presentation.textEdit??{range:e,text:t.presentation.label,forceMoveMarkers:!1};i.push(n),t.presentation.additionalTextEdits&&i.push(...t.presentation.additionalTextEdits);const r=F.lift(n.range),o=s.getModel()._setTrackedRange(null,r,3);return s.executeEdits("colorpicker",i),s.pushUndoStop(),s.getModel()._getTrackedRange(o)??r}async function QR(s,e,t,i,n){const r=await D_e(s,{range:i,color:{red:t.rgba.r/255,green:t.rgba.g/255,blue:t.rgba.b/255,alpha:t.rgba.a}},n.provider,kt.None);e.colorPresentations=r||[]}const V_e="editor.action.showHover",SQe="editor.action.showDefinitionPreviewHover",xQe="editor.action.scrollUpHover",LQe="editor.action.scrollDownHover",kQe="editor.action.scrollLeftHover",IQe="editor.action.scrollRightHover",EQe="editor.action.pageUpHover",DQe="editor.action.pageDownHover",TQe="editor.action.goToTopHover",NQe="editor.action.goToBottomHover",p5="editor.action.increaseHoverVerbosityLevel",RQe=b({key:"increaseHoverVerbosityLevel",comment:["Label for action that will increase the hover verbosity level."]},"Increase Hover Verbosity Level"),m5="editor.action.decreaseHoverVerbosityLevel",AQe=b({key:"decreaseHoverVerbosityLevel",comment:["Label for action that will decrease the hover verbosity level."]},"Decrease Hover Verbosity Level"),B_e="editor.action.inlineSuggest.commit",W_e="editor.action.inlineSuggest.showPrevious",H_e="editor.action.inlineSuggest.showNext";var mQ=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Qc=function(s,e){return function(t,i){e(t,i,s)}},YR;let Fz=class extends te{constructor(e,t,i){super(),this.editor=e,this.model=t,this.instantiationService=i,this.alwaysShowToolbar=wi(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(62).showToolbar==="always"),this.sessionPosition=void 0,this.position=qe(this,n=>{var l,c;const r=(l=this.model.read(n))==null?void 0:l.primaryGhostText.read(n);if(!this.alwaysShowToolbar.read(n)||!r||r.parts.length===0)return this.sessionPosition=void 0,null;const o=r.parts[0].column;this.sessionPosition&&this.sessionPosition.lineNumber!==r.lineNumber&&(this.sessionPosition=void 0);const a=new X(r.lineNumber,Math.min(o,((c=this.sessionPosition)==null?void 0:c.column)??Number.MAX_SAFE_INTEGER));return this.sessionPosition=a,a}),this._register(Jo((n,r)=>{const o=this.model.read(n);if(!o||!this.alwaysShowToolbar.read(n))return;const a=__((c,d)=>{const u=d.add(this.instantiationService.createInstance(B1,this.editor,!0,this.position,o.selectedInlineCompletionIndex,o.inlineCompletionsCount,o.activeCommands));return e.addContentWidget(u),d.add(Ye(()=>e.removeContentWidget(u))),d.add(ht(h=>{this.position.read(h)&&o.lastTriggerKind.read(h)!==iu.Explicit&&o.triggerExplicitly()})),u}),l=nD(this,(c,d)=>!!this.position.read(c)||!!d);r.add(ht(c=>{l.read(c)&&a.read(c)}))}))}};Fz=mQ([Qc(2,Xe)],Fz);const PQe=Qi("inline-suggestion-hints-next",xe.chevronRight,b("parameterHintsNextIcon","Icon for show next parameter hint.")),MQe=Qi("inline-suggestion-hints-previous",xe.chevronLeft,b("parameterHintsPreviousIcon","Icon for show previous parameter hint."));var vm;let B1=(vm=class extends te{static get dropDownVisible(){return this._dropDownVisible}createCommandAction(e,t,i){const n=new Na(e,t,i,!0,()=>this._commandService.executeCommand(e)),r=this.keybindingService.lookupKeybinding(e,this._contextKeyService);let o=t;return r&&(o=b({key:"content",comment:["A label","A keybinding"]},"{0} ({1})",t,r.getLabel())),n.tooltip=o,n}constructor(e,t,i,n,r,o,a,l,c,d,u){super(),this.editor=e,this.withBorder=t,this._position=i,this._currentSuggestionIdx=n,this._suggestionCount=r,this._extraCommands=o,this._commandService=a,this.keybindingService=c,this._contextKeyService=d,this._menuService=u,this.id=`InlineSuggestionHintsContentWidget${YR.id++}`,this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this.nodes=Vt("div.inlineSuggestionsHints",{className:this.withBorder?".withBorder":""},[Vt("div@toolBar")]),this.previousAction=this.createCommandAction(W_e,b("previous","Previous"),at.asClassName(MQe)),this.availableSuggestionCountAction=new Na("inlineSuggestionHints.availableSuggestionCount","",void 0,!1),this.nextAction=this.createCommandAction(H_e,b("next","Next"),at.asClassName(PQe)),this.inlineCompletionsActionsMenus=this._register(this._menuService.createMenu(ze.InlineCompletionsActions,this._contextKeyService)),this.clearAvailableSuggestionCountLabelDebounced=this._register(new xi(()=>{this.availableSuggestionCountAction.label=""},100)),this.disableButtonsDebounced=this._register(new xi(()=>{this.previousAction.enabled=this.nextAction.enabled=!1},100)),this.toolBar=this._register(l.createInstance(Vz,this.nodes.toolBar,ze.InlineSuggestionToolbar,{menuOptions:{renderShortTitle:!0},toolbarOptions:{primaryGroup:h=>h.startsWith("primary")},actionViewItemProvider:(h,g)=>{if(h instanceof Ra)return l.createInstance(FQe,h,void 0);if(h===this.availableSuggestionCountAction){const p=new OQe(void 0,h,{label:!0,icon:!1});return p.setClass("availableSuggestionCount"),p}},telemetrySource:"InlineSuggestionToolbar"})),this.toolBar.setPrependedPrimaryActions([this.previousAction,this.availableSuggestionCountAction,this.nextAction]),this._register(this.toolBar.onDidChangeDropdownVisibility(h=>{YR._dropDownVisible=h})),this._register(ht(h=>{this._position.read(h),this.editor.layoutContentWidget(this)})),this._register(ht(h=>{const g=this._suggestionCount.read(h),p=this._currentSuggestionIdx.read(h);g!==void 0?(this.clearAvailableSuggestionCountLabelDebounced.cancel(),this.availableSuggestionCountAction.label=`${p+1}/${g}`):this.clearAvailableSuggestionCountLabelDebounced.schedule(),g!==void 0&&g>1?(this.disableButtonsDebounced.cancel(),this.previousAction.enabled=this.nextAction.enabled=!0):this.disableButtonsDebounced.schedule()})),this._register(ht(h=>{const p=this._extraCommands.read(h).map(_=>({class:void 0,id:_.id,enabled:!0,tooltip:_.tooltip||"",label:_.title,run:v=>this._commandService.executeCommand(_.id)}));for(const[_,v]of this.inlineCompletionsActionsMenus.getActions())for(const C of v)C instanceof Ra&&p.push(C);p.length>0&&p.unshift(new ks),this.toolBar.setAdditionalSecondaryActions(p)}))}getId(){return this.id}getDomNode(){return this.nodes.root}getPosition(){return{position:this._position.get(),preference:[1,2],positionAffinity:3}}},YR=vm,vm._dropDownVisible=!1,vm.id=0,vm);B1=YR=mQ([Qc(6,Hi),Qc(7,Xe),Qc(8,pi),Qc(9,ct),Qc(10,Ol)],B1);class OQe extends I1{constructor(){super(...arguments),this._className=void 0}setClass(e){this._className=e}render(e){super.render(e),this._className&&e.classList.add(this._className)}updateTooltip(){}}let FQe=class extends Ym{updateLabel(){const e=this._keybindingService.lookupKeybinding(this._action.id,this._contextKeyService);if(!e)return super.updateLabel();if(this.label){const t=Vt("div.keybinding").root;this._register(new SS(t,Da,{disableTitle:!0,...wpe})).set(e),this.label.textContent=this._action.label,this.label.appendChild(t),this.label.classList.add("inlineSuggestionStatusBarItemLabel")}}updateTooltip(){}},Vz=class extends GI{constructor(e,t,i,n,r,o,a,l,c){super(e,{resetMenu:t,...i},n,r,o,a,l,c),this.menuId=t,this.options2=i,this.menuService=n,this.contextKeyService=r,this.menu=this._store.add(this.menuService.createMenu(this.menuId,this.contextKeyService,{emitEventsForSubmenuChanges:!0})),this.additionalActions=[],this.prependedPrimaryActions=[],this._store.add(this.menu.onDidChange(()=>this.updateToolbar())),this.updateToolbar()}updateToolbar(){var i,n,r,o,a,l,c;const e=[],t=[];zF(this.menu,(i=this.options2)==null?void 0:i.menuOptions,{primary:e,secondary:t},(r=(n=this.options2)==null?void 0:n.toolbarOptions)==null?void 0:r.primaryGroup,(a=(o=this.options2)==null?void 0:o.toolbarOptions)==null?void 0:a.shouldInlineSubmenu,(c=(l=this.options2)==null?void 0:l.toolbarOptions)==null?void 0:c.useSeparatorsInPrimaryActions),t.push(...this.additionalActions),e.unshift(...this.prependedPrimaryActions),this.setActions(e,t)}setPrependedPrimaryActions(e){dn(this.prependedPrimaryActions,e,(t,i)=>t===i)||(this.prependedPrimaryActions=e,this.updateToolbar())}setAdditionalSecondaryActions(e){dn(this.additionalActions,e,(t,i)=>t===i)||(this.additionalActions=e,this.updateToolbar())}};Vz=mQ([Qc(3,Ol),Qc(4,ct),Qc(5,Ba),Qc(6,pi),Qc(7,Hi),Qc(8,Tr)],Vz);function _5(s,e,t){const i=Pn(s);return!(e<i.left||e>i.left+i.width||t<i.top||t>i.top+i.height)}let VQe=class{constructor(e,t,i){this.value=e,this.isComplete=t,this.hasLoadingMessage=i}};class z_e extends te{constructor(e,t){super(),this._editor=e,this._computer=t,this._onResult=this._register(new Z),this.onResult=this._onResult.event,this._firstWaitScheduler=this._register(new xi(()=>this._triggerAsyncComputation(),0)),this._secondWaitScheduler=this._register(new xi(()=>this._triggerSyncComputation(),0)),this._loadingMessageScheduler=this._register(new xi(()=>this._triggerLoadingMessage(),0)),this._state=0,this._asyncIterable=null,this._asyncIterableDone=!1,this._result=[]}dispose(){this._asyncIterable&&(this._asyncIterable.cancel(),this._asyncIterable=null),super.dispose()}get _hoverTime(){return this._editor.getOption(60).delay}get _firstWaitTime(){return this._hoverTime/2}get _secondWaitTime(){return this._hoverTime-this._firstWaitTime}get _loadingMessageTime(){return 3*this._hoverTime}_setState(e,t=!0){this._state=e,t&&this._fireResult()}_triggerAsyncComputation(){this._setState(2),this._secondWaitScheduler.schedule(this._secondWaitTime),this._computer.computeAsync?(this._asyncIterableDone=!1,this._asyncIterable=f2e(e=>this._computer.computeAsync(e)),(async()=>{try{for await(const e of this._asyncIterable)e&&(this._result.push(e),this._fireResult());this._asyncIterableDone=!0,(this._state===3||this._state===4)&&this._setState(0)}catch(e){ft(e)}})()):this._asyncIterableDone=!0}_triggerSyncComputation(){this._computer.computeSync&&(this._result=this._result.concat(this._computer.computeSync())),this._setState(this._asyncIterableDone?0:3)}_triggerLoadingMessage(){this._state===3&&this._setState(4)}_fireResult(){if(this._state===1||this._state===2)return;const e=this._state===0,t=this._state===4;this._onResult.fire(new VQe(this._result.slice(0),e,t))}start(e){if(e===0)this._state===0&&(this._setState(1),this._firstWaitScheduler.schedule(this._firstWaitTime),this._loadingMessageScheduler.schedule(this._loadingMessageTime));else switch(this._state){case 0:this._triggerAsyncComputation(),this._secondWaitScheduler.cancel(),this._triggerSyncComputation();break;case 2:this._secondWaitScheduler.cancel(),this._triggerSyncComputation();break}}cancel(){this._firstWaitScheduler.cancel(),this._secondWaitScheduler.cancel(),this._loadingMessageScheduler.cancel(),this._asyncIterable&&(this._asyncIterable.cancel(),this._asyncIterable=null),this._result=[],this._setState(0,!1)}}class _Q{constructor(){this._onDidWillResize=new Z,this.onDidWillResize=this._onDidWillResize.event,this._onDidResize=new Z,this.onDidResize=this._onDidResize.event,this._sashListener=new ce,this._size=new Ci(0,0),this._minSize=new Ci(0,0),this._maxSize=new Ci(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),this.domNode=document.createElement("div"),this._eastSash=new Sr(this.domNode,{getVerticalSashLeft:()=>this._size.width},{orientation:0}),this._westSash=new Sr(this.domNode,{getVerticalSashLeft:()=>0},{orientation:0}),this._northSash=new Sr(this.domNode,{getHorizontalSashTop:()=>0},{orientation:1,orthogonalEdge:VA.North}),this._southSash=new Sr(this.domNode,{getHorizontalSashTop:()=>this._size.height},{orientation:1,orthogonalEdge:VA.South}),this._northSash.orthogonalStartSash=this._westSash,this._northSash.orthogonalEndSash=this._eastSash,this._southSash.orthogonalStartSash=this._westSash,this._southSash.orthogonalEndSash=this._eastSash;let e,t=0,i=0;this._sashListener.add(De.any(this._northSash.onDidStart,this._eastSash.onDidStart,this._southSash.onDidStart,this._westSash.onDidStart)(()=>{e===void 0&&(this._onDidWillResize.fire(),e=this._size,t=0,i=0)})),this._sashListener.add(De.any(this._northSash.onDidEnd,this._eastSash.onDidEnd,this._southSash.onDidEnd,this._westSash.onDidEnd)(()=>{e!==void 0&&(e=void 0,t=0,i=0,this._onDidResize.fire({dimension:this._size,done:!0}))})),this._sashListener.add(this._eastSash.onDidChange(n=>{e&&(i=n.currentX-n.startX,this.layout(e.height+t,e.width+i),this._onDidResize.fire({dimension:this._size,done:!1,east:!0}))})),this._sashListener.add(this._westSash.onDidChange(n=>{e&&(i=-(n.currentX-n.startX),this.layout(e.height+t,e.width+i),this._onDidResize.fire({dimension:this._size,done:!1,west:!0}))})),this._sashListener.add(this._northSash.onDidChange(n=>{e&&(t=-(n.currentY-n.startY),this.layout(e.height+t,e.width+i),this._onDidResize.fire({dimension:this._size,done:!1,north:!0}))})),this._sashListener.add(this._southSash.onDidChange(n=>{e&&(t=n.currentY-n.startY,this.layout(e.height+t,e.width+i),this._onDidResize.fire({dimension:this._size,done:!1,south:!0}))})),this._sashListener.add(De.any(this._eastSash.onDidReset,this._westSash.onDidReset)(n=>{this._preferredSize&&(this.layout(this._size.height,this._preferredSize.width),this._onDidResize.fire({dimension:this._size,done:!0}))})),this._sashListener.add(De.any(this._northSash.onDidReset,this._southSash.onDidReset)(n=>{this._preferredSize&&(this.layout(this._preferredSize.height,this._size.width),this._onDidResize.fire({dimension:this._size,done:!0}))}))}dispose(){this._northSash.dispose(),this._southSash.dispose(),this._eastSash.dispose(),this._westSash.dispose(),this._sashListener.dispose(),this._onDidResize.dispose(),this._onDidWillResize.dispose(),this.domNode.remove()}enableSashes(e,t,i,n){this._northSash.state=e?3:0,this._eastSash.state=t?3:0,this._southSash.state=i?3:0,this._westSash.state=n?3:0}layout(e=this.size.height,t=this.size.width){const{height:i,width:n}=this._minSize,{height:r,width:o}=this._maxSize;e=Math.max(i,Math.min(r,e)),t=Math.max(n,Math.min(o,t));const a=new Ci(t,e);Ci.equals(a,this._size)||(this.domNode.style.height=e+"px",this.domNode.style.width=t+"px",this._size=a,this._northSash.layout(),this._eastSash.layout(),this._southSash.layout(),this._westSash.layout())}clearSashHoverState(){this._eastSash.clearSashHoverState(),this._westSash.clearSashHoverState(),this._northSash.clearSashHoverState(),this._southSash.clearSashHoverState()}get size(){return this._size}set maxSize(e){this._maxSize=e}get maxSize(){return this._maxSize}set minSize(e){this._minSize=e}get minSize(){return this._minSize}set preferredSize(e){this._preferredSize=e}get preferredSize(){return this._preferredSize}}const BQe=30,WQe=24;class HQe extends te{constructor(e,t=new Ci(10,10)){super(),this._editor=e,this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._resizableNode=this._register(new _Q),this._contentPosition=null,this._isResizing=!1,this._resizableNode.domNode.style.position="absolute",this._resizableNode.minSize=Ci.lift(t),this._resizableNode.layout(t.height,t.width),this._resizableNode.enableSashes(!0,!0,!0,!0),this._register(this._resizableNode.onDidResize(i=>{this._resize(new Ci(i.dimension.width,i.dimension.height)),i.done&&(this._isResizing=!1)})),this._register(this._resizableNode.onDidWillResize(()=>{this._isResizing=!0}))}get isResizing(){return this._isResizing}getDomNode(){return this._resizableNode.domNode}getPosition(){return this._contentPosition}get position(){var e;return(e=this._contentPosition)!=null&&e.position?X.lift(this._contentPosition.position):void 0}_availableVerticalSpaceAbove(e){const t=this._editor.getDomNode(),i=this._editor.getScrolledVisiblePosition(e);return!t||!i?void 0:Pn(t).top+i.top-BQe}_availableVerticalSpaceBelow(e){const t=this._editor.getDomNode(),i=this._editor.getScrolledVisiblePosition(e);if(!t||!i)return;const n=Pn(t),r=qm(t.ownerDocument.body),o=n.top+i.top+i.height;return r.height-o-WQe}_findPositionPreference(e,t){const i=Math.min(this._availableVerticalSpaceBelow(t)??1/0,e),n=Math.min(this._availableVerticalSpaceAbove(t)??1/0,e),r=Math.min(Math.max(n,i),e),o=Math.min(e,r);let a;return this._editor.getOption(60).above?a=o<=n?1:2:a=o<=i?2:1,a===1?this._resizableNode.enableSashes(!0,!0,!1,!1):this._resizableNode.enableSashes(!1,!0,!0,!1),a}_resize(e){this._resizableNode.layout(e.height,e.width)}}var zQe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},VN=function(s,e){return function(t,i){e(t,i,s)}},qu;const Hre=30,UQe=6;var wm;let Bz=(wm=class extends HQe{get isVisibleFromKeyboard(){var e;return((e=this._renderedHover)==null?void 0:e.source)===1}get isVisible(){return this._hoverVisibleKey.get()??!1}get isFocused(){return this._hoverFocusedKey.get()??!1}constructor(e,t,i,n,r){const o=e.getOption(67)+8,a=150,l=new Ci(a,o);super(e,l),this._configurationService=i,this._accessibilityService=n,this._keybindingService=r,this._hover=this._register(new _K),this._onDidResize=this._register(new Z),this.onDidResize=this._onDidResize.event,this._minimumSize=l,this._hoverVisibleKey=z.hoverVisible.bindTo(t),this._hoverFocusedKey=z.hoverFocused.bindTo(t),me(this._resizableNode.domNode,this._hover.containerDomNode),this._resizableNode.domNode.style.zIndex="50",this._register(this._editor.onDidLayoutChange(()=>{this.isVisible&&this._updateMaxDimensions()})),this._register(this._editor.onDidChangeConfiguration(d=>{d.hasChanged(50)&&this._updateFont()}));const c=this._register(hu(this._resizableNode.domNode));this._register(c.onDidFocus(()=>{this._hoverFocusedKey.set(!0)})),this._register(c.onDidBlur(()=>{this._hoverFocusedKey.set(!1)})),this._setRenderedHover(void 0),this._editor.addContentWidget(this)}dispose(){var e;super.dispose(),(e=this._renderedHover)==null||e.dispose(),this._editor.removeContentWidget(this)}getId(){return qu.ID}static _applyDimensions(e,t,i){const n=typeof t=="number"?`${t}px`:t,r=typeof i=="number"?`${i}px`:i;e.style.width=n,e.style.height=r}_setContentsDomNodeDimensions(e,t){const i=this._hover.contentsDomNode;return qu._applyDimensions(i,e,t)}_setContainerDomNodeDimensions(e,t){const i=this._hover.containerDomNode;return qu._applyDimensions(i,e,t)}_setHoverWidgetDimensions(e,t){this._setContentsDomNodeDimensions(e,t),this._setContainerDomNodeDimensions(e,t),this._layoutContentWidget()}static _applyMaxDimensions(e,t,i){const n=typeof t=="number"?`${t}px`:t,r=typeof i=="number"?`${i}px`:i;e.style.maxWidth=n,e.style.maxHeight=r}_setHoverWidgetMaxDimensions(e,t){qu._applyMaxDimensions(this._hover.contentsDomNode,e,t),qu._applyMaxDimensions(this._hover.containerDomNode,e,t),this._hover.containerDomNode.style.setProperty("--vscode-hover-maxWidth",typeof e=="number"?`${e}px`:e),this._layoutContentWidget()}_setAdjustedHoverWidgetDimensions(e){this._setHoverWidgetMaxDimensions("none","none");const t=e.width,i=e.height;this._setHoverWidgetDimensions(t,i)}_updateResizableNodeMaxDimensions(){const e=this._findMaximumRenderingWidth()??1/0,t=this._findMaximumRenderingHeight()??1/0;this._resizableNode.maxSize=new Ci(e,t),this._setHoverWidgetMaxDimensions(e,t)}_resize(e){qu._lastDimensions=new Ci(e.width,e.height),this._setAdjustedHoverWidgetDimensions(e),this._resizableNode.layout(e.height,e.width),this._updateResizableNodeMaxDimensions(),this._hover.scrollbar.scanDomNode(),this._editor.layoutContentWidget(this),this._onDidResize.fire()}_findAvailableSpaceVertically(){var t;const e=(t=this._renderedHover)==null?void 0:t.showAtPosition;if(e)return this._positionPreference===1?this._availableVerticalSpaceAbove(e):this._availableVerticalSpaceBelow(e)}_findMaximumRenderingHeight(){const e=this._findAvailableSpaceVertically();if(!e)return;let t=UQe;return Array.from(this._hover.contentsDomNode.children).forEach(i=>{t+=i.clientHeight}),Math.min(e,t)}_isHoverTextOverflowing(){this._hover.containerDomNode.style.setProperty("--vscode-hover-whiteSpace","nowrap"),this._hover.containerDomNode.style.setProperty("--vscode-hover-sourceWhiteSpace","nowrap");const e=Array.from(this._hover.contentsDomNode.children).some(t=>t.scrollWidth>t.clientWidth);return this._hover.containerDomNode.style.removeProperty("--vscode-hover-whiteSpace"),this._hover.containerDomNode.style.removeProperty("--vscode-hover-sourceWhiteSpace"),e}_findMaximumRenderingWidth(){if(!this._editor||!this._editor.hasModel())return;const e=this._isHoverTextOverflowing(),t=typeof this._contentWidth>"u"?0:this._contentWidth-2;return e||this._hover.containerDomNode.clientWidth<t?qm(this._hover.containerDomNode.ownerDocument.body).width-14:this._hover.containerDomNode.clientWidth+2}isMouseGettingCloser(e,t){if(!this._renderedHover)return!1;if(this._renderedHover.initialMousePosX===void 0||this._renderedHover.initialMousePosY===void 0)return this._renderedHover.initialMousePosX=e,this._renderedHover.initialMousePosY=t,!1;const i=Pn(this.getDomNode());this._renderedHover.closestMouseDistance===void 0&&(this._renderedHover.closestMouseDistance=zre(this._renderedHover.initialMousePosX,this._renderedHover.initialMousePosY,i.left,i.top,i.width,i.height));const n=zre(e,t,i.left,i.top,i.width,i.height);return n>this._renderedHover.closestMouseDistance+4?!1:(this._renderedHover.closestMouseDistance=Math.min(this._renderedHover.closestMouseDistance,n),!0)}_setRenderedHover(e){var t;(t=this._renderedHover)==null||t.dispose(),this._renderedHover=e,this._hoverVisibleKey.set(!!e),this._hover.containerDomNode.classList.toggle("hidden",!e)}_updateFont(){const{fontSize:e,lineHeight:t}=this._editor.getOption(50),i=this._hover.contentsDomNode;i.style.fontSize=`${e}px`,i.style.lineHeight=`${t/e}`,Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName("code")).forEach(r=>this._editor.applyFontInfo(r))}_updateContent(e){const t=this._hover.contentsDomNode;t.style.paddingBottom="",t.textContent="",t.appendChild(e)}_layoutContentWidget(){this._editor.layoutContentWidget(this),this._hover.onContentsChanged()}_updateMaxDimensions(){const e=Math.max(this._editor.getLayoutInfo().height/4,250,qu._lastDimensions.height),t=Math.max(this._editor.getLayoutInfo().width*.66,500,qu._lastDimensions.width);this._setHoverWidgetMaxDimensions(t,e)}_render(e){this._setRenderedHover(e),this._updateFont(),this._updateContent(e.domNode),this._updateMaxDimensions(),this.onContentsChanged(),this._editor.render()}getPosition(){return this._renderedHover?{position:this._renderedHover.showAtPosition,secondaryPosition:this._renderedHover.showAtSecondaryPosition,positionAffinity:this._renderedHover.shouldAppearBeforeContent?3:void 0,preference:[this._positionPreference??1]}:null}show(e){var o;if(!this._editor||!this._editor.hasModel())return;this._render(e);const t=$f(this._hover.containerDomNode),i=e.showAtPosition;this._positionPreference=this._findPositionPreference(t,i)??1,this.onContentsChanged(),e.shouldFocus&&this._hover.containerDomNode.focus(),this._onDidResize.fire();const r=this._hover.containerDomNode.ownerDocument.activeElement===this._hover.containerDomNode&&xfe(this._configurationService.getValue("accessibility.verbosity.hover")===!0&&this._accessibilityService.isScreenReaderOptimized(),((o=this._keybindingService.lookupKeybinding("editor.action.accessibleView"))==null?void 0:o.getAriaLabel())??"");r&&(this._hover.contentsDomNode.ariaLabel=this._hover.contentsDomNode.textContent+", "+r)}hide(){if(!this._renderedHover)return;const e=this._renderedHover.shouldFocus||this._hoverFocusedKey.get();this._setRenderedHover(void 0),this._resizableNode.maxSize=new Ci(1/0,1/0),this._resizableNode.clearSashHoverState(),this._hoverFocusedKey.set(!1),this._editor.layoutContentWidget(this),e&&this._editor.focus()}_removeConstraintsRenderNormally(){const e=this._editor.getLayoutInfo();this._resizableNode.layout(e.height,e.width),this._setHoverWidgetDimensions("auto","auto")}setMinimumDimensions(e){this._minimumSize=new Ci(Math.max(this._minimumSize.width,e.width),Math.max(this._minimumSize.height,e.height)),this._updateMinimumWidth()}_updateMinimumWidth(){const e=typeof this._contentWidth>"u"?this._minimumSize.width:Math.min(this._contentWidth,this._minimumSize.width);this._resizableNode.minSize=new Ci(e,this._minimumSize.height)}onContentsChanged(){var n;this._removeConstraintsRenderNormally();const e=this._hover.containerDomNode;let t=$f(e),i=ya(e);if(this._resizableNode.layout(t,i),this._setHoverWidgetDimensions(i,t),t=$f(e),i=ya(e),this._contentWidth=i,this._updateMinimumWidth(),this._resizableNode.layout(t,i),(n=this._renderedHover)!=null&&n.showAtPosition){const r=$f(this._hover.containerDomNode);this._positionPreference=this._findPositionPreference(r,this._renderedHover.showAtPosition)}this._layoutContentWidget()}focus(){this._hover.containerDomNode.focus()}scrollUp(){const e=this._hover.scrollbar.getScrollPosition().scrollTop,t=this._editor.getOption(50);this._hover.scrollbar.setScrollPosition({scrollTop:e-t.lineHeight})}scrollDown(){const e=this._hover.scrollbar.getScrollPosition().scrollTop,t=this._editor.getOption(50);this._hover.scrollbar.setScrollPosition({scrollTop:e+t.lineHeight})}scrollLeft(){const e=this._hover.scrollbar.getScrollPosition().scrollLeft;this._hover.scrollbar.setScrollPosition({scrollLeft:e-Hre})}scrollRight(){const e=this._hover.scrollbar.getScrollPosition().scrollLeft;this._hover.scrollbar.setScrollPosition({scrollLeft:e+Hre})}pageUp(){const e=this._hover.scrollbar.getScrollPosition().scrollTop,t=this._hover.scrollbar.getScrollDimensions().height;this._hover.scrollbar.setScrollPosition({scrollTop:e-t})}pageDown(){const e=this._hover.scrollbar.getScrollPosition().scrollTop,t=this._hover.scrollbar.getScrollDimensions().height;this._hover.scrollbar.setScrollPosition({scrollTop:e+t})}goToTop(){this._hover.scrollbar.setScrollPosition({scrollTop:0})}goToBottom(){this._hover.scrollbar.setScrollPosition({scrollTop:this._hover.scrollbar.getScrollDimensions().scrollHeight})}},qu=wm,wm.ID="editor.contrib.resizableContentHoverWidget",wm._lastDimensions=new Ci(0,0),wm);Bz=qu=zQe([VN(1,ct),VN(2,At),VN(3,Wa),VN(4,pi)],Bz);function zre(s,e,t,i,n,r){const o=t+n/2,a=i+r/2,l=Math.max(Math.abs(s-o)-n/2,0),c=Math.max(Math.abs(e-a)-r/2,0);return Math.sqrt(l*l+c*c)}class AP{get anchor(){return this._anchor}set anchor(e){this._anchor=e}get shouldFocus(){return this._shouldFocus}set shouldFocus(e){this._shouldFocus=e}get source(){return this._source}set source(e){this._source=e}get insistOnKeepingHoverVisible(){return this._insistOnKeepingHoverVisible}set insistOnKeepingHoverVisible(e){this._insistOnKeepingHoverVisible=e}constructor(e,t){this._editor=e,this._participants=t,this._anchor=null,this._shouldFocus=!1,this._source=0,this._insistOnKeepingHoverVisible=!1}static _getLineDecorations(e,t){if(t.type!==1&&!t.supportsMarkerHover)return[];const i=e.getModel(),n=t.range.startLineNumber;if(n>i.getLineCount())return[];const r=i.getLineMaxColumn(n);return e.getLineDecorations(n).filter(o=>{if(o.options.isWholeLine)return!0;const a=o.range.startLineNumber===n?o.range.startColumn:1,l=o.range.endLineNumber===n?o.range.endColumn:r;if(o.options.showIfCollapsed){if(a>t.range.startColumn+1||t.range.endColumn-1>l)return!1}else if(a>t.range.startColumn||t.range.endColumn>l)return!1;return!0})}computeAsync(e){const t=this._anchor;if(!this._editor.hasModel()||!t)return Cl.EMPTY;const i=AP._getLineDecorations(this._editor,t);return Cl.merge(this._participants.map(n=>n.computeAsync?n.computeAsync(t,i,e):Cl.EMPTY))}computeSync(){if(!this._editor.hasModel()||!this._anchor)return[];const e=AP._getLineDecorations(this._editor,this._anchor);let t=[];for(const i of this._participants)t=t.concat(i.computeSync(this._anchor,e));return rd(t)}}class U_e{constructor(e,t,i){this.anchor=e,this.hoverParts=t,this.isComplete=i}filter(e){const t=this.hoverParts.filter(i=>i.isValidForHoverAnchor(e));return t.length===this.hoverParts.length?this:new jQe(this,this.anchor,t,this.isComplete)}}class jQe extends U_e{constructor(e,t,i,n){super(t,i,n),this.original=e}filter(e){return this.original.filter(e)}}var $Qe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},qQe=function(s,e){return function(t,i){e(t,i,s)}};const Ure=ke;let PP=class extends te{get hasContent(){return this._hasContent}constructor(e){super(),this._keybindingService=e,this.actions=[],this._hasContent=!1,this.hoverElement=Ure("div.hover-row.status-bar"),this.hoverElement.tabIndex=0,this.actionsElement=me(this.hoverElement,Ure("div.actions"))}addAction(e){const t=this._keybindingService.lookupKeybinding(e.commandId),i=t?t.getLabel():null;this._hasContent=!0;const n=this._register(TF.render(this.actionsElement,e,i));return this.actions.push(n),n}append(e){const t=me(this.actionsElement,e);return this._hasContent=!0,t}};PP=$Qe([qQe(0,pi)],PP);class KQe{constructor(e,t,i){this.provider=e,this.hover=t,this.ordinal=i}}async function GQe(s,e,t,i,n){const r=await Promise.resolve(s.provideHover(t,i,n)).catch(Mn);if(!(!r||!QQe(r)))return new KQe(s,r,e)}function bQ(s,e,t,i,n=!1){const o=s.ordered(e,n).map((a,l)=>GQe(a,l,e,t,i));return Cl.fromPromises(o).coalesce()}function j_e(s,e,t,i,n=!1){return bQ(s,e,t,i,n).map(r=>r.hover).toPromise()}aa("_executeHoverProvider",(s,e,t)=>{const i=s.get(Be);return j_e(i.hoverProvider,e,t,kt.None)});aa("_executeHoverProvider_recursive",(s,e,t)=>{const i=s.get(Be);return j_e(i.hoverProvider,e,t,kt.None,!0)});function QQe(s){const e=typeof s.range<"u",t=typeof s.contents<"u"&&s.contents&&s.contents.length>0;return e&&t}var YQe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Z_=function(s,e){return function(t,i){e(t,i,s)}};const WC=ke,XQe=Qi("hover-increase-verbosity",xe.add,b("increaseHoverVerbosity","Icon for increaseing hover verbosity.")),ZQe=Qi("hover-decrease-verbosity",xe.remove,b("decreaseHoverVerbosity","Icon for decreasing hover verbosity."));class Yc{constructor(e,t,i,n,r,o=void 0){this.owner=e,this.range=t,this.contents=i,this.isBeforeContent=n,this.ordinal=r,this.source=o}isValidForHoverAnchor(e){return e.type===1&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}class $_e{constructor(e,t,i){this.hover=e,this.hoverProvider=t,this.hoverPosition=i}supportsVerbosityAction(e){switch(e){case La.Increase:return this.hover.canIncreaseVerbosity??!1;case La.Decrease:return this.hover.canDecreaseVerbosity??!1}}}let oE=class{constructor(e,t,i,n,r,o,a,l){this._editor=e,this._languageService=t,this._openerService=i,this._configurationService=n,this._languageFeaturesService=r,this._keybindingService=o,this._hoverService=a,this._commandService=l,this.hoverOrdinal=3}createLoadingMessage(e){return new Yc(this,e.range,[new Lr().appendText(b("modesContentHover.loading","Loading..."))],!1,2e3)}computeSync(e,t){if(!this._editor.hasModel()||e.type!==1)return[];const i=this._editor.getModel(),n=e.range.startLineNumber,r=i.getLineMaxColumn(n),o=[];let a=1e3;const l=i.getLineLength(n),c=i.getLanguageIdAtPosition(e.range.startLineNumber,e.range.startColumn),d=this._editor.getOption(118),u=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:c});let h=!1;d>=0&&l>d&&e.range.startColumn>=d&&(h=!0,o.push(new Yc(this,e.range,[{value:b("stopped rendering","Rendering paused for long line for performance reasons. This can be configured via `editor.stopRenderingLineAfter`.")}],!1,a++))),!h&&typeof u=="number"&&l>=u&&o.push(new Yc(this,e.range,[{value:b("too many characters","Tokenization is skipped for long lines for performance reasons. This can be configured via `editor.maxTokenizationLineLength`.")}],!1,a++));let g=!1;for(const p of t){const _=p.range.startLineNumber===n?p.range.startColumn:1,v=p.range.endLineNumber===n?p.range.endColumn:r,C=p.options.hoverMessage;if(!C||y1(C))continue;p.options.beforeContentClassName&&(g=!0);const y=new F(e.range.startLineNumber,_,e.range.startLineNumber,v);o.push(new Yc(this,y,mq(C),g,a++))}return o}computeAsync(e,t,i){if(!this._editor.hasModel()||e.type!==1)return Cl.EMPTY;const n=this._editor.getModel(),r=this._languageFeaturesService.hoverProvider;return r.has(n)?this._getMarkdownHovers(r,n,e,i):Cl.EMPTY}_getMarkdownHovers(e,t,i,n){const r=i.range.getStartPosition();return bQ(e,t,r,n).filter(l=>!y1(l.hover.contents)).map(l=>{const c=l.hover.range?F.lift(l.hover.range):i.range,d=new $_e(l.hover,l.provider,r);return new Yc(this,c,l.hover.contents,!1,l.ordinal,d)})}renderHoverParts(e,t){return this._renderedHoverParts=new JQe(t,e.fragment,this,this._editor,this._languageService,this._openerService,this._commandService,this._keybindingService,this._hoverService,this._configurationService,e.onContentsChanged),this._renderedHoverParts}updateMarkdownHoverVerbosityLevel(e,t,i){var n;return Promise.resolve((n=this._renderedHoverParts)==null?void 0:n.updateMarkdownHoverPartVerbosityLevel(e,t,i))}};oE=YQe([Z_(1,un),Z_(2,la),Z_(3,At),Z_(4,Be),Z_(5,pi),Z_(6,Kh),Z_(7,Hi)],oE);class BN{constructor(e,t,i){this.hoverPart=e,this.hoverElement=t,this.disposables=i}dispose(){this.disposables.dispose()}}class JQe{constructor(e,t,i,n,r,o,a,l,c,d,u){this._hoverParticipant=i,this._editor=n,this._languageService=r,this._openerService=o,this._commandService=a,this._keybindingService=l,this._hoverService=c,this._configurationService=d,this._onFinishedRendering=u,this._ongoingHoverOperations=new Map,this._disposables=new ce,this.renderedHoverParts=this._renderHoverParts(e,t,this._onFinishedRendering),this._disposables.add(Ye(()=>{this.renderedHoverParts.forEach(h=>{h.dispose()}),this._ongoingHoverOperations.forEach(h=>{h.tokenSource.dispose(!0)})}))}_renderHoverParts(e,t,i){return e.sort(Co(n=>n.ordinal,td)),e.map(n=>{const r=this._renderHoverPart(n,i);return t.appendChild(r.hoverElement),r})}_renderHoverPart(e,t){const i=this._renderMarkdownHover(e,t),n=i.hoverElement,r=e.source,o=new ce;if(o.add(i),!r)return new BN(e,n,o);const a=r.supportsVerbosityAction(La.Increase),l=r.supportsVerbosityAction(La.Decrease);if(!a&&!l)return new BN(e,n,o);const c=WC("div.verbosity-actions");return n.prepend(c),o.add(this._renderHoverExpansionAction(c,La.Increase,a)),o.add(this._renderHoverExpansionAction(c,La.Decrease,l)),new BN(e,n,o)}_renderMarkdownHover(e,t){return q_e(this._editor,e,this._languageService,this._openerService,t)}_renderHoverExpansionAction(e,t,i){const n=new ce,r=t===La.Increase,o=me(e,WC(at.asCSSSelector(r?XQe:ZQe)));o.tabIndex=0;const a=new v1("mouse",!1,{target:e,position:{hoverPosition:0}},this._configurationService,this._hoverService);if(n.add(this._hoverService.setupManagedHover(a,o,tYe(this._keybindingService,t))),!i)return o.classList.add("disabled"),n;o.classList.add("enabled");const l=()=>this._commandService.executeCommand(t===La.Increase?p5:m5);return n.add(new Lfe(o,l)),n.add(new kfe(o,l,[3,10])),n}async updateMarkdownHoverPartVerbosityLevel(e,t,i=!0){const n=this._editor.getModel();if(!n)return;const r=this._getRenderedHoverPartAtIndex(t),o=r==null?void 0:r.hoverPart.source;if(!r||!(o!=null&&o.supportsVerbosityAction(e)))return;const a=await this._fetchHover(o,n,e);if(!a)return;const l=new $_e(a,o.hoverProvider,o.hoverPosition),c=r.hoverPart,d=new Yc(this._hoverParticipant,c.range,a.contents,c.isBeforeContent,c.ordinal,l),u=this._renderHoverPart(d,this._onFinishedRendering);return this._replaceRenderedHoverPartAtIndex(t,u,d),i&&this._focusOnHoverPartWithIndex(t),{hoverPart:d,hoverElement:u.hoverElement}}async _fetchHover(e,t,i){let n=i===La.Increase?1:-1;const r=e.hoverProvider,o=this._ongoingHoverOperations.get(r);o&&(o.tokenSource.cancel(),n+=o.verbosityDelta);const a=new mn;this._ongoingHoverOperations.set(r,{verbosityDelta:n,tokenSource:a});const l={verbosityRequest:{verbosityDelta:n,previousHover:e.hover}};let c;try{c=await Promise.resolve(r.provideHover(t,e.hoverPosition,a.token,l))}catch(d){Mn(d)}return a.dispose(),this._ongoingHoverOperations.delete(r),c}_replaceRenderedHoverPartAtIndex(e,t,i){if(e>=this.renderedHoverParts.length||e<0)return;const n=this.renderedHoverParts[e],r=n.hoverElement,o=t.hoverElement,a=Array.from(o.children);r.replaceChildren(...a);const l=new BN(i,r,t.disposables);r.focus(),n.dispose(),this.renderedHoverParts[e]=l}_focusOnHoverPartWithIndex(e){this.renderedHoverParts[e].hoverElement.focus()}_getRenderedHoverPartAtIndex(e){return this.renderedHoverParts[e]}dispose(){this._disposables.dispose()}}function eYe(s,e,t,i,n){e.sort(Co(o=>o.ordinal,td));const r=[];for(const o of e)r.push(q_e(t,o,i,n,s.onContentsChanged));return new Dw(r)}function q_e(s,e,t,i,n){const r=new ce,o=WC("div.hover-row"),a=WC("div.hover-row-contents");o.appendChild(a);const l=e.contents;for(const d of l){if(y1(d))continue;const u=WC("div.markdown-hover"),h=me(u,WC("div.hover-contents")),g=r.add(new kg({editor:s},t,i));r.add(g.onDidRenderAsync(()=>{h.className="hover-contents code-hover-contents",n()}));const p=r.add(g.render(d));h.appendChild(p.element),a.appendChild(u)}return{hoverPart:e,hoverElement:o,dispose(){r.dispose()}}}function tYe(s,e){switch(e){case La.Increase:{const t=s.lookupKeybinding(p5);return t?b("increaseVerbosityWithKb","Increase Hover Verbosity ({0})",t.getLabel()):b("increaseVerbosity","Increase Hover Verbosity")}case La.Decrease:{const t=s.lookupKeybinding(m5);return t?b("decreaseVerbosityWithKb","Decrease Hover Verbosity ({0})",t.getLabel()):b("decreaseVerbosity","Decrease Hover Verbosity")}}}function Wz(s,e){return!!s[e]}class kB{constructor(e,t){this.target=e.target,this.isLeftClick=e.event.leftButton,this.isMiddleClick=e.event.middleButton,this.isRightClick=e.event.rightButton,this.hasTriggerModifier=Wz(e.event,t.triggerModifier),this.hasSideBySideModifier=Wz(e.event,t.triggerSideBySideModifier),this.isNoneOrSingleMouseDown=e.event.detail<=1}}class jre{constructor(e,t){this.keyCodeIsTriggerKey=e.keyCode===t.triggerKey,this.keyCodeIsSideBySideKey=e.keyCode===t.triggerSideBySideKey,this.hasTriggerModifier=Wz(e,t.triggerModifier)}}class WN{constructor(e,t,i,n){this.triggerKey=e,this.triggerModifier=t,this.triggerSideBySideKey=i,this.triggerSideBySideModifier=n}equals(e){return this.triggerKey===e.triggerKey&&this.triggerModifier===e.triggerModifier&&this.triggerSideBySideKey===e.triggerSideBySideKey&&this.triggerSideBySideModifier===e.triggerSideBySideModifier}}function $re(s){return s==="altKey"?Wt?new WN(57,"metaKey",6,"altKey"):new WN(5,"ctrlKey",6,"altKey"):Wt?new WN(6,"altKey",57,"metaKey"):new WN(6,"altKey",5,"ctrlKey")}class b5 extends te{constructor(e,t){super(),this._onMouseMoveOrRelevantKeyDown=this._register(new Z),this.onMouseMoveOrRelevantKeyDown=this._onMouseMoveOrRelevantKeyDown.event,this._onExecute=this._register(new Z),this.onExecute=this._onExecute.event,this._onCancel=this._register(new Z),this.onCancel=this._onCancel.event,this._editor=e,this._extractLineNumberFromMouseEvent=(t==null?void 0:t.extractLineNumberFromMouseEvent)??(i=>i.target.position?i.target.position.lineNumber:0),this._opts=$re(this._editor.getOption(78)),this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._lineNumberOnMouseDown=0,this._register(this._editor.onDidChangeConfiguration(i=>{if(i.hasChanged(78)){const n=$re(this._editor.getOption(78));if(this._opts.equals(n))return;this._opts=n,this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._lineNumberOnMouseDown=0,this._onCancel.fire()}})),this._register(this._editor.onMouseMove(i=>this._onEditorMouseMove(new kB(i,this._opts)))),this._register(this._editor.onMouseDown(i=>this._onEditorMouseDown(new kB(i,this._opts)))),this._register(this._editor.onMouseUp(i=>this._onEditorMouseUp(new kB(i,this._opts)))),this._register(this._editor.onKeyDown(i=>this._onEditorKeyDown(new jre(i,this._opts)))),this._register(this._editor.onKeyUp(i=>this._onEditorKeyUp(new jre(i,this._opts)))),this._register(this._editor.onMouseDrag(()=>this._resetHandler())),this._register(this._editor.onDidChangeCursorSelection(i=>this._onDidChangeCursorSelection(i))),this._register(this._editor.onDidChangeModel(i=>this._resetHandler())),this._register(this._editor.onDidChangeModelContent(()=>this._resetHandler())),this._register(this._editor.onDidScrollChange(i=>{(i.scrollTopChanged||i.scrollLeftChanged)&&this._resetHandler()}))}_onDidChangeCursorSelection(e){e.selection&&e.selection.startColumn!==e.selection.endColumn&&this._resetHandler()}_onEditorMouseMove(e){this._lastMouseMoveEvent=e,this._onMouseMoveOrRelevantKeyDown.fire([e,null])}_onEditorMouseDown(e){this._hasTriggerKeyOnMouseDown=e.hasTriggerModifier,this._lineNumberOnMouseDown=this._extractLineNumberFromMouseEvent(e)}_onEditorMouseUp(e){const t=this._extractLineNumberFromMouseEvent(e);this._hasTriggerKeyOnMouseDown&&this._lineNumberOnMouseDown&&this._lineNumberOnMouseDown===t&&this._onExecute.fire(e)}_onEditorKeyDown(e){this._lastMouseMoveEvent&&(e.keyCodeIsTriggerKey||e.keyCodeIsSideBySideKey&&e.hasTriggerModifier)?this._onMouseMoveOrRelevantKeyDown.fire([this._lastMouseMoveEvent,e]):e.hasTriggerModifier&&this._onCancel.fire()}_onEditorKeyUp(e){e.keyCodeIsTriggerKey&&this._onCancel.fire()}_resetHandler(){this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._onCancel.fire()}}class K_e{constructor(e,t){this.range=e,this.direction=t}}class vQ{constructor(e,t,i){this.hint=e,this.anchor=t,this.provider=i,this._isResolved=!1}with(e){const t=new vQ(this.hint,e.anchor,this.provider);return t._isResolved=this._isResolved,t._currentResolve=this._currentResolve,t}async resolve(e){if(typeof this.provider.resolveInlayHint=="function"){if(this._currentResolve)return await this._currentResolve,e.isCancellationRequested?void 0:this.resolve(e);this._isResolved||(this._currentResolve=this._doResolve(e).finally(()=>this._currentResolve=void 0)),await this._currentResolve}}async _doResolve(e){try{const t=await Promise.resolve(this.provider.resolveInlayHint(this.hint,e));this.hint.tooltip=(t==null?void 0:t.tooltip)??this.hint.tooltip,this.hint.label=(t==null?void 0:t.label)??this.hint.label,this.hint.textEdits=(t==null?void 0:t.textEdits)??this.hint.textEdits,this._isResolved=!0}catch(t){Mn(t),this._isResolved=!1}}}const ny=class ny{static async create(e,t,i,n){const r=[],o=e.ordered(t).reverse().map(a=>i.map(async l=>{try{const c=await a.provideInlayHints(t,l,n);(c!=null&&c.hints.length||a.onDidChangeInlayHints)&&r.push([c??ny._emptyInlayHintList,a])}catch(c){Mn(c)}}));if(await Promise.all(o.flat()),n.isCancellationRequested||t.isDisposed())throw new od;return new ny(i,r,t)}constructor(e,t,i){this._disposables=new ce,this.ranges=e,this.provider=new Set;const n=[];for(const[r,o]of t){this._disposables.add(r),this.provider.add(o);for(const a of r.hints){const l=i.validatePosition(a.position);let c="before";const d=ny._getRangeAtPosition(i,l);let u;d.getStartPosition().isBefore(l)?(u=F.fromPositions(d.getStartPosition(),l),c="after"):(u=F.fromPositions(l,d.getEndPosition()),c="before"),n.push(new vQ(a,new K_e(u,c),o))}}this.items=n.sort((r,o)=>X.compare(r.hint.position,o.hint.position))}dispose(){this._disposables.dispose()}static _getRangeAtPosition(e,t){const i=t.lineNumber,n=e.getWordAtPosition(t);if(n)return new F(i,n.startColumn,i,n.endColumn);e.tokenization.tokenizeIfCheap(i);const r=e.tokenization.getLineTokens(i),o=t.column-1,a=r.findTokenIndexAtOffset(o);let l=r.getStartOffset(a),c=r.getEndOffset(a);return c-l===1&&(l===o&&a>1?(l=r.getStartOffset(a-1),c=r.getEndOffset(a-1)):c===o&&a<r.getCount()-1&&(l=r.getStartOffset(a+1),c=r.getEndOffset(a+1))),new F(i,l+1,i,c+1)}};ny._emptyInlayHintList=Object.freeze({dispose(){},hints:[]});let MP=ny;function iYe(s){return Je.from({scheme:gt.command,path:s.id,query:s.arguments&&encodeURIComponent(JSON.stringify(s.arguments))}).toString()}var nYe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},gf=function(s,e){return function(t,i){e(t,i,s)}};let hd=class extends $I{constructor(e,t,i,n,r,o,a,l,c,d,u,h,g){super(e,{...n.getRawOptions(),overflowWidgetsDomNode:n.getOverflowWidgetsDomNode()},i,r,o,a,l,c,d,u,h,g),this._parentEditor=n,this._overwriteOptions=t,super.updateOptions(this._overwriteOptions),this._register(n.onDidChangeConfiguration(p=>this._onParentConfigurationChanged(p)))}getParentEditor(){return this._parentEditor}_onParentConfigurationChanged(e){super.updateOptions(this._parentEditor.getRawOptions()),super.updateOptions(this._overwriteOptions)}updateOptions(e){G4(this._overwriteOptions,e,!0),super.updateOptions(this._overwriteOptions)}};hd=nYe([gf(4,Xe),gf(5,ni),gf(6,Hi),gf(7,ct),gf(8,gs),gf(9,jn),gf(10,Wa),gf(11,bn),gf(12,Be)],hd);const qre=new fe(new Jt(0,122,204)),sYe={showArrow:!0,showFrame:!0,className:"",frameColor:qre,arrowColor:qre,keepEditorSelection:!1},rYe="vs.editor.contrib.zoneWidget";class oYe{constructor(e,t,i,n,r,o,a,l){this.id="",this.domNode=e,this.afterLineNumber=t,this.afterColumn=i,this.heightInLines=n,this.showInHiddenAreas=a,this.ordinal=l,this._onDomNodeTop=r,this._onComputedHeight=o}onDomNodeTop(e){this._onDomNodeTop(e)}onComputedHeight(e){this._onComputedHeight(e)}}class aYe{constructor(e,t){this._id=e,this._domNode=t}getId(){return this._id}getDomNode(){return this._domNode}getPosition(){return null}}const LO=class LO{constructor(e){this._editor=e,this._ruleName=LO._IdGenerator.nextId(),this._decorations=this._editor.createDecorationsCollection(),this._color=null,this._height=-1}dispose(){this.hide(),YW(this._ruleName)}set color(e){this._color!==e&&(this._color=e,this._updateStyle())}set height(e){this._height!==e&&(this._height=e,this._updateStyle())}_updateStyle(){YW(this._ruleName),q2(`.monaco-editor ${this._ruleName}`,`border-style: solid; border-color: transparent; border-bottom-color: ${this._color}; border-width: ${this._height}px; bottom: -${this._height}px !important; margin-left: -${this._height}px; `)}show(e){e.column===1&&(e={lineNumber:e.lineNumber,column:2}),this._decorations.set([{range:F.fromPositions(e),options:{description:"zone-widget-arrow",className:this._ruleName,stickiness:1}}])}hide(){this._decorations.clear()}};LO._IdGenerator=new kK(".arrow-decoration-");let Hz=LO;class lYe{constructor(e,t={}){this._arrow=null,this._overlayWidget=null,this._resizeSash=null,this._viewZone=null,this._disposables=new ce,this.container=null,this._isShowing=!1,this.editor=e,this._positionMarkerId=this.editor.createDecorationsCollection(),this.options=Ef(t),G4(this.options,sYe,!1),this.domNode=document.createElement("div"),this.options.isAccessible||(this.domNode.setAttribute("aria-hidden","true"),this.domNode.setAttribute("role","presentation")),this._disposables.add(this.editor.onDidLayoutChange(i=>{const n=this._getWidth(i);this.domNode.style.width=n+"px",this.domNode.style.left=this._getLeft(i)+"px",this._onWidth(n)}))}dispose(){this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),this._viewZone&&this.editor.changeViewZones(e=>{this._viewZone&&e.removeZone(this._viewZone.id),this._viewZone=null}),this._positionMarkerId.clear(),this._disposables.dispose()}create(){this.domNode.classList.add("zone-widget"),this.options.className&&this.domNode.classList.add(this.options.className),this.container=document.createElement("div"),this.container.classList.add("zone-widget-container"),this.domNode.appendChild(this.container),this.options.showArrow&&(this._arrow=new Hz(this.editor),this._disposables.add(this._arrow)),this._fillContainer(this.container),this._initSash(),this._applyStyles()}style(e){e.frameColor&&(this.options.frameColor=e.frameColor),e.arrowColor&&(this.options.arrowColor=e.arrowColor),this._applyStyles()}_applyStyles(){if(this.container&&this.options.frameColor){const e=this.options.frameColor.toString();this.container.style.borderTopColor=e,this.container.style.borderBottomColor=e}if(this._arrow&&this.options.arrowColor){const e=this.options.arrowColor.toString();this._arrow.color=e}}_getWidth(e){return e.width-e.minimap.minimapWidth-e.verticalScrollbarWidth}_getLeft(e){return e.minimap.minimapWidth>0&&e.minimap.minimapLeft===0?e.minimap.minimapWidth:0}_onViewZoneTop(e){this.domNode.style.top=e+"px"}_onViewZoneHeight(e){var t;if(this.domNode.style.height=`${e}px`,this.container){const i=e-this._decoratingElementsHeight();this.container.style.height=`${i}px`;const n=this.editor.getLayoutInfo();this._doLayout(i,this._getWidth(n))}(t=this._resizeSash)==null||t.layout()}get position(){const e=this._positionMarkerId.getRange(0);if(e)return e.getStartPosition()}show(e,t){const i=F.isIRange(e)?F.lift(e):F.fromPositions(e);this._isShowing=!0,this._showImpl(i,t),this._isShowing=!1,this._positionMarkerId.set([{range:i,options:_t.EMPTY}])}hide(){var e;this._viewZone&&(this.editor.changeViewZones(t=>{this._viewZone&&t.removeZone(this._viewZone.id)}),this._viewZone=null),this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),(e=this._arrow)==null||e.hide(),this._positionMarkerId.clear()}_decoratingElementsHeight(){const e=this.editor.getOption(67);let t=0;if(this.options.showArrow){const i=Math.round(e/3);t+=2*i}if(this.options.showFrame){const i=Math.round(e/9);t+=2*i}return t}_showImpl(e,t){const i=e.getStartPosition(),n=this.editor.getLayoutInfo(),r=this._getWidth(n);this.domNode.style.width=`${r}px`,this.domNode.style.left=this._getLeft(n)+"px";const o=document.createElement("div");o.style.overflow="hidden";const a=this.editor.getOption(67);if(!this.options.allowUnlimitedHeight){const h=Math.max(12,this.editor.getLayoutInfo().height/a*.8);t=Math.min(t,h)}let l=0,c=0;if(this._arrow&&this.options.showArrow&&(l=Math.round(a/3),this._arrow.height=l,this._arrow.show(i)),this.options.showFrame&&(c=Math.round(a/9)),this.editor.changeViewZones(h=>{this._viewZone&&h.removeZone(this._viewZone.id),this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),this.domNode.style.top="-1000px",this._viewZone=new oYe(o,i.lineNumber,i.column,t,g=>this._onViewZoneTop(g),g=>this._onViewZoneHeight(g),this.options.showInHiddenAreas,this.options.ordinal),this._viewZone.id=h.addZone(this._viewZone),this._overlayWidget=new aYe(rYe+this._viewZone.id,this.domNode),this.editor.addOverlayWidget(this._overlayWidget)}),this.container&&this.options.showFrame){const h=this.options.frameWidth?this.options.frameWidth:c;this.container.style.borderTopWidth=h+"px",this.container.style.borderBottomWidth=h+"px"}const d=t*a-this._decoratingElementsHeight();this.container&&(this.container.style.top=l+"px",this.container.style.height=d+"px",this.container.style.overflow="hidden"),this._doLayout(d,r),this.options.keepEditorSelection||this.editor.setSelection(e);const u=this.editor.getModel();if(u){const h=u.validateRange(new F(e.startLineNumber,1,e.endLineNumber+1,1));this.revealRange(h,h.startLineNumber===u.getLineCount())}}revealRange(e,t){t?this.editor.revealLineNearTop(e.endLineNumber,0):this.editor.revealRange(e,0)}setCssClass(e,t){this.container&&(t&&this.container.classList.remove(t),this.container.classList.add(e))}_onWidth(e){}_doLayout(e,t){}_relayout(e){this._viewZone&&this._viewZone.heightInLines!==e&&this.editor.changeViewZones(t=>{this._viewZone&&(this._viewZone.heightInLines=e,t.layoutZone(this._viewZone.id))})}_initSash(){if(this._resizeSash)return;this._resizeSash=this._disposables.add(new Sr(this.domNode,this,{orientation:1})),this.options.isResizeable||(this._resizeSash.state=0);let e;this._disposables.add(this._resizeSash.onDidStart(t=>{this._viewZone&&(e={startY:t.startY,heightInLines:this._viewZone.heightInLines})})),this._disposables.add(this._resizeSash.onDidEnd(()=>{e=void 0})),this._disposables.add(this._resizeSash.onDidChange(t=>{if(e){const i=(t.currentY-e.startY)/this.editor.getOption(67),n=i<0?Math.ceil(i):Math.floor(i),r=e.heightInLines+n;r>5&&r<35&&this._relayout(r)}}))}getHorizontalSashLeft(){return 0}getHorizontalSashTop(){return(this.domNode.style.height===null?0:parseInt(this.domNode.style.height))-this._decoratingElementsHeight()/2}getHorizontalSashWidth(){const e=this.editor.getLayoutInfo();return e.width-e.minimap.minimapWidth}}var G_e=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Q_e=function(s,e){return function(t,i){e(t,i,s)}};const Y_e=Ht("IPeekViewService");qt(Y_e,class{constructor(){this._widgets=new Map}addExclusiveWidget(s,e){const t=this._widgets.get(s);t&&(t.listener.dispose(),t.widget.dispose());const i=()=>{const n=this._widgets.get(s);n&&n.widget===e&&(n.listener.dispose(),this._widgets.delete(s))};this._widgets.set(s,{widget:e,listener:e.onDidClose(i)})}},1);var sa;(function(s){s.inPeekEditor=new Oe("inReferenceSearchEditor",!0,b("inReferenceSearchEditor","Whether the current code editor is embedded inside peek")),s.notInPeekEditor=s.inPeekEditor.toNegated()})(sa||(sa={}));var zy;let OP=(zy=class{constructor(e,t){e instanceof hd&&sa.inPeekEditor.bindTo(t)}dispose(){}},zy.ID="editor.contrib.referenceController",zy);OP=G_e([Q_e(1,ct)],OP);Zt(OP.ID,OP,0);function cYe(s){const e=s.get(ni).getFocusedCodeEditor();return e instanceof hd?e.getParentEditor():e}const dYe={headerBackgroundColor:fe.white,primaryHeadingColor:fe.fromHex("#333333"),secondaryHeadingColor:fe.fromHex("#6c6c6cb3")};let FP=class extends lYe{constructor(e,t,i){super(e,t),this.instantiationService=i,this._onDidClose=new Z,this.onDidClose=this._onDidClose.event,G4(this.options,dYe,!1)}dispose(){this.disposed||(this.disposed=!0,super.dispose(),this._onDidClose.fire(this))}style(e){const t=this.options;e.headerBackgroundColor&&(t.headerBackgroundColor=e.headerBackgroundColor),e.primaryHeadingColor&&(t.primaryHeadingColor=e.primaryHeadingColor),e.secondaryHeadingColor&&(t.secondaryHeadingColor=e.secondaryHeadingColor),super.style(e)}_applyStyles(){super._applyStyles();const e=this.options;this._headElement&&e.headerBackgroundColor&&(this._headElement.style.backgroundColor=e.headerBackgroundColor.toString()),this._primaryHeading&&e.primaryHeadingColor&&(this._primaryHeading.style.color=e.primaryHeadingColor.toString()),this._secondaryHeading&&e.secondaryHeadingColor&&(this._secondaryHeading.style.color=e.secondaryHeadingColor.toString()),this._bodyElement&&e.frameColor&&(this._bodyElement.style.borderColor=e.frameColor.toString())}_fillContainer(e){this.setCssClass("peekview-widget"),this._headElement=ke(".head"),this._bodyElement=ke(".body"),this._fillHead(this._headElement),this._fillBody(this._bodyElement),e.appendChild(this._headElement),e.appendChild(this._bodyElement)}_fillHead(e,t){this._titleElement=ke(".peekview-title"),this.options.supportOnTitleClick&&(this._titleElement.classList.add("clickable"),yn(this._titleElement,"click",r=>this._onTitleClick(r))),me(this._headElement,this._titleElement),this._fillTitleIcon(this._titleElement),this._primaryHeading=ke("span.filename"),this._secondaryHeading=ke("span.dirname"),this._metaHeading=ke("span.meta"),me(this._titleElement,this._primaryHeading,this._secondaryHeading,this._metaHeading);const i=ke(".peekview-actions");me(this._headElement,i);const n=this._getActionBarOptions();this._actionbarWidget=new Dl(i,n),this._disposables.add(this._actionbarWidget),t||this._actionbarWidget.push(new Na("peekview.close",b("label.close","Close"),at.asClassName(xe.close),!0,()=>(this.dispose(),Promise.resolve())),{label:!1,icon:!0})}_fillTitleIcon(e){}_getActionBarOptions(){return{actionViewItemProvider:uge.bind(void 0,this.instantiationService),orientation:0}}_onTitleClick(e){}setTitle(e,t){this._primaryHeading&&this._secondaryHeading&&(this._primaryHeading.innerText=e,this._primaryHeading.setAttribute("title",e),t?this._secondaryHeading.innerText=t:Ys(this._secondaryHeading))}setMetaTitle(e){this._metaHeading&&(e?(this._metaHeading.innerText=e,ka(this._metaHeading)):fo(this._metaHeading))}_doLayout(e,t){if(!this._isShowing&&e<0){this.dispose();return}const i=Math.ceil(this.editor.getOption(67)*1.2),n=Math.round(e-(i+2));this._doLayoutHead(i,t),this._doLayoutBody(n,t)}_doLayoutHead(e,t){this._headElement&&(this._headElement.style.height=`${e}px`,this._headElement.style.lineHeight=this._headElement.style.height)}_doLayoutBody(e,t){this._bodyElement&&(this._bodyElement.style.height=`${e}px`)}};FP=G_e([Q_e(2,Xe)],FP);const uYe=j("peekViewTitle.background",{dark:"#252526",light:"#F3F3F3",hcDark:fe.black,hcLight:fe.white},b("peekViewTitleBackground","Background color of the peek view title area.")),X_e=j("peekViewTitleLabel.foreground",{dark:fe.white,light:fe.black,hcDark:fe.white,hcLight:qh},b("peekViewTitleForeground","Color of the peek view title.")),Z_e=j("peekViewTitleDescription.foreground",{dark:"#ccccccb3",light:"#616161",hcDark:"#FFFFFF99",hcLight:"#292929"},b("peekViewTitleInfoForeground","Color of the peek view title info.")),hYe=j("peekView.border",{dark:Ph,light:Ph,hcDark:Xt,hcLight:Xt},b("peekViewBorder","Color of the peek view borders and arrow.")),fYe=j("peekViewResult.background",{dark:"#252526",light:"#F3F3F3",hcDark:fe.black,hcLight:fe.white},b("peekViewResultsBackground","Background color of the peek view result list."));j("peekViewResult.lineForeground",{dark:"#bbbbbb",light:"#646465",hcDark:fe.white,hcLight:qh},b("peekViewResultsMatchForeground","Foreground color for line nodes in the peek view result list."));j("peekViewResult.fileForeground",{dark:fe.white,light:"#1E1E1E",hcDark:fe.white,hcLight:qh},b("peekViewResultsFileForeground","Foreground color for file nodes in the peek view result list."));j("peekViewResult.selectionBackground",{dark:"#3399ff33",light:"#3399ff33",hcDark:null,hcLight:null},b("peekViewResultsSelectionBackground","Background color of the selected entry in the peek view result list."));j("peekViewResult.selectionForeground",{dark:fe.white,light:"#6C6C6C",hcDark:fe.white,hcLight:qh},b("peekViewResultsSelectionForeground","Foreground color of the selected entry in the peek view result list."));const J_e=j("peekViewEditor.background",{dark:"#001F33",light:"#F2F8FC",hcDark:fe.black,hcLight:fe.white},b("peekViewEditorBackground","Background color of the peek view editor."));j("peekViewEditorGutter.background",J_e,b("peekViewEditorGutterBackground","Background color of the gutter in the peek view editor."));j("peekViewEditorStickyScroll.background",J_e,b("peekViewEditorStickScrollBackground","Background color of sticky scroll in the peek view editor."));j("peekViewResult.matchHighlightBackground",{dark:"#ea5c004d",light:"#ea5c004d",hcDark:null,hcLight:null},b("peekViewResultsMatchHighlight","Match highlight color in the peek view result list."));j("peekViewEditor.matchHighlightBackground",{dark:"#ff8f0099",light:"#f5d802de",hcDark:null,hcLight:null},b("peekViewEditorMatchHighlight","Match highlight color in the peek view editor."));j("peekViewEditor.matchHighlightBorder",{dark:null,light:null,hcDark:tn,hcLight:tn},b("peekViewEditorMatchHighlightBorder","Match highlight border in the peek view editor."));class n_{constructor(e,t,i,n){this.isProviderFirst=e,this.parent=t,this.link=i,this._rangeCallback=n,this.id=W6.nextId()}get uri(){return this.link.uri}get range(){return this._range??this.link.targetSelectionRange??this.link.range}set range(e){this._range=e,this._rangeCallback(this)}get ariaMessage(){var t;const e=(t=this.parent.getPreview(this))==null?void 0:t.preview(this.range);return e?b({key:"aria.oneReference.preview",comment:["Placeholders are: 0: filename, 1:line number, 2: column number, 3: preview snippet of source code"]},"{0} in {1} on line {2} at column {3}",e.value,Cc(this.uri),this.range.startLineNumber,this.range.startColumn):b("aria.oneReference","in {0} on line {1} at column {2}",Cc(this.uri),this.range.startLineNumber,this.range.startColumn)}}class gYe{constructor(e){this._modelReference=e}dispose(){this._modelReference.dispose()}preview(e,t=8){const i=this._modelReference.object.textEditorModel;if(!i)return;const{startLineNumber:n,startColumn:r,endLineNumber:o,endColumn:a}=e,l=i.getWordUntilPosition({lineNumber:n,column:r-t}),c=new F(n,l.startColumn,n,r),d=new F(o,a,o,1073741824),u=i.getValueInRange(c).replace(/^\s+/,""),h=i.getValueInRange(e),g=i.getValueInRange(d).replace(/\s+$/,"");return{value:u+h+g,highlight:{start:u.length,end:u.length+h.length}}}}class aE{constructor(e,t){this.parent=e,this.uri=t,this.children=[],this._previews=new Fs}dispose(){Ni(this._previews.values()),this._previews.clear()}getPreview(e){return this._previews.get(e.uri)}get ariaMessage(){const e=this.children.length;return e===1?b("aria.fileReferences.1","1 symbol in {0}, full path {1}",Cc(this.uri),this.uri.fsPath):b("aria.fileReferences.N","{0} symbols in {1}, full path {2}",e,Cc(this.uri),this.uri.fsPath)}async resolve(e){if(this._previews.size!==0)return this;for(const t of this.children)if(!this._previews.has(t.uri))try{const i=await e.createModelReference(t.uri);this._previews.set(t.uri,new gYe(i))}catch(i){ft(i)}return this}}class Pa{constructor(e,t){this.groups=[],this.references=[],this._onDidChangeReferenceRange=new Z,this.onDidChangeReferenceRange=this._onDidChangeReferenceRange.event,this._links=e,this._title=t;const[i]=e;e.sort(Pa._compareReferences);let n;for(const r of e)if((!n||!nn.isEqual(n.uri,r.uri,!0))&&(n=new aE(this,r.uri),this.groups.push(n)),n.children.length===0||Pa._compareReferences(r,n.children[n.children.length-1])!==0){const o=new n_(i===r,n,r,a=>this._onDidChangeReferenceRange.fire(a));this.references.push(o),n.children.push(o)}}dispose(){Ni(this.groups),this._onDidChangeReferenceRange.dispose(),this.groups.length=0}clone(){return new Pa(this._links,this._title)}get title(){return this._title}get isEmpty(){return this.groups.length===0}get ariaMessage(){return this.isEmpty?b("aria.result.0","No results found"):this.references.length===1?b("aria.result.1","Found 1 symbol in {0}",this.references[0].uri.fsPath):this.groups.length===1?b("aria.result.n1","Found {0} symbols in {1}",this.references.length,this.groups[0].uri.fsPath):b("aria.result.nm","Found {0} symbols in {1} files",this.references.length,this.groups.length)}nextOrPreviousReference(e,t){const{parent:i}=e;let n=i.children.indexOf(e);const r=i.children.length,o=i.parent.groups.length;return o===1||t&&n+1<r||!t&&n>0?(t?n=(n+1)%r:n=(n+r-1)%r,i.children[n]):(n=i.parent.groups.indexOf(i),t?(n=(n+1)%o,i.parent.groups[n].children[0]):(n=(n+o-1)%o,i.parent.groups[n].children[i.parent.groups[n].children.length-1]))}nearestReference(e,t){const i=this.references.map((n,r)=>({idx:r,prefixLen:zm(n.uri.toString(),e.toString()),offsetDist:Math.abs(n.range.startLineNumber-t.lineNumber)*100+Math.abs(n.range.startColumn-t.column)})).sort((n,r)=>n.prefixLen>r.prefixLen?-1:n.prefixLen<r.prefixLen?1:n.offsetDist<r.offsetDist?-1:n.offsetDist>r.offsetDist?1:0)[0];if(i)return this.references[i.idx]}referenceAt(e,t){for(const i of this.references)if(i.uri.toString()===e.toString()&&F.containsPosition(i.range,t))return i}firstReference(){for(const e of this.references)if(e.isProviderFirst)return e;return this.references[0]}static _compareReferences(e,t){return nn.compare(e.uri,t.uri)||F.compareRangesUsingStarts(e.range,t.range)}}var v5=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},w5=function(s,e){return function(t,i){e(t,i,s)}},zz;let Uz=class{constructor(e){this._resolverService=e}hasChildren(e){return e instanceof Pa||e instanceof aE}getChildren(e){if(e instanceof Pa)return e.groups;if(e instanceof aE)return e.resolve(this._resolverService).then(t=>t.children);throw new Error("bad tree")}};Uz=v5([w5(0,oa)],Uz);class pYe{getHeight(){return 23}getTemplateId(e){return e instanceof aE?VP.id:BP.id}}let jz=class{constructor(e){this._keybindingService=e}getKeyboardNavigationLabel(e){var t;if(e instanceof n_){const i=(t=e.parent.getPreview(e))==null?void 0:t.preview(e.range);if(i)return i.value}return Cc(e.uri)}};jz=v5([w5(0,pi)],jz);class mYe{getId(e){return e instanceof n_?e.id:e.uri}}let $z=class extends te{constructor(e,t){super(),this._labelService=t;const i=document.createElement("div");i.classList.add("reference-file"),this.file=this._register(new KA(i,{supportHighlights:!0})),this.badge=new B8(me(i,ke(".count")),{},cge),e.appendChild(i)}set(e,t){const i=RF(e.uri);this.file.setLabel(this._labelService.getUriBasenameLabel(e.uri),this._labelService.getUriLabel(i,{relative:!0}),{title:this._labelService.getUriLabel(e.uri),matches:t});const n=e.children.length;this.badge.setCount(n),n>1?this.badge.setTitleFormat(b("referencesCount","{0} references",n)):this.badge.setTitleFormat(b("referenceCount","{0} reference",n))}};$z=v5([w5(1,x1)],$z);var wv;let VP=(wv=class{constructor(e){this._instantiationService=e,this.templateId=zz.id}renderTemplate(e){return this._instantiationService.createInstance($z,e)}renderElement(e,t,i){i.set(e.element,YE(e.filterData))}disposeTemplate(e){e.dispose()}},zz=wv,wv.id="FileReferencesRenderer",wv);VP=zz=v5([w5(0,Xe)],VP);class _Ye extends te{constructor(e){super(),this.label=this._register(new fm(e))}set(e,t){var n;const i=(n=e.parent.getPreview(e))==null?void 0:n.preview(e.range);if(!i||!i.value)this.label.set(`${Cc(e.uri)}:${e.range.startLineNumber+1}:${e.range.startColumn+1}`);else{const{value:r,highlight:o}=i;t&&!ou.isDefault(t)?(this.label.element.classList.toggle("referenceMatch",!1),this.label.set(r,YE(t))):(this.label.element.classList.toggle("referenceMatch",!0),this.label.set(r,[o]))}}}const kO=class kO{constructor(){this.templateId=kO.id}renderTemplate(e){return new _Ye(e)}renderElement(e,t,i){i.set(e.element,e.filterData)}disposeTemplate(e){e.dispose()}};kO.id="OneReferenceRenderer";let BP=kO;class bYe{getWidgetAriaLabel(){return b("treeAriaLabel","References")}getAriaLabel(e){return e.ariaMessage}}var vYe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Z0=function(s,e){return function(t,i){e(t,i,s)}};const IO=class IO{constructor(e,t){this._editor=e,this._model=t,this._decorations=new Map,this._decorationIgnoreSet=new Set,this._callOnDispose=new ce,this._callOnModelChange=new ce,this._callOnDispose.add(this._editor.onDidChangeModel(()=>this._onModelChanged())),this._onModelChanged()}dispose(){this._callOnModelChange.dispose(),this._callOnDispose.dispose(),this.removeDecorations()}_onModelChanged(){this._callOnModelChange.clear();const e=this._editor.getModel();if(e){for(const t of this._model.references)if(t.uri.toString()===e.uri.toString()){this._addDecorations(t.parent);return}}}_addDecorations(e){if(!this._editor.hasModel())return;this._callOnModelChange.add(this._editor.getModel().onDidChangeDecorations(()=>this._onDecorationChanged()));const t=[],i=[];for(let n=0,r=e.children.length;n<r;n++){const o=e.children[n];this._decorationIgnoreSet.has(o.id)||o.uri.toString()===this._editor.getModel().uri.toString()&&(t.push({range:o.range,options:IO.DecorationOptions}),i.push(n))}this._editor.changeDecorations(n=>{const r=n.deltaDecorations([],t);for(let o=0;o<r.length;o++)this._decorations.set(r[o],e.children[i[o]])})}_onDecorationChanged(){const e=[],t=this._editor.getModel();if(t){for(const[i,n]of this._decorations){const r=t.getDecorationRange(i);if(!r)continue;let o=!1;if(!F.equalsRange(r,n.range)){if(F.spansMultipleLines(r))o=!0;else{const a=n.range.endColumn-n.range.startColumn,l=r.endColumn-r.startColumn;a!==l&&(o=!0)}o?(this._decorationIgnoreSet.add(n.id),e.push(i)):n.range=r}}for(let i=0,n=e.length;i<n;i++)this._decorations.delete(e[i]);this._editor.removeDecorations(e)}}removeDecorations(){this._editor.removeDecorations([...this._decorations.keys()]),this._decorations.clear()}};IO.DecorationOptions=_t.register({description:"reference-decoration",stickiness:1,className:"reference-decoration"});let qz=IO;class wYe{constructor(){this.ratio=.7,this.heightInLines=18}static fromJSON(e){let t,i;try{const n=JSON.parse(e);t=n.ratio,i=n.heightInLines}catch{}return{ratio:t||.7,heightInLines:i||18}}}class CYe extends K8{}let Kz=class extends FP{constructor(e,t,i,n,r,o,a,l,c){super(e,{showFrame:!1,showArrow:!0,isResizeable:!0,isAccessible:!0,supportOnTitleClick:!0},o),this._defaultTreeKeyboardSupport=t,this.layoutData=i,this._textModelResolverService=r,this._instantiationService=o,this._peekViewService=a,this._uriLabel=l,this._keybindingService=c,this._disposeOnNewModel=new ce,this._callOnDispose=new ce,this._onDidSelectReference=new Z,this.onDidSelectReference=this._onDidSelectReference.event,this._dim=new Ci(0,0),this._isClosing=!1,this._applyTheme(n.getColorTheme()),this._callOnDispose.add(n.onDidColorThemeChange(this._applyTheme.bind(this))),this._peekViewService.addExclusiveWidget(e,this),this.create()}get isClosing(){return this._isClosing}dispose(){this._isClosing=!0,this.setModel(void 0),this._callOnDispose.dispose(),this._disposeOnNewModel.dispose(),Ni(this._preview),Ni(this._previewNotAvailableMessage),Ni(this._tree),Ni(this._previewModelReference),this._splitView.dispose(),super.dispose()}_applyTheme(e){const t=e.getColor(hYe)||fe.transparent;this.style({arrowColor:t,frameColor:t,headerBackgroundColor:e.getColor(uYe)||fe.transparent,primaryHeadingColor:e.getColor(X_e),secondaryHeadingColor:e.getColor(Z_e)})}show(e){super.show(e,this.layoutData.heightInLines||18)}focusOnReferenceTree(){this._tree.domFocus()}focusOnPreviewEditor(){this._preview.focus()}isPreviewEditorFocused(){return this._preview.hasTextFocus()}_onTitleClick(e){this._preview&&this._preview.getModel()&&this._onDidSelectReference.fire({element:this._getFocusedReference(),kind:e.ctrlKey||e.metaKey||e.altKey?"side":"open",source:"title"})}_fillBody(e){this.setCssClass("reference-zone-widget"),this._messageContainer=me(e,ke("div.messages")),fo(this._messageContainer),this._splitView=new tpe(e,{orientation:1}),this._previewContainer=me(e,ke("div.preview.inline"));const t={scrollBeyondLastLine:!1,scrollbar:{verticalScrollbarSize:14,horizontal:"auto",useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,alwaysConsumeMouseWheel:!0},overviewRulerLanes:2,fixedOverflowWidgets:!0,minimap:{enabled:!1}};this._preview=this._instantiationService.createInstance(hd,this._previewContainer,t,{},this.editor),fo(this._previewContainer),this._previewNotAvailableMessage=this._instantiationService.createInstance(Jd,b("missingPreviewMessage","no preview available"),So,Jd.DEFAULT_CREATION_OPTIONS,null),this._treeContainer=me(e,ke("div.ref-tree.inline"));const i={keyboardSupport:this._defaultTreeKeyboardSupport,accessibilityProvider:new bYe,keyboardNavigationLabelProvider:this._instantiationService.createInstance(jz),identityProvider:new mYe,openOnSingleClick:!0,selectionNavigation:!0,overrideStyles:{listBackground:fYe}};this._defaultTreeKeyboardSupport&&this._callOnDispose.add(yn(this._treeContainer,"keydown",r=>{r.equals(9)&&(this._keybindingService.dispatchEvent(r,r.target),r.stopPropagation())},!0)),this._tree=this._instantiationService.createInstance(CYe,"ReferencesWidget",this._treeContainer,new pYe,[this._instantiationService.createInstance(VP),this._instantiationService.createInstance(BP)],this._instantiationService.createInstance(Uz),i),this._splitView.addView({onDidChange:De.None,element:this._previewContainer,minimumSize:200,maximumSize:Number.MAX_VALUE,layout:r=>{this._preview.layout({height:this._dim.height,width:r})}},WA.Distribute),this._splitView.addView({onDidChange:De.None,element:this._treeContainer,minimumSize:100,maximumSize:Number.MAX_VALUE,layout:r=>{this._treeContainer.style.height=`${this._dim.height}px`,this._treeContainer.style.width=`${r}px`,this._tree.layout(this._dim.height,r)}},WA.Distribute),this._disposables.add(this._splitView.onDidSashChange(()=>{this._dim.width&&(this.layoutData.ratio=this._splitView.getViewSize(0)/this._dim.width)},void 0));const n=(r,o)=>{r instanceof n_&&(o==="show"&&this._revealReference(r,!1),this._onDidSelectReference.fire({element:r,kind:o,source:"tree"}))};this._disposables.add(this._tree.onDidOpen(r=>{r.sideBySide?n(r.element,"side"):r.editorOptions.pinned?n(r.element,"goto"):n(r.element,"show")})),fo(this._treeContainer)}_onWidth(e){this._dim&&this._doLayoutBody(this._dim.height,e)}_doLayoutBody(e,t){super._doLayoutBody(e,t),this._dim=new Ci(t,e),this.layoutData.heightInLines=this._viewZone?this._viewZone.heightInLines:this.layoutData.heightInLines,this._splitView.layout(t),this._splitView.resizeView(0,t*this.layoutData.ratio)}setSelection(e){return this._revealReference(e,!0).then(()=>{this._model&&(this._tree.setSelection([e]),this._tree.setFocus([e]))})}setModel(e){return this._disposeOnNewModel.clear(),this._model=e,this._model?this._onNewModel():Promise.resolve()}_onNewModel(){return this._model?this._model.isEmpty?(this.setTitle(""),this._messageContainer.innerText=b("noResults","No results"),ka(this._messageContainer),Promise.resolve(void 0)):(fo(this._messageContainer),this._decorationsManager=new qz(this._preview,this._model),this._disposeOnNewModel.add(this._decorationsManager),this._disposeOnNewModel.add(this._model.onDidChangeReferenceRange(e=>this._tree.rerender(e))),this._disposeOnNewModel.add(this._preview.onMouseDown(e=>{const{event:t,target:i}=e;if(t.detail!==2)return;const n=this._getFocusedReference();n&&this._onDidSelectReference.fire({element:{uri:n.uri,range:i.range},kind:t.ctrlKey||t.metaKey||t.altKey?"side":"open",source:"editor"})})),this.container.classList.add("results-loaded"),ka(this._treeContainer),ka(this._previewContainer),this._splitView.layout(this._dim.width),this.focusOnReferenceTree(),this._tree.setInput(this._model.groups.length===1?this._model.groups[0]:this._model)):Promise.resolve(void 0)}_getFocusedReference(){const[e]=this._tree.getFocus();if(e instanceof n_)return e;if(e instanceof aE&&e.children.length>0)return e.children[0]}async revealReference(e){await this._revealReference(e,!1),this._onDidSelectReference.fire({element:e,kind:"goto",source:"tree"})}async _revealReference(e,t){if(this._revealedReference===e)return;this._revealedReference=e,e.uri.scheme!==gt.inMemory?this.setTitle(m5e(e.uri),this._uriLabel.getUriLabel(RF(e.uri))):this.setTitle(b("peekView.alternateTitle","References"));const i=this._textModelResolverService.createModelReference(e.uri);this._tree.getInput()===e.parent?this._tree.reveal(e):(t&&this._tree.reveal(e.parent),await this._tree.expand(e.parent),this._tree.reveal(e));const n=await i;if(!this._model){n.dispose();return}Ni(this._previewModelReference);const r=n.object;if(r){const o=this._preview.getModel()===r.textEditorModel?0:1,a=F.lift(e.range).collapseToStart();this._previewModelReference=n,this._preview.setModel(r.textEditorModel),this._preview.setSelection(a),this._preview.revealRangeInCenter(a,o)}else this._preview.setModel(this._previewNotAvailableMessage),n.dispose()}};Kz=vYe([Z0(3,gs),Z0(4,oa),Z0(5,Xe),Z0(6,Y_e),Z0(7,x1),Z0(8,pi)],Kz);var yYe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},J0=function(s,e){return function(t,i){e(t,i,s)}},XR;const s0=new Oe("referenceSearchVisible",!1,b("referenceSearchVisible","Whether reference peek is visible, like 'Peek References' or 'Peek Definition'"));var Cv;let Tw=(Cv=class{static get(e){return e.getContribution(XR.ID)}constructor(e,t,i,n,r,o,a,l){this._defaultTreeKeyboardSupport=e,this._editor=t,this._editorService=n,this._notificationService=r,this._instantiationService=o,this._storageService=a,this._configurationService=l,this._disposables=new ce,this._requestIdPool=0,this._ignoreModelChangeEvent=!1,this._referenceSearchVisible=s0.bindTo(i)}dispose(){var e,t;this._referenceSearchVisible.reset(),this._disposables.dispose(),(e=this._widget)==null||e.dispose(),(t=this._model)==null||t.dispose(),this._widget=void 0,this._model=void 0}toggleWidget(e,t,i){let n;if(this._widget&&(n=this._widget.position),this.closeWidget(),n&&e.containsPosition(n))return;this._peekMode=i,this._referenceSearchVisible.set(!0),this._disposables.add(this._editor.onDidChangeModelLanguage(()=>{this.closeWidget()})),this._disposables.add(this._editor.onDidChangeModel(()=>{this._ignoreModelChangeEvent||this.closeWidget()}));const r="peekViewLayout",o=wYe.fromJSON(this._storageService.get(r,0,"{}"));this._widget=this._instantiationService.createInstance(Kz,this._editor,this._defaultTreeKeyboardSupport,o),this._widget.setTitle(b("labelLoading","Loading...")),this._widget.show(e),this._disposables.add(this._widget.onDidClose(()=>{t.cancel(),this._widget?(this._storageService.store(r,JSON.stringify(this._widget.layoutData),0,1),this._widget.isClosing||this.closeWidget(),this._widget=void 0):this.closeWidget()})),this._disposables.add(this._widget.onDidSelectReference(l=>{const{element:c,kind:d}=l;if(c)switch(d){case"open":(l.source!=="editor"||!this._configurationService.getValue("editor.stablePeek"))&&this.openReference(c,!1,!1);break;case"side":this.openReference(c,!0,!1);break;case"goto":i?this._gotoReference(c,!0):this.openReference(c,!1,!0);break}}));const a=++this._requestIdPool;t.then(l=>{var c;if(a!==this._requestIdPool||!this._widget){l.dispose();return}return(c=this._model)==null||c.dispose(),this._model=l,this._widget.setModel(this._model).then(()=>{if(this._widget&&this._model&&this._editor.hasModel()){this._model.isEmpty?this._widget.setMetaTitle(""):this._widget.setMetaTitle(b("metaTitle.N","{0} ({1})",this._model.title,this._model.references.length));const d=this._editor.getModel().uri,u=new X(e.startLineNumber,e.startColumn),h=this._model.nearestReference(d,u);if(h)return this._widget.setSelection(h).then(()=>{this._widget&&this._editor.getOption(87)==="editor"&&this._widget.focusOnPreviewEditor()})}})},l=>{this._notificationService.error(l)})}changeFocusBetweenPreviewAndReferences(){this._widget&&(this._widget.isPreviewEditorFocused()?this._widget.focusOnReferenceTree():this._widget.focusOnPreviewEditor())}async goToNextOrPreviousReference(e){if(!this._editor.hasModel()||!this._model||!this._widget)return;const t=this._widget.position;if(!t)return;const i=this._model.nearestReference(this._editor.getModel().uri,t);if(!i)return;const n=this._model.nextOrPreviousReference(i,e),r=this._editor.hasTextFocus(),o=this._widget.isPreviewEditorFocused();await this._widget.setSelection(n),await this._gotoReference(n,!1),r?this._editor.focus():this._widget&&o&&this._widget.focusOnPreviewEditor()}async revealReference(e){!this._editor.hasModel()||!this._model||!this._widget||await this._widget.revealReference(e)}closeWidget(e=!0){var t,i;(t=this._widget)==null||t.dispose(),(i=this._model)==null||i.dispose(),this._referenceSearchVisible.reset(),this._disposables.clear(),this._widget=void 0,this._model=void 0,e&&this._editor.focus(),this._requestIdPool+=1}_gotoReference(e,t){var n;(n=this._widget)==null||n.hide(),this._ignoreModelChangeEvent=!0;const i=F.lift(e.range).collapseToStart();return this._editorService.openCodeEditor({resource:e.uri,options:{selection:i,selectionSource:"code.jump",pinned:t}},this._editor).then(r=>{if(this._ignoreModelChangeEvent=!1,!r||!this._widget){this.closeWidget();return}if(this._editor===r)this._widget.show(i),this._widget.focusOnReferenceTree();else{const o=XR.get(r),a=this._model.clone();this.closeWidget(),r.focus(),o==null||o.toggleWidget(i,xs(l=>Promise.resolve(a)),this._peekMode??!1)}},r=>{this._ignoreModelChangeEvent=!1,ft(r)})}openReference(e,t,i){t||this.closeWidget();const{uri:n,range:r}=e;this._editorService.openCodeEditor({resource:n,options:{selection:r,selectionSource:"code.jump",pinned:i}},this._editor,t)}},XR=Cv,Cv.ID="editor.contrib.referencesController",Cv);Tw=XR=yYe([J0(2,ct),J0(3,ni),J0(4,jn),J0(5,Xe),J0(6,md),J0(7,At)],Tw);function r0(s,e){const t=cYe(s);if(!t)return;const i=Tw.get(t);i&&e(i)}Io.registerCommandAndKeybindingRule({id:"togglePeekWidgetFocus",weight:100,primary:ns(2089,60),when:he.or(s0,sa.inPeekEditor),handler(s){r0(s,e=>{e.changeFocusBetweenPreviewAndReferences()})}});Io.registerCommandAndKeybindingRule({id:"goToNextReference",weight:90,primary:62,secondary:[70],when:he.or(s0,sa.inPeekEditor),handler(s){r0(s,e=>{e.goToNextOrPreviousReference(!0)})}});Io.registerCommandAndKeybindingRule({id:"goToPreviousReference",weight:90,primary:1086,secondary:[1094],when:he.or(s0,sa.inPeekEditor),handler(s){r0(s,e=>{e.goToNextOrPreviousReference(!1)})}});Gt.registerCommandAlias("goToNextReferenceFromEmbeddedEditor","goToNextReference");Gt.registerCommandAlias("goToPreviousReferenceFromEmbeddedEditor","goToPreviousReference");Gt.registerCommandAlias("closeReferenceSearchEditor","closeReferenceSearch");Gt.registerCommand("closeReferenceSearch",s=>r0(s,e=>e.closeWidget()));Io.registerKeybindingRule({id:"closeReferenceSearch",weight:-1,primary:9,secondary:[1033],when:he.and(sa.inPeekEditor,he.not("config.editor.stablePeek"))});Io.registerKeybindingRule({id:"closeReferenceSearch",weight:250,primary:9,secondary:[1033],when:he.and(s0,he.not("config.editor.stablePeek"),he.or(z.editorTextFocus,upe.negate()))});Io.registerCommandAndKeybindingRule({id:"revealReference",weight:200,primary:3,mac:{primary:3,secondary:[2066]},when:he.and(s0,gpe,cG.negate(),dG.negate()),handler(s){var i;const t=(i=s.get(Ic).lastFocusedList)==null?void 0:i.getFocus();Array.isArray(t)&&t[0]instanceof n_&&r0(s,n=>n.revealReference(t[0]))}});Io.registerCommandAndKeybindingRule({id:"openReferenceToSide",weight:100,primary:2051,mac:{primary:259},when:he.and(s0,gpe,cG.negate(),dG.negate()),handler(s){var i;const t=(i=s.get(Ic).lastFocusedList)==null?void 0:i.getFocus();Array.isArray(t)&&t[0]instanceof n_&&r0(s,n=>n.openReference(t[0],!0,!0))}});Gt.registerCommand("openReference",s=>{var i;const t=(i=s.get(Ic).lastFocusedList)==null?void 0:i.getFocus();Array.isArray(t)&&t[0]instanceof n_&&r0(s,n=>n.openReference(t[0],!1,!0))});var ebe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},dL=function(s,e){return function(t,i){e(t,i,s)}};const wQ=new Oe("hasSymbols",!1,b("hasSymbols","Whether there are symbol locations that can be navigated via keyboard-only.")),C5=Ht("ISymbolNavigationService");let Gz=class{constructor(e,t,i,n){this._editorService=t,this._notificationService=i,this._keybindingService=n,this._currentModel=void 0,this._currentIdx=-1,this._ignoreEditorChange=!1,this._ctxHasSymbols=wQ.bindTo(e)}reset(){var e,t;this._ctxHasSymbols.reset(),(e=this._currentState)==null||e.dispose(),(t=this._currentMessage)==null||t.dispose(),this._currentModel=void 0,this._currentIdx=-1}put(e){const t=e.parent.parent;if(t.references.length<=1){this.reset();return}this._currentModel=t,this._currentIdx=t.references.indexOf(e),this._ctxHasSymbols.set(!0),this._showMessage();const i=new Qz(this._editorService),n=i.onDidChange(r=>{if(this._ignoreEditorChange)return;const o=this._editorService.getActiveCodeEditor();if(!o)return;const a=o.getModel(),l=o.getPosition();if(!a||!l)return;let c=!1,d=!1;for(const u of t.references)if(wI(u.uri,a.uri))c=!0,d=d||F.containsPosition(u.range,l);else if(c)break;(!c||!d)&&this.reset()});this._currentState=id(i,n)}revealNext(e){if(!this._currentModel)return Promise.resolve();this._currentIdx+=1,this._currentIdx%=this._currentModel.references.length;const t=this._currentModel.references[this._currentIdx];return this._showMessage(),this._ignoreEditorChange=!0,this._editorService.openCodeEditor({resource:t.uri,options:{selection:F.collapseToStart(t.range),selectionRevealType:3}},e).finally(()=>{this._ignoreEditorChange=!1})}_showMessage(){var i;(i=this._currentMessage)==null||i.dispose();const e=this._keybindingService.lookupKeybinding("editor.gotoNextSymbolFromResult"),t=e?b("location.kb","Symbol {0} of {1}, {2} for next",this._currentIdx+1,this._currentModel.references.length,e.getLabel()):b("location","Symbol {0} of {1}",this._currentIdx+1,this._currentModel.references.length);this._currentMessage=this._notificationService.status(t)}};Gz=ebe([dL(0,ct),dL(1,ni),dL(2,jn),dL(3,pi)],Gz);qt(C5,Gz,1);Me(new class extends fs{constructor(){super({id:"editor.gotoNextSymbolFromResult",precondition:wQ,kbOpts:{weight:100,primary:70}})}runEditorCommand(s,e){return s.get(C5).revealNext(e)}});Io.registerCommandAndKeybindingRule({id:"editor.gotoNextSymbolFromResult.cancel",weight:100,when:wQ,primary:9,handler(s){s.get(C5).reset()}});let Qz=class{constructor(e){this._listener=new Map,this._disposables=new ce,this._onDidChange=new Z,this.onDidChange=this._onDidChange.event,this._disposables.add(e.onCodeEditorRemove(this._onDidRemoveEditor,this)),this._disposables.add(e.onCodeEditorAdd(this._onDidAddEditor,this)),e.listCodeEditors().forEach(this._onDidAddEditor,this)}dispose(){this._disposables.dispose(),this._onDidChange.dispose(),Ni(this._listener.values())}_onDidAddEditor(e){this._listener.set(e,id(e.onDidChangeCursorPosition(t=>this._onDidChange.fire({editor:e})),e.onDidChangeModelContent(t=>this._onDidChange.fire({editor:e}))))}_onDidRemoveEditor(e){var t;(t=this._listener.get(e))==null||t.dispose(),this._listener.delete(e)}};Qz=ebe([dL(0,ni)],Qz);function Yz(s,e){return e.uri.scheme===s.uri.scheme?!0:!qW(e.uri,gt.walkThroughSnippet,gt.vscodeChatCodeBlock,gt.vscodeChatCodeCompareBlock)}async function vD(s,e,t,i,n){const o=t.ordered(s,i).map(l=>Promise.resolve(n(l,s,e)).then(void 0,c=>{Mn(c)})),a=await Promise.all(o);return rd(a.flat()).filter(l=>Yz(s,l))}function wD(s,e,t,i,n){return vD(e,t,s,i,(r,o,a)=>r.provideDefinition(o,a,n))}function CQ(s,e,t,i,n){return vD(e,t,s,i,(r,o,a)=>r.provideDeclaration(o,a,n))}function yQ(s,e,t,i,n){return vD(e,t,s,i,(r,o,a)=>r.provideImplementation(o,a,n))}function SQ(s,e,t,i,n){return vD(e,t,s,i,(r,o,a)=>r.provideTypeDefinition(o,a,n))}function CD(s,e,t,i,n,r){return vD(e,t,s,n,async(o,a,l)=>{var u,h;const c=(u=await o.provideReferences(a,l,{includeDeclaration:!0},r))==null?void 0:u.filter(g=>Yz(a,g));if(!i||!c||c.length!==2)return c;const d=(h=await o.provideReferences(a,l,{includeDeclaration:!1},r))==null?void 0:h.filter(g=>Yz(a,g));return d&&d.length===1?d:c})}async function Yh(s){const e=await s(),t=new Pa(e,""),i=t.references.map(n=>n.link);return t.dispose(),i}aa("_executeDefinitionProvider",(s,e,t)=>{const i=s.get(Be),n=wD(i.definitionProvider,e,t,!1,kt.None);return Yh(()=>n)});aa("_executeDefinitionProvider_recursive",(s,e,t)=>{const i=s.get(Be),n=wD(i.definitionProvider,e,t,!0,kt.None);return Yh(()=>n)});aa("_executeTypeDefinitionProvider",(s,e,t)=>{const i=s.get(Be),n=SQ(i.typeDefinitionProvider,e,t,!1,kt.None);return Yh(()=>n)});aa("_executeTypeDefinitionProvider_recursive",(s,e,t)=>{const i=s.get(Be),n=SQ(i.typeDefinitionProvider,e,t,!0,kt.None);return Yh(()=>n)});aa("_executeDeclarationProvider",(s,e,t)=>{const i=s.get(Be),n=CQ(i.declarationProvider,e,t,!1,kt.None);return Yh(()=>n)});aa("_executeDeclarationProvider_recursive",(s,e,t)=>{const i=s.get(Be),n=CQ(i.declarationProvider,e,t,!0,kt.None);return Yh(()=>n)});aa("_executeReferenceProvider",(s,e,t)=>{const i=s.get(Be),n=CD(i.referenceProvider,e,t,!1,!1,kt.None);return Yh(()=>n)});aa("_executeReferenceProvider_recursive",(s,e,t)=>{const i=s.get(Be),n=CD(i.referenceProvider,e,t,!1,!0,kt.None);return Yh(()=>n)});aa("_executeImplementationProvider",(s,e,t)=>{const i=s.get(Be),n=yQ(i.implementationProvider,e,t,!1,kt.None);return Yh(()=>n)});aa("_executeImplementationProvider_recursive",(s,e,t)=>{const i=s.get(Be),n=yQ(i.implementationProvider,e,t,!0,kt.None);return Yh(()=>n)});Os.appendMenuItem(ze.EditorContext,{submenu:ze.EditorContextPeek,title:b("peek.submenu","Peek"),group:"navigation",order:100});class W1{static is(e){return!e||typeof e!="object"?!1:!!(e instanceof W1||X.isIPosition(e.position)&&e.model)}constructor(e,t){this.model=e,this.position=t}}const jc=class jc extends vu{static all(){return jc._allSymbolNavigationCommands.values()}static _patchConfig(e){const t={...e,f1:!0};if(t.menu)for(const i of Kt.wrap(t.menu))(i.id===ze.EditorContext||i.id===ze.EditorContextPeek)&&(i.when=he.and(e.precondition,i.when));return t}constructor(e,t){super(jc._patchConfig(t)),this.configuration=e,jc._allSymbolNavigationCommands.set(t.id,this)}runEditorCommand(e,t,i,n){if(!t.hasModel())return Promise.resolve(void 0);const r=e.get(jn),o=e.get(ni),a=e.get(m_),l=e.get(C5),c=e.get(Be),d=e.get(Xe),u=t.getModel(),h=t.getPosition(),g=W1.is(i)?i:new W1(u,h),p=new t_(t,5),_=jE(this._getLocationModel(c,g.model,g.position,p.token),p.token).then(async v=>{var x;if(!v||p.token.isCancellationRequested)return;Eo(v.ariaMessage);let C;if(v.referenceAt(u.uri,h)){const L=this._getAlternativeCommand(t);!jc._activeAlternativeCommands.has(L)&&jc._allSymbolNavigationCommands.has(L)&&(C=jc._allSymbolNavigationCommands.get(L))}const y=v.references.length;if(y===0){if(!this.configuration.muteMessage){const L=u.getWordAtPosition(h);(x=Aa.get(t))==null||x.showMessage(this._getNoResultFoundMessage(L),h)}}else if(y===1&&C)jc._activeAlternativeCommands.add(this.desc.id),d.invokeFunction(L=>C.runEditorCommand(L,t,i,n).finally(()=>{jc._activeAlternativeCommands.delete(this.desc.id)}));else return this._onResult(o,l,t,v,n)},v=>{r.error(v)}).finally(()=>{p.dispose()});return a.showWhile(_,250),_}async _onResult(e,t,i,n,r){const o=this._getGoToPreference(i);if(!(i instanceof hd)&&(this.configuration.openInPeek||o==="peek"&&n.references.length>1))this._openInPeek(i,n,r);else{const a=n.firstReference(),l=n.references.length>1&&o==="gotoAndPeek",c=await this._openReference(i,e,a,this.configuration.openToSide,!l);l&&c?this._openInPeek(c,n,r):n.dispose(),o==="goto"&&t.put(a)}}async _openReference(e,t,i,n,r){let o;if(ERe(i)&&(o=i.targetSelectionRange),o||(o=i.range),!o)return;const a=await t.openCodeEditor({resource:i.uri,options:{selection:F.collapseToStart(o),selectionRevealType:3,selectionSource:"code.jump"}},e,n);if(a){if(r){const l=a.getModel(),c=a.createDecorationsCollection([{range:o,options:{description:"symbol-navigate-action-highlight",className:"symbolHighlight"}}]);setTimeout(()=>{a.getModel()===l&&c.clear()},350)}return a}}_openInPeek(e,t,i){const n=Tw.get(e);n&&e.hasModel()?n.toggleWidget(i??e.getSelection(),xs(r=>Promise.resolve(t)),this.configuration.openInPeek):t.dispose()}};jc._allSymbolNavigationCommands=new Map,jc._activeAlternativeCommands=new Set;let Tg=jc;class yD extends Tg{async _getLocationModel(e,t,i,n){return new Pa(await wD(e.definitionProvider,t,i,!1,n),b("def.title","Definitions"))}_getNoResultFoundMessage(e){return e&&e.word?b("noResultWord","No definition found for '{0}'",e.word):b("generic.noResults","No definition found")}_getAlternativeCommand(e){return e.getOption(58).alternativeDefinitionCommand}_getGoToPreference(e){return e.getOption(58).multipleDefinitions}}var Cm;Oi((Cm=class extends yD{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:Cm.id,title:{...dt("actions.goToDecl.label","Go to Definition"),mnemonicTitle:b({key:"miGotoDefinition",comment:["&& denotes a mnemonic"]},"Go to &&Definition")},precondition:z.hasDefinitionProvider,keybinding:[{when:z.editorTextFocus,primary:70,weight:100},{when:he.and(z.editorTextFocus,cpe),primary:2118,weight:100}],menu:[{id:ze.EditorContext,group:"navigation",order:1.1},{id:ze.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:2}]}),Gt.registerCommandAlias("editor.action.goToDeclaration",Cm.id)}},Cm.id="editor.action.revealDefinition",Cm));var ym;Oi((ym=class extends yD{constructor(){super({openToSide:!0,openInPeek:!1,muteMessage:!1},{id:ym.id,title:dt("actions.goToDeclToSide.label","Open Definition to the Side"),precondition:he.and(z.hasDefinitionProvider,z.isInEmbeddedEditor.toNegated()),keybinding:[{when:z.editorTextFocus,primary:ns(2089,70),weight:100},{when:he.and(z.editorTextFocus,cpe),primary:ns(2089,2118),weight:100}]}),Gt.registerCommandAlias("editor.action.openDeclarationToTheSide",ym.id)}},ym.id="editor.action.revealDefinitionAside",ym));var Sm;Oi((Sm=class extends yD{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:Sm.id,title:dt("actions.previewDecl.label","Peek Definition"),precondition:he.and(z.hasDefinitionProvider,sa.notInPeekEditor,z.isInEmbeddedEditor.toNegated()),keybinding:{when:z.editorTextFocus,primary:582,linux:{primary:3140},weight:100},menu:{id:ze.EditorContextPeek,group:"peek",order:2}}),Gt.registerCommandAlias("editor.action.previewDeclaration",Sm.id)}},Sm.id="editor.action.peekDefinition",Sm));class tbe extends Tg{async _getLocationModel(e,t,i,n){return new Pa(await CQ(e.declarationProvider,t,i,!1,n),b("decl.title","Declarations"))}_getNoResultFoundMessage(e){return e&&e.word?b("decl.noResultWord","No declaration found for '{0}'",e.word):b("decl.generic.noResults","No declaration found")}_getAlternativeCommand(e){return e.getOption(58).alternativeDeclarationCommand}_getGoToPreference(e){return e.getOption(58).multipleDeclarations}}var yv;Oi((yv=class extends tbe{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:yv.id,title:{...dt("actions.goToDeclaration.label","Go to Declaration"),mnemonicTitle:b({key:"miGotoDeclaration",comment:["&& denotes a mnemonic"]},"Go to &&Declaration")},precondition:he.and(z.hasDeclarationProvider,z.isInEmbeddedEditor.toNegated()),menu:[{id:ze.EditorContext,group:"navigation",order:1.3},{id:ze.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:3}]})}_getNoResultFoundMessage(e){return e&&e.word?b("decl.noResultWord","No declaration found for '{0}'",e.word):b("decl.generic.noResults","No declaration found")}},yv.id="editor.action.revealDeclaration",yv));Oi(class extends tbe{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:"editor.action.peekDeclaration",title:dt("actions.peekDecl.label","Peek Declaration"),precondition:he.and(z.hasDeclarationProvider,sa.notInPeekEditor,z.isInEmbeddedEditor.toNegated()),menu:{id:ze.EditorContextPeek,group:"peek",order:3}})}});class ibe extends Tg{async _getLocationModel(e,t,i,n){return new Pa(await SQ(e.typeDefinitionProvider,t,i,!1,n),b("typedef.title","Type Definitions"))}_getNoResultFoundMessage(e){return e&&e.word?b("goToTypeDefinition.noResultWord","No type definition found for '{0}'",e.word):b("goToTypeDefinition.generic.noResults","No type definition found")}_getAlternativeCommand(e){return e.getOption(58).alternativeTypeDefinitionCommand}_getGoToPreference(e){return e.getOption(58).multipleTypeDefinitions}}var Sv;Oi((Sv=class extends ibe{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:Sv.ID,title:{...dt("actions.goToTypeDefinition.label","Go to Type Definition"),mnemonicTitle:b({key:"miGotoTypeDefinition",comment:["&& denotes a mnemonic"]},"Go to &&Type Definition")},precondition:z.hasTypeDefinitionProvider,keybinding:{when:z.editorTextFocus,primary:0,weight:100},menu:[{id:ze.EditorContext,group:"navigation",order:1.4},{id:ze.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:3}]})}},Sv.ID="editor.action.goToTypeDefinition",Sv));var xv;Oi((xv=class extends ibe{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:xv.ID,title:dt("actions.peekTypeDefinition.label","Peek Type Definition"),precondition:he.and(z.hasTypeDefinitionProvider,sa.notInPeekEditor,z.isInEmbeddedEditor.toNegated()),menu:{id:ze.EditorContextPeek,group:"peek",order:4}})}},xv.ID="editor.action.peekTypeDefinition",xv));class nbe extends Tg{async _getLocationModel(e,t,i,n){return new Pa(await yQ(e.implementationProvider,t,i,!1,n),b("impl.title","Implementations"))}_getNoResultFoundMessage(e){return e&&e.word?b("goToImplementation.noResultWord","No implementation found for '{0}'",e.word):b("goToImplementation.generic.noResults","No implementation found")}_getAlternativeCommand(e){return e.getOption(58).alternativeImplementationCommand}_getGoToPreference(e){return e.getOption(58).multipleImplementations}}var Lv;Oi((Lv=class extends nbe{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:Lv.ID,title:{...dt("actions.goToImplementation.label","Go to Implementations"),mnemonicTitle:b({key:"miGotoImplementation",comment:["&& denotes a mnemonic"]},"Go to &&Implementations")},precondition:z.hasImplementationProvider,keybinding:{when:z.editorTextFocus,primary:2118,weight:100},menu:[{id:ze.EditorContext,group:"navigation",order:1.45},{id:ze.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:4}]})}},Lv.ID="editor.action.goToImplementation",Lv));var kv;Oi((kv=class extends nbe{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:kv.ID,title:dt("actions.peekImplementation.label","Peek Implementations"),precondition:he.and(z.hasImplementationProvider,sa.notInPeekEditor,z.isInEmbeddedEditor.toNegated()),keybinding:{when:z.editorTextFocus,primary:3142,weight:100},menu:{id:ze.EditorContextPeek,group:"peek",order:5}})}},kv.ID="editor.action.peekImplementation",kv));class sbe extends Tg{_getNoResultFoundMessage(e){return e?b("references.no","No references found for '{0}'",e.word):b("references.noGeneric","No references found")}_getAlternativeCommand(e){return e.getOption(58).alternativeReferenceCommand}_getGoToPreference(e){return e.getOption(58).multipleReferences}}Oi(class extends sbe{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:"editor.action.goToReferences",title:{...dt("goToReferences.label","Go to References"),mnemonicTitle:b({key:"miGotoReference",comment:["&& denotes a mnemonic"]},"Go to &&References")},precondition:he.and(z.hasReferenceProvider,sa.notInPeekEditor,z.isInEmbeddedEditor.toNegated()),keybinding:{when:z.editorTextFocus,primary:1094,weight:100},menu:[{id:ze.EditorContext,group:"navigation",order:1.45},{id:ze.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:5}]})}async _getLocationModel(e,t,i,n){return new Pa(await CD(e.referenceProvider,t,i,!0,!1,n),b("ref.title","References"))}});Oi(class extends sbe{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:"editor.action.referenceSearch.trigger",title:dt("references.action.label","Peek References"),precondition:he.and(z.hasReferenceProvider,sa.notInPeekEditor,z.isInEmbeddedEditor.toNegated()),menu:{id:ze.EditorContextPeek,group:"peek",order:6}})}async _getLocationModel(e,t,i,n){return new Pa(await CD(e.referenceProvider,t,i,!1,!1,n),b("ref.title","References"))}});class SYe extends Tg{constructor(e,t,i){super(e,{id:"editor.action.goToLocation",title:dt("label.generic","Go to Any Symbol"),precondition:he.and(sa.notInPeekEditor,z.isInEmbeddedEditor.toNegated())}),this._references=t,this._gotoMultipleBehaviour=i}async _getLocationModel(e,t,i,n){return new Pa(this._references,b("generic.title","Locations"))}_getNoResultFoundMessage(e){return e&&b("generic.noResult","No results for '{0}'",e.word)||""}_getGoToPreference(e){return this._gotoMultipleBehaviour??e.getOption(58).multipleReferences}_getAlternativeCommand(){return""}}Gt.registerCommand({id:"editor.action.goToLocations",metadata:{description:"Go to locations from a position in a file",args:[{name:"uri",description:"The text document in which to start",constraint:Je},{name:"position",description:"The position at which to start",constraint:X.isIPosition},{name:"locations",description:"An array of locations.",constraint:Array},{name:"multiple",description:"Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto`"},{name:"noResultsMessage",description:"Human readable message that shows when locations is empty."}]},handler:async(s,e,t,i,n,r,o)=>{ii(Je.isUri(e)),ii(X.isIPosition(t)),ii(Array.isArray(i)),ii(typeof n>"u"||typeof n=="string"),ii(typeof o>"u"||typeof o=="boolean");const a=s.get(ni),l=await a.openCodeEditor({resource:e},a.getFocusedCodeEditor());if(Wh(l))return l.setPosition(t),l.revealPositionInCenterIfOutsideViewport(t,0),l.invokeWithinContext(c=>{const d=new class extends SYe{_getNoResultFoundMessage(u){return r||super._getNoResultFoundMessage(u)}}({muteMessage:!r,openInPeek:!!o,openToSide:!1},i,n);c.get(Xe).invokeFunction(d.run.bind(d),l)})}});Gt.registerCommand({id:"editor.action.peekLocations",metadata:{description:"Peek locations from a position in a file",args:[{name:"uri",description:"The text document in which to start",constraint:Je},{name:"position",description:"The position at which to start",constraint:X.isIPosition},{name:"locations",description:"An array of locations.",constraint:Array},{name:"multiple",description:"Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto`"}]},handler:async(s,e,t,i,n)=>{s.get(Hi).executeCommand("editor.action.goToLocations",e,t,i,n,void 0,!0)}});Gt.registerCommand({id:"editor.action.findReferences",handler:(s,e,t)=>{ii(Je.isUri(e)),ii(X.isIPosition(t));const i=s.get(Be),n=s.get(ni);return n.openCodeEditor({resource:e},n.getFocusedCodeEditor()).then(r=>{if(!Wh(r)||!r.hasModel())return;const o=Tw.get(r);if(!o)return;const a=xs(c=>CD(i.referenceProvider,r.getModel(),X.lift(t),!1,!1,c).then(d=>new Pa(d,b("ref.title","References")))),l=new F(t.lineNumber,t.column,t.lineNumber,t.column);return Promise.resolve(o.toggleWidget(l,a,!1))})}});Gt.registerCommandAlias("editor.action.showReferences","editor.action.peekLocations");async function xYe(s,e,t,i){const n=s.get(oa),r=s.get(Ba),o=s.get(Hi),a=s.get(Xe),l=s.get(jn);if(await i.item.resolve(kt.None),!i.part.location)return;const c=i.part.location,d=[],u=new Set(Os.getMenuItems(ze.EditorContext).map(g=>my(g)?g.command.id:f5()));for(const g of Tg.all())u.has(g.desc.id)&&d.push(new Na(g.desc.id,Ra.label(g.desc,{renderShortTitle:!0}),void 0,!0,async()=>{const p=await n.createModelReference(c.uri);try{const _=new W1(p.object.textEditorModel,F.getStartPosition(c.range)),v=i.item.anchor.range;await a.invokeFunction(g.runEditorCommand.bind(g),e,_,v)}finally{p.dispose()}}));if(i.part.command){const{command:g}=i.part;d.push(new ks),d.push(new Na(g.id,g.title,void 0,!0,async()=>{try{await o.executeCommand(g.id,...g.arguments??[])}catch(p){l.notify({severity:wF.Error,source:i.item.provider.displayName,message:p})}}))}const h=e.getOption(128);r.showContextMenu({domForShadowRoot:h?e.getDomNode()??void 0:void 0,getAnchor:()=>{const g=Pn(t);return{x:g.left,y:g.top+g.height+8}},getActions:()=>d,onHide:()=>{e.focus()},autoSelectFirstItem:!0})}async function rbe(s,e,t,i){const r=await s.get(oa).createModelReference(i.uri);await t.invokeWithinContext(async o=>{const a=e.hasSideBySideModifier,l=o.get(ct),c=sa.inPeekEditor.getValue(l),d=!a&&t.getOption(89)&&!c;return new yD({openToSide:a,openInPeek:d,muteMessage:!0},{title:{value:"",original:""},id:"",precondition:void 0}).run(o,new W1(r.object.textEditorModel,F.getStartPosition(i.range)),F.lift(i.range))}),r.dispose()}var LYe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},eC=function(s,e){return function(t,i){e(t,i,s)}},_C;class WP{constructor(){this._entries=new $h(50)}get(e){const t=WP._key(e);return this._entries.get(t)}set(e,t){const i=WP._key(e);this._entries.set(i,t)}static _key(e){return`${e.uri.toString()}/${e.getVersionId()}`}}const obe=Ht("IInlayHintsCache");qt(obe,WP,1);class Xz{constructor(e,t){this.item=e,this.index=t}get part(){const e=this.item.hint.label;return typeof e=="string"?{label:e}:e[this.index]}}class kYe{constructor(e,t){this.part=e,this.hasTriggerModifier=t}}var ng;let lE=(ng=class{static get(e){return e.getContribution(_C.ID)??void 0}constructor(e,t,i,n,r,o,a){this._editor=e,this._languageFeaturesService=t,this._inlayHintsCache=n,this._commandService=r,this._notificationService=o,this._instaService=a,this._disposables=new ce,this._sessionDisposables=new ce,this._decorationsMetadata=new Map,this._ruleFactory=new sP(this._editor),this._activeRenderMode=0,this._debounceInfo=i.for(t.inlayHintsProvider,"InlayHint",{min:25}),this._disposables.add(t.inlayHintsProvider.onDidChange(()=>this._update())),this._disposables.add(e.onDidChangeModel(()=>this._update())),this._disposables.add(e.onDidChangeModelLanguage(()=>this._update())),this._disposables.add(e.onDidChangeConfiguration(l=>{l.hasChanged(142)&&this._update()})),this._update()}dispose(){this._sessionDisposables.dispose(),this._removeAllDecorations(),this._disposables.dispose()}_update(){this._sessionDisposables.clear(),this._removeAllDecorations();const e=this._editor.getOption(142);if(e.enabled==="off")return;const t=this._editor.getModel();if(!t||!this._languageFeaturesService.inlayHintsProvider.has(t))return;if(e.enabled==="on")this._activeRenderMode=0;else{let a,l;e.enabled==="onUnlessPressed"?(a=0,l=1):(a=1,l=0),this._activeRenderMode=a,this._sessionDisposables.add(qf.getInstance().event(c=>{if(!this._editor.hasModel())return;const d=c.altKey&&c.ctrlKey&&!(c.shiftKey||c.metaKey)?l:a;if(d!==this._activeRenderMode){this._activeRenderMode=d;const u=this._editor.getModel(),h=this._copyInlayHintsWithCurrentAnchor(u);this._updateHintsDecorators([u.getFullModelRange()],h),o.schedule(0)}}))}const i=this._inlayHintsCache.get(t);i&&this._updateHintsDecorators([t.getFullModelRange()],i),this._sessionDisposables.add(Ye(()=>{t.isDisposed()||this._cacheHintsForFastRestore(t)}));let n;const r=new Set,o=new xi(async()=>{const a=Date.now();n==null||n.dispose(!0),n=new mn;const l=t.onWillDispose(()=>n==null?void 0:n.cancel());try{const c=n.token,d=await MP.create(this._languageFeaturesService.inlayHintsProvider,t,this._getHintsRanges(),c);if(o.delay=this._debounceInfo.update(t,Date.now()-a),c.isCancellationRequested){d.dispose();return}for(const u of d.provider)typeof u.onDidChangeInlayHints=="function"&&!r.has(u)&&(r.add(u),this._sessionDisposables.add(u.onDidChangeInlayHints(()=>{o.isScheduled()||o.schedule()})));this._sessionDisposables.add(d),this._updateHintsDecorators(d.ranges,d.items),this._cacheHintsForFastRestore(t)}catch(c){ft(c)}finally{n.dispose(),l.dispose()}},this._debounceInfo.get(t));this._sessionDisposables.add(o),this._sessionDisposables.add(Ye(()=>n==null?void 0:n.dispose(!0))),o.schedule(0),this._sessionDisposables.add(this._editor.onDidScrollChange(a=>{(a.scrollTopChanged||!o.isScheduled())&&o.schedule()})),this._sessionDisposables.add(this._editor.onDidChangeModelContent(a=>{n==null||n.cancel();const l=Math.max(o.delay,1250);o.schedule(l)})),this._sessionDisposables.add(this._installDblClickGesture(()=>o.schedule(0))),this._sessionDisposables.add(this._installLinkGesture()),this._sessionDisposables.add(this._installContextMenu())}_installLinkGesture(){const e=new ce,t=e.add(new b5(this._editor)),i=new ce;return e.add(i),e.add(t.onMouseMoveOrRelevantKeyDown(n=>{const[r]=n,o=this._getInlayHintLabelPart(r),a=this._editor.getModel();if(!o||!a){i.clear();return}const l=new mn;i.add(Ye(()=>l.dispose(!0))),o.item.resolve(l.token),this._activeInlayHintPart=o.part.command||o.part.location?new kYe(o,r.hasTriggerModifier):void 0;const c=a.validatePosition(o.item.hint.position).lineNumber,d=new F(c,1,c,a.getLineMaxColumn(c)),u=this._getInlineHintsForRange(d);this._updateHintsDecorators([d],u),i.add(Ye(()=>{this._activeInlayHintPart=void 0,this._updateHintsDecorators([d],u)}))})),e.add(t.onCancel(()=>i.clear())),e.add(t.onExecute(async n=>{const r=this._getInlayHintLabelPart(n);if(r){const o=r.part;o.location?this._instaService.invokeFunction(rbe,n,this._editor,o.location):$7.is(o.command)&&await this._invokeCommand(o.command,r.item)}})),e}_getInlineHintsForRange(e){const t=new Set;for(const i of this._decorationsMetadata.values())e.containsRange(i.item.anchor.range)&&t.add(i.item);return Array.from(t)}_installDblClickGesture(e){return this._editor.onMouseUp(async t=>{if(t.event.detail!==2)return;const i=this._getInlayHintLabelPart(t);if(i&&(t.event.preventDefault(),await i.item.resolve(kt.None),Xr(i.item.hint.textEdits))){const n=i.item.hint.textEdits.map(r=>gn.replace(F.lift(r.range),r.text));this._editor.executeEdits("inlayHint.default",n),e()}})}_installContextMenu(){return this._editor.onContextMenu(async e=>{if(!Ls(e.event.target))return;const t=this._getInlayHintLabelPart(e);t&&await this._instaService.invokeFunction(xYe,this._editor,e.event.target,t)})}_getInlayHintLabelPart(e){var i;if(e.target.type!==6)return;const t=(i=e.target.detail.injectedText)==null?void 0:i.options;if(t instanceof Zm&&(t==null?void 0:t.attachedData)instanceof Xz)return t.attachedData}async _invokeCommand(e,t){try{await this._commandService.executeCommand(e.id,...e.arguments??[])}catch(i){this._notificationService.notify({severity:wF.Error,source:t.provider.displayName,message:i})}}_cacheHintsForFastRestore(e){const t=this._copyInlayHintsWithCurrentAnchor(e);this._inlayHintsCache.set(e,t)}_copyInlayHintsWithCurrentAnchor(e){const t=new Map;for(const[i,n]of this._decorationsMetadata){if(t.has(n.item))continue;const r=e.getDecorationRange(i);if(r){const o=new K_e(r,n.item.anchor.direction),a=n.item.with({anchor:o});t.set(n.item,a)}}return Array.from(t.values())}_getHintsRanges(){const t=this._editor.getModel(),i=this._editor.getVisibleRangesPlusViewportAboveBelow(),n=[];for(const r of i.sort(F.compareRangesUsingStarts)){const o=t.validateRange(new F(r.startLineNumber-30,r.startColumn,r.endLineNumber+30,r.endColumn));n.length===0||!F.areIntersectingOrTouching(n[n.length-1],o)?n.push(o):n[n.length-1]=F.plusRange(n[n.length-1],o)}return n}_updateHintsDecorators(e,t){var p,_;const i=[],n=(v,C,y,x,L)=>{const I={content:y,inlineClassNameAffectsLetterSpacing:!0,inlineClassName:C.className,cursorStops:x,attachedData:L};i.push({item:v,classNameRef:C,decoration:{range:v.anchor.range,options:{description:"InlayHint",showIfCollapsed:v.anchor.range.isEmpty(),collapseOnReplaceEdit:!v.anchor.range.isEmpty(),stickiness:0,[v.anchor.direction]:this._activeRenderMode===0?I:void 0}}})},r=(v,C)=>{const y=this._ruleFactory.createClassNameRef({width:`${o/3|0}px`,display:"inline-block"});n(v,y," ",C?Zc.Right:Zc.None)},{fontSize:o,fontFamily:a,padding:l,isUniform:c}=this._getLayoutInfo(),d="--code-editorInlayHintsFontFamily";this._editor.getContainerDomNode().style.setProperty(d,a);let u={line:0,totalLen:0};for(const v of t){if(u.line!==v.anchor.range.startLineNumber&&(u={line:v.anchor.range.startLineNumber,totalLen:0}),u.totalLen>_C._MAX_LABEL_LEN)continue;v.hint.paddingLeft&&r(v,!1);const C=typeof v.hint.label=="string"?[{label:v.hint.label}]:v.hint.label;for(let y=0;y<C.length;y++){const x=C[y],L=y===0,I=y===C.length-1,A={fontSize:`${o}px`,fontFamily:`var(${d}), ${yo.fontFamily}`,verticalAlign:c?"baseline":"middle",unicodeBidi:"isolate"};Xr(v.hint.textEdits)&&(A.cursor="default"),this._fillInColors(A,v.hint),(x.command||x.location)&&((p=this._activeInlayHintPart)==null?void 0:p.part.item)===v&&this._activeInlayHintPart.part.index===y&&(A.textDecoration="underline",this._activeInlayHintPart.hasTriggerModifier&&(A.color=kn(GOe),A.cursor="pointer")),l&&(L&&I?(A.padding=`1px ${Math.max(1,o/4)|0}px`,A.borderRadius=`${o/4|0}px`):L?(A.padding=`1px 0 1px ${Math.max(1,o/4)|0}px`,A.borderRadius=`${o/4|0}px 0 0 ${o/4|0}px`):I?(A.padding=`1px ${Math.max(1,o/4)|0}px 1px 0`,A.borderRadius=`0 ${o/4|0}px ${o/4|0}px 0`):A.padding="1px 0 1px 0");let D=x.label;u.totalLen+=D.length;let N=!1;const R=u.totalLen-_C._MAX_LABEL_LEN;if(R>0&&(D=D.slice(0,-R)+"…",N=!0),n(v,this._ruleFactory.createClassNameRef(A),IYe(D),I&&!v.hint.paddingRight?Zc.Right:Zc.None,new Xz(v,y)),N)break}if(v.hint.paddingRight&&r(v,!0),i.length>_C._MAX_DECORATORS)break}const h=[];for(const[v,C]of this._decorationsMetadata){const y=(_=this._editor.getModel())==null?void 0:_.getDecorationRange(v);y&&e.some(x=>x.containsRange(y))&&(h.push(v),C.classNameRef.dispose(),this._decorationsMetadata.delete(v))}const g=_u.capture(this._editor);this._editor.changeDecorations(v=>{const C=v.deltaDecorations(h,i.map(y=>y.decoration));for(let y=0;y<C.length;y++){const x=i[y];this._decorationsMetadata.set(C[y],x)}}),g.restore(this._editor)}_fillInColors(e,t){t.kind===F2.Parameter?(e.backgroundColor=kn(i4e),e.color=kn(t4e)):t.kind===F2.Type?(e.backgroundColor=kn(e4e),e.color=kn(JOe)):(e.backgroundColor=kn(uK),e.color=kn(dK))}_getLayoutInfo(){const e=this._editor.getOption(142),t=e.padding,i=this._editor.getOption(52),n=this._editor.getOption(49);let r=e.fontSize;(!r||r<5||r>i)&&(r=i);const o=e.fontFamily||n;return{fontSize:r,fontFamily:o,padding:t,isUniform:!t&&o===n&&r===i}}_removeAllDecorations(){this._editor.removeDecorations(Array.from(this._decorationsMetadata.keys()));for(const e of this._decorationsMetadata.values())e.classNameRef.dispose();this._decorationsMetadata.clear()}},_C=ng,ng.ID="editor.contrib.InlayHints",ng._MAX_DECORATORS=1500,ng._MAX_LABEL_LEN=43,ng);lE=_C=LYe([eC(1,Be),eC(2,Fl),eC(3,obe),eC(4,Hi),eC(5,jn),eC(6,Xe)],lE);function IYe(s){return s.replace(/[ \t]/g," ")}Gt.registerCommand("_executeInlayHintProvider",async(s,...e)=>{const[t,i]=e;ii(Je.isUri(t)),ii(F.isIRange(i));const{inlayHintsProvider:n}=s.get(Be),r=await s.get(oa).createModelReference(t);try{const o=await MP.create(n,r.object.textEditorModel,[F.lift(i)],kt.None),a=o.items.map(l=>l.hint);return setTimeout(()=>o.dispose(),0),a}finally{r.dispose()}});var EYe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},pp=function(s,e){return function(t,i){e(t,i,s)}};class Kre extends GR{constructor(e,t,i,n){super(10,t,e.item.anchor.range,i,n,!0),this.part=e}}let HP=class extends oE{constructor(e,t,i,n,r,o,a,l,c){super(e,t,i,o,l,n,r,c),this._resolverService=a,this.hoverOrdinal=6}suggestHoverAnchor(e){var n;if(!lE.get(this._editor)||e.target.type!==6)return null;const i=(n=e.target.detail.injectedText)==null?void 0:n.options;return i instanceof Zm&&i.attachedData instanceof Xz?new Kre(i.attachedData,this,e.event.posx,e.event.posy):null}computeSync(){return[]}computeAsync(e,t,i){return e instanceof Kre?new Cl(async n=>{const{part:r}=e;if(await r.item.resolve(i),i.isCancellationRequested)return;let o;typeof r.item.hint.tooltip=="string"?o=new Lr().appendText(r.item.hint.tooltip):r.item.hint.tooltip&&(o=r.item.hint.tooltip),o&&n.emitOne(new Yc(this,e.range,[o],!1,0)),Xr(r.item.hint.textEdits)&&n.emitOne(new Yc(this,e.range,[new Lr().appendText(b("hint.dbl","Double-click to insert"))],!1,10001));let a;if(typeof r.part.tooltip=="string"?a=new Lr().appendText(r.part.tooltip):r.part.tooltip&&(a=r.part.tooltip),a&&n.emitOne(new Yc(this,e.range,[a],!1,1)),r.part.location||r.part.command){let c;const u=this._editor.getOption(78)==="altKey"?Wt?b("links.navigate.kb.meta.mac","cmd + click"):b("links.navigate.kb.meta","ctrl + click"):Wt?b("links.navigate.kb.alt.mac","option + click"):b("links.navigate.kb.alt","alt + click");r.part.location&&r.part.command?c=new Lr().appendText(b("hint.defAndCommand","Go to Definition ({0}), right click for more",u)):r.part.location?c=new Lr().appendText(b("hint.def","Go to Definition ({0})",u)):r.part.command&&(c=new Lr(`[${b("hint.cmd","Execute Command")}](${iYe(r.part.command)} "${r.part.command.title}") (${u})`,{isTrusted:!0})),c&&n.emitOne(new Yc(this,e.range,[c],!1,1e4))}const l=await this._resolveInlayHintLabelPartHover(r,i);for await(const c of l)n.emitOne(c)}):Cl.EMPTY}async _resolveInlayHintLabelPartHover(e,t){if(!e.part.location)return Cl.EMPTY;const{uri:i,range:n}=e.part.location,r=await this._resolverService.createModelReference(i);try{const o=r.object.textEditorModel;return this._languageFeaturesService.hoverProvider.has(o)?bQ(this._languageFeaturesService.hoverProvider,o,new X(n.startLineNumber,n.startColumn),t).filter(a=>!y1(a.hover.contents)).map(a=>new Yc(this,e.item.anchor.range,a.hover.contents,!1,2+a.ordinal)):Cl.EMPTY}finally{r.dispose()}}};HP=EYe([pp(1,un),pp(2,la),pp(3,pi),pp(4,Kh),pp(5,At),pp(6,oa),pp(7,Be),pp(8,Hi)],HP);class xQ extends te{constructor(e,t,i,n,r,o){super();const a=t.anchor,l=t.hoverParts;this._renderedHoverParts=this._register(new Zz(e,i,l,o,r));const{showAtPosition:c,showAtSecondaryPosition:d}=xQ.computeHoverPositions(e,a.range,l);this.shouldAppearBeforeContent=l.some(u=>u.isBeforeContent),this.showAtPosition=c,this.showAtSecondaryPosition=d,this.initialMousePosX=a.initialMousePosX,this.initialMousePosY=a.initialMousePosY,this.shouldFocus=n.shouldFocus,this.source=n.source}get domNode(){return this._renderedHoverParts.domNode}get domNodeHasChildren(){return this._renderedHoverParts.domNodeHasChildren}get focusedHoverPartIndex(){return this._renderedHoverParts.focusedHoverPartIndex}async updateHoverVerbosityLevel(e,t,i){this._renderedHoverParts.updateHoverVerbosityLevel(e,t,i)}isColorPickerVisible(){return this._renderedHoverParts.isColorPickerVisible()}static computeHoverPositions(e,t,i){let n=1;if(e.hasModel()){const d=e._getViewModel(),u=d.coordinatesConverter,h=u.convertModelRangeToViewRange(t),g=d.getLineMinColumn(h.startLineNumber),p=new X(h.startLineNumber,g);n=u.convertViewPositionToModelPosition(p).column}const r=t.startLineNumber;let o=t.startColumn,a;for(const d of i){const u=d.range,h=u.startLineNumber===r,g=u.endLineNumber===r;if(h&&g){const _=u.startColumn,v=Math.min(o,_);o=Math.max(v,n)}d.forceShowAtRange&&(a=u)}let l,c;if(a){const d=a.getStartPosition();l=d,c=d}else l=t.getStartPosition(),c=new X(r,o);return{showAtPosition:l,showAtSecondaryPosition:c}}}class DYe{constructor(e,t){this._statusBar=t,e.appendChild(this._statusBar.hoverElement)}get hoverElement(){return this._statusBar.hoverElement}get actions(){return this._statusBar.actions}dispose(){this._statusBar.dispose()}}const EO=class EO extends te{constructor(e,t,i,n,r){super(),this._renderedParts=[],this._focusedHoverPartIndex=-1,this._context=r,this._fragment=document.createDocumentFragment(),this._register(this._renderParts(t,i,r,n)),this._register(this._registerListenersOnRenderedParts()),this._register(this._createEditorDecorations(e,i)),this._updateMarkdownAndColorParticipantInfo(t)}_createEditorDecorations(e,t){if(t.length===0)return te.None;let i=t[0].range;for(const r of t){const o=r.range;i=F.plusRange(i,o)}const n=e.createDecorationsCollection();return n.set([{range:i,options:EO._DECORATION_OPTIONS}]),Ye(()=>{n.clear()})}_renderParts(e,t,i,n){const r=new PP(n),o={fragment:this._fragment,statusBar:r,...i},a=new ce;for(const c of e){const d=this._renderHoverPartsForParticipant(t,c,o);a.add(d);for(const u of d.renderedHoverParts)this._renderedParts.push({type:"hoverPart",participant:c,hoverPart:u.hoverPart,hoverElement:u.hoverElement})}const l=this._renderStatusBar(this._fragment,r);return l&&(a.add(l),this._renderedParts.push({type:"statusBar",hoverElement:l.hoverElement,actions:l.actions})),Ye(()=>{a.dispose()})}_renderHoverPartsForParticipant(e,t,i){const n=e.filter(o=>o.owner===t);return n.length>0?t.renderHoverParts(i,n):new Dw([])}_renderStatusBar(e,t){if(t.hasContent)return new DYe(e,t)}_registerListenersOnRenderedParts(){const e=new ce;return this._renderedParts.forEach((t,i)=>{const n=t.hoverElement;n.tabIndex=0,e.add(oe(n,Le.FOCUS_IN,r=>{r.stopPropagation(),this._focusedHoverPartIndex=i})),e.add(oe(n,Le.FOCUS_OUT,r=>{r.stopPropagation(),this._focusedHoverPartIndex=-1}))}),e}_updateMarkdownAndColorParticipantInfo(e){const t=e.find(i=>i instanceof oE&&!(i instanceof HP));t&&(this._markdownHoverParticipant=t),this._colorHoverParticipant=e.find(i=>i instanceof sE)}async updateHoverVerbosityLevel(e,t,i){if(!this._markdownHoverParticipant)return;const n=this._normalizedIndexToMarkdownHoverIndexRange(this._markdownHoverParticipant,t);if(n===void 0)return;const r=await this._markdownHoverParticipant.updateMarkdownHoverVerbosityLevel(e,n,i);r&&(this._renderedParts[t]={type:"hoverPart",participant:this._markdownHoverParticipant,hoverPart:r.hoverPart,hoverElement:r.hoverElement},this._context.onContentsChanged())}isColorPickerVisible(){var e;return((e=this._colorHoverParticipant)==null?void 0:e.isColorPickerVisible())??!1}_normalizedIndexToMarkdownHoverIndexRange(e,t){const i=this._renderedParts[t];if(!i||i.type!=="hoverPart"||!(i.participant===e))return;const r=this._renderedParts.findIndex(o=>o.type==="hoverPart"&&o.participant===e);if(r===-1)throw new di;return t-r}get domNode(){return this._fragment}get domNodeHasChildren(){return this._fragment.hasChildNodes()}get focusedHoverPartIndex(){return this._focusedHoverPartIndex}};EO._DECORATION_OPTIONS=_t.register({description:"content-hover-highlight",className:"hoverHighlight"});let Zz=EO;var TYe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Gre=function(s,e){return function(t,i){e(t,i,s)}};let Jz=class extends te{constructor(e,t,i){super(),this._editor=e,this._instantiationService=t,this._keybindingService=i,this._currentResult=null,this._onContentsChanged=this._register(new Z),this.onContentsChanged=this._onContentsChanged.event,this._contentHoverWidget=this._register(this._instantiationService.createInstance(Bz,this._editor)),this._participants=this._initializeHoverParticipants(),this._computer=new AP(this._editor,this._participants),this._hoverOperation=this._register(new z_e(this._editor,this._computer)),this._registerListeners()}_initializeHoverParticipants(){const e=[];for(const t of n0.getAll()){const i=this._instantiationService.createInstance(t,this._editor);e.push(i)}return e.sort((t,i)=>t.hoverOrdinal-i.hoverOrdinal),this._register(this._contentHoverWidget.onDidResize(()=>{this._participants.forEach(t=>{var i;return(i=t.handleResize)==null?void 0:i.call(t)})})),e}_registerListeners(){this._register(this._hoverOperation.onResult(t=>{if(!this._computer.anchor)return;const i=t.hasLoadingMessage?this._addLoadingMessage(t.value):t.value;this._withResult(new U_e(this._computer.anchor,i,t.isComplete))}));const e=this._contentHoverWidget.getDomNode();this._register(yn(e,"keydown",t=>{t.equals(9)&&this.hide()})),this._register(yn(e,"mouseleave",t=>{this._onMouseLeave(t)})),this._register(Ln.onDidChange(()=>{this._contentHoverWidget.position&&this._currentResult&&this._setCurrentResult(this._currentResult)}))}_startShowingOrUpdateHover(e,t,i,n,r){if(!(this._contentHoverWidget.position&&this._currentResult))return e?(this._startHoverOperationIfNecessary(e,t,i,n,!1),!0):!1;const a=this._editor.getOption(60).sticky,l=r&&this._contentHoverWidget.isMouseGettingCloser(r.event.posx,r.event.posy);return a&&l?(e&&this._startHoverOperationIfNecessary(e,t,i,n,!0),!0):e?this._currentResult.anchor.equals(e)?!0:e.canAdoptVisibleHover(this._currentResult.anchor,this._contentHoverWidget.position)?(this._setCurrentResult(this._currentResult.filter(e)),this._startHoverOperationIfNecessary(e,t,i,n,!1),!0):(this._setCurrentResult(null),this._startHoverOperationIfNecessary(e,t,i,n,!1),!0):(this._setCurrentResult(null),!1)}_startHoverOperationIfNecessary(e,t,i,n,r){this._computer.anchor&&this._computer.anchor.equals(e)||(this._hoverOperation.cancel(),this._computer.anchor=e,this._computer.shouldFocus=n,this._computer.source=i,this._computer.insistOnKeepingHoverVisible=r,this._hoverOperation.start(t))}_setCurrentResult(e){let t=e;if(this._currentResult===t)return;t&&t.hoverParts.length===0&&(t=null),this._currentResult=t,this._currentResult?this._showHover(this._currentResult):this._hideHover()}_addLoadingMessage(e){if(!this._computer.anchor)return e;for(const t of this._participants){if(!t.createLoadingMessage)continue;const i=t.createLoadingMessage(this._computer.anchor);if(i)return e.slice(0).concat([i])}return e}_withResult(e){if(this._contentHoverWidget.position&&this._currentResult&&this._currentResult.isComplete||this._setCurrentResult(e),!e.isComplete)return;const n=e.hoverParts.length===0,r=this._computer.insistOnKeepingHoverVisible;n&&r||this._setCurrentResult(e)}_showHover(e){const t=this._getHoverContext();this._renderedContentHover=new xQ(this._editor,e,this._participants,this._computer,t,this._keybindingService),this._renderedContentHover.domNodeHasChildren?this._contentHoverWidget.show(this._renderedContentHover):this._renderedContentHover.dispose()}_hideHover(){this._contentHoverWidget.hide()}_getHoverContext(){return{hide:()=>{this.hide()},onContentsChanged:()=>{this._onContentsChanged.fire(),this._contentHoverWidget.onContentsChanged()},setMinimumDimensions:n=>{this._contentHoverWidget.setMinimumDimensions(n)}}}showsOrWillShow(e){if(this._contentHoverWidget.isResizing)return!0;const i=this._findHoverAnchorCandidates(e);if(!(i.length>0))return this._startShowingOrUpdateHover(null,0,0,!1,e);const r=i[0];return this._startShowingOrUpdateHover(r,0,0,!1,e)}_findHoverAnchorCandidates(e){const t=[];for(const n of this._participants){if(!n.suggestHoverAnchor)continue;const r=n.suggestHoverAnchor(e);r&&t.push(r)}const i=e.target;switch(i.type){case 6:{t.push(new LB(0,i.range,e.event.posx,e.event.posy));break}case 7:{const n=this._editor.getOption(50).typicalHalfwidthCharacterWidth/2;if(!(!i.detail.isAfterLines&&typeof i.detail.horizontalDistanceToText=="number"&&i.detail.horizontalDistanceToText<n))break;t.push(new LB(0,i.range,e.event.posx,e.event.posy));break}}return t.sort((n,r)=>r.priority-n.priority),t}_onMouseLeave(e){const t=this._editor.getDomNode();(!t||!_5(t,e.x,e.y))&&this.hide()}startShowingAtRange(e,t,i,n){this._startShowingOrUpdateHover(new LB(0,e,void 0,void 0),t,i,n,null)}async updateHoverVerbosityLevel(e,t,i){var n;(n=this._renderedContentHover)==null||n.updateHoverVerbosityLevel(e,t,i)}focusedHoverPartIndex(){var e;return((e=this._renderedContentHover)==null?void 0:e.focusedHoverPartIndex)??-1}containsNode(e){return e?this._contentHoverWidget.getDomNode().contains(e):!1}focus(){this._contentHoverWidget.focus()}scrollUp(){this._contentHoverWidget.scrollUp()}scrollDown(){this._contentHoverWidget.scrollDown()}scrollLeft(){this._contentHoverWidget.scrollLeft()}scrollRight(){this._contentHoverWidget.scrollRight()}pageUp(){this._contentHoverWidget.pageUp()}pageDown(){this._contentHoverWidget.pageDown()}goToTop(){this._contentHoverWidget.goToTop()}goToBottom(){this._contentHoverWidget.goToBottom()}hide(){this._computer.anchor=null,this._hoverOperation.cancel(),this._setCurrentResult(null)}getDomNode(){return this._contentHoverWidget.getDomNode()}get isColorPickerVisible(){var e;return((e=this._renderedContentHover)==null?void 0:e.isColorPickerVisible())??!1}get isVisibleFromKeyboard(){return this._contentHoverWidget.isVisibleFromKeyboard}get isVisible(){return this._contentHoverWidget.isVisible}get isFocused(){return this._contentHoverWidget.isFocused}get isResizing(){return this._contentHoverWidget.isResizing}get widget(){return this._contentHoverWidget}};Jz=TYe([Gre(1,Xe),Gre(2,pi)],Jz);var NYe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Qre=function(s,e){return function(t,i){e(t,i,s)}},eU,Iv;let Jr=(Iv=class extends te{constructor(e,t,i){super(),this._editor=e,this._instantiationService=t,this._keybindingService=i,this._onHoverContentsChanged=this._register(new Z),this.shouldKeepOpenOnEditorMouseMoveOrLeave=!1,this._listenersStore=new ce,this._hoverState={mouseDown:!1,activatedByDecoratorClick:!1},this._reactToEditorMouseMoveRunner=this._register(new xi(()=>this._reactToEditorMouseMove(this._mouseMoveEvent),0)),this._hookListeners(),this._register(this._editor.onDidChangeConfiguration(n=>{n.hasChanged(60)&&(this._unhookListeners(),this._hookListeners())}))}static get(e){return e.getContribution(eU.ID)}_hookListeners(){const e=this._editor.getOption(60);this._hoverSettings={enabled:e.enabled,sticky:e.sticky,hidingDelay:e.hidingDelay},e.enabled?(this._listenersStore.add(this._editor.onMouseDown(t=>this._onEditorMouseDown(t))),this._listenersStore.add(this._editor.onMouseUp(()=>this._onEditorMouseUp())),this._listenersStore.add(this._editor.onMouseMove(t=>this._onEditorMouseMove(t))),this._listenersStore.add(this._editor.onKeyDown(t=>this._onKeyDown(t)))):(this._listenersStore.add(this._editor.onMouseMove(t=>this._onEditorMouseMove(t))),this._listenersStore.add(this._editor.onKeyDown(t=>this._onKeyDown(t)))),this._listenersStore.add(this._editor.onMouseLeave(t=>this._onEditorMouseLeave(t))),this._listenersStore.add(this._editor.onDidChangeModel(()=>{this._cancelScheduler(),this._hideWidgets()})),this._listenersStore.add(this._editor.onDidChangeModelContent(()=>this._cancelScheduler())),this._listenersStore.add(this._editor.onDidScrollChange(t=>this._onEditorScrollChanged(t)))}_unhookListeners(){this._listenersStore.clear()}_cancelScheduler(){this._mouseMoveEvent=void 0,this._reactToEditorMouseMoveRunner.cancel()}_onEditorScrollChanged(e){(e.scrollTopChanged||e.scrollLeftChanged)&&this._hideWidgets()}_onEditorMouseDown(e){this._hoverState.mouseDown=!0,!this._shouldNotHideCurrentHoverWidget(e)&&this._hideWidgets()}_shouldNotHideCurrentHoverWidget(e){return this._isMouseOnContentHoverWidget(e)||this._isContentWidgetResizing()}_isMouseOnContentHoverWidget(e){var i;const t=(i=this._contentWidget)==null?void 0:i.getDomNode();return t?_5(t,e.event.posx,e.event.posy):!1}_onEditorMouseUp(){this._hoverState.mouseDown=!1}_onEditorMouseLeave(e){this.shouldKeepOpenOnEditorMouseMoveOrLeave||(this._cancelScheduler(),this._shouldNotHideCurrentHoverWidget(e))||this._hideWidgets()}_shouldNotRecomputeCurrentHoverWidget(e){const t=this._hoverSettings.sticky,i=(o,a)=>{const l=this._isMouseOnContentHoverWidget(o);return a&&l},n=o=>{var c;const a=this._isMouseOnContentHoverWidget(o),l=((c=this._contentWidget)==null?void 0:c.isColorPickerVisible)??!1;return a&&l},r=(o,a)=>{var l,c,d,u;return(a&&((c=this._contentWidget)==null?void 0:c.containsNode((l=o.event.browserEvent.view)==null?void 0:l.document.activeElement))&&!((u=(d=o.event.browserEvent.view)==null?void 0:d.getSelection())!=null&&u.isCollapsed))??!1};return i(e,t)||n(e)||r(e,t)}_onEditorMouseMove(e){var a,l,c,d;if(this.shouldKeepOpenOnEditorMouseMoveOrLeave||(this._mouseMoveEvent=e,(a=this._contentWidget)!=null&&a.isFocused||(l=this._contentWidget)!=null&&l.isResizing))return;const t=this._hoverSettings.sticky;if(t&&((c=this._contentWidget)!=null&&c.isVisibleFromKeyboard))return;if(this._shouldNotRecomputeCurrentHoverWidget(e)){this._reactToEditorMouseMoveRunner.cancel();return}const n=this._hoverSettings.hidingDelay;if(((d=this._contentWidget)==null?void 0:d.isVisible)&&t&&n>0){this._reactToEditorMouseMoveRunner.isScheduled()||this._reactToEditorMouseMoveRunner.schedule(n);return}this._reactToEditorMouseMove(e)}_reactToEditorMouseMove(e){var l;if(!e)return;const i=(l=e.target.element)==null?void 0:l.classList.contains("colorpicker-color-decoration"),n=this._editor.getOption(149),r=this._hoverSettings.enabled,o=this._hoverState.activatedByDecoratorClick;if(i&&(n==="click"&&!o||n==="hover"&&!r||n==="clickAndHover"&&!r&&!o)||!i&&!r&&!o){this._hideWidgets();return}this._tryShowHoverWidget(e)||this._hideWidgets()}_tryShowHoverWidget(e){return this._getOrCreateContentWidget().showsOrWillShow(e)}_onKeyDown(e){var n;if(!this._editor.hasModel())return;const t=this._keybindingService.softDispatch(e,this._editor.getDomNode()),i=t.kind===1||t.kind===2&&(t.commandId===V_e||t.commandId===p5||t.commandId===m5)&&((n=this._contentWidget)==null?void 0:n.isVisible);e.keyCode===5||e.keyCode===6||e.keyCode===57||e.keyCode===4||i||this._hideWidgets()}_hideWidgets(){var e,t;this._hoverState.mouseDown&&((e=this._contentWidget)!=null&&e.isColorPickerVisible)||B1.dropDownVisible||(this._hoverState.activatedByDecoratorClick=!1,(t=this._contentWidget)==null||t.hide())}_getOrCreateContentWidget(){return this._contentWidget||(this._contentWidget=this._instantiationService.createInstance(Jz,this._editor),this._listenersStore.add(this._contentWidget.onContentsChanged(()=>this._onHoverContentsChanged.fire()))),this._contentWidget}showContentHover(e,t,i,n,r=!1){this._hoverState.activatedByDecoratorClick=r,this._getOrCreateContentWidget().startShowingAtRange(e,t,i,n)}_isContentWidgetResizing(){var e;return((e=this._contentWidget)==null?void 0:e.widget.isResizing)||!1}focusedHoverPartIndex(){return this._getOrCreateContentWidget().focusedHoverPartIndex()}updateHoverVerbosityLevel(e,t,i){this._getOrCreateContentWidget().updateHoverVerbosityLevel(e,t,i)}focus(){var e;(e=this._contentWidget)==null||e.focus()}scrollUp(){var e;(e=this._contentWidget)==null||e.scrollUp()}scrollDown(){var e;(e=this._contentWidget)==null||e.scrollDown()}scrollLeft(){var e;(e=this._contentWidget)==null||e.scrollLeft()}scrollRight(){var e;(e=this._contentWidget)==null||e.scrollRight()}pageUp(){var e;(e=this._contentWidget)==null||e.pageUp()}pageDown(){var e;(e=this._contentWidget)==null||e.pageDown()}goToTop(){var e;(e=this._contentWidget)==null||e.goToTop()}goToBottom(){var e;(e=this._contentWidget)==null||e.goToBottom()}get isColorPickerVisible(){var e;return(e=this._contentWidget)==null?void 0:e.isColorPickerVisible}get isHoverVisible(){var e;return(e=this._contentWidget)==null?void 0:e.isVisible}dispose(){var e;super.dispose(),this._unhookListeners(),this._listenersStore.dispose(),(e=this._contentWidget)==null||e.dispose()}},eU=Iv,Iv.ID="editor.contrib.contentHover",Iv);Jr=eU=NYe([Qre(1,Xe),Qre(2,pi)],Jr);const lY=class lY extends te{constructor(e){super(),this._editor=e,this._register(e.onMouseDown(t=>this.onMouseDown(t)))}dispose(){super.dispose()}onMouseDown(e){const t=this._editor.getOption(149);if(t!=="click"&&t!=="clickAndHover")return;const i=e.target;if(i.type!==6||!i.detail.injectedText||i.detail.injectedText.options.attachedData!==N_e||!i.range)return;const n=this._editor.getContribution(Jr.ID);if(n&&!n.isColorPickerVisible){const r=new F(i.range.startLineNumber,i.range.startColumn+1,i.range.endLineNumber,i.range.endColumn+1);n.showContentHover(r,1,0,!1,!0)}}};lY.ID="editor.contrib.colorContribution";let zP=lY;Zt(zP.ID,zP,2);n0.register(sE);var abe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},HC=function(s,e){return function(t,i){e(t,i,s)}},tU,iU,Ev;let Nw=(Ev=class extends te{constructor(e,t,i){super(),this._editor=e,this._instantiationService=i,this._standaloneColorPickerWidget=null,this._standaloneColorPickerVisible=z.standaloneColorPickerVisible.bindTo(t),this._standaloneColorPickerFocused=z.standaloneColorPickerFocused.bindTo(t)}showOrFocus(){var e;this._editor.hasModel()&&(this._standaloneColorPickerVisible.get()?this._standaloneColorPickerFocused.get()||(e=this._standaloneColorPickerWidget)==null||e.focus():this._standaloneColorPickerWidget=this._instantiationService.createInstance(nU,this._editor,this._standaloneColorPickerVisible,this._standaloneColorPickerFocused))}hide(){var e;this._standaloneColorPickerFocused.set(!1),this._standaloneColorPickerVisible.set(!1),(e=this._standaloneColorPickerWidget)==null||e.hide(),this._editor.focus()}insertColor(){var e;(e=this._standaloneColorPickerWidget)==null||e.updateEditor(),this.hide()}static get(e){return e.getContribution(tU.ID)}},tU=Ev,Ev.ID="editor.contrib.standaloneColorPickerController",Ev);Nw=tU=abe([HC(1,ct),HC(2,Xe)],Nw);Zt(Nw.ID,Nw,1);const Yre=8,RYe=22;var Dv;let nU=(Dv=class extends te{constructor(e,t,i,n,r,o,a){var u;super(),this._editor=e,this._standaloneColorPickerVisible=t,this._standaloneColorPickerFocused=i,this._keybindingService=r,this._languageFeaturesService=o,this._editorWorkerService=a,this.allowEditorOverflow=!0,this._position=void 0,this._body=document.createElement("div"),this._colorHover=null,this._selectionSetInEditor=!1,this._onResult=this._register(new Z),this.onResult=this._onResult.event,this._standaloneColorPickerVisible.set(!0),this._standaloneColorPickerParticipant=n.createInstance(rE,this._editor),this._position=(u=this._editor._getViewModel())==null?void 0:u.getPrimaryCursorState().modelState.position;const l=this._editor.getSelection(),c=l?{startLineNumber:l.startLineNumber,startColumn:l.startColumn,endLineNumber:l.endLineNumber,endColumn:l.endColumn}:{startLineNumber:0,endLineNumber:0,endColumn:0,startColumn:0},d=this._register(hu(this._body));this._register(d.onDidBlur(h=>{this.hide()})),this._register(d.onDidFocus(h=>{this.focus()})),this._register(this._editor.onDidChangeCursorPosition(()=>{this._selectionSetInEditor?this._selectionSetInEditor=!1:this.hide()})),this._register(this._editor.onMouseMove(h=>{var p;const g=(p=h.target.element)==null?void 0:p.classList;g&&g.contains("colorpicker-color-decoration")&&this.hide()})),this._register(this.onResult(h=>{this._render(h.value,h.foundInEditor)})),this._start(c),this._body.style.zIndex="50",this._editor.addContentWidget(this)}updateEditor(){this._colorHover&&this._standaloneColorPickerParticipant.updateEditorModel(this._colorHover)}getId(){return iU.ID}getDomNode(){return this._body}getPosition(){if(!this._position)return null;const e=this._editor.getOption(60).above;return{position:this._position,secondaryPosition:this._position,preference:e?[1,2]:[2,1],positionAffinity:2}}hide(){this.dispose(),this._standaloneColorPickerVisible.set(!1),this._standaloneColorPickerFocused.set(!1),this._editor.removeContentWidget(this),this._editor.focus()}focus(){this._standaloneColorPickerFocused.set(!0),this._body.focus()}async _start(e){const t=await this._computeAsync(e);t&&this._onResult.fire(new AYe(t.result,t.foundInEditor))}async _computeAsync(e){if(!this._editor.hasModel())return null;const t={range:e,color:{red:0,green:0,blue:0,alpha:1}},i=await this._standaloneColorPickerParticipant.createColorHover(t,new nE(this._editorWorkerService),this._languageFeaturesService.colorProvider);return i?{result:i.colorHover,foundInEditor:i.foundInEditor}:null}_render(e,t){const i=document.createDocumentFragment(),n=this._register(new PP(this._keybindingService)),r={fragment:i,statusBar:n,onContentsChanged:()=>{},hide:()=>this.hide()};this._colorHover=e;const o=this._standaloneColorPickerParticipant.renderHoverParts(r,[e]);if(!o)return;this._register(o.disposables);const a=o.colorPicker;this._body.classList.add("standalone-colorpicker-body"),this._body.style.maxHeight=Math.max(this._editor.getLayoutInfo().height/4,250)+"px",this._body.style.maxWidth=Math.max(this._editor.getLayoutInfo().width*.66,500)+"px",this._body.tabIndex=0,this._body.appendChild(i),a.layout();const l=a.body,c=l.saturationBox.domNode.clientWidth,d=l.domNode.clientWidth-c-RYe-Yre,u=a.body.enterButton;u==null||u.onClicked(()=>{this.updateEditor(),this.hide()});const h=a.header,g=h.pickedColorNode;g.style.width=c+Yre+"px";const p=h.originalColorNode;p.style.width=d+"px";const _=a.header.closeButton;_==null||_.onClicked(()=>{this.hide()}),t&&(u&&(u.button.textContent="Replace"),this._selectionSetInEditor=!0,this._editor.setSelection(e.range)),this._editor.layoutContentWidget(this)}},iU=Dv,Dv.ID="editor.contrib.standaloneColorPickerWidget",Dv);nU=iU=abe([HC(3,Xe),HC(4,pi),HC(5,Be),HC(6,ca)],nU);class AYe{constructor(e,t){this.value=e,this.foundInEditor=t}}class PYe extends vu{constructor(){super({id:"editor.action.showOrFocusStandaloneColorPicker",title:{...dt("showOrFocusStandaloneColorPicker","Show or Focus Standalone Color Picker"),mnemonicTitle:b({key:"mishowOrFocusStandaloneColorPicker",comment:["&& denotes a mnemonic"]},"&&Show or Focus Standalone Color Picker")},precondition:void 0,menu:[{id:ze.CommandPalette}],metadata:{description:dt("showOrFocusStandaloneColorPickerDescription","Show or focus a standalone color picker which uses the default color provider. It displays hex/rgb/hsl colors.")}})}runEditorCommand(e,t){var i;(i=Nw.get(t))==null||i.showOrFocus()}}class MYe extends Ve{constructor(){super({id:"editor.action.hideColorPicker",label:b({key:"hideColorPicker",comment:["Action that hides the color picker"]},"Hide the Color Picker"),alias:"Hide the Color Picker",precondition:z.standaloneColorPickerVisible.isEqualTo(!0),kbOpts:{primary:9,weight:100},metadata:{description:dt("hideColorPickerDescription","Hide the standalone color picker.")}})}run(e,t){var i;(i=Nw.get(t))==null||i.hide()}}class OYe extends Ve{constructor(){super({id:"editor.action.insertColorWithStandaloneColorPicker",label:b({key:"insertColorWithStandaloneColorPicker",comment:["Action that inserts color with standalone color picker"]},"Insert Color with Standalone Color Picker"),alias:"Insert Color with Standalone Color Picker",precondition:z.standaloneColorPickerFocused.isEqualTo(!0),kbOpts:{primary:3,weight:100},metadata:{description:dt("insertColorWithStandaloneColorPickerDescription","Insert hex/rgb/hsl colors with the focused standalone color picker.")}})}run(e,t){var i;(i=Nw.get(t))==null||i.insertColor()}}ye(MYe);ye(OYe);Oi(PYe);class Zp{constructor(e,t,i){this.languageConfigurationService=i,this._selection=e,this._insertSpace=t,this._usedEndToken=null}static _haystackHasNeedleAtOffset(e,t,i){if(i<0)return!1;const n=t.length,r=e.length;if(i+n>r)return!1;for(let o=0;o<n;o++){const a=e.charCodeAt(i+o),l=t.charCodeAt(o);if(a!==l&&!(a>=65&&a<=90&&a+32===l)&&!(l>=65&&l<=90&&l+32===a))return!1}return!0}_createOperationsForBlockComment(e,t,i,n,r,o){const a=e.startLineNumber,l=e.startColumn,c=e.endLineNumber,d=e.endColumn,u=r.getLineContent(a),h=r.getLineContent(c);let g=u.lastIndexOf(t,l-1+t.length),p=h.indexOf(i,d-1-i.length);if(g!==-1&&p!==-1)if(a===c)u.substring(g+t.length,p).indexOf(i)>=0&&(g=-1,p=-1);else{const v=u.substring(g+t.length),C=h.substring(0,p);(v.indexOf(i)>=0||C.indexOf(i)>=0)&&(g=-1,p=-1)}let _;g!==-1&&p!==-1?(n&&g+t.length<u.length&&u.charCodeAt(g+t.length)===32&&(t=t+" "),n&&p>0&&h.charCodeAt(p-1)===32&&(i=" "+i,p-=1),_=Zp._createRemoveBlockCommentOperations(new F(a,g+t.length+1,c,p+1),t,i)):(_=Zp._createAddBlockCommentOperations(e,t,i,this._insertSpace),this._usedEndToken=_.length===1?i:null);for(const v of _)o.addTrackedEditOperation(v.range,v.text)}static _createRemoveBlockCommentOperations(e,t,i){const n=[];return F.isEmpty(e)?n.push(gn.delete(new F(e.startLineNumber,e.startColumn-t.length,e.endLineNumber,e.endColumn+i.length))):(n.push(gn.delete(new F(e.startLineNumber,e.startColumn-t.length,e.startLineNumber,e.startColumn))),n.push(gn.delete(new F(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn+i.length)))),n}static _createAddBlockCommentOperations(e,t,i,n){const r=[];return F.isEmpty(e)?r.push(gn.replace(new F(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn),t+"  "+i)):(r.push(gn.insert(new X(e.startLineNumber,e.startColumn),t+(n?" ":""))),r.push(gn.insert(new X(e.endLineNumber,e.endColumn),(n?" ":"")+i))),r}getEditOperations(e,t){const i=this._selection.startLineNumber,n=this._selection.startColumn;e.tokenization.tokenizeIfCheap(i);const r=e.getLanguageIdAtPosition(i,n),o=this.languageConfigurationService.getLanguageConfiguration(r).comments;!o||!o.blockCommentStartToken||!o.blockCommentEndToken||this._createOperationsForBlockComment(this._selection,o.blockCommentStartToken,o.blockCommentEndToken,this._insertSpace,e,t)}computeCursorState(e,t){const i=t.getInverseEditOperations();if(i.length===2){const n=i[0],r=i[1];return new Ue(n.range.endLineNumber,n.range.endColumn,r.range.startLineNumber,r.range.startColumn)}else{const n=i[0].range,r=this._usedEndToken?-this._usedEndToken.length-1:0;return new Ue(n.endLineNumber,n.endColumn+r,n.endLineNumber,n.endColumn+r)}}}class Cf{constructor(e,t,i,n,r,o,a){this.languageConfigurationService=e,this._selection=t,this._indentSize=i,this._type=n,this._insertSpace=r,this._selectionId=null,this._deltaColumn=0,this._moveEndPositionDown=!1,this._ignoreEmptyLines=o,this._ignoreFirstLine=a||!1}static _gatherPreflightCommentStrings(e,t,i,n){e.tokenization.tokenizeIfCheap(t);const r=e.getLanguageIdAtPosition(t,1),o=n.getLanguageConfiguration(r).comments,a=o?o.lineCommentToken:null;if(!a)return null;const l=[];for(let c=0,d=i-t+1;c<d;c++)l[c]={ignore:!1,commentStr:a,commentStrOffset:0,commentStrLength:a.length};return l}static _analyzeLines(e,t,i,n,r,o,a,l){let c=!0,d;e===0?d=!0:e===1?d=!1:d=!0;for(let u=0,h=n.length;u<h;u++){const g=n[u],p=r+u;if(p===r&&a){g.ignore=!0;continue}const _=i.getLineContent(p),v=Zr(_);if(v===-1){g.ignore=o,g.commentStrOffset=_.length;continue}if(c=!1,g.ignore=!1,g.commentStrOffset=v,d&&!Zp._haystackHasNeedleAtOffset(_,g.commentStr,v)&&(e===0?d=!1:e===1||(g.ignore=!0)),d&&t){const C=v+g.commentStrLength;C<_.length&&_.charCodeAt(C)===32&&(g.commentStrLength+=1)}}if(e===0&&c){d=!1;for(let u=0,h=n.length;u<h;u++)n[u].ignore=!1}return{supported:!0,shouldRemoveComments:d,lines:n}}static _gatherPreflightData(e,t,i,n,r,o,a,l){const c=Cf._gatherPreflightCommentStrings(i,n,r,l);return c===null?{supported:!1}:Cf._analyzeLines(e,t,i,c,n,o,a,l)}_executeLineComments(e,t,i,n){let r;i.shouldRemoveComments?r=Cf._createRemoveLineCommentsOperations(i.lines,n.startLineNumber):(Cf._normalizeInsertionPoint(e,i.lines,n.startLineNumber,this._indentSize),r=this._createAddLineCommentsOperations(i.lines,n.startLineNumber));const o=new X(n.positionLineNumber,n.positionColumn);for(let a=0,l=r.length;a<l;a++)t.addEditOperation(r[a].range,r[a].text),F.isEmpty(r[a].range)&&F.getStartPosition(r[a].range).equals(o)&&e.getLineContent(o.lineNumber).length+1===o.column&&(this._deltaColumn=(r[a].text||"").length);this._selectionId=t.trackSelection(n)}_attemptRemoveBlockComment(e,t,i,n){let r=t.startLineNumber,o=t.endLineNumber;const a=n.length+Math.max(e.getLineFirstNonWhitespaceColumn(t.startLineNumber),t.startColumn);let l=e.getLineContent(r).lastIndexOf(i,a-1),c=e.getLineContent(o).indexOf(n,t.endColumn-1-i.length);return l!==-1&&c===-1&&(c=e.getLineContent(r).indexOf(n,l+i.length),o=r),l===-1&&c!==-1&&(l=e.getLineContent(o).lastIndexOf(i,c),r=o),t.isEmpty()&&(l===-1||c===-1)&&(l=e.getLineContent(r).indexOf(i),l!==-1&&(c=e.getLineContent(r).indexOf(n,l+i.length))),l!==-1&&e.getLineContent(r).charCodeAt(l+i.length)===32&&(i+=" "),c!==-1&&e.getLineContent(o).charCodeAt(c-1)===32&&(n=" "+n,c-=1),l!==-1&&c!==-1?Zp._createRemoveBlockCommentOperations(new F(r,l+i.length+1,o,c+1),i,n):null}_executeBlockComment(e,t,i){e.tokenization.tokenizeIfCheap(i.startLineNumber);const n=e.getLanguageIdAtPosition(i.startLineNumber,1),r=this.languageConfigurationService.getLanguageConfiguration(n).comments;if(!r||!r.blockCommentStartToken||!r.blockCommentEndToken)return;const o=r.blockCommentStartToken,a=r.blockCommentEndToken;let l=this._attemptRemoveBlockComment(e,i,o,a);if(!l){if(i.isEmpty()){const c=e.getLineContent(i.startLineNumber);let d=Zr(c);d===-1&&(d=c.length),l=Zp._createAddBlockCommentOperations(new F(i.startLineNumber,d+1,i.startLineNumber,c.length+1),o,a,this._insertSpace)}else l=Zp._createAddBlockCommentOperations(new F(i.startLineNumber,e.getLineFirstNonWhitespaceColumn(i.startLineNumber),i.endLineNumber,e.getLineMaxColumn(i.endLineNumber)),o,a,this._insertSpace);l.length===1&&(this._deltaColumn=o.length+1)}this._selectionId=t.trackSelection(i);for(const c of l)t.addEditOperation(c.range,c.text)}getEditOperations(e,t){let i=this._selection;if(this._moveEndPositionDown=!1,i.startLineNumber===i.endLineNumber&&this._ignoreFirstLine){t.addEditOperation(new F(i.startLineNumber,e.getLineMaxColumn(i.startLineNumber),i.startLineNumber+1,1),i.startLineNumber===e.getLineCount()?"":`
`),this._selectionId=t.trackSelection(i);return}i.startLineNumber<i.endLineNumber&&i.endColumn===1&&(this._moveEndPositionDown=!0,i=i.setEndPosition(i.endLineNumber-1,e.getLineMaxColumn(i.endLineNumber-1)));const n=Cf._gatherPreflightData(this._type,this._insertSpace,e,i.startLineNumber,i.endLineNumber,this._ignoreEmptyLines,this._ignoreFirstLine,this.languageConfigurationService);return n.supported?this._executeLineComments(e,t,n,i):this._executeBlockComment(e,t,i)}computeCursorState(e,t){let i=t.getTrackedSelection(this._selectionId);return this._moveEndPositionDown&&(i=i.setEndPosition(i.endLineNumber+1,1)),new Ue(i.selectionStartLineNumber,i.selectionStartColumn+this._deltaColumn,i.positionLineNumber,i.positionColumn+this._deltaColumn)}static _createRemoveLineCommentsOperations(e,t){const i=[];for(let n=0,r=e.length;n<r;n++){const o=e[n];o.ignore||i.push(gn.delete(new F(t+n,o.commentStrOffset+1,t+n,o.commentStrOffset+o.commentStrLength+1)))}return i}_createAddLineCommentsOperations(e,t){const i=[],n=this._insertSpace?" ":"";for(let r=0,o=e.length;r<o;r++){const a=e[r];a.ignore||i.push(gn.insert(new X(t+r,a.commentStrOffset+1),a.commentStr+n))}return i}static nextVisibleColumn(e,t,i,n){return i?e+(t-e%t):e+n}static _normalizeInsertionPoint(e,t,i,n){let r=1073741824,o,a;for(let l=0,c=t.length;l<c;l++){if(t[l].ignore)continue;const d=e.getLineContent(i+l);let u=0;for(let h=0,g=t[l].commentStrOffset;u<r&&h<g;h++)u=Cf.nextVisibleColumn(u,n,d.charCodeAt(h)===9,1);u<r&&(r=u)}r=Math.floor(r/n)*n;for(let l=0,c=t.length;l<c;l++){if(t[l].ignore)continue;const d=e.getLineContent(i+l);let u=0;for(o=0,a=t[l].commentStrOffset;u<r&&o<a;o++)u=Cf.nextVisibleColumn(u,n,d.charCodeAt(o)===9,1);u>r?t[l].commentStrOffset=o-1:t[l].commentStrOffset=o}}}class LQ extends Ve{constructor(e,t){super(t),this._type=e}run(e,t){const i=e.get(bn);if(!t.hasModel())return;const n=t.getModel(),r=[],o=n.getOptions(),a=t.getOption(23),l=t.getSelections().map((d,u)=>({selection:d,index:u,ignoreFirstLine:!1}));l.sort((d,u)=>F.compareRangesUsingStarts(d.selection,u.selection));let c=l[0];for(let d=1;d<l.length;d++){const u=l[d];c.selection.endLineNumber===u.selection.startLineNumber&&(c.index<u.index?u.ignoreFirstLine=!0:(c.ignoreFirstLine=!0,c=u))}for(const d of l)r.push(new Cf(i,d.selection,o.indentSize,this._type,a.insertSpace,a.ignoreEmptyLines,d.ignoreFirstLine));t.pushUndoStop(),t.executeCommands(this.id,r),t.pushUndoStop()}}class FYe extends LQ{constructor(){super(0,{id:"editor.action.commentLine",label:b("comment.line","Toggle Line Comment"),alias:"Toggle Line Comment",precondition:z.writable,kbOpts:{kbExpr:z.editorTextFocus,primary:2138,weight:100},menuOpts:{menuId:ze.MenubarEditMenu,group:"5_insert",title:b({key:"miToggleLineComment",comment:["&& denotes a mnemonic"]},"&&Toggle Line Comment"),order:1}})}}class VYe extends LQ{constructor(){super(1,{id:"editor.action.addCommentLine",label:b("comment.line.add","Add Line Comment"),alias:"Add Line Comment",precondition:z.writable,kbOpts:{kbExpr:z.editorTextFocus,primary:ns(2089,2081),weight:100}})}}class BYe extends LQ{constructor(){super(2,{id:"editor.action.removeCommentLine",label:b("comment.line.remove","Remove Line Comment"),alias:"Remove Line Comment",precondition:z.writable,kbOpts:{kbExpr:z.editorTextFocus,primary:ns(2089,2099),weight:100}})}}class WYe extends Ve{constructor(){super({id:"editor.action.blockComment",label:b("comment.block","Toggle Block Comment"),alias:"Toggle Block Comment",precondition:z.writable,kbOpts:{kbExpr:z.editorTextFocus,primary:1567,linux:{primary:3103},weight:100},menuOpts:{menuId:ze.MenubarEditMenu,group:"5_insert",title:b({key:"miToggleBlockComment",comment:["&& denotes a mnemonic"]},"Toggle &&Block Comment"),order:2}})}run(e,t){const i=e.get(bn);if(!t.hasModel())return;const n=t.getOption(23),r=[],o=t.getSelections();for(const a of o)r.push(new Zp(a,n.insertSpace,i));t.pushUndoStop(),t.executeCommands(this.id,r),t.pushUndoStop()}}ye(FYe);ye(VYe);ye(BYe);ye(WYe);var HYe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},J_=function(s,e){return function(t,i){e(t,i,s)}},sU,Tv;let H1=(Tv=class{static get(e){return e.getContribution(sU.ID)}constructor(e,t,i,n,r,o,a,l){this._contextMenuService=t,this._contextViewService=i,this._contextKeyService=n,this._keybindingService=r,this._menuService=o,this._configurationService=a,this._workspaceContextService=l,this._toDispose=new ce,this._contextMenuIsBeingShownCount=0,this._editor=e,this._toDispose.add(this._editor.onContextMenu(c=>this._onContextMenu(c))),this._toDispose.add(this._editor.onMouseWheel(c=>{if(this._contextMenuIsBeingShownCount>0){const d=this._contextViewService.getContextViewElement(),u=c.srcElement;u.shadowRoot&&uw(d)===u.shadowRoot||this._contextViewService.hideContextView()}})),this._toDispose.add(this._editor.onKeyDown(c=>{this._editor.getOption(24)&&c.keyCode===58&&(c.preventDefault(),c.stopPropagation(),this.showContextMenu())}))}_onContextMenu(e){if(!this._editor.hasModel())return;if(!this._editor.getOption(24)){this._editor.focus(),e.target.position&&!this._editor.getSelection().containsPosition(e.target.position)&&this._editor.setPosition(e.target.position);return}if(e.target.type===12||e.target.type===6&&e.target.detail.injectedText)return;if(e.event.preventDefault(),e.event.stopPropagation(),e.target.type===11)return this._showScrollbarContextMenu(e.event);if(e.target.type!==6&&e.target.type!==7&&e.target.type!==1)return;if(this._editor.focus(),e.target.position){let i=!1;for(const n of this._editor.getSelections())if(n.containsPosition(e.target.position)){i=!0;break}i||this._editor.setPosition(e.target.position)}let t=null;e.target.type!==1&&(t=e.event),this.showContextMenu(t)}showContextMenu(e){if(!this._editor.getOption(24)||!this._editor.hasModel())return;const t=this._getMenuActions(this._editor.getModel(),this._editor.contextMenuId);t.length>0&&this._doShowContextMenu(t,e)}_getMenuActions(e,t){const i=[],n=this._menuService.getMenuActions(t,this._contextKeyService,{arg:e.uri});for(const r of n){const[,o]=r;let a=0;for(const l of o)if(l instanceof _y){const c=this._getMenuActions(e,l.item.submenu);c.length>0&&(i.push(new f1(l.id,l.label,c)),a++)}else i.push(l),a++;a&&i.push(new ks)}return i.length&&i.pop(),i}_doShowContextMenu(e,t=null){if(!this._editor.hasModel())return;const i=this._editor.getOption(60);this._editor.updateOptions({hover:{enabled:!1}});let n=t;if(!n){this._editor.revealPosition(this._editor.getPosition(),1),this._editor.render();const o=this._editor.getScrolledVisiblePosition(this._editor.getPosition()),a=Pn(this._editor.getDomNode()),l=a.left+o.left,c=a.top+o.top+o.height;n={x:l,y:c}}const r=this._editor.getOption(128)&&!du;this._contextMenuIsBeingShownCount++,this._contextMenuService.showContextMenu({domForShadowRoot:r?this._editor.getOverflowWidgetsDomNode()??this._editor.getDomNode():void 0,getAnchor:()=>n,getActions:()=>e,getActionViewItem:o=>{const a=this._keybindingFor(o);if(a)return new I1(o,o,{label:!0,keybinding:a.getLabel(),isMenu:!0});const l=o;return typeof l.getActionViewItem=="function"?l.getActionViewItem():new I1(o,o,{icon:!0,label:!0,isMenu:!0})},getKeyBinding:o=>this._keybindingFor(o),onHide:o=>{this._contextMenuIsBeingShownCount--,this._editor.updateOptions({hover:i})}})}_showScrollbarContextMenu(e){if(!this._editor.hasModel()||W3e(this._workspaceContextService.getWorkspace()))return;const t=this._editor.getOption(73);let i=0;const n=c=>({id:`menu-action-${++i}`,label:c.label,tooltip:"",class:void 0,enabled:typeof c.enabled>"u"?!0:c.enabled,checked:c.checked,run:c.run}),r=(c,d)=>new f1(`menu-action-${++i}`,c,d,void 0),o=(c,d,u,h,g)=>{if(!d)return n({label:c,enabled:d,run:()=>{}});const p=v=>()=>{this._configurationService.updateValue(u,v)},_=[];for(const v of g)_.push(n({label:v.label,checked:h===v.value,run:p(v.value)}));return r(c,_)},a=[];a.push(n({label:b("context.minimap.minimap","Minimap"),checked:t.enabled,run:()=>{this._configurationService.updateValue("editor.minimap.enabled",!t.enabled)}})),a.push(new ks),a.push(n({label:b("context.minimap.renderCharacters","Render Characters"),enabled:t.enabled,checked:t.renderCharacters,run:()=>{this._configurationService.updateValue("editor.minimap.renderCharacters",!t.renderCharacters)}})),a.push(o(b("context.minimap.size","Vertical size"),t.enabled,"editor.minimap.size",t.size,[{label:b("context.minimap.size.proportional","Proportional"),value:"proportional"},{label:b("context.minimap.size.fill","Fill"),value:"fill"},{label:b("context.minimap.size.fit","Fit"),value:"fit"}])),a.push(o(b("context.minimap.slider","Slider"),t.enabled,"editor.minimap.showSlider",t.showSlider,[{label:b("context.minimap.slider.mouseover","Mouse Over"),value:"mouseover"},{label:b("context.minimap.slider.always","Always"),value:"always"}]));const l=this._editor.getOption(128)&&!du;this._contextMenuIsBeingShownCount++,this._contextMenuService.showContextMenu({domForShadowRoot:l?this._editor.getDomNode():void 0,getAnchor:()=>e,getActions:()=>a,onHide:c=>{this._contextMenuIsBeingShownCount--,this._editor.focus()}})}_keybindingFor(e){return this._keybindingService.lookupKeybinding(e.id)}dispose(){this._contextMenuIsBeingShownCount>0&&this._contextViewService.hideContextView(),this._toDispose.dispose()}},sU=Tv,Tv.ID="editor.contrib.contextmenu",Tv);H1=sU=HYe([J_(1,Ba),J_(2,Fg),J_(3,ct),J_(4,pi),J_(5,Ol),J_(6,At),J_(7,_w)],H1);class zYe extends Ve{constructor(){super({id:"editor.action.showContextMenu",label:b("action.showContextMenu.label","Show Editor Context Menu"),alias:"Show Editor Context Menu",precondition:void 0,kbOpts:{kbExpr:z.textInputFocus,primary:1092,weight:100}})}run(e,t){var i;(i=H1.get(t))==null||i.showContextMenu()}}Zt(H1.ID,H1,2);ye(zYe);class IB{constructor(e){this.selections=e}equals(e){const t=this.selections.length,i=e.selections.length;if(t!==i)return!1;for(let n=0;n<t;n++)if(!this.selections[n].equalsSelection(e.selections[n]))return!1;return!0}}class EB{constructor(e,t,i){this.cursorState=e,this.scrollTop=t,this.scrollLeft=i}}const DO=class DO extends te{static get(e){return e.getContribution(DO.ID)}constructor(e){super(),this._editor=e,this._isCursorUndoRedo=!1,this._undoStack=[],this._redoStack=[],this._register(e.onDidChangeModel(t=>{this._undoStack=[],this._redoStack=[]})),this._register(e.onDidChangeModelContent(t=>{this._undoStack=[],this._redoStack=[]})),this._register(e.onDidChangeCursorSelection(t=>{if(this._isCursorUndoRedo||!t.oldSelections||t.oldModelVersionId!==t.modelVersionId)return;const i=new IB(t.oldSelections);this._undoStack.length>0&&this._undoStack[this._undoStack.length-1].cursorState.equals(i)||(this._undoStack.push(new EB(i,e.getScrollTop(),e.getScrollLeft())),this._redoStack=[],this._undoStack.length>50&&this._undoStack.shift())}))}cursorUndo(){!this._editor.hasModel()||this._undoStack.length===0||(this._redoStack.push(new EB(new IB(this._editor.getSelections()),this._editor.getScrollTop(),this._editor.getScrollLeft())),this._applyState(this._undoStack.pop()))}cursorRedo(){!this._editor.hasModel()||this._redoStack.length===0||(this._undoStack.push(new EB(new IB(this._editor.getSelections()),this._editor.getScrollTop(),this._editor.getScrollLeft())),this._applyState(this._redoStack.pop()))}_applyState(e){this._isCursorUndoRedo=!0,this._editor.setSelections(e.cursorState.selections),this._editor.setScrollPosition({scrollTop:e.scrollTop,scrollLeft:e.scrollLeft}),this._isCursorUndoRedo=!1}};DO.ID="editor.contrib.cursorUndoRedoController";let z1=DO;class UYe extends Ve{constructor(){super({id:"cursorUndo",label:b("cursor.undo","Cursor Undo"),alias:"Cursor Undo",precondition:void 0,kbOpts:{kbExpr:z.textInputFocus,primary:2099,weight:100}})}run(e,t,i){var n;(n=z1.get(t))==null||n.cursorUndo()}}class jYe extends Ve{constructor(){super({id:"cursorRedo",label:b("cursor.redo","Cursor Redo"),alias:"Cursor Redo",precondition:void 0})}run(e,t,i){var n;(n=z1.get(t))==null||n.cursorRedo()}}Zt(z1.ID,z1,0);ye(UYe);ye(jYe);class $Ye{constructor(e,t,i){this.selection=e,this.targetPosition=t,this.copy=i,this.targetSelection=null}getEditOperations(e,t){const i=e.getValueInRange(this.selection);if(this.copy||t.addEditOperation(this.selection,null),t.addEditOperation(new F(this.targetPosition.lineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.targetPosition.column),i),this.selection.containsPosition(this.targetPosition)&&!(this.copy&&(this.selection.getEndPosition().equals(this.targetPosition)||this.selection.getStartPosition().equals(this.targetPosition)))){this.targetSelection=this.selection;return}if(this.copy){this.targetSelection=new Ue(this.targetPosition.lineNumber,this.targetPosition.column,this.selection.endLineNumber-this.selection.startLineNumber+this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn);return}if(this.targetPosition.lineNumber>this.selection.endLineNumber){this.targetSelection=new Ue(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn);return}if(this.targetPosition.lineNumber<this.selection.endLineNumber){this.targetSelection=new Ue(this.targetPosition.lineNumber,this.targetPosition.column,this.targetPosition.lineNumber+this.selection.endLineNumber-this.selection.startLineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn);return}this.selection.endColumn<=this.targetPosition.column?this.targetSelection=new Ue(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column-this.selection.endColumn+this.selection.startColumn:this.targetPosition.column-this.selection.endColumn+this.selection.startColumn,this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column:this.selection.endColumn):this.targetSelection=new Ue(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.targetPosition.column+this.selection.endColumn-this.selection.startColumn)}computeCursorState(e,t){return this.targetSelection}}function tC(s){return Wt?s.altKey:s.ctrlKey}const Ep=class Ep extends te{constructor(e){super(),this._editor=e,this._dndDecorationIds=this._editor.createDecorationsCollection(),this._register(this._editor.onMouseDown(t=>this._onEditorMouseDown(t))),this._register(this._editor.onMouseUp(t=>this._onEditorMouseUp(t))),this._register(this._editor.onMouseDrag(t=>this._onEditorMouseDrag(t))),this._register(this._editor.onMouseDrop(t=>this._onEditorMouseDrop(t))),this._register(this._editor.onMouseDropCanceled(()=>this._onEditorMouseDropCanceled())),this._register(this._editor.onKeyDown(t=>this.onEditorKeyDown(t))),this._register(this._editor.onKeyUp(t=>this.onEditorKeyUp(t))),this._register(this._editor.onDidBlurEditorWidget(()=>this.onEditorBlur())),this._register(this._editor.onDidBlurEditorText(()=>this.onEditorBlur())),this._mouseDown=!1,this._modifierPressed=!1,this._dragSelection=null}onEditorBlur(){this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1,this._modifierPressed=!1}onEditorKeyDown(e){!this._editor.getOption(35)||this._editor.getOption(22)||(tC(e)&&(this._modifierPressed=!0),this._mouseDown&&tC(e)&&this._editor.updateOptions({mouseStyle:"copy"}))}onEditorKeyUp(e){!this._editor.getOption(35)||this._editor.getOption(22)||(tC(e)&&(this._modifierPressed=!1),this._mouseDown&&e.keyCode===Ep.TRIGGER_KEY_VALUE&&this._editor.updateOptions({mouseStyle:"default"}))}_onEditorMouseDown(e){this._mouseDown=!0}_onEditorMouseUp(e){this._mouseDown=!1,this._editor.updateOptions({mouseStyle:"text"})}_onEditorMouseDrag(e){const t=e.target;if(this._dragSelection===null){const n=(this._editor.getSelections()||[]).filter(r=>t.position&&r.containsPosition(t.position));if(n.length===1)this._dragSelection=n[0];else return}tC(e.event)?this._editor.updateOptions({mouseStyle:"copy"}):this._editor.updateOptions({mouseStyle:"default"}),t.position&&(this._dragSelection.containsPosition(t.position)?this._removeDecoration():this.showAt(t.position))}_onEditorMouseDropCanceled(){this._editor.updateOptions({mouseStyle:"text"}),this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1}_onEditorMouseDrop(e){if(e.target&&(this._hitContent(e.target)||this._hitMargin(e.target))&&e.target.position){const t=new X(e.target.position.lineNumber,e.target.position.column);if(this._dragSelection===null){let i=null;if(e.event.shiftKey){const n=this._editor.getSelection();if(n){const{selectionStartLineNumber:r,selectionStartColumn:o}=n;i=[new Ue(r,o,t.lineNumber,t.column)]}}else i=(this._editor.getSelections()||[]).map(n=>n.containsPosition(t)?new Ue(t.lineNumber,t.column,t.lineNumber,t.column):n);this._editor.setSelections(i||[],"mouse",3)}else(!this._dragSelection.containsPosition(t)||(tC(e.event)||this._modifierPressed)&&(this._dragSelection.getEndPosition().equals(t)||this._dragSelection.getStartPosition().equals(t)))&&(this._editor.pushUndoStop(),this._editor.executeCommand(Ep.ID,new $Ye(this._dragSelection,t,tC(e.event)||this._modifierPressed)),this._editor.pushUndoStop())}this._editor.updateOptions({mouseStyle:"text"}),this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1}showAt(e){this._dndDecorationIds.set([{range:new F(e.lineNumber,e.column,e.lineNumber,e.column),options:Ep._DECORATION_OPTIONS}]),this._editor.revealPosition(e,1)}_removeDecoration(){this._dndDecorationIds.clear()}_hitContent(e){return e.type===6||e.type===7}_hitMargin(e){return e.type===2||e.type===3||e.type===4}dispose(){this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1,this._modifierPressed=!1,super.dispose()}};Ep.ID="editor.contrib.dragAndDrop",Ep.TRIGGER_KEY_VALUE=Wt?6:5,Ep._DECORATION_OPTIONS=_t.register({description:"dnd-target",className:"dnd-target"});let UP=Ep;Zt(UP.ID,UP,2);Zt(Dg.ID,Dg,0);LS(vz);Me(new class extends fs{constructor(){super({id:d_e,precondition:uQ,kbOpts:{weight:100,primary:2137}})}runEditorCommand(s,e){var t;return(t=Dg.get(e))==null?void 0:t.changePasteType()}});Me(new class extends fs{constructor(){super({id:"editor.hidePasteWidget",precondition:uQ,kbOpts:{weight:100,primary:9}})}runEditorCommand(s,e){var t;(t=Dg.get(e))==null||t.clearWidgets()}});var Nv;ye((Nv=class extends Ve{constructor(){super({id:"editor.action.pasteAs",label:b("pasteAs","Paste As..."),alias:"Paste As...",precondition:z.writable,metadata:{description:"Paste as",args:[{name:"args",schema:Nv.argsSchema}]}})}run(e,t,i){var r;let n=typeof(i==null?void 0:i.kind)=="string"?i.kind:void 0;return!n&&i&&(n=typeof i.id=="string"?i.id:void 0),(r=Dg.get(t))==null?void 0:r.pasteAs(n?new cn(n):void 0)}},Nv.argsSchema={type:"object",properties:{kind:{type:"string",description:b("pasteAs.kind","The kind of the paste edit to try applying. If not provided or there are multiple edits for this kind, the editor will show a picker.")}}},Nv));ye(class extends Ve{constructor(){super({id:"editor.action.pasteAsText",label:b("pasteAsText","Paste as Text"),alias:"Paste as Text",precondition:z.writable})}run(s,e){var t;return(t=Dg.get(e))==null?void 0:t.pasteAs({providerId:xw.id})}});class qYe{constructor(){this._dragOperations=new Map}removeDragOperationTransfer(e){if(e&&this._dragOperations.has(e)){const t=this._dragOperations.get(e);return this._dragOperations.delete(e),t}}}class Xre{constructor(e){this.identifier=e}}const lbe=Ht("treeViewsDndService");qt(lbe,qYe,1);var KYe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},HN=function(s,e){return function(t,i){e(t,i,s)}},rU;const cbe="editor.experimental.dropIntoEditor.defaultProvider",dbe="editor.changeDropType",kQ=new Oe("dropWidgetVisible",!1,b("dropWidgetVisible","Whether the drop widget is showing"));var Rv;let U1=(Rv=class extends te{static get(e){return e.getContribution(rU.ID)}constructor(e,t,i,n,r){super(),this._configService=i,this._languageFeaturesService=n,this._treeViewsDragAndDropService=r,this.treeItemsTransfer=_z.getInstance(),this._dropProgressManager=this._register(t.createInstance(TP,"dropIntoEditor",e)),this._postDropWidgetManager=this._register(t.createInstance(RP,"dropIntoEditor",e,kQ,{id:dbe,label:b("postDropWidgetTitle","Show drop options...")})),this._register(e.onDropIntoEditor(o=>this.onDropIntoEditor(e,o.position,o.event)))}clearWidgets(){this._postDropWidgetManager.clear()}changeDropType(){this._postDropWidgetManager.tryShowSelector()}async onDropIntoEditor(e,t,i){var r;if(!i.dataTransfer||!e.hasModel())return;(r=this._currentOperation)==null||r.cancel(),e.focus(),e.setPosition(t);const n=xs(async o=>{const a=new ce,l=a.add(new t_(e,1,void 0,o));try{const c=await this.extractDataTransferData(i);if(c.size===0||l.token.isCancellationRequested)return;const d=e.getModel();if(!d)return;const u=this._languageFeaturesService.documentDropEditProvider.ordered(d).filter(g=>g.dropMimeTypes?g.dropMimeTypes.some(p=>c.matches(p)):!0),h=a.add(await this.getDropEdits(u,d,t,c,l));if(l.token.isCancellationRequested)return;if(h.edits.length){const g=this.getInitialActiveEditIndex(d,h.edits),p=e.getOption(36).showDropSelector==="afterDrop";await this._postDropWidgetManager.applyEditAndShowIfNeeded([F.fromPositions(t)],{activeEditIndex:g,allEdits:h.edits},p,async _=>_,o)}}finally{a.dispose(),this._currentOperation===n&&(this._currentOperation=void 0)}});this._dropProgressManager.showWhile(t,b("dropIntoEditorProgress","Running drop handlers. Click to cancel"),n,{cancel:()=>n.cancel()}),this._currentOperation=n}async getDropEdits(e,t,i,n,r){const o=new ce,a=await jE(Promise.all(e.map(async c=>{try{const d=await c.provideDocumentDropEdits(t,i,n,r.token);return d&&o.add(d),d==null?void 0:d.edits.map(u=>({...u,providerId:c.id}))}catch(d){console.error(d)}})),r.token),l=rd(a??[]).flat();return{edits:l_e(l),dispose:()=>o.dispose()}}getInitialActiveEditIndex(e,t){const i=this._configService.getValue(cbe,{resource:e.uri});for(const[n,r]of Object.entries(i)){const o=new cn(r),a=t.findIndex(l=>o.value===l.providerId&&l.handledMimeType&&e_e(n,[l.handledMimeType]));if(a>=0)return a}return 0}async extractDataTransferData(e){if(!e.dataTransfer)return new Jme;const t=n_e(e.dataTransfer);if(this.treeItemsTransfer.hasData(Xre.prototype)){const i=this.treeItemsTransfer.getData(Xre.prototype);if(Array.isArray(i))for(const n of i){const r=await this._treeViewsDragAndDropService.removeDragOperationTransfer(n.identifier);if(r)for(const[o,a]of r)t.replace(o,a)}}return t}},rU=Rv,Rv.ID="editor.contrib.dropIntoEditorController",Rv);U1=rU=KYe([HN(1,Xe),HN(2,At),HN(3,Be),HN(4,lbe)],U1);Zt(U1.ID,U1,2);LS(bz);Me(new class extends fs{constructor(){super({id:dbe,precondition:kQ,kbOpts:{weight:100,primary:2137}})}runEditorCommand(s,e,t){var i;(i=U1.get(e))==null||i.changeDropType()}});Me(new class extends fs{constructor(){super({id:"editor.hideDropWidget",precondition:kQ,kbOpts:{weight:100,primary:9}})}runEditorCommand(s,e,t){var i;(i=U1.get(e))==null||i.clearWidgets()}});_n.as(pd.Configuration).registerConfiguration({...JE,properties:{[cbe]:{type:"object",scope:5,description:b("defaultProviderDescription","Configures the default drop provider to use for content of a given mime type."),default:{},additionalProperties:{type:"string"}}}});const Hr=class Hr{constructor(e){this._editor=e,this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null,this._startPosition=this._editor.getPosition()}dispose(){this._editor.removeDecorations(this._allDecorations()),this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null}reset(){this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null}getCount(){return this._decorations.length}getFindScope(){return this._findScopeDecorationIds[0]?this._editor.getModel().getDecorationRange(this._findScopeDecorationIds[0]):null}getFindScopes(){if(this._findScopeDecorationIds.length){const e=this._findScopeDecorationIds.map(t=>this._editor.getModel().getDecorationRange(t)).filter(t=>!!t);if(e.length)return e}return null}getStartPosition(){return this._startPosition}setStartPosition(e){this._startPosition=e,this.setCurrentFindMatch(null)}_getDecorationIndex(e){const t=this._decorations.indexOf(e);return t>=0?t+1:1}getDecorationRangeAt(e){const t=e<this._decorations.length?this._decorations[e]:null;return t?this._editor.getModel().getDecorationRange(t):null}getCurrentMatchesPosition(e){const t=this._editor.getModel().getDecorationsInRange(e);for(const i of t){const n=i.options;if(n===Hr._FIND_MATCH_DECORATION||n===Hr._CURRENT_FIND_MATCH_DECORATION)return this._getDecorationIndex(i.id)}return 0}setCurrentFindMatch(e){let t=null,i=0;if(e)for(let n=0,r=this._decorations.length;n<r;n++){const o=this._editor.getModel().getDecorationRange(this._decorations[n]);if(e.equalsRange(o)){t=this._decorations[n],i=n+1;break}}return(this._highlightedDecorationId!==null||t!==null)&&this._editor.changeDecorations(n=>{if(this._highlightedDecorationId!==null&&(n.changeDecorationOptions(this._highlightedDecorationId,Hr._FIND_MATCH_DECORATION),this._highlightedDecorationId=null),t!==null&&(this._highlightedDecorationId=t,n.changeDecorationOptions(this._highlightedDecorationId,Hr._CURRENT_FIND_MATCH_DECORATION)),this._rangeHighlightDecorationId!==null&&(n.removeDecoration(this._rangeHighlightDecorationId),this._rangeHighlightDecorationId=null),t!==null){let r=this._editor.getModel().getDecorationRange(t);if(r.startLineNumber!==r.endLineNumber&&r.endColumn===1){const o=r.endLineNumber-1,a=this._editor.getModel().getLineMaxColumn(o);r=new F(r.startLineNumber,r.startColumn,o,a)}this._rangeHighlightDecorationId=n.addDecoration(r,Hr._RANGE_HIGHLIGHT_DECORATION)}}),i}set(e,t){this._editor.changeDecorations(i=>{let n=Hr._FIND_MATCH_DECORATION;const r=[];if(e.length>1e3){n=Hr._FIND_MATCH_NO_OVERVIEW_DECORATION;const a=this._editor.getModel().getLineCount(),c=this._editor.getLayoutInfo().height/a,d=Math.max(2,Math.ceil(3/c));let u=e[0].range.startLineNumber,h=e[0].range.endLineNumber;for(let g=1,p=e.length;g<p;g++){const _=e[g].range;h+d>=_.startLineNumber?_.endLineNumber>h&&(h=_.endLineNumber):(r.push({range:new F(u,1,h,1),options:Hr._FIND_MATCH_ONLY_OVERVIEW_DECORATION}),u=_.startLineNumber,h=_.endLineNumber)}r.push({range:new F(u,1,h,1),options:Hr._FIND_MATCH_ONLY_OVERVIEW_DECORATION})}const o=new Array(e.length);for(let a=0,l=e.length;a<l;a++)o[a]={range:e[a].range,options:n};this._decorations=i.deltaDecorations(this._decorations,o),this._overviewRulerApproximateDecorations=i.deltaDecorations(this._overviewRulerApproximateDecorations,r),this._rangeHighlightDecorationId&&(i.removeDecoration(this._rangeHighlightDecorationId),this._rangeHighlightDecorationId=null),this._findScopeDecorationIds.length&&(this._findScopeDecorationIds.forEach(a=>i.removeDecoration(a)),this._findScopeDecorationIds=[]),t!=null&&t.length&&(this._findScopeDecorationIds=t.map(a=>i.addDecoration(a,Hr._FIND_SCOPE_DECORATION)))})}matchBeforePosition(e){if(this._decorations.length===0)return null;for(let t=this._decorations.length-1;t>=0;t--){const i=this._decorations[t],n=this._editor.getModel().getDecorationRange(i);if(!(!n||n.endLineNumber>e.lineNumber)){if(n.endLineNumber<e.lineNumber)return n;if(!(n.endColumn>e.column))return n}}return this._editor.getModel().getDecorationRange(this._decorations[this._decorations.length-1])}matchAfterPosition(e){if(this._decorations.length===0)return null;for(let t=0,i=this._decorations.length;t<i;t++){const n=this._decorations[t],r=this._editor.getModel().getDecorationRange(n);if(!(!r||r.startLineNumber<e.lineNumber)){if(r.startLineNumber>e.lineNumber)return r;if(!(r.startColumn<e.column))return r}}return this._editor.getModel().getDecorationRange(this._decorations[0])}_allDecorations(){let e=[];return e=e.concat(this._decorations),e=e.concat(this._overviewRulerApproximateDecorations),this._findScopeDecorationIds.length&&e.push(...this._findScopeDecorationIds),this._rangeHighlightDecorationId&&e.push(this._rangeHighlightDecorationId),e}};Hr._CURRENT_FIND_MATCH_DECORATION=_t.register({description:"current-find-match",stickiness:1,zIndex:13,className:"currentFindMatch",inlineClassName:"currentFindMatchInline",showIfCollapsed:!0,overviewRuler:{color:kn(xV),position:Il.Center},minimap:{color:kn(R6),position:1}}),Hr._FIND_MATCH_DECORATION=_t.register({description:"find-match",stickiness:1,zIndex:10,className:"findMatch",inlineClassName:"findMatchInline",showIfCollapsed:!0,overviewRuler:{color:kn(xV),position:Il.Center},minimap:{color:kn(R6),position:1}}),Hr._FIND_MATCH_NO_OVERVIEW_DECORATION=_t.register({description:"find-match-no-overview",stickiness:1,className:"findMatch",showIfCollapsed:!0}),Hr._FIND_MATCH_ONLY_OVERVIEW_DECORATION=_t.register({description:"find-match-only-overview",stickiness:1,overviewRuler:{color:kn(xV),position:Il.Center}}),Hr._RANGE_HIGHLIGHT_DECORATION=_t.register({description:"find-range-highlight",stickiness:1,className:"rangeHighlight",isWholeLine:!0}),Hr._FIND_SCOPE_DECORATION=_t.register({description:"find-scope",className:"findScope",isWholeLine:!0});let oU=Hr;class GYe{constructor(e,t,i){this._editorSelection=e,this._ranges=t,this._replaceStrings=i,this._trackedEditorSelectionId=null}getEditOperations(e,t){if(this._ranges.length>0){const i=[];for(let o=0;o<this._ranges.length;o++)i.push({range:this._ranges[o],text:this._replaceStrings[o]});i.sort((o,a)=>F.compareRangesUsingStarts(o.range,a.range));const n=[];let r=i[0];for(let o=1;o<i.length;o++)r.range.endLineNumber===i[o].range.startLineNumber&&r.range.endColumn===i[o].range.startColumn?(r.range=r.range.plusRange(i[o].range),r.text=r.text+i[o].text):(n.push(r),r=i[o]);n.push(r);for(const o of n)t.addEditOperation(o.range,o.text)}this._trackedEditorSelectionId=t.trackSelection(this._editorSelection)}computeCursorState(e,t){return t.getTrackedSelection(this._trackedEditorSelectionId)}}function ube(s,e){if(s&&s[0]!==""){const t=Zre(s,e,"-"),i=Zre(s,e,"_");return t&&!i?Jre(s,e,"-"):!t&&i?Jre(s,e,"_"):s[0].toUpperCase()===s[0]?e.toUpperCase():s[0].toLowerCase()===s[0]?e.toLowerCase():KRe(s[0][0])&&e.length>0?e[0].toUpperCase()+e.substr(1):s[0][0].toUpperCase()!==s[0][0]&&e.length>0?e[0].toLowerCase()+e.substr(1):e}else return e}function Zre(s,e,t){return s[0].indexOf(t)!==-1&&e.indexOf(t)!==-1&&s[0].split(t).length===e.split(t).length}function Jre(s,e,t){const i=e.split(t),n=s[0].split(t);let r="";return i.forEach((o,a)=>{r+=ube([n[a]],o)+t}),r.slice(0,-1)}class eoe{constructor(e){this.staticValue=e,this.kind=0}}class QYe{constructor(e){this.pieces=e,this.kind=1}}class j1{static fromStaticValue(e){return new j1([sv.staticValue(e)])}get hasReplacementPatterns(){return this._state.kind===1}constructor(e){!e||e.length===0?this._state=new eoe(""):e.length===1&&e[0].staticValue!==null?this._state=new eoe(e[0].staticValue):this._state=new QYe(e)}buildReplaceString(e,t){if(this._state.kind===0)return t?ube(e,this._state.staticValue):this._state.staticValue;let i="";for(let n=0,r=this._state.pieces.length;n<r;n++){const o=this._state.pieces[n];if(o.staticValue!==null){i+=o.staticValue;continue}let a=j1._substitute(o.matchIndex,e);if(o.caseOps!==null&&o.caseOps.length>0){const l=[],c=o.caseOps.length;let d=0;for(let u=0,h=a.length;u<h;u++){if(d>=c){l.push(a.slice(u));break}switch(o.caseOps[d]){case"U":l.push(a[u].toUpperCase());break;case"u":l.push(a[u].toUpperCase()),d++;break;case"L":l.push(a[u].toLowerCase());break;case"l":l.push(a[u].toLowerCase()),d++;break;default:l.push(a[u])}}a=l.join("")}i+=a}return i}static _substitute(e,t){if(t===null)return"";if(e===0)return t[0];let i="";for(;e>0;){if(e<t.length)return(t[e]||"")+i;i=String(e%10)+i,e=Math.floor(e/10)}return"$"+i}}class sv{static staticValue(e){return new sv(e,-1,null)}static caseOps(e,t){return new sv(null,e,t)}constructor(e,t,i){this.staticValue=e,this.matchIndex=t,!i||i.length===0?this.caseOps=null:this.caseOps=i.slice(0)}}class YYe{constructor(e){this._source=e,this._lastCharIndex=0,this._result=[],this._resultLen=0,this._currentStaticPiece=""}emitUnchanged(e){this._emitStatic(this._source.substring(this._lastCharIndex,e)),this._lastCharIndex=e}emitStatic(e,t){this._emitStatic(e),this._lastCharIndex=t}_emitStatic(e){e.length!==0&&(this._currentStaticPiece+=e)}emitMatchIndex(e,t,i){this._currentStaticPiece.length!==0&&(this._result[this._resultLen++]=sv.staticValue(this._currentStaticPiece),this._currentStaticPiece=""),this._result[this._resultLen++]=sv.caseOps(e,i),this._lastCharIndex=t}finalize(){return this.emitUnchanged(this._source.length),this._currentStaticPiece.length!==0&&(this._result[this._resultLen++]=sv.staticValue(this._currentStaticPiece),this._currentStaticPiece=""),new j1(this._result)}}function XYe(s){if(!s||s.length===0)return new j1(null);const e=[],t=new YYe(s);for(let i=0,n=s.length;i<n;i++){const r=s.charCodeAt(i);if(r===92){if(i++,i>=n)break;const o=s.charCodeAt(i);switch(o){case 92:t.emitUnchanged(i-1),t.emitStatic("\\",i+1);break;case 110:t.emitUnchanged(i-1),t.emitStatic(`
`,i+1);break;case 116:t.emitUnchanged(i-1),t.emitStatic("	",i+1);break;case 117:case 85:case 108:case 76:t.emitUnchanged(i-1),t.emitStatic("",i+1),e.push(String.fromCharCode(o));break}continue}if(r===36){if(i++,i>=n)break;const o=s.charCodeAt(i);if(o===36){t.emitUnchanged(i-1),t.emitStatic("$",i+1);continue}if(o===48||o===38){t.emitUnchanged(i-1),t.emitMatchIndex(0,i+1,e),e.length=0;continue}if(49<=o&&o<=57){let a=o-48;if(i+1<n){const l=s.charCodeAt(i+1);if(48<=l&&l<=57){i++,a=a*10+(l-48),t.emitUnchanged(i-2),t.emitMatchIndex(a,i+1,e),e.length=0;continue}}t.emitUnchanged(i-1),t.emitMatchIndex(a,i+1,e),e.length=0;continue}}}return t.finalize()}const Hg=new Oe("findWidgetVisible",!1);Hg.toNegated();const y5=new Oe("findInputFocussed",!1),IQ=new Oe("replaceInputFocussed",!1),zN={primary:545,mac:{primary:2593}},UN={primary:565,mac:{primary:2613}},jN={primary:560,mac:{primary:2608}},$N={primary:554,mac:{primary:2602}},qN={primary:558,mac:{primary:2606}},$i={StartFindAction:"actions.find",StartFindWithSelection:"actions.findWithSelection",StartFindWithArgs:"editor.actions.findWithArgs",NextMatchFindAction:"editor.action.nextMatchFindAction",PreviousMatchFindAction:"editor.action.previousMatchFindAction",GoToMatchFindAction:"editor.action.goToMatchFindAction",NextSelectionMatchFindAction:"editor.action.nextSelectionMatchFindAction",PreviousSelectionMatchFindAction:"editor.action.previousSelectionMatchFindAction",StartFindReplaceAction:"editor.action.startFindReplaceAction",CloseFindWidgetCommand:"closeFindWidget",ToggleCaseSensitiveCommand:"toggleFindCaseSensitive",ToggleWholeWordCommand:"toggleFindWholeWord",ToggleRegexCommand:"toggleFindRegex",ToggleSearchScopeCommand:"toggleFindInSelection",TogglePreserveCaseCommand:"togglePreserveCase",ReplaceOneAction:"editor.action.replaceOne",ReplaceAllAction:"editor.action.replaceAll",SelectAllMatchesAction:"editor.action.selectAllMatches"},Jp=19999,ZYe=240;class rk{constructor(e,t){this._toDispose=new ce,this._editor=e,this._state=t,this._isDisposed=!1,this._startSearchingTimer=new gd,this._decorations=new oU(e),this._toDispose.add(this._decorations),this._updateDecorationsScheduler=new xi(()=>{if(this._editor.hasModel())return this.research(!1)},100),this._toDispose.add(this._updateDecorationsScheduler),this._toDispose.add(this._editor.onDidChangeCursorPosition(i=>{(i.reason===3||i.reason===5||i.reason===6)&&this._decorations.setStartPosition(this._editor.getPosition())})),this._ignoreModelContentChanged=!1,this._toDispose.add(this._editor.onDidChangeModelContent(i=>{this._ignoreModelContentChanged||(i.isFlush&&this._decorations.reset(),this._decorations.setStartPosition(this._editor.getPosition()),this._updateDecorationsScheduler.schedule())})),this._toDispose.add(this._state.onFindReplaceStateChange(i=>this._onStateChanged(i))),this.research(!1,this._state.searchScope)}dispose(){this._isDisposed=!0,Ni(this._startSearchingTimer),this._toDispose.dispose()}_onStateChanged(e){this._isDisposed||this._editor.hasModel()&&(e.searchString||e.isReplaceRevealed||e.isRegex||e.wholeWord||e.matchCase||e.searchScope)&&(this._editor.getModel().isTooLargeForSyncing()?(this._startSearchingTimer.cancel(),this._startSearchingTimer.setIfNotSet(()=>{e.searchScope?this.research(e.moveCursor,this._state.searchScope):this.research(e.moveCursor)},ZYe)):e.searchScope?this.research(e.moveCursor,this._state.searchScope):this.research(e.moveCursor))}static _getSearchRange(e,t){return t||e.getFullModelRange()}research(e,t){let i=null;typeof t<"u"?t!==null&&(Array.isArray(t)?i=t:i=[t]):i=this._decorations.getFindScopes(),i!==null&&(i=i.map(a=>{if(a.startLineNumber!==a.endLineNumber){let l=a.endLineNumber;return a.endColumn===1&&(l=l-1),new F(a.startLineNumber,1,l,this._editor.getModel().getLineMaxColumn(l))}return a}));const n=this._findMatches(i,!1,Jp);this._decorations.set(n,i);const r=this._editor.getSelection();let o=this._decorations.getCurrentMatchesPosition(r);if(o===0&&n.length>0){const a=lI(n.map(l=>l.range),l=>F.compareRangesUsingStarts(l,r)>=0);o=a>0?a-1+1:o}this._state.changeMatchInfo(o,this._decorations.getCount(),void 0),e&&this._editor.getOption(41).cursorMoveOnType&&this._moveToNextMatch(this._decorations.getStartPosition())}_hasMatches(){return this._state.matchesCount>0}_cannotFind(){if(!this._hasMatches()){const e=this._decorations.getFindScope();return e&&this._editor.revealRangeInCenterIfOutsideViewport(e,0),!0}return!1}_setCurrentFindMatch(e){const t=this._decorations.setCurrentFindMatch(e);this._state.changeMatchInfo(t,this._decorations.getCount(),e),this._editor.setSelection(e),this._editor.revealRangeInCenterIfOutsideViewport(e,0)}_prevSearchPosition(e){const t=this._state.isRegex&&(this._state.searchString.indexOf("^")>=0||this._state.searchString.indexOf("$")>=0);let{lineNumber:i,column:n}=e;const r=this._editor.getModel();return t||n===1?(i===1?i=r.getLineCount():i--,n=r.getLineMaxColumn(i)):n--,new X(i,n)}_moveToPrevMatch(e,t=!1){if(!this._state.canNavigateBack()){const d=this._decorations.matchAfterPosition(e);d&&this._setCurrentFindMatch(d);return}if(this._decorations.getCount()<Jp){let d=this._decorations.matchBeforePosition(e);d&&d.isEmpty()&&d.getStartPosition().equals(e)&&(e=this._prevSearchPosition(e),d=this._decorations.matchBeforePosition(e)),d&&this._setCurrentFindMatch(d);return}if(this._cannotFind())return;const i=this._decorations.getFindScope(),n=rk._getSearchRange(this._editor.getModel(),i);n.getEndPosition().isBefore(e)&&(e=n.getEndPosition()),e.isBefore(n.getStartPosition())&&(e=n.getEndPosition());const{lineNumber:r,column:o}=e,a=this._editor.getModel();let l=new X(r,o),c=a.findPreviousMatch(this._state.searchString,l,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(132):null,!1);if(c&&c.range.isEmpty()&&c.range.getStartPosition().equals(l)&&(l=this._prevSearchPosition(l),c=a.findPreviousMatch(this._state.searchString,l,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(132):null,!1)),!!c){if(!t&&!n.containsRange(c.range))return this._moveToPrevMatch(c.range.getStartPosition(),!0);this._setCurrentFindMatch(c.range)}}moveToPrevMatch(){this._moveToPrevMatch(this._editor.getSelection().getStartPosition())}_nextSearchPosition(e){const t=this._state.isRegex&&(this._state.searchString.indexOf("^")>=0||this._state.searchString.indexOf("$")>=0);let{lineNumber:i,column:n}=e;const r=this._editor.getModel();return t||n===r.getLineMaxColumn(i)?(i===r.getLineCount()?i=1:i++,n=1):n++,new X(i,n)}_moveToNextMatch(e){if(!this._state.canNavigateForward()){const i=this._decorations.matchBeforePosition(e);i&&this._setCurrentFindMatch(i);return}if(this._decorations.getCount()<Jp){let i=this._decorations.matchAfterPosition(e);i&&i.isEmpty()&&i.getStartPosition().equals(e)&&(e=this._nextSearchPosition(e),i=this._decorations.matchAfterPosition(e)),i&&this._setCurrentFindMatch(i);return}const t=this._getNextMatch(e,!1,!0);t&&this._setCurrentFindMatch(t.range)}_getNextMatch(e,t,i,n=!1){if(this._cannotFind())return null;const r=this._decorations.getFindScope(),o=rk._getSearchRange(this._editor.getModel(),r);o.getEndPosition().isBefore(e)&&(e=o.getStartPosition()),e.isBefore(o.getStartPosition())&&(e=o.getStartPosition());const{lineNumber:a,column:l}=e,c=this._editor.getModel();let d=new X(a,l),u=c.findNextMatch(this._state.searchString,d,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(132):null,t);return i&&u&&u.range.isEmpty()&&u.range.getStartPosition().equals(d)&&(d=this._nextSearchPosition(d),u=c.findNextMatch(this._state.searchString,d,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(132):null,t)),u?!n&&!o.containsRange(u.range)?this._getNextMatch(u.range.getEndPosition(),t,i,!0):u:null}moveToNextMatch(){this._moveToNextMatch(this._editor.getSelection().getEndPosition())}_moveToMatch(e){const t=this._decorations.getDecorationRangeAt(e);t&&this._setCurrentFindMatch(t)}moveToMatch(e){this._moveToMatch(e)}_getReplacePattern(){return this._state.isRegex?XYe(this._state.replaceString):j1.fromStaticValue(this._state.replaceString)}replace(){if(!this._hasMatches())return;const e=this._getReplacePattern(),t=this._editor.getSelection(),i=this._getNextMatch(t.getStartPosition(),!0,!1);if(i)if(t.equalsRange(i.range)){const n=e.buildReplaceString(i.matches,this._state.preserveCase),r=new dr(t,n);this._executeEditorCommand("replace",r),this._decorations.setStartPosition(new X(t.startLineNumber,t.startColumn+n.length)),this.research(!0)}else this._decorations.setStartPosition(this._editor.getPosition()),this._setCurrentFindMatch(i.range)}_findMatches(e,t,i){const n=(e||[null]).map(r=>rk._getSearchRange(this._editor.getModel(),r));return this._editor.getModel().findMatches(this._state.searchString,n,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(132):null,t,i)}replaceAll(){if(!this._hasMatches())return;const e=this._decorations.getFindScopes();e===null&&this._state.matchesCount>=Jp?this._largeReplaceAll():this._regularReplaceAll(e),this.research(!1)}_largeReplaceAll(){const t=new ob(this._state.searchString,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(132):null).parseSearchRequest();if(!t)return;let i=t.regex;if(!i.multiline){let u="mu";i.ignoreCase&&(u+="i"),i.global&&(u+="g"),i=new RegExp(i.source,u)}const n=this._editor.getModel(),r=n.getValue(1),o=n.getFullModelRange(),a=this._getReplacePattern();let l;const c=this._state.preserveCase;a.hasReplacementPatterns||c?l=r.replace(i,function(){return a.buildReplaceString(arguments,c)}):l=r.replace(i,a.buildReplaceString(null,c));const d=new xG(o,l,this._editor.getSelection());this._executeEditorCommand("replaceAll",d)}_regularReplaceAll(e){const t=this._getReplacePattern(),i=this._findMatches(e,t.hasReplacementPatterns||this._state.preserveCase,1073741824),n=[];for(let o=0,a=i.length;o<a;o++)n[o]=t.buildReplaceString(i[o].matches,this._state.preserveCase);const r=new GYe(this._editor.getSelection(),i.map(o=>o.range),n);this._executeEditorCommand("replaceAll",r)}selectAllMatches(){if(!this._hasMatches())return;const e=this._decorations.getFindScopes();let i=this._findMatches(e,!1,1073741824).map(r=>new Ue(r.range.startLineNumber,r.range.startColumn,r.range.endLineNumber,r.range.endColumn));const n=this._editor.getSelection();for(let r=0,o=i.length;r<o;r++)if(i[r].equalsRange(n)){i=[n].concat(i.slice(0,r)).concat(i.slice(r+1));break}this._editor.setSelections(i)}_executeEditorCommand(e,t){try{this._ignoreModelContentChanged=!0,this._editor.pushUndoStop(),this._editor.executeCommand(e,t),this._editor.pushUndoStop()}finally{this._ignoreModelContentChanged=!1}}}const TO=class TO extends Vl{constructor(e,t,i){super(),this._hideSoon=this._register(new xi(()=>this._hide(),2e3)),this._isVisible=!1,this._editor=e,this._state=t,this._keybindingService=i,this._domNode=document.createElement("div"),this._domNode.className="findOptionsWidget",this._domNode.style.display="none",this._domNode.style.top="10px",this._domNode.style.zIndex="12",this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true");const n={inputActiveOptionBorder:Fe(kF),inputActiveOptionForeground:Fe(IF),inputActiveOptionBackground:Fe(GE)},r=this._register(k1());this.caseSensitive=this._register(new Qge({appendTitle:this._keybindingLabelFor($i.ToggleCaseSensitiveCommand),isChecked:this._state.matchCase,hoverDelegate:r,...n})),this._domNode.appendChild(this.caseSensitive.domNode),this._register(this.caseSensitive.onChange(()=>{this._state.change({matchCase:this.caseSensitive.checked},!1)})),this.wholeWords=this._register(new Yge({appendTitle:this._keybindingLabelFor($i.ToggleWholeWordCommand),isChecked:this._state.wholeWord,hoverDelegate:r,...n})),this._domNode.appendChild(this.wholeWords.domNode),this._register(this.wholeWords.onChange(()=>{this._state.change({wholeWord:this.wholeWords.checked},!1)})),this.regex=this._register(new Xge({appendTitle:this._keybindingLabelFor($i.ToggleRegexCommand),isChecked:this._state.isRegex,hoverDelegate:r,...n})),this._domNode.appendChild(this.regex.domNode),this._register(this.regex.onChange(()=>{this._state.change({isRegex:this.regex.checked},!1)})),this._editor.addOverlayWidget(this),this._register(this._state.onFindReplaceStateChange(o=>{let a=!1;o.isRegex&&(this.regex.checked=this._state.isRegex,a=!0),o.wholeWord&&(this.wholeWords.checked=this._state.wholeWord,a=!0),o.matchCase&&(this.caseSensitive.checked=this._state.matchCase,a=!0),!this._state.isRevealed&&a&&this._revealTemporarily()})),this._register(oe(this._domNode,Le.MOUSE_LEAVE,o=>this._onMouseLeave())),this._register(oe(this._domNode,"mouseover",o=>this._onMouseOver()))}_keybindingLabelFor(e){const t=this._keybindingService.lookupKeybinding(e);return t?` (${t.getLabel()})`:""}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}getId(){return TO.ID}getDomNode(){return this._domNode}getPosition(){return{preference:0}}highlightFindOptions(){this._revealTemporarily()}_revealTemporarily(){this._show(),this._hideSoon.schedule()}_onMouseLeave(){this._hideSoon.schedule()}_onMouseOver(){this._hideSoon.cancel()}_show(){this._isVisible||(this._isVisible=!0,this._domNode.style.display="block")}_hide(){this._isVisible&&(this._isVisible=!1,this._domNode.style.display="none")}};TO.ID="editor.contrib.findOptionsWidget";let aU=TO;function KN(s,e){return s===1?!0:s===2?!1:e}class JYe extends te{get searchString(){return this._searchString}get replaceString(){return this._replaceString}get isRevealed(){return this._isRevealed}get isReplaceRevealed(){return this._isReplaceRevealed}get isRegex(){return KN(this._isRegexOverride,this._isRegex)}get wholeWord(){return KN(this._wholeWordOverride,this._wholeWord)}get matchCase(){return KN(this._matchCaseOverride,this._matchCase)}get preserveCase(){return KN(this._preserveCaseOverride,this._preserveCase)}get actualIsRegex(){return this._isRegex}get actualWholeWord(){return this._wholeWord}get actualMatchCase(){return this._matchCase}get actualPreserveCase(){return this._preserveCase}get searchScope(){return this._searchScope}get matchesPosition(){return this._matchesPosition}get matchesCount(){return this._matchesCount}get currentMatch(){return this._currentMatch}constructor(){super(),this._onFindReplaceStateChange=this._register(new Z),this.onFindReplaceStateChange=this._onFindReplaceStateChange.event,this._searchString="",this._replaceString="",this._isRevealed=!1,this._isReplaceRevealed=!1,this._isRegex=!1,this._isRegexOverride=0,this._wholeWord=!1,this._wholeWordOverride=0,this._matchCase=!1,this._matchCaseOverride=0,this._preserveCase=!1,this._preserveCaseOverride=0,this._searchScope=null,this._matchesPosition=0,this._matchesCount=0,this._currentMatch=null,this._loop=!0,this._isSearching=!1,this._filters=null}changeMatchInfo(e,t,i){const n={moveCursor:!1,updateHistory:!1,searchString:!1,replaceString:!1,isRevealed:!1,isReplaceRevealed:!1,isRegex:!1,wholeWord:!1,matchCase:!1,preserveCase:!1,searchScope:!1,matchesPosition:!1,matchesCount:!1,currentMatch:!1,loop:!1,isSearching:!1,filters:!1};let r=!1;t===0&&(e=0),e>t&&(e=t),this._matchesPosition!==e&&(this._matchesPosition=e,n.matchesPosition=!0,r=!0),this._matchesCount!==t&&(this._matchesCount=t,n.matchesCount=!0,r=!0),typeof i<"u"&&(F.equalsRange(this._currentMatch,i)||(this._currentMatch=i,n.currentMatch=!0,r=!0)),r&&this._onFindReplaceStateChange.fire(n)}change(e,t,i=!0){var d;const n={moveCursor:t,updateHistory:i,searchString:!1,replaceString:!1,isRevealed:!1,isReplaceRevealed:!1,isRegex:!1,wholeWord:!1,matchCase:!1,preserveCase:!1,searchScope:!1,matchesPosition:!1,matchesCount:!1,currentMatch:!1,loop:!1,isSearching:!1,filters:!1};let r=!1;const o=this.isRegex,a=this.wholeWord,l=this.matchCase,c=this.preserveCase;typeof e.searchString<"u"&&this._searchString!==e.searchString&&(this._searchString=e.searchString,n.searchString=!0,r=!0),typeof e.replaceString<"u"&&this._replaceString!==e.replaceString&&(this._replaceString=e.replaceString,n.replaceString=!0,r=!0),typeof e.isRevealed<"u"&&this._isRevealed!==e.isRevealed&&(this._isRevealed=e.isRevealed,n.isRevealed=!0,r=!0),typeof e.isReplaceRevealed<"u"&&this._isReplaceRevealed!==e.isReplaceRevealed&&(this._isReplaceRevealed=e.isReplaceRevealed,n.isReplaceRevealed=!0,r=!0),typeof e.isRegex<"u"&&(this._isRegex=e.isRegex),typeof e.wholeWord<"u"&&(this._wholeWord=e.wholeWord),typeof e.matchCase<"u"&&(this._matchCase=e.matchCase),typeof e.preserveCase<"u"&&(this._preserveCase=e.preserveCase),typeof e.searchScope<"u"&&((d=e.searchScope)!=null&&d.every(u=>{var h;return(h=this._searchScope)==null?void 0:h.some(g=>!F.equalsRange(g,u))})||(this._searchScope=e.searchScope,n.searchScope=!0,r=!0)),typeof e.loop<"u"&&this._loop!==e.loop&&(this._loop=e.loop,n.loop=!0,r=!0),typeof e.isSearching<"u"&&this._isSearching!==e.isSearching&&(this._isSearching=e.isSearching,n.isSearching=!0,r=!0),typeof e.filters<"u"&&(this._filters?this._filters.update(e.filters):this._filters=e.filters,n.filters=!0,r=!0),this._isRegexOverride=typeof e.isRegexOverride<"u"?e.isRegexOverride:0,this._wholeWordOverride=typeof e.wholeWordOverride<"u"?e.wholeWordOverride:0,this._matchCaseOverride=typeof e.matchCaseOverride<"u"?e.matchCaseOverride:0,this._preserveCaseOverride=typeof e.preserveCaseOverride<"u"?e.preserveCaseOverride:0,o!==this.isRegex&&(r=!0,n.isRegex=!0),a!==this.wholeWord&&(r=!0,n.wholeWord=!0),l!==this.matchCase&&(r=!0,n.matchCase=!0),c!==this.preserveCase&&(r=!0,n.preserveCase=!0),r&&this._onFindReplaceStateChange.fire(n)}canNavigateBack(){return this.canNavigateInLoop()||this.matchesPosition!==1}canNavigateForward(){return this.canNavigateInLoop()||this.matchesPosition<this.matchesCount}canNavigateInLoop(){return this._loop||this.matchesCount>=Jp}}const eXe=b("defaultLabel","input"),tXe=b("label.preserveCaseToggle","Preserve Case");class iXe extends CS{constructor(e){super({icon:xe.preserveCase,title:tXe+e.appendTitle,isChecked:e.isChecked,hoverDelegate:e.hoverDelegate??No("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class nXe extends Vl{constructor(e,t,i,n){super(),this._showOptionButtons=i,this.fixFocusOnOptionClickEnabled=!0,this.cachedOptionsWidth=0,this._onDidOptionChange=this._register(new Z),this.onDidOptionChange=this._onDidOptionChange.event,this._onKeyDown=this._register(new Z),this.onKeyDown=this._onKeyDown.event,this._onMouseDown=this._register(new Z),this._onInput=this._register(new Z),this._onKeyUp=this._register(new Z),this._onPreserveCaseKeyDown=this._register(new Z),this.onPreserveCaseKeyDown=this._onPreserveCaseKeyDown.event,this.contextViewProvider=t,this.placeholder=n.placeholder||"",this.validation=n.validation,this.label=n.label||eXe;const r=n.appendPreserveCaseLabel||"",o=n.history||[],a=!!n.flexibleHeight,l=!!n.flexibleWidth,c=n.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new Zge(this.domNode,this.contextViewProvider,{ariaLabel:this.label||"",placeholder:this.placeholder||"",validationOptions:{validation:this.validation},history:o,showHistoryHint:n.showHistoryHint,flexibleHeight:a,flexibleWidth:l,flexibleMaxHeight:c,inputBoxStyles:n.inputBoxStyles})),this.preserveCase=this._register(new iXe({appendTitle:r,isChecked:!1,...n.toggleStyles})),this._register(this.preserveCase.onChange(h=>{this._onDidOptionChange.fire(h),!h&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.preserveCase.onKeyDown(h=>{this._onPreserveCaseKeyDown.fire(h)})),this._showOptionButtons?this.cachedOptionsWidth=this.preserveCase.width():this.cachedOptionsWidth=0;const d=[this.preserveCase.domNode];this.onkeydown(this.domNode,h=>{if(h.equals(15)||h.equals(17)||h.equals(9)){const g=d.indexOf(this.domNode.ownerDocument.activeElement);if(g>=0){let p=-1;h.equals(17)?p=(g+1)%d.length:h.equals(15)&&(g===0?p=d.length-1:p=g-1),h.equals(9)?(d[g].blur(),this.inputBox.focus()):p>=0&&d[p].focus(),jt.stop(h,!0)}}});const u=document.createElement("div");u.className="controls",u.style.display=this._showOptionButtons?"block":"none",u.appendChild(this.preserveCase.domNode),this.domNode.appendChild(u),e==null||e.appendChild(this.domNode),this.onkeydown(this.inputBox.inputElement,h=>this._onKeyDown.fire(h)),this.onkeyup(this.inputBox.inputElement,h=>this._onKeyUp.fire(h)),this.oninput(this.inputBox.inputElement,h=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,h=>this._onMouseDown.fire(h))}enable(){this.domNode.classList.remove("disabled"),this.inputBox.enable(),this.preserveCase.enable()}disable(){this.domNode.classList.add("disabled"),this.inputBox.disable(),this.preserveCase.disable()}setEnabled(e){e?this.enable():this.disable()}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getPreserveCase(){return this.preserveCase.checked}setPreserveCase(e){this.preserveCase.checked=e}focusOnPreserve(){this.preserveCase.focus()}validate(){var e;(e=this.inputBox)==null||e.validate()}set width(e){this.inputBox.paddingRight=this.cachedOptionsWidth,this.domNode.style.width=e+"px"}dispose(){super.dispose()}}var hbe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},fbe=function(s,e){return function(t,i){e(t,i,s)}};const EQ=new Oe("suggestWidgetVisible",!1,b("suggestWidgetVisible","Whether suggestion are visible")),DQ="historyNavigationWidgetFocus",gbe="historyNavigationForwardsEnabled",pbe="historyNavigationBackwardsEnabled";let hg;const GN=[];function mbe(s,e){if(GN.includes(e))throw new Error("Cannot register the same widget multiple times");GN.push(e);const t=new ce,i=new Oe(DQ,!1).bindTo(s),n=new Oe(gbe,!0).bindTo(s),r=new Oe(pbe,!0).bindTo(s),o=()=>{i.set(!0),hg=e},a=()=>{i.set(!1),hg===e&&(hg=void 0)};return rF(e.element)&&o(),t.add(e.onDidFocus(()=>o())),t.add(e.onDidBlur(()=>a())),t.add(Ye(()=>{GN.splice(GN.indexOf(e),1),a()})),{historyNavigationForwardsEnablement:n,historyNavigationBackwardsEnablement:r,dispose(){t.dispose()}}}let lU=class extends Jge{constructor(e,t,i,n){super(e,t,i);const r=this._register(n.createScoped(this.inputBox.element));this._register(mbe(r,this.inputBox))}};lU=hbe([fbe(3,ct)],lU);let cU=class extends nXe{constructor(e,t,i,n,r=!1){super(e,t,r,i);const o=this._register(n.createScoped(this.inputBox.element));this._register(mbe(o,this.inputBox))}};cU=hbe([fbe(3,ct)],cU);Io.registerCommandAndKeybindingRule({id:"history.showPrevious",weight:200,when:he.and(he.has(DQ),he.equals(pbe,!0),he.not("isComposing"),EQ.isEqualTo(!1)),primary:16,secondary:[528],handler:s=>{hg==null||hg.showPreviousValue()}});Io.registerCommandAndKeybindingRule({id:"history.showNext",weight:200,when:he.and(he.has(DQ),he.equals(gbe,!0),he.not("isComposing"),EQ.isEqualTo(!1)),primary:18,secondary:[530],handler:s=>{hg==null||hg.showNextValue()}});function toe(s){var e,t;return((e=s.lookupKeybinding("history.showPrevious"))==null?void 0:e.getElectronAccelerator())==="Up"&&((t=s.lookupKeybinding("history.showNext"))==null?void 0:t.getElectronAccelerator())==="Down"}const ioe=Qi("find-collapsed",xe.chevronRight,b("findCollapsedIcon","Icon to indicate that the editor find widget is collapsed.")),noe=Qi("find-expanded",xe.chevronDown,b("findExpandedIcon","Icon to indicate that the editor find widget is expanded.")),sXe=Qi("find-selection",xe.selection,b("findSelectionIcon","Icon for 'Find in Selection' in the editor find widget.")),rXe=Qi("find-replace",xe.replace,b("findReplaceIcon","Icon for 'Replace' in the editor find widget.")),oXe=Qi("find-replace-all",xe.replaceAll,b("findReplaceAllIcon","Icon for 'Replace All' in the editor find widget.")),aXe=Qi("find-previous-match",xe.arrowUp,b("findPreviousMatchIcon","Icon for 'Find Previous' in the editor find widget.")),lXe=Qi("find-next-match",xe.arrowDown,b("findNextMatchIcon","Icon for 'Find Next' in the editor find widget.")),cXe=b("label.findDialog","Find / Replace"),dXe=b("label.find","Find"),uXe=b("placeholder.find","Find"),hXe=b("label.previousMatchButton","Previous Match"),fXe=b("label.nextMatchButton","Next Match"),gXe=b("label.toggleSelectionFind","Find in Selection"),pXe=b("label.closeButton","Close"),mXe=b("label.replace","Replace"),_Xe=b("placeholder.replace","Replace"),bXe=b("label.replaceButton","Replace"),vXe=b("label.replaceAllButton","Replace All"),wXe=b("label.toggleReplaceButton","Toggle Replace"),CXe=b("title.matchesCountLimit","Only the first {0} results are highlighted, but all find operations work on the entire text.",Jp),yXe=b("label.matchesLocation","{0} of {1}"),soe=b("label.noResults","No results"),Hu=419,SXe=275,xXe=SXe-54;let Bx=69;const LXe=33,roe="ctrlEnterReplaceAll.windows.donotask",ooe=Wt?256:2048;class DB{constructor(e){this.afterLineNumber=e,this.heightInPx=LXe,this.suppressMouseDown=!1,this.domNode=document.createElement("div"),this.domNode.className="dock-find-viewzone"}}function aoe(s,e,t){const i=!!e.match(/\n/);if(t&&i&&t.selectionStart>0){s.stopPropagation();return}}function loe(s,e,t){const i=!!e.match(/\n/);if(t&&i&&t.selectionEnd<t.value.length){s.stopPropagation();return}}const NO=class NO extends Vl{constructor(e,t,i,n,r,o,a,l,c,d){super(),this._hoverService=d,this._cachedHeight=null,this._revealTimeouts=[],this._codeEditor=e,this._controller=t,this._state=i,this._contextViewProvider=n,this._keybindingService=r,this._contextKeyService=o,this._storageService=l,this._notificationService=c,this._ctrlEnterReplaceAllWarningPrompted=!!l.getBoolean(roe,0),this._isVisible=!1,this._isReplaceVisible=!1,this._ignoreChangeEvent=!1,this._updateHistoryDelayer=new bc(500),this._register(Ye(()=>this._updateHistoryDelayer.cancel())),this._register(this._state.onFindReplaceStateChange(u=>this._onStateChanged(u))),this._buildDomNode(),this._updateButtons(),this._tryUpdateWidgetWidth(),this._findInput.inputBox.layout(),this._register(this._codeEditor.onDidChangeConfiguration(u=>{if(u.hasChanged(92)&&(this._codeEditor.getOption(92)&&this._state.change({isReplaceRevealed:!1},!1),this._updateButtons()),u.hasChanged(146)&&this._tryUpdateWidgetWidth(),u.hasChanged(2)&&this.updateAccessibilitySupport(),u.hasChanged(41)){const h=this._codeEditor.getOption(41).loop;this._state.change({loop:h},!1);const g=this._codeEditor.getOption(41).addExtraSpaceOnTop;g&&!this._viewZone&&(this._viewZone=new DB(0),this._showViewZone()),!g&&this._viewZone&&this._removeViewZone()}})),this.updateAccessibilitySupport(),this._register(this._codeEditor.onDidChangeCursorSelection(()=>{this._isVisible&&this._updateToggleSelectionFindButton()})),this._register(this._codeEditor.onDidFocusEditorWidget(async()=>{if(this._isVisible){const u=await this._controller.getGlobalBufferTerm();u&&u!==this._state.searchString&&(this._state.change({searchString:u},!1),this._findInput.select())}})),this._findInputFocused=y5.bindTo(o),this._findFocusTracker=this._register(hu(this._findInput.inputBox.inputElement)),this._register(this._findFocusTracker.onDidFocus(()=>{this._findInputFocused.set(!0),this._updateSearchScope()})),this._register(this._findFocusTracker.onDidBlur(()=>{this._findInputFocused.set(!1)})),this._replaceInputFocused=IQ.bindTo(o),this._replaceFocusTracker=this._register(hu(this._replaceInput.inputBox.inputElement)),this._register(this._replaceFocusTracker.onDidFocus(()=>{this._replaceInputFocused.set(!0),this._updateSearchScope()})),this._register(this._replaceFocusTracker.onDidBlur(()=>{this._replaceInputFocused.set(!1)})),this._codeEditor.addOverlayWidget(this),this._codeEditor.getOption(41).addExtraSpaceOnTop&&(this._viewZone=new DB(0)),this._register(this._codeEditor.onDidChangeModel(()=>{this._isVisible&&(this._viewZoneId=void 0)})),this._register(this._codeEditor.onDidScrollChange(u=>{if(u.scrollTopChanged){this._layoutViewZone();return}setTimeout(()=>{this._layoutViewZone()},0)}))}getId(){return NO.ID}getDomNode(){return this._domNode}getPosition(){return this._isVisible?{preference:0}:null}_onStateChanged(e){if(e.searchString){try{this._ignoreChangeEvent=!0,this._findInput.setValue(this._state.searchString)}finally{this._ignoreChangeEvent=!1}this._updateButtons()}if(e.replaceString&&(this._replaceInput.inputBox.value=this._state.replaceString),e.isRevealed&&(this._state.isRevealed?this._reveal():this._hide(!0)),e.isReplaceRevealed&&(this._state.isReplaceRevealed?!this._codeEditor.getOption(92)&&!this._isReplaceVisible&&(this._isReplaceVisible=!0,this._replaceInput.width=ya(this._findInput.domNode),this._updateButtons(),this._replaceInput.inputBox.layout()):this._isReplaceVisible&&(this._isReplaceVisible=!1,this._updateButtons())),(e.isRevealed||e.isReplaceRevealed)&&(this._state.isRevealed||this._state.isReplaceRevealed)&&this._tryUpdateHeight()&&this._showViewZone(),e.isRegex&&this._findInput.setRegex(this._state.isRegex),e.wholeWord&&this._findInput.setWholeWords(this._state.wholeWord),e.matchCase&&this._findInput.setCaseSensitive(this._state.matchCase),e.preserveCase&&this._replaceInput.setPreserveCase(this._state.preserveCase),e.searchScope&&(this._state.searchScope?this._toggleSelectionFind.checked=!0:this._toggleSelectionFind.checked=!1,this._updateToggleSelectionFindButton()),e.searchString||e.matchesCount||e.matchesPosition){const t=this._state.searchString.length>0&&this._state.matchesCount===0;this._domNode.classList.toggle("no-results",t),this._updateMatchesCount(),this._updateButtons()}(e.searchString||e.currentMatch)&&this._layoutViewZone(),e.updateHistory&&this._delayedUpdateHistory(),e.loop&&this._updateButtons()}_delayedUpdateHistory(){this._updateHistoryDelayer.trigger(this._updateHistory.bind(this)).then(void 0,ft)}_updateHistory(){this._state.searchString&&this._findInput.inputBox.addToHistory(),this._state.replaceString&&this._replaceInput.inputBox.addToHistory()}_updateMatchesCount(){var t;this._matchesCount.style.minWidth=Bx+"px",this._state.matchesCount>=Jp?this._matchesCount.title=CXe:this._matchesCount.title="",(t=this._matchesCount.firstChild)==null||t.remove();let e;if(this._state.matchesCount>0){let i=String(this._state.matchesCount);this._state.matchesCount>=Jp&&(i+="+");let n=String(this._state.matchesPosition);n==="0"&&(n="?"),e=lw(yXe,n,i)}else e=soe;this._matchesCount.appendChild(document.createTextNode(e)),Eo(this._getAriaLabel(e,this._state.currentMatch,this._state.searchString)),Bx=Math.max(Bx,this._matchesCount.clientWidth)}_getAriaLabel(e,t,i){if(e===soe)return i===""?b("ariaSearchNoResultEmpty","{0} found",e):b("ariaSearchNoResult","{0} found for '{1}'",e,i);if(t){const n=b("ariaSearchNoResultWithLineNum","{0} found for '{1}', at {2}",e,i,t.startLineNumber+":"+t.startColumn),r=this._codeEditor.getModel();return r&&t.startLineNumber<=r.getLineCount()&&t.startLineNumber>=1?`${r.getLineContent(t.startLineNumber)}, ${n}`:n}return b("ariaSearchNoResultWithLineNumNoCurrentMatch","{0} found for '{1}'",e,i)}_updateToggleSelectionFindButton(){const e=this._codeEditor.getSelection(),t=e?e.startLineNumber!==e.endLineNumber||e.startColumn!==e.endColumn:!1,i=this._toggleSelectionFind.checked;this._isVisible&&(i||t)?this._toggleSelectionFind.enable():this._toggleSelectionFind.disable()}_updateButtons(){this._findInput.setEnabled(this._isVisible),this._replaceInput.setEnabled(this._isVisible&&this._isReplaceVisible),this._updateToggleSelectionFindButton(),this._closeBtn.setEnabled(this._isVisible);const e=this._state.searchString.length>0,t=!!this._state.matchesCount;this._prevBtn.setEnabled(this._isVisible&&e&&t&&this._state.canNavigateBack()),this._nextBtn.setEnabled(this._isVisible&&e&&t&&this._state.canNavigateForward()),this._replaceBtn.setEnabled(this._isVisible&&this._isReplaceVisible&&e),this._replaceAllBtn.setEnabled(this._isVisible&&this._isReplaceVisible&&e),this._domNode.classList.toggle("replaceToggled",this._isReplaceVisible),this._toggleReplaceBtn.setExpanded(this._isReplaceVisible);const i=!this._codeEditor.getOption(92);this._toggleReplaceBtn.setEnabled(this._isVisible&&i)}_reveal(){if(this._revealTimeouts.forEach(e=>{clearTimeout(e)}),this._revealTimeouts=[],!this._isVisible){this._isVisible=!0;const e=this._codeEditor.getSelection();switch(this._codeEditor.getOption(41).autoFindInSelection){case"always":this._toggleSelectionFind.checked=!0;break;case"never":this._toggleSelectionFind.checked=!1;break;case"multiline":{const i=!!e&&e.startLineNumber!==e.endLineNumber;this._toggleSelectionFind.checked=i;break}}this._tryUpdateWidgetWidth(),this._updateButtons(),this._revealTimeouts.push(setTimeout(()=>{this._domNode.classList.add("visible"),this._domNode.setAttribute("aria-hidden","false")},0)),this._revealTimeouts.push(setTimeout(()=>{this._findInput.validate()},200)),this._codeEditor.layoutOverlayWidget(this);let t=!0;if(this._codeEditor.getOption(41).seedSearchStringFromSelection&&e){const i=this._codeEditor.getDomNode();if(i){const n=Pn(i),r=this._codeEditor.getScrolledVisiblePosition(e.getStartPosition()),o=n.left+(r?r.left:0),a=r?r.top:0;if(this._viewZone&&a<this._viewZone.heightInPx){e.endLineNumber>e.startLineNumber&&(t=!1);const l=Zue(this._domNode).left;o>l&&(t=!1);const c=this._codeEditor.getScrolledVisiblePosition(e.getEndPosition());n.left+(c?c.left:0)>l&&(t=!1)}}}this._showViewZone(t)}}_hide(e){this._revealTimeouts.forEach(t=>{clearTimeout(t)}),this._revealTimeouts=[],this._isVisible&&(this._isVisible=!1,this._updateButtons(),this._domNode.classList.remove("visible"),this._domNode.setAttribute("aria-hidden","true"),this._findInput.clearMessage(),e&&this._codeEditor.focus(),this._codeEditor.layoutOverlayWidget(this),this._removeViewZone())}_layoutViewZone(e){if(!this._codeEditor.getOption(41).addExtraSpaceOnTop){this._removeViewZone();return}if(!this._isVisible)return;const i=this._viewZone;this._viewZoneId!==void 0||!i||this._codeEditor.changeViewZones(n=>{i.heightInPx=this._getHeight(),this._viewZoneId=n.addZone(i),this._codeEditor.setScrollTop(e||this._codeEditor.getScrollTop()+i.heightInPx)})}_showViewZone(e=!0){if(!this._isVisible||!this._codeEditor.getOption(41).addExtraSpaceOnTop)return;this._viewZone===void 0&&(this._viewZone=new DB(0));const i=this._viewZone;this._codeEditor.changeViewZones(n=>{if(this._viewZoneId!==void 0){const r=this._getHeight();if(r===i.heightInPx)return;const o=r-i.heightInPx;i.heightInPx=r,n.layoutZone(this._viewZoneId),e&&this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()+o);return}else{let r=this._getHeight();if(r-=this._codeEditor.getOption(84).top,r<=0)return;i.heightInPx=r,this._viewZoneId=n.addZone(i),e&&this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()+r)}})}_removeViewZone(){this._codeEditor.changeViewZones(e=>{this._viewZoneId!==void 0&&(e.removeZone(this._viewZoneId),this._viewZoneId=void 0,this._viewZone&&(this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()-this._viewZone.heightInPx),this._viewZone=void 0))})}_tryUpdateWidgetWidth(){if(!this._isVisible||!this._domNode.isConnected)return;const e=this._codeEditor.getLayoutInfo();if(e.contentWidth<=0){this._domNode.classList.add("hiddenEditor");return}else this._domNode.classList.contains("hiddenEditor")&&this._domNode.classList.remove("hiddenEditor");const i=e.width,n=e.minimap.minimapWidth;let r=!1,o=!1,a=!1;if(this._resized&&ya(this._domNode)>Hu){this._domNode.style.maxWidth=`${i-28-n-15}px`,this._replaceInput.width=ya(this._findInput.domNode);return}if(Hu+28+n>=i&&(o=!0),Hu+28+n-Bx>=i&&(a=!0),Hu+28+n-Bx>=i+50&&(r=!0),this._domNode.classList.toggle("collapsed-find-widget",r),this._domNode.classList.toggle("narrow-find-widget",a),this._domNode.classList.toggle("reduced-find-widget",o),!a&&!r&&(this._domNode.style.maxWidth=`${i-28-n-15}px`),this._findInput.layout({collapsedFindWidget:r,narrowFindWidget:a,reducedFindWidget:o}),this._resized){const l=this._findInput.inputBox.element.clientWidth;l>0&&(this._replaceInput.width=l)}else this._isReplaceVisible&&(this._replaceInput.width=ya(this._findInput.domNode))}_getHeight(){let e=0;return e+=4,e+=this._findInput.inputBox.height+2,this._isReplaceVisible&&(e+=4,e+=this._replaceInput.inputBox.height+2),e+=4,e}_tryUpdateHeight(){const e=this._getHeight();return this._cachedHeight!==null&&this._cachedHeight===e?!1:(this._cachedHeight=e,this._domNode.style.height=`${e}px`,!0)}focusFindInput(){this._findInput.select(),this._findInput.focus()}focusReplaceInput(){this._replaceInput.select(),this._replaceInput.focus()}highlightFindOptions(){this._findInput.highlightFindOptions()}_updateSearchScope(){if(this._codeEditor.hasModel()&&this._toggleSelectionFind.checked){const e=this._codeEditor.getSelections();e.map(t=>{t.endColumn===1&&t.endLineNumber>t.startLineNumber&&(t=t.setEndPosition(t.endLineNumber-1,this._codeEditor.getModel().getLineMaxColumn(t.endLineNumber-1)));const i=this._state.currentMatch;return t.startLineNumber!==t.endLineNumber&&!F.equalsRange(t,i)?t:null}).filter(t=>!!t),e.length&&this._state.change({searchScope:e},!0)}}_onFindInputMouseDown(e){e.middleButton&&e.stopPropagation()}_onFindInputKeyDown(e){if(e.equals(ooe|3))if(this._keybindingService.dispatchEvent(e,e.target)){e.preventDefault();return}else{this._findInput.inputBox.insertAtCursor(`
`),e.preventDefault();return}if(e.equals(2)){this._isReplaceVisible?this._replaceInput.focus():this._findInput.focusOnCaseSensitive(),e.preventDefault();return}if(e.equals(2066)){this._codeEditor.focus(),e.preventDefault();return}if(e.equals(16))return aoe(e,this._findInput.getValue(),this._findInput.domNode.querySelector("textarea"));if(e.equals(18))return loe(e,this._findInput.getValue(),this._findInput.domNode.querySelector("textarea"))}_onReplaceInputKeyDown(e){if(e.equals(ooe|3))if(this._keybindingService.dispatchEvent(e,e.target)){e.preventDefault();return}else{gr&&Th&&!this._ctrlEnterReplaceAllWarningPrompted&&(this._notificationService.info(b("ctrlEnter.keybindingChanged","Ctrl+Enter now inserts line break instead of replacing all. You can modify the keybinding for editor.action.replaceAll to override this behavior.")),this._ctrlEnterReplaceAllWarningPrompted=!0,this._storageService.store(roe,!0,0,0)),this._replaceInput.inputBox.insertAtCursor(`
`),e.preventDefault();return}if(e.equals(2)){this._findInput.focusOnCaseSensitive(),e.preventDefault();return}if(e.equals(1026)){this._findInput.focus(),e.preventDefault();return}if(e.equals(2066)){this._codeEditor.focus(),e.preventDefault();return}if(e.equals(16))return aoe(e,this._replaceInput.inputBox.value,this._replaceInput.inputBox.element.querySelector("textarea"));if(e.equals(18))return loe(e,this._replaceInput.inputBox.value,this._replaceInput.inputBox.element.querySelector("textarea"))}getVerticalSashLeft(e){return 0}_keybindingLabelFor(e){const t=this._keybindingService.lookupKeybinding(e);return t?` (${t.getLabel()})`:""}_buildDomNode(){this._findInput=this._register(new lU(null,this._contextViewProvider,{width:xXe,label:dXe,placeholder:uXe,appendCaseSensitiveLabel:this._keybindingLabelFor($i.ToggleCaseSensitiveCommand),appendWholeWordsLabel:this._keybindingLabelFor($i.ToggleWholeWordCommand),appendRegexLabel:this._keybindingLabelFor($i.ToggleRegexCommand),validation:d=>{if(d.length===0||!this._findInput.getRegex())return null;try{return new RegExp(d,"gu"),null}catch(u){return{content:u.message}}},flexibleHeight:!0,flexibleWidth:!0,flexibleMaxHeight:118,showCommonFindToggles:!0,showHistoryHint:()=>toe(this._keybindingService),inputBoxStyles:LA,toggleStyles:xA},this._contextKeyService)),this._findInput.setRegex(!!this._state.isRegex),this._findInput.setCaseSensitive(!!this._state.matchCase),this._findInput.setWholeWords(!!this._state.wholeWord),this._register(this._findInput.onKeyDown(d=>this._onFindInputKeyDown(d))),this._register(this._findInput.inputBox.onDidChange(()=>{this._ignoreChangeEvent||this._state.change({searchString:this._findInput.getValue()},!0)})),this._register(this._findInput.onDidOptionChange(()=>{this._state.change({isRegex:this._findInput.getRegex(),wholeWord:this._findInput.getWholeWords(),matchCase:this._findInput.getCaseSensitive()},!0)})),this._register(this._findInput.onCaseSensitiveKeyDown(d=>{d.equals(1026)&&this._isReplaceVisible&&(this._replaceInput.focus(),d.preventDefault())})),this._register(this._findInput.onRegexKeyDown(d=>{d.equals(2)&&this._isReplaceVisible&&(this._replaceInput.focusOnPreserve(),d.preventDefault())})),this._register(this._findInput.inputBox.onDidHeightChange(d=>{this._tryUpdateHeight()&&this._showViewZone()})),Lo&&this._register(this._findInput.onMouseDown(d=>this._onFindInputMouseDown(d))),this._matchesCount=document.createElement("div"),this._matchesCount.className="matchesCount",this._updateMatchesCount();const i=this._register(k1());this._prevBtn=this._register(new iC({label:hXe+this._keybindingLabelFor($i.PreviousMatchFindAction),icon:aXe,hoverDelegate:i,onTrigger:()=>{Hp(this._codeEditor.getAction($i.PreviousMatchFindAction)).run().then(void 0,ft)}},this._hoverService)),this._nextBtn=this._register(new iC({label:fXe+this._keybindingLabelFor($i.NextMatchFindAction),icon:lXe,hoverDelegate:i,onTrigger:()=>{Hp(this._codeEditor.getAction($i.NextMatchFindAction)).run().then(void 0,ft)}},this._hoverService));const n=document.createElement("div");n.className="find-part",n.appendChild(this._findInput.domNode);const r=document.createElement("div");r.className="find-actions",n.appendChild(r),r.appendChild(this._matchesCount),r.appendChild(this._prevBtn.domNode),r.appendChild(this._nextBtn.domNode),this._toggleSelectionFind=this._register(new CS({icon:sXe,title:gXe+this._keybindingLabelFor($i.ToggleSearchScopeCommand),isChecked:!1,hoverDelegate:i,inputActiveOptionBackground:Fe(GE),inputActiveOptionBorder:Fe(kF),inputActiveOptionForeground:Fe(IF)})),this._register(this._toggleSelectionFind.onChange(()=>{if(this._toggleSelectionFind.checked){if(this._codeEditor.hasModel()){let d=this._codeEditor.getSelections();d=d.map(u=>(u.endColumn===1&&u.endLineNumber>u.startLineNumber&&(u=u.setEndPosition(u.endLineNumber-1,this._codeEditor.getModel().getLineMaxColumn(u.endLineNumber-1))),u.isEmpty()?null:u)).filter(u=>!!u),d.length&&this._state.change({searchScope:d},!0)}}else this._state.change({searchScope:null},!0)})),r.appendChild(this._toggleSelectionFind.domNode),this._closeBtn=this._register(new iC({label:pXe+this._keybindingLabelFor($i.CloseFindWidgetCommand),icon:Dpe,hoverDelegate:i,onTrigger:()=>{this._state.change({isRevealed:!1,searchScope:null},!1)},onKeyDown:d=>{d.equals(2)&&this._isReplaceVisible&&(this._replaceBtn.isEnabled()?this._replaceBtn.focus():this._codeEditor.focus(),d.preventDefault())}},this._hoverService)),this._replaceInput=this._register(new cU(null,void 0,{label:mXe,placeholder:_Xe,appendPreserveCaseLabel:this._keybindingLabelFor($i.TogglePreserveCaseCommand),history:[],flexibleHeight:!0,flexibleWidth:!0,flexibleMaxHeight:118,showHistoryHint:()=>toe(this._keybindingService),inputBoxStyles:LA,toggleStyles:xA},this._contextKeyService,!0)),this._replaceInput.setPreserveCase(!!this._state.preserveCase),this._register(this._replaceInput.onKeyDown(d=>this._onReplaceInputKeyDown(d))),this._register(this._replaceInput.inputBox.onDidChange(()=>{this._state.change({replaceString:this._replaceInput.inputBox.value},!1)})),this._register(this._replaceInput.inputBox.onDidHeightChange(d=>{this._isReplaceVisible&&this._tryUpdateHeight()&&this._showViewZone()})),this._register(this._replaceInput.onDidOptionChange(()=>{this._state.change({preserveCase:this._replaceInput.getPreserveCase()},!0)})),this._register(this._replaceInput.onPreserveCaseKeyDown(d=>{d.equals(2)&&(this._prevBtn.isEnabled()?this._prevBtn.focus():this._nextBtn.isEnabled()?this._nextBtn.focus():this._toggleSelectionFind.enabled?this._toggleSelectionFind.focus():this._closeBtn.isEnabled()&&this._closeBtn.focus(),d.preventDefault())}));const o=this._register(k1());this._replaceBtn=this._register(new iC({label:bXe+this._keybindingLabelFor($i.ReplaceOneAction),icon:rXe,hoverDelegate:o,onTrigger:()=>{this._controller.replace()},onKeyDown:d=>{d.equals(1026)&&(this._closeBtn.focus(),d.preventDefault())}},this._hoverService)),this._replaceAllBtn=this._register(new iC({label:vXe+this._keybindingLabelFor($i.ReplaceAllAction),icon:oXe,hoverDelegate:o,onTrigger:()=>{this._controller.replaceAll()}},this._hoverService));const a=document.createElement("div");a.className="replace-part",a.appendChild(this._replaceInput.domNode);const l=document.createElement("div");l.className="replace-actions",a.appendChild(l),l.appendChild(this._replaceBtn.domNode),l.appendChild(this._replaceAllBtn.domNode),this._toggleReplaceBtn=this._register(new iC({label:wXe,className:"codicon toggle left",onTrigger:()=>{this._state.change({isReplaceRevealed:!this._isReplaceVisible},!1),this._isReplaceVisible&&(this._replaceInput.width=ya(this._findInput.domNode),this._replaceInput.inputBox.layout()),this._showViewZone()}},this._hoverService)),this._toggleReplaceBtn.setExpanded(this._isReplaceVisible),this._domNode=document.createElement("div"),this._domNode.className="editor-widget find-widget",this._domNode.setAttribute("aria-hidden","true"),this._domNode.ariaLabel=cXe,this._domNode.role="dialog",this._domNode.style.width=`${Hu}px`,this._domNode.appendChild(this._toggleReplaceBtn.domNode),this._domNode.appendChild(n),this._domNode.appendChild(this._closeBtn.domNode),this._domNode.appendChild(a),this._resizeSash=this._register(new Sr(this._domNode,this,{orientation:0,size:2})),this._resized=!1;let c=Hu;this._register(this._resizeSash.onDidStart(()=>{c=ya(this._domNode)})),this._register(this._resizeSash.onDidChange(d=>{this._resized=!0;const u=c+d.startX-d.currentX;if(u<Hu)return;const h=parseFloat(sF(this._domNode).maxWidth)||0;u>h||(this._domNode.style.width=`${u}px`,this._isReplaceVisible&&(this._replaceInput.width=ya(this._findInput.domNode)),this._findInput.inputBox.layout(),this._tryUpdateHeight())})),this._register(this._resizeSash.onDidReset(()=>{const d=ya(this._domNode);if(d<Hu)return;let u=Hu;if(!this._resized||d===Hu){const h=this._codeEditor.getLayoutInfo();u=h.width-28-h.minimap.minimapWidth-15,this._resized=!0}this._domNode.style.width=`${u}px`,this._isReplaceVisible&&(this._replaceInput.width=ya(this._findInput.domNode)),this._findInput.inputBox.layout()}))}updateAccessibilitySupport(){const e=this._codeEditor.getOption(2);this._findInput.setFocusInputOnOptionClick(e!==2)}};NO.ID="editor.contrib.findWidget";let dU=NO;class iC extends Vl{constructor(e,t){super(),this._opts=e;let i="button";this._opts.className&&(i=i+" "+this._opts.className),this._opts.icon&&(i=i+" "+at.asClassName(this._opts.icon)),this._domNode=document.createElement("div"),this._domNode.tabIndex=0,this._domNode.className=i,this._domNode.setAttribute("role","button"),this._domNode.setAttribute("aria-label",this._opts.label),this._register(t.setupManagedHover(e.hoverDelegate??No("element"),this._domNode,this._opts.label)),this.onclick(this._domNode,n=>{this._opts.onTrigger(),n.preventDefault()}),this.onkeydown(this._domNode,n=>{var r,o;if(n.equals(10)||n.equals(3)){this._opts.onTrigger(),n.preventDefault();return}(o=(r=this._opts).onKeyDown)==null||o.call(r,n)})}get domNode(){return this._domNode}isEnabled(){return this._domNode.tabIndex>=0}focus(){this._domNode.focus()}setEnabled(e){this._domNode.classList.toggle("disabled",!e),this._domNode.setAttribute("aria-disabled",String(!e)),this._domNode.tabIndex=e?0:-1}setExpanded(e){this._domNode.setAttribute("aria-expanded",String(!!e)),e?(this._domNode.classList.remove(...at.asClassNameArray(ioe)),this._domNode.classList.add(...at.asClassNameArray(noe))):(this._domNode.classList.remove(...at.asClassNameArray(noe)),this._domNode.classList.add(...at.asClassNameArray(ioe)))}}Lc((s,e)=>{const t=s.getColor(jp);t&&e.addRule(`.monaco-editor .findMatch { border: 1px ${su(s.type)?"dotted":"solid"} ${t}; box-sizing: border-box; }`);const i=s.getColor(ZOe);i&&e.addRule(`.monaco-editor .findScope { border: 1px ${su(s.type)?"dashed":"solid"} ${i}; }`);const n=s.getColor(Xt);n&&e.addRule(`.monaco-editor .find-widget { border: 1px solid ${n}; }`);const r=s.getColor(YOe);r&&e.addRule(`.monaco-editor .findMatchInline { color: ${r}; }`);const o=s.getColor(XOe);o&&e.addRule(`.monaco-editor .currentFindMatchInline { color: ${o}; }`)});var _be=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},tc=function(s,e){return function(t,i){e(t,i,s)}},uU;const kXe=524288;function hU(s,e="single",t=!1){if(!s.hasModel())return null;const i=s.getSelection();if(e==="single"&&i.startLineNumber===i.endLineNumber||e==="multiple"){if(i.isEmpty()){const n=s.getConfiguredWordAtPosition(i.getStartPosition());if(n&&t===!1)return n.word}else if(s.getModel().getValueLengthInRange(i)<kXe)return s.getModel().getValueInRange(i)}return null}var Av;let ra=(Av=class extends te{get editor(){return this._editor}static get(e){return e.getContribution(uU.ID)}constructor(e,t,i,n,r,o){super(),this._editor=e,this._findWidgetVisible=Hg.bindTo(t),this._contextKeyService=t,this._storageService=i,this._clipboardService=n,this._notificationService=r,this._hoverService=o,this._updateHistoryDelayer=new bc(500),this._state=this._register(new JYe),this.loadQueryState(),this._register(this._state.onFindReplaceStateChange(a=>this._onStateChanged(a))),this._model=null,this._register(this._editor.onDidChangeModel(()=>{const a=this._editor.getModel()&&this._state.isRevealed;this.disposeModel(),this._state.change({searchScope:null,matchCase:this._storageService.getBoolean("editor.matchCase",1,!1),wholeWord:this._storageService.getBoolean("editor.wholeWord",1,!1),isRegex:this._storageService.getBoolean("editor.isRegex",1,!1),preserveCase:this._storageService.getBoolean("editor.preserveCase",1,!1)},!1),a&&this._start({forceRevealReplace:!1,seedSearchStringFromSelection:"none",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!1,updateSearchScope:!1,loop:this._editor.getOption(41).loop})}))}dispose(){this.disposeModel(),super.dispose()}disposeModel(){this._model&&(this._model.dispose(),this._model=null)}_onStateChanged(e){this.saveQueryState(e),e.isRevealed&&(this._state.isRevealed?this._findWidgetVisible.set(!0):(this._findWidgetVisible.reset(),this.disposeModel())),e.searchString&&this.setGlobalBufferTerm(this._state.searchString)}saveQueryState(e){e.isRegex&&this._storageService.store("editor.isRegex",this._state.actualIsRegex,1,1),e.wholeWord&&this._storageService.store("editor.wholeWord",this._state.actualWholeWord,1,1),e.matchCase&&this._storageService.store("editor.matchCase",this._state.actualMatchCase,1,1),e.preserveCase&&this._storageService.store("editor.preserveCase",this._state.actualPreserveCase,1,1)}loadQueryState(){this._state.change({matchCase:this._storageService.getBoolean("editor.matchCase",1,this._state.matchCase),wholeWord:this._storageService.getBoolean("editor.wholeWord",1,this._state.wholeWord),isRegex:this._storageService.getBoolean("editor.isRegex",1,this._state.isRegex),preserveCase:this._storageService.getBoolean("editor.preserveCase",1,this._state.preserveCase)},!1)}isFindInputFocused(){return!!y5.getValue(this._contextKeyService)}getState(){return this._state}closeFindWidget(){this._state.change({isRevealed:!1,searchScope:null},!1),this._editor.focus()}toggleCaseSensitive(){this._state.change({matchCase:!this._state.matchCase},!1),this._state.isRevealed||this.highlightFindOptions()}toggleWholeWords(){this._state.change({wholeWord:!this._state.wholeWord},!1),this._state.isRevealed||this.highlightFindOptions()}toggleRegex(){this._state.change({isRegex:!this._state.isRegex},!1),this._state.isRevealed||this.highlightFindOptions()}togglePreserveCase(){this._state.change({preserveCase:!this._state.preserveCase},!1),this._state.isRevealed||this.highlightFindOptions()}toggleSearchScope(){if(this._state.searchScope)this._state.change({searchScope:null},!0);else if(this._editor.hasModel()){let e=this._editor.getSelections();e=e.map(t=>(t.endColumn===1&&t.endLineNumber>t.startLineNumber&&(t=t.setEndPosition(t.endLineNumber-1,this._editor.getModel().getLineMaxColumn(t.endLineNumber-1))),t.isEmpty()?null:t)).filter(t=>!!t),e.length&&this._state.change({searchScope:e},!0)}}setSearchString(e){this._state.isRegex&&(e=Nl(e)),this._state.change({searchString:e},!1)}highlightFindOptions(e=!1){}async _start(e,t){if(this.disposeModel(),!this._editor.hasModel())return;const i={...t,isRevealed:!0};if(e.seedSearchStringFromSelection==="single"){const n=hU(this._editor,e.seedSearchStringFromSelection,e.seedSearchStringFromNonEmptySelection);n&&(this._state.isRegex?i.searchString=Nl(n):i.searchString=n)}else if(e.seedSearchStringFromSelection==="multiple"&&!e.updateSearchScope){const n=hU(this._editor,e.seedSearchStringFromSelection);n&&(i.searchString=n)}if(!i.searchString&&e.seedSearchStringFromGlobalClipboard){const n=await this.getGlobalBufferTerm();if(!this._editor.hasModel())return;n&&(i.searchString=n)}if(e.forceRevealReplace||i.isReplaceRevealed?i.isReplaceRevealed=!0:this._findWidgetVisible.get()||(i.isReplaceRevealed=!1),e.updateSearchScope){const n=this._editor.getSelections();n.some(r=>!r.isEmpty())&&(i.searchScope=n)}i.loop=e.loop,this._state.change(i,!1),this._model||(this._model=new rk(this._editor,this._state))}start(e,t){return this._start(e,t)}moveToNextMatch(){return this._model?(this._model.moveToNextMatch(),!0):!1}moveToPrevMatch(){return this._model?(this._model.moveToPrevMatch(),!0):!1}goToMatch(e){return this._model?(this._model.moveToMatch(e),!0):!1}replace(){return this._model?(this._model.replace(),!0):!1}replaceAll(){var e;return this._model?(e=this._editor.getModel())!=null&&e.isTooLargeForHeapOperation()?(this._notificationService.warn(b("too.large.for.replaceall","The file is too large to perform a replace all operation.")),!1):(this._model.replaceAll(),!0):!1}selectAllMatches(){return this._model?(this._model.selectAllMatches(),this._editor.focus(),!0):!1}async getGlobalBufferTerm(){return this._editor.getOption(41).globalFindClipboard&&this._editor.hasModel()&&!this._editor.getModel().isTooLargeForSyncing()?this._clipboardService.readFindText():""}setGlobalBufferTerm(e){this._editor.getOption(41).globalFindClipboard&&this._editor.hasModel()&&!this._editor.getModel().isTooLargeForSyncing()&&this._clipboardService.writeFindText(e)}},uU=Av,Av.ID="editor.contrib.findController",Av);ra=uU=_be([tc(1,ct),tc(2,md),tc(3,Wg),tc(4,jn),tc(5,Kh)],ra);let fU=class extends ra{constructor(e,t,i,n,r,o,a,l,c){super(e,i,a,l,o,c),this._contextViewService=t,this._keybindingService=n,this._themeService=r,this._widget=null,this._findOptionsWidget=null}async _start(e,t){this._widget||this._createFindWidget();const i=this._editor.getSelection();let n=!1;switch(this._editor.getOption(41).autoFindInSelection){case"always":n=!0;break;case"never":n=!1;break;case"multiline":{n=!!i&&i.startLineNumber!==i.endLineNumber;break}}e.updateSearchScope=e.updateSearchScope||n,await super._start(e,t),this._widget&&(e.shouldFocus===2?this._widget.focusReplaceInput():e.shouldFocus===1&&this._widget.focusFindInput())}highlightFindOptions(e=!1){this._widget||this._createFindWidget(),this._state.isRevealed&&!e?this._widget.highlightFindOptions():this._findOptionsWidget.highlightFindOptions()}_createFindWidget(){this._widget=this._register(new dU(this._editor,this,this._state,this._contextViewService,this._keybindingService,this._contextKeyService,this._themeService,this._storageService,this._notificationService,this._hoverService)),this._findOptionsWidget=this._register(new aU(this._editor,this._state,this._keybindingService))}};fU=_be([tc(1,Fg),tc(2,ct),tc(3,pi),tc(4,gs),tc(5,jn),tc(6,md),tc(7,Wg),tc(8,Kh)],fU);const IXe=phe(new ghe({id:$i.StartFindAction,label:b("startFindAction","Find"),alias:"Find",precondition:he.or(z.focus,he.has("editorIsOpen")),kbOpts:{kbExpr:null,primary:2084,weight:100},menuOpts:{menuId:ze.MenubarEditMenu,group:"3_find",title:b({key:"miFind",comment:["&& denotes a mnemonic"]},"&&Find"),order:1}}));IXe.addImplementation(0,(s,e,t)=>{const i=ra.get(e);return i?i.start({forceRevealReplace:!1,seedSearchStringFromSelection:e.getOption(41).seedSearchStringFromSelection!=="never"?"single":"none",seedSearchStringFromNonEmptySelection:e.getOption(41).seedSearchStringFromSelection==="selection",seedSearchStringFromGlobalClipboard:e.getOption(41).globalFindClipboard,shouldFocus:1,shouldAnimate:!0,updateSearchScope:!1,loop:e.getOption(41).loop}):!1});const EXe={description:"Open a new In-Editor Find Widget.",args:[{name:"Open a new In-Editor Find Widget args",schema:{properties:{searchString:{type:"string"},replaceString:{type:"string"},isRegex:{type:"boolean"},matchWholeWord:{type:"boolean"},isCaseSensitive:{type:"boolean"},preserveCase:{type:"boolean"},findInSelection:{type:"boolean"}}}}]};class DXe extends Ve{constructor(){super({id:$i.StartFindWithArgs,label:b("startFindWithArgsAction","Find With Arguments"),alias:"Find With Arguments",precondition:void 0,kbOpts:{kbExpr:null,primary:0,weight:100},metadata:EXe})}async run(e,t,i){const n=ra.get(t);if(n){const r=i?{searchString:i.searchString,replaceString:i.replaceString,isReplaceRevealed:i.replaceString!==void 0,isRegex:i.isRegex,wholeWord:i.matchWholeWord,matchCase:i.isCaseSensitive,preserveCase:i.preserveCase}:{};await n.start({forceRevealReplace:!1,seedSearchStringFromSelection:n.getState().searchString.length===0&&t.getOption(41).seedSearchStringFromSelection!=="never"?"single":"none",seedSearchStringFromNonEmptySelection:t.getOption(41).seedSearchStringFromSelection==="selection",seedSearchStringFromGlobalClipboard:!0,shouldFocus:1,shouldAnimate:!0,updateSearchScope:(i==null?void 0:i.findInSelection)||!1,loop:t.getOption(41).loop},r),n.setGlobalBufferTerm(n.getState().searchString)}}}class TXe extends Ve{constructor(){super({id:$i.StartFindWithSelection,label:b("startFindWithSelectionAction","Find With Selection"),alias:"Find With Selection",precondition:void 0,kbOpts:{kbExpr:null,primary:0,mac:{primary:2083},weight:100}})}async run(e,t){const i=ra.get(t);i&&(await i.start({forceRevealReplace:!1,seedSearchStringFromSelection:"multiple",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(41).loop}),i.setGlobalBufferTerm(i.getState().searchString))}}class bbe extends Ve{async run(e,t){const i=ra.get(t);i&&!this._run(i)&&(await i.start({forceRevealReplace:!1,seedSearchStringFromSelection:i.getState().searchString.length===0&&t.getOption(41).seedSearchStringFromSelection!=="never"?"single":"none",seedSearchStringFromNonEmptySelection:t.getOption(41).seedSearchStringFromSelection==="selection",seedSearchStringFromGlobalClipboard:!0,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(41).loop}),this._run(i))}}class NXe extends bbe{constructor(){super({id:$i.NextMatchFindAction,label:b("findNextMatchAction","Find Next"),alias:"Find Next",precondition:void 0,kbOpts:[{kbExpr:z.focus,primary:61,mac:{primary:2085,secondary:[61]},weight:100},{kbExpr:he.and(z.focus,y5),primary:3,weight:100}]})}_run(e){return e.moveToNextMatch()?(e.editor.pushUndoStop(),!0):!1}}class RXe extends bbe{constructor(){super({id:$i.PreviousMatchFindAction,label:b("findPreviousMatchAction","Find Previous"),alias:"Find Previous",precondition:void 0,kbOpts:[{kbExpr:z.focus,primary:1085,mac:{primary:3109,secondary:[1085]},weight:100},{kbExpr:he.and(z.focus,y5),primary:1027,weight:100}]})}_run(e){return e.moveToPrevMatch()}}class AXe extends Ve{constructor(){super({id:$i.GoToMatchFindAction,label:b("findMatchAction.goToMatch","Go to Match..."),alias:"Go to Match...",precondition:Hg}),this._highlightDecorations=[]}run(e,t,i){const n=ra.get(t);if(!n)return;const r=n.getState().matchesCount;if(r<1){e.get(jn).notify({severity:wF.Warning,message:b("findMatchAction.noResults","No matches. Try searching for something else.")});return}const o=e.get(kc),a=new ce,l=a.add(o.createInputBox());l.placeholder=b("findMatchAction.inputPlaceHolder","Type a number to go to a specific match (between 1 and {0})",r);const c=u=>{const h=parseInt(u);if(isNaN(h))return;const g=n.getState().matchesCount;if(h>0&&h<=g)return h-1;if(h<0&&h>=-g)return g+h},d=u=>{const h=c(u);if(typeof h=="number"){l.validationMessage=void 0,n.goToMatch(h);const g=n.getState().currentMatch;g&&this.addDecorations(t,g)}else l.validationMessage=b("findMatchAction.inputValidationMessage","Please type a number between 1 and {0}",n.getState().matchesCount),this.clearDecorations(t)};a.add(l.onDidChangeValue(u=>{d(u)})),a.add(l.onDidAccept(()=>{const u=c(l.value);typeof u=="number"?(n.goToMatch(u),l.hide()):l.validationMessage=b("findMatchAction.inputValidationMessage","Please type a number between 1 and {0}",n.getState().matchesCount)})),a.add(l.onDidHide(()=>{this.clearDecorations(t),a.dispose()})),l.show()}clearDecorations(e){e.changeDecorations(t=>{this._highlightDecorations=t.deltaDecorations(this._highlightDecorations,[])})}addDecorations(e,t){e.changeDecorations(i=>{this._highlightDecorations=i.deltaDecorations(this._highlightDecorations,[{range:t,options:{description:"find-match-quick-access-range-highlight",className:"rangeHighlight",isWholeLine:!0}},{range:t,options:{description:"find-match-quick-access-range-highlight-overview",overviewRuler:{color:kn(mge),position:Il.Full}}}])})}}class vbe extends Ve{async run(e,t){const i=ra.get(t);if(!i)return;const n=hU(t,"single",!1);n&&i.setSearchString(n),this._run(i)||(await i.start({forceRevealReplace:!1,seedSearchStringFromSelection:"none",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(41).loop}),this._run(i))}}class PXe extends vbe{constructor(){super({id:$i.NextSelectionMatchFindAction,label:b("nextSelectionMatchFindAction","Find Next Selection"),alias:"Find Next Selection",precondition:void 0,kbOpts:{kbExpr:z.focus,primary:2109,weight:100}})}_run(e){return e.moveToNextMatch()}}class MXe extends vbe{constructor(){super({id:$i.PreviousSelectionMatchFindAction,label:b("previousSelectionMatchFindAction","Find Previous Selection"),alias:"Find Previous Selection",precondition:void 0,kbOpts:{kbExpr:z.focus,primary:3133,weight:100}})}_run(e){return e.moveToPrevMatch()}}const OXe=phe(new ghe({id:$i.StartFindReplaceAction,label:b("startReplace","Replace"),alias:"Replace",precondition:he.or(z.focus,he.has("editorIsOpen")),kbOpts:{kbExpr:null,primary:2086,mac:{primary:2596},weight:100},menuOpts:{menuId:ze.MenubarEditMenu,group:"3_find",title:b({key:"miReplace",comment:["&& denotes a mnemonic"]},"&&Replace"),order:2}}));OXe.addImplementation(0,(s,e,t)=>{if(!e.hasModel()||e.getOption(92))return!1;const i=ra.get(e);if(!i)return!1;const n=e.getSelection(),r=i.isFindInputFocused(),o=!n.isEmpty()&&n.startLineNumber===n.endLineNumber&&e.getOption(41).seedSearchStringFromSelection!=="never"&&!r,a=r||o?2:1;return i.start({forceRevealReplace:!0,seedSearchStringFromSelection:o?"single":"none",seedSearchStringFromNonEmptySelection:e.getOption(41).seedSearchStringFromSelection==="selection",seedSearchStringFromGlobalClipboard:e.getOption(41).seedSearchStringFromSelection!=="never",shouldFocus:a,shouldAnimate:!0,updateSearchScope:!1,loop:e.getOption(41).loop})});Zt(ra.ID,fU,0);ye(DXe);ye(TXe);ye(NXe);ye(RXe);ye(AXe);ye(PXe);ye(MXe);const yu=fs.bindToContribution(ra.get);Me(new yu({id:$i.CloseFindWidgetCommand,precondition:Hg,handler:s=>s.closeFindWidget(),kbOpts:{weight:105,kbExpr:he.and(z.focus,he.not("isComposing")),primary:9,secondary:[1033]}}));Me(new yu({id:$i.ToggleCaseSensitiveCommand,precondition:void 0,handler:s=>s.toggleCaseSensitive(),kbOpts:{weight:105,kbExpr:z.focus,primary:zN.primary,mac:zN.mac,win:zN.win,linux:zN.linux}}));Me(new yu({id:$i.ToggleWholeWordCommand,precondition:void 0,handler:s=>s.toggleWholeWords(),kbOpts:{weight:105,kbExpr:z.focus,primary:UN.primary,mac:UN.mac,win:UN.win,linux:UN.linux}}));Me(new yu({id:$i.ToggleRegexCommand,precondition:void 0,handler:s=>s.toggleRegex(),kbOpts:{weight:105,kbExpr:z.focus,primary:jN.primary,mac:jN.mac,win:jN.win,linux:jN.linux}}));Me(new yu({id:$i.ToggleSearchScopeCommand,precondition:void 0,handler:s=>s.toggleSearchScope(),kbOpts:{weight:105,kbExpr:z.focus,primary:$N.primary,mac:$N.mac,win:$N.win,linux:$N.linux}}));Me(new yu({id:$i.TogglePreserveCaseCommand,precondition:void 0,handler:s=>s.togglePreserveCase(),kbOpts:{weight:105,kbExpr:z.focus,primary:qN.primary,mac:qN.mac,win:qN.win,linux:qN.linux}}));Me(new yu({id:$i.ReplaceOneAction,precondition:Hg,handler:s=>s.replace(),kbOpts:{weight:105,kbExpr:z.focus,primary:3094}}));Me(new yu({id:$i.ReplaceOneAction,precondition:Hg,handler:s=>s.replace(),kbOpts:{weight:105,kbExpr:he.and(z.focus,IQ),primary:3}}));Me(new yu({id:$i.ReplaceAllAction,precondition:Hg,handler:s=>s.replaceAll(),kbOpts:{weight:105,kbExpr:z.focus,primary:2563}}));Me(new yu({id:$i.ReplaceAllAction,precondition:Hg,handler:s=>s.replaceAll(),kbOpts:{weight:105,kbExpr:he.and(z.focus,IQ),primary:void 0,mac:{primary:2051}}}));Me(new yu({id:$i.SelectAllMatchesAction,precondition:Hg,handler:s=>s.selectAllMatches(),kbOpts:{weight:105,kbExpr:z.focus,primary:515}}));const FXe={0:" ",1:"u",2:"r"},coe=65535,jd=16777215,doe=4278190080;class TB{constructor(e){const t=Math.ceil(e/32);this._states=new Uint32Array(t)}get(e){const t=e/32|0,i=e%32;return(this._states[t]&1<<i)!==0}set(e,t){const i=e/32|0,n=e%32,r=this._states[i];t?this._states[i]=r|1<<n:this._states[i]=r&~(1<<n)}}class gl{constructor(e,t,i){if(e.length!==t.length||e.length>coe)throw new Error("invalid startIndexes or endIndexes size");this._startIndexes=e,this._endIndexes=t,this._collapseStates=new TB(e.length),this._userDefinedStates=new TB(e.length),this._recoveredStates=new TB(e.length),this._types=i,this._parentsComputed=!1}ensureParentIndices(){if(!this._parentsComputed){this._parentsComputed=!0;const e=[],t=(i,n)=>{const r=e[e.length-1];return this.getStartLineNumber(r)<=i&&this.getEndLineNumber(r)>=n};for(let i=0,n=this._startIndexes.length;i<n;i++){const r=this._startIndexes[i],o=this._endIndexes[i];if(r>jd||o>jd)throw new Error("startLineNumber or endLineNumber must not exceed "+jd);for(;e.length>0&&!t(r,o);)e.pop();const a=e.length>0?e[e.length-1]:-1;e.push(i),this._startIndexes[i]=r+((a&255)<<24),this._endIndexes[i]=o+((a&65280)<<16)}}}get length(){return this._startIndexes.length}getStartLineNumber(e){return this._startIndexes[e]&jd}getEndLineNumber(e){return this._endIndexes[e]&jd}getType(e){return this._types?this._types[e]:void 0}hasTypes(){return!!this._types}isCollapsed(e){return this._collapseStates.get(e)}setCollapsed(e,t){this._collapseStates.set(e,t)}isUserDefined(e){return this._userDefinedStates.get(e)}setUserDefined(e,t){return this._userDefinedStates.set(e,t)}isRecovered(e){return this._recoveredStates.get(e)}setRecovered(e,t){return this._recoveredStates.set(e,t)}getSource(e){return this.isUserDefined(e)?1:this.isRecovered(e)?2:0}setSource(e,t){t===1?(this.setUserDefined(e,!0),this.setRecovered(e,!1)):t===2?(this.setUserDefined(e,!1),this.setRecovered(e,!0)):(this.setUserDefined(e,!1),this.setRecovered(e,!1))}setCollapsedAllOfType(e,t){let i=!1;if(this._types)for(let n=0;n<this._types.length;n++)this._types[n]===e&&(this.setCollapsed(n,t),i=!0);return i}toRegion(e){return new VXe(this,e)}getParentIndex(e){this.ensureParentIndices();const t=((this._startIndexes[e]&doe)>>>24)+((this._endIndexes[e]&doe)>>>16);return t===coe?-1:t}contains(e,t){return this.getStartLineNumber(e)<=t&&this.getEndLineNumber(e)>=t}findIndex(e){let t=0,i=this._startIndexes.length;if(i===0)return-1;for(;t<i;){const n=Math.floor((t+i)/2);e<this.getStartLineNumber(n)?i=n:t=n+1}return t-1}findRange(e){let t=this.findIndex(e);if(t>=0){if(this.getEndLineNumber(t)>=e)return t;for(t=this.getParentIndex(t);t!==-1;){if(this.contains(t,e))return t;t=this.getParentIndex(t)}}return-1}toString(){const e=[];for(let t=0;t<this.length;t++)e[t]=`[${FXe[this.getSource(t)]}${this.isCollapsed(t)?"+":"-"}] ${this.getStartLineNumber(t)}/${this.getEndLineNumber(t)}`;return e.join(", ")}toFoldRange(e){return{startLineNumber:this._startIndexes[e]&jd,endLineNumber:this._endIndexes[e]&jd,type:this._types?this._types[e]:void 0,isCollapsed:this.isCollapsed(e),source:this.getSource(e)}}static fromFoldRanges(e){const t=e.length,i=new Uint32Array(t),n=new Uint32Array(t);let r=[],o=!1;for(let l=0;l<t;l++){const c=e[l];i[l]=c.startLineNumber,n[l]=c.endLineNumber,r.push(c.type),c.type&&(o=!0)}o||(r=void 0);const a=new gl(i,n,r);for(let l=0;l<t;l++)e[l].isCollapsed&&a.setCollapsed(l,!0),a.setSource(l,e[l].source);return a}static sanitizeAndMerge(e,t,i,n){i=i??Number.MAX_VALUE;const r=(v,C)=>Array.isArray(v)?y=>y<C?v[y]:void 0:y=>y<C?v.toFoldRange(y):void 0,o=r(e,e.length),a=r(t,t.length);let l=0,c=0,d=o(0),u=a(0);const h=[];let g,p=0;const _=[];for(;d||u;){let v;if(u&&(!d||d.startLineNumber>=u.startLineNumber))d&&d.startLineNumber===u.startLineNumber?(u.source===1?v=u:(v=d,v.isCollapsed=u.isCollapsed&&(d.endLineNumber===u.endLineNumber||!(n!=null&&n.startsInside(d.startLineNumber+1,d.endLineNumber+1))),v.source=0),d=o(++l)):(v=u,u.isCollapsed&&u.source===0&&(v.source=2)),u=a(++c);else{let C=c,y=u;for(;;){if(!y||y.startLineNumber>d.endLineNumber){v=d;break}if(y.source===1&&y.endLineNumber>d.endLineNumber)break;y=a(++C)}d=o(++l)}if(v){for(;g&&g.endLineNumber<v.startLineNumber;)g=h.pop();v.endLineNumber>v.startLineNumber&&v.startLineNumber>p&&v.endLineNumber<=i&&(!g||g.endLineNumber>=v.endLineNumber)&&(_.push(v),p=v.startLineNumber,g&&h.push(g),g=v)}}return _}}class VXe{constructor(e,t){this.ranges=e,this.index=t}get startLineNumber(){return this.ranges.getStartLineNumber(this.index)}get endLineNumber(){return this.ranges.getEndLineNumber(this.index)}get regionIndex(){return this.index}get parentIndex(){return this.ranges.getParentIndex(this.index)}get isCollapsed(){return this.ranges.isCollapsed(this.index)}containedBy(e){return e.startLineNumber<=this.startLineNumber&&e.endLineNumber>=this.endLineNumber}containsLine(e){return this.startLineNumber<=e&&e<=this.endLineNumber}}class BXe{get regions(){return this._regions}get textModel(){return this._textModel}constructor(e,t){this._updateEventEmitter=new Z,this.onDidChange=this._updateEventEmitter.event,this._textModel=e,this._decorationProvider=t,this._regions=new gl(new Uint32Array(0),new Uint32Array(0)),this._editorDecorationIds=[]}toggleCollapseState(e){if(!e.length)return;e=e.sort((i,n)=>i.regionIndex-n.regionIndex);const t={};this._decorationProvider.changeDecorations(i=>{let n=0,r=-1,o=-1;const a=l=>{for(;n<l;){const c=this._regions.getEndLineNumber(n),d=this._regions.isCollapsed(n);if(c<=r){const u=this.regions.getSource(n)!==0;i.changeDecorationOptions(this._editorDecorationIds[n],this._decorationProvider.getDecorationOption(d,c<=o,u))}d&&c>o&&(o=c),n++}};for(const l of e){const c=l.regionIndex,d=this._editorDecorationIds[c];if(d&&!t[d]){t[d]=!0,a(c);const u=!this._regions.isCollapsed(c);this._regions.setCollapsed(c,u),r=Math.max(r,this._regions.getEndLineNumber(c))}}a(this._regions.length)}),this._updateEventEmitter.fire({model:this,collapseStateChanged:e})}removeManualRanges(e){const t=new Array,i=n=>{for(const r of e)if(!(r.startLineNumber>n.endLineNumber||n.startLineNumber>r.endLineNumber))return!0;return!1};for(let n=0;n<this._regions.length;n++){const r=this._regions.toFoldRange(n);(r.source===0||!i(r))&&t.push(r)}this.updatePost(gl.fromFoldRanges(t))}update(e,t){const i=this._currentFoldedOrManualRanges(t),n=gl.sanitizeAndMerge(e,i,this._textModel.getLineCount(),t);this.updatePost(gl.fromFoldRanges(n))}updatePost(e){const t=[];let i=-1;for(let n=0,r=e.length;n<r;n++){const o=e.getStartLineNumber(n),a=e.getEndLineNumber(n),l=e.isCollapsed(n),c=e.getSource(n)!==0,d={startLineNumber:o,startColumn:this._textModel.getLineMaxColumn(o),endLineNumber:a,endColumn:this._textModel.getLineMaxColumn(a)+1};t.push({range:d,options:this._decorationProvider.getDecorationOption(l,a<=i,c)}),l&&a>i&&(i=a)}this._decorationProvider.changeDecorations(n=>this._editorDecorationIds=n.deltaDecorations(this._editorDecorationIds,t)),this._regions=e,this._updateEventEmitter.fire({model:this})}_currentFoldedOrManualRanges(e){const t=[];for(let i=0,n=this._regions.length;i<n;i++){let r=this.regions.isCollapsed(i);const o=this.regions.getSource(i);if(r||o!==0){const a=this._regions.toFoldRange(i),l=this._textModel.getDecorationRange(this._editorDecorationIds[i]);l&&(r&&(e!=null&&e.startsInside(l.startLineNumber+1,l.endLineNumber))&&(r=!1),t.push({startLineNumber:l.startLineNumber,endLineNumber:l.endLineNumber,type:a.type,isCollapsed:r,source:o}))}}return t}getMemento(){const e=this._currentFoldedOrManualRanges(),t=[],i=this._textModel.getLineCount();for(let n=0,r=e.length;n<r;n++){const o=e[n];if(o.startLineNumber>=o.endLineNumber||o.startLineNumber<1||o.endLineNumber>i)continue;const a=this._getLinesChecksum(o.startLineNumber+1,o.endLineNumber);t.push({startLineNumber:o.startLineNumber,endLineNumber:o.endLineNumber,isCollapsed:o.isCollapsed,source:o.source,checksum:a})}return t.length>0?t:void 0}applyMemento(e){if(!Array.isArray(e))return;const t=[],i=this._textModel.getLineCount();for(const r of e){if(r.startLineNumber>=r.endLineNumber||r.startLineNumber<1||r.endLineNumber>i)continue;const o=this._getLinesChecksum(r.startLineNumber+1,r.endLineNumber);(!r.checksum||o===r.checksum)&&t.push({startLineNumber:r.startLineNumber,endLineNumber:r.endLineNumber,type:void 0,isCollapsed:r.isCollapsed??!0,source:r.source??0})}const n=gl.sanitizeAndMerge(this._regions,t,i);this.updatePost(gl.fromFoldRanges(n))}_getLinesChecksum(e,t){return tF(this._textModel.getLineContent(e)+this._textModel.getLineContent(t))%1e6}dispose(){this._decorationProvider.removeDecorations(this._editorDecorationIds)}getAllRegionsAtLine(e,t){const i=[];if(this._regions){let n=this._regions.findRange(e),r=1;for(;n>=0;){const o=this._regions.toRegion(n);(!t||t(o,r))&&i.push(o),r++,n=o.parentIndex}}return i}getRegionAtLine(e){if(this._regions){const t=this._regions.findRange(e);if(t>=0)return this._regions.toRegion(t)}return null}getRegionsInside(e,t){const i=[],n=e?e.regionIndex+1:0,r=e?e.endLineNumber:Number.MAX_VALUE;if(t&&t.length===2){const o=[];for(let a=n,l=this._regions.length;a<l;a++){const c=this._regions.toRegion(a);if(this._regions.getStartLineNumber(a)<r){for(;o.length>0&&!c.containedBy(o[o.length-1]);)o.pop();o.push(c),t(c,o.length)&&i.push(c)}else break}}else for(let o=n,a=this._regions.length;o<a;o++){const l=this._regions.toRegion(o);if(this._regions.getStartLineNumber(o)<r)(!t||t(l))&&i.push(l);else break}return i}}function TQ(s,e,t){const i=[];for(const n of t){const r=s.getRegionAtLine(n);if(r){const o=!r.isCollapsed;if(i.push(r),e>1){const a=s.getRegionsInside(r,(l,c)=>l.isCollapsed!==o&&c<e);i.push(...a)}}}s.toggleCollapseState(i)}function NS(s,e,t=Number.MAX_VALUE,i){const n=[];if(i&&i.length>0)for(const r of i){const o=s.getRegionAtLine(r);if(o&&(o.isCollapsed!==e&&n.push(o),t>1)){const a=s.getRegionsInside(o,(l,c)=>l.isCollapsed!==e&&c<t);n.push(...a)}}else{const r=s.getRegionsInside(null,(o,a)=>o.isCollapsed!==e&&a<t);n.push(...r)}s.toggleCollapseState(n)}function wbe(s,e,t,i){const n=[];for(const r of i){const o=s.getAllRegionsAtLine(r,(a,l)=>a.isCollapsed!==e&&l<=t);n.push(...o)}s.toggleCollapseState(n)}function WXe(s,e,t){const i=[];for(const n of t){const r=s.getAllRegionsAtLine(n,o=>o.isCollapsed!==e);r.length>0&&i.push(r[0])}s.toggleCollapseState(i)}function HXe(s,e,t,i){const n=(o,a)=>a===e&&o.isCollapsed!==t&&!i.some(l=>o.containsLine(l)),r=s.getRegionsInside(null,n);s.toggleCollapseState(r)}function Cbe(s,e,t){const i=[];for(const o of t){const a=s.getAllRegionsAtLine(o,void 0);a.length>0&&i.push(a[0])}const n=o=>i.every(a=>!a.containedBy(o)&&!o.containedBy(a))&&o.isCollapsed!==e,r=s.getRegionsInside(null,n);s.toggleCollapseState(r)}function NQ(s,e,t){const i=s.textModel,n=s.regions,r=[];for(let o=n.length-1;o>=0;o--)if(t!==n.isCollapsed(o)){const a=n.getStartLineNumber(o);e.test(i.getLineContent(a))&&r.push(n.toRegion(o))}s.toggleCollapseState(r)}function RQ(s,e,t){const i=s.regions,n=[];for(let r=i.length-1;r>=0;r--)t!==i.isCollapsed(r)&&e===i.getType(r)&&n.push(i.toRegion(r));s.toggleCollapseState(n)}function zXe(s,e){let t=null;const i=e.getRegionAtLine(s);if(i!==null&&(t=i.startLineNumber,s===t)){const n=i.parentIndex;n!==-1?t=e.regions.getStartLineNumber(n):t=null}return t}function UXe(s,e){let t=e.getRegionAtLine(s);if(t!==null&&t.startLineNumber===s){if(s!==t.startLineNumber)return t.startLineNumber;{const i=t.parentIndex;let n=0;for(i!==-1&&(n=e.regions.getStartLineNumber(t.parentIndex));t!==null;)if(t.regionIndex>0){if(t=e.regions.toRegion(t.regionIndex-1),t.startLineNumber<=n)return null;if(t.parentIndex===i)return t.startLineNumber}else return null}}else if(e.regions.length>0)for(t=e.regions.toRegion(e.regions.length-1);t!==null;){if(t.startLineNumber<s)return t.startLineNumber;t.regionIndex>0?t=e.regions.toRegion(t.regionIndex-1):t=null}return null}function jXe(s,e){let t=e.getRegionAtLine(s);if(t!==null&&t.startLineNumber===s){const i=t.parentIndex;let n=0;if(i!==-1)n=e.regions.getEndLineNumber(t.parentIndex);else{if(e.regions.length===0)return null;n=e.regions.getEndLineNumber(e.regions.length-1)}for(;t!==null;)if(t.regionIndex<e.regions.length){if(t=e.regions.toRegion(t.regionIndex+1),t.startLineNumber>=n)return null;if(t.parentIndex===i)return t.startLineNumber}else return null}else if(e.regions.length>0)for(t=e.regions.toRegion(0);t!==null;){if(t.startLineNumber>s)return t.startLineNumber;t.regionIndex<e.regions.length?t=e.regions.toRegion(t.regionIndex+1):t=null}return null}class $Xe{get onDidChange(){return this._updateEventEmitter.event}get hiddenRanges(){return this._hiddenRanges}constructor(e){this._updateEventEmitter=new Z,this._hasLineChanges=!1,this._foldingModel=e,this._foldingModelListener=e.onDidChange(t=>this.updateHiddenRanges()),this._hiddenRanges=[],e.regions.length&&this.updateHiddenRanges()}notifyChangeModelContent(e){this._hiddenRanges.length&&!this._hasLineChanges&&(this._hasLineChanges=e.changes.some(t=>t.range.endLineNumber!==t.range.startLineNumber||Gm(t.text)[0]!==0))}updateHiddenRanges(){let e=!1;const t=[];let i=0,n=0,r=Number.MAX_VALUE,o=-1;const a=this._foldingModel.regions;for(;i<a.length;i++){if(!a.isCollapsed(i))continue;const l=a.getStartLineNumber(i)+1,c=a.getEndLineNumber(i);r<=l&&c<=o||(!e&&n<this._hiddenRanges.length&&this._hiddenRanges[n].startLineNumber===l&&this._hiddenRanges[n].endLineNumber===c?(t.push(this._hiddenRanges[n]),n++):(e=!0,t.push(new F(l,1,c,1))),r=l,o=c)}(this._hasLineChanges||e||n<this._hiddenRanges.length)&&this.applyHiddenRanges(t)}applyHiddenRanges(e){this._hiddenRanges=e,this._hasLineChanges=!1,this._updateEventEmitter.fire(e)}hasRanges(){return this._hiddenRanges.length>0}isHidden(e){return uoe(this._hiddenRanges,e)!==null}adjustSelections(e){let t=!1;const i=this._foldingModel.textModel;let n=null;const r=o=>((!n||!qXe(o,n))&&(n=uoe(this._hiddenRanges,o)),n?n.startLineNumber-1:null);for(let o=0,a=e.length;o<a;o++){let l=e[o];const c=r(l.startLineNumber);c&&(l=l.setStartPosition(c,i.getLineMaxColumn(c)),t=!0);const d=r(l.endLineNumber);d&&(l=l.setEndPosition(d,i.getLineMaxColumn(d)),t=!0),e[o]=l}return t}dispose(){this.hiddenRanges.length>0&&(this._hiddenRanges=[],this._updateEventEmitter.fire(this._hiddenRanges)),this._foldingModelListener&&(this._foldingModelListener.dispose(),this._foldingModelListener=null)}}function qXe(s,e){return s>=e.startLineNumber&&s<=e.endLineNumber}function uoe(s,e){const t=lI(s,i=>e<i.startLineNumber)-1;return t>=0&&s[t].endLineNumber>=e?s[t]:null}const KXe=5e3,GXe="indent";class AQ{constructor(e,t,i){this.editorModel=e,this.languageConfigurationService=t,this.foldingRangesLimit=i,this.id=GXe}dispose(){}compute(e){const t=this.languageConfigurationService.getLanguageConfiguration(this.editorModel.getLanguageId()).foldingRules,i=t&&!!t.offSide,n=t&&t.markers;return Promise.resolve(XXe(this.editorModel,i,n,this.foldingRangesLimit))}}let QXe=class{constructor(e){this._startIndexes=[],this._endIndexes=[],this._indentOccurrences=[],this._length=0,this._foldingRangesLimit=e}insertFirst(e,t,i){if(e>jd||t>jd)return;const n=this._length;this._startIndexes[n]=e,this._endIndexes[n]=t,this._length++,i<1e3&&(this._indentOccurrences[i]=(this._indentOccurrences[i]||0)+1)}toIndentRanges(e){const t=this._foldingRangesLimit.limit;if(this._length<=t){this._foldingRangesLimit.update(this._length,!1);const i=new Uint32Array(this._length),n=new Uint32Array(this._length);for(let r=this._length-1,o=0;r>=0;r--,o++)i[o]=this._startIndexes[r],n[o]=this._endIndexes[r];return new gl(i,n)}else{this._foldingRangesLimit.update(this._length,t);let i=0,n=this._indentOccurrences.length;for(let l=0;l<this._indentOccurrences.length;l++){const c=this._indentOccurrences[l];if(c){if(c+i>t){n=l;break}i+=c}}const r=e.getOptions().tabSize,o=new Uint32Array(t),a=new Uint32Array(t);for(let l=this._length-1,c=0;l>=0;l--){const d=this._startIndexes[l],u=e.getLineContent(d),h=jF(u,r);(h<n||h===n&&i++<t)&&(o[c]=d,a[c]=this._endIndexes[l],c++)}return new gl(o,a)}}};const YXe={limit:KXe,update:()=>{}};function XXe(s,e,t,i=YXe){const n=s.getOptions().tabSize,r=new QXe(i);let o;t&&(o=new RegExp(`(${t.start.source})|(?:${t.end.source})`));const a=[],l=s.getLineCount()+1;a.push({indent:-1,endAbove:l,line:l});for(let c=s.getLineCount();c>0;c--){const d=s.getLineContent(c),u=jF(d,n);let h=a[a.length-1];if(u===-1){e&&(h.endAbove=c);continue}let g;if(o&&(g=d.match(o)))if(g[1]){let p=a.length-1;for(;p>0&&a[p].indent!==-2;)p--;if(p>0){a.length=p+1,h=a[p],r.insertFirst(c,h.line,u),h.line=c,h.indent=u,h.endAbove=c;continue}}else{a.push({indent:-2,endAbove:c,line:c});continue}if(h.indent>u){do a.pop(),h=a[a.length-1];while(h.indent>u);const p=h.endAbove-1;p-c>=1&&r.insertFirst(c,p,u)}h.indent===u?h.endAbove=c:a.push({indent:u,endAbove:c,line:c})}return r.toIndentRanges(s)}const ZXe=j("editor.foldBackground",{light:Tt(Up,.3),dark:Tt(Up,.3),hcDark:null,hcLight:null},b("foldBackgroundBackground","Background color behind folded ranges. The color must not be opaque so as not to hide underlying decorations."),!0);j("editor.foldPlaceholderForeground",{light:"#808080",dark:"#808080",hcDark:null,hcLight:null},b("collapsedTextColor","Color of the collapsed text after the first line of a folded range."));j("editorGutter.foldingControlForeground",lA,b("editorGutter.foldingControlForeground","Color of the folding control in the editor gutter."));const jP=Qi("folding-expanded",xe.chevronDown,b("foldingExpandedIcon","Icon for expanded ranges in the editor glyph margin.")),$P=Qi("folding-collapsed",xe.chevronRight,b("foldingCollapsedIcon","Icon for collapsed ranges in the editor glyph margin.")),hoe=Qi("folding-manual-collapsed",$P,b("foldingManualCollapedIcon","Icon for manually collapsed ranges in the editor glyph margin.")),foe=Qi("folding-manual-expanded",jP,b("foldingManualExpandedIcon","Icon for manually expanded ranges in the editor glyph margin.")),NB={color:kn(ZXe),position:1},nC=b("linesCollapsed","Click to expand the range."),QN=b("linesExpanded","Click to collapse the range."),ts=class ts{constructor(e){this.editor=e,this.showFoldingControls="mouseover",this.showFoldingHighlights=!0}getDecorationOption(e,t,i){return t?ts.HIDDEN_RANGE_DECORATION:this.showFoldingControls==="never"?e?this.showFoldingHighlights?ts.NO_CONTROLS_COLLAPSED_HIGHLIGHTED_RANGE_DECORATION:ts.NO_CONTROLS_COLLAPSED_RANGE_DECORATION:ts.NO_CONTROLS_EXPANDED_RANGE_DECORATION:e?i?this.showFoldingHighlights?ts.MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION:ts.MANUALLY_COLLAPSED_VISUAL_DECORATION:this.showFoldingHighlights?ts.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION:ts.COLLAPSED_VISUAL_DECORATION:this.showFoldingControls==="mouseover"?i?ts.MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION:ts.EXPANDED_AUTO_HIDE_VISUAL_DECORATION:i?ts.MANUALLY_EXPANDED_VISUAL_DECORATION:ts.EXPANDED_VISUAL_DECORATION}changeDecorations(e){return this.editor.changeDecorations(e)}removeDecorations(e){this.editor.removeDecorations(e)}};ts.COLLAPSED_VISUAL_DECORATION=_t.register({description:"folding-collapsed-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",isWholeLine:!0,linesDecorationsTooltip:nC,firstLineDecorationClassName:at.asClassName($P)}),ts.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION=_t.register({description:"folding-collapsed-highlighted-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",className:"folded-background",minimap:NB,isWholeLine:!0,linesDecorationsTooltip:nC,firstLineDecorationClassName:at.asClassName($P)}),ts.MANUALLY_COLLAPSED_VISUAL_DECORATION=_t.register({description:"folding-manually-collapsed-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",isWholeLine:!0,linesDecorationsTooltip:nC,firstLineDecorationClassName:at.asClassName(hoe)}),ts.MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION=_t.register({description:"folding-manually-collapsed-highlighted-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",className:"folded-background",minimap:NB,isWholeLine:!0,linesDecorationsTooltip:nC,firstLineDecorationClassName:at.asClassName(hoe)}),ts.NO_CONTROLS_COLLAPSED_RANGE_DECORATION=_t.register({description:"folding-no-controls-range-decoration",stickiness:0,afterContentClassName:"inline-folded",isWholeLine:!0,linesDecorationsTooltip:nC}),ts.NO_CONTROLS_COLLAPSED_HIGHLIGHTED_RANGE_DECORATION=_t.register({description:"folding-no-controls-range-decoration",stickiness:0,afterContentClassName:"inline-folded",className:"folded-background",minimap:NB,isWholeLine:!0,linesDecorationsTooltip:nC}),ts.EXPANDED_VISUAL_DECORATION=_t.register({description:"folding-expanded-visual-decoration",stickiness:1,isWholeLine:!0,firstLineDecorationClassName:"alwaysShowFoldIcons "+at.asClassName(jP),linesDecorationsTooltip:QN}),ts.EXPANDED_AUTO_HIDE_VISUAL_DECORATION=_t.register({description:"folding-expanded-auto-hide-visual-decoration",stickiness:1,isWholeLine:!0,firstLineDecorationClassName:at.asClassName(jP),linesDecorationsTooltip:QN}),ts.MANUALLY_EXPANDED_VISUAL_DECORATION=_t.register({description:"folding-manually-expanded-visual-decoration",stickiness:0,isWholeLine:!0,firstLineDecorationClassName:"alwaysShowFoldIcons "+at.asClassName(foe),linesDecorationsTooltip:QN}),ts.MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION=_t.register({description:"folding-manually-expanded-auto-hide-visual-decoration",stickiness:0,isWholeLine:!0,firstLineDecorationClassName:at.asClassName(foe),linesDecorationsTooltip:QN}),ts.NO_CONTROLS_EXPANDED_RANGE_DECORATION=_t.register({description:"folding-no-controls-range-decoration",stickiness:0,isWholeLine:!0}),ts.HIDDEN_RANGE_DECORATION=_t.register({description:"folding-hidden-range-decoration",stickiness:1});let gU=ts;const JXe={},eZe="syntax";class PQ{constructor(e,t,i,n,r){this.editorModel=e,this.providers=t,this.handleFoldingRangesChange=i,this.foldingRangesLimit=n,this.fallbackRangeProvider=r,this.id=eZe,this.disposables=new ce,r&&this.disposables.add(r);for(const o of t)typeof o.onDidChange=="function"&&this.disposables.add(o.onDidChange(i))}compute(e){return tZe(this.providers,this.editorModel,e).then(t=>{var i;return t?nZe(t,this.foldingRangesLimit):((i=this.fallbackRangeProvider)==null?void 0:i.compute(e))??null})}dispose(){this.disposables.dispose()}}function tZe(s,e,t){let i=null;const n=s.map((r,o)=>Promise.resolve(r.provideFoldingRanges(e,JXe,t)).then(a=>{if(!t.isCancellationRequested&&Array.isArray(a)){Array.isArray(i)||(i=[]);const l=e.getLineCount();for(const c of a)c.start>0&&c.end>c.start&&c.end<=l&&i.push({start:c.start,end:c.end,rank:o,kind:c.kind})}},Mn));return Promise.all(n).then(r=>i)}class iZe{constructor(e){this._startIndexes=[],this._endIndexes=[],this._nestingLevels=[],this._nestingLevelCounts=[],this._types=[],this._length=0,this._foldingRangesLimit=e}add(e,t,i,n){if(e>jd||t>jd)return;const r=this._length;this._startIndexes[r]=e,this._endIndexes[r]=t,this._nestingLevels[r]=n,this._types[r]=i,this._length++,n<30&&(this._nestingLevelCounts[n]=(this._nestingLevelCounts[n]||0)+1)}toIndentRanges(){const e=this._foldingRangesLimit.limit;if(this._length<=e){this._foldingRangesLimit.update(this._length,!1);const t=new Uint32Array(this._length),i=new Uint32Array(this._length);for(let n=0;n<this._length;n++)t[n]=this._startIndexes[n],i[n]=this._endIndexes[n];return new gl(t,i,this._types)}else{this._foldingRangesLimit.update(this._length,e);let t=0,i=this._nestingLevelCounts.length;for(let a=0;a<this._nestingLevelCounts.length;a++){const l=this._nestingLevelCounts[a];if(l){if(l+t>e){i=a;break}t+=l}}const n=new Uint32Array(e),r=new Uint32Array(e),o=[];for(let a=0,l=0;a<this._length;a++){const c=this._nestingLevels[a];(c<i||c===i&&t++<e)&&(n[l]=this._startIndexes[a],r[l]=this._endIndexes[a],o[l]=this._types[a],l++)}return new gl(n,r,o)}}}function nZe(s,e){const t=s.sort((o,a)=>{let l=o.start-a.start;return l===0&&(l=o.rank-a.rank),l}),i=new iZe(e);let n;const r=[];for(const o of t)if(!n)n=o,i.add(o.start,o.end,o.kind&&o.kind.value,r.length);else if(o.start>n.start)if(o.end<=n.end)r.push(n),n=o,i.add(o.start,o.end,o.kind&&o.kind.value,r.length);else{if(o.start>n.end){do n=r.pop();while(n&&o.start>n.end);n&&r.push(n),n=o}i.add(o.start,o.end,o.kind&&o.kind.value,r.length)}return i.toIndentRanges()}var sZe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Wx=function(s,e){return function(t,i){e(t,i,s)}},fb;const mr=new Oe("foldingEnabled",!1);var Pv;let s_=(Pv=class extends te{static get(e){return e.getContribution(fb.ID)}static getFoldingRangeProviders(e,t){var n;const i=e.foldingRangeProvider.ordered(t);return((n=fb._foldingRangeSelector)==null?void 0:n.call(fb,i,t))??i}constructor(e,t,i,n,r,o){super(),this.contextKeyService=t,this.languageConfigurationService=i,this.languageFeaturesService=o,this.localToDispose=this._register(new ce),this.editor=e,this._foldingLimitReporter=new ybe(e);const a=this.editor.getOptions();this._isEnabled=a.get(43),this._useFoldingProviders=a.get(44)!=="indentation",this._unfoldOnClickAfterEndOfLine=a.get(48),this._restoringViewState=!1,this._currentModelHasFoldedImports=!1,this._foldingImportsByDefault=a.get(46),this.updateDebounceInfo=r.for(o.foldingRangeProvider,"Folding",{min:200}),this.foldingModel=null,this.hiddenRangeModel=null,this.rangeProvider=null,this.foldingRegionPromise=null,this.foldingModelPromise=null,this.updateScheduler=null,this.cursorChangedScheduler=null,this.mouseDownInfo=null,this.foldingDecorationProvider=new gU(e),this.foldingDecorationProvider.showFoldingControls=a.get(111),this.foldingDecorationProvider.showFoldingHighlights=a.get(45),this.foldingEnabled=mr.bindTo(this.contextKeyService),this.foldingEnabled.set(this._isEnabled),this._register(this.editor.onDidChangeModel(()=>this.onModelChanged())),this._register(this.editor.onDidChangeConfiguration(l=>{if(l.hasChanged(43)&&(this._isEnabled=this.editor.getOptions().get(43),this.foldingEnabled.set(this._isEnabled),this.onModelChanged()),l.hasChanged(47)&&this.onModelChanged(),l.hasChanged(111)||l.hasChanged(45)){const c=this.editor.getOptions();this.foldingDecorationProvider.showFoldingControls=c.get(111),this.foldingDecorationProvider.showFoldingHighlights=c.get(45),this.triggerFoldingModelChanged()}l.hasChanged(44)&&(this._useFoldingProviders=this.editor.getOptions().get(44)!=="indentation",this.onFoldingStrategyChanged()),l.hasChanged(48)&&(this._unfoldOnClickAfterEndOfLine=this.editor.getOptions().get(48)),l.hasChanged(46)&&(this._foldingImportsByDefault=this.editor.getOptions().get(46))})),this.onModelChanged()}saveViewState(){const e=this.editor.getModel();if(!e||!this._isEnabled||e.isTooLargeForTokenization())return{};if(this.foldingModel){const t=this.foldingModel.getMemento(),i=this.rangeProvider?this.rangeProvider.id:void 0;return{collapsedRegions:t,lineCount:e.getLineCount(),provider:i,foldedImports:this._currentModelHasFoldedImports}}}restoreViewState(e){const t=this.editor.getModel();if(!(!t||!this._isEnabled||t.isTooLargeForTokenization()||!this.hiddenRangeModel)&&e&&(this._currentModelHasFoldedImports=!!e.foldedImports,e.collapsedRegions&&e.collapsedRegions.length>0&&this.foldingModel)){this._restoringViewState=!0;try{this.foldingModel.applyMemento(e.collapsedRegions)}finally{this._restoringViewState=!1}}}onModelChanged(){this.localToDispose.clear();const e=this.editor.getModel();!this._isEnabled||!e||e.isTooLargeForTokenization()||(this._currentModelHasFoldedImports=!1,this.foldingModel=new BXe(e,this.foldingDecorationProvider),this.localToDispose.add(this.foldingModel),this.hiddenRangeModel=new $Xe(this.foldingModel),this.localToDispose.add(this.hiddenRangeModel),this.localToDispose.add(this.hiddenRangeModel.onDidChange(t=>this.onHiddenRangesChanges(t))),this.updateScheduler=new bc(this.updateDebounceInfo.get(e)),this.cursorChangedScheduler=new xi(()=>this.revealCursor(),200),this.localToDispose.add(this.cursorChangedScheduler),this.localToDispose.add(this.languageFeaturesService.foldingRangeProvider.onDidChange(()=>this.onFoldingStrategyChanged())),this.localToDispose.add(this.editor.onDidChangeModelLanguageConfiguration(()=>this.onFoldingStrategyChanged())),this.localToDispose.add(this.editor.onDidChangeModelContent(t=>this.onDidChangeModelContent(t))),this.localToDispose.add(this.editor.onDidChangeCursorPosition(()=>this.onCursorPositionChanged())),this.localToDispose.add(this.editor.onMouseDown(t=>this.onEditorMouseDown(t))),this.localToDispose.add(this.editor.onMouseUp(t=>this.onEditorMouseUp(t))),this.localToDispose.add({dispose:()=>{var t,i;this.foldingRegionPromise&&(this.foldingRegionPromise.cancel(),this.foldingRegionPromise=null),(t=this.updateScheduler)==null||t.cancel(),this.updateScheduler=null,this.foldingModel=null,this.foldingModelPromise=null,this.hiddenRangeModel=null,this.cursorChangedScheduler=null,(i=this.rangeProvider)==null||i.dispose(),this.rangeProvider=null}}),this.triggerFoldingModelChanged())}onFoldingStrategyChanged(){var e;(e=this.rangeProvider)==null||e.dispose(),this.rangeProvider=null,this.triggerFoldingModelChanged()}getRangeProvider(e){if(this.rangeProvider)return this.rangeProvider;const t=new AQ(e,this.languageConfigurationService,this._foldingLimitReporter);if(this.rangeProvider=t,this._useFoldingProviders&&this.foldingModel){const i=fb.getFoldingRangeProviders(this.languageFeaturesService,e);i.length>0&&(this.rangeProvider=new PQ(e,i,()=>this.triggerFoldingModelChanged(),this._foldingLimitReporter,t))}return this.rangeProvider}getFoldingModel(){return this.foldingModelPromise}onDidChangeModelContent(e){var t;(t=this.hiddenRangeModel)==null||t.notifyChangeModelContent(e),this.triggerFoldingModelChanged()}triggerFoldingModelChanged(){this.updateScheduler&&(this.foldingRegionPromise&&(this.foldingRegionPromise.cancel(),this.foldingRegionPromise=null),this.foldingModelPromise=this.updateScheduler.trigger(()=>{const e=this.foldingModel;if(!e)return null;const t=new Bs,i=this.getRangeProvider(e.textModel),n=this.foldingRegionPromise=xs(r=>i.compute(r));return n.then(r=>{if(r&&n===this.foldingRegionPromise){let o;if(this._foldingImportsByDefault&&!this._currentModelHasFoldedImports){const c=r.setCollapsedAllOfType(Hm.Imports.value,!0);c&&(o=_u.capture(this.editor),this._currentModelHasFoldedImports=c)}const a=this.editor.getSelections();e.update(r,rZe(a)),o==null||o.restore(this.editor);const l=this.updateDebounceInfo.update(e.textModel,t.elapsed());this.updateScheduler&&(this.updateScheduler.defaultDelay=l)}return e})}).then(void 0,e=>(ft(e),null)))}onHiddenRangesChanges(e){if(this.hiddenRangeModel&&e.length&&!this._restoringViewState){const t=this.editor.getSelections();t&&this.hiddenRangeModel.adjustSelections(t)&&this.editor.setSelections(t)}this.editor.setHiddenAreas(e,this)}onCursorPositionChanged(){this.hiddenRangeModel&&this.hiddenRangeModel.hasRanges()&&this.cursorChangedScheduler.schedule()}revealCursor(){const e=this.getFoldingModel();e&&e.then(t=>{if(t){const i=this.editor.getSelections();if(i&&i.length>0){const n=[];for(const r of i){const o=r.selectionStartLineNumber;this.hiddenRangeModel&&this.hiddenRangeModel.isHidden(o)&&n.push(...t.getAllRegionsAtLine(o,a=>a.isCollapsed&&o>a.startLineNumber))}n.length&&(t.toggleCollapseState(n),this.reveal(i[0].getPosition()))}}}).then(void 0,ft)}onEditorMouseDown(e){if(this.mouseDownInfo=null,!this.hiddenRangeModel||!e.target||!e.target.range||!e.event.leftButton&&!e.event.middleButton)return;const t=e.target.range;let i=!1;switch(e.target.type){case 4:{const n=e.target.detail,r=e.target.element.offsetLeft;if(n.offsetX-r<4)return;i=!0;break}case 7:{if(this._unfoldOnClickAfterEndOfLine&&this.hiddenRangeModel.hasRanges()&&!e.target.detail.isAfterLines)break;return}case 6:{if(this.hiddenRangeModel.hasRanges()){const n=this.editor.getModel();if(n&&t.startColumn===n.getLineMaxColumn(t.startLineNumber))break}return}default:return}this.mouseDownInfo={lineNumber:t.startLineNumber,iconClicked:i}}onEditorMouseUp(e){const t=this.foldingModel;if(!t||!this.mouseDownInfo||!e.target)return;const i=this.mouseDownInfo.lineNumber,n=this.mouseDownInfo.iconClicked,r=e.target.range;if(!r||r.startLineNumber!==i)return;if(n){if(e.target.type!==4)return}else{const a=this.editor.getModel();if(!a||r.startColumn!==a.getLineMaxColumn(i))return}const o=t.getRegionAtLine(i);if(o&&o.startLineNumber===i){const a=o.isCollapsed;if(n||a){const l=e.event.altKey;let c=[];if(l){const d=h=>!h.containedBy(o)&&!o.containedBy(h),u=t.getRegionsInside(null,d);for(const h of u)h.isCollapsed&&c.push(h);c.length===0&&(c=u)}else{const d=e.event.middleButton||e.event.shiftKey;if(d)for(const u of t.getRegionsInside(o))u.isCollapsed===a&&c.push(u);(a||!d||c.length===0)&&c.push(o)}t.toggleCollapseState(c),this.reveal({lineNumber:i,column:1})}}}reveal(e){this.editor.revealPositionInCenterIfOutsideViewport(e,0)}},fb=Pv,Pv.ID="editor.contrib.folding",Pv);s_=fb=sZe([Wx(1,ct),Wx(2,bn),Wx(3,jn),Wx(4,Fl),Wx(5,Be)],s_);class ybe{constructor(e){this.editor=e,this._onDidChange=new Z,this._computed=0,this._limited=!1}get limit(){return this.editor.getOptions().get(47)}update(e,t){(e!==this._computed||t!==this._limited)&&(this._computed=e,this._limited=t,this._onDidChange.fire())}}class Rr extends Ve{runEditorCommand(e,t,i){const n=e.get(bn),r=s_.get(t);if(!r)return;const o=r.getFoldingModel();if(o)return this.reportTelemetry(e,t),o.then(a=>{if(a){this.invoke(r,a,t,i,n);const l=t.getSelection();l&&r.reveal(l.getStartPosition())}})}getSelectedLines(e){const t=e.getSelections();return t?t.map(i=>i.startLineNumber):[]}getLineNumbers(e,t){return e&&e.selectionLines?e.selectionLines.map(i=>i+1):this.getSelectedLines(t)}run(e,t){}}function rZe(s){return!s||s.length===0?{startsInside:()=>!1}:{startsInside(e,t){for(const i of s){const n=i.startLineNumber;if(n>=e&&n<=t)return!0}return!1}}}function Sbe(s){if(!Yr(s)){if(!Ms(s))return!1;const e=s;if(!Yr(e.levels)&&!Vm(e.levels)||!Yr(e.direction)&&!Zo(e.direction)||!Yr(e.selectionLines)&&(!Array.isArray(e.selectionLines)||!e.selectionLines.every(Vm)))return!1}return!0}class oZe extends Rr{constructor(){super({id:"editor.unfold",label:b("unfoldAction.label","Unfold"),alias:"Unfold",precondition:mr,kbOpts:{kbExpr:z.editorTextFocus,primary:3166,mac:{primary:2654},weight:100},metadata:{description:"Unfold the content in the editor",args:[{name:"Unfold editor argument",description:`Property-value pairs that can be passed through this argument:
						* 'levels': Number of levels to unfold. If not set, defaults to 1.
						* 'direction': If 'up', unfold given number of levels up otherwise unfolds down.
						* 'selectionLines': Array of the start lines (0-based) of the editor selections to apply the unfold action to. If not set, the active selection(s) will be used.
						`,constraint:Sbe,schema:{type:"object",properties:{levels:{type:"number",default:1},direction:{type:"string",enum:["up","down"],default:"down"},selectionLines:{type:"array",items:{type:"number"}}}}}]}})}invoke(e,t,i,n){const r=n&&n.levels||1,o=this.getLineNumbers(n,i);n&&n.direction==="up"?wbe(t,!1,r,o):NS(t,!1,r,o)}}class aZe extends Rr{constructor(){super({id:"editor.unfoldRecursively",label:b("unFoldRecursivelyAction.label","Unfold Recursively"),alias:"Unfold Recursively",precondition:mr,kbOpts:{kbExpr:z.editorTextFocus,primary:ns(2089,2142),weight:100}})}invoke(e,t,i,n){NS(t,!1,Number.MAX_VALUE,this.getSelectedLines(i))}}class lZe extends Rr{constructor(){super({id:"editor.fold",label:b("foldAction.label","Fold"),alias:"Fold",precondition:mr,kbOpts:{kbExpr:z.editorTextFocus,primary:3164,mac:{primary:2652},weight:100},metadata:{description:"Fold the content in the editor",args:[{name:"Fold editor argument",description:`Property-value pairs that can be passed through this argument:
							* 'levels': Number of levels to fold.
							* 'direction': If 'up', folds given number of levels up otherwise folds down.
							* 'selectionLines': Array of the start lines (0-based) of the editor selections to apply the fold action to. If not set, the active selection(s) will be used.
							If no levels or direction is set, folds the region at the locations or if already collapsed, the first uncollapsed parent instead.
						`,constraint:Sbe,schema:{type:"object",properties:{levels:{type:"number"},direction:{type:"string",enum:["up","down"]},selectionLines:{type:"array",items:{type:"number"}}}}}]}})}invoke(e,t,i,n){const r=this.getLineNumbers(n,i),o=n&&n.levels,a=n&&n.direction;typeof o!="number"&&typeof a!="string"?WXe(t,!0,r):a==="up"?wbe(t,!0,o||1,r):NS(t,!0,o||1,r)}}class cZe extends Rr{constructor(){super({id:"editor.toggleFold",label:b("toggleFoldAction.label","Toggle Fold"),alias:"Toggle Fold",precondition:mr,kbOpts:{kbExpr:z.editorTextFocus,primary:ns(2089,2090),weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);TQ(t,1,n)}}class dZe extends Rr{constructor(){super({id:"editor.foldRecursively",label:b("foldRecursivelyAction.label","Fold Recursively"),alias:"Fold Recursively",precondition:mr,kbOpts:{kbExpr:z.editorTextFocus,primary:ns(2089,2140),weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);NS(t,!0,Number.MAX_VALUE,n)}}class uZe extends Rr{constructor(){super({id:"editor.toggleFoldRecursively",label:b("toggleFoldRecursivelyAction.label","Toggle Fold Recursively"),alias:"Toggle Fold Recursively",precondition:mr,kbOpts:{kbExpr:z.editorTextFocus,primary:ns(2089,3114),weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);TQ(t,Number.MAX_VALUE,n)}}class hZe extends Rr{constructor(){super({id:"editor.foldAllBlockComments",label:b("foldAllBlockComments.label","Fold All Block Comments"),alias:"Fold All Block Comments",precondition:mr,kbOpts:{kbExpr:z.editorTextFocus,primary:ns(2089,2138),weight:100}})}invoke(e,t,i,n,r){if(t.regions.hasTypes())RQ(t,Hm.Comment.value,!0);else{const o=i.getModel();if(!o)return;const a=r.getLanguageConfiguration(o.getLanguageId()).comments;if(a&&a.blockCommentStartToken){const l=new RegExp("^\\s*"+Nl(a.blockCommentStartToken));NQ(t,l,!0)}}}}class fZe extends Rr{constructor(){super({id:"editor.foldAllMarkerRegions",label:b("foldAllMarkerRegions.label","Fold All Regions"),alias:"Fold All Regions",precondition:mr,kbOpts:{kbExpr:z.editorTextFocus,primary:ns(2089,2077),weight:100}})}invoke(e,t,i,n,r){if(t.regions.hasTypes())RQ(t,Hm.Region.value,!0);else{const o=i.getModel();if(!o)return;const a=r.getLanguageConfiguration(o.getLanguageId()).foldingRules;if(a&&a.markers&&a.markers.start){const l=new RegExp(a.markers.start);NQ(t,l,!0)}}}}class gZe extends Rr{constructor(){super({id:"editor.unfoldAllMarkerRegions",label:b("unfoldAllMarkerRegions.label","Unfold All Regions"),alias:"Unfold All Regions",precondition:mr,kbOpts:{kbExpr:z.editorTextFocus,primary:ns(2089,2078),weight:100}})}invoke(e,t,i,n,r){if(t.regions.hasTypes())RQ(t,Hm.Region.value,!1);else{const o=i.getModel();if(!o)return;const a=r.getLanguageConfiguration(o.getLanguageId()).foldingRules;if(a&&a.markers&&a.markers.start){const l=new RegExp(a.markers.start);NQ(t,l,!1)}}}}class pZe extends Rr{constructor(){super({id:"editor.foldAllExcept",label:b("foldAllExcept.label","Fold All Except Selected"),alias:"Fold All Except Selected",precondition:mr,kbOpts:{kbExpr:z.editorTextFocus,primary:ns(2089,2136),weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);Cbe(t,!0,n)}}class mZe extends Rr{constructor(){super({id:"editor.unfoldAllExcept",label:b("unfoldAllExcept.label","Unfold All Except Selected"),alias:"Unfold All Except Selected",precondition:mr,kbOpts:{kbExpr:z.editorTextFocus,primary:ns(2089,2134),weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);Cbe(t,!1,n)}}class _Ze extends Rr{constructor(){super({id:"editor.foldAll",label:b("foldAllAction.label","Fold All"),alias:"Fold All",precondition:mr,kbOpts:{kbExpr:z.editorTextFocus,primary:ns(2089,2069),weight:100}})}invoke(e,t,i){NS(t,!0)}}class bZe extends Rr{constructor(){super({id:"editor.unfoldAll",label:b("unfoldAllAction.label","Unfold All"),alias:"Unfold All",precondition:mr,kbOpts:{kbExpr:z.editorTextFocus,primary:ns(2089,2088),weight:100}})}invoke(e,t,i){NS(t,!1)}}const sy=class sy extends Rr{getFoldingLevel(){return parseInt(this.id.substr(sy.ID_PREFIX.length))}invoke(e,t,i){HXe(t,this.getFoldingLevel(),!0,this.getSelectedLines(i))}};sy.ID_PREFIX="editor.foldLevel",sy.ID=e=>sy.ID_PREFIX+e;let qP=sy;class vZe extends Rr{constructor(){super({id:"editor.gotoParentFold",label:b("gotoParentFold.label","Go to Parent Fold"),alias:"Go to Parent Fold",precondition:mr,kbOpts:{kbExpr:z.editorTextFocus,weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);if(n.length>0){const r=zXe(n[0],t);r!==null&&i.setSelection({startLineNumber:r,startColumn:1,endLineNumber:r,endColumn:1})}}}class wZe extends Rr{constructor(){super({id:"editor.gotoPreviousFold",label:b("gotoPreviousFold.label","Go to Previous Folding Range"),alias:"Go to Previous Folding Range",precondition:mr,kbOpts:{kbExpr:z.editorTextFocus,weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);if(n.length>0){const r=UXe(n[0],t);r!==null&&i.setSelection({startLineNumber:r,startColumn:1,endLineNumber:r,endColumn:1})}}}class CZe extends Rr{constructor(){super({id:"editor.gotoNextFold",label:b("gotoNextFold.label","Go to Next Folding Range"),alias:"Go to Next Folding Range",precondition:mr,kbOpts:{kbExpr:z.editorTextFocus,weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);if(n.length>0){const r=jXe(n[0],t);r!==null&&i.setSelection({startLineNumber:r,startColumn:1,endLineNumber:r,endColumn:1})}}}class yZe extends Rr{constructor(){super({id:"editor.createFoldingRangeFromSelection",label:b("createManualFoldRange.label","Create Folding Range from Selection"),alias:"Create Folding Range from Selection",precondition:mr,kbOpts:{kbExpr:z.editorTextFocus,primary:ns(2089,2135),weight:100}})}invoke(e,t,i){var o;const n=[],r=i.getSelections();if(r){for(const a of r){let l=a.endLineNumber;a.endColumn===1&&--l,l>a.startLineNumber&&(n.push({startLineNumber:a.startLineNumber,endLineNumber:l,type:void 0,isCollapsed:!0,source:1}),i.setSelection({startLineNumber:a.startLineNumber,startColumn:1,endLineNumber:a.startLineNumber,endColumn:1}))}if(n.length>0){n.sort((l,c)=>l.startLineNumber-c.startLineNumber);const a=gl.sanitizeAndMerge(t.regions,n,(o=i.getModel())==null?void 0:o.getLineCount());t.updatePost(gl.fromFoldRanges(a))}}}}class SZe extends Rr{constructor(){super({id:"editor.removeManualFoldingRanges",label:b("removeManualFoldingRanges.label","Remove Manual Folding Ranges"),alias:"Remove Manual Folding Ranges",precondition:mr,kbOpts:{kbExpr:z.editorTextFocus,primary:ns(2089,2137),weight:100}})}invoke(e,t,i){const n=i.getSelections();if(n){const r=[];for(const o of n){const{startLineNumber:a,endLineNumber:l}=o;r.push(l>=a?{startLineNumber:a,endLineNumber:l}:{endLineNumber:l,startLineNumber:a})}t.removeManualRanges(r),e.triggerFoldingModelChanged()}}}Zt(s_.ID,s_,0);ye(oZe);ye(aZe);ye(lZe);ye(dZe);ye(uZe);ye(_Ze);ye(bZe);ye(hZe);ye(fZe);ye(gZe);ye(pZe);ye(mZe);ye(cZe);ye(vZe);ye(wZe);ye(CZe);ye(yZe);ye(SZe);for(let s=1;s<=7;s++)zAe(new qP({id:qP.ID(s),label:b("foldLevelAction.label","Fold Level {0}",s),alias:`Fold Level ${s}`,precondition:mr,kbOpts:{kbExpr:z.editorTextFocus,primary:ns(2089,2048|21+s),weight:100}}));Gt.registerCommand("_executeFoldingRangeProvider",async function(s,...e){const[t]=e;if(!(t instanceof Je))throw fc();const i=s.get(Be),n=s.get(Gi).getModel(t);if(!n)throw fc();const r=s.get(At);if(!r.getValue("editor.folding",{resource:t}))return[];const o=s.get(bn),a=r.getValue("editor.foldingStrategy",{resource:t}),l={get limit(){return r.getValue("editor.foldingMaximumRegions",{resource:t})},update:(g,p)=>{}},c=new AQ(n,o,l);let d=c;if(a!=="indentation"){const g=s_.getFoldingRangeProviders(i,n);g.length&&(d=new PQ(n,g,()=>{},l,c))}const u=await d.compute(kt.None),h=[];try{if(u)for(let g=0;g<u.length;g++){const p=u.getType(g);h.push({start:u.getStartLineNumber(g),end:u.getEndLineNumber(g),kind:p?Hm.fromValue(p):void 0})}return h}finally{d.dispose()}});class xZe extends Ve{constructor(){super({id:"editor.action.fontZoomIn",label:b("EditorFontZoomIn.label","Increase Editor Font Size"),alias:"Increase Editor Font Size",precondition:void 0})}run(e,t){oc.setZoomLevel(oc.getZoomLevel()+1)}}class LZe extends Ve{constructor(){super({id:"editor.action.fontZoomOut",label:b("EditorFontZoomOut.label","Decrease Editor Font Size"),alias:"Decrease Editor Font Size",precondition:void 0})}run(e,t){oc.setZoomLevel(oc.getZoomLevel()-1)}}class kZe extends Ve{constructor(){super({id:"editor.action.fontZoomReset",label:b("EditorFontZoomReset.label","Reset Editor Font Size"),alias:"Reset Editor Font Size",precondition:void 0})}run(e,t){oc.setZoomLevel(0)}}ye(xZe);ye(LZe);ye(kZe);var xbe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},ok=function(s,e){return function(t,i){e(t,i,s)}},Uy;let KP=(Uy=class{constructor(e,t,i,n){this._editor=e,this._languageFeaturesService=t,this._workerService=i,this._accessibilitySignalService=n,this._disposables=new ce,this._sessionDisposables=new ce,this._disposables.add(t.onTypeFormattingEditProvider.onDidChange(this._update,this)),this._disposables.add(e.onDidChangeModel(()=>this._update())),this._disposables.add(e.onDidChangeModelLanguage(()=>this._update())),this._disposables.add(e.onDidChangeConfiguration(r=>{r.hasChanged(56)&&this._update()})),this._update()}dispose(){this._disposables.dispose(),this._sessionDisposables.dispose()}_update(){if(this._sessionDisposables.clear(),!this._editor.getOption(56)||!this._editor.hasModel())return;const e=this._editor.getModel(),[t]=this._languageFeaturesService.onTypeFormattingEditProvider.ordered(e);if(!t||!t.autoFormatTriggerCharacters)return;const i=new Z2;for(const n of t.autoFormatTriggerCharacters)i.add(n.charCodeAt(0));this._sessionDisposables.add(this._editor.onDidType(n=>{const r=n.charCodeAt(n.length-1);i.has(r)&&this._trigger(String.fromCharCode(r))}))}_trigger(e){if(!this._editor.hasModel()||this._editor.getSelections().length>1||!this._editor.getSelection().isEmpty())return;const t=this._editor.getModel(),i=this._editor.getPosition(),n=new mn,r=this._editor.onDidChangeModelContent(o=>{if(o.isFlush){n.cancel(),r.dispose();return}for(let a=0,l=o.changes.length;a<l;a++)if(o.changes[a].range.endLineNumber<=i.lineNumber){n.cancel(),r.dispose();return}});Eme(this._workerService,this._languageFeaturesService,t,i,e,t.getFormattingOptions(),n.token).then(o=>{n.token.isCancellationRequested||Xr(o)&&(this._accessibilitySignalService.playSignal(fl.format,{userGesture:!1}),M1.execute(this._editor,o,!0))}).finally(()=>{r.dispose()})}},Uy.ID="editor.contrib.autoFormat",Uy);KP=xbe([ok(1,Be),ok(2,ca),ok(3,v_)],KP);var jy;let GP=(jy=class{constructor(e,t,i){this.editor=e,this._languageFeaturesService=t,this._instantiationService=i,this._callOnDispose=new ce,this._callOnModel=new ce,this._callOnDispose.add(e.onDidChangeConfiguration(()=>this._update())),this._callOnDispose.add(e.onDidChangeModel(()=>this._update())),this._callOnDispose.add(e.onDidChangeModelLanguage(()=>this._update())),this._callOnDispose.add(t.documentRangeFormattingEditProvider.onDidChange(this._update,this))}dispose(){this._callOnDispose.dispose(),this._callOnModel.dispose()}_update(){this._callOnModel.clear(),this.editor.getOption(55)&&this.editor.hasModel()&&this._languageFeaturesService.documentRangeFormattingEditProvider.has(this.editor.getModel())&&this._callOnModel.add(this.editor.onDidPaste(({range:e})=>this._trigger(e)))}_trigger(e){this.editor.hasModel()&&(this.editor.getSelections().length>1||this._instantiationService.invokeFunction(Ime,this.editor,e,2,Zd.None,kt.None,!1).catch(ft))}},jy.ID="editor.contrib.formatOnPaste",jy);GP=xbe([ok(1,Be),ok(2,Xe)],GP);class IZe extends Ve{constructor(){super({id:"editor.action.formatDocument",label:b("formatDocument.label","Format Document"),alias:"Format Document",precondition:he.and(z.notInCompositeEditor,z.writable,z.hasDocumentFormattingProvider),kbOpts:{kbExpr:z.editorTextFocus,primary:1572,linux:{primary:3111},weight:100},contextMenuOpts:{group:"1_modification",order:1.3}})}async run(e,t){if(t.hasModel()){const i=e.get(Xe);await e.get(m_).showWhile(i.invokeFunction(Mqe,t,1,Zd.None,kt.None,!0),250)}}}class EZe extends Ve{constructor(){super({id:"editor.action.formatSelection",label:b("formatSelection.label","Format Selection"),alias:"Format Selection",precondition:he.and(z.writable,z.hasDocumentSelectionFormattingProvider),kbOpts:{kbExpr:z.editorTextFocus,primary:ns(2089,2084),weight:100},contextMenuOpts:{when:z.hasNonEmptySelection,group:"1_modification",order:1.31}})}async run(e,t){if(!t.hasModel())return;const i=e.get(Xe),n=t.getModel(),r=t.getSelections().map(a=>a.isEmpty()?new F(a.startLineNumber,1,a.startLineNumber,n.getLineMaxColumn(a.startLineNumber)):a);await e.get(m_).showWhile(i.invokeFunction(Ime,t,r,1,Zd.None,kt.None,!0),250)}}Zt(KP.ID,KP,2);Zt(GP.ID,GP,2);ye(IZe);ye(EZe);Gt.registerCommand("editor.action.format",async s=>{const e=s.get(ni).getFocusedCodeEditor();if(!e||!e.hasModel())return;const t=s.get(Hi);e.getSelection().isEmpty()?await t.executeCommand("editor.action.formatDocument"):await t.executeCommand("editor.action.formatSelection")});var DZe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},RB=function(s,e){return function(t,i){e(t,i,s)}};class zC{remove(){var e;(e=this.parent)==null||e.children.delete(this.id)}static findId(e,t){let i;typeof e=="string"?i=`${t.id}/${e}`:(i=`${t.id}/${e.name}`,t.children.get(i)!==void 0&&(i=`${t.id}/${e.name}_${e.range.startLineNumber}_${e.range.startColumn}`));let n=i;for(let r=0;t.children.get(n)!==void 0;r++)n=`${i}_${r}`;return n}static empty(e){return e.children.size===0}}class pU extends zC{constructor(e,t,i){super(),this.id=e,this.parent=t,this.symbol=i,this.children=new Map}}class Lbe extends zC{constructor(e,t,i,n){super(),this.id=e,this.parent=t,this.label=i,this.order=n,this.children=new Map}}class Rf extends zC{static create(e,t,i){const n=new mn(i),r=new Rf(t.uri),o=e.ordered(t),a=o.map((c,d)=>{const u=zC.findId(`provider_${d}`,r),h=new Lbe(u,r,c.displayName??"Unknown Outline Provider",d);return Promise.resolve(c.provideDocumentSymbols(t,n.token)).then(g=>{for(const p of g||[])Rf._makeOutlineElement(p,h);return h},g=>(Mn(g),h)).then(g=>{zC.empty(g)?g.remove():r._groups.set(u,g)})}),l=e.onDidChange(()=>{const c=e.ordered(t);dn(c,o)||n.cancel()});return Promise.all(a).then(()=>n.token.isCancellationRequested&&!i.isCancellationRequested?Rf.create(e,t,i):r._compact()).finally(()=>{n.dispose(),l.dispose(),n.dispose()})}static _makeOutlineElement(e,t){const i=zC.findId(e,t),n=new pU(i,t,e);if(e.children)for(const r of e.children)Rf._makeOutlineElement(r,n);t.children.set(n.id,n)}constructor(e){super(),this.uri=e,this.id="root",this.parent=void 0,this._groups=new Map,this.children=new Map,this.id="root",this.parent=void 0}_compact(){let e=0;for(const[t,i]of this._groups)i.children.size===0?this._groups.delete(t):e+=1;if(e!==1)this.children=this._groups;else{const t=Kt.first(this._groups.values());for(const[,i]of t.children)i.parent=this,this.children.set(i.id,i)}return this}getTopLevelSymbols(){const e=[];for(const t of this.children.values())t instanceof pU?e.push(t.symbol):e.push(...Kt.map(t.children.values(),i=>i.symbol));return e.sort((t,i)=>F.compareRangesUsingStarts(t.range,i.range))}asListOfDocumentSymbols(){const e=this.getTopLevelSymbols(),t=[];return Rf._flattenDocumentSymbols(t,e,""),t.sort((i,n)=>X.compare(F.getStartPosition(i.range),F.getStartPosition(n.range))||X.compare(F.getEndPosition(n.range),F.getEndPosition(i.range)))}static _flattenDocumentSymbols(e,t,i){for(const n of t)e.push({kind:n.kind,tags:n.tags,name:n.name,detail:n.detail,containerName:n.containerName||i,range:n.range,selectionRange:n.selectionRange,children:void 0}),n.children&&Rf._flattenDocumentSymbols(e,n.children,n.name)}}const SD=Ht("IOutlineModelService");let mU=class{constructor(e,t,i){this._languageFeaturesService=e,this._disposables=new ce,this._cache=new $h(10,.7),this._debounceInformation=t.for(e.documentSymbolProvider,"DocumentSymbols",{min:350}),this._disposables.add(i.onModelRemoved(n=>{this._cache.delete(n.id)}))}dispose(){this._disposables.dispose()}async getOrCreate(e,t){const i=this._languageFeaturesService.documentSymbolProvider,n=i.ordered(e);let r=this._cache.get(e.id);if(!r||r.versionId!==e.getVersionId()||!dn(r.provider,n)){const a=new mn;r={versionId:e.getVersionId(),provider:n,promiseCnt:0,source:a,promise:Rf.create(i,e,a.token),model:void 0},this._cache.set(e.id,r);const l=Date.now();r.promise.then(c=>{r.model=c,this._debounceInformation.update(e,Date.now()-l)}).catch(c=>{this._cache.delete(e.id)})}if(r.model)return r.model;r.promiseCnt+=1;const o=t.onCancellationRequested(()=>{--r.promiseCnt===0&&(r.source.cancel(),this._cache.delete(e.id))});try{return await r.promise}finally{o.dispose()}}};mU=DZe([RB(0,Be),RB(1,Fl),RB(2,Gi)],mU);qt(SD,mU,1);Gt.registerCommand("_executeDocumentSymbolProvider",async function(s,...e){const[t]=e;ii(Je.isUri(t));const i=s.get(SD),r=await s.get(oa).createModelReference(t);try{return(await i.getOrCreate(r.object.textEditorModel,kt.None)).getTopLevelSymbols()}finally{r.dispose()}});const Zu=class Zu extends te{constructor(e,t){super(),this.contextKeyService=e,this.model=t,this.inlineCompletionVisible=Zu.inlineSuggestionVisible.bindTo(this.contextKeyService),this.inlineCompletionSuggestsIndentation=Zu.inlineSuggestionHasIndentation.bindTo(this.contextKeyService),this.inlineCompletionSuggestsIndentationLessThanTabSize=Zu.inlineSuggestionHasIndentationLessThanTabSize.bindTo(this.contextKeyService),this.suppressSuggestions=Zu.suppressSuggestions.bindTo(this.contextKeyService),this._register(ht(i=>{const n=this.model.read(i),r=n==null?void 0:n.state.read(i),o=!!(r!=null&&r.inlineCompletion)&&(r==null?void 0:r.primaryGhostText)!==void 0&&!(r!=null&&r.primaryGhostText.isEmpty());this.inlineCompletionVisible.set(o),r!=null&&r.primaryGhostText&&(r!=null&&r.inlineCompletion)&&this.suppressSuggestions.set(r.inlineCompletion.inlineCompletion.source.inlineCompletions.suppressSuggestions)})),this._register(ht(i=>{const n=this.model.read(i);let r=!1,o=!0;const a=n==null?void 0:n.primaryGhostText.read(i);if(n!=null&&n.selectedSuggestItem&&a&&a.parts.length>0){const{column:l,lines:c}=a.parts[0],d=c[0],u=n.textModel.getLineIndentColumn(a.lineNumber);if(l<=u){let g=Zr(d);g===-1&&(g=d.length-1),r=g>0;const p=n.textModel.getOptions().tabSize;o=hs.visibleColumnFromColumn(d,g+1,p)<p}}this.inlineCompletionSuggestsIndentation.set(r),this.inlineCompletionSuggestsIndentationLessThanTabSize.set(o)}))}};Zu.inlineSuggestionVisible=new Oe("inlineSuggestionVisible",!1,b("inlineSuggestionVisible","Whether an inline suggestion is visible")),Zu.inlineSuggestionHasIndentation=new Oe("inlineSuggestionHasIndentation",!1,b("inlineSuggestionHasIndentation","Whether the inline suggestion starts with whitespace")),Zu.inlineSuggestionHasIndentationLessThanTabSize=new Oe("inlineSuggestionHasIndentationLessThanTabSize",!0,b("inlineSuggestionHasIndentationLessThanTabSize","Whether the inline suggestion starts with whitespace that is less than what would be inserted by tab")),Zu.suppressSuggestions=new Oe("inlineSuggestionSuppressSuggestions",void 0,b("suppressSuggestions","Whether suggestions should be suppressed for the current suggestion"));let Ma=Zu;function TZe(s){const e=new ce,t=e.add(ihe());return e.add(ht(i=>{t.setStyle(s.read(i))})),e}class cE{constructor(e,t){this.lineNumber=e,this.parts=t}equals(e){return this.lineNumber===e.lineNumber&&this.parts.length===e.parts.length&&this.parts.every((t,i)=>t.equals(e.parts[i]))}renderForScreenReader(e){if(this.parts.length===0)return"";const t=this.parts[this.parts.length-1],i=e.substr(0,t.column-1);return new Jq([...this.parts.map(r=>new Rh(F.fromPositions(new X(1,r.column)),r.lines.join(`
`)))]).applyToString(i).substring(this.parts[0].column-1)}isEmpty(){return this.parts.every(e=>e.lines.length===0)}get lineCount(){return 1+this.parts.reduce((e,t)=>e+t.lines.length-1,0)}}class QP{constructor(e,t,i){this.column=e,this.text=t,this.preview=i,this.lines=Uh(this.text)}equals(e){return this.column===e.column&&this.lines.length===e.lines.length&&this.lines.every((t,i)=>t===e.lines[i])}}class _U{constructor(e,t,i,n=0){this.lineNumber=e,this.columnRange=t,this.text=i,this.additionalReservedLineCount=n,this.parts=[new QP(this.columnRange.endColumnExclusive,this.text,!1)],this.newLines=Uh(this.text)}renderForScreenReader(e){return this.newLines.join(`
`)}get lineCount(){return this.newLines.length}isEmpty(){return this.parts.every(e=>e.lines.length===0)}equals(e){return this.lineNumber===e.lineNumber&&this.columnRange.equals(e.columnRange)&&this.newLines.length===e.newLines.length&&this.newLines.every((t,i)=>t===e.newLines[i])&&this.additionalReservedLineCount===e.additionalReservedLineCount}}function goe(s,e){return dn(s,e,kbe)}function kbe(s,e){return s===e?!0:!s||!e?!1:s instanceof cE&&e instanceof cE||s instanceof _U&&e instanceof _U?s.equals(e):!1}const NZe=[];function RZe(){return NZe}class Ibe{constructor(e,t){if(this.startColumn=e,this.endColumnExclusive=t,e>t)throw new di(`startColumn ${e} cannot be after endColumnExclusive ${t}`)}toRange(e){return new F(e,this.startColumn,e,this.endColumnExclusive)}equals(e){return this.startColumn===e.startColumn&&this.endColumnExclusive===e.endColumnExclusive}}function Ebe(s,e){const t=new ce,i=s.createDecorationsCollection();return t.add(tD({debugName:()=>`Apply decorations from ${e.debugName}`},n=>{const r=e.read(n);i.set(r)})),t.add({dispose:()=>{i.clear()}}),t}function AZe(s,e){return new X(s.lineNumber+e.lineNumber-1,e.lineNumber===1?s.column+e.column-1:e.column)}function poe(s,e){return new X(s.lineNumber-e.lineNumber+1,s.lineNumber-e.lineNumber===0?s.column-e.column+1:s.column)}var PZe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},MZe=function(s,e){return function(t,i){e(t,i,s)}};const moe="ghost-text";let bU=class extends te{constructor(e,t,i){super(),this.editor=e,this.model=t,this.languageService=i,this.isDisposed=Rt(this,!1),this.currentTextModel=wi(this,this.editor.onDidChangeModel,()=>this.editor.getModel()),this.uiState=qe(this,n=>{if(this.isDisposed.read(n))return;const r=this.currentTextModel.read(n);if(r!==this.model.targetTextModel.read(n))return;const o=this.model.ghostText.read(n);if(!o)return;const a=o instanceof _U?o.columnRange:void 0,l=[],c=[];function d(_,v){if(c.length>0){const C=c[c.length-1];v&&C.decorations.push(new vo(C.content.length+1,C.content.length+1+_[0].length,v,0)),C.content+=_[0],_=_.slice(1)}for(const C of _)c.push({content:C,decorations:v?[new vo(1,C.length+1,v,0)]:[]})}const u=r.getLineContent(o.lineNumber);let h,g=0;for(const _ of o.parts){let v=_.lines;h===void 0?(l.push({column:_.column,text:v[0],preview:_.preview}),v=v.slice(1)):d([u.substring(g,_.column-1)],void 0),v.length>0&&(d(v,moe),h===void 0&&_.column<=u.length&&(h=_.column)),g=_.column-1}h!==void 0&&d([u.substring(g)],void 0);const p=h!==void 0?new Ibe(h,u.length+1):void 0;return{replacedRange:a,inlineTexts:l,additionalLines:c,hiddenRange:p,lineNumber:o.lineNumber,additionalReservedLineCount:this.model.minReservedLineCount.read(n),targetTextModel:r}}),this.decorations=qe(this,n=>{const r=this.uiState.read(n);if(!r)return[];const o=[];r.replacedRange&&o.push({range:r.replacedRange.toRange(r.lineNumber),options:{inlineClassName:"inline-completion-text-to-replace",description:"GhostTextReplacement"}}),r.hiddenRange&&o.push({range:r.hiddenRange.toRange(r.lineNumber),options:{inlineClassName:"ghost-text-hidden",description:"ghost-text-hidden"}});for(const a of r.inlineTexts)o.push({range:F.fromPositions(new X(r.lineNumber,a.column)),options:{description:moe,after:{content:a.text,inlineClassName:a.preview?"ghost-text-decoration-preview":"ghost-text-decoration",cursorStops:Zc.Left},showIfCollapsed:!0}});return o}),this.additionalLinesWidget=this._register(new OZe(this.editor,this.languageService.languageIdCodec,qe(n=>{const r=this.uiState.read(n);return r?{lineNumber:r.lineNumber,additionalLines:r.additionalLines,minReservedLineCount:r.additionalReservedLineCount,targetTextModel:r.targetTextModel}:void 0}))),this._register(Ye(()=>{this.isDisposed.set(!0,void 0)})),this._register(Ebe(this.editor,this.decorations))}ownsViewZone(e){return this.additionalLinesWidget.viewZoneId===e}};bU=PZe([MZe(2,un)],bU);class OZe extends te{get viewZoneId(){return this._viewZoneId}constructor(e,t,i){super(),this.editor=e,this.languageIdCodec=t,this.lines=i,this._viewZoneId=void 0,this.editorOptionsChanged=cr("editorOptionChanged",De.filter(this.editor.onDidChangeConfiguration,n=>n.hasChanged(33)||n.hasChanged(118)||n.hasChanged(100)||n.hasChanged(95)||n.hasChanged(51)||n.hasChanged(50)||n.hasChanged(67))),this._register(ht(n=>{const r=this.lines.read(n);this.editorOptionsChanged.read(n),r?this.updateLines(r.lineNumber,r.additionalLines,r.minReservedLineCount):this.clear()}))}dispose(){super.dispose(),this.clear()}clear(){this.editor.changeViewZones(e=>{this._viewZoneId&&(e.removeZone(this._viewZoneId),this._viewZoneId=void 0)})}updateLines(e,t,i){const n=this.editor.getModel();if(!n)return;const{tabSize:r}=n.getOptions();this.editor.changeViewZones(o=>{this._viewZoneId&&(o.removeZone(this._viewZoneId),this._viewZoneId=void 0);const a=Math.max(t.length,i);if(a>0){const l=document.createElement("div");FZe(l,r,t,this.editor.getOptions(),this.languageIdCodec),this._viewZoneId=o.addZone({afterLineNumber:e,heightInLines:a,domNode:l,afterColumnAffinity:1})}})}}function FZe(s,e,t,i,n){const r=i.get(33),o=i.get(118),a="none",l=i.get(95),c=i.get(51),d=i.get(50),u=i.get(67),h=new hS(1e4);h.appendString('<div class="suggest-preview-text">');for(let _=0,v=t.length;_<v;_++){const C=t[_],y=C.content;h.appendString('<div class="view-line'),h.appendString('" style="top:'),h.appendString(String(_*u)),h.appendString('px;width:1000000px;">');const x=zE(y),L=h1(y),I=Ws.createEmpty(y,n);dD(new w_(d.isMonospace&&!r,d.canUseHalfwidthRightwardsArrow,y,!1,x,L,0,I,C.decorations,e,0,d.spaceWidth,d.middotWidth,d.wsmiddotWidth,o,a,l,c!==Bm.OFF,null),h),h.appendString("</div>")}h.appendString("</div>"),Zs(s,d);const g=h.build(),p=_oe?_oe.createHTML(g):g;s.innerHTML=p}const _oe=Og("editorGhostText",{createHTML:s=>s});function VZe(s,e){const t=new xge,i=new kge(t,c=>e.getLanguageConfiguration(c)),n=new Lge(new BZe([s]),i),r=L8(n,[],void 0,!0);let o="";const a=s.getLineContent();function l(c,d){if(c.kind===2)if(l(c.openingBracket,d),d=En(d,c.openingBracket.length),c.child&&(l(c.child,d),d=En(d,c.child.length)),c.closingBracket)l(c.closingBracket,d),d=En(d,c.closingBracket.length);else{const h=i.getSingleLanguageBracketTokens(c.openingBracket.languageId).findClosingTokenText(c.openingBracket.bracketIds);o+=h}else if(c.kind!==3){if(c.kind===0||c.kind===1)o+=a.substring(d,En(d,c.length));else if(c.kind===4)for(const u of c.children)l(u,d),d=En(d,u.length)}}return l(r,bo),o}class BZe{constructor(e){this.lines=e,this.tokenization={getLineTokens:t=>this.lines[t-1]}}getLineCount(){return this.lines.length}getLineLength(e){return this.lines[e-1].getLineContent().length}}async function Dbe(s,e,t,i,n=kt.None,r){const o=e instanceof X?zZe(e,t):e,a=s.all(t),l=new Gq;for(const C of a)C.groupId&&l.add(C.groupId,C);function c(C){if(!C.yieldsToGroupIds)return[];const y=[];for(const x of C.yieldsToGroupIds||[]){const L=l.get(x);for(const I of L)y.push(I)}return y}const d=new Map,u=new Set;function h(C,y){if(y=[...y,C],u.has(C))return y;u.add(C);try{const x=c(C);for(const L of x){const I=h(L,y);if(I)return I}}finally{u.delete(C)}}function g(C){const y=d.get(C);if(y)return y;const x=h(C,[]);x&&Mn(new Error(`Inline completions: cyclic yield-to dependency detected. Path: ${x.map(I=>I.toString?I.toString():""+I).join(" -> ")}`));const L=new lS;return d.set(C,L.p),(async()=>{var I;if(!x){const A=c(C);for(const D of A){const N=await g(D);if(N&&N.items.length>0)return}}try{return e instanceof X?await C.provideInlineCompletions(t,e,i,n):await((I=C.provideInlineEdits)==null?void 0:I.call(C,t,e,i,n))}catch(A){Mn(A);return}})().then(I=>L.complete(I),I=>L.error(I)),L.p}const p=await Promise.all(a.map(async C=>({provider:C,completions:await g(C)}))),_=new Map,v=[];for(const C of p){const y=C.completions;if(!y)continue;const x=new HZe(y,C.provider);v.push(x);for(const L of y.items){const I=YP.from(L,x,o,t,r);_.set(I.hash(),I)}}return new WZe(Array.from(_.values()),new Set(_.keys()),v)}class WZe{constructor(e,t,i){this.completions=e,this.hashs=t,this.providerResults=i}has(e){return this.hashs.has(e.hash())}dispose(){for(const e of this.providerResults)e.removeRef()}}class HZe{constructor(e,t){this.inlineCompletions=e,this.provider=t,this.refCount=1}addRef(){this.refCount++}removeRef(){this.refCount--,this.refCount===0&&this.provider.freeInlineCompletions(this.inlineCompletions)}}class YP{static from(e,t,i,n,r){let o,a,l=e.range?F.lift(e.range):i;if(typeof e.insertText=="string"){if(o=e.insertText,r&&e.completeBracketPairs){o=boe(o,l.getStartPosition(),n,r);const c=o.length-e.insertText.length;c!==0&&(l=new F(l.startLineNumber,l.startColumn,l.endLineNumber,l.endColumn+c))}a=void 0}else if("snippet"in e.insertText){const c=e.insertText.snippet.length;if(r&&e.completeBracketPairs){e.insertText.snippet=boe(e.insertText.snippet,l.getStartPosition(),n,r);const u=e.insertText.snippet.length-c;u!==0&&(l=new F(l.startLineNumber,l.startColumn,l.endLineNumber,l.endColumn+u))}const d=new Lw().parse(e.insertText.snippet);d.children.length===1&&d.children[0]instanceof po?(o=d.children[0].value,a=void 0):(o=d.toString(),a={snippet:e.insertText.snippet,range:l})}else gF(e.insertText);return new YP(o,e.command,l,o,a,e.additionalTextEdits||RZe(),e,t)}constructor(e,t,i,n,r,o,a,l){this.filterText=e,this.command=t,this.range=i,this.insertText=n,this.snippetInfo=r,this.additionalTextEdits=o,this.sourceInlineCompletion=a,this.source=l,e=e.replace(/\r\n|\r/g,`
`),n=e.replace(/\r\n|\r/g,`
`)}withRange(e){return new YP(this.filterText,this.command,e,this.insertText,this.snippetInfo,this.additionalTextEdits,this.sourceInlineCompletion,this.source)}hash(){return JSON.stringify({insertText:this.insertText,range:this.range.toString()})}toSingleTextEdit(){return new Rh(this.range,this.insertText)}}function zZe(s,e){const t=e.getWordAtPosition(s),i=e.getLineMaxColumn(s.lineNumber);return t?new F(s.lineNumber,t.startColumn,s.lineNumber,i):F.fromPositions(s,s.with(void 0,i))}function boe(s,e,t,i){const r=t.getLineContent(e.lineNumber).substring(0,e.column-1)+s,o=t.tokenization.tokenizeLineWithEdit(e,r.length-(e.column-1),s),a=o==null?void 0:o.sliceAndInflate(e.column-1,r.length,0);return a?VZe(a,i):s}function rv(s,e,t){const i=t?s.range.intersectRanges(t):s.range;if(!i)return s;const n=e.getValueInRange(i,1),r=zm(n,s.text),o=cd.ofText(n.substring(0,r)).addToPosition(s.range.getStartPosition()),a=s.text.substring(r),l=F.fromPositions(o,s.range.getEndPosition());return new Rh(l,a)}function Tbe(s,e){return s.text.startsWith(e.text)&&UZe(s.range,e.range)}function voe(s,e,t,i,n=0){let r=rv(s,e);if(r.range.endLineNumber!==r.range.startLineNumber)return;const o=e.getLineContent(r.range.startLineNumber),a=Ti(o).length;if(r.range.startColumn-1<=a){const p=Ti(r.text).length,_=o.substring(r.range.startColumn-1,a),[v,C]=[r.range.getStartPosition(),r.range.getEndPosition()],y=v.column+_.length<=C.column?v.delta(0,_.length):C,x=F.fromPositions(y,C),L=r.text.startsWith(_)?r.text.substring(_.length):r.text.substring(p);r=new Rh(x,L)}const c=e.getValueInRange(r.range),d=jZe(c,r.text);if(!d)return;const u=r.range.startLineNumber,h=new Array;if(t==="prefix"){const p=d.filter(_=>_.originalLength===0);if(p.length>1||p.length===1&&p[0].originalStart!==c.length)return}const g=r.text.length-n;for(const p of d){const _=r.range.startColumn+p.originalStart+p.originalLength;if(t==="subwordSmart"&&i&&i.lineNumber===r.range.startLineNumber&&_<i.column||p.originalLength>0)return;if(p.modifiedLength===0)continue;const v=p.modifiedStart+p.modifiedLength,C=Math.max(p.modifiedStart,Math.min(v,g)),y=r.text.substring(p.modifiedStart,C),x=r.text.substring(C,Math.max(p.modifiedStart,v));y.length>0&&h.push(new QP(_,y,!1)),x.length>0&&h.push(new QP(_,x,!0))}return new cE(u,h)}function UZe(s,e){return e.getStartPosition().equals(s.getStartPosition())&&e.getEndPosition().isBeforeOrEqual(s.getEndPosition())}let zu;function jZe(s,e){if((zu==null?void 0:zu.originalValue)===s&&(zu==null?void 0:zu.newValue)===e)return zu==null?void 0:zu.changes;{let t=Coe(s,e,!0);if(t){const i=woe(t);if(i>0){const n=Coe(s,e,!1);n&&woe(n)<i&&(t=n)}}return zu={originalValue:s,newValue:e,changes:t},t}}function woe(s){let e=0;for(const t of s)e+=t.originalLength;return e}function Coe(s,e,t){if(s.length>5e3||e.length>5e3)return;function i(c){let d=0;for(let u=0,h=c.length;u<h;u++){const g=c.charCodeAt(u);g>d&&(d=g)}return d}const n=Math.max(i(s),i(e));function r(c){if(c<0)throw new Error("unexpected");return n+c+1}function o(c){let d=0,u=0;const h=new Int32Array(c.length);for(let g=0,p=c.length;g<p;g++)if(t&&c[g]==="("){const _=u*100+d;h[g]=r(2*_),d++}else if(t&&c[g]===")"){d=Math.max(d-1,0);const _=u*100+d;h[g]=r(2*_+1),d===0&&u++}else h[g]=c.charCodeAt(g);return h}const a=o(s),l=o(e);return new ch({getElements:()=>a},{getElements:()=>l}).ComputeDiff(!1).changes}var $Ze=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},yoe=function(s,e){return function(t,i){e(t,i,s)}};let vU=class extends te{constructor(e,t,i,n,r){super(),this.textModel=e,this.versionId=t,this._debounceValue=i,this.languageFeaturesService=n,this.languageConfigurationService=r,this._updateOperation=this._register(new Es),this.inlineCompletions=SI("inlineCompletions",void 0),this.suggestWidgetInlineCompletions=SI("suggestWidgetInlineCompletions",void 0),this._register(this.textModel.onDidChangeContent(()=>{this._updateOperation.clear()}))}fetch(e,t,i){var d,u;const n=new KZe(e,t,this.textModel.getVersionId()),r=t.selectedSuggestionInfo?this.suggestWidgetInlineCompletions:this.inlineCompletions;if((d=this._updateOperation.value)!=null&&d.request.satisfies(n))return this._updateOperation.value.promise;if((u=r.get())!=null&&u.request.satisfies(n))return Promise.resolve(!0);const o=!!this._updateOperation.value;this._updateOperation.clear();const a=new mn,l=(async()=>{if((o||t.triggerKind===iu.Automatic)&&await qZe(this._debounceValue.get(this.textModel),a.token),a.token.isCancellationRequested||this._store.isDisposed||this.textModel.getVersionId()!==n.versionId)return!1;const g=new Date,p=await Dbe(this.languageFeaturesService.inlineCompletionsProvider,e,this.textModel,t,a.token,this.languageConfigurationService);if(a.token.isCancellationRequested||this._store.isDisposed||this.textModel.getVersionId()!==n.versionId)return!1;const _=new Date;this._debounceValue.update(this.textModel,_.getTime()-g.getTime());const v=new QZe(p,n,this.textModel,this.versionId);if(i){const C=i.toInlineCompletion(void 0);i.canBeReused(this.textModel,e)&&!p.has(C)&&v.prepend(i.inlineCompletion,C.range,!0)}return this._updateOperation.clear(),pn(C=>{r.set(v,C)}),!0})(),c=new GZe(n,a,l);return this._updateOperation.value=c,l}clear(e){this._updateOperation.clear(),this.inlineCompletions.set(void 0,e),this.suggestWidgetInlineCompletions.set(void 0,e)}clearSuggestWidgetInlineCompletions(e){var t;(t=this._updateOperation.value)!=null&&t.request.context.selectedSuggestionInfo&&this._updateOperation.clear(),this.suggestWidgetInlineCompletions.set(void 0,e)}cancelUpdate(){this._updateOperation.clear()}};vU=$Ze([yoe(3,Be),yoe(4,bn)],vU);function qZe(s,e){return new Promise(t=>{let i;const n=setTimeout(()=>{i&&i.dispose(),t()},s);e&&(i=e.onCancellationRequested(()=>{clearTimeout(n),i&&i.dispose(),t()}))})}class KZe{constructor(e,t,i){this.position=e,this.context=t,this.versionId=i}satisfies(e){return this.position.equals(e.position)&&r8(this.context.selectedSuggestionInfo,e.context.selectedSuggestionInfo,G3e())&&(e.context.triggerKind===iu.Automatic||this.context.triggerKind===iu.Explicit)&&this.versionId===e.versionId}}class GZe{constructor(e,t,i){this.request=e,this.cancellationTokenSource=t,this.promise=i}dispose(){this.cancellationTokenSource.cancel()}}class QZe{get inlineCompletions(){return this._inlineCompletions}constructor(e,t,i,n){this.inlineCompletionProviderResult=e,this.request=t,this._textModel=i,this._versionId=n,this._refCount=1,this._prependedInlineCompletionItems=[];const r=i.deltaDecorations([],e.completions.map(o=>({range:o.range,options:{description:"inline-completion-tracking-range"}})));this._inlineCompletions=e.completions.map((o,a)=>new Soe(o,r[a],this._textModel,this._versionId))}clone(){return this._refCount++,this}dispose(){if(this._refCount--,this._refCount===0){setTimeout(()=>{this._textModel.isDisposed()||this._textModel.deltaDecorations(this._inlineCompletions.map(e=>e.decorationId),[])},0),this.inlineCompletionProviderResult.dispose();for(const e of this._prependedInlineCompletionItems)e.source.removeRef()}}prepend(e,t,i){i&&e.source.addRef();const n=this._textModel.deltaDecorations([],[{range:t,options:{description:"inline-completion-tracking-range"}}])[0];this._inlineCompletions.unshift(new Soe(e,n,this._textModel,this._versionId)),this._prependedInlineCompletionItems.push(e)}}class Soe{get forwardStable(){return this.inlineCompletion.source.inlineCompletions.enableForwardStability??!1}constructor(e,t,i,n){this.inlineCompletion=e,this.decorationId=t,this._textModel=i,this._modelVersion=n,this.semanticId=JSON.stringify([this.inlineCompletion.filterText,this.inlineCompletion.insertText,this.inlineCompletion.range.getStartPosition().toString()]),this._updatedRange=_l({owner:this,equalsFn:F.equalsRange},r=>(this._modelVersion.read(r),this._textModel.getDecorationRange(this.decorationId)))}toInlineCompletion(e){return this.inlineCompletion.withRange(this._updatedRange.read(e)??AB)}toSingleTextEdit(e){return new Rh(this._updatedRange.read(e)??AB,this.inlineCompletion.insertText)}isVisible(e,t,i){const n=rv(this._toFilterTextReplacement(i),e),r=this._updatedRange.read(i);if(!r||!this.inlineCompletion.range.getStartPosition().equals(r.getStartPosition())||t.lineNumber!==n.range.startLineNumber)return!1;const o=e.getValueInRange(n.range,1),a=n.text,l=Math.max(0,t.column-n.range.startColumn);let c=a.substring(0,l),d=a.substring(l),u=o.substring(0,l),h=o.substring(l);const g=e.getLineIndentColumn(n.range.startLineNumber);return n.range.startColumn<=g&&(u=u.trimStart(),u.length===0&&(h=h.trimStart()),c=c.trimStart(),c.length===0&&(d=d.trimStart())),c.startsWith(u)&&!!Tfe(h,d)}canBeReused(e,t){const i=this._updatedRange.read(void 0);return!!i&&i.containsPosition(t)&&this.isVisible(e,t,void 0)&&cd.ofRange(i).isGreaterThanOrEqualTo(cd.ofRange(this.inlineCompletion.range))}_toFilterTextReplacement(e){return new Rh(this._updatedRange.read(e)??AB,this.inlineCompletion.filterText)}}const AB=new F(1,1,1,1),Dt={Visible:EQ,HasFocusedSuggestion:new Oe("suggestWidgetHasFocusedSuggestion",!1,b("suggestWidgetHasSelection","Whether any suggestion is focused")),DetailsVisible:new Oe("suggestWidgetDetailsVisible",!1,b("suggestWidgetDetailsVisible","Whether suggestion details are visible")),MultipleSuggestions:new Oe("suggestWidgetMultipleSuggestions",!1,b("suggestWidgetMultipleSuggestions","Whether there are multiple suggestions to pick from")),MakesTextEdit:new Oe("suggestionMakesTextEdit",!0,b("suggestionMakesTextEdit","Whether inserting the current suggestion yields in a change or has everything already been typed")),AcceptSuggestionsOnEnter:new Oe("acceptSuggestionOnEnter",!0,b("acceptSuggestionOnEnter","Whether suggestions are inserted when pressing Enter")),HasInsertAndReplaceRange:new Oe("suggestionHasInsertAndReplaceRange",!1,b("suggestionHasInsertAndReplaceRange","Whether the current suggestion has insert and replace behaviour")),InsertMode:new Oe("suggestionInsertMode",void 0,{type:"string",description:b("suggestionInsertMode","Whether the default behaviour is to insert or replace")}),CanResolve:new Oe("suggestionCanResolve",!1,b("suggestionCanResolve","Whether the current suggestion supports to resolve further details"))},gm=new ze("suggestWidgetStatusBar");class YZe{constructor(e,t,i,n){var r;this.position=e,this.completion=t,this.container=i,this.provider=n,this.isInvalid=!1,this.score=ou.Default,this.distance=0,this.textLabel=typeof t.label=="string"?t.label:(r=t.label)==null?void 0:r.label,this.labelLow=this.textLabel.toLowerCase(),this.isInvalid=!this.textLabel,this.sortTextLow=t.sortText&&t.sortText.toLowerCase(),this.filterTextLow=t.filterText&&t.filterText.toLowerCase(),this.extensionId=t.extensionId,F.isIRange(t.range)?(this.editStart=new X(t.range.startLineNumber,t.range.startColumn),this.editInsertEnd=new X(t.range.endLineNumber,t.range.endColumn),this.editReplaceEnd=new X(t.range.endLineNumber,t.range.endColumn),this.isInvalid=this.isInvalid||F.spansMultipleLines(t.range)||t.range.startLineNumber!==e.lineNumber):(this.editStart=new X(t.range.insert.startLineNumber,t.range.insert.startColumn),this.editInsertEnd=new X(t.range.insert.endLineNumber,t.range.insert.endColumn),this.editReplaceEnd=new X(t.range.replace.endLineNumber,t.range.replace.endColumn),this.isInvalid=this.isInvalid||F.spansMultipleLines(t.range.insert)||F.spansMultipleLines(t.range.replace)||t.range.insert.startLineNumber!==e.lineNumber||t.range.replace.startLineNumber!==e.lineNumber||t.range.insert.startColumn!==t.range.replace.startColumn),typeof n.resolveCompletionItem!="function"&&(this._resolveCache=Promise.resolve(),this._resolveDuration=0)}get isResolved(){return this._resolveDuration!==void 0}get resolveDuration(){return this._resolveDuration!==void 0?this._resolveDuration:-1}async resolve(e){if(!this._resolveCache){const t=e.onCancellationRequested(()=>{this._resolveCache=void 0,this._resolveDuration=void 0}),i=new Bs(!0);this._resolveCache=Promise.resolve(this.provider.resolveCompletionItem(this.completion,e)).then(n=>{Object.assign(this.completion,n),this._resolveDuration=i.elapsed()},n=>{xc(n)&&(this._resolveCache=void 0,this._resolveDuration=void 0)}).finally(()=>{t.dispose()})}return this._resolveCache}}const RO=class RO{constructor(e=2,t=new Set,i=new Set,n=new Map,r=!0){this.snippetSortOrder=e,this.kindFilter=t,this.providerFilter=i,this.providerItemsToReuse=n,this.showDeprecated=r}};RO.default=new RO;let dE=RO;class XZe{constructor(e,t,i,n){this.items=e,this.needsClipboard=t,this.durations=i,this.disposable=n}}async function MQ(s,e,t,i=dE.default,n={triggerKind:0},r=kt.None){const o=new Bs;t=t.clone();const a=e.getWordAtPosition(t),l=a?new F(t.lineNumber,a.startColumn,t.lineNumber,a.endColumn):F.fromPositions(t),c={replace:l,insert:l.setEndPosition(t.lineNumber,t.column)},d=[],u=new ce,h=[];let g=!1;const p=(v,C,y)=>{var L;let x=!1;if(!C)return x;for(const I of C.suggestions)if(!i.kindFilter.has(I.kind)){if(!i.showDeprecated&&((L=I==null?void 0:I.tags)!=null&&L.includes(1)))continue;I.range||(I.range=c),I.sortText||(I.sortText=typeof I.label=="string"?I.label:I.label.label),!g&&I.insertTextRules&&I.insertTextRules&4&&(g=Lw.guessNeedsClipboard(I.insertText)),d.push(new YZe(t,I,C,v)),x=!0}return Y4(C)&&u.add(C),h.push({providerName:v._debugDisplayName??"unknown_provider",elapsedProvider:C.duration??-1,elapsedOverall:y.elapsed()}),x},_=(async()=>{})();for(const v of s.orderedGroups(e)){let C=!1;if(await Promise.all(v.map(async y=>{if(i.providerItemsToReuse.has(y)){const x=i.providerItemsToReuse.get(y);x.forEach(L=>d.push(L)),C=C||x.length>0;return}if(!(i.providerFilter.size>0&&!i.providerFilter.has(y)))try{const x=new Bs,L=await y.provideCompletionItems(e,t,n,r);C=p(y,L,x)||C}catch(x){Mn(x)}})),C||r.isCancellationRequested)break}return await _,r.isCancellationRequested?(u.dispose(),Promise.reject(new od)):new XZe(d.sort(eJe(i.snippetSortOrder)),g,{entries:h,elapsed:o.elapsed()},u)}function OQ(s,e){if(s.sortTextLow&&e.sortTextLow){if(s.sortTextLow<e.sortTextLow)return-1;if(s.sortTextLow>e.sortTextLow)return 1}return s.textLabel<e.textLabel?-1:s.textLabel>e.textLabel?1:s.completion.kind-e.completion.kind}function ZZe(s,e){if(s.completion.kind!==e.completion.kind){if(s.completion.kind===27)return-1;if(e.completion.kind===27)return 1}return OQ(s,e)}function JZe(s,e){if(s.completion.kind!==e.completion.kind){if(s.completion.kind===27)return 1;if(e.completion.kind===27)return-1}return OQ(s,e)}const S5=new Map;S5.set(0,ZZe);S5.set(2,JZe);S5.set(1,OQ);function eJe(s){return S5.get(s)}Gt.registerCommand("_executeCompletionItemProvider",async(s,...e)=>{const[t,i,n,r]=e;ii(Je.isUri(t)),ii(X.isIPosition(i)),ii(typeof n=="string"||!n),ii(typeof r=="number"||!r);const{completionProvider:o}=s.get(Be),a=await s.get(oa).createModelReference(t);try{const l={incomplete:!1,suggestions:[]},c=[],d=a.object.textEditorModel.validatePosition(i),u=await MQ(o,a.object.textEditorModel,d,void 0,{triggerCharacter:n??void 0,triggerKind:n?1:0});for(const h of u.items)c.length<(r??0)&&c.push(h.resolve(kt.None)),l.incomplete=l.incomplete||h.container.incomplete,l.suggestions.push(h.completion);try{return await Promise.all(c),l}finally{setTimeout(()=>u.disposable.dispose(),100)}}finally{a.dispose()}});function tJe(s,e){var t;(t=s.getContribution("editor.contrib.suggestController"))==null||t.triggerSuggest(new Set().add(e),void 0,!0)}class UC{static isAllOff(e){return e.other==="off"&&e.comments==="off"&&e.strings==="off"}static isAllOn(e){return e.other==="on"&&e.comments==="on"&&e.strings==="on"}static valueFor(e,t){switch(t){case 1:return e.comments;case 2:return e.strings;default:return e.other}}}function xoe(s,e=gr){return vOe(s,e)?s.charAt(0).toUpperCase()+s.slice(1):s}var iJe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},nJe=function(s,e){return function(t,i){e(t,i,s)}};class Loe{constructor(e){this._delegates=e}resolve(e){for(const t of this._delegates){const i=t.resolve(e);if(i!==void 0)return i}}}class koe{constructor(e,t,i,n){this._model=e,this._selection=t,this._selectionIdx=i,this._overtypingCapturer=n}resolve(e){const{name:t}=e;if(t==="SELECTION"||t==="TM_SELECTED_TEXT"){let i=this._model.getValueInRange(this._selection)||void 0,n=this._selection.startLineNumber!==this._selection.endLineNumber;if(!i&&this._overtypingCapturer){const r=this._overtypingCapturer.getLastOvertypedInfo(this._selectionIdx);r&&(i=r.value,n=r.multiline)}if(i&&n&&e.snippet){const r=this._model.getLineContent(this._selection.startLineNumber),o=Ti(r,0,this._selection.startColumn-1);let a=o;e.snippet.walk(c=>c===e?!1:(c instanceof po&&(a=Ti(Uh(c.value).pop())),!0));const l=zm(a,o);i=i.replace(/(\r\n|\r|\n)(.*)/g,(c,d,u)=>`${d}${a.substr(l)}${u}`)}return i}else{if(t==="TM_CURRENT_LINE")return this._model.getLineContent(this._selection.positionLineNumber);if(t==="TM_CURRENT_WORD"){const i=this._model.getWordAtPosition({lineNumber:this._selection.positionLineNumber,column:this._selection.positionColumn});return i&&i.word||void 0}else{if(t==="TM_LINE_INDEX")return String(this._selection.positionLineNumber-1);if(t==="TM_LINE_NUMBER")return String(this._selection.positionLineNumber);if(t==="CURSOR_INDEX")return String(this._selectionIdx);if(t==="CURSOR_NUMBER")return String(this._selectionIdx+1)}}}}class Ioe{constructor(e,t){this._labelService=e,this._model=t}resolve(e){const{name:t}=e;if(t==="TM_FILENAME")return lm(this._model.uri.fsPath);if(t==="TM_FILENAME_BASE"){const i=lm(this._model.uri.fsPath),n=i.lastIndexOf(".");return n<=0?i:i.slice(0,n)}else{if(t==="TM_DIRECTORY")return bue(this._model.uri.fsPath)==="."?"":this._labelService.getUriLabel(RF(this._model.uri));if(t==="TM_FILEPATH")return this._labelService.getUriLabel(this._model.uri);if(t==="RELATIVE_FILEPATH")return this._labelService.getUriLabel(this._model.uri,{relative:!0,noPrefix:!0})}}}class Eoe{constructor(e,t,i,n){this._readClipboardText=e,this._selectionIdx=t,this._selectionCount=i,this._spread=n}resolve(e){if(e.name!=="CLIPBOARD")return;const t=this._readClipboardText();if(t){if(this._spread){const i=t.split(/\r\n|\n|\r/).filter(n=>!Iue(n));if(i.length===this._selectionCount)return i[this._selectionIdx]}return t}}}let XP=class{constructor(e,t,i){this._model=e,this._selection=t,this._languageConfigurationService=i}resolve(e){const{name:t}=e,i=this._model.getLanguageIdAtPosition(this._selection.selectionStartLineNumber,this._selection.selectionStartColumn),n=this._languageConfigurationService.getLanguageConfiguration(i).comments;if(n){if(t==="LINE_COMMENT")return n.lineCommentToken||void 0;if(t==="BLOCK_COMMENT_START")return n.blockCommentStartToken||void 0;if(t==="BLOCK_COMMENT_END")return n.blockCommentEndToken||void 0}}};XP=iJe([nJe(2,bn)],XP);const Ju=class Ju{constructor(){this._date=new Date}resolve(e){const{name:t}=e;if(t==="CURRENT_YEAR")return String(this._date.getFullYear());if(t==="CURRENT_YEAR_SHORT")return String(this._date.getFullYear()).slice(-2);if(t==="CURRENT_MONTH")return String(this._date.getMonth().valueOf()+1).padStart(2,"0");if(t==="CURRENT_DATE")return String(this._date.getDate().valueOf()).padStart(2,"0");if(t==="CURRENT_HOUR")return String(this._date.getHours().valueOf()).padStart(2,"0");if(t==="CURRENT_MINUTE")return String(this._date.getMinutes().valueOf()).padStart(2,"0");if(t==="CURRENT_SECOND")return String(this._date.getSeconds().valueOf()).padStart(2,"0");if(t==="CURRENT_DAY_NAME")return Ju.dayNames[this._date.getDay()];if(t==="CURRENT_DAY_NAME_SHORT")return Ju.dayNamesShort[this._date.getDay()];if(t==="CURRENT_MONTH_NAME")return Ju.monthNames[this._date.getMonth()];if(t==="CURRENT_MONTH_NAME_SHORT")return Ju.monthNamesShort[this._date.getMonth()];if(t==="CURRENT_SECONDS_UNIX")return String(Math.floor(this._date.getTime()/1e3));if(t==="CURRENT_TIMEZONE_OFFSET"){const i=this._date.getTimezoneOffset(),n=i>0?"-":"+",r=Math.trunc(Math.abs(i/60)),o=r<10?"0"+r:r,a=Math.abs(i)-r*60,l=a<10?"0"+a:a;return n+o+":"+l}}};Ju.dayNames=[b("Sunday","Sunday"),b("Monday","Monday"),b("Tuesday","Tuesday"),b("Wednesday","Wednesday"),b("Thursday","Thursday"),b("Friday","Friday"),b("Saturday","Saturday")],Ju.dayNamesShort=[b("SundayShort","Sun"),b("MondayShort","Mon"),b("TuesdayShort","Tue"),b("WednesdayShort","Wed"),b("ThursdayShort","Thu"),b("FridayShort","Fri"),b("SaturdayShort","Sat")],Ju.monthNames=[b("January","January"),b("February","February"),b("March","March"),b("April","April"),b("May","May"),b("June","June"),b("July","July"),b("August","August"),b("September","September"),b("October","October"),b("November","November"),b("December","December")],Ju.monthNamesShort=[b("JanuaryShort","Jan"),b("FebruaryShort","Feb"),b("MarchShort","Mar"),b("AprilShort","Apr"),b("MayShort","May"),b("JuneShort","Jun"),b("JulyShort","Jul"),b("AugustShort","Aug"),b("SeptemberShort","Sep"),b("OctoberShort","Oct"),b("NovemberShort","Nov"),b("DecemberShort","Dec")];let ZP=Ju;class Doe{constructor(e){this._workspaceService=e}resolve(e){if(!this._workspaceService)return;const t=F3e(this._workspaceService.getWorkspace());if(!M3e(t)){if(e.name==="WORKSPACE_NAME")return this._resolveWorkspaceName(t);if(e.name==="WORKSPACE_FOLDER")return this._resoveWorkspacePath(t)}}_resolveWorkspaceName(e){if(X6(e))return lm(e.uri.path);let t=lm(e.configPath.path);return t.endsWith(Z6)&&(t=t.substr(0,t.length-Z6.length-1)),t}_resoveWorkspacePath(e){if(X6(e))return xoe(e.uri.fsPath);const t=lm(e.configPath.path);let i=e.configPath.fsPath;return i.endsWith(t)&&(i=i.substr(0,i.length-t.length-1)),i?xoe(i):"/"}}class Toe{resolve(e){const{name:t}=e;if(t==="RANDOM")return Math.random().toString().slice(-6);if(t==="RANDOM_HEX")return Math.random().toString(16).slice(-6);if(t==="UUID")return f5()}}var sJe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},rJe=function(s,e){return function(t,i){e(t,i,s)}},Md;const $c=class $c{constructor(e,t,i){this._editor=e,this._snippet=t,this._snippetLineLeadingWhitespace=i,this._offset=-1,this._nestingLevel=1,this._placeholderGroups=Vee(t.placeholders,sc.compareByIndex),this._placeholderGroupsIdx=-1}initialize(e){this._offset=e.newPosition}dispose(){this._placeholderDecorations&&this._editor.removeDecorations([...this._placeholderDecorations.values()]),this._placeholderGroups.length=0}_initDecorations(){if(this._offset===-1)throw new Error("Snippet not initialized!");if(this._placeholderDecorations)return;this._placeholderDecorations=new Map;const e=this._editor.getModel();this._editor.changeDecorations(t=>{for(const i of this._snippet.placeholders){const n=this._snippet.offset(i),r=this._snippet.fullLen(i),o=F.fromPositions(e.getPositionAt(this._offset+n),e.getPositionAt(this._offset+n+r)),a=i.isFinalTabstop?$c._decor.inactiveFinal:$c._decor.inactive,l=t.addDecoration(o,a);this._placeholderDecorations.set(i,l)}})}move(e){if(!this._editor.hasModel())return[];if(this._initDecorations(),this._placeholderGroupsIdx>=0){const n=[];for(const r of this._placeholderGroups[this._placeholderGroupsIdx])if(r.transform){const o=this._placeholderDecorations.get(r),a=this._editor.getModel().getDecorationRange(o),l=this._editor.getModel().getValueInRange(a),c=r.transform.resolve(l).split(/\r\n|\r|\n/);for(let d=1;d<c.length;d++)c[d]=this._editor.getModel().normalizeIndentation(this._snippetLineLeadingWhitespace+c[d]);n.push(gn.replace(a,c.join(this._editor.getModel().getEOL())))}n.length>0&&this._editor.executeEdits("snippet.placeholderTransform",n)}let t=!1;e===!0&&this._placeholderGroupsIdx<this._placeholderGroups.length-1?(this._placeholderGroupsIdx+=1,t=!0):e===!1&&this._placeholderGroupsIdx>0&&(this._placeholderGroupsIdx-=1,t=!0);const i=this._editor.getModel().changeDecorations(n=>{const r=new Set,o=[];for(const a of this._placeholderGroups[this._placeholderGroupsIdx]){const l=this._placeholderDecorations.get(a),c=this._editor.getModel().getDecorationRange(l);o.push(new Ue(c.startLineNumber,c.startColumn,c.endLineNumber,c.endColumn)),t=t&&this._hasPlaceholderBeenCollapsed(a),n.changeDecorationOptions(l,a.isFinalTabstop?$c._decor.activeFinal:$c._decor.active),r.add(a);for(const d of this._snippet.enclosingPlaceholders(a)){const u=this._placeholderDecorations.get(d);n.changeDecorationOptions(u,d.isFinalTabstop?$c._decor.activeFinal:$c._decor.active),r.add(d)}}for(const[a,l]of this._placeholderDecorations)r.has(a)||n.changeDecorationOptions(l,a.isFinalTabstop?$c._decor.inactiveFinal:$c._decor.inactive);return o});return t?this.move(e):i??[]}_hasPlaceholderBeenCollapsed(e){let t=e;for(;t;){if(t instanceof sc){const i=this._placeholderDecorations.get(t);if(this._editor.getModel().getDecorationRange(i).isEmpty()&&t.toString().length>0)return!0}t=t.parent}return!1}get isAtFirstPlaceholder(){return this._placeholderGroupsIdx<=0||this._placeholderGroups.length===0}get isAtLastPlaceholder(){return this._placeholderGroupsIdx===this._placeholderGroups.length-1}get hasPlaceholder(){return this._snippet.placeholders.length>0}get isTrivialSnippet(){if(this._snippet.placeholders.length===0)return!0;if(this._snippet.placeholders.length===1){const[e]=this._snippet.placeholders;if(e.isFinalTabstop&&this._snippet.rightMostDescendant===e)return!0}return!1}computePossibleSelections(){const e=new Map;for(const t of this._placeholderGroups){let i;for(const n of t){if(n.isFinalTabstop)break;i||(i=[],e.set(n.index,i));const r=this._placeholderDecorations.get(n),o=this._editor.getModel().getDecorationRange(r);if(!o){e.delete(n.index);break}i.push(o)}}return e}get activeChoice(){if(!this._placeholderDecorations)return;const e=this._placeholderGroups[this._placeholderGroupsIdx][0];if(!(e!=null&&e.choice))return;const t=this._placeholderDecorations.get(e);if(!t)return;const i=this._editor.getModel().getDecorationRange(t);if(i)return{range:i,choice:e.choice}}get hasChoice(){let e=!1;return this._snippet.walk(t=>(e=t instanceof TS,!e)),e}merge(e){const t=this._editor.getModel();this._nestingLevel*=10,this._editor.changeDecorations(i=>{for(const n of this._placeholderGroups[this._placeholderGroupsIdx]){const r=e.shift();console.assert(r._offset!==-1),console.assert(!r._placeholderDecorations);const o=r._snippet.placeholderInfo.last.index;for(const l of r._snippet.placeholderInfo.all)l.isFinalTabstop?l.index=n.index+(o+1)/this._nestingLevel:l.index=n.index+l.index/this._nestingLevel;this._snippet.replace(n,r._snippet.children);const a=this._placeholderDecorations.get(n);i.removeDecoration(a),this._placeholderDecorations.delete(n);for(const l of r._snippet.placeholders){const c=r._snippet.offset(l),d=r._snippet.fullLen(l),u=F.fromPositions(t.getPositionAt(r._offset+c),t.getPositionAt(r._offset+c+d)),h=i.addDecoration(u,$c._decor.inactive);this._placeholderDecorations.set(l,h)}}this._placeholderGroups=Vee(this._snippet.placeholders,sc.compareByIndex)})}};$c._decor={active:_t.register({description:"snippet-placeholder-1",stickiness:0,className:"snippet-placeholder"}),inactive:_t.register({description:"snippet-placeholder-2",stickiness:1,className:"snippet-placeholder"}),activeFinal:_t.register({description:"snippet-placeholder-3",stickiness:1,className:"finish-snippet-placeholder"}),inactiveFinal:_t.register({description:"snippet-placeholder-4",stickiness:1,className:"finish-snippet-placeholder"})};let JP=$c;const Noe={overwriteBefore:0,overwriteAfter:0,adjustWhitespace:!0,clipboardText:void 0,overtypingCapturer:void 0};let eM=Md=class{static adjustWhitespace(e,t,i,n,r){const o=e.getLineContent(t.lineNumber),a=Ti(o,0,t.column-1);let l;return n.walk(c=>{if(!(c instanceof po)||c.parent instanceof TS||r&&!r.has(c))return!0;const d=c.value.split(/\r\n|\r|\n/);if(i){const h=n.offset(c);if(h===0)d[0]=e.normalizeIndentation(d[0]);else{l=l??n.toString();const g=l.charCodeAt(h-1);(g===10||g===13)&&(d[0]=e.normalizeIndentation(a+d[0]))}for(let g=1;g<d.length;g++)d[g]=e.normalizeIndentation(a+d[g])}const u=d.join(e.getEOL());return u!==c.value&&(c.parent.replace(c,[new po(u)]),l=void 0),!0}),a}static adjustSelection(e,t,i,n){if(i!==0||n!==0){const{positionLineNumber:r,positionColumn:o}=t,a=o-i,l=o+n,c=e.validateRange({startLineNumber:r,startColumn:a,endLineNumber:r,endColumn:l});t=Ue.createWithDirection(c.startLineNumber,c.startColumn,c.endLineNumber,c.endColumn,t.getDirection())}return t}static createEditsAndSnippetsFromSelections(e,t,i,n,r,o,a,l,c){const d=[],u=[];if(!e.hasModel())return{edits:d,snippets:u};const h=e.getModel(),g=e.invokeWithinContext(L=>L.get(_w)),p=e.invokeWithinContext(L=>new Ioe(L.get(x1),h)),_=()=>a,v=h.getValueInRange(Md.adjustSelection(h,e.getSelection(),i,0)),C=h.getValueInRange(Md.adjustSelection(h,e.getSelection(),0,n)),y=h.getLineFirstNonWhitespaceColumn(e.getSelection().positionLineNumber),x=e.getSelections().map((L,I)=>({selection:L,idx:I})).sort((L,I)=>F.compareRangesUsingStarts(L.selection,I.selection));for(const{selection:L,idx:I}of x){let A=Md.adjustSelection(h,L,i,0),D=Md.adjustSelection(h,L,0,n);v!==h.getValueInRange(A)&&(A=L),C!==h.getValueInRange(D)&&(D=L);const N=L.setStartPosition(A.startLineNumber,A.startColumn).setEndPosition(D.endLineNumber,D.endColumn),R=new Lw().parse(t,!0,r),W=N.getStartPosition(),H=Md.adjustWhitespace(h,W,o||I>0&&y!==h.getLineFirstNonWhitespaceColumn(L.positionLineNumber),R);R.resolveVariables(new Loe([p,new Eoe(_,I,x.length,e.getOption(79)==="spread"),new koe(h,L,I,l),new XP(h,L,c),new ZP,new Doe(g),new Toe])),d[I]=gn.replace(N,R.toString()),d[I].identifier={major:I,minor:0},d[I]._isTracked=!0,u[I]=new JP(e,R,H)}return{edits:d,snippets:u}}static createEditsAndSnippetsFromEdits(e,t,i,n,r,o,a){if(!e.hasModel()||t.length===0)return{edits:[],snippets:[]};const l=[],c=e.getModel(),d=new Lw,u=new mD,h=new Loe([e.invokeWithinContext(p=>new Ioe(p.get(x1),c)),new Eoe(()=>r,0,e.getSelections().length,e.getOption(79)==="spread"),new koe(c,e.getSelection(),0,o),new XP(c,e.getSelection(),a),new ZP,new Doe(e.invokeWithinContext(p=>p.get(_w))),new Toe]);t=t.sort((p,_)=>F.compareRangesUsingStarts(p.range,_.range));let g=0;for(let p=0;p<t.length;p++){const{range:_,template:v}=t[p];if(p>0){const I=t[p-1].range,A=F.fromPositions(I.getEndPosition(),_.getStartPosition()),D=new po(c.getValueInRange(A));u.appendChild(D),g+=D.value.length}const C=d.parseFragment(v,u);Md.adjustWhitespace(c,_.getStartPosition(),!0,u,new Set(C)),u.resolveVariables(h);const y=u.toString(),x=y.slice(g);g=y.length;const L=gn.replace(_,x);L.identifier={major:p,minor:0},L._isTracked=!0,l.push(L)}return d.ensureFinalTabstop(u,i,!0),{edits:l,snippets:[new JP(e,u,"")]}}constructor(e,t,i=Noe,n){this._editor=e,this._template=t,this._options=i,this._languageConfigurationService=n,this._templateMerges=[],this._snippets=[]}dispose(){Ni(this._snippets)}_logInfo(){return`template="${this._template}", merged_templates="${this._templateMerges.join(" -> ")}"`}insert(){if(!this._editor.hasModel())return;const{edits:e,snippets:t}=typeof this._template=="string"?Md.createEditsAndSnippetsFromSelections(this._editor,this._template,this._options.overwriteBefore,this._options.overwriteAfter,!1,this._options.adjustWhitespace,this._options.clipboardText,this._options.overtypingCapturer,this._languageConfigurationService):Md.createEditsAndSnippetsFromEdits(this._editor,this._template,!1,this._options.adjustWhitespace,this._options.clipboardText,this._options.overtypingCapturer,this._languageConfigurationService);this._snippets=t,this._editor.executeEdits("snippet",e,i=>{const n=i.filter(r=>!!r.identifier);for(let r=0;r<t.length;r++)t[r].initialize(n[r].textChange);return this._snippets[0].hasPlaceholder?this._move(!0):n.map(r=>Ue.fromPositions(r.range.getEndPosition()))}),this._editor.revealRange(this._editor.getSelections()[0])}merge(e,t=Noe){if(!this._editor.hasModel())return;this._templateMerges.push([this._snippets[0]._nestingLevel,this._snippets[0]._placeholderGroupsIdx,e]);const{edits:i,snippets:n}=Md.createEditsAndSnippetsFromSelections(this._editor,e,t.overwriteBefore,t.overwriteAfter,!0,t.adjustWhitespace,t.clipboardText,t.overtypingCapturer,this._languageConfigurationService);this._editor.executeEdits("snippet",i,r=>{const o=r.filter(l=>!!l.identifier);for(let l=0;l<n.length;l++)n[l].initialize(o[l].textChange);const a=n[0].isTrivialSnippet;if(!a){for(const l of this._snippets)l.merge(n);console.assert(n.length===0)}return this._snippets[0].hasPlaceholder&&!a?this._move(void 0):o.map(l=>Ue.fromPositions(l.range.getEndPosition()))})}next(){const e=this._move(!0);this._editor.setSelections(e),this._editor.revealPositionInCenterIfOutsideViewport(e[0].getPosition())}prev(){const e=this._move(!1);this._editor.setSelections(e),this._editor.revealPositionInCenterIfOutsideViewport(e[0].getPosition())}_move(e){const t=[];for(const i of this._snippets){const n=i.move(e);t.push(...n)}return t}get isAtFirstPlaceholder(){return this._snippets[0].isAtFirstPlaceholder}get isAtLastPlaceholder(){return this._snippets[0].isAtLastPlaceholder}get hasPlaceholder(){return this._snippets[0].hasPlaceholder}get hasChoice(){return this._snippets[0].hasChoice}get activeChoice(){return this._snippets[0].activeChoice}isSelectionWithinPlaceholders(){if(!this.hasPlaceholder)return!1;const e=this._editor.getSelections();if(e.length<this._snippets.length)return!1;const t=new Map;for(const i of this._snippets){const n=i.computePossibleSelections();if(t.size===0)for(const[r,o]of n){o.sort(F.compareRangesUsingStarts);for(const a of e)if(o[0].containsRange(a)){t.set(r,[]);break}}if(t.size===0)return!1;t.forEach((r,o)=>{r.push(...n.get(o))})}e.sort(F.compareRangesUsingStarts);for(const[i,n]of t){if(n.length!==e.length){t.delete(i);continue}n.sort(F.compareRangesUsingStarts);for(let r=0;r<n.length;r++)if(!n[r].containsRange(e[r])){t.delete(i);continue}}return t.size>0}};eM=Md=sJe([rJe(3,bn)],eM);var oJe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},YN=function(s,e){return function(t,i){e(t,i,s)}},bC;const Roe={overwriteBefore:0,overwriteAfter:0,undoStopBefore:!0,undoStopAfter:!0,adjustWhitespace:!0,clipboardText:void 0,overtypingCapturer:void 0};var fh;let Do=(fh=class{static get(e){return e.getContribution(bC.ID)}constructor(e,t,i,n,r){this._editor=e,this._logService=t,this._languageFeaturesService=i,this._languageConfigurationService=r,this._snippetListener=new ce,this._modelVersionId=-1,this._inSnippet=bC.InSnippetMode.bindTo(n),this._hasNextTabstop=bC.HasNextTabstop.bindTo(n),this._hasPrevTabstop=bC.HasPrevTabstop.bindTo(n)}dispose(){var e;this._inSnippet.reset(),this._hasPrevTabstop.reset(),this._hasNextTabstop.reset(),(e=this._session)==null||e.dispose(),this._snippetListener.dispose()}insert(e,t){try{this._doInsert(e,typeof t>"u"?Roe:{...Roe,...t})}catch(i){this.cancel(),this._logService.error(i),this._logService.error("snippet_error"),this._logService.error("insert_template=",e),this._logService.error("existing_template=",this._session?this._session._logInfo():"<no_session>")}}_doInsert(e,t){var i;if(this._editor.hasModel()){if(this._snippetListener.clear(),t.undoStopBefore&&this._editor.getModel().pushStackElement(),this._session&&typeof e!="string"&&this.cancel(),this._session?(ii(typeof e=="string"),this._session.merge(e,t)):(this._modelVersionId=this._editor.getModel().getAlternativeVersionId(),this._session=new eM(this._editor,e,t,this._languageConfigurationService),this._session.insert()),t.undoStopAfter&&this._editor.getModel().pushStackElement(),(i=this._session)!=null&&i.hasChoice){const n={_debugDisplayName:"snippetChoiceCompletions",provideCompletionItems:(d,u)=>{if(!this._session||d!==this._editor.getModel()||!X.equals(this._editor.getPosition(),u))return;const{activeChoice:h}=this._session;if(!h||h.choice.options.length===0)return;const g=d.getValueInRange(h.range),p=!!h.choice.options.find(v=>v.value===g),_=[];for(let v=0;v<h.choice.options.length;v++){const C=h.choice.options[v];_.push({kind:13,label:C.value,insertText:C.value,sortText:"a".repeat(v+1),range:h.range,filterText:p?`${g}_${C.value}`:void 0,command:{id:"jumpToNextSnippetPlaceholder",title:b("next","Go to next placeholder...")}})}return{suggestions:_}}},r=this._editor.getModel();let o,a=!1;const l=()=>{o==null||o.dispose(),a=!1},c=()=>{a||(o=this._languageFeaturesService.completionProvider.register({language:r.getLanguageId(),pattern:r.uri.fsPath,scheme:r.uri.scheme,exclusive:!0},n),this._snippetListener.add(o),a=!0)};this._choiceCompletions={provider:n,enable:c,disable:l}}this._updateState(),this._snippetListener.add(this._editor.onDidChangeModelContent(n=>n.isFlush&&this.cancel())),this._snippetListener.add(this._editor.onDidChangeModel(()=>this.cancel())),this._snippetListener.add(this._editor.onDidChangeCursorSelection(()=>this._updateState()))}}_updateState(){if(!(!this._session||!this._editor.hasModel())){if(this._modelVersionId===this._editor.getModel().getAlternativeVersionId())return this.cancel();if(!this._session.hasPlaceholder)return this.cancel();if(this._session.isAtLastPlaceholder||!this._session.isSelectionWithinPlaceholders())return this._editor.getModel().pushStackElement(),this.cancel();this._inSnippet.set(!0),this._hasPrevTabstop.set(!this._session.isAtFirstPlaceholder),this._hasNextTabstop.set(!this._session.isAtLastPlaceholder),this._handleChoice()}}_handleChoice(){var t;if(!this._session||!this._editor.hasModel()){this._currentChoice=void 0;return}const{activeChoice:e}=this._session;if(!e||!this._choiceCompletions){(t=this._choiceCompletions)==null||t.disable(),this._currentChoice=void 0;return}this._currentChoice!==e.choice&&(this._currentChoice=e.choice,this._choiceCompletions.enable(),queueMicrotask(()=>{tJe(this._editor,this._choiceCompletions.provider)}))}finish(){for(;this._inSnippet.get();)this.next()}cancel(e=!1){var t;this._inSnippet.reset(),this._hasPrevTabstop.reset(),this._hasNextTabstop.reset(),this._snippetListener.clear(),this._currentChoice=void 0,(t=this._session)==null||t.dispose(),this._session=void 0,this._modelVersionId=-1,e&&this._editor.setSelections([this._editor.getSelection()])}prev(){var e;(e=this._session)==null||e.prev(),this._updateState()}next(){var e;(e=this._session)==null||e.next(),this._updateState()}isInSnippet(){return!!this._inSnippet.get()}},bC=fh,fh.ID="snippetController2",fh.InSnippetMode=new Oe("inSnippetMode",!1,b("inSnippetMode","Whether the editor in current in snippet mode")),fh.HasNextTabstop=new Oe("hasNextTabstop",!1,b("hasNextTabstop","Whether there is a next tab stop when in snippet mode")),fh.HasPrevTabstop=new Oe("hasPrevTabstop",!1,b("hasPrevTabstop","Whether there is a previous tab stop when in snippet mode")),fh);Do=bC=oJe([YN(1,pr),YN(2,Be),YN(3,ct),YN(4,bn)],Do);Zt(Do.ID,Do,4);const x5=fs.bindToContribution(Do.get);Me(new x5({id:"jumpToNextSnippetPlaceholder",precondition:he.and(Do.InSnippetMode,Do.HasNextTabstop),handler:s=>s.next(),kbOpts:{weight:130,kbExpr:z.textInputFocus,primary:2}}));Me(new x5({id:"jumpToPrevSnippetPlaceholder",precondition:he.and(Do.InSnippetMode,Do.HasPrevTabstop),handler:s=>s.prev(),kbOpts:{weight:130,kbExpr:z.textInputFocus,primary:1026}}));Me(new x5({id:"leaveSnippet",precondition:Do.InSnippetMode,handler:s=>s.cancel(!0),kbOpts:{weight:130,kbExpr:z.textInputFocus,primary:9,secondary:[1033]}}));Me(new x5({id:"acceptSnippet",precondition:Do.InSnippetMode,handler:s=>s.finish()}));var aJe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},PB=function(s,e){return function(t,i){e(t,i,s)}};let wU=class extends te{get isAcceptingPartially(){return this._isAcceptingPartially}constructor(e,t,i,n,r,o,a,l,c,d,u,h){super(),this.textModel=e,this.selectedSuggestItem=t,this._textModelVersionId=i,this._positions=n,this._debounceValue=r,this._suggestPreviewEnabled=o,this._suggestPreviewMode=a,this._inlineSuggestMode=l,this._enabled=c,this._instantiationService=d,this._commandService=u,this._languageConfigurationService=h,this._source=this._register(this._instantiationService.createInstance(vU,this.textModel,this._textModelVersionId,this._debounceValue)),this._isActive=Rt(this,!1),this._forceUpdateExplicitlySignal=vS(this),this._selectedInlineCompletionId=Rt(this,void 0),this._primaryPosition=qe(this,p=>this._positions.read(p)[0]??new X(1,1)),this._isAcceptingPartially=!1,this._preserveCurrentCompletionReasons=new Set([yf.Redo,yf.Undo,yf.AcceptWord]),this._fetchInlineCompletionsPromise=Zfe({owner:this,createEmptyChangeSummary:()=>({preserveCurrentCompletion:!1,inlineCompletionTriggerKind:iu.Automatic}),handleChange:(p,_)=>(p.didChange(this._textModelVersionId)&&this._preserveCurrentCompletionReasons.has(this._getReason(p.change))?_.preserveCurrentCompletion=!0:p.didChange(this._forceUpdateExplicitlySignal)&&(_.inlineCompletionTriggerKind=iu.Explicit),!0)},(p,_)=>{if(this._forceUpdateExplicitlySignal.read(p),!(this._enabled.read(p)&&this.selectedSuggestItem.read(p)||this._isActive.read(p))){this._source.cancelUpdate();return}this._textModelVersionId.read(p);const C=this._source.suggestWidgetInlineCompletions.get(),y=this.selectedSuggestItem.read(p);if(C&&!y){const D=this._source.inlineCompletions.get();pn(N=>{(!D||C.request.versionId>D.request.versionId)&&this._source.inlineCompletions.set(C.clone(),N),this._source.clearSuggestWidgetInlineCompletions(N)})}const x=this._primaryPosition.read(p),L={triggerKind:_.inlineCompletionTriggerKind,selectedSuggestionInfo:y==null?void 0:y.toSelectedSuggestionInfo()},I=this.selectedInlineCompletion.get(),A=_.preserveCurrentCompletion||I!=null&&I.forwardStable?I:void 0;return this._source.fetch(x,L,A)}),this._filteredInlineCompletionItems=_l({owner:this,equalsFn:wA()},p=>{const _=this._source.inlineCompletions.read(p);if(!_)return[];const v=this._primaryPosition.read(p);return _.inlineCompletions.filter(y=>y.isVisible(this.textModel,v,p))}),this.selectedInlineCompletionIndex=qe(this,p=>{const _=this._selectedInlineCompletionId.read(p),v=this._filteredInlineCompletionItems.read(p),C=this._selectedInlineCompletionId===void 0?-1:v.findIndex(y=>y.semanticId===_);return C===-1?(this._selectedInlineCompletionId.set(void 0,void 0),0):C}),this.selectedInlineCompletion=qe(this,p=>{const _=this._filteredInlineCompletionItems.read(p),v=this.selectedInlineCompletionIndex.read(p);return _[v]}),this.activeCommands=_l({owner:this,equalsFn:wA()},p=>{var _;return((_=this.selectedInlineCompletion.read(p))==null?void 0:_.inlineCompletion.source.inlineCompletions.commands)??[]}),this.lastTriggerKind=this._source.inlineCompletions.map(this,p=>p==null?void 0:p.request.context.triggerKind),this.inlineCompletionsCount=qe(this,p=>{if(this.lastTriggerKind.read(p)===iu.Explicit)return this._filteredInlineCompletionItems.read(p).length}),this.state=_l({owner:this,equalsFn:(p,_)=>!p||!_?p===_:goe(p.ghostTexts,_.ghostTexts)&&p.inlineCompletion===_.inlineCompletion&&p.suggestItem===_.suggestItem},p=>{const _=this.textModel,v=this.selectedSuggestItem.read(p);if(v){const C=rv(v.toSingleTextEdit(),_),y=this._computeAugmentation(C,p);if(!this._suggestPreviewEnabled.read(p)&&!y)return;const L=(y==null?void 0:y.edit)??C,I=y?y.edit.text.length-C.text.length:0,A=this._suggestPreviewMode.read(p),D=this._positions.read(p),N=[L,...MB(this.textModel,D,L)],R=N.map((H,U)=>voe(H,_,A,D[U],I)).filter(Ch),W=R[0]??new cE(L.range.endLineNumber,[]);return{edits:N,primaryGhostText:W,ghostTexts:R,inlineCompletion:y==null?void 0:y.completion,suggestItem:v}}else{if(!this._isActive.read(p))return;const C=this.selectedInlineCompletion.read(p);if(!C)return;const y=C.toSingleTextEdit(p),x=this._inlineSuggestMode.read(p),L=this._positions.read(p),I=[y,...MB(this.textModel,L,y)],A=I.map((D,N)=>voe(D,_,x,L[N],0)).filter(Ch);return A[0]?{edits:I,primaryGhostText:A[0],ghostTexts:A,inlineCompletion:C,suggestItem:void 0}:void 0}}),this.ghostTexts=_l({owner:this,equalsFn:goe},p=>{const _=this.state.read(p);if(_)return _.ghostTexts}),this.primaryGhostText=_l({owner:this,equalsFn:kbe},p=>{const _=this.state.read(p);if(_)return _==null?void 0:_.primaryGhostText}),this._register(wS(this._fetchInlineCompletionsPromise));let g;this._register(ht(p=>{var C,y;const _=this.state.read(p),v=_==null?void 0:_.inlineCompletion;if((v==null?void 0:v.semanticId)!==(g==null?void 0:g.semanticId)&&(g=v,v)){const x=v.inlineCompletion,L=x.source;(y=(C=L.provider).handleItemDidShow)==null||y.call(C,L.inlineCompletions,x.sourceInlineCompletion,x.insertText)}}))}_getReason(e){return e!=null&&e.isUndoing?yf.Undo:e!=null&&e.isRedoing?yf.Redo:this.isAcceptingPartially?yf.AcceptWord:yf.Other}async trigger(e){this._isActive.set(!0,e),await this._fetchInlineCompletionsPromise.get()}async triggerExplicitly(e){bw(e,t=>{this._isActive.set(!0,t),this._forceUpdateExplicitlySignal.trigger(t)}),await this._fetchInlineCompletionsPromise.get()}stop(e){bw(e,t=>{this._isActive.set(!1,t),this._source.clear(t)})}_computeAugmentation(e,t){const i=this.textModel,n=this._source.suggestWidgetInlineCompletions.read(t),r=n?n.inlineCompletions:[this.selectedInlineCompletion.read(t)].filter(Ch);return gMe(r,a=>{let l=a.toSingleTextEdit(t);return l=rv(l,i,F.fromPositions(l.range.getStartPosition(),e.range.getEndPosition())),Tbe(l,e)?{completion:a,edit:l}:void 0})}async _deltaSelectedInlineCompletionIndex(e){await this.triggerExplicitly();const t=this._filteredInlineCompletionItems.get()||[];if(t.length>0){const i=(this.selectedInlineCompletionIndex.get()+e+t.length)%t.length;this._selectedInlineCompletionId.set(t[i].semanticId,void 0)}else this._selectedInlineCompletionId.set(void 0,void 0)}async next(){await this._deltaSelectedInlineCompletionIndex(1)}async previous(){await this._deltaSelectedInlineCompletionIndex(-1)}async accept(e){var n;if(e.getModel()!==this.textModel)throw new di;const t=this.state.get();if(!t||t.primaryGhostText.isEmpty()||!t.inlineCompletion)return;const i=t.inlineCompletion.toInlineCompletion(void 0);if(i.command&&i.source.addRef(),e.pushUndoStop(),i.snippetInfo)e.executeEdits("inlineSuggestion.accept",[gn.replace(i.range,""),...i.additionalTextEdits]),e.setPosition(i.snippetInfo.range.getStartPosition(),"inlineCompletionAccept"),(n=Do.get(e))==null||n.insert(i.snippetInfo.snippet,{undoStopBefore:!1});else{const r=t.edits,o=Aoe(r).map(a=>Ue.fromPositions(a));e.executeEdits("inlineSuggestion.accept",[...r.map(a=>gn.replace(a.range,a.text)),...i.additionalTextEdits]),e.setSelections(o,"inlineCompletionAccept")}this.stop(),i.command&&(await this._commandService.executeCommand(i.command.id,...i.command.arguments||[]).then(void 0,Mn),i.source.removeRef())}async acceptNextWord(e){await this._acceptNext(e,(t,i)=>{const n=this.textModel.getLanguageIdAtPosition(t.lineNumber,t.column),r=this._languageConfigurationService.getLanguageConfiguration(n),o=new RegExp(r.wordDefinition.source,r.wordDefinition.flags.replace("g","")),a=i.match(o);let l=0;a&&a.index!==void 0?a.index===0?l=a[0].length:l=a.index:l=i.length;const d=/\s+/g.exec(i);return d&&d.index!==void 0&&d.index+d[0].length<l&&(l=d.index+d[0].length),l},0)}async acceptNextLine(e){await this._acceptNext(e,(t,i)=>{const n=i.match(/\n/);return n&&n.index!==void 0?n.index+1:i.length},1)}async _acceptNext(e,t,i){if(e.getModel()!==this.textModel)throw new di;const n=this.state.get();if(!n||n.primaryGhostText.isEmpty()||!n.inlineCompletion)return;const r=n.primaryGhostText,o=n.inlineCompletion.toInlineCompletion(void 0);if(o.snippetInfo||o.filterText!==o.insertText){await this.accept(e);return}const a=r.parts[0],l=new X(r.lineNumber,a.column),c=a.text,d=t(l,c);if(d===c.length&&r.parts.length===1){this.accept(e);return}const u=c.substring(0,d),h=this._positions.get(),g=h[0];o.source.addRef();try{this._isAcceptingPartially=!0;try{e.pushUndoStop();const p=F.fromPositions(g,l),_=e.getModel().getValueInRange(p)+u,v=new Rh(p,_),C=[v,...MB(this.textModel,h,v)],y=Aoe(C).map(x=>Ue.fromPositions(x));e.executeEdits("inlineSuggestion.accept",C.map(x=>gn.replace(x.range,x.text))),e.setSelections(y,"inlineCompletionPartialAccept"),e.revealPositionInCenterIfOutsideViewport(e.getPosition(),1)}finally{this._isAcceptingPartially=!1}if(o.source.provider.handlePartialAccept){const p=F.fromPositions(o.range.getStartPosition(),cd.ofText(u).addToPosition(l)),_=e.getModel().getValueInRange(p,1);o.source.provider.handlePartialAccept(o.source.inlineCompletions,o.sourceInlineCompletion,_.length,{kind:i})}}finally{o.source.removeRef()}}handleSuggestAccepted(e){var r,o;const t=rv(e.toSingleTextEdit(),this.textModel),i=this._computeAugmentation(t,void 0);if(!i)return;const n=i.completion.inlineCompletion;(o=(r=n.source.provider).handlePartialAccept)==null||o.call(r,n.source.inlineCompletions,n.sourceInlineCompletion,t.text.length,{kind:2})}};wU=aJe([PB(9,Xe),PB(10,Hi),PB(11,bn)],wU);var yf;(function(s){s[s.Undo=0]="Undo",s[s.Redo=1]="Redo",s[s.AcceptWord=2]="AcceptWord",s[s.Other=3]="Other"})(yf||(yf={}));function MB(s,e,t){if(e.length===1)return[];const i=e[0],n=e.slice(1),r=t.range.getStartPosition(),o=t.range.getEndPosition(),a=s.getValueInRange(F.fromPositions(i,o)),l=poe(i,r);if(l.lineNumber<1)return ft(new di(`positionWithinTextEdit line number should be bigger than 0.
			Invalid subtraction between ${i.toString()} and ${r.toString()}`)),[];const c=lJe(t.text,l);return n.map(d=>{const u=AZe(poe(d,r),o),h=s.getValueInRange(F.fromPositions(d,u)),g=zm(a,h),p=F.fromPositions(d,d.delta(0,g));return new Rh(p,c)})}function lJe(s,e){let t="";const i=HRe(s);for(let n=e.lineNumber-1;n<i.length;n++)t+=i[n].substring(n===e.lineNumber-1?e.column-1:0);return t}function Aoe(s){const e=k2.createSortPermutation(s,Co(r=>r.range,F.compareRangesUsingStarts)),i=new Jq(e.apply(s)).getNewRanges();return e.inverse().apply(i).map(r=>r.getEndPosition())}var cJe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Poe=function(s,e){return function(t,i){e(t,i,s)}},uL;class FQ{constructor(e){this.name=e}select(e,t,i){if(i.length===0)return 0;const n=i[0].score[0];for(let r=0;r<i.length;r++){const{score:o,completion:a}=i[r];if(o[0]!==n)break;if(a.preselect)return r}return 0}}class Moe extends FQ{constructor(){super("first")}memorize(e,t,i){}toJSON(){}fromJSON(){}}class dJe extends FQ{constructor(){super("recentlyUsed"),this._cache=new $h(300,.66),this._seq=0}memorize(e,t,i){const n=`${e.getLanguageId()}/${i.textLabel}`;this._cache.set(n,{touch:this._seq++,type:i.completion.kind,insertText:i.completion.insertText})}select(e,t,i){if(i.length===0)return 0;const n=e.getLineContent(t.lineNumber).substr(t.column-10,t.column-1);if(/\s$/.test(n))return super.select(e,t,i);const r=i[0].score[0];let o=-1,a=-1,l=-1;for(let c=0;c<i.length&&i[c].score[0]===r;c++){const d=`${e.getLanguageId()}/${i[c].textLabel}`,u=this._cache.peek(d);if(u&&u.touch>l&&u.type===i[c].completion.kind&&u.insertText===i[c].completion.insertText&&(l=u.touch,a=c),i[c].completion.preselect&&o===-1)return o=c}return a!==-1?a:o!==-1?o:0}toJSON(){return this._cache.toJSON()}fromJSON(e){this._cache.clear();const t=0;for(const[i,n]of e)n.touch=t,n.type=typeof n.type=="number"?n.type:Xk.fromString(n.type),this._cache.set(i,n);this._seq=this._cache.size}}class uJe extends FQ{constructor(){super("recentlyUsedByPrefix"),this._trie=Cy.forStrings(),this._seq=0}memorize(e,t,i){const{word:n}=e.getWordUntilPosition(t),r=`${e.getLanguageId()}/${n}`;this._trie.set(r,{type:i.completion.kind,insertText:i.completion.insertText,touch:this._seq++})}select(e,t,i){const{word:n}=e.getWordUntilPosition(t);if(!n)return super.select(e,t,i);const r=`${e.getLanguageId()}/${n}`;let o=this._trie.get(r);if(o||(o=this._trie.findSubstr(r)),o)for(let a=0;a<i.length;a++){const{kind:l,insertText:c}=i[a].completion;if(l===o.type&&c===o.insertText)return a}return super.select(e,t,i)}toJSON(){const e=[];return this._trie.forEach((t,i)=>e.push([i,t])),e.sort((t,i)=>-(t[1].touch-i[1].touch)).forEach((t,i)=>t[1].touch=i),e.slice(0,200)}fromJSON(e){if(this._trie.clear(),e.length>0){this._seq=e[0][1].touch+1;for(const[t,i]of e)i.type=typeof i.type=="number"?i.type:Xk.fromString(i.type),this._trie.set(t,i)}}}var xm;let CU=(xm=class{constructor(e,t){this._storageService=e,this._configService=t,this._disposables=new ce,this._persistSoon=new xi(()=>this._saveState(),500),this._disposables.add(e.onWillSaveState(i=>{i.reason===kI.SHUTDOWN&&this._saveState()}))}dispose(){this._disposables.dispose(),this._persistSoon.dispose()}memorize(e,t,i){this._withStrategy(e,t).memorize(e,t,i),this._persistSoon.schedule()}select(e,t,i){return this._withStrategy(e,t).select(e,t,i)}_withStrategy(e,t){var n;const i=this._configService.getValue("editor.suggestSelection",{overrideIdentifier:e.getLanguageIdAtPosition(t.lineNumber,t.column),resource:e.uri});if(((n=this._strategy)==null?void 0:n.name)!==i){this._saveState();const r=uL._strategyCtors.get(i)||Moe;this._strategy=new r;try{const a=this._configService.getValue("editor.suggest.shareSuggestSelections")?0:1,l=this._storageService.get(`${uL._storagePrefix}/${i}`,a);l&&this._strategy.fromJSON(JSON.parse(l))}catch{}}return this._strategy}_saveState(){if(this._strategy){const t=this._configService.getValue("editor.suggest.shareSuggestSelections")?0:1,i=JSON.stringify(this._strategy);this._storageService.store(`${uL._storagePrefix}/${this._strategy.name}`,i,t,1)}}},uL=xm,xm._strategyCtors=new Map([["recentlyUsedByPrefix",uJe],["recentlyUsed",dJe],["first",Moe]]),xm._storagePrefix="suggest/memories",xm);CU=uL=cJe([Poe(0,md),Poe(1,At)],CU);const L5=Ht("ISuggestMemories");qt(L5,CU,1);var hJe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},fJe=function(s,e){return function(t,i){e(t,i,s)}},yU,Mv;let tM=(Mv=class{constructor(e,t){this._editor=e,this._enabled=!1,this._ckAtEnd=yU.AtEnd.bindTo(t),this._configListener=this._editor.onDidChangeConfiguration(i=>i.hasChanged(124)&&this._update()),this._update()}dispose(){var e;this._configListener.dispose(),(e=this._selectionListener)==null||e.dispose(),this._ckAtEnd.reset()}_update(){const e=this._editor.getOption(124)==="on";if(this._enabled!==e)if(this._enabled=e,this._enabled){const t=()=>{if(!this._editor.hasModel()){this._ckAtEnd.set(!1);return}const i=this._editor.getModel(),n=this._editor.getSelection(),r=i.getWordAtPosition(n.getStartPosition());if(!r){this._ckAtEnd.set(!1);return}this._ckAtEnd.set(r.endColumn===n.getStartPosition().column)};this._selectionListener=this._editor.onDidChangeCursorSelection(t),t()}else this._selectionListener&&(this._ckAtEnd.reset(),this._selectionListener.dispose(),this._selectionListener=void 0)}},yU=Mv,Mv.AtEnd=new Oe("atEndOfWord",!1),Mv);tM=yU=hJe([fJe(1,ct)],tM);var gJe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},pJe=function(s,e){return function(t,i){e(t,i,s)}},hL,Ov;let $1=(Ov=class{constructor(e,t){this._editor=e,this._index=0,this._ckOtherSuggestions=hL.OtherSuggestions.bindTo(t)}dispose(){this.reset()}reset(){var e;this._ckOtherSuggestions.reset(),(e=this._listener)==null||e.dispose(),this._model=void 0,this._acceptNext=void 0,this._ignore=!1}set({model:e,index:t},i){if(e.items.length===0){this.reset();return}if(hL._moveIndex(!0,e,t)===t){this.reset();return}this._acceptNext=i,this._model=e,this._index=t,this._listener=this._editor.onDidChangeCursorPosition(()=>{this._ignore||this.reset()}),this._ckOtherSuggestions.set(!0)}static _moveIndex(e,t,i){let n=i;for(let r=t.items.length;r>0&&(n=(n+t.items.length+(e?1:-1))%t.items.length,!(n===i||!t.items[n].completion.additionalTextEdits));r--);return n}next(){this._move(!0)}prev(){this._move(!1)}_move(e){if(this._model)try{this._ignore=!0,this._index=hL._moveIndex(e,this._model,this._index),this._acceptNext({index:this._index,item:this._model.items[this._index],model:this._model})}finally{this._ignore=!1}}},hL=Ov,Ov.OtherSuggestions=new Oe("hasOtherSuggestions",!1),Ov);$1=hL=gJe([pJe(1,ct)],$1);class mJe{constructor(e,t,i,n){this._disposables=new ce,this._disposables.add(i.onDidSuggest(r=>{r.completionModel.items.length===0&&this.reset()})),this._disposables.add(i.onDidCancel(r=>{this.reset()})),this._disposables.add(t.onDidShow(()=>this._onItem(t.getFocusedItem()))),this._disposables.add(t.onDidFocus(this._onItem,this)),this._disposables.add(t.onDidHide(this.reset,this)),this._disposables.add(e.onWillType(r=>{if(this._active&&!t.isFrozen()&&i.state!==0){const o=r.charCodeAt(r.length-1);this._active.acceptCharacters.has(o)&&e.getOption(0)&&n(this._active.item)}}))}_onItem(e){if(!e||!Xr(e.item.completion.commitCharacters)){this.reset();return}if(this._active&&this._active.item.item===e.item)return;const t=new Z2;for(const i of e.item.completion.commitCharacters)i.length>0&&t.add(i.charCodeAt(0));this._active={acceptCharacters:t,item:e}}reset(){this._active=void 0}dispose(){this._disposables.dispose()}}const ec=class ec{async provideSelectionRanges(e,t){const i=[];for(const n of t){const r=[];i.push(r);const o=new Map;await new Promise(a=>ec._bracketsRightYield(a,0,e,n,o)),await new Promise(a=>ec._bracketsLeftYield(a,0,e,n,o,r))}return i}static _bracketsRightYield(e,t,i,n,r){const o=new Map,a=Date.now();for(;;){if(t>=ec._maxRounds){e();break}if(!n){e();break}const l=i.bracketPairs.findNextBracket(n);if(!l){e();break}if(Date.now()-a>ec._maxDuration){setTimeout(()=>ec._bracketsRightYield(e,t+1,i,n,r));break}if(l.bracketInfo.isOpeningBracket){const d=l.bracketInfo.bracketText,u=o.has(d)?o.get(d):0;o.set(d,u+1)}else{const d=l.bracketInfo.getOpeningBrackets()[0].bracketText;let u=o.has(d)?o.get(d):0;if(u-=1,o.set(d,Math.max(0,u)),u<0){let h=r.get(d);h||(h=new _o,r.set(d,h)),h.push(l.range)}}n=l.range.getEndPosition()}}static _bracketsLeftYield(e,t,i,n,r,o){const a=new Map,l=Date.now();for(;;){if(t>=ec._maxRounds&&r.size===0){e();break}if(!n){e();break}const c=i.bracketPairs.findPrevBracket(n);if(!c){e();break}if(Date.now()-l>ec._maxDuration){setTimeout(()=>ec._bracketsLeftYield(e,t+1,i,n,r,o));break}if(c.bracketInfo.isOpeningBracket){const u=c.bracketInfo.bracketText;let h=a.has(u)?a.get(u):0;if(h-=1,a.set(u,Math.max(0,h)),h<0){const g=r.get(u);if(g){const p=g.shift();g.size===0&&r.delete(u);const _=F.fromPositions(c.range.getEndPosition(),p.getStartPosition()),v=F.fromPositions(c.range.getStartPosition(),p.getEndPosition());o.push({range:_}),o.push({range:v}),ec._addBracketLeading(i,v,o)}}}else{const u=c.bracketInfo.getOpeningBrackets()[0].bracketText,h=a.has(u)?a.get(u):0;a.set(u,h+1)}n=c.range.getStartPosition()}}static _addBracketLeading(e,t,i){if(t.startLineNumber===t.endLineNumber)return;const n=t.startLineNumber,r=e.getLineFirstNonWhitespaceColumn(n);r!==0&&r!==t.startColumn&&(i.push({range:F.fromPositions(new X(n,r),t.getEndPosition())}),i.push({range:F.fromPositions(new X(n,1),t.getEndPosition())}));const o=n-1;if(o>0){const a=e.getLineFirstNonWhitespaceColumn(o);a===t.startColumn&&a!==e.getLineLastNonWhitespaceColumn(o)&&(i.push({range:F.fromPositions(new X(o,a),t.getEndPosition())}),i.push({range:F.fromPositions(new X(o,1),t.getEndPosition())}))}}};ec._maxDuration=30,ec._maxRounds=2;let iM=ec;const eh=class eh{static async create(e,t){if(!t.getOption(119).localityBonus||!t.hasModel())return eh.None;const i=t.getModel(),n=t.getPosition();if(!e.canComputeWordRanges(i.uri))return eh.None;const[r]=await new iM().provideSelectionRanges(i,[n]);if(r.length===0)return eh.None;const o=await e.computeWordRanges(i.uri,r[0].range);if(!o)return eh.None;const a=i.getWordUntilPosition(n);return delete o[a.word],new class extends eh{distance(l,c){if(!n.equals(t.getPosition()))return 0;if(c.kind===17)return 2<<20;const d=typeof c.label=="string"?c.label:c.label.label,u=o[d];if(Kde(u))return 2<<20;const h=$k(u,F.fromPositions(l),F.compareRangesUsingStarts),g=h>=0?u[h]:u[Math.max(0,~h-1)];let p=r.length;for(const _ of r){if(!F.containsRange(_.range,g))break;p-=1}return p}}}};eh.None=new class extends eh{distance(){return 0}};let nM=eh,Ooe=class{constructor(e,t){this.leadingLineContent=e,this.characterCountDelta=t}};class Vp{constructor(e,t,i,n,r,o,a=vI.default,l=void 0){this.clipboardText=l,this._snippetCompareFn=Vp._compareCompletionItems,this._items=e,this._column=t,this._wordDistance=n,this._options=r,this._refilterKind=1,this._lineContext=i,this._fuzzyScoreOptions=a,o==="top"?this._snippetCompareFn=Vp._compareCompletionItemsSnippetsUp:o==="bottom"&&(this._snippetCompareFn=Vp._compareCompletionItemsSnippetsDown)}get lineContext(){return this._lineContext}set lineContext(e){(this._lineContext.leadingLineContent!==e.leadingLineContent||this._lineContext.characterCountDelta!==e.characterCountDelta)&&(this._refilterKind=this._lineContext.characterCountDelta<e.characterCountDelta&&this._filteredItems?2:1,this._lineContext=e)}get items(){return this._ensureCachedState(),this._filteredItems}getItemsByProvider(){return this._ensureCachedState(),this._itemsByProvider}getIncompleteProvider(){this._ensureCachedState();const e=new Set;for(const[t,i]of this.getItemsByProvider())i.length>0&&i[0].container.incomplete&&e.add(t);return e}get stats(){return this._ensureCachedState(),this._stats}_ensureCachedState(){this._refilterKind!==0&&this._createCachedState()}_createCachedState(){this._itemsByProvider=new Map;const e=[],{leadingLineContent:t,characterCountDelta:i}=this._lineContext;let n="",r="";const o=this._refilterKind===1?this._items:this._filteredItems,a=[],l=!this._options.filterGraceful||o.length>2e3?mw:r5e;for(let c=0;c<o.length;c++){const d=o[c];if(d.isInvalid)continue;const u=this._itemsByProvider.get(d.provider);u?u.push(d):this._itemsByProvider.set(d.provider,[d]);const h=d.position.column-d.editStart.column,g=h+i-(d.position.column-this._column);if(n.length!==g&&(n=g===0?"":t.slice(-g),r=n.toLowerCase()),d.word=n,g===0)d.score=ou.Default;else{let p=0;for(;p<h;){const _=n.charCodeAt(p);if(_===32||_===9)p+=1;else break}if(p>=g)d.score=ou.Default;else if(typeof d.completion.filterText=="string"){const _=l(n,r,p,d.completion.filterText,d.filterTextLow,0,this._fuzzyScoreOptions);if(!_)continue;BW(d.completion.filterText,d.textLabel)===0?d.score=_:(d.score=t5e(n,r,p,d.textLabel,d.labelLow,0),d.score[0]=_[0])}else{const _=l(n,r,p,d.textLabel,d.labelLow,0,this._fuzzyScoreOptions);if(!_)continue;d.score=_}}d.idx=c,d.distance=this._wordDistance.distance(d.position,d.completion),a.push(d),e.push(d.textLabel.length)}this._filteredItems=a.sort(this._snippetCompareFn),this._refilterKind=0,this._stats={pLabelLen:e.length?T7(e.length-.85,e,(c,d)=>c-d):0}}static _compareCompletionItems(e,t){return e.score[0]>t.score[0]?-1:e.score[0]<t.score[0]?1:e.distance<t.distance?-1:e.distance>t.distance?1:e.idx<t.idx?-1:e.idx>t.idx?1:0}static _compareCompletionItemsSnippetsDown(e,t){if(e.completion.kind!==t.completion.kind){if(e.completion.kind===27)return 1;if(t.completion.kind===27)return-1}return Vp._compareCompletionItems(e,t)}static _compareCompletionItemsSnippetsUp(e,t){if(e.completion.kind!==t.completion.kind){if(e.completion.kind===27)return-1;if(t.completion.kind===27)return 1}return Vp._compareCompletionItems(e,t)}}var _Je=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},mp=function(s,e){return function(t,i){e(t,i,s)}},SU;class eb{static shouldAutoTrigger(e){if(!e.hasModel())return!1;const t=e.getModel(),i=e.getPosition();t.tokenization.tokenizeIfCheap(i.lineNumber);const n=t.getWordAtPosition(i);return!(!n||n.endColumn!==i.column&&n.startColumn+1!==i.column||!isNaN(Number(n.word)))}constructor(e,t,i){this.leadingLineContent=e.getLineContent(t.lineNumber).substr(0,t.column-1),this.leadingWord=e.getWordUntilPosition(t),this.lineNumber=t.lineNumber,this.column=t.column,this.triggerOptions=i}}function bJe(s,e,t){if(!e.getContextKeyValue(Ma.inlineSuggestionVisible.key))return!0;const i=e.getContextKeyValue(Ma.suppressSuggestions.key);return i!==void 0?!i:!s.getOption(62).suppressSuggestions}function vJe(s,e,t){if(!e.getContextKeyValue("inlineSuggestionVisible"))return!0;const i=e.getContextKeyValue(Ma.suppressSuggestions.key);return i!==void 0?!i:!s.getOption(62).suppressSuggestions}let sM=SU=class{constructor(e,t,i,n,r,o,a,l,c){this._editor=e,this._editorWorkerService=t,this._clipboardService=i,this._telemetryService=n,this._logService=r,this._contextKeyService=o,this._configurationService=a,this._languageFeaturesService=l,this._envService=c,this._toDispose=new ce,this._triggerCharacterListener=new ce,this._triggerQuickSuggest=new gd,this._triggerState=void 0,this._completionDisposables=new ce,this._onDidCancel=new Z,this._onDidTrigger=new Z,this._onDidSuggest=new Z,this.onDidCancel=this._onDidCancel.event,this.onDidTrigger=this._onDidTrigger.event,this.onDidSuggest=this._onDidSuggest.event,this._telemetryGate=0,this._currentSelection=this._editor.getSelection()||new Ue(1,1,1,1),this._toDispose.add(this._editor.onDidChangeModel(()=>{this._updateTriggerCharacters(),this.cancel()})),this._toDispose.add(this._editor.onDidChangeModelLanguage(()=>{this._updateTriggerCharacters(),this.cancel()})),this._toDispose.add(this._editor.onDidChangeConfiguration(()=>{this._updateTriggerCharacters()})),this._toDispose.add(this._languageFeaturesService.completionProvider.onDidChange(()=>{this._updateTriggerCharacters(),this._updateActiveSuggestSession()}));let d=!1;this._toDispose.add(this._editor.onDidCompositionStart(()=>{d=!0})),this._toDispose.add(this._editor.onDidCompositionEnd(()=>{d=!1,this._onCompositionEnd()})),this._toDispose.add(this._editor.onDidChangeCursorSelection(u=>{d||this._onCursorChange(u)})),this._toDispose.add(this._editor.onDidChangeModelContent(()=>{!d&&this._triggerState!==void 0&&this._refilterCompletionItems()})),this._updateTriggerCharacters()}dispose(){Ni(this._triggerCharacterListener),Ni([this._onDidCancel,this._onDidSuggest,this._onDidTrigger,this._triggerQuickSuggest]),this._toDispose.dispose(),this._completionDisposables.dispose(),this.cancel()}_updateTriggerCharacters(){if(this._triggerCharacterListener.clear(),this._editor.getOption(92)||!this._editor.hasModel()||!this._editor.getOption(122))return;const e=new Map;for(const i of this._languageFeaturesService.completionProvider.all(this._editor.getModel()))for(const n of i.triggerCharacters||[]){let r=e.get(n);r||(r=new Set,e.set(n,r)),r.add(i)}const t=i=>{var o;if(!vJe(this._editor,this._contextKeyService,this._configurationService)||eb.shouldAutoTrigger(this._editor))return;if(!i){const a=this._editor.getPosition();i=this._editor.getModel().getLineContent(a.lineNumber).substr(0,a.column-1)}let n="";cw(i.charCodeAt(i.length-1))?ws(i.charCodeAt(i.length-2))&&(n=i.substr(i.length-2)):n=i.charAt(i.length-1);const r=e.get(n);if(r){const a=new Map;if(this._completionModel)for(const[l,c]of this._completionModel.getItemsByProvider())r.has(l)||a.set(l,c);this.trigger({auto:!0,triggerKind:1,triggerCharacter:n,retrigger:!!this._completionModel,clipboardText:(o=this._completionModel)==null?void 0:o.clipboardText,completionOptions:{providerFilter:r,providerItemsToReuse:a}})}};this._triggerCharacterListener.add(this._editor.onDidType(t)),this._triggerCharacterListener.add(this._editor.onDidCompositionEnd(()=>t()))}get state(){return this._triggerState?this._triggerState.auto?2:1:0}cancel(e=!1){var t;this._triggerState!==void 0&&(this._triggerQuickSuggest.cancel(),(t=this._requestToken)==null||t.cancel(),this._requestToken=void 0,this._triggerState=void 0,this._completionModel=void 0,this._context=void 0,this._onDidCancel.fire({retrigger:e}))}clear(){this._completionDisposables.clear()}_updateActiveSuggestSession(){this._triggerState!==void 0&&(!this._editor.hasModel()||!this._languageFeaturesService.completionProvider.has(this._editor.getModel())?this.cancel():this.trigger({auto:this._triggerState.auto,retrigger:!0}))}_onCursorChange(e){if(!this._editor.hasModel())return;const t=this._currentSelection;if(this._currentSelection=this._editor.getSelection(),!e.selection.isEmpty()||e.reason!==0&&e.reason!==3||e.source!=="keyboard"&&e.source!=="deleteLeft"){this.cancel();return}this._triggerState===void 0&&e.reason===0?(t.containsRange(this._currentSelection)||t.getEndPosition().isBeforeOrEqual(this._currentSelection.getPosition()))&&this._doTriggerQuickSuggest():this._triggerState!==void 0&&e.reason===3&&this._refilterCompletionItems()}_onCompositionEnd(){this._triggerState===void 0?this._doTriggerQuickSuggest():this._refilterCompletionItems()}_doTriggerQuickSuggest(){var e;UC.isAllOff(this._editor.getOption(90))||this._editor.getOption(119).snippetsPreventQuickSuggestions&&((e=Do.get(this._editor))!=null&&e.isInSnippet())||(this.cancel(),this._triggerQuickSuggest.cancelAndSet(()=>{if(this._triggerState!==void 0||!eb.shouldAutoTrigger(this._editor)||!this._editor.hasModel()||!this._editor.hasWidgetFocus())return;const t=this._editor.getModel(),i=this._editor.getPosition(),n=this._editor.getOption(90);if(!UC.isAllOff(n)){if(!UC.isAllOn(n)){t.tokenization.tokenizeIfCheap(i.lineNumber);const r=t.tokenization.getLineTokens(i.lineNumber),o=r.getStandardTokenType(r.findTokenIndexAtOffset(Math.max(i.column-1-1,0)));if(UC.valueFor(n,o)!=="on")return}bJe(this._editor,this._contextKeyService,this._configurationService)&&this._languageFeaturesService.completionProvider.has(t)&&this.trigger({auto:!0})}},this._editor.getOption(91)))}_refilterCompletionItems(){ii(this._editor.hasModel()),ii(this._triggerState!==void 0);const e=this._editor.getModel(),t=this._editor.getPosition(),i=new eb(e,t,{...this._triggerState,refilter:!0});this._onNewContext(i)}trigger(e){var h,g,p;if(!this._editor.hasModel())return;const t=this._editor.getModel(),i=new eb(t,this._editor.getPosition(),e);this.cancel(e.retrigger),this._triggerState=e,this._onDidTrigger.fire({auto:e.auto,shy:e.shy??!1,position:this._editor.getPosition()}),this._context=i;let n={triggerKind:e.triggerKind??0};e.triggerCharacter&&(n={triggerKind:1,triggerCharacter:e.triggerCharacter}),this._requestToken=new mn;const r=this._editor.getOption(113);let o=1;switch(r){case"top":o=0;break;case"bottom":o=2;break}const{itemKind:a,showDeprecated:l}=SU.createSuggestFilter(this._editor),c=new dE(o,((h=e.completionOptions)==null?void 0:h.kindFilter)??a,(g=e.completionOptions)==null?void 0:g.providerFilter,(p=e.completionOptions)==null?void 0:p.providerItemsToReuse,l),d=nM.create(this._editorWorkerService,this._editor),u=MQ(this._languageFeaturesService.completionProvider,t,this._editor.getPosition(),c,n,this._requestToken.token);Promise.all([u,d]).then(async([_,v])=>{var I;if((I=this._requestToken)==null||I.dispose(),!this._editor.hasModel())return;let C=e==null?void 0:e.clipboardText;if(!C&&_.needsClipboard&&(C=await this._clipboardService.readText()),this._triggerState===void 0)return;const y=this._editor.getModel(),x=new eb(y,this._editor.getPosition(),e),L={...vI.default,firstMatchCanBeWeak:!this._editor.getOption(119).matchOnWordStartOnly};if(this._completionModel=new Vp(_.items,this._context.column,{leadingLineContent:x.leadingLineContent,characterCountDelta:x.column-this._context.column},v,this._editor.getOption(119),this._editor.getOption(113),L,C),this._completionDisposables.add(_.disposable),this._onNewContext(x),this._reportDurationsTelemetry(_.durations),!this._envService.isBuilt||this._envService.isExtensionDevelopment)for(const A of _.items)A.isInvalid&&this._logService.warn(`[suggest] did IGNORE invalid completion item from ${A.provider._debugDisplayName}`,A.completion)}).catch(ft)}_reportDurationsTelemetry(e){this._telemetryGate++%230===0&&setTimeout(()=>{this._telemetryService.publicLog2("suggest.durations.json",{data:JSON.stringify(e)}),this._logService.debug("suggest.durations.json",e)})}static createSuggestFilter(e){const t=new Set;e.getOption(113)==="none"&&t.add(27);const n=e.getOption(119);return n.showMethods||t.add(0),n.showFunctions||t.add(1),n.showConstructors||t.add(2),n.showFields||t.add(3),n.showVariables||t.add(4),n.showClasses||t.add(5),n.showStructs||t.add(6),n.showInterfaces||t.add(7),n.showModules||t.add(8),n.showProperties||t.add(9),n.showEvents||t.add(10),n.showOperators||t.add(11),n.showUnits||t.add(12),n.showValues||t.add(13),n.showConstants||t.add(14),n.showEnums||t.add(15),n.showEnumMembers||t.add(16),n.showKeywords||t.add(17),n.showWords||t.add(18),n.showColors||t.add(19),n.showFiles||t.add(20),n.showReferences||t.add(21),n.showColors||t.add(22),n.showFolders||t.add(23),n.showTypeParameters||t.add(24),n.showSnippets||t.add(27),n.showUsers||t.add(25),n.showIssues||t.add(26),{itemKind:t,showDeprecated:n.showDeprecated}}_onNewContext(e){if(this._context){if(e.lineNumber!==this._context.lineNumber){this.cancel();return}if(Ti(e.leadingLineContent)!==Ti(this._context.leadingLineContent)){this.cancel();return}if(e.column<this._context.column){e.leadingWord.word?this.trigger({auto:this._context.triggerOptions.auto,retrigger:!0}):this.cancel();return}if(this._completionModel){if(e.leadingWord.word.length!==0&&e.leadingWord.startColumn>this._context.leadingWord.startColumn){if(eb.shouldAutoTrigger(this._editor)&&this._context){const i=this._completionModel.getItemsByProvider();this.trigger({auto:this._context.triggerOptions.auto,retrigger:!0,clipboardText:this._completionModel.clipboardText,completionOptions:{providerItemsToReuse:i}})}return}if(e.column>this._context.column&&this._completionModel.getIncompleteProvider().size>0&&e.leadingWord.word.length!==0){const t=new Map,i=new Set;for(const[n,r]of this._completionModel.getItemsByProvider())r.length>0&&r[0].container.incomplete?i.add(n):t.set(n,r);this.trigger({auto:this._context.triggerOptions.auto,triggerKind:2,retrigger:!0,clipboardText:this._completionModel.clipboardText,completionOptions:{providerFilter:i,providerItemsToReuse:t}})}else{const t=this._completionModel.lineContext;let i=!1;if(this._completionModel.lineContext={leadingLineContent:e.leadingLineContent,characterCountDelta:e.column-this._context.column},this._completionModel.items.length===0){const n=eb.shouldAutoTrigger(this._editor);if(!this._context){this.cancel();return}if(n&&this._context.leadingWord.endColumn<e.leadingWord.startColumn){this.trigger({auto:this._context.triggerOptions.auto,retrigger:!0});return}if(this._context.triggerOptions.auto){this.cancel();return}else if(this._completionModel.lineContext=t,i=this._completionModel.items.length>0,i&&e.leadingWord.word.length===0){this.cancel();return}}this._onDidSuggest.fire({completionModel:this._completionModel,triggerOptions:e.triggerOptions,isFrozen:i})}}}}};sM=SU=_Je([mp(1,ca),mp(2,Wg),mp(3,Tr),mp(4,pr),mp(5,ct),mp(6,At),mp(7,Be),mp(8,nK)],sM);const AO=class AO{constructor(e,t){this._disposables=new ce,this._lastOvertyped=[],this._locked=!1,this._disposables.add(e.onWillType(()=>{if(this._locked||!e.hasModel())return;const i=e.getSelections(),n=i.length;let r=!1;for(let a=0;a<n;a++)if(!i[a].isEmpty()){r=!0;break}if(!r){this._lastOvertyped.length!==0&&(this._lastOvertyped.length=0);return}this._lastOvertyped=[];const o=e.getModel();for(let a=0;a<n;a++){const l=i[a];if(o.getValueLengthInRange(l)>AO._maxSelectionLength)return;this._lastOvertyped[a]={value:o.getValueInRange(l),multiline:l.startLineNumber!==l.endLineNumber}}})),this._disposables.add(t.onDidTrigger(i=>{this._locked=!0})),this._disposables.add(t.onDidCancel(i=>{this._locked=!1}))}getLastOvertypedInfo(e){if(e>=0&&e<this._lastOvertyped.length)return this._lastOvertyped[e]}dispose(){this._disposables.dispose()}};AO._maxSelectionLength=51200;let xU=AO;var wJe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},OB=function(s,e){return function(t,i){e(t,i,s)}};let LU=class{constructor(e,t,i,n,r){this._menuId=t,this._menuService=n,this._contextKeyService=r,this._menuDisposables=new ce,this.element=me(e,ke(".suggest-status-bar"));const o=a=>a instanceof Ra?i.createInstance(MK,a,{useComma:!0}):void 0;this._leftActions=new Dl(this.element,{actionViewItemProvider:o}),this._rightActions=new Dl(this.element,{actionViewItemProvider:o}),this._leftActions.domNode.classList.add("left"),this._rightActions.domNode.classList.add("right")}dispose(){this._menuDisposables.dispose(),this._leftActions.dispose(),this._rightActions.dispose(),this.element.remove()}show(){const e=this._menuService.createMenu(this._menuId,this._contextKeyService),t=()=>{const i=[],n=[];for(const[r,o]of e.getActions())r==="left"?i.push(...o):n.push(...o);this._leftActions.clear(),this._leftActions.push(i),this._rightActions.clear(),this._rightActions.push(n)};this._menuDisposables.add(e.onDidChange(()=>t())),this._menuDisposables.add(e)}hide(){this._menuDisposables.clear()}};LU=wJe([OB(2,Xe),OB(3,Ol),OB(4,ct)],LU);var CJe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},yJe=function(s,e){return function(t,i){e(t,i,s)}};function VQ(s){return!!s&&!!(s.completion.documentation||s.completion.detail&&s.completion.detail!==s.completion.label)}let kU=class{constructor(e,t){this._editor=e,this._onDidClose=new Z,this.onDidClose=this._onDidClose.event,this._onDidChangeContents=new Z,this.onDidChangeContents=this._onDidChangeContents.event,this._disposables=new ce,this._renderDisposeable=new ce,this._borderWidth=1,this._size=new Ci(330,0),this.domNode=ke(".suggest-details"),this.domNode.classList.add("no-docs"),this._markdownRenderer=t.createInstance(kg,{editor:e}),this._body=ke(".body"),this._scrollbar=new QE(this._body,{alwaysConsumeMouseWheel:!0}),me(this.domNode,this._scrollbar.getDomNode()),this._disposables.add(this._scrollbar),this._header=me(this._body,ke(".header")),this._close=me(this._header,ke("span"+at.asCSSSelector(xe.close))),this._close.title=b("details.close","Close"),this._type=me(this._header,ke("p.type")),this._docs=me(this._body,ke("p.docs")),this._configureFont(),this._disposables.add(this._editor.onDidChangeConfiguration(i=>{i.hasChanged(50)&&this._configureFont()}))}dispose(){this._disposables.dispose(),this._renderDisposeable.dispose()}_configureFont(){const e=this._editor.getOptions(),t=e.get(50),i=t.getMassagedFontFamily(),n=e.get(120)||t.fontSize,r=e.get(121)||t.lineHeight,o=t.fontWeight,a=`${n}px`,l=`${r}px`;this.domNode.style.fontSize=a,this.domNode.style.lineHeight=`${r/n}`,this.domNode.style.fontWeight=o,this.domNode.style.fontFeatureSettings=t.fontFeatureSettings,this._type.style.fontFamily=i,this._close.style.height=l,this._close.style.width=l}getLayoutInfo(){const e=this._editor.getOption(121)||this._editor.getOption(50).lineHeight,t=this._borderWidth,i=t*2;return{lineHeight:e,borderWidth:t,borderHeight:i,verticalPadding:22,horizontalPadding:14}}renderLoading(){this._type.textContent=b("loading","Loading..."),this._docs.textContent="",this.domNode.classList.remove("no-docs","no-type"),this.layout(this.size.width,this.getLayoutInfo().lineHeight*2),this._onDidChangeContents.fire(this)}renderItem(e,t){var r;this._renderDisposeable.clear();let{detail:i,documentation:n}=e.completion;if(t){let o="";o+=`score: ${e.score[0]}
`,o+=`prefix: ${e.word??"(no prefix)"}
`,o+=`word: ${e.completion.filterText?e.completion.filterText+" (filterText)":e.textLabel}
`,o+=`distance: ${e.distance} (localityBonus-setting)
`,o+=`index: ${e.idx}, based on ${e.completion.sortText&&`sortText: "${e.completion.sortText}"`||"label"}
`,o+=`commit_chars: ${(r=e.completion.commitCharacters)==null?void 0:r.join("")}
`,n=new Lr().appendCodeblock("empty",o),i=`Provider: ${e.provider._debugDisplayName}`}if(!t&&!VQ(e)){this.clearContents();return}if(this.domNode.classList.remove("no-docs","no-type"),i){const o=i.length>1e5?`${i.substr(0,1e5)}…`:i;this._type.textContent=o,this._type.title=o,ka(this._type),this._type.classList.toggle("auto-wrap",!/\r?\n^\s+/gmi.test(o))}else Ys(this._type),this._type.title="",fo(this._type),this.domNode.classList.add("no-type");if(Ys(this._docs),typeof n=="string")this._docs.classList.remove("markdown-docs"),this._docs.textContent=n;else if(n){this._docs.classList.add("markdown-docs"),Ys(this._docs);const o=this._markdownRenderer.render(n);this._docs.appendChild(o.element),this._renderDisposeable.add(o),this._renderDisposeable.add(this._markdownRenderer.onDidRenderAsync(()=>{this.layout(this._size.width,this._type.clientHeight+this._docs.clientHeight),this._onDidChangeContents.fire(this)}))}this.domNode.style.userSelect="text",this.domNode.tabIndex=-1,this._close.onmousedown=o=>{o.preventDefault(),o.stopPropagation()},this._close.onclick=o=>{o.preventDefault(),o.stopPropagation(),this._onDidClose.fire()},this._body.scrollTop=0,this.layout(this._size.width,this._type.clientHeight+this._docs.clientHeight),this._onDidChangeContents.fire(this)}clearContents(){this.domNode.classList.add("no-docs"),this._type.textContent="",this._docs.textContent=""}get isEmpty(){return this.domNode.classList.contains("no-docs")}get size(){return this._size}layout(e,t){const i=new Ci(e,t);Ci.equals(i,this._size)||(this._size=i,K2e(this.domNode,e,t)),this._scrollbar.scanDomNode()}scrollDown(e=8){this._body.scrollTop+=e}scrollUp(e=8){this._body.scrollTop-=e}scrollTop(){this._body.scrollTop=0}scrollBottom(){this._body.scrollTop=this._body.scrollHeight}pageDown(){this.scrollDown(80)}pageUp(){this.scrollUp(80)}set borderWidth(e){this._borderWidth=e}get borderWidth(){return this._borderWidth}};kU=CJe([yJe(1,Xe)],kU);class SJe{constructor(e,t){this.widget=e,this._editor=t,this.allowEditorOverflow=!0,this._disposables=new ce,this._added=!1,this._preferAlignAtTop=!0,this._resizable=new _Q,this._resizable.domNode.classList.add("suggest-details-container"),this._resizable.domNode.appendChild(e.domNode),this._resizable.enableSashes(!1,!0,!0,!1);let i,n,r=0,o=0;this._disposables.add(this._resizable.onDidWillResize(()=>{i=this._topLeft,n=this._resizable.size})),this._disposables.add(this._resizable.onDidResize(a=>{if(i&&n){this.widget.layout(a.dimension.width,a.dimension.height);let l=!1;a.west&&(o=n.width-a.dimension.width,l=!0),a.north&&(r=n.height-a.dimension.height,l=!0),l&&this._applyTopLeft({top:i.top+r,left:i.left+o})}a.done&&(i=void 0,n=void 0,r=0,o=0,this._userSize=a.dimension)})),this._disposables.add(this.widget.onDidChangeContents(()=>{this._anchorBox&&this._placeAtAnchor(this._anchorBox,this._userSize??this.widget.size,this._preferAlignAtTop)}))}dispose(){this._resizable.dispose(),this._disposables.dispose(),this.hide()}getId(){return"suggest.details"}getDomNode(){return this._resizable.domNode}getPosition(){return this._topLeft?{preference:this._topLeft}:null}show(){this._added||(this._editor.addOverlayWidget(this),this._added=!0)}hide(e=!1){this._resizable.clearSashHoverState(),this._added&&(this._editor.removeOverlayWidget(this),this._added=!1,this._anchorBox=void 0,this._topLeft=void 0),e&&(this._userSize=void 0,this.widget.clearContents())}placeAtAnchor(e,t){const i=e.getBoundingClientRect();this._anchorBox=i,this._preferAlignAtTop=t,this._placeAtAnchor(this._anchorBox,this._userSize??this.widget.size,t)}_placeAtAnchor(e,t,i){const n=qm(this.getDomNode().ownerDocument.body),r=this.widget.getLayoutInfo(),o=new Ci(220,2*r.lineHeight),a=e.top,l=function(){const I=n.width-(e.left+e.width+r.borderWidth+r.horizontalPadding),A=-r.borderWidth+e.left+e.width,D=new Ci(I,n.height-e.top-r.borderHeight-r.verticalPadding),N=D.with(void 0,e.top+e.height-r.borderHeight-r.verticalPadding);return{top:a,left:A,fit:I-t.width,maxSizeTop:D,maxSizeBottom:N,minSize:o.with(Math.min(I,o.width))}}(),c=function(){const I=e.left-r.borderWidth-r.horizontalPadding,A=Math.max(r.horizontalPadding,e.left-t.width-r.borderWidth),D=new Ci(I,n.height-e.top-r.borderHeight-r.verticalPadding),N=D.with(void 0,e.top+e.height-r.borderHeight-r.verticalPadding);return{top:a,left:A,fit:I-t.width,maxSizeTop:D,maxSizeBottom:N,minSize:o.with(Math.min(I,o.width))}}(),d=function(){const I=e.left,A=-r.borderWidth+e.top+e.height,D=new Ci(e.width-r.borderHeight,n.height-e.top-e.height-r.verticalPadding);return{top:A,left:I,fit:D.height-t.height,maxSizeBottom:D,maxSizeTop:D,minSize:o.with(D.width)}}(),u=[l,c,d],h=u.find(I=>I.fit>=0)??u.sort((I,A)=>A.fit-I.fit)[0],g=e.top+e.height-r.borderHeight;let p,_=t.height;const v=Math.max(h.maxSizeTop.height,h.maxSizeBottom.height);_>v&&(_=v);let C;i?_<=h.maxSizeTop.height?(p=!0,C=h.maxSizeTop):(p=!1,C=h.maxSizeBottom):_<=h.maxSizeBottom.height?(p=!1,C=h.maxSizeBottom):(p=!0,C=h.maxSizeTop);let{top:y,left:x}=h;!p&&_>e.height&&(y=g-_);const L=this._editor.getDomNode();if(L){const I=L.getBoundingClientRect();y-=I.top,x-=I.left}this._applyTopLeft({left:x,top:y}),this._resizable.enableSashes(!p,h===l,p,h!==l),this._resizable.minSize=h.minSize,this._resizable.maxSize=C,this._resizable.layout(_,Math.min(C.width,t.width)),this.widget.layout(this._resizable.size.width,this._resizable.size.height)}_applyTopLeft(e){this._topLeft=e,this._editor.layoutOverlayWidget(this)}}var _h;(function(s){s[s.FILE=0]="FILE",s[s.FOLDER=1]="FOLDER",s[s.ROOT_FOLDER=2]="ROOT_FOLDER"})(_h||(_h={}));const xJe=/(?:\/|^)(?:([^\/]+)\/)?([^\/]+)$/;function XN(s,e,t,i,n){if(at.isThemeIcon(n))return[`codicon-${n.id}`,"predefined-file-icon"];if(Je.isUri(n))return[];const r=i===_h.ROOT_FOLDER?["rootfolder-icon"]:i===_h.FOLDER?["folder-icon"]:["file-icon"];if(t){let o;if(t.scheme===gt.data)o=Qm.parseMetaData(t).get(Qm.META_DATA_LABEL);else{const a=t.path.match(xJe);a?(o=ZN(a[2].toLowerCase()),a[1]&&r.push(`${ZN(a[1].toLowerCase())}-name-dir-icon`)):o=ZN(t.authority.toLowerCase())}if(i===_h.ROOT_FOLDER)r.push(`${o}-root-name-folder-icon`);else if(i===_h.FOLDER)r.push(`${o}-name-folder-icon`);else{if(o){if(r.push(`${o}-name-file-icon`),r.push("name-file-icon"),o.length<=255){const l=o.split(".");for(let c=1;c<l.length;c++)r.push(`${l.slice(c).join(".")}-ext-file-icon`)}r.push("ext-file-icon")}const a=LJe(s,e,t);a&&r.push(`${ZN(a)}-lang-file-icon`)}}return r}function LJe(s,e,t){if(!t)return null;let i=null;if(t.scheme===gt.data){const r=Qm.parseMetaData(t).get(Qm.META_DATA_MIME);r&&(i=e.getLanguageIdByMimeType(r))}else{const n=s.getModel(t);n&&(i=n.getLanguageId())}return i&&i!==So?i:e.guessLanguageIdByFilepathOrFirstLine(t)}function ZN(s){return s.replace(/[\s]/g,"/")}var kJe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},FB=function(s,e){return function(t,i){e(t,i,s)}};function Nbe(s){return`suggest-aria-id:${s}`}const IJe=Qi("suggest-more-info",xe.chevronRight,b("suggestMoreInfoIcon","Icon for more information in the suggest widget."));var Gd;const EJe=new(Gd=class{extract(e,t){if(e.textLabel.match(Gd._regexStrict))return t[0]=e.textLabel,!0;if(e.completion.detail&&e.completion.detail.match(Gd._regexStrict))return t[0]=e.completion.detail,!0;if(e.completion.documentation){const i=typeof e.completion.documentation=="string"?e.completion.documentation:e.completion.documentation.value,n=Gd._regexRelaxed.exec(i);if(n&&(n.index===0||n.index+n[0].length===i.length))return t[0]=n[0],!0}return!1}},Gd._regexRelaxed=/(#([\da-fA-F]{3}){1,2}|(rgb|hsl)a\(\s*(\d{1,3}%?\s*,\s*){3}(1|0?\.\d+)\)|(rgb|hsl)\(\s*\d{1,3}%?(\s*,\s*\d{1,3}%?){2}\s*\))/,Gd._regexStrict=new RegExp(`^${Gd._regexRelaxed.source}$`,"i"),Gd);let IU=class{constructor(e,t,i,n){this._editor=e,this._modelService=t,this._languageService=i,this._themeService=n,this._onDidToggleDetails=new Z,this.onDidToggleDetails=this._onDidToggleDetails.event,this.templateId="suggestion"}dispose(){this._onDidToggleDetails.dispose()}renderTemplate(e){const t=new ce,i=e;i.classList.add("show-file-icons");const n=me(e,ke(".icon")),r=me(n,ke("span.colorspan")),o=me(e,ke(".contents")),a=me(o,ke(".main")),l=me(a,ke(".icon-label.codicon")),c=me(a,ke("span.left")),d=me(a,ke("span.right")),u=new KA(c,{supportHighlights:!0,supportIcons:!0});t.add(u);const h=me(c,ke("span.signature-label")),g=me(c,ke("span.qualifier-label")),p=me(d,ke("span.details-label")),_=me(d,ke("span.readMore"+at.asCSSSelector(IJe)));return _.title=b("readMore","Read More"),{root:i,left:c,right:d,icon:n,colorspan:r,iconLabel:u,iconContainer:l,parametersLabel:h,qualifierLabel:g,detailsLabel:p,readMore:_,disposables:t,configureFont:()=>{const C=this._editor.getOptions(),y=C.get(50),x=y.getMassagedFontFamily(),L=y.fontFeatureSettings,I=C.get(120)||y.fontSize,A=C.get(121)||y.lineHeight,D=y.fontWeight,N=y.letterSpacing,R=`${I}px`,W=`${A}px`,H=`${N}px`;i.style.fontSize=R,i.style.fontWeight=D,i.style.letterSpacing=H,a.style.fontFamily=x,a.style.fontFeatureSettings=L,a.style.lineHeight=W,n.style.height=W,n.style.width=W,_.style.height=W,_.style.width=W}}}renderElement(e,t,i){i.configureFont();const{completion:n}=e;i.root.id=Nbe(t),i.colorspan.style.backgroundColor="";const r={labelEscapeNewLines:!0,matches:YE(e.score)},o=[];if(n.kind===19&&EJe.extract(e,o))i.icon.className="icon customcolor",i.iconContainer.className="icon hide",i.colorspan.style.backgroundColor=o[0];else if(n.kind===20&&this._themeService.getFileIconTheme().hasFileIcons){i.icon.className="icon hide",i.iconContainer.className="icon hide";const a=XN(this._modelService,this._languageService,Je.from({scheme:"fake",path:e.textLabel}),_h.FILE),l=XN(this._modelService,this._languageService,Je.from({scheme:"fake",path:n.detail}),_h.FILE);r.extraClasses=a.length>l.length?a:l}else n.kind===23&&this._themeService.getFileIconTheme().hasFolderIcons?(i.icon.className="icon hide",i.iconContainer.className="icon hide",r.extraClasses=[XN(this._modelService,this._languageService,Je.from({scheme:"fake",path:e.textLabel}),_h.FOLDER),XN(this._modelService,this._languageService,Je.from({scheme:"fake",path:n.detail}),_h.FOLDER)].flat()):(i.icon.className="icon hide",i.iconContainer.className="",i.iconContainer.classList.add("suggest-icon",...at.asClassNameArray(Xk.toIcon(n.kind))));n.tags&&n.tags.indexOf(1)>=0&&(r.extraClasses=(r.extraClasses||[]).concat(["deprecated"]),r.matches=[]),i.iconLabel.setLabel(e.textLabel,void 0,r),typeof n.label=="string"?(i.parametersLabel.textContent="",i.detailsLabel.textContent=VB(n.detail||""),i.root.classList.add("string-label")):(i.parametersLabel.textContent=VB(n.label.detail||""),i.detailsLabel.textContent=VB(n.label.description||""),i.root.classList.remove("string-label")),this._editor.getOption(119).showInlineDetails?ka(i.detailsLabel):fo(i.detailsLabel),VQ(e)?(i.right.classList.add("can-expand-details"),ka(i.readMore),i.readMore.onmousedown=a=>{a.stopPropagation(),a.preventDefault()},i.readMore.onclick=a=>{a.stopPropagation(),a.preventDefault(),this._onDidToggleDetails.fire()}):(i.right.classList.remove("can-expand-details"),fo(i.readMore),i.readMore.onmousedown=null,i.readMore.onclick=null)}disposeTemplate(e){e.disposables.dispose()}};IU=kJe([FB(1,Gi),FB(2,un),FB(3,gs)],IU);function VB(s){return s.replace(/\r\n|\r|\n/g,"")}var DJe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},JN=function(s,e){return function(t,i){e(t,i,s)}},vC;j("editorSuggestWidget.background",yl,b("editorSuggestWidgetBackground","Background color of the suggest widget."));j("editorSuggestWidget.border",lK,b("editorSuggestWidgetBorder","Border color of the suggest widget."));const TJe=j("editorSuggestWidget.foreground",qh,b("editorSuggestWidgetForeground","Foreground color of the suggest widget."));j("editorSuggestWidget.selectedForeground",pI,b("editorSuggestWidgetSelectedForeground","Foreground color of the selected entry in the suggest widget."));j("editorSuggestWidget.selectedIconForeground",pK,b("editorSuggestWidgetSelectedIconForeground","Icon foreground color of the selected entry in the suggest widget."));const NJe=j("editorSuggestWidget.selectedBackground",mI,b("editorSuggestWidgetSelectedBackground","Background color of the selected entry in the suggest widget."));j("editorSuggestWidget.highlightForeground",IC,b("editorSuggestWidgetHighlightForeground","Color of the match highlights in the suggest widget."));j("editorSuggestWidget.focusHighlightForeground",rFe,b("editorSuggestWidgetFocusHighlightForeground","Color of the match highlights in the suggest widget when an item is focused."));j("editorSuggestWidgetStatus.foreground",Tt(TJe,.5),b("editorSuggestWidgetStatusForeground","Foreground color of the suggest widget status."));class RJe{constructor(e,t){this._service=e,this._key=`suggestWidget.size/${t.getEditorType()}/${t instanceof hd}`}restore(){const e=this._service.get(this._key,0)??"";try{const t=JSON.parse(e);if(Ci.is(t))return Ci.lift(t)}catch{}}store(e){this._service.store(this._key,JSON.stringify(e),0,1)}reset(){this._service.remove(this._key,0)}}var Lm;let EU=(Lm=class{constructor(e,t,i,n,r){this.editor=e,this._storageService=t,this._state=0,this._isAuto=!1,this._pendingLayout=new Es,this._pendingShowDetails=new Es,this._ignoreFocusEvents=!1,this._forceRenderingAbove=!1,this._explainMode=!1,this._showTimeout=new gd,this._disposables=new ce,this._onDidSelect=new aw,this._onDidFocus=new aw,this._onDidHide=new Z,this._onDidShow=new Z,this.onDidSelect=this._onDidSelect.event,this.onDidFocus=this._onDidFocus.event,this.onDidHide=this._onDidHide.event,this.onDidShow=this._onDidShow.event,this._onDetailsKeydown=new Z,this.onDetailsKeyDown=this._onDetailsKeydown.event,this.element=new _Q,this.element.domNode.classList.add("editor-widget","suggest-widget"),this._contentWidget=new AJe(this,e),this._persistedSize=new RJe(t,e);class o{constructor(g,p,_=!1,v=!1){this.persistedSize=g,this.currentSize=p,this.persistHeight=_,this.persistWidth=v}}let a;this._disposables.add(this.element.onDidWillResize(()=>{this._contentWidget.lockPreference(),a=new o(this._persistedSize.restore(),this.element.size)})),this._disposables.add(this.element.onDidResize(h=>{var g,p;if(this._resize(h.dimension.width,h.dimension.height),a&&(a.persistHeight=a.persistHeight||!!h.north||!!h.south,a.persistWidth=a.persistWidth||!!h.east||!!h.west),!!h.done){if(a){const{itemHeight:_,defaultSize:v}=this.getLayoutInfo(),C=Math.round(_/2);let{width:y,height:x}=this.element.size;(!a.persistHeight||Math.abs(a.currentSize.height-x)<=C)&&(x=((g=a.persistedSize)==null?void 0:g.height)??v.height),(!a.persistWidth||Math.abs(a.currentSize.width-y)<=C)&&(y=((p=a.persistedSize)==null?void 0:p.width)??v.width),this._persistedSize.store(new Ci(y,x))}this._contentWidget.unlockPreference(),a=void 0}})),this._messageElement=me(this.element.domNode,ke(".message")),this._listElement=me(this.element.domNode,ke(".tree"));const l=this._disposables.add(r.createInstance(kU,this.editor));l.onDidClose(this.toggleDetails,this,this._disposables),this._details=new SJe(l,this.editor);const c=()=>this.element.domNode.classList.toggle("no-icons",!this.editor.getOption(119).showIcons);c();const d=r.createInstance(IU,this.editor);this._disposables.add(d),this._disposables.add(d.onDidToggleDetails(()=>this.toggleDetails())),this._list=new Bl("SuggestWidget",this._listElement,{getHeight:h=>this.getLayoutInfo().itemHeight,getTemplateId:h=>"suggestion"},[d],{alwaysConsumeMouseWheel:!0,useShadows:!1,mouseSupport:!1,multipleSelectionSupport:!1,accessibilityProvider:{getRole:()=>"option",getWidgetAriaLabel:()=>b("suggest","Suggest"),getWidgetRole:()=>"listbox",getAriaLabel:h=>{let g=h.textLabel;if(typeof h.completion.label!="string"){const{detail:C,description:y}=h.completion.label;C&&y?g=b("label.full","{0} {1}, {2}",g,C,y):C?g=b("label.detail","{0} {1}",g,C):y&&(g=b("label.desc","{0}, {1}",g,y))}if(!h.isResolved||!this._isDetailsVisible())return g;const{documentation:p,detail:_}=h.completion,v=lw("{0}{1}",_||"",p?typeof p=="string"?p:p.value:"");return b("ariaCurrenttSuggestionReadDetails","{0}, docs: {1}",g,v)}}}),this._list.style(Qw({listInactiveFocusBackground:NJe,listInactiveFocusOutline:tn})),this._status=r.createInstance(LU,this.element.domNode,gm);const u=()=>this.element.domNode.classList.toggle("with-status-bar",this.editor.getOption(119).showStatusBar);u(),this._disposables.add(n.onDidColorThemeChange(h=>this._onThemeChange(h))),this._onThemeChange(n.getColorTheme()),this._disposables.add(this._list.onMouseDown(h=>this._onListMouseDownOrTap(h))),this._disposables.add(this._list.onTap(h=>this._onListMouseDownOrTap(h))),this._disposables.add(this._list.onDidChangeSelection(h=>this._onListSelection(h))),this._disposables.add(this._list.onDidChangeFocus(h=>this._onListFocus(h))),this._disposables.add(this.editor.onDidChangeCursorSelection(()=>this._onCursorSelectionChanged())),this._disposables.add(this.editor.onDidChangeConfiguration(h=>{h.hasChanged(119)&&(u(),c()),this._completionModel&&(h.hasChanged(50)||h.hasChanged(120)||h.hasChanged(121))&&this._list.splice(0,this._list.length,this._completionModel.items)})),this._ctxSuggestWidgetVisible=Dt.Visible.bindTo(i),this._ctxSuggestWidgetDetailsVisible=Dt.DetailsVisible.bindTo(i),this._ctxSuggestWidgetMultipleSuggestions=Dt.MultipleSuggestions.bindTo(i),this._ctxSuggestWidgetHasFocusedSuggestion=Dt.HasFocusedSuggestion.bindTo(i),this._disposables.add(yn(this._details.widget.domNode,"keydown",h=>{this._onDetailsKeydown.fire(h)})),this._disposables.add(this.editor.onMouseDown(h=>this._onEditorMouseDown(h)))}dispose(){var e;this._details.widget.dispose(),this._details.dispose(),this._list.dispose(),this._status.dispose(),this._disposables.dispose(),(e=this._loadingTimeout)==null||e.dispose(),this._pendingLayout.dispose(),this._pendingShowDetails.dispose(),this._showTimeout.dispose(),this._contentWidget.dispose(),this.element.dispose()}_onEditorMouseDown(e){this._details.widget.domNode.contains(e.target.element)?this._details.widget.domNode.focus():this.element.domNode.contains(e.target.element)&&this.editor.focus()}_onCursorSelectionChanged(){this._state!==0&&this._contentWidget.layout()}_onListMouseDownOrTap(e){typeof e.element>"u"||typeof e.index>"u"||(e.browserEvent.preventDefault(),e.browserEvent.stopPropagation(),this._select(e.element,e.index))}_onListSelection(e){e.elements.length&&this._select(e.elements[0],e.indexes[0])}_select(e,t){const i=this._completionModel;i&&(this._onDidSelect.fire({item:e,index:t,model:i}),this.editor.focus())}_onThemeChange(e){this._details.widget.borderWidth=su(e.type)?2:1}_onListFocus(e){var n;if(this._ignoreFocusEvents)return;if(!e.elements.length){this._currentSuggestionDetails&&(this._currentSuggestionDetails.cancel(),this._currentSuggestionDetails=void 0,this._focusedItem=void 0),this.editor.setAriaOptions({activeDescendant:void 0}),this._ctxSuggestWidgetHasFocusedSuggestion.set(!1);return}if(!this._completionModel)return;this._ctxSuggestWidgetHasFocusedSuggestion.set(!0);const t=e.elements[0],i=e.indexes[0];t!==this._focusedItem&&((n=this._currentSuggestionDetails)==null||n.cancel(),this._currentSuggestionDetails=void 0,this._focusedItem=t,this._list.reveal(i),this._currentSuggestionDetails=xs(async r=>{const o=$m(()=>{this._isDetailsVisible()&&this.showDetails(!0)},250),a=r.onCancellationRequested(()=>o.dispose());try{return await t.resolve(r)}finally{o.dispose(),a.dispose()}}),this._currentSuggestionDetails.then(()=>{i>=this._list.length||t!==this._list.element(i)||(this._ignoreFocusEvents=!0,this._list.splice(i,1,[t]),this._list.setFocus([i]),this._ignoreFocusEvents=!1,this._isDetailsVisible()?this.showDetails(!1):this.element.domNode.classList.remove("docs-side"),this.editor.setAriaOptions({activeDescendant:Nbe(i)}))}).catch(ft)),this._onDidFocus.fire({item:t,index:i,model:this._completionModel})}_setState(e){if(this._state!==e)switch(this._state=e,this.element.domNode.classList.toggle("frozen",e===4),this.element.domNode.classList.remove("message"),e){case 0:fo(this._messageElement,this._listElement,this._status.element),this._details.hide(!0),this._status.hide(),this._contentWidget.hide(),this._ctxSuggestWidgetVisible.reset(),this._ctxSuggestWidgetMultipleSuggestions.reset(),this._ctxSuggestWidgetHasFocusedSuggestion.reset(),this._showTimeout.cancel(),this.element.domNode.classList.remove("visible"),this._list.splice(0,this._list.length),this._focusedItem=void 0,this._cappedHeight=void 0,this._explainMode=!1;break;case 1:this.element.domNode.classList.add("message"),this._messageElement.textContent=vC.LOADING_MESSAGE,fo(this._listElement,this._status.element),ka(this._messageElement),this._details.hide(),this._show(),this._focusedItem=void 0,Mh(vC.LOADING_MESSAGE);break;case 2:this.element.domNode.classList.add("message"),this._messageElement.textContent=vC.NO_SUGGESTIONS_MESSAGE,fo(this._listElement,this._status.element),ka(this._messageElement),this._details.hide(),this._show(),this._focusedItem=void 0,Mh(vC.NO_SUGGESTIONS_MESSAGE);break;case 3:fo(this._messageElement),ka(this._listElement,this._status.element),this._show();break;case 4:fo(this._messageElement),ka(this._listElement,this._status.element),this._show();break;case 5:fo(this._messageElement),ka(this._listElement,this._status.element),this._details.show(),this._show();break}}_show(){this._status.show(),this._contentWidget.show(),this._layout(this._persistedSize.restore()),this._ctxSuggestWidgetVisible.set(!0),this._showTimeout.cancelAndSet(()=>{this.element.domNode.classList.add("visible"),this._onDidShow.fire(this)},100)}showTriggered(e,t){this._state===0&&(this._contentWidget.setPosition(this.editor.getPosition()),this._isAuto=!!e,this._isAuto||(this._loadingTimeout=$m(()=>this._setState(1),t)))}showSuggestions(e,t,i,n,r){var l,c;if(this._contentWidget.setPosition(this.editor.getPosition()),(l=this._loadingTimeout)==null||l.dispose(),(c=this._currentSuggestionDetails)==null||c.cancel(),this._currentSuggestionDetails=void 0,this._completionModel!==e&&(this._completionModel=e),i&&this._state!==2&&this._state!==0){this._setState(4);return}const o=this._completionModel.items.length,a=o===0;if(this._ctxSuggestWidgetMultipleSuggestions.set(o>1),a){this._setState(n?0:2),this._completionModel=void 0;return}this._focusedItem=void 0,this._onDidFocus.pause(),this._onDidSelect.pause();try{this._list.splice(0,this._list.length,this._completionModel.items),this._setState(i?4:3),this._list.reveal(t,0),this._list.setFocus(r?[]:[t])}finally{this._onDidFocus.resume(),this._onDidSelect.resume()}this._pendingLayout.value=j2(nt(this.element.domNode),()=>{this._pendingLayout.clear(),this._layout(this.element.size),this._details.widget.domNode.classList.remove("focused")})}focusSelected(){this._list.length>0&&this._list.setFocus([0])}selectNextPage(){switch(this._state){case 0:return!1;case 5:return this._details.widget.pageDown(),!0;case 1:return!this._isAuto;default:return this._list.focusNextPage(),!0}}selectNext(){switch(this._state){case 0:return!1;case 1:return!this._isAuto;default:return this._list.focusNext(1,!0),!0}}selectLast(){switch(this._state){case 0:return!1;case 5:return this._details.widget.scrollBottom(),!0;case 1:return!this._isAuto;default:return this._list.focusLast(),!0}}selectPreviousPage(){switch(this._state){case 0:return!1;case 5:return this._details.widget.pageUp(),!0;case 1:return!this._isAuto;default:return this._list.focusPreviousPage(),!0}}selectPrevious(){switch(this._state){case 0:return!1;case 1:return!this._isAuto;default:return this._list.focusPrevious(1,!0),!1}}selectFirst(){switch(this._state){case 0:return!1;case 5:return this._details.widget.scrollTop(),!0;case 1:return!this._isAuto;default:return this._list.focusFirst(),!0}}getFocusedItem(){if(this._state!==0&&this._state!==2&&this._state!==1&&this._completionModel&&this._list.getFocus().length>0)return{item:this._list.getFocusedElements()[0],index:this._list.getFocus()[0],model:this._completionModel}}toggleDetailsFocus(){this._state===5?(this._setState(3),this._details.widget.domNode.classList.remove("focused")):this._state===3&&this._isDetailsVisible()&&(this._setState(5),this._details.widget.domNode.classList.add("focused"))}toggleDetails(){this._isDetailsVisible()?(this._pendingShowDetails.clear(),this._ctxSuggestWidgetDetailsVisible.set(!1),this._setDetailsVisible(!1),this._details.hide(),this.element.domNode.classList.remove("shows-details")):(VQ(this._list.getFocusedElements()[0])||this._explainMode)&&(this._state===3||this._state===5||this._state===4)&&(this._ctxSuggestWidgetDetailsVisible.set(!0),this._setDetailsVisible(!0),this.showDetails(!1))}showDetails(e){this._pendingShowDetails.value=j2(nt(this.element.domNode),()=>{this._pendingShowDetails.clear(),this._details.show(),e?this._details.widget.renderLoading():this._details.widget.renderItem(this._list.getFocusedElements()[0],this._explainMode),this._details.widget.isEmpty?this._details.hide():(this._positionDetails(),this.element.domNode.classList.add("shows-details")),this.editor.focus()})}toggleExplainMode(){this._list.getFocusedElements()[0]&&(this._explainMode=!this._explainMode,this._isDetailsVisible()?this.showDetails(!1):this.toggleDetails())}resetPersistedSize(){this._persistedSize.reset()}hideWidget(){var i;this._pendingLayout.clear(),this._pendingShowDetails.clear(),(i=this._loadingTimeout)==null||i.dispose(),this._setState(0),this._onDidHide.fire(this),this.element.clearSashHoverState();const e=this._persistedSize.restore(),t=Math.ceil(this.getLayoutInfo().itemHeight*4.3);e&&e.height<t&&this._persistedSize.store(e.with(void 0,t))}isFrozen(){return this._state===4}_afterRender(e){if(e===null){this._isDetailsVisible()&&this._details.hide();return}this._state===2||this._state===1||(this._isDetailsVisible()&&!this._details.widget.isEmpty&&this._details.show(),this._positionDetails())}_layout(e){var o,a;if(!this.editor.hasModel()||!this.editor.getDomNode())return;const t=qm(this.element.domNode.ownerDocument.body),i=this.getLayoutInfo();e||(e=i.defaultSize);let n=e.height,r=e.width;if(this._status.element.style.height=`${i.itemHeight}px`,this._state===2||this._state===1)n=i.itemHeight+i.borderHeight,r=i.defaultSize.width/2,this.element.enableSashes(!1,!1,!1,!1),this.element.minSize=this.element.maxSize=new Ci(r,n),this._contentWidget.setPreference(2);else{const l=t.width-i.borderHeight-2*i.horizontalPadding;r>l&&(r=l);const c=this._completionModel?this._completionModel.stats.pLabelLen*i.typicalHalfwidthCharacterWidth:r,d=i.statusBarHeight+this._list.contentHeight+i.borderHeight,u=i.itemHeight+i.statusBarHeight,h=Pn(this.editor.getDomNode()),g=this.editor.getScrolledVisiblePosition(this.editor.getPosition()),p=h.top+g.top+g.height,_=Math.min(t.height-p-i.verticalPadding,d),v=h.top+g.top-i.verticalPadding,C=Math.min(v,d);let y=Math.min(Math.max(C,_)+i.borderHeight,d);n===((o=this._cappedHeight)==null?void 0:o.capped)&&(n=this._cappedHeight.wanted),n<u&&(n=u),n>y&&(n=y),n>_||this._forceRenderingAbove&&v>150?(this._contentWidget.setPreference(1),this.element.enableSashes(!0,!0,!1,!1),y=C):(this._contentWidget.setPreference(2),this.element.enableSashes(!1,!0,!0,!1),y=_),this.element.preferredSize=new Ci(c,i.defaultSize.height),this.element.maxSize=new Ci(l,y),this.element.minSize=new Ci(220,u),this._cappedHeight=n===d?{wanted:((a=this._cappedHeight)==null?void 0:a.wanted)??e.height,capped:n}:void 0}this._resize(r,n)}_resize(e,t){const{width:i,height:n}=this.element.maxSize;e=Math.min(i,e),t=Math.min(n,t);const{statusBarHeight:r}=this.getLayoutInfo();this._list.layout(t-r,e),this._listElement.style.height=`${t-r}px`,this.element.layout(t,e),this._contentWidget.layout(),this._positionDetails()}_positionDetails(){var e;this._isDetailsVisible()&&this._details.placeAtAnchor(this.element.domNode,((e=this._contentWidget.getPosition())==null?void 0:e.preference[0])===2)}getLayoutInfo(){const e=this.editor.getOption(50),t=ho(this.editor.getOption(121)||e.lineHeight,8,1e3),i=!this.editor.getOption(119).showStatusBar||this._state===2||this._state===1?0:t,n=this._details.widget.borderWidth,r=2*n;return{itemHeight:t,statusBarHeight:i,borderWidth:n,borderHeight:r,typicalHalfwidthCharacterWidth:e.typicalHalfwidthCharacterWidth,verticalPadding:22,horizontalPadding:14,defaultSize:new Ci(430,i+12*t+r)}}_isDetailsVisible(){return this._storageService.getBoolean("expandSuggestionDocs",0,!1)}_setDetailsVisible(e){this._storageService.store("expandSuggestionDocs",e,0,0)}forceRenderingAbove(){this._forceRenderingAbove||(this._forceRenderingAbove=!0,this._layout(this._persistedSize.restore()))}stopForceRenderingAbove(){this._forceRenderingAbove=!1}},vC=Lm,Lm.LOADING_MESSAGE=b("suggestWidget.loading","Loading..."),Lm.NO_SUGGESTIONS_MESSAGE=b("suggestWidget.noSuggestions","No suggestions."),Lm);EU=vC=DJe([JN(1,md),JN(2,ct),JN(3,gs),JN(4,Xe)],EU);class AJe{constructor(e,t){this._widget=e,this._editor=t,this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._preferenceLocked=!1,this._added=!1,this._hidden=!1}dispose(){this._added&&(this._added=!1,this._editor.removeContentWidget(this))}getId(){return"editor.widget.suggestWidget"}getDomNode(){return this._widget.element.domNode}show(){this._hidden=!1,this._added||(this._added=!0,this._editor.addContentWidget(this))}hide(){this._hidden||(this._hidden=!0,this.layout())}layout(){this._editor.layoutContentWidget(this)}getPosition(){return this._hidden||!this._position||!this._preference?null:{position:this._position,preference:[this._preference]}}beforeRender(){const{height:e,width:t}=this._widget.element.size,{borderWidth:i,horizontalPadding:n}=this._widget.getLayoutInfo();return new Ci(t+2*i+n,e+2*i)}afterRender(e){this._widget._afterRender(e)}setPreference(e){this._preferenceLocked||(this._preference=e)}lockPreference(){this._preferenceLocked=!0}unlockPreference(){this._preferenceLocked=!1}setPosition(e){this._position=e}}var PJe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},sC=function(s,e){return function(t,i){e(t,i,s)}},DU;class MJe{constructor(e,t){if(this._model=e,this._position=t,this._decorationOptions=_t.register({description:"suggest-line-suffix",stickiness:1}),e.getLineMaxColumn(t.lineNumber)!==t.column){const n=e.getOffsetAt(t),r=e.getPositionAt(n+1);e.changeDecorations(o=>{this._marker&&o.removeDecoration(this._marker),this._marker=o.addDecoration(F.fromPositions(t,r),this._decorationOptions)})}}dispose(){this._marker&&!this._model.isDisposed()&&this._model.changeDecorations(e=>{e.removeDecoration(this._marker),this._marker=void 0})}delta(e){if(this._model.isDisposed()||this._position.lineNumber!==e.lineNumber)return 0;if(this._marker){const t=this._model.getDecorationRange(this._marker);return this._model.getOffsetAt(t.getStartPosition())-this._model.getOffsetAt(e)}else return this._model.getLineMaxColumn(e.lineNumber)-e.column}}var Fv;let Jc=(Fv=class{static get(e){return e.getContribution(DU.ID)}constructor(e,t,i,n,r,o,a){this._memoryService=t,this._commandService=i,this._contextKeyService=n,this._instantiationService=r,this._logService=o,this._telemetryService=a,this._lineSuffix=new Es,this._toDispose=new ce,this._selectors=new OJe(u=>u.priority),this._onWillInsertSuggestItem=new Z,this.onWillInsertSuggestItem=this._onWillInsertSuggestItem.event,this.editor=e,this.model=r.createInstance(sM,this.editor),this._selectors.register({priority:0,select:(u,h,g)=>this._memoryService.select(u,h,g)});const l=Dt.InsertMode.bindTo(n);l.set(e.getOption(119).insertMode),this._toDispose.add(this.model.onDidTrigger(()=>l.set(e.getOption(119).insertMode))),this.widget=this._toDispose.add(new tV(nt(e.getDomNode()),()=>{const u=this._instantiationService.createInstance(EU,this.editor);this._toDispose.add(u),this._toDispose.add(u.onDidSelect(v=>this._insertSuggestion(v,0),this));const h=new mJe(this.editor,u,this.model,v=>this._insertSuggestion(v,2));this._toDispose.add(h);const g=Dt.MakesTextEdit.bindTo(this._contextKeyService),p=Dt.HasInsertAndReplaceRange.bindTo(this._contextKeyService),_=Dt.CanResolve.bindTo(this._contextKeyService);return this._toDispose.add(Ye(()=>{g.reset(),p.reset(),_.reset()})),this._toDispose.add(u.onDidFocus(({item:v})=>{const C=this.editor.getPosition(),y=v.editStart.column,x=C.column;let L=!0;this.editor.getOption(1)==="smart"&&this.model.state===2&&!v.completion.additionalTextEdits&&!(v.completion.insertTextRules&4)&&x-y===v.completion.insertText.length&&(L=this.editor.getModel().getValueInRange({startLineNumber:C.lineNumber,startColumn:y,endLineNumber:C.lineNumber,endColumn:x})!==v.completion.insertText),g.set(L),p.set(!X.equals(v.editInsertEnd,v.editReplaceEnd)),_.set(!!v.provider.resolveCompletionItem||!!v.completion.documentation||v.completion.detail!==v.completion.label)})),this._toDispose.add(u.onDetailsKeyDown(v=>{if(v.toKeyCodeChord().equals(new yg(!0,!1,!1,!1,33))||Wt&&v.toKeyCodeChord().equals(new yg(!1,!1,!1,!0,33))){v.stopPropagation();return}v.toKeyCodeChord().isModifierKey()||this.editor.focus()})),u})),this._overtypingCapturer=this._toDispose.add(new tV(nt(e.getDomNode()),()=>this._toDispose.add(new xU(this.editor,this.model)))),this._alternatives=this._toDispose.add(new tV(nt(e.getDomNode()),()=>this._toDispose.add(new $1(this.editor,this._contextKeyService)))),this._toDispose.add(r.createInstance(tM,e)),this._toDispose.add(this.model.onDidTrigger(u=>{this.widget.value.showTriggered(u.auto,u.shy?250:50),this._lineSuffix.value=new MJe(this.editor.getModel(),u.position)})),this._toDispose.add(this.model.onDidSuggest(u=>{if(u.triggerOptions.shy)return;let h=-1;for(const p of this._selectors.itemsOrderedByPriorityDesc)if(h=p.select(this.editor.getModel(),this.editor.getPosition(),u.completionModel.items),h!==-1)break;if(h===-1&&(h=0),this.model.state===0)return;let g=!1;if(u.triggerOptions.auto){const p=this.editor.getOption(119);p.selectionMode==="never"||p.selectionMode==="always"?g=p.selectionMode==="never":p.selectionMode==="whenTriggerCharacter"?g=u.triggerOptions.triggerKind!==1:p.selectionMode==="whenQuickSuggestion"&&(g=u.triggerOptions.triggerKind===1&&!u.triggerOptions.refilter)}this.widget.value.showSuggestions(u.completionModel,h,u.isFrozen,u.triggerOptions.auto,g)})),this._toDispose.add(this.model.onDidCancel(u=>{u.retrigger||this.widget.value.hideWidget()})),this._toDispose.add(this.editor.onDidBlurEditorWidget(()=>{this.model.cancel(),this.model.clear()}));const c=Dt.AcceptSuggestionsOnEnter.bindTo(n),d=()=>{const u=this.editor.getOption(1);c.set(u==="on"||u==="smart")};this._toDispose.add(this.editor.onDidChangeConfiguration(()=>d())),d()}dispose(){this._alternatives.dispose(),this._toDispose.dispose(),this.widget.dispose(),this.model.dispose(),this._lineSuffix.dispose(),this._onWillInsertSuggestItem.dispose()}_insertSuggestion(e,t){if(!e||!e.item){this._alternatives.value.reset(),this.model.cancel(),this.model.clear();return}if(!this.editor.hasModel())return;const i=Do.get(this.editor);if(!i)return;this._onWillInsertSuggestItem.fire({item:e.item});const n=this.editor.getModel(),r=n.getAlternativeVersionId(),{item:o}=e,a=[],l=new mn;t&1||this.editor.pushUndoStop();const c=this.getOverwriteInfo(o,!!(t&8));this._memoryService.memorize(n,this.editor.getPosition(),o);const d=o.isResolved;let u=-1,h=-1;if(Array.isArray(o.completion.additionalTextEdits)){this.model.cancel();const p=_u.capture(this.editor);this.editor.executeEdits("suggestController.additionalTextEdits.sync",o.completion.additionalTextEdits.map(_=>{let v=F.lift(_.range);if(v.startLineNumber===o.position.lineNumber&&v.startColumn>o.position.column){const C=this.editor.getPosition().column-o.position.column,y=C,x=F.spansMultipleLines(v)?0:C;v=new F(v.startLineNumber,v.startColumn+y,v.endLineNumber,v.endColumn+x)}return gn.replaceMove(v,_.text)})),p.restoreRelativeVerticalPositionOfCursor(this.editor)}else if(!d){const p=new Bs;let _;const v=n.onDidChangeContent(L=>{if(L.isFlush){l.cancel(),v.dispose();return}for(const I of L.changes){const A=F.getEndPosition(I.range);(!_||X.isBefore(A,_))&&(_=A)}}),C=t;t|=2;let y=!1;const x=this.editor.onWillType(()=>{x.dispose(),y=!0,C&2||this.editor.pushUndoStop()});a.push(o.resolve(l.token).then(()=>{if(!o.completion.additionalTextEdits||l.token.isCancellationRequested)return;if(_&&o.completion.additionalTextEdits.some(I=>X.isBefore(_,F.getStartPosition(I.range))))return!1;y&&this.editor.pushUndoStop();const L=_u.capture(this.editor);return this.editor.executeEdits("suggestController.additionalTextEdits.async",o.completion.additionalTextEdits.map(I=>gn.replaceMove(F.lift(I.range),I.text))),L.restoreRelativeVerticalPositionOfCursor(this.editor),(y||!(C&2))&&this.editor.pushUndoStop(),!0}).then(L=>{this._logService.trace("[suggest] async resolving of edits DONE (ms, applied?)",p.elapsed(),L),h=L===!0?1:L===!1?0:-2}).finally(()=>{v.dispose(),x.dispose()}))}let{insertText:g}=o.completion;if(o.completion.insertTextRules&4||(g=Lw.escape(g)),this.model.cancel(),i.insert(g,{overwriteBefore:c.overwriteBefore,overwriteAfter:c.overwriteAfter,undoStopBefore:!1,undoStopAfter:!1,adjustWhitespace:!(o.completion.insertTextRules&1),clipboardText:e.model.clipboardText,overtypingCapturer:this._overtypingCapturer.value}),t&2||this.editor.pushUndoStop(),o.completion.command)if(o.completion.command.id===rM.id)this.model.trigger({auto:!0,retrigger:!0});else{const p=new Bs;a.push(this._commandService.executeCommand(o.completion.command.id,...o.completion.command.arguments?[...o.completion.command.arguments]:[]).catch(_=>{o.completion.extensionId?Mn(_):ft(_)}).finally(()=>{u=p.elapsed()}))}t&4&&this._alternatives.value.set(e,p=>{for(l.cancel();n.canUndo();){r!==n.getAlternativeVersionId()&&n.undo(),this._insertSuggestion(p,3|(t&8?8:0));break}}),this._alertCompletionItem(o),Promise.all(a).finally(()=>{this._reportSuggestionAcceptedTelemetry(o,n,d,u,h,e.index,e.model.items),this.model.clear(),l.dispose()})}_reportSuggestionAcceptedTelemetry(e,t,i,n,r,o,a){var h;if(Math.floor(Math.random()*100)===0)return;const l=new Map;for(let g=0;g<Math.min(30,a.length);g++){const p=a[g].textLabel;l.has(p)?l.get(p).push(g):l.set(p,[g])}const c=l.get(e.textLabel),u=c&&c.length>1?c[0]:-1;this._telemetryService.publicLog2("suggest.acceptedSuggestion",{extensionId:((h=e.extensionId)==null?void 0:h.value)??"unknown",providerId:e.provider._debugDisplayName??"unknown",kind:e.completion.kind,basenameHash:tF(Cc(t.uri)).toString(16),languageId:t.getLanguageId(),fileExtension:_5e(t.uri),resolveInfo:e.provider.resolveCompletionItem?i?1:0:-1,resolveDuration:e.resolveDuration,commandDuration:n,additionalEditsAsync:r,index:o,firstIndex:u})}getOverwriteInfo(e,t){ii(this.editor.hasModel());let i=this.editor.getOption(119).insertMode==="replace";t&&(i=!i);const n=e.position.column-e.editStart.column,r=(i?e.editReplaceEnd.column:e.editInsertEnd.column)-e.position.column,o=this.editor.getPosition().column-e.position.column,a=this._lineSuffix.value?this._lineSuffix.value.delta(this.editor.getPosition()):0;return{overwriteBefore:n+o,overwriteAfter:r+a}}_alertCompletionItem(e){if(Xr(e.completion.additionalTextEdits)){const t=b("aria.alert.snippet","Accepting '{0}' made {1} additional edits",e.textLabel,e.completion.additionalTextEdits.length);Eo(t)}}triggerSuggest(e,t,i){this.editor.hasModel()&&(this.model.trigger({auto:t??!1,completionOptions:{providerFilter:e,kindFilter:i?new Set:void 0}}),this.editor.revealPosition(this.editor.getPosition(),0),this.editor.focus())}triggerSuggestAndAcceptBest(e){if(!this.editor.hasModel())return;const t=this.editor.getPosition(),i=()=>{t.equals(this.editor.getPosition())&&this._commandService.executeCommand(e.fallback)},n=r=>{if(r.completion.insertTextRules&4||r.completion.additionalTextEdits)return!0;const o=this.editor.getPosition(),a=r.editStart.column,l=o.column;return l-a!==r.completion.insertText.length?!0:this.editor.getModel().getValueInRange({startLineNumber:o.lineNumber,startColumn:a,endLineNumber:o.lineNumber,endColumn:l})!==r.completion.insertText};De.once(this.model.onDidTrigger)(r=>{const o=[];De.any(this.model.onDidTrigger,this.model.onDidCancel)(()=>{Ni(o),i()},void 0,o),this.model.onDidSuggest(({completionModel:a})=>{if(Ni(o),a.items.length===0){i();return}const l=this._memoryService.select(this.editor.getModel(),this.editor.getPosition(),a.items),c=a.items[l];if(!n(c)){i();return}this.editor.pushUndoStop(),this._insertSuggestion({index:l,item:c,model:a},7)},void 0,o)}),this.model.trigger({auto:!1,shy:!0}),this.editor.revealPosition(t,0),this.editor.focus()}acceptSelectedSuggestion(e,t){const i=this.widget.value.getFocusedItem();let n=0;e&&(n|=4),t&&(n|=8),this._insertSuggestion(i,n)}acceptNextSuggestion(){this._alternatives.value.next()}acceptPrevSuggestion(){this._alternatives.value.prev()}cancelSuggestWidget(){this.model.cancel(),this.model.clear(),this.widget.value.hideWidget()}focusSuggestion(){this.widget.value.focusSelected()}selectNextSuggestion(){this.widget.value.selectNext()}selectNextPageSuggestion(){this.widget.value.selectNextPage()}selectLastSuggestion(){this.widget.value.selectLast()}selectPrevSuggestion(){this.widget.value.selectPrevious()}selectPrevPageSuggestion(){this.widget.value.selectPreviousPage()}selectFirstSuggestion(){this.widget.value.selectFirst()}toggleSuggestionDetails(){this.widget.value.toggleDetails()}toggleExplainMode(){this.widget.value.toggleExplainMode()}toggleSuggestionFocus(){this.widget.value.toggleDetailsFocus()}resetWidgetSize(){this.widget.value.resetPersistedSize()}forceRenderingAbove(){this.widget.value.forceRenderingAbove()}stopForceRenderingAbove(){this.widget.isInitialized&&this.widget.value.stopForceRenderingAbove()}registerSelector(e){return this._selectors.register(e)}},DU=Fv,Fv.ID="editor.contrib.suggestController",Fv);Jc=DU=PJe([sC(1,L5),sC(2,Hi),sC(3,ct),sC(4,Xe),sC(5,pr),sC(6,Tr)],Jc);class OJe{constructor(e){this.prioritySelector=e,this._items=new Array}register(e){if(this._items.indexOf(e)!==-1)throw new Error("Value is already registered");return this._items.push(e),this._items.sort((t,i)=>this.prioritySelector(i)-this.prioritySelector(t)),{dispose:()=>{const t=this._items.indexOf(e);t>=0&&this._items.splice(t,1)}}}get itemsOrderedByPriorityDesc(){return this._items}}const PO=class PO extends Ve{constructor(){super({id:PO.id,label:b("suggest.trigger.label","Trigger Suggest"),alias:"Trigger Suggest",precondition:he.and(z.writable,z.hasCompletionItemProvider,Dt.Visible.toNegated()),kbOpts:{kbExpr:z.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[521,2087]},weight:100}})}run(e,t,i){const n=Jc.get(t);if(!n)return;let r;i&&typeof i=="object"&&i.auto===!0&&(r=!0),n.triggerSuggest(void 0,r,void 0)}};PO.id="editor.action.triggerSuggest";let rM=PO;Zt(Jc.ID,Jc,2);ye(rM);const Ml=190,Ao=fs.bindToContribution(Jc.get);Me(new Ao({id:"acceptSelectedSuggestion",precondition:he.and(Dt.Visible,Dt.HasFocusedSuggestion),handler(s){s.acceptSelectedSuggestion(!0,!1)},kbOpts:[{primary:2,kbExpr:he.and(Dt.Visible,z.textInputFocus),weight:Ml},{primary:3,kbExpr:he.and(Dt.Visible,z.textInputFocus,Dt.AcceptSuggestionsOnEnter,Dt.MakesTextEdit),weight:Ml}],menuOpts:[{menuId:gm,title:b("accept.insert","Insert"),group:"left",order:1,when:Dt.HasInsertAndReplaceRange.toNegated()},{menuId:gm,title:b("accept.insert","Insert"),group:"left",order:1,when:he.and(Dt.HasInsertAndReplaceRange,Dt.InsertMode.isEqualTo("insert"))},{menuId:gm,title:b("accept.replace","Replace"),group:"left",order:1,when:he.and(Dt.HasInsertAndReplaceRange,Dt.InsertMode.isEqualTo("replace"))}]}));Me(new Ao({id:"acceptAlternativeSelectedSuggestion",precondition:he.and(Dt.Visible,z.textInputFocus,Dt.HasFocusedSuggestion),kbOpts:{weight:Ml,kbExpr:z.textInputFocus,primary:1027,secondary:[1026]},handler(s){s.acceptSelectedSuggestion(!1,!0)},menuOpts:[{menuId:gm,group:"left",order:2,when:he.and(Dt.HasInsertAndReplaceRange,Dt.InsertMode.isEqualTo("insert")),title:b("accept.replace","Replace")},{menuId:gm,group:"left",order:2,when:he.and(Dt.HasInsertAndReplaceRange,Dt.InsertMode.isEqualTo("replace")),title:b("accept.insert","Insert")}]}));Gt.registerCommandAlias("acceptSelectedSuggestionOnEnter","acceptSelectedSuggestion");Me(new Ao({id:"hideSuggestWidget",precondition:Dt.Visible,handler:s=>s.cancelSuggestWidget(),kbOpts:{weight:Ml,kbExpr:z.textInputFocus,primary:9,secondary:[1033]}}));Me(new Ao({id:"selectNextSuggestion",precondition:he.and(Dt.Visible,he.or(Dt.MultipleSuggestions,Dt.HasFocusedSuggestion.negate())),handler:s=>s.selectNextSuggestion(),kbOpts:{weight:Ml,kbExpr:z.textInputFocus,primary:18,secondary:[2066],mac:{primary:18,secondary:[2066,300]}}}));Me(new Ao({id:"selectNextPageSuggestion",precondition:he.and(Dt.Visible,he.or(Dt.MultipleSuggestions,Dt.HasFocusedSuggestion.negate())),handler:s=>s.selectNextPageSuggestion(),kbOpts:{weight:Ml,kbExpr:z.textInputFocus,primary:12,secondary:[2060]}}));Me(new Ao({id:"selectLastSuggestion",precondition:he.and(Dt.Visible,he.or(Dt.MultipleSuggestions,Dt.HasFocusedSuggestion.negate())),handler:s=>s.selectLastSuggestion()}));Me(new Ao({id:"selectPrevSuggestion",precondition:he.and(Dt.Visible,he.or(Dt.MultipleSuggestions,Dt.HasFocusedSuggestion.negate())),handler:s=>s.selectPrevSuggestion(),kbOpts:{weight:Ml,kbExpr:z.textInputFocus,primary:16,secondary:[2064],mac:{primary:16,secondary:[2064,302]}}}));Me(new Ao({id:"selectPrevPageSuggestion",precondition:he.and(Dt.Visible,he.or(Dt.MultipleSuggestions,Dt.HasFocusedSuggestion.negate())),handler:s=>s.selectPrevPageSuggestion(),kbOpts:{weight:Ml,kbExpr:z.textInputFocus,primary:11,secondary:[2059]}}));Me(new Ao({id:"selectFirstSuggestion",precondition:he.and(Dt.Visible,he.or(Dt.MultipleSuggestions,Dt.HasFocusedSuggestion.negate())),handler:s=>s.selectFirstSuggestion()}));Me(new Ao({id:"focusSuggestion",precondition:he.and(Dt.Visible,Dt.HasFocusedSuggestion.negate()),handler:s=>s.focusSuggestion(),kbOpts:{weight:Ml,kbExpr:z.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[2087]}}}));Me(new Ao({id:"focusAndAcceptSuggestion",precondition:he.and(Dt.Visible,Dt.HasFocusedSuggestion.negate()),handler:s=>{s.focusSuggestion(),s.acceptSelectedSuggestion(!0,!1)}}));Me(new Ao({id:"toggleSuggestionDetails",precondition:he.and(Dt.Visible,Dt.HasFocusedSuggestion),handler:s=>s.toggleSuggestionDetails(),kbOpts:{weight:Ml,kbExpr:z.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[2087]}},menuOpts:[{menuId:gm,group:"right",order:1,when:he.and(Dt.DetailsVisible,Dt.CanResolve),title:b("detail.more","Show Less")},{menuId:gm,group:"right",order:1,when:he.and(Dt.DetailsVisible.toNegated(),Dt.CanResolve),title:b("detail.less","Show More")}]}));Me(new Ao({id:"toggleExplainMode",precondition:Dt.Visible,handler:s=>s.toggleExplainMode(),kbOpts:{weight:100,primary:2138}}));Me(new Ao({id:"toggleSuggestionFocus",precondition:Dt.Visible,handler:s=>s.toggleSuggestionFocus(),kbOpts:{weight:Ml,kbExpr:z.textInputFocus,primary:2570,mac:{primary:778}}}));Me(new Ao({id:"insertBestCompletion",precondition:he.and(z.textInputFocus,he.equals("config.editor.tabCompletion","on"),tM.AtEnd,Dt.Visible.toNegated(),$1.OtherSuggestions.toNegated(),Do.InSnippetMode.toNegated()),handler:(s,e)=>{s.triggerSuggestAndAcceptBest(Ms(e)?{fallback:"tab",...e}:{fallback:"tab"})},kbOpts:{weight:Ml,primary:2}}));Me(new Ao({id:"insertNextSuggestion",precondition:he.and(z.textInputFocus,he.equals("config.editor.tabCompletion","on"),$1.OtherSuggestions,Dt.Visible.toNegated(),Do.InSnippetMode.toNegated()),handler:s=>s.acceptNextSuggestion(),kbOpts:{weight:Ml,kbExpr:z.textInputFocus,primary:2}}));Me(new Ao({id:"insertPrevSuggestion",precondition:he.and(z.textInputFocus,he.equals("config.editor.tabCompletion","on"),$1.OtherSuggestions,Dt.Visible.toNegated(),Do.InSnippetMode.toNegated()),handler:s=>s.acceptPrevSuggestion(),kbOpts:{weight:Ml,kbExpr:z.textInputFocus,primary:1026}}));ye(class extends Ve{constructor(){super({id:"editor.action.resetSuggestSize",label:b("suggest.reset.label","Reset Suggest Widget Size"),alias:"Reset Suggest Widget Size",precondition:void 0})}run(s,e){var t;(t=Jc.get(e))==null||t.resetWidgetSize()}});class FJe extends te{get selectedItem(){return this._currentSuggestItemInfo}constructor(e,t,i){super(),this.editor=e,this.suggestControllerPreselector=t,this.onWillAccept=i,this.isSuggestWidgetVisible=!1,this.isShiftKeyPressed=!1,this._isActive=!1,this._currentSuggestItemInfo=void 0,this._onDidSelectedItemChange=this._register(new Z),this.onDidSelectedItemChange=this._onDidSelectedItemChange.event,this._register(e.onKeyDown(r=>{r.shiftKey&&!this.isShiftKeyPressed&&(this.isShiftKeyPressed=!0,this.update(this._isActive))})),this._register(e.onKeyUp(r=>{r.shiftKey&&this.isShiftKeyPressed&&(this.isShiftKeyPressed=!1,this.update(this._isActive))}));const n=Jc.get(this.editor);if(n){this._register(n.registerSelector({priority:100,select:(a,l,c)=>{const d=this.editor.getModel();if(!d)return-1;const u=this.suggestControllerPreselector(),h=u?rv(u,d):void 0;if(!h)return-1;const g=X.lift(l),p=c.map((v,C)=>{const y=ak.fromSuggestion(n,d,g,v,this.isShiftKeyPressed),x=rv(y.toSingleTextEdit(),d),L=Tbe(h,x);return{index:C,valid:L,prefixLength:x.text.length,suggestItem:v}}).filter(v=>v&&v.valid&&v.prefixLength>0),_=Zq(p,Co(v=>v.prefixLength,td));return _?_.index:-1}}));let r=!1;const o=()=>{r||(r=!0,this._register(n.widget.value.onDidShow(()=>{this.isSuggestWidgetVisible=!0,this.update(!0)})),this._register(n.widget.value.onDidHide(()=>{this.isSuggestWidgetVisible=!1,this.update(!1)})),this._register(n.widget.value.onDidFocus(()=>{this.isSuggestWidgetVisible=!0,this.update(!0)})))};this._register(De.once(n.model.onDidTrigger)(a=>{o()})),this._register(n.onWillInsertSuggestItem(a=>{const l=this.editor.getPosition(),c=this.editor.getModel();if(!l||!c)return;const d=ak.fromSuggestion(n,c,l,a.item,this.isShiftKeyPressed);this.onWillAccept(d)}))}this.update(this._isActive)}update(e){const t=this.getSuggestItemInfo();(this._isActive!==e||!VJe(this._currentSuggestItemInfo,t))&&(this._isActive=e,this._currentSuggestItemInfo=t,this._onDidSelectedItemChange.fire())}getSuggestItemInfo(){const e=Jc.get(this.editor);if(!e||!this.isSuggestWidgetVisible)return;const t=e.widget.value.getFocusedItem(),i=this.editor.getPosition(),n=this.editor.getModel();if(!(!t||!i||!n))return ak.fromSuggestion(e,n,i,t.item,this.isShiftKeyPressed)}stopForceRenderingAbove(){const e=Jc.get(this.editor);e==null||e.stopForceRenderingAbove()}forceRenderingAbove(){const e=Jc.get(this.editor);e==null||e.forceRenderingAbove()}}class ak{static fromSuggestion(e,t,i,n,r){let{insertText:o}=n.completion,a=!1;if(n.completion.insertTextRules&4){const c=new Lw().parse(o);c.children.length<100&&eM.adjustWhitespace(t,i,!0,c),o=c.toString(),a=!0}const l=e.getOverwriteInfo(n,r);return new ak(F.fromPositions(i.delta(0,-l.overwriteBefore),i.delta(0,Math.max(l.overwriteAfter,0))),o,n.completion.kind,a)}constructor(e,t,i,n){this.range=e,this.insertText=t,this.completionItemKind=i,this.isSnippetText=n}equals(e){return this.range.equalsRange(e.range)&&this.insertText===e.insertText&&this.completionItemKind===e.completionItemKind&&this.isSnippetText===e.isSnippetText}toSelectedSuggestionInfo(){return new xue(this.range,this.insertText,this.completionItemKind,this.isSnippetText)}toSingleTextEdit(){return new Rh(this.range,this.insertText)}}function VJe(s,e){return s===e?!0:!s||!e?!1:s.equals(e)}var BJe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},pf=function(s,e){return function(t,i){e(t,i,s)}},TU,Vv;let Sc=(Vv=class extends te{static get(e){return e.getContribution(TU.ID)}constructor(e,t,i,n,r,o,a,l,c,d){super(),this.editor=e,this._instantiationService=t,this._contextKeyService=i,this._configurationService=n,this._commandService=r,this._debounceService=o,this._languageFeaturesService=a,this._accessibilitySignalService=l,this._keybindingService=c,this._accessibilityService=d,this._editorObs=Ea(this.editor),this._positions=qe(this,h=>{var g;return((g=this._editorObs.selections.read(h))==null?void 0:g.map(p=>p.getEndPosition()))??[new X(1,1)]}),this._suggestWidgetAdaptor=this._register(new FJe(this.editor,()=>{var h,g;return this._editorObs.forceUpdate(),(g=(h=this.model.get())==null?void 0:h.selectedInlineCompletion.get())==null?void 0:g.toSingleTextEdit(void 0)},h=>this._editorObs.forceUpdate(g=>{var p;(p=this.model.get())==null||p.handleSuggestAccepted(h)}))),this._suggestWidgetSelectedItem=wi(this,h=>this._suggestWidgetAdaptor.onDidSelectedItemChange(()=>{this._editorObs.forceUpdate(g=>h(void 0))}),()=>this._suggestWidgetAdaptor.selectedItem),this._enabledInConfig=wi(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(62).enabled),this._isScreenReaderEnabled=wi(this,this._accessibilityService.onDidChangeScreenReaderOptimized,()=>this._accessibilityService.isScreenReaderOptimized()),this._editorDictationInProgress=wi(this,this._contextKeyService.onDidChangeContext,()=>this._contextKeyService.getContext(this.editor.getDomNode()).getValue("editorDictation.inProgress")===!0),this._enabled=qe(this,h=>this._enabledInConfig.read(h)&&(!this._isScreenReaderEnabled.read(h)||!this._editorDictationInProgress.read(h))),this._debounceValue=this._debounceService.for(this._languageFeaturesService.inlineCompletionsProvider,"InlineCompletionsDebounce",{min:50,max:50}),this.model=Kr(this,h=>{if(this._editorObs.isReadonly.read(h))return;const g=this._editorObs.model.read(h);return g?this._instantiationService.createInstance(wU,g,this._suggestWidgetSelectedItem,this._editorObs.versionId,this._positions,this._debounceValue,wi(this.editor.onDidChangeConfiguration,()=>this.editor.getOption(119).preview),wi(this.editor.onDidChangeConfiguration,()=>this.editor.getOption(119).previewMode),wi(this.editor.onDidChangeConfiguration,()=>this.editor.getOption(62).mode),this._enabled):void 0}).recomputeInitiallyAndOnChange(this._store),this._ghostTexts=qe(this,h=>{const g=this.model.read(h);return(g==null?void 0:g.ghostTexts.read(h))??[]}),this._stablizedGhostTexts=WJe(this._ghostTexts,this._store),this._ghostTextWidgets=u9e(this,this._stablizedGhostTexts,(h,g)=>g.add(this._instantiationService.createInstance(bU,this.editor,{ghostText:h,minReservedLineCount:hc(0),targetTextModel:this.model.map(p=>p==null?void 0:p.textModel)}))).recomputeInitiallyAndOnChange(this._store),this._playAccessibilitySignal=vS(this),this._fontFamily=wi(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(62).fontFamily),this._register(new Ma(this._contextKeyService,this.model)),this._register(sz(this._editorObs.onDidType,(h,g)=>{var p;this._enabled.get()&&((p=this.model.get())==null||p.trigger())})),this._register(this._commandService.onDidExecuteCommand(h=>{new Set([Ay.Tab.id,Ay.DeleteLeft.id,Ay.DeleteRight.id,B_e,"acceptSelectedSuggestion"]).has(h.commandId)&&e.hasTextFocus()&&this._enabled.get()&&this._editorObs.forceUpdate(p=>{var _;(_=this.model.get())==null||_.trigger(p)})})),this._register(sz(this._editorObs.selections,(h,g)=>{var p;g.some(_=>_.reason===3||_.source==="api")&&((p=this.model.get())==null||p.stop())})),this._register(this.editor.onDidBlurEditorWidget(()=>{this._contextKeyService.getContextKeyValue("accessibleViewIsShown")||this._configurationService.getValue("editor.inlineSuggest.keepOnBlur")||e.getOption(62).keepOnBlur||B1.dropDownVisible||pn(h=>{var g;(g=this.model.get())==null||g.stop(h)})})),this._register(ht(h=>{var p;const g=(p=this.model.read(h))==null?void 0:p.state.read(h);g!=null&&g.suggestItem?g.primaryGhostText.lineCount>=2&&this._suggestWidgetAdaptor.forceRenderingAbove():this._suggestWidgetAdaptor.stopForceRenderingAbove()})),this._register(Ye(()=>{this._suggestWidgetAdaptor.stopForceRenderingAbove()}));const u=nD(this,(h,g)=>{var v;const p=this.model.read(h),_=p==null?void 0:p.state.read(h);return this._suggestWidgetSelectedItem.get()?g:(v=_==null?void 0:_.inlineCompletion)==null?void 0:v.semanticId});this._register(Oje(qe(h=>(this._playAccessibilitySignal.read(h),u.read(h),{})),async(h,g,p)=>{const _=this.model.get(),v=_==null?void 0:_.state.get();if(!v||!_)return;const C=_.textModel.getLineContent(v.primaryGhostText.lineNumber);await Sg(50,F7(p)),await ege(this._suggestWidgetSelectedItem,Yr,()=>!1,F7(p)),await this._accessibilitySignalService.playSignal(fl.inlineSuggestion),this.editor.getOption(8)&&this._provideScreenReaderUpdate(v.primaryGhostText.renderForScreenReader(C))})),this._register(new Fz(this.editor,this.model,this._instantiationService)),this._register(TZe(qe(h=>{const g=this._fontFamily.read(h);return g===""||g==="default"?"":`
.monaco-editor .ghost-text-decoration,
.monaco-editor .ghost-text-decoration-preview,
.monaco-editor .ghost-text {
	font-family: ${g};
}`}))),this._register(this._configurationService.onDidChangeConfiguration(h=>{h.affectsConfiguration("accessibility.verbosity.inlineCompletions")&&this.editor.updateOptions({inlineCompletionsAccessibilityVerbose:this._configurationService.getValue("accessibility.verbosity.inlineCompletions")})})),this.editor.updateOptions({inlineCompletionsAccessibilityVerbose:this._configurationService.getValue("accessibility.verbosity.inlineCompletions")})}playAccessibilitySignal(e){this._playAccessibilitySignal.trigger(e)}_provideScreenReaderUpdate(e){const t=this._contextKeyService.getContextKeyValue("accessibleViewIsShown"),i=this._keybindingService.lookupKeybinding("editor.action.accessibleView");let n;!t&&i&&this.editor.getOption(150)&&(n=b("showAccessibleViewHint","Inspect this in the accessible view ({0})",i.getAriaLabel())),Eo(n?e+", "+n:e)}shouldShowHoverAt(e){var i;const t=(i=this.model.get())==null?void 0:i.primaryGhostText.get();return t?t.parts.some(n=>e.containsPosition(new X(t.lineNumber,n.column))):!1}shouldShowHoverAtViewZone(e){var t;return((t=this._ghostTextWidgets.get()[0])==null?void 0:t.ownsViewZone(e))??!1}},TU=Vv,Vv.ID="editor.contrib.inlineCompletionsController",Vv);Sc=TU=BJe([pf(1,Xe),pf(2,ct),pf(3,At),pf(4,Hi),pf(5,Fl),pf(6,Be),pf(7,v_),pf(8,pi),pf(9,Wa)],Sc);function WJe(s,e){const t=Rt("result",[]),i=[];return e.add(ht(n=>{const r=s.read(n);pn(o=>{if(r.length!==i.length){i.length=r.length;for(let a=0;a<i.length;a++)i[a]||(i[a]=Rt("item",r[a]));t.set([...i],o)}i.forEach((a,l)=>a.set(r[l],o))})})),t}const MO=class MO extends Ve{constructor(){super({id:MO.ID,label:b("action.inlineSuggest.showNext","Show Next Inline Suggestion"),alias:"Show Next Inline Suggestion",precondition:he.and(z.writable,Ma.inlineSuggestionVisible),kbOpts:{weight:100,primary:606}})}async run(e,t){var n;const i=Sc.get(t);(n=i==null?void 0:i.model.get())==null||n.next()}};MO.ID=H_e;let NU=MO;const OO=class OO extends Ve{constructor(){super({id:OO.ID,label:b("action.inlineSuggest.showPrevious","Show Previous Inline Suggestion"),alias:"Show Previous Inline Suggestion",precondition:he.and(z.writable,Ma.inlineSuggestionVisible),kbOpts:{weight:100,primary:604}})}async run(e,t){var n;const i=Sc.get(t);(n=i==null?void 0:i.model.get())==null||n.previous()}};OO.ID=W_e;let RU=OO;class HJe extends Ve{constructor(){super({id:"editor.action.inlineSuggest.trigger",label:b("action.inlineSuggest.trigger","Trigger Inline Suggestion"),alias:"Trigger Inline Suggestion",precondition:z.writable})}async run(e,t){const i=Sc.get(t);await Xfe(async n=>{var r;await((r=i==null?void 0:i.model.get())==null?void 0:r.triggerExplicitly(n)),i==null||i.playAccessibilitySignal(n)})}}class zJe extends Ve{constructor(){super({id:"editor.action.inlineSuggest.acceptNextWord",label:b("action.inlineSuggest.acceptNextWord","Accept Next Word Of Inline Suggestion"),alias:"Accept Next Word Of Inline Suggestion",precondition:he.and(z.writable,Ma.inlineSuggestionVisible),kbOpts:{weight:101,primary:2065,kbExpr:he.and(z.writable,Ma.inlineSuggestionVisible)},menuOpts:[{menuId:ze.InlineSuggestionToolbar,title:b("acceptWord","Accept Word"),group:"primary",order:2}]})}async run(e,t){var n;const i=Sc.get(t);await((n=i==null?void 0:i.model.get())==null?void 0:n.acceptNextWord(i.editor))}}class UJe extends Ve{constructor(){super({id:"editor.action.inlineSuggest.acceptNextLine",label:b("action.inlineSuggest.acceptNextLine","Accept Next Line Of Inline Suggestion"),alias:"Accept Next Line Of Inline Suggestion",precondition:he.and(z.writable,Ma.inlineSuggestionVisible),kbOpts:{weight:101},menuOpts:[{menuId:ze.InlineSuggestionToolbar,title:b("acceptLine","Accept Line"),group:"secondary",order:2}]})}async run(e,t){var n;const i=Sc.get(t);await((n=i==null?void 0:i.model.get())==null?void 0:n.acceptNextLine(i.editor))}}class jJe extends Ve{constructor(){super({id:B_e,label:b("action.inlineSuggest.accept","Accept Inline Suggestion"),alias:"Accept Inline Suggestion",precondition:Ma.inlineSuggestionVisible,menuOpts:[{menuId:ze.InlineSuggestionToolbar,title:b("accept","Accept"),group:"primary",order:1}],kbOpts:{primary:2,weight:200,kbExpr:he.and(Ma.inlineSuggestionVisible,z.tabMovesFocus.toNegated(),Ma.inlineSuggestionHasIndentationLessThanTabSize,Dt.Visible.toNegated(),z.hoverFocused.toNegated())}})}async run(e,t){var n;const i=Sc.get(t);i&&((n=i.model.get())==null||n.accept(i.editor),i.editor.focus())}}const FO=class FO extends Ve{constructor(){super({id:FO.ID,label:b("action.inlineSuggest.hide","Hide Inline Suggestion"),alias:"Hide Inline Suggestion",precondition:Ma.inlineSuggestionVisible,kbOpts:{weight:100,primary:9}})}async run(e,t){const i=Sc.get(t);pn(n=>{var r;(r=i==null?void 0:i.model.get())==null||r.stop(n)})}};FO.ID="editor.action.inlineSuggest.hide";let AU=FO;const VO=class VO extends To{constructor(){super({id:VO.ID,title:b("action.inlineSuggest.alwaysShowToolbar","Always Show Toolbar"),f1:!1,precondition:void 0,menu:[{id:ze.InlineSuggestionToolbar,group:"secondary",order:10}],toggled:he.equals("config.editor.inlineSuggest.showToolbar","always")})}async run(e,t){const i=e.get(At),r=i.getValue("editor.inlineSuggest.showToolbar")==="always"?"onHover":"always";i.updateValue("editor.inlineSuggest.showToolbar",r)}};VO.ID="editor.action.inlineSuggest.toggleAlwaysShowToolbar";let PU=VO;var $Je=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Hx=function(s,e){return function(t,i){e(t,i,s)}};class qJe{constructor(e,t,i){this.owner=e,this.range=t,this.controller=i}isValidForHoverAnchor(e){return e.type===1&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}let MU=class{constructor(e,t,i,n,r,o){this._editor=e,this._languageService=t,this._openerService=i,this.accessibilityService=n,this._instantiationService=r,this._telemetryService=o,this.hoverOrdinal=4}suggestHoverAnchor(e){const t=Sc.get(this._editor);if(!t)return null;const i=e.target;if(i.type===8){const n=i.detail;if(t.shouldShowHoverAtViewZone(n.viewZoneId))return new GR(1e3,this,F.fromPositions(this._editor.getModel().validatePosition(n.positionBefore||n.position)),e.event.posx,e.event.posy,!1)}return i.type===7&&t.shouldShowHoverAt(i.range)?new GR(1e3,this,i.range,e.event.posx,e.event.posy,!1):i.type===6&&i.detail.mightBeForeignElement&&t.shouldShowHoverAt(i.range)?new GR(1e3,this,i.range,e.event.posx,e.event.posy,!1):null}computeSync(e,t){if(this._editor.getOption(62).showToolbar!=="onHover")return[];const i=Sc.get(this._editor);return i&&i.shouldShowHoverAt(e.range)?[new qJe(this,e.range,i)]:[]}renderHoverParts(e,t){const i=new ce,n=t[0];this._telemetryService.publicLog2("inlineCompletionHover.shown"),this.accessibilityService.isScreenReaderOptimized()&&!this._editor.getOption(8)&&i.add(this.renderScreenReaderText(e,n));const r=n.controller.model.get(),o=this._instantiationService.createInstance(B1,this._editor,!1,hc(null),r.selectedInlineCompletionIndex,r.inlineCompletionsCount,r.activeCommands),a=o.getDomNode();e.fragment.appendChild(a),r.triggerExplicitly(),i.add(o);const l={hoverPart:n,hoverElement:a,dispose(){i.dispose()}};return new Dw([l])}renderScreenReaderText(e,t){const i=new ce,n=ke,r=n("div.hover-row.markdown-hover"),o=me(r,n("div.hover-contents",{"aria-live":"assertive"})),a=i.add(new kg({editor:this._editor},this._languageService,this._openerService)),l=c=>{i.add(a.onDidRenderAsync(()=>{o.className="hover-contents code-hover-contents",e.onContentsChanged()}));const d=b("inlineSuggestionFollows","Suggestion:"),u=i.add(a.render(new Lr().appendText(d).appendCodeblock("text",c)));o.replaceChildren(u.element)};return i.add(ht(c=>{var u;const d=(u=t.controller.model.read(c))==null?void 0:u.primaryGhostText.read(c);if(d){const h=this._editor.getModel().getLineContent(d.lineNumber);l(d.renderForScreenReader(h))}else Xs(o)})),e.fragment.appendChild(r),i}};MU=$Je([Hx(1,un),Hx(2,la),Hx(3,Wa),Hx(4,Xe),Hx(5,Tr)],MU);class KJe{}const k5=new class{constructor(){this._implementations=[]}register(e){return this._implementations.push(e),{dispose:()=>{const t=this._implementations.indexOf(e);t!==-1&&this._implementations.splice(t,1)}}}getImplementations(){return this._implementations}};Zt(Sc.ID,Sc,3);ye(HJe);ye(NU);ye(RU);ye(zJe);ye(UJe);ye(jJe);ye(AU);Oi(PU);n0.register(MU);k5.register(new KJe);var GJe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},BB=function(s,e){return function(t,i){e(t,i,s)}},fL,km;let uE=(km=class{constructor(e,t,i,n){this.textModelResolverService=t,this.languageService=i,this.languageFeaturesService=n,this.toUnhook=new ce,this.toUnhookForKeyboard=new ce,this.currentWordAtPosition=null,this.previousPromise=null,this.editor=e,this.linkDecorations=this.editor.createDecorationsCollection();const r=new b5(e);this.toUnhook.add(r),this.toUnhook.add(r.onMouseMoveOrRelevantKeyDown(([o,a])=>{this.startFindDefinitionFromMouse(o,a??void 0)})),this.toUnhook.add(r.onExecute(o=>{this.isEnabled(o)&&this.gotoDefinition(o.target.position,o.hasSideBySideModifier).catch(a=>{ft(a)}).finally(()=>{this.removeLinkDecorations()})})),this.toUnhook.add(r.onCancel(()=>{this.removeLinkDecorations(),this.currentWordAtPosition=null}))}static get(e){return e.getContribution(fL.ID)}async startFindDefinitionFromCursor(e){await this.startFindDefinition(e),this.toUnhookForKeyboard.add(this.editor.onDidChangeCursorPosition(()=>{this.currentWordAtPosition=null,this.removeLinkDecorations(),this.toUnhookForKeyboard.clear()})),this.toUnhookForKeyboard.add(this.editor.onKeyDown(t=>{t&&(this.currentWordAtPosition=null,this.removeLinkDecorations(),this.toUnhookForKeyboard.clear())}))}startFindDefinitionFromMouse(e,t){if(e.target.type===9&&this.linkDecorations.length>0)return;if(!this.editor.hasModel()||!this.isEnabled(e,t)){this.currentWordAtPosition=null,this.removeLinkDecorations();return}const i=e.target.position;this.startFindDefinition(i)}async startFindDefinition(e){var o;this.toUnhookForKeyboard.clear();const t=e?(o=this.editor.getModel())==null?void 0:o.getWordAtPosition(e):null;if(!t){this.currentWordAtPosition=null,this.removeLinkDecorations();return}if(this.currentWordAtPosition&&this.currentWordAtPosition.startColumn===t.startColumn&&this.currentWordAtPosition.endColumn===t.endColumn&&this.currentWordAtPosition.word===t.word)return;this.currentWordAtPosition=t;const i=new xme(this.editor,15);this.previousPromise&&(this.previousPromise.cancel(),this.previousPromise=null),this.previousPromise=xs(a=>this.findDefinition(e,a));let n;try{n=await this.previousPromise}catch(a){ft(a);return}if(!n||!n.length||!i.validate(this.editor)){this.removeLinkDecorations();return}const r=n[0].originSelectionRange?F.lift(n[0].originSelectionRange):new F(e.lineNumber,t.startColumn,e.lineNumber,t.endColumn);if(n.length>1){let a=r;for(const{originSelectionRange:l}of n)l&&(a=F.plusRange(a,l));this.addDecoration(a,new Lr().appendText(b("multipleResults","Click to show {0} definitions.",n.length)))}else{const a=n[0];if(!a.uri)return;this.textModelResolverService.createModelReference(a.uri).then(l=>{if(!l.object||!l.object.textEditorModel){l.dispose();return}const{object:{textEditorModel:c}}=l,{startLineNumber:d}=a.range;if(d<1||d>c.getLineCount()){l.dispose();return}const u=this.getPreviewValue(c,d,a),h=this.languageService.guessLanguageIdByFilepathOrFirstLine(c.uri);this.addDecoration(r,u?new Lr().appendCodeblock(h||"",u):void 0),l.dispose()})}}getPreviewValue(e,t,i){let n=i.range;return n.endLineNumber-n.startLineNumber>=fL.MAX_SOURCE_PREVIEW_LINES&&(n=this.getPreviewRangeBasedOnIndentation(e,t)),this.stripIndentationFromPreviewRange(e,t,n)}stripIndentationFromPreviewRange(e,t,i){let r=e.getLineFirstNonWhitespaceColumn(t);for(let a=t+1;a<i.endLineNumber;a++){const l=e.getLineFirstNonWhitespaceColumn(a);r=Math.min(r,l)}return e.getValueInRange(i).replace(new RegExp(`^\\s{${r-1}}`,"gm"),"").trim()}getPreviewRangeBasedOnIndentation(e,t){const i=e.getLineFirstNonWhitespaceColumn(t),n=Math.min(e.getLineCount(),t+fL.MAX_SOURCE_PREVIEW_LINES);let r=t+1;for(;r<n;r++){const o=e.getLineFirstNonWhitespaceColumn(r);if(i===o)break}return new F(t,1,r+1,1)}addDecoration(e,t){const i={range:e,options:{description:"goto-definition-link",inlineClassName:"goto-definition-link",hoverMessage:t}};this.linkDecorations.set([i])}removeLinkDecorations(){this.linkDecorations.clear()}isEnabled(e,t){var i;return this.editor.hasModel()&&e.isLeftClick&&e.isNoneOrSingleMouseDown&&e.target.type===6&&!(((i=e.target.detail.injectedText)==null?void 0:i.options)instanceof Zm)&&(e.hasTriggerModifier||(t?t.keyCodeIsTriggerKey:!1))&&this.languageFeaturesService.definitionProvider.has(this.editor.getModel())}findDefinition(e,t){const i=this.editor.getModel();return i?wD(this.languageFeaturesService.definitionProvider,i,e,!1,t):Promise.resolve(null)}gotoDefinition(e,t){return this.editor.setPosition(e),this.editor.invokeWithinContext(i=>{const n=!t&&this.editor.getOption(89)&&!this.isInPeekEditor(i);return new yD({openToSide:t,openInPeek:n,muteMessage:!0},{title:{value:"",original:""},id:"",precondition:void 0}).run(i)})}isInPeekEditor(e){const t=e.get(ct);return sa.inPeekEditor.getValue(t)}dispose(){this.toUnhook.dispose(),this.toUnhookForKeyboard.dispose()}},fL=km,km.ID="editor.contrib.gotodefinitionatposition",km.MAX_SOURCE_PREVIEW_LINES=8,km);uE=fL=GJe([BB(1,oa),BB(2,un),BB(3,Be)],uE);Zt(uE.ID,uE,2);var Rbe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},oM=function(s,e){return function(t,i){e(t,i,s)}};class Foe{constructor(e,t,i){this.marker=e,this.index=t,this.total=i}}let OU=class{constructor(e,t,i){this._markerService=t,this._configService=i,this._onDidChange=new Z,this.onDidChange=this._onDidChange.event,this._dispoables=new ce,this._markers=[],this._nextIdx=-1,Je.isUri(e)?this._resourceFilter=a=>a.toString()===e.toString():e&&(this._resourceFilter=e);const n=this._configService.getValue("problems.sortOrder"),r=(a,l)=>{let c=eI(a.resource.toString(),l.resource.toString());return c===0&&(n==="position"?c=F.compareRangesUsingStarts(a,l)||In.compare(a.severity,l.severity):c=In.compare(a.severity,l.severity)||F.compareRangesUsingStarts(a,l)),c},o=()=>{this._markers=this._markerService.read({resource:Je.isUri(e)?e:void 0,severities:In.Error|In.Warning|In.Info}),typeof e=="function"&&(this._markers=this._markers.filter(a=>this._resourceFilter(a.resource))),this._markers.sort(r)};o(),this._dispoables.add(t.onMarkerChanged(a=>{(!this._resourceFilter||a.some(l=>this._resourceFilter(l)))&&(o(),this._nextIdx=-1,this._onDidChange.fire())}))}dispose(){this._dispoables.dispose(),this._onDidChange.dispose()}matches(e){return!this._resourceFilter&&!e?!0:!this._resourceFilter||!e?!1:this._resourceFilter(e)}get selected(){const e=this._markers[this._nextIdx];return e&&new Foe(e,this._nextIdx+1,this._markers.length)}_initIdx(e,t,i){let n=!1,r=this._markers.findIndex(o=>o.resource.toString()===e.uri.toString());r<0&&(r=$k(this._markers,{resource:e.uri},(o,a)=>eI(o.resource.toString(),a.resource.toString())),r<0&&(r=~r));for(let o=r;o<this._markers.length;o++){let a=F.lift(this._markers[o]);if(a.isEmpty()){const l=e.getWordAtPosition(a.getStartPosition());l&&(a=new F(a.startLineNumber,l.startColumn,a.startLineNumber,l.endColumn))}if(t&&(a.containsPosition(t)||t.isBeforeOrEqual(a.getStartPosition()))){this._nextIdx=o,n=!0;break}if(this._markers[o].resource.toString()!==e.uri.toString())break}n||(this._nextIdx=i?0:this._markers.length-1),this._nextIdx<0&&(this._nextIdx=this._markers.length-1)}resetIndex(){this._nextIdx=-1}move(e,t,i){if(this._markers.length===0)return!1;const n=this._nextIdx;return this._nextIdx===-1?this._initIdx(t,i,e):e?this._nextIdx=(this._nextIdx+1)%this._markers.length:e||(this._nextIdx=(this._nextIdx-1+this._markers.length)%this._markers.length),n!==this._nextIdx}find(e,t){let i=this._markers.findIndex(n=>n.resource.toString()===e.toString());if(!(i<0)){for(;i<this._markers.length;i++)if(F.containsPosition(this._markers[i],t))return new Foe(this._markers[i],i+1,this._markers.length)}}};OU=Rbe([oM(1,Gh),oM(2,At)],OU);const Abe=Ht("IMarkerNavigationService");let FU=class{constructor(e,t){this._markerService=e,this._configService=t,this._provider=new _o}getMarkerList(e){for(const t of this._provider){const i=t.getMarkerList(e);if(i)return i}return new OU(e,this._markerService,this._configService)}};FU=Rbe([oM(0,Gh),oM(1,At)],FU);qt(Abe,FU,1);var VU;(function(s){function e(t){switch(t){case Hn.Ignore:return"severity-ignore "+at.asClassName(xe.info);case Hn.Info:return at.asClassName(xe.info);case Hn.Warning:return at.asClassName(xe.warning);case Hn.Error:return at.asClassName(xe.error);default:return""}}s.className=e})(VU||(VU={}));var QJe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},rC=function(s,e){return function(t,i){e(t,i,s)}},BU;class YJe{constructor(e,t,i,n,r){this._openerService=n,this._labelService=r,this._lines=0,this._longestLineLength=0,this._relatedDiagnostics=new WeakMap,this._disposables=new ce,this._editor=t;const o=document.createElement("div");o.className="descriptioncontainer",this._messageBlock=document.createElement("div"),this._messageBlock.classList.add("message"),this._messageBlock.setAttribute("aria-live","assertive"),this._messageBlock.setAttribute("role","alert"),o.appendChild(this._messageBlock),this._relatedBlock=document.createElement("div"),o.appendChild(this._relatedBlock),this._disposables.add(yn(this._relatedBlock,"click",a=>{a.preventDefault();const l=this._relatedDiagnostics.get(a.target);l&&i(l)})),this._scrollable=new Sfe(o,{horizontal:1,vertical:1,useShadows:!1,horizontalScrollbarSize:6,verticalScrollbarSize:6}),e.appendChild(this._scrollable.getDomNode()),this._disposables.add(this._scrollable.onScroll(a=>{o.style.left=`-${a.scrollLeft}px`,o.style.top=`-${a.scrollTop}px`})),this._disposables.add(this._scrollable)}dispose(){Ni(this._disposables)}update(e){const{source:t,message:i,relatedInformation:n,code:r}=e;let o=((t==null?void 0:t.length)||0)+2;r&&(typeof r=="string"?o+=r.length:o+=r.value.length);const a=Uh(i);this._lines=a.length,this._longestLineLength=0;for(const h of a)this._longestLineLength=Math.max(h.length+o,this._longestLineLength);Ys(this._messageBlock),this._messageBlock.setAttribute("aria-label",this.getAriaLabel(e)),this._editor.applyFontInfo(this._messageBlock);let l=this._messageBlock;for(const h of a)l=document.createElement("div"),l.innerText=h,h===""&&(l.style.height=this._messageBlock.style.lineHeight),this._messageBlock.appendChild(l);if(t||r){const h=document.createElement("span");if(h.classList.add("details"),l.appendChild(h),t){const g=document.createElement("span");g.innerText=t,g.classList.add("source"),h.appendChild(g)}if(r)if(typeof r=="string"){const g=document.createElement("span");g.innerText=`(${r})`,g.classList.add("code"),h.appendChild(g)}else{this._codeLink=ke("a.code-link"),this._codeLink.setAttribute("href",`${r.target.toString()}`),this._codeLink.onclick=p=>{this._openerService.open(r.target,{allowCommands:!0}),p.preventDefault(),p.stopPropagation()};const g=me(this._codeLink,ke("span"));g.innerText=r.value,h.appendChild(this._codeLink)}}if(Ys(this._relatedBlock),this._editor.applyFontInfo(this._relatedBlock),Xr(n)){const h=this._relatedBlock.appendChild(document.createElement("div"));h.style.paddingTop=`${Math.floor(this._editor.getOption(67)*.66)}px`,this._lines+=1;for(const g of n){const p=document.createElement("div"),_=document.createElement("a");_.classList.add("filename"),_.innerText=`${this._labelService.getUriBasenameLabel(g.resource)}(${g.startLineNumber}, ${g.startColumn}): `,_.title=this._labelService.getUriLabel(g.resource),this._relatedDiagnostics.set(_,g);const v=document.createElement("span");v.innerText=g.message,p.appendChild(_),p.appendChild(v),this._lines+=1,h.appendChild(p)}}const c=this._editor.getOption(50),d=Math.ceil(c.typicalFullwidthCharacterWidth*this._longestLineLength*.75),u=c.lineHeight*this._lines;this._scrollable.setScrollDimensions({scrollWidth:d,scrollHeight:u})}layout(e,t){this._scrollable.getDomNode().style.height=`${e}px`,this._scrollable.getDomNode().style.width=`${t}px`,this._scrollable.setScrollDimensions({width:t,height:e})}getHeightInLines(){return Math.min(17,this._lines)}getAriaLabel(e){let t="";switch(e.severity){case In.Error:t=b("Error","Error");break;case In.Warning:t=b("Warning","Warning");break;case In.Info:t=b("Info","Info");break;case In.Hint:t=b("Hint","Hint");break}let i=b("marker aria","{0} at {1}. ",t,e.startLineNumber+":"+e.startColumn);const n=this._editor.getModel();return n&&e.startLineNumber<=n.getLineCount()&&e.startLineNumber>=1&&(i=`${n.getLineContent(e.startLineNumber)}, ${i}`),i}}var Bv;let hE=(Bv=class extends FP{constructor(e,t,i,n,r,o,a){super(e,{showArrow:!0,showFrame:!0,isAccessible:!0,frameWidth:1},r),this._themeService=t,this._openerService=i,this._menuService=n,this._contextKeyService=o,this._labelService=a,this._callOnDispose=new ce,this._onDidSelectRelatedInformation=new Z,this.onDidSelectRelatedInformation=this._onDidSelectRelatedInformation.event,this._severity=In.Warning,this._backgroundColor=fe.white,this._applyTheme(t.getColorTheme()),this._callOnDispose.add(t.onDidColorThemeChange(this._applyTheme.bind(this))),this.create()}_applyTheme(e){this._backgroundColor=e.getColor(eet);let t=WU,i=XJe;this._severity===In.Warning?(t=ZR,i=ZJe):this._severity===In.Info&&(t=HU,i=JJe);const n=e.getColor(t),r=e.getColor(i);this.style({arrowColor:n,frameColor:n,headerBackgroundColor:r,primaryHeadingColor:e.getColor(X_e),secondaryHeadingColor:e.getColor(Z_e)})}_applyStyles(){this._parentContainer&&(this._parentContainer.style.backgroundColor=this._backgroundColor?this._backgroundColor.toString():""),super._applyStyles()}dispose(){this._callOnDispose.dispose(),super.dispose()}_fillHead(e){super._fillHead(e),this._disposables.add(this._actionbarWidget.actionRunner.onWillRun(n=>this.editor.focus()));const t=[],i=this._menuService.getMenuActions(BU.TitleMenu,this._contextKeyService);zF(i,t),this._actionbarWidget.push(t,{label:!1,icon:!0,index:0})}_fillTitleIcon(e){this._icon=me(e,ke(""))}_fillBody(e){this._parentContainer=e,e.classList.add("marker-widget"),this._parentContainer.tabIndex=0,this._parentContainer.setAttribute("role","tooltip"),this._container=document.createElement("div"),e.appendChild(this._container),this._message=new YJe(this._container,this.editor,t=>this._onDidSelectRelatedInformation.fire(t),this._openerService,this._labelService),this._disposables.add(this._message)}show(){throw new Error("call showAtMarker")}showAtMarker(e,t,i){this._container.classList.remove("stale"),this._message.update(e),this._severity=e.severity,this._applyTheme(this._themeService.getColorTheme());const n=F.lift(e),r=this.editor.getPosition(),o=r&&n.containsPosition(r)?r:n.getStartPosition();super.show(o,this.computeRequiredHeight());const a=this.editor.getModel();if(a){const l=i>1?b("problems","{0} of {1} problems",t,i):b("change","{0} of {1} problem",t,i);this.setTitle(Cc(a.uri),l)}this._icon.className=`codicon ${VU.className(In.toSeverity(this._severity))}`,this.editor.revealPositionNearTop(o,0),this.editor.focus()}updateMarker(e){this._container.classList.remove("stale"),this._message.update(e)}showStale(){this._container.classList.add("stale"),this._relayout()}_doLayoutBody(e,t){super._doLayoutBody(e,t),this._heightInPixel=e,this._message.layout(e,t),this._container.style.height=`${e}px`}_onWidth(e){this._message.layout(this._heightInPixel,e)}_relayout(){super._relayout(this.computeRequiredHeight())}computeRequiredHeight(){return 3+this._message.getHeightInLines()}},BU=Bv,Bv.TitleMenu=new ze("gotoErrorTitleMenu"),Bv);hE=BU=QJe([rC(1,gs),rC(2,la),rC(3,Ol),rC(4,Xe),rC(5,ct),rC(6,x1)],hE);const Voe=uI(xF,$Oe),Boe=uI(Lg,hI),Woe=uI(Ph,fI),WU=j("editorMarkerNavigationError.background",{dark:Voe,light:Voe,hcDark:Xt,hcLight:Xt},b("editorMarkerNavigationError","Editor marker navigation widget error color.")),XJe=j("editorMarkerNavigationError.headerBackground",{dark:Tt(WU,.1),light:Tt(WU,.1),hcDark:null,hcLight:null},b("editorMarkerNavigationErrorHeaderBackground","Editor marker navigation widget error heading background.")),ZR=j("editorMarkerNavigationWarning.background",{dark:Boe,light:Boe,hcDark:Xt,hcLight:Xt},b("editorMarkerNavigationWarning","Editor marker navigation widget warning color.")),ZJe=j("editorMarkerNavigationWarning.headerBackground",{dark:Tt(ZR,.1),light:Tt(ZR,.1),hcDark:"#0C141F",hcLight:Tt(ZR,.2)},b("editorMarkerNavigationWarningBackground","Editor marker navigation widget warning heading background.")),HU=j("editorMarkerNavigationInfo.background",{dark:Woe,light:Woe,hcDark:Xt,hcLight:Xt},b("editorMarkerNavigationInfo","Editor marker navigation widget info color.")),JJe=j("editorMarkerNavigationInfo.headerBackground",{dark:Tt(HU,.1),light:Tt(HU,.1),hcDark:null,hcLight:null},b("editorMarkerNavigationInfoHeaderBackground","Editor marker navigation widget info heading background.")),eet=j("editorMarkerNavigation.background",dd,b("editorMarkerNavigationBackground","Editor marker navigation widget background."));var tet=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},eR=function(s,e){return function(t,i){e(t,i,s)}},gL,Wv;let Rw=(Wv=class{static get(e){return e.getContribution(gL.ID)}constructor(e,t,i,n,r){this._markerNavigationService=t,this._contextKeyService=i,this._editorService=n,this._instantiationService=r,this._sessionDispoables=new ce,this._editor=e,this._widgetVisible=Pbe.bindTo(this._contextKeyService)}dispose(){this._cleanUp(),this._sessionDispoables.dispose()}_cleanUp(){this._widgetVisible.reset(),this._sessionDispoables.clear(),this._widget=void 0,this._model=void 0}_getOrCreateModel(e){if(this._model&&this._model.matches(e))return this._model;let t=!1;return this._model&&(t=!0,this._cleanUp()),this._model=this._markerNavigationService.getMarkerList(e),t&&this._model.move(!0,this._editor.getModel(),this._editor.getPosition()),this._widget=this._instantiationService.createInstance(hE,this._editor),this._widget.onDidClose(()=>this.close(),this,this._sessionDispoables),this._widgetVisible.set(!0),this._sessionDispoables.add(this._model),this._sessionDispoables.add(this._widget),this._sessionDispoables.add(this._editor.onDidChangeCursorPosition(i=>{var n,r,o;(!((n=this._model)!=null&&n.selected)||!F.containsPosition((r=this._model)==null?void 0:r.selected.marker,i.position))&&((o=this._model)==null||o.resetIndex())})),this._sessionDispoables.add(this._model.onDidChange(()=>{if(!this._widget||!this._widget.position||!this._model)return;const i=this._model.find(this._editor.getModel().uri,this._widget.position);i?this._widget.updateMarker(i.marker):this._widget.showStale()})),this._sessionDispoables.add(this._widget.onDidSelectRelatedInformation(i=>{this._editorService.openCodeEditor({resource:i.resource,options:{pinned:!0,revealIfOpened:!0,selection:F.lift(i).collapseToStart()}},this._editor),this.close(!1)})),this._sessionDispoables.add(this._editor.onDidChangeModel(()=>this._cleanUp())),this._model}close(e=!0){this._cleanUp(),e&&this._editor.focus()}showAtMarker(e){if(this._editor.hasModel()){const t=this._getOrCreateModel(this._editor.getModel().uri);t.resetIndex(),t.move(!0,this._editor.getModel(),new X(e.startLineNumber,e.startColumn)),t.selected&&this._widget.showAtMarker(t.selected.marker,t.selected.index,t.selected.total)}}async nagivate(e,t){var i,n;if(this._editor.hasModel()){const r=this._getOrCreateModel(t?void 0:this._editor.getModel().uri);if(r.move(e,this._editor.getModel(),this._editor.getPosition()),!r.selected)return;if(r.selected.marker.resource.toString()!==this._editor.getModel().uri.toString()){this._cleanUp();const o=await this._editorService.openCodeEditor({resource:r.selected.marker.resource,options:{pinned:!1,revealIfOpened:!0,selectionRevealType:2,selection:r.selected.marker}},this._editor);o&&((i=gL.get(o))==null||i.close(),(n=gL.get(o))==null||n.nagivate(e,t))}else this._widget.showAtMarker(r.selected.marker,r.selected.index,r.selected.total)}}},gL=Wv,Wv.ID="editor.contrib.markerController",Wv);Rw=gL=tet([eR(1,Abe),eR(2,ct),eR(3,ni),eR(4,Xe)],Rw);class I5 extends Ve{constructor(e,t,i){super(i),this._next=e,this._multiFile=t}async run(e,t){var i;t.hasModel()&&((i=Rw.get(t))==null||i.nagivate(this._next,this._multiFile))}}const Ab=class Ab extends I5{constructor(){super(!0,!1,{id:Ab.ID,label:Ab.LABEL,alias:"Go to Next Problem (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:z.focus,primary:578,weight:100},menuOpts:{menuId:hE.TitleMenu,title:Ab.LABEL,icon:Qi("marker-navigation-next",xe.arrowDown,b("nextMarkerIcon","Icon for goto next marker.")),group:"navigation",order:1}})}};Ab.ID="editor.action.marker.next",Ab.LABEL=b("markerAction.next.label","Go to Next Problem (Error, Warning, Info)");let aM=Ab;const Pb=class Pb extends I5{constructor(){super(!1,!1,{id:Pb.ID,label:Pb.LABEL,alias:"Go to Previous Problem (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:z.focus,primary:1602,weight:100},menuOpts:{menuId:hE.TitleMenu,title:Pb.LABEL,icon:Qi("marker-navigation-previous",xe.arrowUp,b("previousMarkerIcon","Icon for goto previous marker.")),group:"navigation",order:2}})}};Pb.ID="editor.action.marker.prev",Pb.LABEL=b("markerAction.previous.label","Go to Previous Problem (Error, Warning, Info)");let zU=Pb;class iet extends I5{constructor(){super(!0,!0,{id:"editor.action.marker.nextInFiles",label:b("markerAction.nextInFiles.label","Go to Next Problem in Files (Error, Warning, Info)"),alias:"Go to Next Problem in Files (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:z.focus,primary:66,weight:100},menuOpts:{menuId:ze.MenubarGoMenu,title:b({key:"miGotoNextProblem",comment:["&& denotes a mnemonic"]},"Next &&Problem"),group:"6_problem_nav",order:1}})}}class net extends I5{constructor(){super(!1,!0,{id:"editor.action.marker.prevInFiles",label:b("markerAction.previousInFiles.label","Go to Previous Problem in Files (Error, Warning, Info)"),alias:"Go to Previous Problem in Files (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:z.focus,primary:1090,weight:100},menuOpts:{menuId:ze.MenubarGoMenu,title:b({key:"miGotoPreviousProblem",comment:["&& denotes a mnemonic"]},"Previous &&Problem"),group:"6_problem_nav",order:2}})}}Zt(Rw.ID,Rw,4);ye(aM);ye(zU);ye(iet);ye(net);const Pbe=new Oe("markersNavigationVisible",!1),set=fs.bindToContribution(Rw.get);Me(new set({id:"closeMarkersNavigation",precondition:Pbe,handler:s=>s.close(),kbOpts:{weight:150,kbExpr:z.focus,primary:9,secondary:[1033]}}));var Bd;(function(s){s.NoAutoFocus="noAutoFocus",s.FocusIfVisible="focusIfVisible",s.AutoFocusImmediately="autoFocusImmediately"})(Bd||(Bd={}));class ret extends Ve{constructor(){super({id:V_e,label:b({key:"showOrFocusHover",comment:["Label for action that will trigger the showing/focusing of a hover in the editor.","If the hover is not visible, it will show the hover.","This allows for users to show the hover without using the mouse."]},"Show or Focus Hover"),metadata:{description:dt("showOrFocusHoverDescription","Show or focus the editor hover which shows documentation, references, and other content for a symbol at the current cursor position."),args:[{name:"args",schema:{type:"object",properties:{focus:{description:"Controls if and when the hover should take focus upon being triggered by this action.",enum:[Bd.NoAutoFocus,Bd.FocusIfVisible,Bd.AutoFocusImmediately],enumDescriptions:[b("showOrFocusHover.focus.noAutoFocus","The hover will not automatically take focus."),b("showOrFocusHover.focus.focusIfVisible","The hover will take focus only if it is already visible."),b("showOrFocusHover.focus.autoFocusImmediately","The hover will automatically take focus when it appears.")],default:Bd.FocusIfVisible}}}}]},alias:"Show or Focus Hover",precondition:void 0,kbOpts:{kbExpr:z.editorTextFocus,primary:ns(2089,2087),weight:100}})}run(e,t,i){if(!t.hasModel())return;const n=Jr.get(t);if(!n)return;const r=i==null?void 0:i.focus;let o=Bd.FocusIfVisible;Object.values(Bd).includes(r)?o=r:typeof r=="boolean"&&r&&(o=Bd.AutoFocusImmediately);const a=c=>{const d=t.getPosition(),u=new F(d.lineNumber,d.column,d.lineNumber,d.column);n.showContentHover(u,1,1,c)},l=t.getOption(2)===2;n.isHoverVisible?o!==Bd.NoAutoFocus?n.focus():a(l):a(l||o===Bd.AutoFocusImmediately)}}class oet extends Ve{constructor(){super({id:SQe,label:b({key:"showDefinitionPreviewHover",comment:["Label for action that will trigger the showing of definition preview hover in the editor.","This allows for users to show the definition preview hover without using the mouse."]},"Show Definition Preview Hover"),alias:"Show Definition Preview Hover",precondition:void 0,metadata:{description:dt("showDefinitionPreviewHoverDescription","Show the definition preview hover in the editor.")}})}run(e,t){const i=Jr.get(t);if(!i)return;const n=t.getPosition();if(!n)return;const r=new F(n.lineNumber,n.column,n.lineNumber,n.column),o=uE.get(t);if(!o)return;o.startFindDefinitionFromCursor(n).then(()=>{i.showContentHover(r,1,1,!0)})}}class aet extends Ve{constructor(){super({id:xQe,label:b({key:"scrollUpHover",comment:["Action that allows to scroll up in the hover widget with the up arrow when the hover widget is focused."]},"Scroll Up Hover"),alias:"Scroll Up Hover",precondition:z.hoverFocused,kbOpts:{kbExpr:z.hoverFocused,primary:16,weight:100},metadata:{description:dt("scrollUpHoverDescription","Scroll up the editor hover.")}})}run(e,t){const i=Jr.get(t);i&&i.scrollUp()}}class cet extends Ve{constructor(){super({id:LQe,label:b({key:"scrollDownHover",comment:["Action that allows to scroll down in the hover widget with the up arrow when the hover widget is focused."]},"Scroll Down Hover"),alias:"Scroll Down Hover",precondition:z.hoverFocused,kbOpts:{kbExpr:z.hoverFocused,primary:18,weight:100},metadata:{description:dt("scrollDownHoverDescription","Scroll down the editor hover.")}})}run(e,t){const i=Jr.get(t);i&&i.scrollDown()}}class det extends Ve{constructor(){super({id:kQe,label:b({key:"scrollLeftHover",comment:["Action that allows to scroll left in the hover widget with the left arrow when the hover widget is focused."]},"Scroll Left Hover"),alias:"Scroll Left Hover",precondition:z.hoverFocused,kbOpts:{kbExpr:z.hoverFocused,primary:15,weight:100},metadata:{description:dt("scrollLeftHoverDescription","Scroll left the editor hover.")}})}run(e,t){const i=Jr.get(t);i&&i.scrollLeft()}}class uet extends Ve{constructor(){super({id:IQe,label:b({key:"scrollRightHover",comment:["Action that allows to scroll right in the hover widget with the right arrow when the hover widget is focused."]},"Scroll Right Hover"),alias:"Scroll Right Hover",precondition:z.hoverFocused,kbOpts:{kbExpr:z.hoverFocused,primary:17,weight:100},metadata:{description:dt("scrollRightHoverDescription","Scroll right the editor hover.")}})}run(e,t){const i=Jr.get(t);i&&i.scrollRight()}}class het extends Ve{constructor(){super({id:EQe,label:b({key:"pageUpHover",comment:["Action that allows to page up in the hover widget with the page up command when the hover widget is focused."]},"Page Up Hover"),alias:"Page Up Hover",precondition:z.hoverFocused,kbOpts:{kbExpr:z.hoverFocused,primary:11,secondary:[528],weight:100},metadata:{description:dt("pageUpHoverDescription","Page up the editor hover.")}})}run(e,t){const i=Jr.get(t);i&&i.pageUp()}}class fet extends Ve{constructor(){super({id:DQe,label:b({key:"pageDownHover",comment:["Action that allows to page down in the hover widget with the page down command when the hover widget is focused."]},"Page Down Hover"),alias:"Page Down Hover",precondition:z.hoverFocused,kbOpts:{kbExpr:z.hoverFocused,primary:12,secondary:[530],weight:100},metadata:{description:dt("pageDownHoverDescription","Page down the editor hover.")}})}run(e,t){const i=Jr.get(t);i&&i.pageDown()}}class get extends Ve{constructor(){super({id:TQe,label:b({key:"goToTopHover",comment:["Action that allows to go to the top of the hover widget with the home command when the hover widget is focused."]},"Go To Top Hover"),alias:"Go To Bottom Hover",precondition:z.hoverFocused,kbOpts:{kbExpr:z.hoverFocused,primary:14,secondary:[2064],weight:100},metadata:{description:dt("goToTopHoverDescription","Go to the top of the editor hover.")}})}run(e,t){const i=Jr.get(t);i&&i.goToTop()}}class pet extends Ve{constructor(){super({id:NQe,label:b({key:"goToBottomHover",comment:["Action that allows to go to the bottom in the hover widget with the end command when the hover widget is focused."]},"Go To Bottom Hover"),alias:"Go To Bottom Hover",precondition:z.hoverFocused,kbOpts:{kbExpr:z.hoverFocused,primary:13,secondary:[2066],weight:100},metadata:{description:dt("goToBottomHoverDescription","Go to the bottom of the editor hover.")}})}run(e,t){const i=Jr.get(t);i&&i.goToBottom()}}class met extends Ve{constructor(){super({id:p5,label:RQe,alias:"Increase Hover Verbosity Level",precondition:z.hoverVisible})}run(e,t,i){const n=Jr.get(t);if(!n)return;const r=(i==null?void 0:i.index)!==void 0?i.index:n.focusedHoverPartIndex();n.updateHoverVerbosityLevel(La.Increase,r,i==null?void 0:i.focus)}}class _et extends Ve{constructor(){super({id:m5,label:AQe,alias:"Decrease Hover Verbosity Level",precondition:z.hoverVisible})}run(e,t,i){var o;const n=Jr.get(t);if(!n)return;const r=(i==null?void 0:i.index)!==void 0?i.index:n.focusedHoverPartIndex();(o=Jr.get(t))==null||o.updateHoverVerbosityLevel(La.Decrease,r,i==null?void 0:i.focus)}}var bet=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},WB=function(s,e){return function(t,i){e(t,i,s)}};const Bc=ke;class vet{constructor(e,t,i){this.owner=e,this.range=t,this.marker=i}isValidForHoverAnchor(e){return e.type===1&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}const Hoe={type:1,filter:{include:en.QuickFix},triggerAction:Va.QuickFixHover};let UU=class{constructor(e,t,i,n){this._editor=e,this._markerDecorationsService=t,this._openerService=i,this._languageFeaturesService=n,this.hoverOrdinal=1,this.recentMarkerCodeActionsInfo=void 0}computeSync(e,t){if(!this._editor.hasModel()||e.type!==1&&!e.supportsMarkerHover)return[];const i=this._editor.getModel(),n=e.range.startLineNumber,r=i.getLineMaxColumn(n),o=[];for(const a of t){const l=a.range.startLineNumber===n?a.range.startColumn:1,c=a.range.endLineNumber===n?a.range.endColumn:r,d=this._markerDecorationsService.getMarker(i.uri,a);if(!d)continue;const u=new F(e.range.startLineNumber,l,e.range.startLineNumber,c);o.push(new vet(this,u,d))}return o}renderHoverParts(e,t){if(!t.length)return new Dw([]);const i=new ce,n=[];t.forEach(o=>{const a=this._renderMarkerHover(o);e.fragment.appendChild(a.hoverElement),n.push(a)});const r=t.length===1?t[0]:t.sort((o,a)=>In.compare(o.marker.severity,a.marker.severity))[0];return this.renderMarkerStatusbar(e,r,i),new Dw(n)}_renderMarkerHover(e){const t=new ce,i=Bc("div.hover-row"),n=me(i,Bc("div.marker.hover-contents")),{source:r,message:o,code:a,relatedInformation:l}=e.marker;this._editor.applyFontInfo(n);const c=me(n,Bc("span"));if(c.style.whiteSpace="pre-wrap",c.innerText=o,r||a)if(a&&typeof a!="string"){const u=Bc("span");if(r){const _=me(u,Bc("span"));_.innerText=r}const h=me(u,Bc("a.code-link"));h.setAttribute("href",a.target.toString()),t.add(oe(h,"click",_=>{this._openerService.open(a.target,{allowCommands:!0}),_.preventDefault(),_.stopPropagation()}));const g=me(h,Bc("span"));g.innerText=a.value;const p=me(n,u);p.style.opacity="0.6",p.style.paddingLeft="6px"}else{const u=me(n,Bc("span"));u.style.opacity="0.6",u.style.paddingLeft="6px",u.innerText=r&&a?`${r}(${a})`:r||`(${a})`}if(Xr(l))for(const{message:u,resource:h,startLineNumber:g,startColumn:p}of l){const _=me(n,Bc("div"));_.style.marginTop="8px";const v=me(_,Bc("a"));v.innerText=`${Cc(h)}(${g}, ${p}): `,v.style.cursor="pointer",t.add(oe(v,"click",y=>{if(y.stopPropagation(),y.preventDefault(),this._openerService){const x={selection:{startLineNumber:g,startColumn:p}};this._openerService.open(h,{fromUserGesture:!0,editorOptions:x}).catch(ft)}}));const C=me(_,Bc("span"));C.innerText=u,this._editor.applyFontInfo(C)}return{hoverPart:e,hoverElement:i,dispose:()=>t.dispose()}}renderMarkerStatusbar(e,t,i){if(t.marker.severity===In.Error||t.marker.severity===In.Warning||t.marker.severity===In.Info){const n=Rw.get(this._editor);n&&e.statusBar.addAction({label:b("view problem","View Problem"),commandId:aM.ID,run:()=>{e.hide(),n.showAtMarker(t.marker),this._editor.focus()}})}if(!this._editor.getOption(92)){const n=e.statusBar.append(Bc("div"));this.recentMarkerCodeActionsInfo&&(DA.makeKey(this.recentMarkerCodeActionsInfo.marker)===DA.makeKey(t.marker)?this.recentMarkerCodeActionsInfo.hasCodeActions||(n.textContent=b("noQuickFixes","No quick fixes available")):this.recentMarkerCodeActionsInfo=void 0);const r=this.recentMarkerCodeActionsInfo&&!this.recentMarkerCodeActionsInfo.hasCodeActions?te.None:$m(()=>n.textContent=b("checkingForQuickFixes","Checking for quick fixes..."),200,i);n.textContent||(n.textContent=" ");const o=this.getCodeActions(t.marker);i.add(Ye(()=>o.cancel())),o.then(a=>{if(r.dispose(),this.recentMarkerCodeActionsInfo={marker:t.marker,hasCodeActions:a.validActions.length>0},!this.recentMarkerCodeActionsInfo.hasCodeActions){a.dispose(),n.textContent=b("noQuickFixes","No quick fixes available");return}n.style.display="none";let l=!1;i.add(Ye(()=>{l||a.dispose()})),e.statusBar.addAction({label:b("quick fixes","Quick Fix..."),commandId:fQ,run:c=>{l=!0;const d=F1.get(this._editor),u=Pn(c);e.hide(),d==null||d.showCodeActions(Hoe,a,{x:u.left,y:u.top,width:u.width,height:u.height})}})},ft)}}getCodeActions(e){return xs(t=>BC(this._languageFeaturesService.codeActionProvider,this._editor.getModel(),new F(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn),Hoe,Zd.None,t))}};UU=bet([WB(1,BK),WB(2,la),WB(3,Be)],UU);class wet{get lineNumber(){return this._lineNumber}set lineNumber(e){this._lineNumber=e}get lane(){return this._laneOrLine}set lane(e){this._laneOrLine=e}constructor(e){this._editor=e,this._lineNumber=-1,this._laneOrLine=ld.Center}computeSync(){var r;const e=o=>({value:o}),t=this._editor.getLineDecorations(this._lineNumber),i=[],n=this._laneOrLine==="lineNo";if(!t)return i;for(const o of t){const a=((r=o.options.glyphMargin)==null?void 0:r.position)??ld.Center;if(!n&&a!==this._laneOrLine)continue;const l=n?o.options.lineNumberHoverMessage:o.options.glyphMarginHoverMessage;!l||y1(l)||i.push(...mq(l).map(e))}return i}}var Cet=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},zoe=function(s,e){return function(t,i){e(t,i,s)}},jU;const Uoe=ke;var Hv;let $U=(Hv=class extends te{constructor(e,t,i){super(),this._renderDisposeables=this._register(new ce),this._editor=e,this._isVisible=!1,this._messages=[],this._hover=this._register(new _K),this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible),this._markdownRenderer=this._register(new kg({editor:this._editor},t,i)),this._computer=new wet(this._editor),this._hoverOperation=this._register(new z_e(this._editor,this._computer)),this._register(this._hoverOperation.onResult(n=>{this._withResult(n.value)})),this._register(this._editor.onDidChangeModelDecorations(()=>this._onModelDecorationsChanged())),this._register(this._editor.onDidChangeConfiguration(n=>{n.hasChanged(50)&&this._updateFont()})),this._register(yn(this._hover.containerDomNode,"mouseleave",n=>{this._onMouseLeave(n)})),this._editor.addOverlayWidget(this)}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}getId(){return jU.ID}getDomNode(){return this._hover.containerDomNode}getPosition(){return null}_updateFont(){Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName("code")).forEach(t=>this._editor.applyFontInfo(t))}_onModelDecorationsChanged(){this._isVisible&&(this._hoverOperation.cancel(),this._hoverOperation.start(0))}showsOrWillShow(e){const t=e.target;return t.type===2&&t.detail.glyphMarginLane?(this._startShowingAt(t.position.lineNumber,t.detail.glyphMarginLane),!0):t.type===3?(this._startShowingAt(t.position.lineNumber,"lineNo"),!0):!1}_startShowingAt(e,t){this._computer.lineNumber===e&&this._computer.lane===t||(this._hoverOperation.cancel(),this.hide(),this._computer.lineNumber=e,this._computer.lane=t,this._hoverOperation.start(0))}hide(){this._computer.lineNumber=-1,this._hoverOperation.cancel(),this._isVisible&&(this._isVisible=!1,this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible))}_withResult(e){this._messages=e,this._messages.length>0?this._renderMessages(this._computer.lineNumber,this._messages):this.hide()}_renderMessages(e,t){this._renderDisposeables.clear();const i=document.createDocumentFragment();for(const n of t){const r=Uoe("div.hover-row.markdown-hover"),o=me(r,Uoe("div.hover-contents")),a=this._renderDisposeables.add(this._markdownRenderer.render(n.value));o.appendChild(a.element),i.appendChild(r)}this._updateContents(i),this._showAt(e)}_updateContents(e){this._hover.contentsDomNode.textContent="",this._hover.contentsDomNode.appendChild(e),this._updateFont()}_showAt(e){this._isVisible||(this._isVisible=!0,this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible));const t=this._editor.getLayoutInfo(),i=this._editor.getTopForLineNumber(e),n=this._editor.getScrollTop(),r=this._editor.getOption(67),o=this._hover.containerDomNode.clientHeight,a=i-n-(o-r)/2,l=t.glyphMarginLeft+t.glyphMarginWidth+(this._computer.lane==="lineNo"?t.lineNumbersWidth:0);this._hover.containerDomNode.style.left=`${l}px`,this._hover.containerDomNode.style.top=`${Math.max(Math.round(a),0)}px`}_onMouseLeave(e){const t=this._editor.getDomNode();(!t||!_5(t,e.x,e.y))&&this.hide()}},jU=Hv,Hv.ID="editor.contrib.modesGlyphHoverWidget",Hv);$U=jU=Cet([zoe(1,un),zoe(2,la)],$U);var yet=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},xet=function(s,e){return function(t,i){e(t,i,s)}},$y;let lM=($y=class extends te{constructor(e,t){super(),this._editor=e,this._instantiationService=t,this.shouldKeepOpenOnEditorMouseMoveOrLeave=!1,this._listenersStore=new ce,this._hoverState={mouseDown:!1},this._reactToEditorMouseMoveRunner=this._register(new xi(()=>this._reactToEditorMouseMove(this._mouseMoveEvent),0)),this._hookListeners(),this._register(this._editor.onDidChangeConfiguration(i=>{i.hasChanged(60)&&(this._unhookListeners(),this._hookListeners())}))}_hookListeners(){const e=this._editor.getOption(60);this._hoverSettings={enabled:e.enabled,sticky:e.sticky,hidingDelay:e.hidingDelay},e.enabled?(this._listenersStore.add(this._editor.onMouseDown(t=>this._onEditorMouseDown(t))),this._listenersStore.add(this._editor.onMouseUp(()=>this._onEditorMouseUp())),this._listenersStore.add(this._editor.onMouseMove(t=>this._onEditorMouseMove(t))),this._listenersStore.add(this._editor.onKeyDown(t=>this._onKeyDown(t)))):(this._listenersStore.add(this._editor.onMouseMove(t=>this._onEditorMouseMove(t))),this._listenersStore.add(this._editor.onKeyDown(t=>this._onKeyDown(t)))),this._listenersStore.add(this._editor.onMouseLeave(t=>this._onEditorMouseLeave(t))),this._listenersStore.add(this._editor.onDidChangeModel(()=>{this._cancelScheduler(),this._hideWidgets()})),this._listenersStore.add(this._editor.onDidChangeModelContent(()=>this._cancelScheduler())),this._listenersStore.add(this._editor.onDidScrollChange(t=>this._onEditorScrollChanged(t)))}_unhookListeners(){this._listenersStore.clear()}_cancelScheduler(){this._mouseMoveEvent=void 0,this._reactToEditorMouseMoveRunner.cancel()}_onEditorScrollChanged(e){(e.scrollTopChanged||e.scrollLeftChanged)&&this._hideWidgets()}_onEditorMouseDown(e){this._hoverState.mouseDown=!0,!this._isMouseOnMarginHoverWidget(e)&&this._hideWidgets()}_isMouseOnMarginHoverWidget(e){var i;const t=(i=this._glyphWidget)==null?void 0:i.getDomNode();return t?_5(t,e.event.posx,e.event.posy):!1}_onEditorMouseUp(){this._hoverState.mouseDown=!1}_onEditorMouseLeave(e){this.shouldKeepOpenOnEditorMouseMoveOrLeave||(this._cancelScheduler(),this._isMouseOnMarginHoverWidget(e))||this._hideWidgets()}_shouldNotRecomputeCurrentHoverWidget(e){const t=this._hoverSettings.sticky,i=this._isMouseOnMarginHoverWidget(e);return t&&i}_onEditorMouseMove(e){if(this.shouldKeepOpenOnEditorMouseMoveOrLeave)return;if(this._mouseMoveEvent=e,this._shouldNotRecomputeCurrentHoverWidget(e)){this._reactToEditorMouseMoveRunner.cancel();return}this._reactToEditorMouseMove(e)}_reactToEditorMouseMove(e){!e||this._tryShowHoverWidget(e)||this._hideWidgets()}_tryShowHoverWidget(e){return this._getOrCreateGlyphWidget().showsOrWillShow(e)}_onKeyDown(e){this._editor.hasModel()&&(e.keyCode===5||e.keyCode===6||e.keyCode===57||e.keyCode===4||this._hideWidgets())}_hideWidgets(){var e;(e=this._glyphWidget)==null||e.hide()}_getOrCreateGlyphWidget(){return this._glyphWidget||(this._glyphWidget=this._instantiationService.createInstance($U,this._editor)),this._glyphWidget}dispose(){var e;super.dispose(),this._unhookListeners(),this._listenersStore.dispose(),(e=this._glyphWidget)==null||e.dispose()}},$y.ID="editor.contrib.marginHover",$y);lM=yet([xet(1,Xe)],lM);class Let{}class ket{}class Iet{}Zt(Jr.ID,Jr,2);Zt(lM.ID,lM,2);ye(ret);ye(oet);ye(aet);ye(cet);ye(det);ye(uet);ye(het);ye(fet);ye(get);ye(pet);ye(met);ye(_et);n0.register(oE);n0.register(UU);Lc((s,e)=>{const t=s.getColor(dfe);t&&(e.addRule(`.monaco-editor .monaco-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${t.transparent(.5)}; }`),e.addRule(`.monaco-editor .monaco-hover hr { border-top: 1px solid ${t.transparent(.5)}; }`),e.addRule(`.monaco-editor .monaco-hover hr { border-bottom: 0px solid ${t.transparent(.5)}; }`))});k5.register(new Let);k5.register(new ket);k5.register(new Iet);function Ca(s,e){let t=0;for(let i=0;i<s.length;i++)s.charAt(i)==="	"?t+=e:t++;return t}function lk(s,e,t){s=s<0?0:s;let i="";if(!t){const n=Math.floor(s/e);s=s%e;for(let r=0;r<n;r++)i+="	"}for(let n=0;n<s;n++)i+=" ";return i}function Mbe(s,e,t,i){if(s.getLineCount()===1&&s.getLineMaxColumn(1)===1)return[];const n=e.getLanguageConfiguration(s.getLanguageId()).indentRulesSupport;if(!n)return[];const r=new LG(s,n,e);for(i=Math.min(i,s.getLineCount());t<=i&&r.shouldIgnore(t);)t++;if(t>i-1)return[];const{tabSize:o,indentSize:a,insertSpaces:l}=s.getOptions(),c=(_,v)=>(v=v||1,yc.shiftIndent(_,_.length+v,o,a,l)),d=(_,v)=>(v=v||1,yc.unshiftIndent(_,_.length+v,o,a,l)),u=[],h=s.getLineContent(t);let g=Ti(h),p=g;r.shouldIncrease(t)?(p=c(p),g=c(g)):r.shouldIndentNextLine(t)&&(p=c(p)),t++;for(let _=t;_<=i;_++){if(Eet(s,_))continue;const v=s.getLineContent(_),C=Ti(v),y=p;r.shouldDecrease(_,y)&&(p=d(p),g=d(g)),C!==p&&u.push(gn.replaceMove(new Ue(_,1,_,C.length+1),WK(p,a,l))),!r.shouldIgnore(_)&&(r.shouldIncrease(_,y)?(g=c(g),p=g):r.shouldIndentNextLine(_,y)?p=c(p):p=g)}return u}function Eet(s,e){return s.tokenization.isCheapToTokenize(e)?s.tokenization.getLineTokens(e).getStandardTokenType(0)===2:!1}var Det=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Tet=function(s,e){return function(t,i){e(t,i,s)}};const BO=class BO extends Ve{constructor(){super({id:BO.ID,label:b("indentationToSpaces","Convert Indentation to Spaces"),alias:"Convert Indentation to Spaces",precondition:z.writable,metadata:{description:dt("indentationToSpacesDescription","Convert the tab indentation to spaces.")}})}run(e,t){const i=t.getModel();if(!i)return;const n=i.getOptions(),r=t.getSelection();if(!r)return;const o=new Met(r,n.tabSize);t.pushUndoStop(),t.executeCommands(this.id,[o]),t.pushUndoStop(),i.updateOptions({insertSpaces:!0})}};BO.ID="editor.action.indentationToSpaces";let qU=BO;const WO=class WO extends Ve{constructor(){super({id:WO.ID,label:b("indentationToTabs","Convert Indentation to Tabs"),alias:"Convert Indentation to Tabs",precondition:z.writable,metadata:{description:dt("indentationToTabsDescription","Convert the spaces indentation to tabs.")}})}run(e,t){const i=t.getModel();if(!i)return;const n=i.getOptions(),r=t.getSelection();if(!r)return;const o=new Oet(r,n.tabSize);t.pushUndoStop(),t.executeCommands(this.id,[o]),t.pushUndoStop(),i.updateOptions({insertSpaces:!1})}};WO.ID="editor.action.indentationToTabs";let KU=WO;class BQ extends Ve{constructor(e,t,i){super(i),this.insertSpaces=e,this.displaySizeOnly=t}run(e,t){const i=e.get(kc),n=e.get(Gi),r=t.getModel();if(!r)return;const o=n.getCreationOptions(r.getLanguageId(),r.uri,r.isForSimpleWidget),a=r.getOptions(),l=[1,2,3,4,5,6,7,8].map(d=>({id:d.toString(),label:d.toString(),description:d===o.tabSize&&d===a.tabSize?b("configuredTabSize","Configured Tab Size"):d===o.tabSize?b("defaultTabSize","Default Tab Size"):d===a.tabSize?b("currentTabSize","Current Tab Size"):void 0})),c=Math.min(r.getOptions().tabSize-1,7);setTimeout(()=>{i.pick(l,{placeHolder:b({key:"selectTabWidth",comment:["Tab corresponds to the tab key"]},"Select Tab Size for Current File"),activeItem:l[c]}).then(d=>{if(d&&r&&!r.isDisposed()){const u=parseInt(d.label,10);this.displaySizeOnly?r.updateOptions({tabSize:u}):r.updateOptions({tabSize:u,indentSize:u,insertSpaces:this.insertSpaces})}})},50)}}const HO=class HO extends BQ{constructor(){super(!1,!1,{id:HO.ID,label:b("indentUsingTabs","Indent Using Tabs"),alias:"Indent Using Tabs",precondition:void 0,metadata:{description:dt("indentUsingTabsDescription","Use indentation with tabs.")}})}};HO.ID="editor.action.indentUsingTabs";let GU=HO;const zO=class zO extends BQ{constructor(){super(!0,!1,{id:zO.ID,label:b("indentUsingSpaces","Indent Using Spaces"),alias:"Indent Using Spaces",precondition:void 0,metadata:{description:dt("indentUsingSpacesDescription","Use indentation with spaces.")}})}};zO.ID="editor.action.indentUsingSpaces";let QU=zO;const UO=class UO extends BQ{constructor(){super(!0,!0,{id:UO.ID,label:b("changeTabDisplaySize","Change Tab Display Size"),alias:"Change Tab Display Size",precondition:void 0,metadata:{description:dt("changeTabDisplaySizeDescription","Change the space size equivalent of the tab.")}})}};UO.ID="editor.action.changeTabDisplaySize";let YU=UO;const jO=class jO extends Ve{constructor(){super({id:jO.ID,label:b("detectIndentation","Detect Indentation from Content"),alias:"Detect Indentation from Content",precondition:void 0,metadata:{description:dt("detectIndentationDescription","Detect the indentation from content.")}})}run(e,t){const i=e.get(Gi),n=t.getModel();if(!n)return;const r=i.getCreationOptions(n.getLanguageId(),n.uri,n.isForSimpleWidget);n.detectIndentation(r.insertSpaces,r.tabSize)}};jO.ID="editor.action.detectIndentation";let XU=jO;class Net extends Ve{constructor(){super({id:"editor.action.reindentlines",label:b("editor.reindentlines","Reindent Lines"),alias:"Reindent Lines",precondition:z.writable,metadata:{description:dt("editor.reindentlinesDescription","Reindent the lines of the editor.")}})}run(e,t){const i=e.get(bn),n=t.getModel();if(!n)return;const r=Mbe(n,i,1,n.getLineCount());r.length>0&&(t.pushUndoStop(),t.executeEdits(this.id,r),t.pushUndoStop())}}class Ret extends Ve{constructor(){super({id:"editor.action.reindentselectedlines",label:b("editor.reindentselectedlines","Reindent Selected Lines"),alias:"Reindent Selected Lines",precondition:z.writable,metadata:{description:dt("editor.reindentselectedlinesDescription","Reindent the selected lines of the editor.")}})}run(e,t){const i=e.get(bn),n=t.getModel();if(!n)return;const r=t.getSelections();if(r===null)return;const o=[];for(const a of r){let l=a.startLineNumber,c=a.endLineNumber;if(l!==c&&a.endColumn===1&&c--,l===1){if(l===c)continue}else l--;const d=Mbe(n,i,l,c);o.push(...d)}o.length>0&&(t.pushUndoStop(),t.executeEdits(this.id,o),t.pushUndoStop())}}class Aet{constructor(e,t){this._initialSelection=t,this._edits=[],this._selectionId=null;for(const i of e)i.range&&typeof i.text=="string"&&this._edits.push(i)}getEditOperations(e,t){for(const n of this._edits)t.addEditOperation(F.lift(n.range),n.text);let i=!1;Array.isArray(this._edits)&&this._edits.length===1&&this._initialSelection.isEmpty()&&(this._edits[0].range.startColumn===this._initialSelection.endColumn&&this._edits[0].range.startLineNumber===this._initialSelection.endLineNumber?(i=!0,this._selectionId=t.trackSelection(this._initialSelection,!0)):this._edits[0].range.endColumn===this._initialSelection.startColumn&&this._edits[0].range.endLineNumber===this._initialSelection.startLineNumber&&(i=!0,this._selectionId=t.trackSelection(this._initialSelection,!1))),i||(this._selectionId=t.trackSelection(this._initialSelection))}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}}var qy;let cM=(qy=class{constructor(e,t){this.editor=e,this._languageConfigurationService=t,this.callOnDispose=new ce,this.callOnModel=new ce,this.callOnDispose.add(e.onDidChangeConfiguration(()=>this.update())),this.callOnDispose.add(e.onDidChangeModel(()=>this.update())),this.callOnDispose.add(e.onDidChangeModelLanguage(()=>this.update()))}update(){this.callOnModel.clear(),!(this.editor.getOption(12)<4||this.editor.getOption(55))&&this.editor.hasModel()&&this.callOnModel.add(this.editor.onDidPaste(({range:e})=>{this.trigger(e)}))}trigger(e){const t=this.editor.getSelections();if(t===null||t.length>1)return;const i=this.editor.getModel();if(!i||this.rangeContainsOnlyWhitespaceCharacters(i,e)||Pet(i,e)||!i.tokenization.isCheapToTokenize(e.getStartPosition().lineNumber))return;const r=this.editor.getOption(12),{tabSize:o,indentSize:a,insertSpaces:l}=i.getOptions(),c=[],d={shiftIndent:p=>yc.shiftIndent(p,p.length+1,o,a,l),unshiftIndent:p=>yc.unshiftIndent(p,p.length+1,o,a,l)};let u=e.startLineNumber;for(;u<=e.endLineNumber;){if(this.shouldIgnoreLine(i,u)){u++;continue}break}if(u>e.endLineNumber)return;let h=i.getLineContent(u);if(!/\S/.test(h.substring(0,e.startColumn-1))){const p=QL(r,i,i.getLanguageId(),u,d,this._languageConfigurationService);if(p!==null){const _=Ti(h),v=Ca(p,o),C=Ca(_,o);if(v!==C){const y=lk(v,o,l);c.push({range:new F(u,1,u,_.length+1),text:y}),h=y+h.substring(_.length)}else{const y=Qpe(i,u,this._languageConfigurationService);if(y===0||y===8)return}}}const g=u;for(;u<e.endLineNumber;){if(!/\S/.test(i.getLineContent(u+1))){u++;continue}break}if(u!==e.endLineNumber){const _=QL(r,{tokenization:{getLineTokens:v=>i.tokenization.getLineTokens(v),getLanguageId:()=>i.getLanguageId(),getLanguageIdAtPosition:(v,C)=>i.getLanguageIdAtPosition(v,C)},getLineContent:v=>v===g?h:i.getLineContent(v)},i.getLanguageId(),u+1,d,this._languageConfigurationService);if(_!==null){const v=Ca(_,o),C=Ca(Ti(i.getLineContent(u+1)),o);if(v!==C){const y=v-C;for(let x=u+1;x<=e.endLineNumber;x++){const L=i.getLineContent(x),I=Ti(L),D=Ca(I,o)+y,N=lk(D,o,l);N!==I&&c.push({range:new F(x,1,x,I.length+1),text:N})}}}}if(c.length>0){this.editor.pushUndoStop();const p=new Aet(c,this.editor.getSelection());this.editor.executeCommand("autoIndentOnPaste",p),this.editor.pushUndoStop()}}rangeContainsOnlyWhitespaceCharacters(e,t){const i=r=>r.trim().length===0;let n=!0;if(t.startLineNumber===t.endLineNumber){const o=e.getLineContent(t.startLineNumber).substring(t.startColumn-1,t.endColumn-1);n=i(o)}else for(let r=t.startLineNumber;r<=t.endLineNumber;r++){const o=e.getLineContent(r);if(r===t.startLineNumber){const a=o.substring(t.startColumn-1);n=i(a)}else if(r===t.endLineNumber){const a=o.substring(0,t.endColumn-1);n=i(a)}else n=e.getLineFirstNonWhitespaceColumn(r)===0;if(!n)break}return n}shouldIgnoreLine(e,t){e.tokenization.forceTokenization(t);const i=e.getLineFirstNonWhitespaceColumn(t);if(i===0)return!0;const n=e.tokenization.getLineTokens(t);if(n.getCount()>0){const r=n.findTokenIndexAtOffset(i);if(r>=0&&n.getStandardTokenType(r)===1)return!0}return!1}dispose(){this.callOnDispose.dispose(),this.callOnModel.dispose()}},qy.ID="editor.contrib.autoIndentOnPaste",qy);cM=Det([Tet(1,bn)],cM);function Pet(s,e){const t=i=>Z5e(s,i)===2;return t(e.getStartPosition())||t(e.getEndPosition())}function Obe(s,e,t,i){if(s.getLineCount()===1&&s.getLineMaxColumn(1)===1)return;let n="";for(let o=0;o<t;o++)n+=" ";const r=new RegExp(n,"gi");for(let o=1,a=s.getLineCount();o<=a;o++){let l=s.getLineFirstNonWhitespaceColumn(o);if(l===0&&(l=s.getLineMaxColumn(o)),l===1)continue;const c=new F(o,1,o,l),d=s.getValueInRange(c),u=i?d.replace(/\t/ig,n):d.replace(r,"	");e.addEditOperation(c,u)}}class Met{constructor(e,t){this.selection=e,this.tabSize=t,this.selectionId=null}getEditOperations(e,t){this.selectionId=t.trackSelection(this.selection),Obe(e,t,this.tabSize,!0)}computeCursorState(e,t){return t.getTrackedSelection(this.selectionId)}}class Oet{constructor(e,t){this.selection=e,this.tabSize=t,this.selectionId=null}getEditOperations(e,t){this.selectionId=t.trackSelection(this.selection),Obe(e,t,this.tabSize,!1)}computeCursorState(e,t){return t.getTrackedSelection(this.selectionId)}}Zt(cM.ID,cM,2);ye(qU);ye(KU);ye(GU);ye(QU);ye(YU);ye(XU);ye(Net);ye(Ret);Zt(lE.ID,lE,1);n0.register(HP);class Fet{constructor(e,t,i){this._editRange=e,this._originalSelection=t,this._text=i}getEditOperations(e,t){t.addTrackedEditOperation(this._editRange,this._text)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return this._originalSelection.isEmpty()?new Ue(n.endLineNumber,Math.min(this._originalSelection.positionColumn,n.endColumn),n.endLineNumber,Math.min(this._originalSelection.positionColumn,n.endColumn)):new Ue(n.endLineNumber,n.endColumn-this._text.length,n.endLineNumber,n.endColumn)}}var Vet=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Bet=function(s,e){return function(t,i){e(t,i,s)}},JR,Im;let q1=(Im=class{static get(e){return e.getContribution(JR.ID)}constructor(e,t){this.editor=e,this.editorWorkerService=t,this.decorations=this.editor.createDecorationsCollection()}dispose(){}run(e,t){var l;(l=this.currentRequest)==null||l.cancel();const i=this.editor.getSelection(),n=this.editor.getModel();if(!n||!i)return;let r=i;if(r.startLineNumber!==r.endLineNumber)return;const o=new xme(this.editor,5),a=n.uri;return this.editorWorkerService.canNavigateValueSet(a)?(this.currentRequest=xs(c=>this.editorWorkerService.navigateValueSet(a,r,t)),this.currentRequest.then(c=>{var p;if(!c||!c.range||!c.value||!o.validate(this.editor))return;const d=F.lift(c.range);let u=c.range;const h=c.value.length-(r.endColumn-r.startColumn);u={startLineNumber:u.startLineNumber,startColumn:u.startColumn,endLineNumber:u.endLineNumber,endColumn:u.startColumn+c.value.length},h>1&&(r=new Ue(r.startLineNumber,r.startColumn,r.endLineNumber,r.endColumn+h-1));const g=new Fet(d,r,c.value);this.editor.pushUndoStop(),this.editor.executeCommand(e,g),this.editor.pushUndoStop(),this.decorations.set([{range:u,options:JR.DECORATION}]),(p=this.decorationRemover)==null||p.cancel(),this.decorationRemover=Sg(350),this.decorationRemover.then(()=>this.decorations.clear()).catch(ft)}).catch(ft)):Promise.resolve(void 0)}},JR=Im,Im.ID="editor.contrib.inPlaceReplaceController",Im.DECORATION=_t.register({description:"in-place-replace",className:"valueSetReplacement"}),Im);q1=JR=Vet([Bet(1,ca)],q1);class Wet extends Ve{constructor(){super({id:"editor.action.inPlaceReplace.up",label:b("InPlaceReplaceAction.previous.label","Replace with Previous Value"),alias:"Replace with Previous Value",precondition:z.writable,kbOpts:{kbExpr:z.editorTextFocus,primary:3159,weight:100}})}run(e,t){const i=q1.get(t);return i?i.run(this.id,!1):Promise.resolve(void 0)}}class Het extends Ve{constructor(){super({id:"editor.action.inPlaceReplace.down",label:b("InPlaceReplaceAction.next.label","Replace with Next Value"),alias:"Replace with Next Value",precondition:z.writable,kbOpts:{kbExpr:z.editorTextFocus,primary:3161,weight:100}})}run(e,t){const i=q1.get(t);return i?i.run(this.id,!0):Promise.resolve(void 0)}}Zt(q1.ID,q1,4);ye(Wet);ye(Het);class zet extends Ve{constructor(){super({id:"expandLineSelection",label:b("expandLineSelection","Expand Line Selection"),alias:"Expand Line Selection",precondition:void 0,kbOpts:{weight:0,kbExpr:z.textInputFocus,primary:2090}})}run(e,t,i){if(i=i||{},!t.hasModel())return;const n=t._getViewModel();n.model.pushStackElement(),n.setCursorStates(i.source,3,$s.expandLineSelection(n,n.getCursorStates())),n.revealAllCursors(i.source,!0)}}ye(zet);class Uet{constructor(e,t,i){this._selection=e,this._cursors=t,this._selectionId=null,this._trimInRegexesAndStrings=i}getEditOperations(e,t){const i=jet(e,this._cursors,this._trimInRegexesAndStrings);for(let n=0,r=i.length;n<r;n++){const o=i[n];t.addEditOperation(o.range,o.text)}this._selectionId=t.trackSelection(this._selection)}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}}function jet(s,e,t){e.sort((a,l)=>a.lineNumber===l.lineNumber?a.column-l.column:a.lineNumber-l.lineNumber);for(let a=e.length-2;a>=0;a--)e[a].lineNumber===e[a+1].lineNumber&&e.splice(a,1);const i=[];let n=0,r=0;const o=e.length;for(let a=1,l=s.getLineCount();a<=l;a++){const c=s.getLineContent(a),d=c.length+1;let u=0;if(r<o&&e[r].lineNumber===a&&(u=e[r].column,r++,u===d)||c.length===0)continue;const h=nu(c);let g=0;if(h===-1)g=1;else if(h!==c.length-1)g=h+2;else continue;if(!t){if(!s.tokenization.hasAccurateTokensForLine(a))continue;const p=s.tokenization.getLineTokens(a),_=p.getStandardTokenType(p.findTokenIndexAtOffset(g));if(_===2||_===3)continue}g=Math.max(u,g),i[n++]=gn.delete(new F(a,g,a,d))}return i}class Fbe{constructor(e,t,i){this._selection=e,this._isCopyingDown=t,this._noop=i||!1,this._selectionDirection=0,this._selectionId=null,this._startLineNumberDelta=0,this._endLineNumberDelta=0}getEditOperations(e,t){let i=this._selection;this._startLineNumberDelta=0,this._endLineNumberDelta=0,i.startLineNumber<i.endLineNumber&&i.endColumn===1&&(this._endLineNumberDelta=1,i=i.setEndPosition(i.endLineNumber-1,e.getLineMaxColumn(i.endLineNumber-1)));const n=[];for(let o=i.startLineNumber;o<=i.endLineNumber;o++)n.push(e.getLineContent(o));const r=n.join(`
`);r===""&&this._isCopyingDown&&(this._startLineNumberDelta++,this._endLineNumberDelta++),this._noop?t.addEditOperation(new F(i.endLineNumber,e.getLineMaxColumn(i.endLineNumber),i.endLineNumber+1,1),i.endLineNumber===e.getLineCount()?"":`
`):this._isCopyingDown?t.addEditOperation(new F(i.startLineNumber,1,i.startLineNumber,1),r+`
`):t.addEditOperation(new F(i.endLineNumber,e.getLineMaxColumn(i.endLineNumber),i.endLineNumber,e.getLineMaxColumn(i.endLineNumber)),`
`+r),this._selectionId=t.trackSelection(i),this._selectionDirection=this._selection.getDirection()}computeCursorState(e,t){let i=t.getTrackedSelection(this._selectionId);if(this._startLineNumberDelta!==0||this._endLineNumberDelta!==0){let n=i.startLineNumber,r=i.startColumn,o=i.endLineNumber,a=i.endColumn;this._startLineNumberDelta!==0&&(n=n+this._startLineNumberDelta,r=1),this._endLineNumberDelta!==0&&(o=o+this._endLineNumberDelta,a=1),i=Ue.createWithDirection(n,r,o,a,this._selectionDirection)}return i}}var $et=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},qet=function(s,e){return function(t,i){e(t,i,s)}};let ZU=class{constructor(e,t,i,n){this._languageConfigurationService=n,this._selection=e,this._isMovingDown=t,this._autoIndent=i,this._selectionId=null,this._moveEndLineSelectionShrink=!1}getEditOperations(e,t){const i=()=>e.getLanguageId(),n=(u,h)=>e.getLanguageIdAtPosition(u,h),r=e.getLineCount();if(this._isMovingDown&&this._selection.endLineNumber===r){this._selectionId=t.trackSelection(this._selection);return}if(!this._isMovingDown&&this._selection.startLineNumber===1){this._selectionId=t.trackSelection(this._selection);return}this._moveEndPositionDown=!1;let o=this._selection;o.startLineNumber<o.endLineNumber&&o.endColumn===1&&(this._moveEndPositionDown=!0,o=o.setEndPosition(o.endLineNumber-1,e.getLineMaxColumn(o.endLineNumber-1)));const{tabSize:a,indentSize:l,insertSpaces:c}=e.getOptions(),d=this.buildIndentConverter(a,l,c);if(o.startLineNumber===o.endLineNumber&&e.getLineMaxColumn(o.startLineNumber)===1){const u=o.startLineNumber,h=this._isMovingDown?u+1:u-1;e.getLineMaxColumn(h)===1?t.addEditOperation(new F(1,1,1,1),null):(t.addEditOperation(new F(u,1,u,1),e.getLineContent(h)),t.addEditOperation(new F(h,1,h,e.getLineMaxColumn(h)),null)),o=new Ue(h,1,h,1)}else{let u,h;if(this._isMovingDown){u=o.endLineNumber+1,h=e.getLineContent(u),t.addEditOperation(new F(u-1,e.getLineMaxColumn(u-1),u,e.getLineMaxColumn(u)),null);let g=h;if(this.shouldAutoIndent(e,o)){const p=this.matchEnterRule(e,d,a,u,o.startLineNumber-1);if(p!==null){const v=Ti(e.getLineContent(u)),C=p+Ca(v,a);g=lk(C,a,c)+this.trimStart(h)}else{const v={tokenization:{getLineTokens:y=>y===o.startLineNumber?e.tokenization.getLineTokens(u):e.tokenization.getLineTokens(y),getLanguageId:i,getLanguageIdAtPosition:n},getLineContent:y=>y===o.startLineNumber?e.getLineContent(u):e.getLineContent(y)},C=QL(this._autoIndent,v,e.getLanguageIdAtPosition(u,1),o.startLineNumber,d,this._languageConfigurationService);if(C!==null){const y=Ti(e.getLineContent(u)),x=Ca(C,a),L=Ca(y,a);x!==L&&(g=lk(x,a,c)+this.trimStart(h))}}t.addEditOperation(new F(o.startLineNumber,1,o.startLineNumber,1),g+`
`);const _=this.matchEnterRuleMovingDown(e,d,a,o.startLineNumber,u,g);if(_!==null)_!==0&&this.getIndentEditsOfMovingBlock(e,t,o,a,c,_);else{const v={tokenization:{getLineTokens:y=>y===o.startLineNumber?e.tokenization.getLineTokens(u):y>=o.startLineNumber+1&&y<=o.endLineNumber+1?e.tokenization.getLineTokens(y-1):e.tokenization.getLineTokens(y),getLanguageId:i,getLanguageIdAtPosition:n},getLineContent:y=>y===o.startLineNumber?g:y>=o.startLineNumber+1&&y<=o.endLineNumber+1?e.getLineContent(y-1):e.getLineContent(y)},C=QL(this._autoIndent,v,e.getLanguageIdAtPosition(u,1),o.startLineNumber+1,d,this._languageConfigurationService);if(C!==null){const y=Ti(e.getLineContent(o.startLineNumber)),x=Ca(C,a),L=Ca(y,a);if(x!==L){const I=x-L;this.getIndentEditsOfMovingBlock(e,t,o,a,c,I)}}}}else t.addEditOperation(new F(o.startLineNumber,1,o.startLineNumber,1),g+`
`)}else if(u=o.startLineNumber-1,h=e.getLineContent(u),t.addEditOperation(new F(u,1,u+1,1),null),t.addEditOperation(new F(o.endLineNumber,e.getLineMaxColumn(o.endLineNumber),o.endLineNumber,e.getLineMaxColumn(o.endLineNumber)),`
`+h),this.shouldAutoIndent(e,o)){const g={tokenization:{getLineTokens:_=>_===u?e.tokenization.getLineTokens(o.startLineNumber):e.tokenization.getLineTokens(_),getLanguageId:i,getLanguageIdAtPosition:n},getLineContent:_=>_===u?e.getLineContent(o.startLineNumber):e.getLineContent(_)},p=this.matchEnterRule(e,d,a,o.startLineNumber,o.startLineNumber-2);if(p!==null)p!==0&&this.getIndentEditsOfMovingBlock(e,t,o,a,c,p);else{const _=QL(this._autoIndent,g,e.getLanguageIdAtPosition(o.startLineNumber,1),u,d,this._languageConfigurationService);if(_!==null){const v=Ti(e.getLineContent(o.startLineNumber)),C=Ca(_,a),y=Ca(v,a);if(C!==y){const x=C-y;this.getIndentEditsOfMovingBlock(e,t,o,a,c,x)}}}}}this._selectionId=t.trackSelection(o)}buildIndentConverter(e,t,i){return{shiftIndent:n=>yc.shiftIndent(n,n.length+1,e,t,i),unshiftIndent:n=>yc.unshiftIndent(n,n.length+1,e,t,i)}}parseEnterResult(e,t,i,n,r){if(r){let o=r.indentation;r.indentAction===is.None||r.indentAction===is.Indent?o=r.indentation+r.appendText:r.indentAction===is.IndentOutdent?o=r.indentation:r.indentAction===is.Outdent&&(o=t.unshiftIndent(r.indentation)+r.appendText);const a=e.getLineContent(n);if(this.trimStart(a).indexOf(this.trimStart(o))>=0){const l=Ti(e.getLineContent(n));let c=Ti(o);const d=Qpe(e,n,this._languageConfigurationService);d!==null&&d&2&&(c=t.unshiftIndent(c));const u=Ca(c,i),h=Ca(l,i);return u-h}}return null}matchEnterRuleMovingDown(e,t,i,n,r,o){if(nu(o)>=0){const a=e.getLineMaxColumn(r),l=Ry(this._autoIndent,e,new F(r,a,r,a),this._languageConfigurationService);return this.parseEnterResult(e,t,i,n,l)}else{let a=n-1;for(;a>=1;){const d=e.getLineContent(a);if(nu(d)>=0)break;a--}if(a<1||n>e.getLineCount())return null;const l=e.getLineMaxColumn(a),c=Ry(this._autoIndent,e,new F(a,l,a,l),this._languageConfigurationService);return this.parseEnterResult(e,t,i,n,c)}}matchEnterRule(e,t,i,n,r,o){let a=r;for(;a>=1;){let d;if(a===r&&o!==void 0?d=o:d=e.getLineContent(a),nu(d)>=0)break;a--}if(a<1||n>e.getLineCount())return null;const l=e.getLineMaxColumn(a),c=Ry(this._autoIndent,e,new F(a,l,a,l),this._languageConfigurationService);return this.parseEnterResult(e,t,i,n,c)}trimStart(e){return e.replace(/^\s+/,"")}shouldAutoIndent(e,t){if(this._autoIndent<4||!e.tokenization.isCheapToTokenize(t.startLineNumber))return!1;const i=e.getLanguageIdAtPosition(t.startLineNumber,1),n=e.getLanguageIdAtPosition(t.endLineNumber,1);return!(i!==n||this._languageConfigurationService.getLanguageConfiguration(i).indentRulesSupport===null)}getIndentEditsOfMovingBlock(e,t,i,n,r,o){for(let a=i.startLineNumber;a<=i.endLineNumber;a++){const l=e.getLineContent(a),c=Ti(l),u=Ca(c,n)+o,h=lk(u,n,r);h!==c&&(t.addEditOperation(new F(a,1,a,c.length+1),h),a===i.endLineNumber&&i.endColumn<=c.length+1&&h===""&&(this._moveEndLineSelectionShrink=!0))}}computeCursorState(e,t){let i=t.getTrackedSelection(this._selectionId);return this._moveEndPositionDown&&(i=i.setEndPosition(i.endLineNumber+1,1)),this._moveEndLineSelectionShrink&&i.startLineNumber<i.endLineNumber&&(i=i.setEndPosition(i.endLineNumber,2)),i}};ZU=$et([qet(3,bn)],ZU);const ry=class ry{static getCollator(){return ry._COLLATOR||(ry._COLLATOR=new Intl.Collator),ry._COLLATOR}constructor(e,t){this.selection=e,this.descending=t,this.selectionId=null}getEditOperations(e,t){const i=Ket(e,this.selection,this.descending);i&&t.addEditOperation(i.range,i.text),this.selectionId=t.trackSelection(this.selection)}computeCursorState(e,t){return t.getTrackedSelection(this.selectionId)}static canRun(e,t,i){if(e===null)return!1;const n=Vbe(e,t,i);if(!n)return!1;for(let r=0,o=n.before.length;r<o;r++)if(n.before[r]!==n.after[r])return!0;return!1}};ry._COLLATOR=null;let fE=ry;function Vbe(s,e,t){const i=e.startLineNumber;let n=e.endLineNumber;if(e.endColumn===1&&n--,i>=n)return null;const r=[];for(let a=i;a<=n;a++)r.push(s.getLineContent(a));let o=r.slice(0);return o.sort(fE.getCollator().compare),t===!0&&(o=o.reverse()),{startLineNumber:i,endLineNumber:n,before:r,after:o}}function Ket(s,e,t){const i=Vbe(s,e,t);return i?gn.replace(new F(i.startLineNumber,1,i.endLineNumber,s.getLineMaxColumn(i.endLineNumber)),i.after.join(`
`)):null}class Bbe extends Ve{constructor(e,t){super(t),this.down=e}run(e,t){if(!t.hasModel())return;const i=t.getSelections().map((o,a)=>({selection:o,index:a,ignore:!1}));i.sort((o,a)=>F.compareRangesUsingStarts(o.selection,a.selection));let n=i[0];for(let o=1;o<i.length;o++){const a=i[o];n.selection.endLineNumber===a.selection.startLineNumber&&(n.index<a.index?a.ignore=!0:(n.ignore=!0,n=a))}const r=[];for(const o of i)r.push(new Fbe(o.selection,this.down,o.ignore));t.pushUndoStop(),t.executeCommands(this.id,r),t.pushUndoStop()}}class Get extends Bbe{constructor(){super(!1,{id:"editor.action.copyLinesUpAction",label:b("lines.copyUp","Copy Line Up"),alias:"Copy Line Up",precondition:z.writable,kbOpts:{kbExpr:z.editorTextFocus,primary:1552,linux:{primary:3600},weight:100},menuOpts:{menuId:ze.MenubarSelectionMenu,group:"2_line",title:b({key:"miCopyLinesUp",comment:["&& denotes a mnemonic"]},"&&Copy Line Up"),order:1}})}}class Qet extends Bbe{constructor(){super(!0,{id:"editor.action.copyLinesDownAction",label:b("lines.copyDown","Copy Line Down"),alias:"Copy Line Down",precondition:z.writable,kbOpts:{kbExpr:z.editorTextFocus,primary:1554,linux:{primary:3602},weight:100},menuOpts:{menuId:ze.MenubarSelectionMenu,group:"2_line",title:b({key:"miCopyLinesDown",comment:["&& denotes a mnemonic"]},"Co&&py Line Down"),order:2}})}}class Yet extends Ve{constructor(){super({id:"editor.action.duplicateSelection",label:b("duplicateSelection","Duplicate Selection"),alias:"Duplicate Selection",precondition:z.writable,menuOpts:{menuId:ze.MenubarSelectionMenu,group:"2_line",title:b({key:"miDuplicateSelection",comment:["&& denotes a mnemonic"]},"&&Duplicate Selection"),order:5}})}run(e,t,i){if(!t.hasModel())return;const n=[],r=t.getSelections(),o=t.getModel();for(const a of r)if(a.isEmpty())n.push(new Fbe(a,!0));else{const l=new Ue(a.endLineNumber,a.endColumn,a.endLineNumber,a.endColumn);n.push(new RHe(l,o.getValueInRange(a)))}t.pushUndoStop(),t.executeCommands(this.id,n),t.pushUndoStop()}}class Wbe extends Ve{constructor(e,t){super(t),this.down=e}run(e,t){const i=e.get(bn),n=[],r=t.getSelections()||[],o=t.getOption(12);for(const a of r)n.push(new ZU(a,this.down,o,i));t.pushUndoStop(),t.executeCommands(this.id,n),t.pushUndoStop()}}class Xet extends Wbe{constructor(){super(!1,{id:"editor.action.moveLinesUpAction",label:b("lines.moveUp","Move Line Up"),alias:"Move Line Up",precondition:z.writable,kbOpts:{kbExpr:z.editorTextFocus,primary:528,linux:{primary:528},weight:100},menuOpts:{menuId:ze.MenubarSelectionMenu,group:"2_line",title:b({key:"miMoveLinesUp",comment:["&& denotes a mnemonic"]},"Mo&&ve Line Up"),order:3}})}}class Zet extends Wbe{constructor(){super(!0,{id:"editor.action.moveLinesDownAction",label:b("lines.moveDown","Move Line Down"),alias:"Move Line Down",precondition:z.writable,kbOpts:{kbExpr:z.editorTextFocus,primary:530,linux:{primary:530},weight:100},menuOpts:{menuId:ze.MenubarSelectionMenu,group:"2_line",title:b({key:"miMoveLinesDown",comment:["&& denotes a mnemonic"]},"Move &&Line Down"),order:4}})}}class Hbe extends Ve{constructor(e,t){super(t),this.descending=e}run(e,t){if(!t.hasModel())return;const i=t.getModel();let n=t.getSelections();n.length===1&&n[0].isEmpty()&&(n=[new Ue(1,1,i.getLineCount(),i.getLineMaxColumn(i.getLineCount()))]);for(const o of n)if(!fE.canRun(t.getModel(),o,this.descending))return;const r=[];for(let o=0,a=n.length;o<a;o++)r[o]=new fE(n[o],this.descending);t.pushUndoStop(),t.executeCommands(this.id,r),t.pushUndoStop()}}class Jet extends Hbe{constructor(){super(!1,{id:"editor.action.sortLinesAscending",label:b("lines.sortAscending","Sort Lines Ascending"),alias:"Sort Lines Ascending",precondition:z.writable})}}class ett extends Hbe{constructor(){super(!0,{id:"editor.action.sortLinesDescending",label:b("lines.sortDescending","Sort Lines Descending"),alias:"Sort Lines Descending",precondition:z.writable})}}class ttt extends Ve{constructor(){super({id:"editor.action.removeDuplicateLines",label:b("lines.deleteDuplicates","Delete Duplicate Lines"),alias:"Delete Duplicate Lines",precondition:z.writable})}run(e,t){if(!t.hasModel())return;const i=t.getModel();if(i.getLineCount()===1&&i.getLineMaxColumn(1)===1)return;const n=[],r=[];let o=0,a=!0,l=t.getSelections();l.length===1&&l[0].isEmpty()&&(l=[new Ue(1,1,i.getLineCount(),i.getLineMaxColumn(i.getLineCount()))],a=!1);for(const c of l){const d=new Set,u=[];for(let _=c.startLineNumber;_<=c.endLineNumber;_++){const v=i.getLineContent(_);d.has(v)||(u.push(v),d.add(v))}const h=new Ue(c.startLineNumber,1,c.endLineNumber,i.getLineMaxColumn(c.endLineNumber)),g=c.startLineNumber-o,p=new Ue(g,1,g+u.length-1,u[u.length-1].length);n.push(gn.replace(h,u.join(`
`))),r.push(p),o+=c.endLineNumber-c.startLineNumber+1-u.length}t.pushUndoStop(),t.executeEdits(this.id,n,a?r:void 0),t.pushUndoStop()}}const $O=class $O extends Ve{constructor(){super({id:$O.ID,label:b("lines.trimTrailingWhitespace","Trim Trailing Whitespace"),alias:"Trim Trailing Whitespace",precondition:z.writable,kbOpts:{kbExpr:z.editorTextFocus,primary:ns(2089,2102),weight:100}})}run(e,t,i){let n=[];i.reason==="auto-save"&&(n=(t.getSelections()||[]).map(d=>new X(d.positionLineNumber,d.positionColumn)));const r=t.getSelection();if(r===null)return;const o=e.get(At),a=t.getModel(),l=o.getValue("files.trimTrailingWhitespaceInRegexAndStrings",{overrideIdentifier:a==null?void 0:a.getLanguageId(),resource:a==null?void 0:a.uri}),c=new Uet(r,n,l);t.pushUndoStop(),t.executeCommands(this.id,[c]),t.pushUndoStop()}};$O.ID="editor.action.trimTrailingWhitespace";let JU=$O;class itt extends Ve{constructor(){super({id:"editor.action.deleteLines",label:b("lines.delete","Delete Line"),alias:"Delete Line",precondition:z.writable,kbOpts:{kbExpr:z.textInputFocus,primary:3113,weight:100}})}run(e,t){if(!t.hasModel())return;const i=this._getLinesToRemove(t),n=t.getModel();if(n.getLineCount()===1&&n.getLineMaxColumn(1)===1)return;let r=0;const o=[],a=[];for(let l=0,c=i.length;l<c;l++){const d=i[l];let u=d.startLineNumber,h=d.endLineNumber,g=1,p=n.getLineMaxColumn(h);h<n.getLineCount()?(h+=1,p=1):u>1&&(u-=1,g=n.getLineMaxColumn(u)),o.push(gn.replace(new Ue(u,g,h,p),"")),a.push(new Ue(u-r,d.positionColumn,u-r,d.positionColumn)),r+=d.endLineNumber-d.startLineNumber+1}t.pushUndoStop(),t.executeEdits(this.id,o,a),t.pushUndoStop()}_getLinesToRemove(e){const t=e.getSelections().map(r=>{let o=r.endLineNumber;return r.startLineNumber<r.endLineNumber&&r.endColumn===1&&(o-=1),{startLineNumber:r.startLineNumber,selectionStartColumn:r.selectionStartColumn,endLineNumber:o,positionColumn:r.positionColumn}});t.sort((r,o)=>r.startLineNumber===o.startLineNumber?r.endLineNumber-o.endLineNumber:r.startLineNumber-o.startLineNumber);const i=[];let n=t[0];for(let r=1;r<t.length;r++)n.endLineNumber+1>=t[r].startLineNumber?n.endLineNumber=t[r].endLineNumber:(i.push(n),n=t[r]);return i.push(n),i}}class ntt extends Ve{constructor(){super({id:"editor.action.indentLines",label:b("lines.indent","Indent Line"),alias:"Indent Line",precondition:z.writable,kbOpts:{kbExpr:z.editorTextFocus,primary:2142,weight:100}})}run(e,t){const i=t._getViewModel();i&&(t.pushUndoStop(),t.executeCommands(this.id,Fp.indent(i.cursorConfig,t.getModel(),t.getSelections())),t.pushUndoStop())}}class stt extends Ve{constructor(){super({id:"editor.action.outdentLines",label:b("lines.outdent","Outdent Line"),alias:"Outdent Line",precondition:z.writable,kbOpts:{kbExpr:z.editorTextFocus,primary:2140,weight:100}})}run(e,t){Ay.Outdent.runEditorCommand(e,t,null)}}class rtt extends Ve{constructor(){super({id:"editor.action.insertLineBefore",label:b("lines.insertBefore","Insert Line Above"),alias:"Insert Line Above",precondition:z.writable,kbOpts:{kbExpr:z.editorTextFocus,primary:3075,weight:100}})}run(e,t){const i=t._getViewModel();i&&(t.pushUndoStop(),t.executeCommands(this.id,n5.lineInsertBefore(i.cursorConfig,t.getModel(),t.getSelections())))}}class ott extends Ve{constructor(){super({id:"editor.action.insertLineAfter",label:b("lines.insertAfter","Insert Line Below"),alias:"Insert Line Below",precondition:z.writable,kbOpts:{kbExpr:z.editorTextFocus,primary:2051,weight:100}})}run(e,t){const i=t._getViewModel();i&&(t.pushUndoStop(),t.executeCommands(this.id,n5.lineInsertAfter(i.cursorConfig,t.getModel(),t.getSelections())))}}class zbe extends Ve{run(e,t){if(!t.hasModel())return;const i=t.getSelection(),n=this._getRangesToDelete(t),r=[];for(let l=0,c=n.length-1;l<c;l++){const d=n[l],u=n[l+1];F.intersectRanges(d,u)===null?r.push(d):n[l+1]=F.plusRange(d,u)}r.push(n[n.length-1]);const o=this._getEndCursorState(i,r),a=r.map(l=>gn.replace(l,""));t.pushUndoStop(),t.executeEdits(this.id,a,o),t.pushUndoStop()}}class att extends zbe{constructor(){super({id:"deleteAllLeft",label:b("lines.deleteAllLeft","Delete All Left"),alias:"Delete All Left",precondition:z.writable,kbOpts:{kbExpr:z.textInputFocus,primary:0,mac:{primary:2049},weight:100}})}_getEndCursorState(e,t){let i=null;const n=[];let r=0;return t.forEach(o=>{let a;if(o.endColumn===1&&r>0){const l=o.startLineNumber-r;a=new Ue(l,o.startColumn,l,o.startColumn)}else a=new Ue(o.startLineNumber,o.startColumn,o.startLineNumber,o.startColumn);r+=o.endLineNumber-o.startLineNumber,o.intersectRanges(e)?i=a:n.push(a)}),i&&n.unshift(i),n}_getRangesToDelete(e){const t=e.getSelections();if(t===null)return[];let i=t;const n=e.getModel();return n===null?[]:(i.sort(F.compareRangesUsingStarts),i=i.map(r=>{if(r.isEmpty())if(r.startColumn===1){const o=Math.max(1,r.startLineNumber-1),a=r.startLineNumber===1?1:n.getLineLength(o)+1;return new F(o,a,r.startLineNumber,1)}else return new F(r.startLineNumber,1,r.startLineNumber,r.startColumn);else return new F(r.startLineNumber,1,r.endLineNumber,r.endColumn)}),i)}}class ltt extends zbe{constructor(){super({id:"deleteAllRight",label:b("lines.deleteAllRight","Delete All Right"),alias:"Delete All Right",precondition:z.writable,kbOpts:{kbExpr:z.textInputFocus,primary:0,mac:{primary:297,secondary:[2068]},weight:100}})}_getEndCursorState(e,t){let i=null;const n=[];for(let r=0,o=t.length,a=0;r<o;r++){const l=t[r],c=new Ue(l.startLineNumber-a,l.startColumn,l.startLineNumber-a,l.startColumn);l.intersectRanges(e)?i=c:n.push(c)}return i&&n.unshift(i),n}_getRangesToDelete(e){const t=e.getModel();if(t===null)return[];const i=e.getSelections();if(i===null)return[];const n=i.map(r=>{if(r.isEmpty()){const o=t.getLineMaxColumn(r.startLineNumber);return r.startColumn===o?new F(r.startLineNumber,r.startColumn,r.startLineNumber+1,1):new F(r.startLineNumber,r.startColumn,r.startLineNumber,o)}return r});return n.sort(F.compareRangesUsingStarts),n}}class ctt extends Ve{constructor(){super({id:"editor.action.joinLines",label:b("lines.joinLines","Join Lines"),alias:"Join Lines",precondition:z.writable,kbOpts:{kbExpr:z.editorTextFocus,primary:0,mac:{primary:296},weight:100}})}run(e,t){const i=t.getSelections();if(i===null)return;let n=t.getSelection();if(n===null)return;i.sort(F.compareRangesUsingStarts);const r=[],o=i.reduce((h,g)=>h.isEmpty()?h.endLineNumber===g.startLineNumber?(n.equalsSelection(h)&&(n=g),g):g.startLineNumber>h.endLineNumber+1?(r.push(h),g):new Ue(h.startLineNumber,h.startColumn,g.endLineNumber,g.endColumn):g.startLineNumber>h.endLineNumber?(r.push(h),g):new Ue(h.startLineNumber,h.startColumn,g.endLineNumber,g.endColumn));r.push(o);const a=t.getModel();if(a===null)return;const l=[],c=[];let d=n,u=0;for(let h=0,g=r.length;h<g;h++){const p=r[h],_=p.startLineNumber,v=1;let C=0,y,x;const L=a.getLineLength(p.endLineNumber)-p.endColumn;if(p.isEmpty()||p.startLineNumber===p.endLineNumber){const D=p.getStartPosition();D.lineNumber<a.getLineCount()?(y=_+1,x=a.getLineMaxColumn(y)):(y=D.lineNumber,x=a.getLineMaxColumn(D.lineNumber))}else y=p.endLineNumber,x=a.getLineMaxColumn(y);let I=a.getLineContent(_);for(let D=_+1;D<=y;D++){const N=a.getLineContent(D),R=a.getLineFirstNonWhitespaceColumn(D);if(R>=1){let W=!0;I===""&&(W=!1),W&&(I.charAt(I.length-1)===" "||I.charAt(I.length-1)==="	")&&(W=!1,I=I.replace(/[\s\uFEFF\xA0]+$/g," "));const H=N.substr(R-1);I+=(W?" ":"")+H,W?C=H.length+1:C=H.length}else C=0}const A=new F(_,v,y,x);if(!A.isEmpty()){let D;p.isEmpty()?(l.push(gn.replace(A,I)),D=new Ue(A.startLineNumber-u,I.length-C+1,_-u,I.length-C+1)):p.startLineNumber===p.endLineNumber?(l.push(gn.replace(A,I)),D=new Ue(p.startLineNumber-u,p.startColumn,p.endLineNumber-u,p.endColumn)):(l.push(gn.replace(A,I)),D=new Ue(p.startLineNumber-u,p.startColumn,p.startLineNumber-u,I.length-L)),F.intersectRanges(A,n)!==null?d=D:c.push(D)}u+=A.endLineNumber-A.startLineNumber}c.unshift(d),t.pushUndoStop(),t.executeEdits(this.id,l,c),t.pushUndoStop()}}class dtt extends Ve{constructor(){super({id:"editor.action.transpose",label:b("editor.transpose","Transpose Characters around the Cursor"),alias:"Transpose Characters around the Cursor",precondition:z.writable})}run(e,t){const i=t.getSelections();if(i===null)return;const n=t.getModel();if(n===null)return;const r=[];for(let o=0,a=i.length;o<a;o++){const l=i[o];if(!l.isEmpty())continue;const c=l.getStartPosition(),d=n.getLineMaxColumn(c.lineNumber);if(c.column>=d){if(c.lineNumber===n.getLineCount())continue;const u=new F(c.lineNumber,Math.max(1,c.column-1),c.lineNumber+1,1),h=n.getValueInRange(u).split("").reverse().join("");r.push(new dr(new Ue(c.lineNumber,Math.max(1,c.column-1),c.lineNumber+1,1),h))}else{const u=new F(c.lineNumber,Math.max(1,c.column-1),c.lineNumber,c.column+1),h=n.getValueInRange(u).split("").reverse().join("");r.push(new xG(u,h,new Ue(c.lineNumber,c.column+1,c.lineNumber,c.column+1)))}}t.pushUndoStop(),t.executeCommands(this.id,r),t.pushUndoStop()}}class o0 extends Ve{run(e,t){const i=t.getSelections();if(i===null)return;const n=t.getModel();if(n===null)return;const r=t.getOption(132),o=[];for(const a of i)if(a.isEmpty()){const l=a.getStartPosition(),c=t.getConfiguredWordAtPosition(l);if(!c)continue;const d=new F(l.lineNumber,c.startColumn,l.lineNumber,c.endColumn),u=n.getValueInRange(d);o.push(gn.replace(d,this._modifyText(u,r)))}else{const l=n.getValueInRange(a);o.push(gn.replace(a,this._modifyText(l,r)))}t.pushUndoStop(),t.executeEdits(this.id,o),t.pushUndoStop()}}class utt extends o0{constructor(){super({id:"editor.action.transformToUppercase",label:b("editor.transformToUppercase","Transform to Uppercase"),alias:"Transform to Uppercase",precondition:z.writable})}_modifyText(e,t){return e.toLocaleUpperCase()}}class htt extends o0{constructor(){super({id:"editor.action.transformToLowercase",label:b("editor.transformToLowercase","Transform to Lowercase"),alias:"Transform to Lowercase",precondition:z.writable})}_modifyText(e,t){return e.toLocaleLowerCase()}}class fg{constructor(e,t){this._pattern=e,this._flags=t,this._actual=null,this._evaluated=!1}get(){if(!this._evaluated){this._evaluated=!0;try{this._actual=new RegExp(this._pattern,this._flags)}catch{}}return this._actual}isSupported(){return this.get()!==null}}const qO=class qO extends o0{constructor(){super({id:"editor.action.transformToTitlecase",label:b("editor.transformToTitlecase","Transform to Title Case"),alias:"Transform to Title Case",precondition:z.writable})}_modifyText(e,t){const i=qO.titleBoundary.get();return i?e.toLocaleLowerCase().replace(i,n=>n.toLocaleUpperCase()):e}};qO.titleBoundary=new fg("(^|[^\\p{L}\\p{N}']|((^|\\P{L})'))\\p{L}","gmu");let dM=qO;const oy=class oy extends o0{constructor(){super({id:"editor.action.transformToSnakecase",label:b("editor.transformToSnakecase","Transform to Snake Case"),alias:"Transform to Snake Case",precondition:z.writable})}_modifyText(e,t){const i=oy.caseBoundary.get(),n=oy.singleLetters.get();return!i||!n?e:e.replace(i,"$1_$2").replace(n,"$1_$2$3").toLocaleLowerCase()}};oy.caseBoundary=new fg("(\\p{Ll})(\\p{Lu})","gmu"),oy.singleLetters=new fg("(\\p{Lu}|\\p{N})(\\p{Lu})(\\p{Ll})","gmu");let ck=oy;const KO=class KO extends o0{constructor(){super({id:"editor.action.transformToCamelcase",label:b("editor.transformToCamelcase","Transform to Camel Case"),alias:"Transform to Camel Case",precondition:z.writable})}_modifyText(e,t){const i=KO.wordBoundary.get();if(!i)return e;const n=e.split(i);return n.shift()+n.map(o=>o.substring(0,1).toLocaleUpperCase()+o.substring(1)).join("")}};KO.wordBoundary=new fg("[_\\s-]","gm");let uM=KO;const ay=class ay extends o0{constructor(){super({id:"editor.action.transformToPascalcase",label:b("editor.transformToPascalcase","Transform to Pascal Case"),alias:"Transform to Pascal Case",precondition:z.writable})}_modifyText(e,t){const i=ay.wordBoundary.get(),n=ay.wordBoundaryToMaintain.get();return!i||!n?e:e.split(n).map(a=>a.split(i)).flat().map(a=>a.substring(0,1).toLocaleUpperCase()+a.substring(1)).join("")}};ay.wordBoundary=new fg("[_\\s-]","gm"),ay.wordBoundaryToMaintain=new fg("(?<=\\.)","gm");let hM=ay;const Dp=class Dp extends o0{static isSupported(){return[this.caseBoundary,this.singleLetters,this.underscoreBoundary].every(t=>t.isSupported())}constructor(){super({id:"editor.action.transformToKebabcase",label:b("editor.transformToKebabcase","Transform to Kebab Case"),alias:"Transform to Kebab Case",precondition:z.writable})}_modifyText(e,t){const i=Dp.caseBoundary.get(),n=Dp.singleLetters.get(),r=Dp.underscoreBoundary.get();return!i||!n||!r?e:e.replace(r,"$1-$3").replace(i,"$1-$2").replace(n,"$1-$2").toLocaleLowerCase()}};Dp.caseBoundary=new fg("(\\p{Ll})(\\p{Lu})","gmu"),Dp.singleLetters=new fg("(\\p{Lu}|\\p{N})(\\p{Lu}\\p{Ll})","gmu"),Dp.underscoreBoundary=new fg("(\\S)(_)(\\S)","gm");let fM=Dp;ye(Get);ye(Qet);ye(Yet);ye(Xet);ye(Zet);ye(Jet);ye(ett);ye(ttt);ye(JU);ye(itt);ye(ntt);ye(stt);ye(rtt);ye(ott);ye(att);ye(ltt);ye(ctt);ye(dtt);ye(utt);ye(htt);ck.caseBoundary.isSupported()&&ck.singleLetters.isSupported()&&ye(ck);uM.wordBoundary.isSupported()&&ye(uM);hM.wordBoundary.isSupported()&&ye(hM);dM.titleBoundary.isSupported()&&ye(dM);fM.isSupported()&&ye(fM);var ftt=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},tR=function(s,e){return function(t,i){e(t,i,s)}},e2;const Ube=new Oe("LinkedEditingInputVisible",!1),gtt="linked-editing-decoration";var Em;let K1=(Em=class extends te{static get(e){return e.getContribution(e2.ID)}constructor(e,t,i,n,r){super(),this.languageConfigurationService=n,this._syncRangesToken=0,this._localToDispose=this._register(new ce),this._editor=e,this._providers=i.linkedEditingRangeProvider,this._enabled=!1,this._visibleContextKey=Ube.bindTo(t),this._debounceInformation=r.for(this._providers,"Linked Editing",{max:200}),this._currentDecorations=this._editor.createDecorationsCollection(),this._languageWordPattern=null,this._currentWordPattern=null,this._ignoreChangeEvent=!1,this._localToDispose=this._register(new ce),this._rangeUpdateTriggerPromise=null,this._rangeSyncTriggerPromise=null,this._currentRequestCts=null,this._currentRequestPosition=null,this._currentRequestModelVersion=null,this._register(this._editor.onDidChangeModel(()=>this.reinitialize(!0))),this._register(this._editor.onDidChangeConfiguration(o=>{(o.hasChanged(70)||o.hasChanged(94))&&this.reinitialize(!1)})),this._register(this._providers.onDidChange(()=>this.reinitialize(!1))),this._register(this._editor.onDidChangeModelLanguage(()=>this.reinitialize(!0))),this.reinitialize(!0)}reinitialize(e){const t=this._editor.getModel(),i=t!==null&&(this._editor.getOption(70)||this._editor.getOption(94))&&this._providers.has(t);if(i===this._enabled&&!e||(this._enabled=i,this.clearRanges(),this._localToDispose.clear(),!i||t===null))return;this._localToDispose.add(De.runAndSubscribe(t.onDidChangeLanguageConfiguration,()=>{this._languageWordPattern=this.languageConfigurationService.getLanguageConfiguration(t.getLanguageId()).getWordDefinition()}));const n=new bc(this._debounceInformation.get(t)),r=()=>{this._rangeUpdateTriggerPromise=n.trigger(()=>this.updateRanges(),this._debounceDuration??this._debounceInformation.get(t))},o=new bc(0),a=l=>{this._rangeSyncTriggerPromise=o.trigger(()=>this._syncRanges(l))};this._localToDispose.add(this._editor.onDidChangeCursorPosition(()=>{r()})),this._localToDispose.add(this._editor.onDidChangeModelContent(l=>{if(!this._ignoreChangeEvent&&this._currentDecorations.length>0){const c=this._currentDecorations.getRange(0);if(c&&l.changes.every(d=>c.intersectRanges(d.range))){a(this._syncRangesToken);return}}r()})),this._localToDispose.add({dispose:()=>{n.dispose(),o.dispose()}}),this.updateRanges()}_syncRanges(e){if(!this._editor.hasModel()||e!==this._syncRangesToken||this._currentDecorations.length===0)return;const t=this._editor.getModel(),i=this._currentDecorations.getRange(0);if(!i||i.startLineNumber!==i.endLineNumber)return this.clearRanges();const n=t.getValueInRange(i);if(this._currentWordPattern){const o=n.match(this._currentWordPattern);if((o?o[0].length:0)!==n.length)return this.clearRanges()}const r=[];for(let o=1,a=this._currentDecorations.length;o<a;o++){const l=this._currentDecorations.getRange(o);if(l)if(l.startLineNumber!==l.endLineNumber)r.push({range:l,text:n});else{let c=t.getValueInRange(l),d=n,u=l.startColumn,h=l.endColumn;const g=zm(c,d);u+=g,c=c.substr(g),d=d.substr(g);const p=B2(c,d);h-=p,c=c.substr(0,c.length-p),d=d.substr(0,d.length-p),(u!==h||d.length!==0)&&r.push({range:new F(l.startLineNumber,u,l.endLineNumber,h),text:d})}}if(r.length!==0)try{this._editor.popUndoStop(),this._ignoreChangeEvent=!0;const o=this._editor._getViewModel().getPrevEditOperationType();this._editor.executeEdits("linkedEditing",r),this._editor._getViewModel().setPrevEditOperationType(o)}finally{this._ignoreChangeEvent=!1}}dispose(){this.clearRanges(),super.dispose()}clearRanges(){this._visibleContextKey.set(!1),this._currentDecorations.clear(),this._currentRequestCts&&(this._currentRequestCts.cancel(),this._currentRequestCts=null,this._currentRequestPosition=null)}async updateRanges(e=!1){if(!this._editor.hasModel()){this.clearRanges();return}const t=this._editor.getPosition();if(!this._enabled&&!e||this._editor.getSelections().length>1){this.clearRanges();return}const i=this._editor.getModel(),n=i.getVersionId();if(this._currentRequestPosition&&this._currentRequestModelVersion===n){if(t.equals(this._currentRequestPosition))return;if(this._currentDecorations.length>0){const o=this._currentDecorations.getRange(0);if(o&&o.containsPosition(t))return}}this.clearRanges(),this._currentRequestPosition=t,this._currentRequestModelVersion=n;const r=this._currentRequestCts=new mn;try{const o=new Bs(!1),a=await jbe(this._providers,i,t,r.token);if(this._debounceInformation.update(i,o.elapsed()),r!==this._currentRequestCts||(this._currentRequestCts=null,n!==i.getVersionId()))return;let l=[];a!=null&&a.ranges&&(l=a.ranges),this._currentWordPattern=(a==null?void 0:a.wordPattern)||this._languageWordPattern;let c=!1;for(let u=0,h=l.length;u<h;u++)if(F.containsPosition(l[u],t)){if(c=!0,u!==0){const g=l[u];l.splice(u,1),l.unshift(g)}break}if(!c){this.clearRanges();return}const d=l.map(u=>({range:u,options:e2.DECORATION}));this._visibleContextKey.set(!0),this._currentDecorations.set(d),this._syncRangesToken++}catch(o){xc(o)||ft(o),(this._currentRequestCts===r||!this._currentRequestCts)&&this.clearRanges()}}},e2=Em,Em.ID="editor.contrib.linkedEditing",Em.DECORATION=_t.register({description:"linked-editing",stickiness:0,className:gtt}),Em);K1=e2=ftt([tR(1,ct),tR(2,Be),tR(3,bn),tR(4,Fl)],K1);class ptt extends Ve{constructor(){super({id:"editor.action.linkedEditing",label:b("linkedEditing.label","Start Linked Editing"),alias:"Start Linked Editing",precondition:he.and(z.writable,z.hasRenameProvider),kbOpts:{kbExpr:z.editorTextFocus,primary:3132,weight:100}})}runCommand(e,t){const i=e.get(ni),[n,r]=Array.isArray(t)&&t||[void 0,void 0];return Je.isUri(n)&&X.isIPosition(r)?i.openCodeEditor({resource:n},i.getActiveCodeEditor()).then(o=>{o&&(o.setPosition(r),o.invokeWithinContext(a=>(this.reportTelemetry(a,o),this.run(a,o))))},ft):super.runCommand(e,t)}run(e,t){const i=K1.get(t);return i?Promise.resolve(i.updateRanges(!0)):Promise.resolve()}}const mtt=fs.bindToContribution(K1.get);Me(new mtt({id:"cancelLinkedEditingInput",precondition:Ube,handler:s=>s.clearRanges(),kbOpts:{kbExpr:z.editorTextFocus,weight:199,primary:9,secondary:[1033]}}));function jbe(s,e,t,i){const n=s.ordered(e);return Oq(n.map(r=>async()=>{try{return await r.provideLinkedEditingRanges(e,t,i)}catch(o){Mn(o);return}}),r=>!!r&&Xr(r==null?void 0:r.ranges))}j("editor.linkedEditingBackground",{dark:fe.fromHex("#f00").transparent(.3),light:fe.fromHex("#f00").transparent(.3),hcDark:fe.fromHex("#f00").transparent(.3),hcLight:fe.white},b("editorLinkedEditingBackground","Background color when the editor auto renames on type."));aa("_executeLinkedEditingProvider",(s,e,t)=>{const{linkedEditingRangeProvider:i}=s.get(Be);return jbe(i,e,t,kt.None)});Zt(K1.ID,K1,1);ye(ptt);let _tt=class{constructor(e,t){this._link=e,this._provider=t}toJSON(){return{range:this.range,url:this.url,tooltip:this.tooltip}}get range(){return this._link.range}get url(){return this._link.url}get tooltip(){return this._link.tooltip}async resolve(e){return this._link.url?this._link.url:typeof this._provider.resolveLink=="function"?Promise.resolve(this._provider.resolveLink(this._link,e)).then(t=>(this._link=t||this._link,this._link.url?this.resolve(e):Promise.reject(new Error("missing")))):Promise.reject(new Error("missing"))}};class gM{constructor(e){this._disposables=new ce;let t=[];for(const[i,n]of e){const r=i.links.map(o=>new _tt(o,n));t=gM._union(t,r),Y4(i)&&this._disposables.add(i)}this.links=t}dispose(){this._disposables.dispose(),this.links.length=0}static _union(e,t){const i=[];let n,r,o,a;for(n=0,o=0,r=e.length,a=t.length;n<r&&o<a;){const l=e[n],c=t[o];if(F.areIntersectingOrTouching(l.range,c.range)){n++;continue}F.compareRangesUsingStarts(l.range,c.range)<0?(i.push(l),n++):(i.push(c),o++)}for(;n<r;n++)i.push(e[n]);for(;o<a;o++)i.push(t[o]);return i}}function $be(s,e,t){const i=[],n=s.ordered(e).reverse().map((r,o)=>Promise.resolve(r.provideLinks(e,t)).then(a=>{a&&(i[o]=[a,r])},Mn));return Promise.all(n).then(()=>{const r=new gM(rd(i));return t.isCancellationRequested?(r.dispose(),new gM([])):r})}Gt.registerCommand("_executeLinkProvider",async(s,...e)=>{let[t,i]=e;ii(t instanceof Je),typeof i!="number"&&(i=0);const{linkProvider:n}=s.get(Be),r=s.get(Gi).getModel(t);if(!r)return[];const o=await $be(n,r,kt.None);if(!o)return[];for(let l=0;l<Math.min(i,o.links.length);l++)await o.links[l].resolve(kt.None);const a=o.links.slice(0);return o.dispose(),a});var btt=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},iR=function(s,e){return function(t,i){e(t,i,s)}},ej,zv;let gE=(zv=class extends te{static get(e){return e.getContribution(ej.ID)}constructor(e,t,i,n,r){super(),this.editor=e,this.openerService=t,this.notificationService=i,this.languageFeaturesService=n,this.providers=this.languageFeaturesService.linkProvider,this.debounceInformation=r.for(this.providers,"Links",{min:1e3,max:4e3}),this.computeLinks=this._register(new xi(()=>this.computeLinksNow(),1e3)),this.computePromise=null,this.activeLinksList=null,this.currentOccurrences={},this.activeLinkDecorationId=null;const o=this._register(new b5(e));this._register(o.onMouseMoveOrRelevantKeyDown(([a,l])=>{this._onEditorMouseMove(a,l)})),this._register(o.onExecute(a=>{this.onEditorMouseUp(a)})),this._register(o.onCancel(a=>{this.cleanUpActiveLinkDecoration()})),this._register(e.onDidChangeConfiguration(a=>{a.hasChanged(71)&&(this.updateDecorations([]),this.stop(),this.computeLinks.schedule(0))})),this._register(e.onDidChangeModelContent(a=>{this.editor.hasModel()&&this.computeLinks.schedule(this.debounceInformation.get(this.editor.getModel()))})),this._register(e.onDidChangeModel(a=>{this.currentOccurrences={},this.activeLinkDecorationId=null,this.stop(),this.computeLinks.schedule(0)})),this._register(e.onDidChangeModelLanguage(a=>{this.stop(),this.computeLinks.schedule(0)})),this._register(this.providers.onDidChange(a=>{this.stop(),this.computeLinks.schedule(0)})),this.computeLinks.schedule(0)}async computeLinksNow(){if(!this.editor.hasModel()||!this.editor.getOption(71))return;const e=this.editor.getModel();if(!e.isTooLargeForSyncing()&&this.providers.has(e)){this.activeLinksList&&(this.activeLinksList.dispose(),this.activeLinksList=null),this.computePromise=xs(t=>$be(this.providers,e,t));try{const t=new Bs(!1);if(this.activeLinksList=await this.computePromise,this.debounceInformation.update(e,t.elapsed()),e.isDisposed())return;this.updateDecorations(this.activeLinksList.links)}catch(t){ft(t)}finally{this.computePromise=null}}}updateDecorations(e){const t=this.editor.getOption(78)==="altKey",i=[],n=Object.keys(this.currentOccurrences);for(const o of n){const a=this.currentOccurrences[o];i.push(a.decorationId)}const r=[];if(e)for(const o of e)r.push(Fy.decoration(o,t));this.editor.changeDecorations(o=>{const a=o.deltaDecorations(i,r);this.currentOccurrences={},this.activeLinkDecorationId=null;for(let l=0,c=a.length;l<c;l++){const d=new Fy(e[l],a[l]);this.currentOccurrences[d.decorationId]=d}})}_onEditorMouseMove(e,t){const i=this.editor.getOption(78)==="altKey";if(this.isEnabled(e,t)){this.cleanUpActiveLinkDecoration();const n=this.getLinkOccurrence(e.target.position);n&&this.editor.changeDecorations(r=>{n.activate(r,i),this.activeLinkDecorationId=n.decorationId})}else this.cleanUpActiveLinkDecoration()}cleanUpActiveLinkDecoration(){const e=this.editor.getOption(78)==="altKey";if(this.activeLinkDecorationId){const t=this.currentOccurrences[this.activeLinkDecorationId];t&&this.editor.changeDecorations(i=>{t.deactivate(i,e)}),this.activeLinkDecorationId=null}}onEditorMouseUp(e){if(!this.isEnabled(e))return;const t=this.getLinkOccurrence(e.target.position);t&&this.openLinkOccurrence(t,e.hasSideBySideModifier,!0)}openLinkOccurrence(e,t,i=!1){if(!this.openerService)return;const{link:n}=e;n.resolve(kt.None).then(r=>{if(typeof r=="string"&&this.editor.hasModel()){const o=this.editor.getModel().uri;if(o.scheme===gt.file&&r.startsWith(`${gt.file}:`)){const a=Je.parse(r);if(a.scheme===gt.file){const l=$u(a);let c=null;l.startsWith("/./")||l.startsWith("\\.\\")?c=`.${l.substr(1)}`:(l.startsWith("//./")||l.startsWith("\\\\.\\"))&&(c=`.${l.substr(2)}`),c&&(r=b5e(o,c))}}}return this.openerService.open(r,{openToSide:t,fromUserGesture:i,allowContributedOpeners:!0,allowCommands:!0,fromWorkspace:!0})},r=>{const o=r instanceof Error?r.message:r;o==="invalid"?this.notificationService.warn(b("invalid.url","Failed to open this link because it is not well-formed: {0}",n.url.toString())):o==="missing"?this.notificationService.warn(b("missing.url","Failed to open this link because its target is missing.")):ft(r)})}getLinkOccurrence(e){if(!this.editor.hasModel()||!e)return null;const t=this.editor.getModel().getDecorationsInRange({startLineNumber:e.lineNumber,startColumn:e.column,endLineNumber:e.lineNumber,endColumn:e.column},0,!0);for(const i of t){const n=this.currentOccurrences[i.id];if(n)return n}return null}isEnabled(e,t){return!!(e.target.type===6&&(e.hasTriggerModifier||t&&t.keyCodeIsTriggerKey))}stop(){var e;this.computeLinks.cancel(),this.activeLinksList&&((e=this.activeLinksList)==null||e.dispose(),this.activeLinksList=null),this.computePromise&&(this.computePromise.cancel(),this.computePromise=null)}dispose(){super.dispose(),this.stop()}},ej=zv,zv.ID="editor.linkDetector",zv);gE=ej=btt([iR(1,la),iR(2,jn),iR(3,Be),iR(4,Fl)],gE);const joe={general:_t.register({description:"detected-link",stickiness:1,collapseOnReplaceEdit:!0,inlineClassName:"detected-link"}),active:_t.register({description:"detected-link-active",stickiness:1,collapseOnReplaceEdit:!0,inlineClassName:"detected-link-active"})};class Fy{static decoration(e,t){return{range:e.range,options:Fy._getOptions(e,t,!1)}}static _getOptions(e,t,i){const n={...i?joe.active:joe.general};return n.hoverMessage=vtt(e,t),n}constructor(e,t){this.link=e,this.decorationId=t}activate(e,t){e.changeDecorationOptions(this.decorationId,Fy._getOptions(this.link,t,!0))}deactivate(e,t){e.changeDecorationOptions(this.decorationId,Fy._getOptions(this.link,t,!1))}}function vtt(s,e){const t=s.url&&/^command:/i.test(s.url.toString()),i=s.tooltip?s.tooltip:t?b("links.navigate.executeCmd","Execute command"):b("links.navigate.follow","Follow link"),n=e?Wt?b("links.navigate.kb.meta.mac","cmd + click"):b("links.navigate.kb.meta","ctrl + click"):Wt?b("links.navigate.kb.alt.mac","option + click"):b("links.navigate.kb.alt","alt + click");if(s.url){let r="";if(/^command:/i.test(s.url.toString())){const a=s.url.toString().match(/^command:([^?#]+)/);if(a){const l=a[1];r=b("tooltip.explanation","Execute command {0}",l)}}return new Lr("",!0).appendLink(s.url.toString(!0).replace(/ /g,"%20"),i,r).appendMarkdown(` (${n})`)}else return new Lr().appendText(`${i} (${n})`)}class wtt extends Ve{constructor(){super({id:"editor.action.openLink",label:b("label","Open Link"),alias:"Open Link",precondition:void 0})}run(e,t){const i=gE.get(t);if(!i||!t.hasModel())return;const n=t.getSelections();for(const r of n){const o=i.getLinkOccurrence(r.getEndPosition());o&&i.openLinkOccurrence(o,!1)}}}Zt(gE.ID,gE,1);ye(wtt);const cY=class cY extends te{constructor(e){super(),this._editor=e,this._register(this._editor.onMouseDown(t=>{const i=this._editor.getOption(118);i>=0&&t.target.type===6&&t.target.position.column>=i&&this._editor.updateOptions({stopRenderingLineAfter:-1})}))}};cY.ID="editor.contrib.longLinesHelper";let pM=cY;Zt(pM.ID,pM,2);const Ctt=j("editor.wordHighlightBackground",{dark:"#575757B8",light:"#57575740",hcDark:null,hcLight:null},b("wordHighlight","Background color of a symbol during read-access, like reading a variable. The color must not be opaque so as not to hide underlying decorations."),!0);j("editor.wordHighlightStrongBackground",{dark:"#004972B8",light:"#0e639c40",hcDark:null,hcLight:null},b("wordHighlightStrong","Background color of a symbol during write-access, like writing to a variable. The color must not be opaque so as not to hide underlying decorations."),!0);j("editor.wordHighlightTextBackground",Ctt,b("wordHighlightText","Background color of a textual occurrence for a symbol. The color must not be opaque so as not to hide underlying decorations."),!0);const ytt=j("editor.wordHighlightBorder",{light:null,dark:null,hcDark:tn,hcLight:tn},b("wordHighlightBorder","Border color of a symbol during read-access, like reading a variable."));j("editor.wordHighlightStrongBorder",{light:null,dark:null,hcDark:tn,hcLight:tn},b("wordHighlightStrongBorder","Border color of a symbol during write-access, like writing to a variable."));j("editor.wordHighlightTextBorder",ytt,b("wordHighlightTextBorder","Border color of a textual occurrence for a symbol."));const Stt=j("editorOverviewRuler.wordHighlightForeground","#A0A0A0CC",b("overviewRulerWordHighlightForeground","Overview ruler marker color for symbol highlights. The color must not be opaque so as not to hide underlying decorations."),!0),xtt=j("editorOverviewRuler.wordHighlightStrongForeground","#C0A0C0CC",b("overviewRulerWordHighlightStrongForeground","Overview ruler marker color for write-access symbol highlights. The color must not be opaque so as not to hide underlying decorations."),!0),Ltt=j("editorOverviewRuler.wordHighlightTextForeground",ffe,b("overviewRulerWordHighlightTextForeground","Overview ruler marker color of a textual occurrence for a symbol. The color must not be opaque so as not to hide underlying decorations."),!0),ktt=_t.register({description:"word-highlight-strong",stickiness:1,className:"wordHighlightStrong",overviewRuler:{color:kn(xtt),position:Il.Center},minimap:{color:kn(LF),position:1}}),Itt=_t.register({description:"word-highlight-text",stickiness:1,className:"wordHighlightText",overviewRuler:{color:kn(Ltt),position:Il.Center},minimap:{color:kn(LF),position:1}}),Ett=_t.register({description:"selection-highlight-overview",stickiness:1,className:"selectionHighlight",overviewRuler:{color:kn(ffe),position:Il.Center},minimap:{color:kn(LF),position:1}}),Dtt=_t.register({description:"selection-highlight",stickiness:1,className:"selectionHighlight"}),Ttt=_t.register({description:"word-highlight",stickiness:1,className:"wordHighlight",overviewRuler:{color:kn(Stt),position:Il.Center},minimap:{color:kn(LF),position:1}});function Ntt(s){return s===u1.Write?ktt:s===u1.Text?Itt:Ttt}function Rtt(s){return s?Dtt:Ett}Lc((s,e)=>{const t=s.getColor(cK);t&&e.addRule(`.monaco-editor .selectionHighlight { background-color: ${t.transparent(.5)}; }`)});var Att=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Ptt=function(s,e){return function(t,i){e(t,i,s)}},tj;function C_(s,e){const t=e.filter(i=>!s.find(n=>n.equals(i)));if(t.length>=1){const i=t.map(r=>`line ${r.viewState.position.lineNumber} column ${r.viewState.position.column}`).join(", "),n=t.length===1?b("cursorAdded","Cursor added: {0}",i):b("cursorsAdded","Cursors added: {0}",i);Mh(n)}}class Mtt extends Ve{constructor(){super({id:"editor.action.insertCursorAbove",label:b("mutlicursor.insertAbove","Add Cursor Above"),alias:"Add Cursor Above",precondition:void 0,kbOpts:{kbExpr:z.editorTextFocus,primary:2576,linux:{primary:1552,secondary:[3088]},weight:100},menuOpts:{menuId:ze.MenubarSelectionMenu,group:"3_multi",title:b({key:"miInsertCursorAbove",comment:["&& denotes a mnemonic"]},"&&Add Cursor Above"),order:2}})}run(e,t,i){if(!t.hasModel())return;let n=!0;i&&i.logicalLine===!1&&(n=!1);const r=t._getViewModel();if(r.cursorConfig.readOnly)return;r.model.pushStackElement();const o=r.getCursorStates();r.setCursorStates(i.source,3,$s.addCursorUp(r,o,n)),r.revealTopMostCursor(i.source),C_(o,r.getCursorStates())}}class Ott extends Ve{constructor(){super({id:"editor.action.insertCursorBelow",label:b("mutlicursor.insertBelow","Add Cursor Below"),alias:"Add Cursor Below",precondition:void 0,kbOpts:{kbExpr:z.editorTextFocus,primary:2578,linux:{primary:1554,secondary:[3090]},weight:100},menuOpts:{menuId:ze.MenubarSelectionMenu,group:"3_multi",title:b({key:"miInsertCursorBelow",comment:["&& denotes a mnemonic"]},"A&&dd Cursor Below"),order:3}})}run(e,t,i){if(!t.hasModel())return;let n=!0;i&&i.logicalLine===!1&&(n=!1);const r=t._getViewModel();if(r.cursorConfig.readOnly)return;r.model.pushStackElement();const o=r.getCursorStates();r.setCursorStates(i.source,3,$s.addCursorDown(r,o,n)),r.revealBottomMostCursor(i.source),C_(o,r.getCursorStates())}}class Ftt extends Ve{constructor(){super({id:"editor.action.insertCursorAtEndOfEachLineSelected",label:b("mutlicursor.insertAtEndOfEachLineSelected","Add Cursors to Line Ends"),alias:"Add Cursors to Line Ends",precondition:void 0,kbOpts:{kbExpr:z.editorTextFocus,primary:1575,weight:100},menuOpts:{menuId:ze.MenubarSelectionMenu,group:"3_multi",title:b({key:"miInsertCursorAtEndOfEachLineSelected",comment:["&& denotes a mnemonic"]},"Add C&&ursors to Line Ends"),order:4}})}getCursorsForSelection(e,t,i){if(!e.isEmpty()){for(let n=e.startLineNumber;n<e.endLineNumber;n++){const r=t.getLineMaxColumn(n);i.push(new Ue(n,r,n,r))}e.endColumn>1&&i.push(new Ue(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn))}}run(e,t){if(!t.hasModel())return;const i=t.getModel(),n=t.getSelections(),r=t._getViewModel(),o=r.getCursorStates(),a=[];n.forEach(l=>this.getCursorsForSelection(l,i,a)),a.length>0&&t.setSelections(a),C_(o,r.getCursorStates())}}class Vtt extends Ve{constructor(){super({id:"editor.action.addCursorsToBottom",label:b("mutlicursor.addCursorsToBottom","Add Cursors To Bottom"),alias:"Add Cursors To Bottom",precondition:void 0})}run(e,t){if(!t.hasModel())return;const i=t.getSelections(),n=t.getModel().getLineCount(),r=[];for(let l=i[0].startLineNumber;l<=n;l++)r.push(new Ue(l,i[0].startColumn,l,i[0].endColumn));const o=t._getViewModel(),a=o.getCursorStates();r.length>0&&t.setSelections(r),C_(a,o.getCursorStates())}}class Btt extends Ve{constructor(){super({id:"editor.action.addCursorsToTop",label:b("mutlicursor.addCursorsToTop","Add Cursors To Top"),alias:"Add Cursors To Top",precondition:void 0})}run(e,t){if(!t.hasModel())return;const i=t.getSelections(),n=[];for(let a=i[0].startLineNumber;a>=1;a--)n.push(new Ue(a,i[0].startColumn,a,i[0].endColumn));const r=t._getViewModel(),o=r.getCursorStates();n.length>0&&t.setSelections(n),C_(o,r.getCursorStates())}}class nR{constructor(e,t,i){this.selections=e,this.revealRange=t,this.revealScrollType=i}}class pE{static create(e,t){if(!e.hasModel())return null;const i=t.getState();if(!e.hasTextFocus()&&i.isRevealed&&i.searchString.length>0)return new pE(e,t,!1,i.searchString,i.wholeWord,i.matchCase,null);let n=!1,r,o;const a=e.getSelections();a.length===1&&a[0].isEmpty()?(n=!0,r=!0,o=!0):(r=i.wholeWord,o=i.matchCase);const l=e.getSelection();let c,d=null;if(l.isEmpty()){const u=e.getConfiguredWordAtPosition(l.getStartPosition());if(!u)return null;c=u.word,d=new Ue(l.startLineNumber,u.startColumn,l.startLineNumber,u.endColumn)}else c=e.getModel().getValueInRange(l).replace(/\r\n/g,`
`);return new pE(e,t,n,c,r,o,d)}constructor(e,t,i,n,r,o,a){this._editor=e,this.findController=t,this.isDisconnectedFromFindController=i,this.searchText=n,this.wholeWord=r,this.matchCase=o,this.currentMatch=a}addSelectionToNextFindMatch(){if(!this._editor.hasModel())return null;const e=this._getNextMatch();if(!e)return null;const t=this._editor.getSelections();return new nR(t.concat(e),e,0)}moveSelectionToNextFindMatch(){if(!this._editor.hasModel())return null;const e=this._getNextMatch();if(!e)return null;const t=this._editor.getSelections();return new nR(t.slice(0,t.length-1).concat(e),e,0)}_getNextMatch(){if(!this._editor.hasModel())return null;if(this.currentMatch){const n=this.currentMatch;return this.currentMatch=null,n}this.findController.highlightFindOptions();const e=this._editor.getSelections(),t=e[e.length-1],i=this._editor.getModel().findNextMatch(this.searchText,t.getEndPosition(),!1,this.matchCase,this.wholeWord?this._editor.getOption(132):null,!1);return i?new Ue(i.range.startLineNumber,i.range.startColumn,i.range.endLineNumber,i.range.endColumn):null}addSelectionToPreviousFindMatch(){if(!this._editor.hasModel())return null;const e=this._getPreviousMatch();if(!e)return null;const t=this._editor.getSelections();return new nR(t.concat(e),e,0)}moveSelectionToPreviousFindMatch(){if(!this._editor.hasModel())return null;const e=this._getPreviousMatch();if(!e)return null;const t=this._editor.getSelections();return new nR(t.slice(0,t.length-1).concat(e),e,0)}_getPreviousMatch(){if(!this._editor.hasModel())return null;if(this.currentMatch){const n=this.currentMatch;return this.currentMatch=null,n}this.findController.highlightFindOptions();const e=this._editor.getSelections(),t=e[e.length-1],i=this._editor.getModel().findPreviousMatch(this.searchText,t.getStartPosition(),!1,this.matchCase,this.wholeWord?this._editor.getOption(132):null,!1);return i?new Ue(i.range.startLineNumber,i.range.startColumn,i.range.endLineNumber,i.range.endColumn):null}selectAll(e){if(!this._editor.hasModel())return[];this.findController.highlightFindOptions();const t=this._editor.getModel();return e?t.findMatches(this.searchText,e,!1,this.matchCase,this.wholeWord?this._editor.getOption(132):null,!1,1073741824):t.findMatches(this.searchText,!0,!1,this.matchCase,this.wholeWord?this._editor.getOption(132):null,!1,1073741824)}}const GO=class GO extends te{static get(e){return e.getContribution(GO.ID)}constructor(e){super(),this._sessionDispose=this._register(new ce),this._editor=e,this._ignoreSelectionChange=!1,this._session=null}dispose(){this._endSession(),super.dispose()}_beginSessionIfNeeded(e){if(!this._session){const t=pE.create(this._editor,e);if(!t)return;this._session=t;const i={searchString:this._session.searchText};this._session.isDisconnectedFromFindController&&(i.wholeWordOverride=1,i.matchCaseOverride=1,i.isRegexOverride=2),e.getState().change(i,!1),this._sessionDispose.add(this._editor.onDidChangeCursorSelection(n=>{this._ignoreSelectionChange||this._endSession()})),this._sessionDispose.add(this._editor.onDidBlurEditorText(()=>{this._endSession()})),this._sessionDispose.add(e.getState().onFindReplaceStateChange(n=>{(n.matchCase||n.wholeWord)&&this._endSession()}))}}_endSession(){if(this._sessionDispose.clear(),this._session&&this._session.isDisconnectedFromFindController){const e={wholeWordOverride:0,matchCaseOverride:0,isRegexOverride:0};this._session.findController.getState().change(e,!1)}this._session=null}_setSelections(e){this._ignoreSelectionChange=!0,this._editor.setSelections(e),this._ignoreSelectionChange=!1}_expandEmptyToWord(e,t){if(!t.isEmpty())return t;const i=this._editor.getConfiguredWordAtPosition(t.getStartPosition());return i?new Ue(t.startLineNumber,i.startColumn,t.startLineNumber,i.endColumn):t}_applySessionResult(e){e&&(this._setSelections(e.selections),e.revealRange&&this._editor.revealRangeInCenterIfOutsideViewport(e.revealRange,e.revealScrollType))}getSession(e){return this._session}addSelectionToNextFindMatch(e){if(this._editor.hasModel()){if(!this._session){const t=this._editor.getSelections();if(t.length>1){const n=e.getState().matchCase;if(!qbe(this._editor.getModel(),t,n)){const o=this._editor.getModel(),a=[];for(let l=0,c=t.length;l<c;l++)a[l]=this._expandEmptyToWord(o,t[l]);this._editor.setSelections(a);return}}}this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.addSelectionToNextFindMatch())}}addSelectionToPreviousFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.addSelectionToPreviousFindMatch())}moveSelectionToNextFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.moveSelectionToNextFindMatch())}moveSelectionToPreviousFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.moveSelectionToPreviousFindMatch())}selectAll(e){if(!this._editor.hasModel())return;let t=null;const i=e.getState();if(i.isRevealed&&i.searchString.length>0&&i.isRegex){const n=this._editor.getModel();i.searchScope?t=n.findMatches(i.searchString,i.searchScope,i.isRegex,i.matchCase,i.wholeWord?this._editor.getOption(132):null,!1,1073741824):t=n.findMatches(i.searchString,!0,i.isRegex,i.matchCase,i.wholeWord?this._editor.getOption(132):null,!1,1073741824)}else{if(this._beginSessionIfNeeded(e),!this._session)return;t=this._session.selectAll(i.searchScope)}if(t.length>0){const n=this._editor.getSelection();for(let r=0,o=t.length;r<o;r++){const a=t[r];if(a.range.intersectRanges(n)){t[r]=t[0],t[0]=a;break}}this._setSelections(t.map(r=>new Ue(r.range.startLineNumber,r.range.startColumn,r.range.endLineNumber,r.range.endColumn)))}}};GO.ID="editor.contrib.multiCursorController";let G1=GO;class RS extends Ve{run(e,t){const i=G1.get(t);if(!i)return;const n=t._getViewModel();if(n){const r=n.getCursorStates(),o=ra.get(t);if(o)this._run(i,o);else{const a=e.get(Xe).createInstance(ra,t);this._run(i,a),a.dispose()}C_(r,n.getCursorStates())}}}class Wtt extends RS{constructor(){super({id:"editor.action.addSelectionToNextFindMatch",label:b("addSelectionToNextFindMatch","Add Selection To Next Find Match"),alias:"Add Selection To Next Find Match",precondition:void 0,kbOpts:{kbExpr:z.focus,primary:2082,weight:100},menuOpts:{menuId:ze.MenubarSelectionMenu,group:"3_multi",title:b({key:"miAddSelectionToNextFindMatch",comment:["&& denotes a mnemonic"]},"Add &&Next Occurrence"),order:5}})}_run(e,t){e.addSelectionToNextFindMatch(t)}}class Htt extends RS{constructor(){super({id:"editor.action.addSelectionToPreviousFindMatch",label:b("addSelectionToPreviousFindMatch","Add Selection To Previous Find Match"),alias:"Add Selection To Previous Find Match",precondition:void 0,menuOpts:{menuId:ze.MenubarSelectionMenu,group:"3_multi",title:b({key:"miAddSelectionToPreviousFindMatch",comment:["&& denotes a mnemonic"]},"Add P&&revious Occurrence"),order:6}})}_run(e,t){e.addSelectionToPreviousFindMatch(t)}}class ztt extends RS{constructor(){super({id:"editor.action.moveSelectionToNextFindMatch",label:b("moveSelectionToNextFindMatch","Move Last Selection To Next Find Match"),alias:"Move Last Selection To Next Find Match",precondition:void 0,kbOpts:{kbExpr:z.focus,primary:ns(2089,2082),weight:100}})}_run(e,t){e.moveSelectionToNextFindMatch(t)}}class Utt extends RS{constructor(){super({id:"editor.action.moveSelectionToPreviousFindMatch",label:b("moveSelectionToPreviousFindMatch","Move Last Selection To Previous Find Match"),alias:"Move Last Selection To Previous Find Match",precondition:void 0})}_run(e,t){e.moveSelectionToPreviousFindMatch(t)}}class jtt extends RS{constructor(){super({id:"editor.action.selectHighlights",label:b("selectAllOccurrencesOfFindMatch","Select All Occurrences of Find Match"),alias:"Select All Occurrences of Find Match",precondition:void 0,kbOpts:{kbExpr:z.focus,primary:3114,weight:100},menuOpts:{menuId:ze.MenubarSelectionMenu,group:"3_multi",title:b({key:"miSelectHighlights",comment:["&& denotes a mnemonic"]},"Select All &&Occurrences"),order:7}})}_run(e,t){e.selectAll(t)}}class $tt extends RS{constructor(){super({id:"editor.action.changeAll",label:b("changeAll.label","Change All Occurrences"),alias:"Change All Occurrences",precondition:he.and(z.writable,z.editorTextFocus),kbOpts:{kbExpr:z.editorTextFocus,primary:2108,weight:100},contextMenuOpts:{group:"1_modification",order:1.2}})}_run(e,t){e.selectAll(t)}}class qtt{constructor(e,t,i,n,r){this._model=e,this._searchText=t,this._matchCase=i,this._wordSeparators=n,this._modelVersionId=this._model.getVersionId(),this._cachedFindMatches=null,r&&this._model===r._model&&this._searchText===r._searchText&&this._matchCase===r._matchCase&&this._wordSeparators===r._wordSeparators&&this._modelVersionId===r._modelVersionId&&(this._cachedFindMatches=r._cachedFindMatches)}findMatches(){return this._cachedFindMatches===null&&(this._cachedFindMatches=this._model.findMatches(this._searchText,!0,!1,this._matchCase,this._wordSeparators,!1).map(e=>e.range),this._cachedFindMatches.sort(F.compareRangesUsingStarts)),this._cachedFindMatches}}var Uv;let mM=(Uv=class extends te{constructor(e,t){super(),this._languageFeaturesService=t,this.editor=e,this._isEnabled=e.getOption(109),this._decorations=e.createDecorationsCollection(),this.updateSoon=this._register(new xi(()=>this._update(),300)),this.state=null,this._register(e.onDidChangeConfiguration(n=>{this._isEnabled=e.getOption(109)})),this._register(e.onDidChangeCursorSelection(n=>{this._isEnabled&&(n.selection.isEmpty()?n.reason===3?(this.state&&this._setState(null),this.updateSoon.schedule()):this._setState(null):this._update())})),this._register(e.onDidChangeModel(n=>{this._setState(null)})),this._register(e.onDidChangeModelContent(n=>{this._isEnabled&&this.updateSoon.schedule()}));const i=ra.get(e);i&&this._register(i.getState().onFindReplaceStateChange(n=>{this._update()})),this.updateSoon.schedule()}_update(){this._setState(tj._createState(this.state,this._isEnabled,this.editor))}static _createState(e,t,i){if(!t||!i.hasModel())return null;const n=i.getSelection();if(n.startLineNumber!==n.endLineNumber)return null;const r=G1.get(i);if(!r)return null;const o=ra.get(i);if(!o)return null;let a=r.getSession(o);if(!a){const d=i.getSelections();if(d.length>1){const h=o.getState().matchCase;if(!qbe(i.getModel(),d,h))return null}a=pE.create(i,o)}if(!a||a.currentMatch||/^[ \t]+$/.test(a.searchText)||a.searchText.length>200)return null;const l=o.getState(),c=l.matchCase;if(l.isRevealed){let d=l.searchString;c||(d=d.toLowerCase());let u=a.searchText;if(c||(u=u.toLowerCase()),d===u&&a.matchCase===l.matchCase&&a.wholeWord===l.wholeWord&&!l.isRegex)return null}return new qtt(i.getModel(),a.searchText,a.matchCase,a.wholeWord?i.getOption(132):null,e)}_setState(e){if(this.state=e,!this.state){this._decorations.clear();return}if(!this.editor.hasModel())return;const t=this.editor.getModel();if(t.isTooLargeForTokenization())return;const i=this.state.findMatches(),n=this.editor.getSelections();n.sort(F.compareRangesUsingStarts);const r=[];for(let c=0,d=0,u=i.length,h=n.length;c<u;){const g=i[c];if(d>=h)r.push(g),c++;else{const p=F.compareRangesUsingStarts(g,n[d]);p<0?((n[d].isEmpty()||!F.areIntersecting(g,n[d]))&&r.push(g),c++):(p>0||c++,d++)}}const o=this.editor.getOption(81)!=="off",a=this._languageFeaturesService.documentHighlightProvider.has(t)&&o,l=r.map(c=>({range:c,options:Rtt(a)}));this._decorations.set(l)}dispose(){this._setState(null),super.dispose()}},tj=Uv,Uv.ID="editor.contrib.selectionHighlighter",Uv);mM=tj=Att([Ptt(1,Be)],mM);function qbe(s,e,t){const i=$oe(s,e[0],!t);for(let n=1,r=e.length;n<r;n++){const o=e[n];if(o.isEmpty())return!1;const a=$oe(s,o,!t);if(i!==a)return!1}return!0}function $oe(s,e,t){const i=s.getValueInRange(e);return t?i.toLowerCase():i}class Ktt extends Ve{constructor(){super({id:"editor.action.focusNextCursor",label:b("mutlicursor.focusNextCursor","Focus Next Cursor"),metadata:{description:b("mutlicursor.focusNextCursor.description","Focuses the next cursor"),args:[]},alias:"Focus Next Cursor",precondition:void 0})}run(e,t,i){if(!t.hasModel())return;const n=t._getViewModel();if(n.cursorConfig.readOnly)return;n.model.pushStackElement();const r=Array.from(n.getCursorStates()),o=r.shift();o&&(r.push(o),n.setCursorStates(i.source,3,r),n.revealPrimaryCursor(i.source,!0),C_(r,n.getCursorStates()))}}class Gtt extends Ve{constructor(){super({id:"editor.action.focusPreviousCursor",label:b("mutlicursor.focusPreviousCursor","Focus Previous Cursor"),metadata:{description:b("mutlicursor.focusPreviousCursor.description","Focuses the previous cursor"),args:[]},alias:"Focus Previous Cursor",precondition:void 0})}run(e,t,i){if(!t.hasModel())return;const n=t._getViewModel();if(n.cursorConfig.readOnly)return;n.model.pushStackElement();const r=Array.from(n.getCursorStates()),o=r.pop();o&&(r.unshift(o),n.setCursorStates(i.source,3,r),n.revealPrimaryCursor(i.source,!0),C_(r,n.getCursorStates()))}}Zt(G1.ID,G1,4);Zt(mM.ID,mM,1);ye(Mtt);ye(Ott);ye(Ftt);ye(Wtt);ye(Htt);ye(ztt);ye(Utt);ye(jtt);ye($tt);ye(Vtt);ye(Btt);ye(Ktt);ye(Gtt);const Qtt="editor.action.inlineEdit.accept",Ytt="editor.action.inlineEdit.reject",Xtt="editor.action.inlineEdit.jumpTo",Ztt="editor.action.inlineEdit.jumpBack";var Jtt=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},eit=function(s,e){return function(t,i){e(t,i,s)}};const HB="inline-edit";let ij=class extends te{constructor(e,t,i){super(),this.editor=e,this.model=t,this.languageService=i,this.isDisposed=Rt(this,!1),this.currentTextModel=wi(this,this.editor.onDidChangeModel,()=>this.editor.getModel()),this.uiState=qe(this,n=>{var y;if(this.isDisposed.read(n))return;const r=this.currentTextModel.read(n);if(r!==this.model.targetTextModel.read(n))return;const o=this.model.ghostText.read(n);if(!o)return;let a=(y=this.model.range)==null?void 0:y.read(n);a&&a.startLineNumber===a.endLineNumber&&a.startColumn===a.endColumn&&(a=void 0);const l=(a?a.startLineNumber===a.endLineNumber:!0)&&o.parts.length===1&&o.parts[0].lines.length===1,c=o.parts.length===1&&o.parts[0].lines.every(x=>x.length===0),d=[],u=[];function h(x,L){if(u.length>0){const I=u[u.length-1];L&&I.decorations.push(new vo(I.content.length+1,I.content.length+1+x[0].length,L,0)),I.content+=x[0],x=x.slice(1)}for(const I of x)u.push({content:I,decorations:L?[new vo(1,I.length+1,L,0)]:[]})}const g=r.getLineContent(o.lineNumber);let p,_=0;if(!c&&(l||!a)){for(const x of o.parts){let L=x.lines;a&&!l&&(h(L,HB),L=[]),p===void 0?(d.push({column:x.column,text:L[0],preview:x.preview}),L=L.slice(1)):h([g.substring(_,x.column-1)],void 0),L.length>0&&(h(L,HB),p===void 0&&x.column<=g.length&&(p=x.column)),_=x.column-1}p!==void 0&&h([g.substring(_)],void 0)}const v=p!==void 0?new Ibe(p,g.length+1):void 0,C=l||!a?o.lineNumber:a.endLineNumber-1;return{inlineTexts:d,additionalLines:u,hiddenRange:v,lineNumber:C,additionalReservedLineCount:this.model.minReservedLineCount.read(n),targetTextModel:r,range:a,isSingleLine:l,isPureRemove:c}}),this.decorations=qe(this,n=>{const r=this.uiState.read(n);if(!r)return[];const o=[];if(r.hiddenRange&&o.push({range:r.hiddenRange.toRange(r.lineNumber),options:{inlineClassName:"inline-edit-hidden",description:"inline-edit-hidden"}}),r.range){const a=[];if(r.isSingleLine)a.push(r.range);else if(!r.isPureRemove){const l=r.range.endLineNumber-r.range.startLineNumber;for(let c=0;c<l;c++){const d=r.range.startLineNumber+c,u=r.targetTextModel.getLineFirstNonWhitespaceColumn(d),h=r.targetTextModel.getLineLastNonWhitespaceColumn(d),g=new F(d,u,d,h);a.push(g)}}for(const l of a)o.push({range:l,options:P1})}if(r.range&&!r.isSingleLine&&r.isPureRemove){const a=new F(r.range.startLineNumber,1,r.range.endLineNumber-1,1);o.push({range:a,options:qI})}for(const a of r.inlineTexts)o.push({range:F.fromPositions(new X(r.lineNumber,a.column)),options:{description:HB,after:{content:a.text,inlineClassName:a.preview?"inline-edit-decoration-preview":"inline-edit-decoration",cursorStops:Zc.Left},showIfCollapsed:!0}});return o}),this._register(Ye(()=>{this.isDisposed.set(!0,void 0)})),this._register(Ebe(this.editor,this.decorations))}};ij=Jtt([eit(2,un)],ij);var WQ=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},ah=function(s,e){return function(t,i){e(t,i,s)}},t2;let nj=class extends te{constructor(e,t,i){super(),this.editor=e,this.model=t,this.instantiationService=i,this.alwaysShowToolbar=wi(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(63).showToolbar==="always"),this.sessionPosition=void 0,this.position=qe(this,n=>{var l,c;const r=(l=this.model.read(n))==null?void 0:l.model.ghostText.read(n);if(!this.alwaysShowToolbar.read(n)||!r||r.parts.length===0)return this.sessionPosition=void 0,null;const o=r.parts[0].column;this.sessionPosition&&this.sessionPosition.lineNumber!==r.lineNumber&&(this.sessionPosition=void 0);const a=new X(r.lineNumber,Math.min(o,((c=this.sessionPosition)==null?void 0:c.column)??Number.MAX_SAFE_INTEGER));return this.sessionPosition=a,a}),this._register(Jo((n,r)=>{if(!this.model.read(n)||!this.alwaysShowToolbar.read(n))return;const a=r.add(this.instantiationService.createInstance(sj,this.editor,!0,this.position));e.addContentWidget(a),r.add(Ye(()=>e.removeContentWidget(a)))}))}};nj=WQ([ah(2,Xe)],nj);var Dm;let sj=(Dm=class extends te{constructor(e,t,i,n,r,o){super(),this.editor=e,this.withBorder=t,this._position=i,this._contextKeyService=r,this._menuService=o,this.id=`InlineEditHintsContentWidget${t2.id++}`,this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this.nodes=Vt("div.inlineEditHints",{className:this.withBorder?".withBorder":""},[Vt("div@toolBar")]),this.inlineCompletionsActionsMenus=this._register(this._menuService.createMenu(ze.InlineEditActions,this._contextKeyService)),this.toolBar=this._register(n.createInstance(rj,this.nodes.toolBar,this.editor,ze.InlineEditToolbar,{menuOptions:{renderShortTitle:!0},toolbarOptions:{primaryGroup:a=>a.startsWith("primary")},actionViewItemProvider:(a,l)=>{if(a instanceof Ra)return n.createInstance(tit,a,void 0)},telemetrySource:"InlineEditToolbar"})),this._register(this.toolBar.onDidChangeDropdownVisibility(a=>{t2._dropDownVisible=a})),this._register(ht(a=>{this._position.read(a),this.editor.layoutContentWidget(this)})),this._register(ht(a=>{const l=[];for(const[c,d]of this.inlineCompletionsActionsMenus.getActions())for(const u of d)u instanceof Ra&&l.push(u);l.length>0&&l.unshift(new ks),this.toolBar.setAdditionalSecondaryActions(l)}))}getId(){return this.id}getDomNode(){return this.nodes.root}getPosition(){return{position:this._position.get(),preference:[1,2],positionAffinity:3}}},t2=Dm,Dm._dropDownVisible=!1,Dm.id=0,Dm);sj=t2=WQ([ah(3,Xe),ah(4,ct),ah(5,Ol)],sj);class tit extends Ym{updateLabel(){const e=this._keybindingService.lookupKeybinding(this._action.id,this._contextKeyService);if(!e)return super.updateLabel();if(this.label){const t=Vt("div.keybinding").root;this._register(new SS(t,Da,{disableTitle:!0,...wpe})).set(e),this.label.textContent=this._action.label,this.label.appendChild(t),this.label.classList.add("inlineEditStatusBarItemLabel")}}updateTooltip(){}}let rj=class extends GI{constructor(e,t,i,n,r,o,a,l,c,d){super(e,{resetMenu:i,...n},r,o,a,l,c,d),this.editor=t,this.menuId=i,this.options2=n,this.menuService=r,this.contextKeyService=o,this.menu=this._store.add(this.menuService.createMenu(this.menuId,this.contextKeyService,{emitEventsForSubmenuChanges:!0})),this.additionalActions=[],this.prependedPrimaryActions=[],this._store.add(this.menu.onDidChange(()=>this.updateToolbar())),this._store.add(this.editor.onDidChangeCursorPosition(()=>this.updateToolbar())),this.updateToolbar()}updateToolbar(){var i,n,r,o,a,l,c;const e=[],t=[];zF(this.menu,(i=this.options2)==null?void 0:i.menuOptions,{primary:e,secondary:t},(r=(n=this.options2)==null?void 0:n.toolbarOptions)==null?void 0:r.primaryGroup,(a=(o=this.options2)==null?void 0:o.toolbarOptions)==null?void 0:a.shouldInlineSubmenu,(c=(l=this.options2)==null?void 0:l.toolbarOptions)==null?void 0:c.useSeparatorsInPrimaryActions),t.push(...this.additionalActions),e.unshift(...this.prependedPrimaryActions),this.setActions(e,t)}setAdditionalSecondaryActions(e){dn(this.additionalActions,e,(t,i)=>t===i)||(this.additionalActions=e,this.updateToolbar())}};rj=WQ([ah(4,Ol),ah(5,ct),ah(6,Ba),ah(7,pi),ah(8,Hi),ah(9,Tr)],rj);var Kbe=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},i2=function(s,e){return function(t,i){e(t,i,s)}},pL,oj;function*iit(s,e,t=1){e===void 0&&([e,s]=[s,0]);for(let i=s;i<e;i+=t)yield i}function zB(s){var i;const e=((i=s[0].match(/^\s*/))==null?void 0:i[0])??"",t=e.length;return{text:s.map(n=>n.replace(new RegExp("^"+e),"")),shift:t}}var jv;let aj=(jv=class extends te{static _createUniqueUri(){return Je.from({scheme:"inline-edit-widget",path:new Date().toString()+String(pL._modelId++)})}constructor(e,t,i,n,r){super(),this._editor=e,this._model=t,this._instantiationService=i,this._diffProviderFactoryService=n,this._modelService=r,this._position=qe(this,o=>{const a=this._model.read(o);if(!a||a.text.length===0||a.range.startLineNumber===a.range.endLineNumber&&!(a.range.startColumn===a.range.endColumn&&a.range.startColumn===1))return null;const l=this._editor.getModel();if(!l)return null;const c=Array.from(iit(a.range.startLineNumber,a.range.endLineNumber+1)),d=c.map(_=>l.getLineLastNonWhitespaceColumn(_)),u=Math.max(...d),h=c[d.indexOf(u)],g=new X(h,u);return{top:a.range.startLineNumber,left:g}}),this._text=qe(this,o=>{const a=this._model.read(o);if(!a)return{text:"",shift:0};const l=zB(a.text.split(`
`));return{text:l.text.join(`
`),shift:l.shift}}),this._originalModel=Kr(()=>this._modelService.createModel("",null,pL._createUniqueUri())).keepObserved(this._store),this._modifiedModel=Kr(()=>this._modelService.createModel("",null,pL._createUniqueUri())).keepObserved(this._store),this._diff=qe(this,o=>{var a,l;return(l=(a=this._diffPromise.read(o))==null?void 0:a.promiseResult.read(o))==null?void 0:l.data}),this._diffPromise=qe(this,o=>{const a=this._model.read(o);if(!a)return;const l=this._editor.getModel();if(!l)return;const c=zB(l.getValueInRange(a.range).split(`
`)).text.join(`
`),d=zB(a.text.split(`
`)).text.join(`
`);this._originalModel.get().setValue(c),this._modifiedModel.get().setValue(d);const u=this._diffProviderFactoryService.createDiffProvider({diffAlgorithm:"advanced"});return BF.fromFn(async()=>{const h=await u.computeDiff(this._originalModel.get(),this._modifiedModel.get(),{computeMoves:!1,ignoreTrimWhitespace:!1,maxComputationTimeMs:1e3},kt.None);if(!h.identical)return h.changes})}),this._register(Jo((o,a)=>{if(!this._model.read(o)||this._position.get()===null)return;const c=a.add(this._instantiationService.createInstance(lj,this._editor,this._position,this._text.map(d=>d.text),this._text.map(d=>d.shift),this._diff));e.addOverlayWidget(c),a.add(Ye(()=>e.removeOverlayWidget(c)))}))}},pL=jv,jv._modelId=0,jv);aj=pL=Kbe([i2(2,Xe),i2(3,hD),i2(4,Gi)],aj);var $v;let lj=($v=class extends te{constructor(e,t,i,n,r,o){var a;super(),this._editor=e,this._position=t,this._text=i,this._shift=n,this._diff=r,this._instantiationService=o,this.id=`InlineEditSideBySideContentWidget${oj.id++}`,this.allowEditorOverflow=!1,this._nodes=ke("div.inlineEditSideBySide",void 0),this._scrollChanged=cr("editor.onDidScrollChange",this._editor.onDidScrollChange),this._previewEditor=this._register(this._instantiationService.createInstance(hd,this._nodes,{glyphMargin:!1,lineNumbers:"off",minimap:{enabled:!1},guides:{indentation:!1,bracketPairs:!1,bracketPairsHorizontal:!1,highlightActiveIndentation:!1},folding:!1,selectOnLineNumbers:!1,selectionHighlight:!1,columnSelection:!1,overviewRulerBorder:!1,overviewRulerLanes:0,lineDecorationsWidth:0,lineNumbersMinChars:0,scrollbar:{vertical:"hidden",horizontal:"hidden",alwaysConsumeMouseWheel:!1,handleMouseWheel:!1},readOnly:!0,wordWrap:"off",wordWrapOverride1:"off",wordWrapOverride2:"off",wrappingIndent:"none",wrappingStrategy:void 0},{contributions:[],isSimpleWidget:!0},this._editor)),this._previewEditorObs=Ea(this._previewEditor),this._editorObs=Ea(this._editor),this._previewTextModel=this._register(this._instantiationService.createInstance(Jd,"",((a=this._editor.getModel())==null?void 0:a.getLanguageId())??So,Jd.DEFAULT_CREATION_OPTIONS,null)),this._setText=qe(l=>{const c=this._text.read(l);c&&this._previewTextModel.setValue(c)}).recomputeInitiallyAndOnChange(this._store),this._decorations=qe(this,l=>{this._setText.read(l);const c=this._position.read(l);if(!c)return{org:[],mod:[]};const d=this._diff.read(l);if(!d)return{org:[],mod:[]};const u=[],h=[];if(d.length===1&&d[0].innerChanges[0].modifiedRange.equalsRange(this._previewTextModel.getFullModelRange()))return{org:[],mod:[]};const g=this._shift.get(),p=_=>new F(_.startLineNumber+c.top-1,_.startColumn+g,_.endLineNumber+c.top-1,_.endColumn+g);for(const _ of d)if(_.original.isEmpty||u.push({range:p(_.original.toInclusiveRange()),options:qI}),_.modified.isEmpty||h.push({range:_.modified.toInclusiveRange(),options:wP}),_.modified.isEmpty||_.original.isEmpty)_.original.isEmpty||u.push({range:p(_.original.toInclusiveRange()),options:qG}),_.modified.isEmpty||h.push({range:_.modified.toInclusiveRange(),options:jG});else for(const v of _.innerChanges||[])_.original.contains(v.originalRange.startLineNumber)&&u.push({range:p(v.originalRange),options:v.originalRange.isEmpty()?KG:P1}),_.modified.contains(v.modifiedRange.startLineNumber)&&h.push({range:v.modifiedRange,options:v.modifiedRange.isEmpty()?$G:CP});return{org:u,mod:h}}),this._originalDecorations=qe(this,l=>this._decorations.read(l).org),this._modifiedDecorations=qe(this,l=>this._decorations.read(l).mod),this._previewEditor.setModel(this._previewTextModel),this._register(this._editorObs.setDecorations(this._originalDecorations)),this._register(this._previewEditorObs.setDecorations(this._modifiedDecorations)),this._register(ht(l=>{const c=this._previewEditorObs.contentWidth.read(l),d=this._text.read(l).split(`
`).length-1,u=this._editor.getOption(67)*d;c<=0||this._previewEditor.layout({height:u,width:c})})),this._register(ht(l=>{this._position.read(l),this._editor.layoutOverlayWidget(this)})),this._register(ht(l=>{this._scrollChanged.read(l),this._position.read(l)&&this._editor.layoutOverlayWidget(this)}))}getId(){return this.id}getDomNode(){return this._nodes}getPosition(){const e=this._position.get();if(!e)return null;const t=this._editor.getLayoutInfo(),i=this._editor.getScrolledVisiblePosition(new X(e.top,1));if(!i)return null;const n=i.top-1,r=this._editor.getOffsetForColumn(e.left.lineNumber,e.left.column);return{preference:{left:t.contentLeft+r+10,top:n}}}},oj=$v,$v.id=0,$v);lj=oj=Kbe([i2(5,Xe)],lj);var nit=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},tb=function(s,e){return function(t,i){e(t,i,s)}},mL,ic;let wo=(ic=class extends te{static get(e){return e.getContribution(mL.ID)}constructor(e,t,i,n,r,o,a,l){super(),this.editor=e,this.instantiationService=t,this.contextKeyService=i,this.languageFeaturesService=n,this._commandService=r,this._configurationService=o,this._diffProviderFactoryService=a,this._modelService=l,this._isVisibleContext=mL.inlineEditVisibleContext.bindTo(this.contextKeyService),this._isCursorAtInlineEditContext=mL.cursorAtInlineEditContext.bindTo(this.contextKeyService),this._currentEdit=Rt(this,void 0),this._currentWidget=Kr(this._currentEdit,p=>{const _=this._currentEdit.read(p);if(!_)return;const v=_.range.endLineNumber,C=_.range.endColumn,y=_.text.endsWith(`
`)&&!(_.range.startLineNumber===_.range.endLineNumber&&_.range.startColumn===_.range.endColumn)?_.text.slice(0,-1):_.text,x=new cE(v,[new QP(C,y,!1)]),L=_.range.startLineNumber===_.range.endLineNumber&&x.parts.length===1&&x.parts[0].lines.length===1,I=_.text==="";return!L&&!I?void 0:this.instantiationService.createInstance(ij,this.editor,{ghostText:hc(x),minReservedLineCount:hc(0),targetTextModel:hc(this.editor.getModel()??void 0),range:hc(_.range)})}),this._isAccepting=Rt(this,!1),this._enabled=wi(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(63).enabled),this._fontFamily=wi(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(63).fontFamily);const c=cr("InlineEditController.modelContentChangedSignal",e.onDidChangeModelContent);this._register(ht(p=>{this._enabled.read(p)&&(c.read(p),!this._isAccepting.read(p)&&this.getInlineEdit(e,!0))}));const d=wi(this,e.onDidChangeCursorPosition,()=>e.getPosition());this._register(ht(p=>{if(!this._enabled.read(p))return;const _=d.read(p);_&&this.checkCursorPosition(_)})),this._register(ht(p=>{const _=this._currentEdit.read(p);if(this._isCursorAtInlineEditContext.set(!1),!_){this._isVisibleContext.set(!1);return}this._isVisibleContext.set(!0);const v=e.getPosition();v&&this.checkCursorPosition(v)}));const u=cr("InlineEditController.editorBlurSignal",e.onDidBlurEditorWidget);this._register(ht(async p=>{var _;this._enabled.read(p)&&(u.read(p),!(this._configurationService.getValue("editor.experimentalInlineEdit.keepOnBlur")||e.getOption(63).keepOnBlur)&&((_=this._currentRequestCts)==null||_.dispose(!0),this._currentRequestCts=void 0,await this.clear(!1)))}));const h=cr("InlineEditController.editorFocusSignal",e.onDidFocusEditorText);this._register(ht(p=>{this._enabled.read(p)&&(h.read(p),this.getInlineEdit(e,!0))}));const g=this._register(ihe());this._register(ht(p=>{const _=this._fontFamily.read(p);g.setStyle(_===""||_==="default"?"":`
.monaco-editor .inline-edit-decoration,
.monaco-editor .inline-edit-decoration-preview,
.monaco-editor .inline-edit {
	font-family: ${_};
}`)})),this._register(new nj(this.editor,this._currentWidget,this.instantiationService)),this._register(new aj(this.editor,this._currentEdit,this.instantiationService,this._diffProviderFactoryService,this._modelService))}checkCursorPosition(e){if(!this._currentEdit){this._isCursorAtInlineEditContext.set(!1);return}const t=this._currentEdit.get();if(!t){this._isCursorAtInlineEditContext.set(!1);return}this._isCursorAtInlineEditContext.set(F.containsPosition(t.range,e))}validateInlineEdit(e,t){var i;if(t.text.includes(`
`)&&t.range.startLineNumber!==t.range.endLineNumber&&t.range.startColumn!==t.range.endColumn){if(t.range.startColumn!==1)return!1;const r=t.range.endLineNumber,o=t.range.endColumn,a=((i=e.getModel())==null?void 0:i.getLineLength(r))??0;if(o!==a+1)return!1}return!0}async fetchInlineEdit(e,t){this._currentRequestCts&&this._currentRequestCts.dispose(!0);const i=e.getModel();if(!i)return;const n=i.getVersionId(),r=this.languageFeaturesService.inlineEditProvider.all(i);if(r.length===0)return;const o=r[0];this._currentRequestCts=new mn;const a=this._currentRequestCts.token,l=t?V2.Automatic:V2.Invoke;if(t&&await sit(50,a),a.isCancellationRequested||i.isDisposed()||i.getVersionId()!==n)return;const d=await o.provideInlineEdit(i,{triggerKind:l},a);if(d&&!(a.isCancellationRequested||i.isDisposed()||i.getVersionId()!==n)&&this.validateInlineEdit(e,d))return d}async getInlineEdit(e,t){this._isCursorAtInlineEditContext.set(!1),await this.clear();const i=await this.fetchInlineEdit(e,t);i&&this._currentEdit.set(i,void 0)}async trigger(){await this.getInlineEdit(this.editor,!1)}async jumpBack(){this._jumpBackPosition&&(this.editor.setPosition(this._jumpBackPosition),this.editor.revealPositionInCenterIfOutsideViewport(this._jumpBackPosition))}async accept(){this._isAccepting.set(!0,void 0);const e=this._currentEdit.get();if(!e)return;let t=e.text;e.text.startsWith(`
`)&&(t=e.text.substring(1)),this.editor.pushUndoStop(),this.editor.executeEdits("acceptCurrent",[gn.replace(F.lift(e.range),t)]),e.accepted&&await this._commandService.executeCommand(e.accepted.id,...e.accepted.arguments||[]).then(void 0,Mn),this.freeEdit(e),pn(i=>{this._currentEdit.set(void 0,i),this._isAccepting.set(!1,i)})}jumpToCurrent(){var i;this._jumpBackPosition=(i=this.editor.getSelection())==null?void 0:i.getStartPosition();const e=this._currentEdit.get();if(!e)return;const t=X.lift({lineNumber:e.range.startLineNumber,column:e.range.startColumn});this.editor.setPosition(t),this.editor.revealPositionInCenterIfOutsideViewport(t)}async clear(e=!0){const t=this._currentEdit.get();t&&(t!=null&&t.rejected)&&e&&await this._commandService.executeCommand(t.rejected.id,...t.rejected.arguments||[]).then(void 0,Mn),t&&this.freeEdit(t),this._currentEdit.set(void 0,void 0)}freeEdit(e){const t=this.editor.getModel();if(!t)return;const i=this.languageFeaturesService.inlineEditProvider.all(t);i.length!==0&&i[0].freeInlineEdit(e)}},mL=ic,ic.ID="editor.contrib.inlineEditController",ic.inlineEditVisibleKey="inlineEditVisible",ic.inlineEditVisibleContext=new Oe(ic.inlineEditVisibleKey,!1),ic.cursorAtInlineEditKey="cursorAtInlineEdit",ic.cursorAtInlineEditContext=new Oe(ic.cursorAtInlineEditKey,!1),ic);wo=mL=nit([tb(1,Xe),tb(2,ct),tb(3,Be),tb(4,Hi),tb(5,At),tb(6,hD),tb(7,Gi)],wo);function sit(s,e){return new Promise(t=>{let i;const n=setTimeout(()=>{i&&i.dispose(),t()},s);e&&(i=e.onCancellationRequested(()=>{clearTimeout(n),i&&i.dispose(),t()}))})}let rit=class extends Ve{constructor(){super({id:Qtt,label:"Accept Inline Edit",alias:"Accept Inline Edit",precondition:he.and(z.writable,wo.inlineEditVisibleContext),kbOpts:[{weight:101,primary:2,kbExpr:he.and(z.writable,wo.inlineEditVisibleContext,wo.cursorAtInlineEditContext)}],menuOpts:[{menuId:ze.InlineEditToolbar,title:"Accept",group:"primary",order:1}]})}async run(e,t){const i=wo.get(t);await(i==null?void 0:i.accept())}};class oit extends Ve{constructor(){const e=he.and(z.writable,he.not(wo.inlineEditVisibleKey));super({id:"editor.action.inlineEdit.trigger",label:"Trigger Inline Edit",alias:"Trigger Inline Edit",precondition:e,kbOpts:{weight:101,primary:2646,kbExpr:e}})}async run(e,t){const i=wo.get(t);i==null||i.trigger()}}class ait extends Ve{constructor(){const e=he.and(z.writable,wo.inlineEditVisibleContext,he.not(wo.cursorAtInlineEditKey));super({id:Xtt,label:"Jump to Inline Edit",alias:"Jump to Inline Edit",precondition:e,kbOpts:{weight:101,primary:2646,kbExpr:e},menuOpts:[{menuId:ze.InlineEditToolbar,title:"Jump To Edit",group:"primary",order:3,when:e}]})}async run(e,t){const i=wo.get(t);i==null||i.jumpToCurrent()}}class lit extends Ve{constructor(){const e=he.and(z.writable,wo.cursorAtInlineEditContext);super({id:Ztt,label:"Jump Back from Inline Edit",alias:"Jump Back from Inline Edit",precondition:e,kbOpts:{weight:110,primary:2646,kbExpr:e},menuOpts:[{menuId:ze.InlineEditToolbar,title:"Jump Back",group:"primary",order:3,when:e}]})}async run(e,t){const i=wo.get(t);i==null||i.jumpBack()}}class cit extends Ve{constructor(){const e=he.and(z.writable,wo.inlineEditVisibleContext);super({id:Ytt,label:"Reject Inline Edit",alias:"Reject Inline Edit",precondition:e,kbOpts:{weight:100,primary:9,kbExpr:e},menuOpts:[{menuId:ze.InlineEditToolbar,title:"Reject",group:"secondary",order:2}]})}async run(e,t){const i=wo.get(t);await(i==null?void 0:i.clear())}}ye(rit);ye(cit);ye(ait);ye(lit);ye(oit);Zt(wo.ID,wo,3);const dit="editor.action.inlineEdits.accept",uit="editor.action.inlineEdits.showPrevious",hit="editor.action.inlineEdits.showNext",Q1=new Oe("inlineEditsVisible",!1,b("inlineEditsVisible","Whether an inline edit is visible")),fit=new Oe("inlineEditsIsPinned",!1,b("isPinned","Whether an inline edit is visible")),dY=class dY extends te{constructor(e){super(),this._editor=e,this._editorObs=Ea(this._editor),this._placeholderText=this._editorObs.getOption(88),this._state=_l({owner:this,equalsFn:CA},t=>{const i=this._placeholderText.read(t);if(i&&this._editorObs.valueIsEmpty.read(t))return{placeholder:i}}),this._shouldViewBeAlive=git(this,t=>{var i;return((i=this._state.read(t))==null?void 0:i.placeholder)!==void 0}),this._view=__((t,i)=>{if(!this._shouldViewBeAlive.read(t))return;const n=Vt("div.editorPlaceholder");i.add(ht(r=>{const o=this._state.read(r),a=(o==null?void 0:o.placeholder)!==void 0;n.root.style.display=a?"block":"none",n.root.innerText=(o==null?void 0:o.placeholder)??""})),i.add(ht(r=>{const o=this._editorObs.layoutInfo.read(r);n.root.style.left=`${o.contentLeft}px`,n.root.style.width=o.contentWidth-o.verticalScrollbarWidth+"px",n.root.style.top=`${this._editor.getTopForLineNumber(0)}px`})),i.add(ht(r=>{n.root.style.fontFamily=this._editorObs.getOption(49).read(r),n.root.style.fontSize=this._editorObs.getOption(52).read(r)+"px",n.root.style.lineHeight=this._editorObs.getOption(67).read(r)+"px"})),i.add(this._editorObs.createOverlayWidget({allowEditorOverflow:!1,minContentWidthInPx:hc(0),position:hc(null),domNode:n.root}))}),this._view.recomputeInitiallyAndOnChange(this._store)}};dY.ID="editor.contrib.placeholderText";let mE=dY;function git(s,e){return nD(s,(t,i)=>i===!0?!0:e(t))}var pit=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},mit=function(s,e){return function(t,i){e(t,i,s)}};class _it{constructor(e,t,i){this.range=e,this.newLines=t,this.changes=i}}let cj=class extends te{constructor(e,t,i,n){super(),this._editor=e,this._edit=t,this._userPrompt=i,this._instantiationService=n,this._editorObs=Ea(this._editor),this._elements=Vt("div.inline-edits-widget",{style:{position:"absolute",overflow:"visible",top:"0px",left:"0px"}},[Vt("div@editorContainer",{style:{position:"absolute",top:"0px",left:"0px",width:"500px",height:"500px"}},[Vt("div.toolbar@toolbar",{style:{position:"absolute",top:"-25px",left:"0px"}}),Vt("div.promptEditor@promptEditor",{style:{position:"absolute",top:"-25px",left:"80px",width:"300px",height:"22px"}}),Vt("div.preview@editor",{style:{position:"absolute",top:"0px",left:"0px"}})]),H0("svg",{style:{overflow:"visible",pointerEvents:"none"}},[H0("defs",[H0("linearGradient",{id:"Gradient2",x1:"0",y1:"0",x2:"1",y2:"0"},[H0("stop",{offset:"0%",class:"gradient-stop"}),H0("stop",{offset:"100%",class:"gradient-stop"})])]),H0("path@path",{d:"",fill:"url(#Gradient2)"})])]),this._previewTextModel=this._register(this._instantiationService.createInstance(Jd,"",So,Jd.DEFAULT_CREATION_OPTIONS,null)),this._setText=qe(o=>{const a=this._edit.read(o);a&&this._previewTextModel.setValue(a.newLines.join(`
`))}).recomputeInitiallyAndOnChange(this._store),this._promptTextModel=this._register(this._instantiationService.createInstance(Jd,"",So,Jd.DEFAULT_CREATION_OPTIONS,null)),this._promptEditor=this._register(this._instantiationService.createInstance(hd,this._elements.promptEditor,{glyphMargin:!1,lineNumbers:"off",minimap:{enabled:!1},guides:{indentation:!1,bracketPairs:!1,bracketPairsHorizontal:!1,highlightActiveIndentation:!1},folding:!1,selectOnLineNumbers:!1,selectionHighlight:!1,columnSelection:!1,overviewRulerBorder:!1,overviewRulerLanes:0,lineDecorationsWidth:0,lineNumbersMinChars:0,placeholder:"Describe the change you want...",fontFamily:nme},{contributions:Xb.getSomeEditorContributions([Jc.ID,mE.ID,H1.ID]),isSimpleWidget:!0},this._editor)),this._previewEditor=this._register(this._instantiationService.createInstance(hd,this._elements.editor,{glyphMargin:!1,lineNumbers:"off",minimap:{enabled:!1},guides:{indentation:!1,bracketPairs:!1,bracketPairsHorizontal:!1,highlightActiveIndentation:!1},folding:!1,selectOnLineNumbers:!1,selectionHighlight:!1,columnSelection:!1,overviewRulerBorder:!1,overviewRulerLanes:0,lineDecorationsWidth:0,lineNumbersMinChars:0},{contributions:[]},this._editor)),this._previewEditorObs=Ea(this._previewEditor),this._decorations=qe(this,o=>{var d;this._setText.read(o);const a=(d=this._edit.read(o))==null?void 0:d.changes;if(!a)return[];const l=[],c=[];if(a.length===1&&a[0].innerChanges[0].modifiedRange.equalsRange(this._previewTextModel.getFullModelRange()))return[];for(const u of a)if(u.original.isEmpty||l.push({range:u.original.toInclusiveRange(),options:qI}),u.modified.isEmpty||c.push({range:u.modified.toInclusiveRange(),options:wP}),u.modified.isEmpty||u.original.isEmpty)u.original.isEmpty||l.push({range:u.original.toInclusiveRange(),options:qG}),u.modified.isEmpty||c.push({range:u.modified.toInclusiveRange(),options:jG});else for(const h of u.innerChanges||[])u.original.contains(h.originalRange.startLineNumber)&&l.push({range:h.originalRange,options:h.originalRange.isEmpty()?KG:P1}),u.modified.contains(h.modifiedRange.startLineNumber)&&c.push({range:h.modifiedRange,options:h.modifiedRange.isEmpty()?$G:CP});return c}),this._layout1=qe(this,o=>{const a=this._editor.getModel(),l=this._edit.read(o);if(!l)return null;const c=l.range;let d=0;for(let g=c.startLineNumber;g<c.endLineNumberExclusive;g++){const p=a.getLineMaxColumn(g),_=this._editor.getOffsetForColumn(g,p);d=Math.max(d,_)}return{left:this._editor.getLayoutInfo().contentLeft+d}}),this._layout=qe(this,o=>{const a=this._edit.read(o);if(!a)return null;const l=a.range,c=this._editorObs.scrollLeft.read(o),d=this._layout1.read(o).left+20-c,u=this._editor.getTopForLineNumber(l.startLineNumber)-this._editorObs.scrollTop.read(o),h=this._editor.getTopForLineNumber(l.endLineNumberExclusive)-this._editorObs.scrollTop.read(o),g=new jC(d,u),p=new jC(d,h),_=h-u,v=50,C=this._editor.getOption(67)*a.newLines.length,y=_-C,x=new jC(d+v,u+y/2),L=new jC(d+v,h-y/2);return{topCode:g,bottomCode:p,codeHeight:_,topEdit:x,bottomEdit:L,editHeight:C}});const r=qe(this,o=>this._edit.read(o)!==void 0||this._userPrompt.read(o)!==void 0);this._register(Ig(this._elements.root,{display:qe(this,o=>r.read(o)?"block":"none")})),this._register(FC(this._editor.getDomNode(),this._elements.root)),this._register(Ea(e).createOverlayWidget({domNode:this._elements.root,position:hc(null),allowEditorOverflow:!1,minContentWidthInPx:qe(o=>{var c;const a=(c=this._layout1.read(o))==null?void 0:c.left;if(a===void 0)return 0;const l=this._previewEditorObs.contentWidth.read(o);return a+l})})),this._previewEditor.setModel(this._previewTextModel),this._register(this._previewEditorObs.setDecorations(this._decorations)),this._register(ht(o=>{const a=this._layout.read(o);if(!a)return;const{topCode:l,bottomCode:c,topEdit:d,bottomEdit:u,editHeight:h}=a,g=10,p=0,_=40,v=new vit().moveTo(l).lineTo(l.deltaX(g)).curveTo(l.deltaX(g+_),d.deltaX(-40-p),d.deltaX(-0)).lineTo(d).lineTo(u).lineTo(u.deltaX(-0)).curveTo(u.deltaX(-40-p),c.deltaX(g+_),c.deltaX(g)).lineTo(c).build();this._elements.path.setAttribute("d",v),this._elements.editorContainer.style.top=`${d.y}px`,this._elements.editorContainer.style.left=`${d.x}px`,this._elements.editorContainer.style.height=`${h}px`;const C=this._previewEditorObs.contentWidth.read(o);this._previewEditor.layout({height:h,width:C})})),this._promptEditor.setModel(this._promptTextModel),this._promptEditor.layout(),this._register(wit(bit(this._userPrompt,o=>o??"",o=>o),Ea(this._promptEditor).value)),this._register(ht(o=>{const a=Ea(this._promptEditor).isFocused.read(o);this._elements.root.classList.toggle("focused",a)}))}};cj=pit([mit(3,Xe)],cj);function bit(s,e,t){return eD(void 0,i=>e(s.read(i)),(i,n)=>s.set(t(i),n))}class jC{constructor(e,t){this.x=e,this.y=t}deltaX(e){return new jC(this.x+e,this.y)}}class vit{constructor(){this._data=""}moveTo(e){return this._data+=`M ${e.x} ${e.y} `,this}lineTo(e){return this._data+=`L ${e.x} ${e.y} `,this}curveTo(e,t,i){return this._data+=`C ${e.x} ${e.y} ${t.x} ${t.y} ${i.x} ${i.y} `,this}build(){return this._data}}function wit(s,e){const t=new ce;return t.add(ht(i=>{const n=s.read(i);e.set(n,void 0)})),t.add(ht(i=>{const n=e.read(i);s.set(n,void 0)})),t}var Cit=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},UB=function(s,e){return function(t,i){e(t,i,s)}},_L,qv;let dj=(qv=class extends te{static _createUniqueUri(){return Je.from({scheme:"inline-edits",path:new Date().toString()+String(_L._modelId++)})}constructor(e,t,i,n,r,o,a){super(),this.textModel=e,this._textModelVersionId=t,this._selection=i,this._debounceValue=n,this.languageFeaturesService=r,this._diffProviderFactoryService=o,this._modelService=a,this._forceUpdateExplicitlySignal=vS(this),this._selectedInlineCompletionId=Rt(this,void 0),this._isActive=Rt(this,!1),this._originalModel=Kr(()=>this._modelService.createModel("",null,_L._createUniqueUri())).keepObserved(this._store),this._modifiedModel=Kr(()=>this._modelService.createModel("",null,_L._createUniqueUri())).keepObserved(this._store),this._pinnedRange=new Sit(this.textModel,this._textModelVersionId),this.isPinned=this._pinnedRange.range.map(l=>!!l),this.userPrompt=Rt(this,void 0),this.inlineEdit=qe(this,l=>{var c,d;return(d=(c=this._inlineEdit.read(l))==null?void 0:c.promiseResult.read(l))==null?void 0:d.data}),this._inlineEdit=qe(this,l=>{const c=this.selectedInlineEdit.read(l);if(!c)return;const d=c.inlineCompletion.range;if(c.inlineCompletion.insertText.trim()==="")return;let u=c.inlineCompletion.insertText.split(/\r\n|\r|\n/);function h(v){var y;const C=((y=v[0].match(/^\s*/))==null?void 0:y[0])??"";return v.map(x=>x.replace(new RegExp("^"+C),""))}u=h(u);let p=this.textModel.getValueInRange(d).split(/\r\n|\r|\n/);p=h(p),this._originalModel.get().setValue(p.join(`
`)),this._modifiedModel.get().setValue(u.join(`
`));const _=this._diffProviderFactoryService.createDiffProvider({diffAlgorithm:"advanced"});return BF.fromFn(async()=>{const v=await _.computeDiff(this._originalModel.get(),this._modifiedModel.get(),{computeMoves:!1,ignoreTrimWhitespace:!1,maxComputationTimeMs:1e3},kt.None);if(!v.identical)return new _it(Ct.fromRangeInclusive(d),h(u),v.changes)})}),this._fetchStore=this._register(new ce),this._inlineEditsFetchResult=SI(this,void 0),this._inlineEdits=_l({owner:this,equalsFn:CA},l=>{var c;return((c=this._inlineEditsFetchResult.read(l))==null?void 0:c.completions.map(d=>new yit(d)))??[]}),this._fetchInlineEditsPromise=Zfe({owner:this,createEmptyChangeSummary:()=>({inlineCompletionTriggerKind:iu.Automatic}),handleChange:(l,c)=>(l.didChange(this._forceUpdateExplicitlySignal)&&(c.inlineCompletionTriggerKind=iu.Explicit),!0)},async(l,c)=>{this._fetchStore.clear(),this._forceUpdateExplicitlySignal.read(l),this._textModelVersionId.read(l);function d(_,v){return v(_)}const u=this._pinnedRange.range.read(l)??d(this._selection.read(l),_=>_.isEmpty()?void 0:_);if(!u){this._inlineEditsFetchResult.set(void 0,void 0),this.userPrompt.set(void 0,void 0);return}const h={triggerKind:c.inlineCompletionTriggerKind,selectedSuggestionInfo:void 0,userPrompt:this.userPrompt.read(l)},g=F7(this._fetchStore);await Sg(200,g);const p=await Dbe(this.languageFeaturesService.inlineCompletionsProvider,u,this.textModel,h,g);g.isCancellationRequested||this._inlineEditsFetchResult.set(p,void 0)}),this._filteredInlineEditItems=_l({owner:this,equalsFn:wA()},l=>this._inlineEdits.read(l)),this.selectedInlineCompletionIndex=qe(this,l=>{const c=this._selectedInlineCompletionId.read(l),d=this._filteredInlineEditItems.read(l),u=this._selectedInlineCompletionId===void 0?-1:d.findIndex(h=>h.semanticId===c);return u===-1?(this._selectedInlineCompletionId.set(void 0,void 0),0):u}),this.selectedInlineEdit=qe(this,l=>{const c=this._filteredInlineEditItems.read(l),d=this.selectedInlineCompletionIndex.read(l);return c[d]}),this._register(wS(this._fetchInlineEditsPromise))}async triggerExplicitly(e){bw(e,t=>{this._isActive.set(!0,t),this._forceUpdateExplicitlySignal.trigger(t)}),await this._fetchInlineEditsPromise.get()}stop(e){bw(e,t=>{this.userPrompt.set(void 0,t),this._isActive.set(!1,t),this._inlineEditsFetchResult.set(void 0,t),this._pinnedRange.setRange(void 0,t)})}async _deltaSelectedInlineCompletionIndex(e){await this.triggerExplicitly();const t=this._filteredInlineEditItems.get()||[];if(t.length>0){const i=(this.selectedInlineCompletionIndex.get()+e+t.length)%t.length;this._selectedInlineCompletionId.set(t[i].semanticId,void 0)}else this._selectedInlineCompletionId.set(void 0,void 0)}async next(){await this._deltaSelectedInlineCompletionIndex(1)}async previous(){await this._deltaSelectedInlineCompletionIndex(-1)}async accept(e){if(e.getModel()!==this.textModel)throw new di;const t=this.selectedInlineEdit.get();t&&(e.pushUndoStop(),e.executeEdits("inlineSuggestion.accept",[t.inlineCompletion.toSingleTextEdit().toSingleEditOperation()]),this.stop())}},_L=qv,qv._modelId=0,qv);dj=_L=Cit([UB(4,Be),UB(5,hD),UB(6,Gi)],dj);class yit{constructor(e){this.inlineCompletion=e,this.semanticId=this.inlineCompletion.hash()}}class Sit extends te{constructor(e,t){super(),this._textModel=e,this._versionId=t,this._decorations=Rt(this,[]),this.range=qe(this,i=>{this._versionId.read(i);const n=this._decorations.read(i)[0];return n?this._textModel.getDecorationRange(n)??null:null}),this._register(Ye(()=>{this._textModel.deltaDecorations(this._decorations.get(),[])}))}setRange(e,t){this._decorations.set(this._textModel.deltaDecorations(this._decorations.get(),e?[{range:e,options:{description:"trackedRange"}}]:[]),t)}}var xit=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},zx=function(s,e){return function(t,i){e(t,i,s)}},uj,Kv;let Ng=(Kv=class extends te{static get(e){return e.getContribution(uj.ID)}constructor(e,t,i,n,r,o){super(),this.editor=e,this._instantiationService=t,this._contextKeyService=i,this._debounceService=n,this._languageFeaturesService=r,this._configurationService=o,this._enabled=zje("editor.inlineEdits.enabled",!1,this._configurationService),this._editorObs=Ea(this.editor),this._selection=qe(this,a=>this._editorObs.cursorSelection.read(a)??new Ue(1,1,1,1)),this._debounceValue=this._debounceService.for(this._languageFeaturesService.inlineCompletionsProvider,"InlineEditsDebounce",{min:50,max:50}),this.model=Kr(this,a=>{if(!this._enabled.read(a)||this._editorObs.isReadonly.read(a))return;const l=this._editorObs.model.read(a);return l?this._instantiationService.createInstance(xa(dj,a),l,this._editorObs.versionId,this._selection,this._debounceValue):void 0}),this._hadInlineEdit=nD(this,(a,l)=>{var c;return l||((c=this.model.read(a))==null?void 0:c.inlineEdit.read(a))!==void 0}),this._widget=Kr(this,a=>{if(this._hadInlineEdit.read(a))return this._instantiationService.createInstance(xa(cj,a),this.editor,this.model.map((l,c)=>l==null?void 0:l.inlineEdit.read(c)),Lit(l=>{var c;return((c=this.model.read(l))==null?void 0:c.userPrompt)??Rt("empty","")}))}),this._register(Fd(Q1,this._contextKeyService,a=>{var l;return!!((l=this.model.read(a))!=null&&l.inlineEdit.read(a))})),this._register(Fd(fit,this._contextKeyService,a=>{var l;return!!((l=this.model.read(a))!=null&&l.isPinned.read(a))})),this.model.recomputeInitiallyAndOnChange(this._store),this._widget.recomputeInitiallyAndOnChange(this._store)}},uj=Kv,Kv.ID="editor.contrib.inlineEditsController",Kv);Ng=uj=xit([zx(1,Xe),zx(2,ct),zx(3,Fl),zx(4,Be),zx(5,At)],Ng);function Lit(s){return eD(void 0,e=>s(e).read(e),(e,t)=>{s(void 0).set(e,t)})}function xD(s){return{label:s.value,alias:s.original}}const QO=class QO extends Ve{constructor(){super({id:QO.ID,...xD(dt("action.inlineEdits.showNext","Show Next Inline Edit")),precondition:he.and(z.writable,Q1),kbOpts:{weight:100,primary:606}})}async run(e,t){var n;const i=Ng.get(t);(n=i==null?void 0:i.model.get())==null||n.next()}};QO.ID=hit;let hj=QO;const YO=class YO extends Ve{constructor(){super({id:YO.ID,...xD(dt("action.inlineEdits.showPrevious","Show Previous Inline Edit")),precondition:he.and(z.writable,Q1),kbOpts:{weight:100,primary:604}})}async run(e,t){var n;const i=Ng.get(t);(n=i==null?void 0:i.model.get())==null||n.previous()}};YO.ID=uit;let fj=YO;class kit extends Ve{constructor(){super({id:"editor.action.inlineEdits.trigger",...xD(dt("action.inlineEdits.trigger","Trigger Inline Edit")),precondition:z.writable})}async run(e,t){const i=Ng.get(t);await Xfe(async n=>{var r;await((r=i==null?void 0:i.model.get())==null?void 0:r.triggerExplicitly(n))})}}class Iit extends Ve{constructor(){super({id:dit,...xD(dt("action.inlineEdits.accept","Accept Inline Edit")),precondition:Q1,menuOpts:{menuId:ze.InlineEditsActions,title:b("inlineEditsActions","Accept Inline Edit"),group:"primary",order:1,icon:xe.check},kbOpts:{primary:2058,weight:2e4,kbExpr:Q1}})}async run(e,t){var n;t instanceof hd&&(t=t.getParentEditor());const i=Ng.get(t);i&&((n=i.model.get())==null||n.accept(i.editor),i.editor.focus())}}const XO=class XO extends Ve{constructor(){super({id:XO.ID,...xD(dt("action.inlineEdits.hide","Hide Inline Edit")),precondition:Q1,kbOpts:{weight:100,primary:9}})}async run(e,t){const i=Ng.get(t);pn(n=>{var r;(r=i==null?void 0:i.model.get())==null||r.stop(n)})}};XO.ID="editor.action.inlineEdits.hide";let gj=XO;Zt(Ng.ID,Ng,3);ye(kit);ye(hj);ye(fj);ye(Iit);ye(gj);const Aw={Visible:new Oe("parameterHintsVisible",!1),MultipleSignatures:new Oe("parameterHintsMultipleSignatures",!1)};async function Gbe(s,e,t,i,n){const r=s.ordered(e);for(const o of r)try{const a=await o.provideSignatureHelp(e,t,n,i);if(a)return a}catch(a){Mn(a)}}Gt.registerCommand("_executeSignatureHelpProvider",async(s,...e)=>{const[t,i,n]=e;ii(Je.isUri(t)),ii(X.isIPosition(i)),ii(typeof n=="string"||!n);const r=s.get(Be),o=await s.get(oa).createModelReference(t);try{const a=await Gbe(r.signatureHelpProvider,o.object.textEditorModel,X.lift(i),{triggerKind:yh.Invoke,isRetrigger:!1,triggerCharacter:n},kt.None);return a?(setTimeout(()=>a.dispose(),0),a.value):void 0}finally{o.dispose()}});var Sp;(function(s){s.Default={type:0};class e{constructor(n,r){this.request=n,this.previouslyActiveHints=r,this.type=2}}s.Pending=e;class t{constructor(n){this.hints=n,this.type=1}}s.Active=t})(Sp||(Sp={}));const ZO=class ZO extends te{constructor(e,t,i=ZO.DEFAULT_DELAY){super(),this._onChangedHints=this._register(new Z),this.onChangedHints=this._onChangedHints.event,this.triggerOnType=!1,this._state=Sp.Default,this._pendingTriggers=[],this._lastSignatureHelpResult=this._register(new Es),this.triggerChars=new Z2,this.retriggerChars=new Z2,this.triggerId=0,this.editor=e,this.providers=t,this.throttledDelayer=new bc(i),this._register(this.editor.onDidBlurEditorWidget(()=>this.cancel())),this._register(this.editor.onDidChangeConfiguration(()=>this.onEditorConfigurationChange())),this._register(this.editor.onDidChangeModel(n=>this.onModelChanged())),this._register(this.editor.onDidChangeModelLanguage(n=>this.onModelChanged())),this._register(this.editor.onDidChangeCursorSelection(n=>this.onCursorChange(n))),this._register(this.editor.onDidChangeModelContent(n=>this.onModelContentChange())),this._register(this.providers.onDidChange(this.onModelChanged,this)),this._register(this.editor.onDidType(n=>this.onDidType(n))),this.onEditorConfigurationChange(),this.onModelChanged()}get state(){return this._state}set state(e){this._state.type===2&&this._state.request.cancel(),this._state=e}cancel(e=!1){this.state=Sp.Default,this.throttledDelayer.cancel(),e||this._onChangedHints.fire(void 0)}trigger(e,t){const i=this.editor.getModel();if(!i||!this.providers.has(i))return;const n=++this.triggerId;this._pendingTriggers.push(e),this.throttledDelayer.trigger(()=>this.doTrigger(n),t).catch(ft)}next(){if(this.state.type!==1)return;const e=this.state.hints.signatures.length,t=this.state.hints.activeSignature,i=t%e===e-1,n=this.editor.getOption(86).cycle;if((e<2||i)&&!n){this.cancel();return}this.updateActiveSignature(i&&n?0:t+1)}previous(){if(this.state.type!==1)return;const e=this.state.hints.signatures.length,t=this.state.hints.activeSignature,i=t===0,n=this.editor.getOption(86).cycle;if((e<2||i)&&!n){this.cancel();return}this.updateActiveSignature(i&&n?e-1:t-1)}updateActiveSignature(e){this.state.type===1&&(this.state=new Sp.Active({...this.state.hints,activeSignature:e}),this._onChangedHints.fire(this.state.hints))}async doTrigger(e){const t=this.state.type===1||this.state.type===2,i=this.getLastActiveHints();if(this.cancel(!0),this._pendingTriggers.length===0)return!1;const n=this._pendingTriggers.reduce(Eit);this._pendingTriggers=[];const r={triggerKind:n.triggerKind,triggerCharacter:n.triggerCharacter,isRetrigger:t,activeSignatureHelp:i};if(!this.editor.hasModel())return!1;const o=this.editor.getModel(),a=this.editor.getPosition();this.state=new Sp.Pending(xs(l=>Gbe(this.providers,o,a,r,l)),i);try{const l=await this.state.request;return e!==this.triggerId?(l==null||l.dispose(),!1):!l||!l.value.signatures||l.value.signatures.length===0?(l==null||l.dispose(),this._lastSignatureHelpResult.clear(),this.cancel(),!1):(this.state=new Sp.Active(l.value),this._lastSignatureHelpResult.value=l,this._onChangedHints.fire(this.state.hints),!0)}catch(l){return e===this.triggerId&&(this.state=Sp.Default),ft(l),!1}}getLastActiveHints(){switch(this.state.type){case 1:return this.state.hints;case 2:return this.state.previouslyActiveHints;default:return}}get isTriggered(){return this.state.type===1||this.state.type===2||this.throttledDelayer.isTriggered()}onModelChanged(){this.cancel(),this.triggerChars.clear(),this.retriggerChars.clear();const e=this.editor.getModel();if(e)for(const t of this.providers.ordered(e)){for(const i of t.signatureHelpTriggerCharacters||[])if(i.length){const n=i.charCodeAt(0);this.triggerChars.add(n),this.retriggerChars.add(n)}for(const i of t.signatureHelpRetriggerCharacters||[])i.length&&this.retriggerChars.add(i.charCodeAt(0))}}onDidType(e){if(!this.triggerOnType)return;const t=e.length-1,i=e.charCodeAt(t);(this.triggerChars.has(i)||this.isTriggered&&this.retriggerChars.has(i))&&this.trigger({triggerKind:yh.TriggerCharacter,triggerCharacter:e.charAt(t)})}onCursorChange(e){e.source==="mouse"?this.cancel():this.isTriggered&&this.trigger({triggerKind:yh.ContentChange})}onModelContentChange(){this.isTriggered&&this.trigger({triggerKind:yh.ContentChange})}onEditorConfigurationChange(){this.triggerOnType=this.editor.getOption(86).enabled,this.triggerOnType||this.cancel()}dispose(){this.cancel(!0),super.dispose()}};ZO.DEFAULT_DELAY=120;let pj=ZO;function Eit(s,e){switch(e.triggerKind){case yh.Invoke:return e;case yh.ContentChange:return s;case yh.TriggerCharacter:default:return e}}var Dit=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},sR=function(s,e){return function(t,i){e(t,i,s)}},mj;const sl=ke,Tit=Qi("parameter-hints-next",xe.chevronDown,b("parameterHintsNextIcon","Icon for show next parameter hint.")),Nit=Qi("parameter-hints-previous",xe.chevronUp,b("parameterHintsPreviousIcon","Icon for show previous parameter hint."));var Gv;let _j=(Gv=class extends te{constructor(e,t,i,n,r,o){super(),this.editor=e,this.model=t,this.telemetryService=o,this.renderDisposeables=this._register(new ce),this.visible=!1,this.announcedLabel=null,this.allowEditorOverflow=!0,this.markdownRenderer=this._register(new kg({editor:e},r,n)),this.keyVisible=Aw.Visible.bindTo(i),this.keyMultipleSignatures=Aw.MultipleSignatures.bindTo(i)}createParameterHintDOMNodes(){const e=sl(".editor-widget.parameter-hints-widget"),t=me(e,sl(".phwrapper"));t.tabIndex=-1;const i=me(t,sl(".controls")),n=me(i,sl(".button"+at.asCSSSelector(Nit))),r=me(i,sl(".overloads")),o=me(i,sl(".button"+at.asCSSSelector(Tit)));this._register(oe(n,"click",h=>{jt.stop(h),this.previous()})),this._register(oe(o,"click",h=>{jt.stop(h),this.next()}));const a=sl(".body"),l=new QE(a,{alwaysConsumeMouseWheel:!0});this._register(l),t.appendChild(l.getDomNode());const c=me(a,sl(".signature")),d=me(a,sl(".docs"));e.style.userSelect="text",this.domNodes={element:e,signature:c,overloads:r,docs:d,scrollbar:l},this.editor.addContentWidget(this),this.hide(),this._register(this.editor.onDidChangeCursorSelection(h=>{this.visible&&this.editor.layoutContentWidget(this)}));const u=()=>{if(!this.domNodes)return;const h=this.editor.getOption(50),g=this.domNodes.element;g.style.fontSize=`${h.fontSize}px`,g.style.lineHeight=`${h.lineHeight/h.fontSize}`,g.style.setProperty("--vscode-parameterHintsWidget-editorFontFamily",h.fontFamily),g.style.setProperty("--vscode-parameterHintsWidget-editorFontFamilyDefault",yo.fontFamily)};u(),this._register(De.chain(this.editor.onDidChangeConfiguration.bind(this.editor),h=>h.filter(g=>g.hasChanged(50)))(u)),this._register(this.editor.onDidLayoutChange(h=>this.updateMaxHeight())),this.updateMaxHeight()}show(){this.visible||(this.domNodes||this.createParameterHintDOMNodes(),this.keyVisible.set(!0),this.visible=!0,setTimeout(()=>{var e;(e=this.domNodes)==null||e.element.classList.add("visible")},100),this.editor.layoutContentWidget(this))}hide(){var e;this.renderDisposeables.clear(),this.visible&&(this.keyVisible.reset(),this.visible=!1,this.announcedLabel=null,(e=this.domNodes)==null||e.element.classList.remove("visible"),this.editor.layoutContentWidget(this))}getPosition(){return this.visible?{position:this.editor.getPosition(),preference:[1,2]}:null}render(e){if(this.renderDisposeables.clear(),!this.domNodes)return;const t=e.signatures.length>1;this.domNodes.element.classList.toggle("multiple",t),this.keyMultipleSignatures.set(t),this.domNodes.signature.innerText="",this.domNodes.docs.innerText="";const i=e.signatures[e.activeSignature];if(!i)return;const n=me(this.domNodes.signature,sl(".code")),r=i.parameters.length>0,o=i.activeParameter??e.activeParameter;if(r)this.renderParameters(n,i,o);else{const c=me(n,sl("span"));c.textContent=i.label}const a=i.parameters[o];if(a!=null&&a.documentation){const c=sl("span.documentation");if(typeof a.documentation=="string")c.textContent=a.documentation;else{const d=this.renderMarkdownDocs(a.documentation);c.appendChild(d.element)}me(this.domNodes.docs,sl("p",{},c))}if(i.documentation!==void 0)if(typeof i.documentation=="string")me(this.domNodes.docs,sl("p",{},i.documentation));else{const c=this.renderMarkdownDocs(i.documentation);me(this.domNodes.docs,c.element)}const l=this.hasDocs(i,a);if(this.domNodes.signature.classList.toggle("has-docs",l),this.domNodes.docs.classList.toggle("empty",!l),this.domNodes.overloads.textContent=String(e.activeSignature+1).padStart(e.signatures.length.toString().length,"0")+"/"+e.signatures.length,a){let c="";const d=i.parameters[o];Array.isArray(d.label)?c=i.label.substring(d.label[0],d.label[1]):c=d.label,d.documentation&&(c+=typeof d.documentation=="string"?`, ${d.documentation}`:`, ${d.documentation.value}`),i.documentation&&(c+=typeof i.documentation=="string"?`, ${i.documentation}`:`, ${i.documentation.value}`),this.announcedLabel!==c&&(Eo(b("hint","{0}, hint",c)),this.announcedLabel=c)}this.editor.layoutContentWidget(this),this.domNodes.scrollbar.scanDomNode()}renderMarkdownDocs(e){const t=new Bs,i=this.renderDisposeables.add(this.markdownRenderer.render(e,{asyncRenderCallback:()=>{var r;(r=this.domNodes)==null||r.scrollbar.scanDomNode()}}));i.element.classList.add("markdown-docs");const n=t.elapsed();return n>300&&this.telemetryService.publicLog2("parameterHints.parseMarkdown",{renderDuration:n}),i}hasDocs(e,t){return!!(t&&typeof t.documentation=="string"&&Hp(t.documentation).length>0||t&&typeof t.documentation=="object"&&Hp(t.documentation).value.length>0||e.documentation&&typeof e.documentation=="string"&&Hp(e.documentation).length>0||e.documentation&&typeof e.documentation=="object"&&Hp(e.documentation.value).length>0)}renderParameters(e,t,i){const[n,r]=this.getParameterLabelOffsets(t,i),o=document.createElement("span");o.textContent=t.label.substring(0,n);const a=document.createElement("span");a.textContent=t.label.substring(n,r),a.className="parameter active";const l=document.createElement("span");l.textContent=t.label.substring(r),me(e,o,a,l)}getParameterLabelOffsets(e,t){const i=e.parameters[t];if(i){if(Array.isArray(i.label))return i.label;if(i.label.length){const n=new RegExp(`(\\W|^)${Nl(i.label)}(?=\\W|$)`,"g");n.test(e.label);const r=n.lastIndex-i.label.length;return r>=0?[r,n.lastIndex]:[0,0]}else return[0,0]}else return[0,0]}next(){this.editor.focus(),this.model.next()}previous(){this.editor.focus(),this.model.previous()}getDomNode(){return this.domNodes||this.createParameterHintDOMNodes(),this.domNodes.element}getId(){return mj.ID}updateMaxHeight(){if(!this.domNodes)return;const t=`${Math.max(this.editor.getLayoutInfo().height/4,250)}px`;this.domNodes.element.style.maxHeight=t;const i=this.domNodes.element.getElementsByClassName("phwrapper");i.length&&(i[0].style.maxHeight=t)}},mj=Gv,Gv.ID="editor.widget.parameterHintsWidget",Gv);_j=mj=Dit([sR(2,ct),sR(3,la),sR(4,un),sR(5,Tr)],_j);j("editorHoverWidget.highlightForeground",IC,b("editorHoverWidgetHighlightForeground","Foreground color of the active item in the parameter hint."));var Rit=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},qoe=function(s,e){return function(t,i){e(t,i,s)}},bj,Qv;let Y1=(Qv=class extends te{static get(e){return e.getContribution(bj.ID)}constructor(e,t,i){super(),this.editor=e,this.model=this._register(new pj(e,i.signatureHelpProvider)),this._register(this.model.onChangedHints(n=>{var r;n?(this.widget.value.show(),this.widget.value.render(n)):(r=this.widget.rawValue)==null||r.hide()})),this.widget=new uu(()=>this._register(t.createInstance(_j,this.editor,this.model)))}cancel(){this.model.cancel()}previous(){var e;(e=this.widget.rawValue)==null||e.previous()}next(){var e;(e=this.widget.rawValue)==null||e.next()}trigger(e){this.model.trigger(e,0)}},bj=Qv,Qv.ID="editor.controller.parameterHints",Qv);Y1=bj=Rit([qoe(1,Xe),qoe(2,Be)],Y1);class Ait extends Ve{constructor(){super({id:"editor.action.triggerParameterHints",label:b("parameterHints.trigger.label","Trigger Parameter Hints"),alias:"Trigger Parameter Hints",precondition:z.hasSignatureHelpProvider,kbOpts:{kbExpr:z.editorTextFocus,primary:3082,weight:100}})}run(e,t){const i=Y1.get(t);i==null||i.trigger({triggerKind:yh.Invoke})}}Zt(Y1.ID,Y1,2);ye(Ait);const HQ=175,zQ=fs.bindToContribution(Y1.get);Me(new zQ({id:"closeParameterHints",precondition:Aw.Visible,handler:s=>s.cancel(),kbOpts:{weight:HQ,kbExpr:z.focus,primary:9,secondary:[1033]}}));Me(new zQ({id:"showPrevParameterHint",precondition:he.and(Aw.Visible,Aw.MultipleSignatures),handler:s=>s.previous(),kbOpts:{weight:HQ,kbExpr:z.focus,primary:16,secondary:[528],mac:{primary:16,secondary:[528,302]}}}));Me(new zQ({id:"showNextParameterHint",precondition:he.and(Aw.Visible,Aw.MultipleSignatures),handler:s=>s.next(),kbOpts:{weight:HQ,kbExpr:z.focus,primary:18,secondary:[530],mac:{primary:18,secondary:[530,300]}}}));var Pit=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Mit=function(s,e){return function(t,i){e(t,i,s)}};class Oit{constructor(e){this.instantiationService=e}init(...e){}}function Fit(s,e){return class extends e{constructor(){super(...arguments),this._autorun=void 0}init(...i){this._autorun=Jo((n,r)=>{const o=xa(s(),n);r.add(this.instantiationService.createInstance(o,...i))})}dispose(){var i;(i=this._autorun)==null||i.dispose()}}}function Vit(s){return o5()?Fit(s,vj):s()}let vj=class extends Oit{constructor(e,t){super(t),this.init(e)}};vj=Pit([Mit(1,Xe)],vj);Zt(mE.ID,Vit(()=>mE),0);j("editor.placeholder.foreground",NVe,b("placeholderForeground","Foreground color of the placeholder text in the editor."));var Bit=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},rR=function(s,e){return function(t,i){e(t,i,s)}};const AS=new Oe("renameInputVisible",!1,b("renameInputVisible","Whether the rename input widget is visible"));new Oe("renameInputFocused",!1,b("renameInputFocused","Whether the rename input widget is focused"));let wj=class{constructor(e,t,i,n,r,o){this._editor=e,this._acceptKeybindings=t,this._themeService=i,this._keybindingService=n,this._logService=o,this.allowEditorOverflow=!0,this._disposables=new ce,this._visibleContextKey=AS.bindTo(r),this._isEditingRenameCandidate=!1,this._nRenameSuggestionsInvocations=0,this._hadAutomaticRenameSuggestionsInvocation=!1,this._candidates=new Set,this._beforeFirstInputFieldEditSW=new Bs,this._inputWithButton=new Wit,this._disposables.add(this._inputWithButton),this._editor.addContentWidget(this),this._disposables.add(this._editor.onDidChangeConfiguration(a=>{a.hasChanged(50)&&this._updateFont()})),this._disposables.add(i.onDidColorThemeChange(this._updateStyles,this))}dispose(){this._disposables.dispose(),this._editor.removeContentWidget(this)}getId(){return"__renameInputWidget"}getDomNode(){return this._domNode||(this._domNode=document.createElement("div"),this._domNode.className="monaco-editor rename-box",this._domNode.appendChild(this._inputWithButton.domNode),this._renameCandidateListView=this._disposables.add(new UQ(this._domNode,{fontInfo:this._editor.getOption(50),onFocusChange:e=>{this._inputWithButton.input.value=e,this._isEditingRenameCandidate=!1},onSelectionChange:()=>{this._isEditingRenameCandidate=!1,this.acceptInput(!1)}})),this._disposables.add(this._inputWithButton.onDidInputChange(()=>{var e,t,i;((e=this._renameCandidateListView)==null?void 0:e.focusedCandidate)!==void 0&&(this._isEditingRenameCandidate=!0),this._timeBeforeFirstInputFieldEdit??(this._timeBeforeFirstInputFieldEdit=this._beforeFirstInputFieldEditSW.elapsed()),((t=this._renameCandidateProvidersCts)==null?void 0:t.token.isCancellationRequested)===!1&&this._renameCandidateProvidersCts.cancel(),(i=this._renameCandidateListView)==null||i.clearFocus()})),this._label=document.createElement("div"),this._label.className="rename-label",this._domNode.appendChild(this._label),this._updateFont(),this._updateStyles(this._themeService.getColorTheme())),this._domNode}_updateStyles(e){if(!this._domNode)return;const t=e.getColor(gS),i=e.getColor(ufe);this._domNode.style.backgroundColor=String(e.getColor(yl)??""),this._domNode.style.boxShadow=t?` 0 0 8px 2px ${t}`:"",this._domNode.style.border=i?`1px solid ${i}`:"",this._domNode.style.color=String(e.getColor(gfe)??"");const n=e.getColor(pfe);this._inputWithButton.domNode.style.backgroundColor=String(e.getColor(A6)??""),this._inputWithButton.input.style.backgroundColor=String(e.getColor(A6)??""),this._inputWithButton.domNode.style.borderWidth=n?"1px":"0px",this._inputWithButton.domNode.style.borderStyle=n?"solid":"none",this._inputWithButton.domNode.style.borderColor=(n==null?void 0:n.toString())??"none"}_updateFont(){if(this._domNode===void 0)return;ii(this._label!==void 0,"RenameWidget#_updateFont: _label must not be undefined given _domNode is defined"),this._editor.applyFontInfo(this._inputWithButton.input);const e=this._editor.getOption(50);this._label.style.fontSize=`${this._computeLabelFontSize(e.fontSize)}px`}_computeLabelFontSize(e){return e*.8}getPosition(){if(!this._visible||!this._editor.hasModel()||!this._editor.getDomNode())return null;const e=qm(this.getDomNode().ownerDocument.body),t=Pn(this._editor.getDomNode()),i=this._getTopForPosition();this._nPxAvailableAbove=i+t.top,this._nPxAvailableBelow=e.height-this._nPxAvailableAbove;const n=this._editor.getOption(67),{totalHeight:r}=_E.getLayoutInfo({lineHeight:n}),o=this._nPxAvailableBelow>r*6?[2,1]:[1,2];return{position:this._position,preference:o}}beforeRender(){var i,n;const[e,t]=this._acceptKeybindings;return this._label.innerText=b({key:"label",comment:['placeholders are keybindings, e.g "F2 to Rename, Shift+F2 to Preview"']},"{0} to Rename, {1} to Preview",(i=this._keybindingService.lookupKeybinding(e))==null?void 0:i.getLabel(),(n=this._keybindingService.lookupKeybinding(t))==null?void 0:n.getLabel()),this._domNode.style.minWidth="200px",null}afterRender(e){if(e===null){this.cancelInput(!0,"afterRender (because position is null)");return}if(!this._editor.hasModel()||!this._editor.getDomNode())return;ii(this._renameCandidateListView),ii(this._nPxAvailableAbove!==void 0),ii(this._nPxAvailableBelow!==void 0);const t=$f(this._inputWithButton.domNode),i=$f(this._label);let n;e===2?n=this._nPxAvailableBelow:n=this._nPxAvailableAbove,this._renameCandidateListView.layout({height:n-i-t,width:ya(this._inputWithButton.domNode)})}acceptInput(e){var t;this._trace("invoking acceptInput"),(t=this._currentAcceptInput)==null||t.call(this,e)}cancelInput(e,t){var i;(i=this._currentCancelInput)==null||i.call(this,e)}focusNextRenameSuggestion(){var e;(e=this._renameCandidateListView)!=null&&e.focusNext()||(this._inputWithButton.input.value=this._currentName)}focusPreviousRenameSuggestion(){var e;(e=this._renameCandidateListView)!=null&&e.focusPrevious()||(this._inputWithButton.input.value=this._currentName)}getInput(e,t,i,n,r){const{start:o,end:a}=this._getSelection(e,t);this._renameCts=r;const l=new ce;this._nRenameSuggestionsInvocations=0,this._hadAutomaticRenameSuggestionsInvocation=!1,n===void 0?this._inputWithButton.button.style.display="none":(this._inputWithButton.button.style.display="flex",this._requestRenameCandidatesOnce=n,this._requestRenameCandidates(t,!1),l.add(oe(this._inputWithButton.button,"click",()=>this._requestRenameCandidates(t,!0))),l.add(oe(this._inputWithButton.button,Le.KEY_DOWN,d=>{const u=new Mi(d);(u.equals(3)||u.equals(10))&&(u.stopPropagation(),u.preventDefault(),this._requestRenameCandidates(t,!0))}))),this._isEditingRenameCandidate=!1,this._domNode.classList.toggle("preview",i),this._position=new X(e.startLineNumber,e.startColumn),this._currentName=t,this._inputWithButton.input.value=t,this._inputWithButton.input.setAttribute("selectionStart",o.toString()),this._inputWithButton.input.setAttribute("selectionEnd",a.toString()),this._inputWithButton.input.size=Math.max((e.endColumn-e.startColumn)*1.1,20),this._beforeFirstInputFieldEditSW.reset(),l.add(Ye(()=>{this._renameCts=void 0,r.dispose(!0)})),l.add(Ye(()=>{this._renameCandidateProvidersCts!==void 0&&(this._renameCandidateProvidersCts.dispose(!0),this._renameCandidateProvidersCts=void 0)})),l.add(Ye(()=>this._candidates.clear()));const c=new lS;return c.p.finally(()=>{l.dispose(),this._hide()}),this._currentCancelInput=d=>{var u;return this._trace("invoking _currentCancelInput"),this._currentAcceptInput=void 0,this._currentCancelInput=void 0,(u=this._renameCandidateListView)==null||u.clearCandidates(),c.complete(d),!0},this._currentAcceptInput=d=>{this._trace("invoking _currentAcceptInput"),ii(this._renameCandidateListView!==void 0);const u=this._renameCandidateListView.nCandidates;let h,g;const p=this._renameCandidateListView.focusedCandidate;if(p!==void 0?(this._trace("using new name from renameSuggestion"),h=p,g={k:"renameSuggestion"}):(this._trace("using new name from inputField"),h=this._inputWithButton.input.value,g=this._isEditingRenameCandidate?{k:"userEditedRenameSuggestion"}:{k:"inputField"}),h===t||h.trim().length===0){this.cancelInput(!0,"_currentAcceptInput (because newName === value || newName.trim().length === 0)");return}this._currentAcceptInput=void 0,this._currentCancelInput=void 0,this._renameCandidateListView.clearCandidates(),c.complete({newName:h,wantsPreview:i&&d,stats:{source:g,nRenameSuggestions:u,timeBeforeFirstInputFieldEdit:this._timeBeforeFirstInputFieldEdit,nRenameSuggestionsInvocations:this._nRenameSuggestionsInvocations,hadAutomaticRenameSuggestionsInvocation:this._hadAutomaticRenameSuggestionsInvocation}})},l.add(r.token.onCancellationRequested(()=>this.cancelInput(!0,"cts.token.onCancellationRequested"))),l.add(this._editor.onDidBlurEditorWidget(()=>{var d;return this.cancelInput(!((d=this._domNode)!=null&&d.ownerDocument.hasFocus()),"editor.onDidBlurEditorWidget")})),this._show(),c.p}_requestRenameCandidates(e,t){if(this._requestRenameCandidatesOnce!==void 0&&(this._renameCandidateProvidersCts!==void 0&&this._renameCandidateProvidersCts.dispose(!0),ii(this._renameCts),this._inputWithButton.buttonState!=="stop")){this._renameCandidateProvidersCts=new mn;const i=t?Jk.Invoke:Jk.Automatic,n=this._requestRenameCandidatesOnce(i,this._renameCandidateProvidersCts.token);if(n.length===0){this._inputWithButton.setSparkleButton();return}t||(this._hadAutomaticRenameSuggestionsInvocation=!0),this._nRenameSuggestionsInvocations+=1,this._inputWithButton.setStopButton(),this._updateRenameCandidates(n,e,this._renameCts.token)}}_getSelection(e,t){ii(this._editor.hasModel());const i=this._editor.getSelection();let n=0,r=t.length;return!F.isEmpty(i)&&!F.spansMultipleLines(i)&&F.containsRange(e,i)&&(n=Math.max(0,i.startColumn-e.startColumn),r=Math.min(e.endColumn,i.endColumn)-e.startColumn),{start:n,end:r}}_show(){this._trace("invoking _show"),this._editor.revealLineInCenterIfOutsideViewport(this._position.lineNumber,0),this._visible=!0,this._visibleContextKey.set(!0),this._editor.layoutContentWidget(this),setTimeout(()=>{this._inputWithButton.input.focus(),this._inputWithButton.input.setSelectionRange(parseInt(this._inputWithButton.input.getAttribute("selectionStart")),parseInt(this._inputWithButton.input.getAttribute("selectionEnd")))},100)}async _updateRenameCandidates(e,t,i){const n=(...c)=>this._trace("_updateRenameCandidates",...c);n("start");const r=await jE(Promise.allSettled(e),i);if(this._inputWithButton.setSparkleButton(),r===void 0){n("returning early - received updateRenameCandidates results - undefined");return}const o=r.flatMap(c=>c.status==="fulfilled"&&Ch(c.value)?c.value:[]);n(`received updateRenameCandidates results - total (unfiltered) ${o.length} candidates.`);const a=wg(o,c=>c.newSymbolName);n(`distinct candidates - ${a.length} candidates.`);const l=a.filter(({newSymbolName:c})=>c.trim().length>0&&c!==this._inputWithButton.input.value&&c!==t&&!this._candidates.has(c));if(n(`valid distinct candidates - ${o.length} candidates.`),l.forEach(c=>this._candidates.add(c.newSymbolName)),l.length<1){n("returning early - no valid distinct candidates");return}n("setting candidates"),this._renameCandidateListView.setCandidates(l),n("asking editor to re-layout"),this._editor.layoutContentWidget(this)}_hide(){this._trace("invoked _hide"),this._visible=!1,this._visibleContextKey.reset(),this._editor.layoutContentWidget(this)}_getTopForPosition(){const e=this._editor.getVisibleRanges();let t;return e.length>0?t=e[0].startLineNumber:(this._logService.warn("RenameWidget#_getTopForPosition: this should not happen - visibleRanges is empty"),t=Math.max(1,this._position.lineNumber-5)),this._editor.getTopForLineNumber(this._position.lineNumber)-this._editor.getTopForLineNumber(t)}_trace(...e){this._logService.trace("RenameWidget",...e)}};wj=Bit([rR(2,gs),rR(3,pi),rR(4,ct),rR(5,pr)],wj);class UQ{constructor(e,t){this._disposables=new ce,this._availableHeight=0,this._minimumWidth=0,this._lineHeight=t.fontInfo.lineHeight,this._typicalHalfwidthCharacterWidth=t.fontInfo.typicalHalfwidthCharacterWidth,this._listContainer=document.createElement("div"),this._listContainer.className="rename-box rename-candidate-list-container",e.appendChild(this._listContainer),this._listWidget=UQ._createListWidget(this._listContainer,this._candidateViewHeight,t.fontInfo),this._listWidget.onDidChangeFocus(i=>{i.elements.length===1&&t.onFocusChange(i.elements[0].newSymbolName)},this._disposables),this._listWidget.onDidChangeSelection(i=>{i.elements.length===1&&t.onSelectionChange()},this._disposables),this._disposables.add(this._listWidget.onDidBlur(i=>{this._listWidget.setFocus([])})),this._listWidget.style(Qw({listInactiveFocusForeground:pI,listInactiveFocusBackground:mI}))}dispose(){this._listWidget.dispose(),this._disposables.dispose()}layout({height:e,width:t}){this._availableHeight=e,this._minimumWidth=t}setCandidates(e){this._listWidget.splice(0,0,e);const t=this._pickListHeight(this._listWidget.length),i=this._pickListWidth(e);this._listWidget.layout(t,i),this._listContainer.style.height=`${t}px`,this._listContainer.style.width=`${i}px`,Mh(b("renameSuggestionsReceivedAria","Received {0} rename suggestions",e.length))}clearCandidates(){this._listContainer.style.height="0px",this._listContainer.style.width="0px",this._listWidget.splice(0,this._listWidget.length,[])}get nCandidates(){return this._listWidget.length}get focusedCandidate(){if(this._listWidget.length===0)return;const e=this._listWidget.getSelectedElements()[0];if(e!==void 0)return e.newSymbolName;const t=this._listWidget.getFocusedElements()[0];if(t!==void 0)return t.newSymbolName}focusNext(){if(this._listWidget.length===0)return!1;const e=this._listWidget.getFocus();if(e.length===0)return this._listWidget.focusFirst(),this._listWidget.reveal(0),!0;if(e[0]===this._listWidget.length-1)return this._listWidget.setFocus([]),this._listWidget.reveal(0),!1;{this._listWidget.focusNext();const t=this._listWidget.getFocus()[0];return this._listWidget.reveal(t),!0}}focusPrevious(){if(this._listWidget.length===0)return!1;const e=this._listWidget.getFocus();if(e.length===0){this._listWidget.focusLast();const t=this._listWidget.getFocus()[0];return this._listWidget.reveal(t),!0}else{if(e[0]===0)return this._listWidget.setFocus([]),!1;{this._listWidget.focusPrevious();const t=this._listWidget.getFocus()[0];return this._listWidget.reveal(t),!0}}}clearFocus(){this._listWidget.setFocus([])}get _candidateViewHeight(){const{totalHeight:e}=_E.getLayoutInfo({lineHeight:this._lineHeight});return e}_pickListHeight(e){const t=this._candidateViewHeight*e;return Math.min(t,this._availableHeight,this._candidateViewHeight*7)}_pickListWidth(e){const t=Math.ceil(Math.max(...e.map(n=>n.newSymbolName.length))*this._typicalHalfwidthCharacterWidth);return Math.max(this._minimumWidth,25+t+10)}static _createListWidget(e,t,i){const n=new class{getTemplateId(o){return"candidate"}getHeight(o){return t}},r=new class{constructor(){this.templateId="candidate"}renderTemplate(o){return new _E(o,i)}renderElement(o,a,l){l.populate(o)}disposeTemplate(o){o.dispose()}};return new Bl("NewSymbolNameCandidates",e,n,[r],{keyboardSupport:!1,mouseSupport:!0,multipleSelectionSupport:!1})}}class Wit{constructor(){this._onDidInputChange=new Z,this.onDidInputChange=this._onDidInputChange.event,this._disposables=new ce}get domNode(){return this._domNode||(this._domNode=document.createElement("div"),this._domNode.className="rename-input-with-button",this._domNode.style.display="flex",this._domNode.style.flexDirection="row",this._domNode.style.alignItems="center",this._inputNode=document.createElement("input"),this._inputNode.className="rename-input",this._inputNode.type="text",this._inputNode.style.border="none",this._inputNode.setAttribute("aria-label",b("renameAriaLabel","Rename input. Type new name and press Enter to commit.")),this._domNode.appendChild(this._inputNode),this._buttonNode=document.createElement("div"),this._buttonNode.className="rename-suggestions-button",this._buttonNode.setAttribute("tabindex","0"),this._buttonGenHoverText=b("generateRenameSuggestionsButton","Generate new name suggestions"),this._buttonCancelHoverText=b("cancelRenameSuggestionsButton","Cancel"),this._buttonHover=wu().setupManagedHover(No("element"),this._buttonNode,this._buttonGenHoverText),this._disposables.add(this._buttonHover),this._domNode.appendChild(this._buttonNode),this._disposables.add(oe(this.input,Le.INPUT,()=>this._onDidInputChange.fire())),this._disposables.add(oe(this.input,Le.KEY_DOWN,e=>{const t=new Mi(e);(t.keyCode===15||t.keyCode===17)&&this._onDidInputChange.fire()})),this._disposables.add(oe(this.input,Le.CLICK,()=>this._onDidInputChange.fire())),this._disposables.add(oe(this.input,Le.FOCUS,()=>{this.domNode.style.outlineWidth="1px",this.domNode.style.outlineStyle="solid",this.domNode.style.outlineOffset="-1px",this.domNode.style.outlineColor="var(--vscode-focusBorder)"})),this._disposables.add(oe(this.input,Le.BLUR,()=>{this.domNode.style.outline="none"}))),this._domNode}get input(){return ii(this._inputNode),this._inputNode}get button(){return ii(this._buttonNode),this._buttonNode}get buttonState(){return this._buttonState}setSparkleButton(){var e;this._buttonState="sparkle",this._sparkleIcon??(this._sparkleIcon=pw(xe.sparkle)),Ys(this.button),this.button.appendChild(this._sparkleIcon),this.button.setAttribute("aria-label","Generating new name suggestions"),(e=this._buttonHover)==null||e.update(this._buttonGenHoverText),this.input.focus()}setStopButton(){var e;this._buttonState="stop",this._stopIcon??(this._stopIcon=pw(xe.primitiveSquare)),Ys(this.button),this.button.appendChild(this._stopIcon),this.button.setAttribute("aria-label","Cancel generating new name suggestions"),(e=this._buttonHover)==null||e.update(this._buttonCancelHoverText),this.input.focus()}dispose(){this._disposables.dispose()}}const Rk=class Rk{constructor(e,t){this._domNode=document.createElement("div"),this._domNode.className="rename-box rename-candidate",this._domNode.style.display="flex",this._domNode.style.columnGap="5px",this._domNode.style.alignItems="center",this._domNode.style.height=`${t.lineHeight}px`,this._domNode.style.padding=`${Rk._PADDING}px`;const i=document.createElement("div");i.style.display="flex",i.style.alignItems="center",i.style.width=i.style.height=`${t.lineHeight*.8}px`,this._domNode.appendChild(i),this._icon=pw(xe.sparkle),this._icon.style.display="none",i.appendChild(this._icon),this._label=document.createElement("div"),Zs(this._label,t),this._domNode.appendChild(this._label),e.appendChild(this._domNode)}populate(e){this._updateIcon(e),this._updateLabel(e)}_updateIcon(e){var i;const t=!!((i=e.tags)!=null&&i.includes(j7.AIGenerated));this._icon.style.display=t?"inherit":"none"}_updateLabel(e){this._label.innerText=e.newSymbolName}static getLayoutInfo({lineHeight:e}){return{totalHeight:e+Rk._PADDING*2}}dispose(){}};Rk._PADDING=2;let _E=Rk;var Hit=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},_p=function(s,e){return function(t,i){e(t,i,s)}},Cj;class jQ{constructor(e,t,i){this.model=e,this.position=t,this._providerRenameIdx=0,this._providers=i.ordered(e)}hasProvider(){return this._providers.length>0}async resolveRenameLocation(e){const t=[];for(this._providerRenameIdx=0;this._providerRenameIdx<this._providers.length;this._providerRenameIdx++){const n=this._providers[this._providerRenameIdx];if(!n.resolveRenameLocation)break;const r=await n.resolveRenameLocation(this.model,this.position,e);if(r){if(r.rejectReason){t.push(r.rejectReason);continue}return r}}this._providerRenameIdx=0;const i=this.model.getWordAtPosition(this.position);return i?{range:new F(this.position.lineNumber,i.startColumn,this.position.lineNumber,i.endColumn),text:i.word,rejectReason:t.length>0?t.join(`
`):void 0}:{range:F.fromPositions(this.position),text:"",rejectReason:t.length>0?t.join(`
`):void 0}}async provideRenameEdits(e,t){return this._provideRenameEdits(e,this._providerRenameIdx,[],t)}async _provideRenameEdits(e,t,i,n){const r=this._providers[t];if(!r)return{edits:[],rejectReason:i.join(`
`)};const o=await r.provideRenameEdits(this.model,this.position,e,n);if(o){if(o.rejectReason)return this._provideRenameEdits(e,t+1,i.concat(o.rejectReason),n)}else return this._provideRenameEdits(e,t+1,i.concat(b("no result","No result.")),n);return o}}async function zit(s,e,t,i){const n=new jQ(e,t,s),r=await n.resolveRenameLocation(kt.None);return r!=null&&r.rejectReason?{edits:[],rejectReason:r.rejectReason}:n.provideRenameEdits(i,kt.None)}var Yv;let r_=(Yv=class{static get(e){return e.getContribution(Cj.ID)}constructor(e,t,i,n,r,o,a,l,c){this.editor=e,this._instaService=t,this._notificationService=i,this._bulkEditService=n,this._progressService=r,this._logService=o,this._configService=a,this._languageFeaturesService=l,this._telemetryService=c,this._disposableStore=new ce,this._cts=new mn,this._renameWidget=this._disposableStore.add(this._instaService.createInstance(wj,this.editor,["acceptRenameInput","acceptRenameInputWithPreview"]))}dispose(){this._disposableStore.dispose(),this._cts.dispose(!0)}async run(){var p,_;const e=this._logService.trace.bind(this._logService,"[rename]");if(this._cts.dispose(!0),this._cts=new mn,!this.editor.hasModel()){e("editor has no model");return}const t=this.editor.getPosition(),i=new jQ(this.editor.getModel(),t,this._languageFeaturesService.renameProvider);if(!i.hasProvider()){e("skeleton has no provider");return}const n=new t_(this.editor,5,void 0,this._cts.token);let r;try{e("resolving rename location");const v=i.resolveRenameLocation(n.token);this._progressService.showWhile(v,250),r=await v,e("resolved rename location")}catch(v){v instanceof od?e("resolve rename location cancelled",JSON.stringify(v,null,"	")):(e("resolve rename location failed",v instanceof Error?v:JSON.stringify(v,null,"	")),(typeof v=="string"||au(v))&&((p=Aa.get(this.editor))==null||p.showMessage(v||b("resolveRenameLocationFailed","An unknown error occurred while resolving rename location"),t)));return}finally{n.dispose()}if(!r){e("returning early - no loc");return}if(r.rejectReason){e(`returning early - rejected with reason: ${r.rejectReason}`,r.rejectReason),(_=Aa.get(this.editor))==null||_.showMessage(r.rejectReason,t);return}if(n.token.isCancellationRequested){e("returning early - cts1 cancelled");return}const o=new t_(this.editor,5,r.range,this._cts.token),a=this.editor.getModel(),l=this._languageFeaturesService.newSymbolNamesProvider.all(a),c=await Promise.all(l.map(async v=>[v,await v.supportsAutomaticNewSymbolNamesTriggerKind??!1])),d=(v,C)=>{let y=c.slice();return v===Jk.Automatic&&(y=y.filter(([x,L])=>L)),y.map(([x])=>x.provideNewSymbolNames(a,r.range,v,C))};e("creating rename input field and awaiting its result");const u=this._bulkEditService.hasPreviewHandler()&&this._configService.getValue(this.editor.getModel().uri,"editor.rename.enablePreview"),h=await this._renameWidget.getInput(r.range,r.text,u,l.length>0?d:void 0,o);if(e("received response from rename input field"),l.length>0&&this._reportTelemetry(l.length,a.getLanguageId(),h),typeof h=="boolean"){e(`returning early - rename input field response - ${h}`),h&&this.editor.focus(),o.dispose();return}this.editor.focus(),e("requesting rename edits");const g=jE(i.provideRenameEdits(h.newName,o.token),o.token).then(async v=>{if(!v){e("returning early - no rename edits result");return}if(!this.editor.hasModel()){e("returning early - no model after rename edits are provided");return}if(v.rejectReason){e(`returning early - rejected with reason: ${v.rejectReason}`),this._notificationService.info(v.rejectReason);return}this.editor.setSelection(F.fromPositions(this.editor.getSelection().getPosition())),e("applying edits"),this._bulkEditService.apply(v,{editor:this.editor,showPreview:h.wantsPreview,label:b("label","Renaming '{0}' to '{1}'",r==null?void 0:r.text,h.newName),code:"undoredo.rename",quotableLabel:b("quotableLabel","Renaming {0} to {1}",r==null?void 0:r.text,h.newName),respectAutoSaveConfig:!0}).then(C=>{e("edits applied"),C.ariaSummary&&Eo(b("aria","Successfully renamed '{0}' to '{1}'. Summary: {2}",r.text,h.newName,C.ariaSummary))}).catch(C=>{e(`error when applying edits ${JSON.stringify(C,null,"	")}`),this._notificationService.error(b("rename.failedApply","Rename failed to apply edits")),this._logService.error(C)})},v=>{e("error when providing rename edits",JSON.stringify(v,null,"	")),this._notificationService.error(b("rename.failed","Rename failed to compute edits")),this._logService.error(v)}).finally(()=>{o.dispose()});return e("returning rename operation"),this._progressService.showWhile(g,250),g}acceptRenameInput(e){this._renameWidget.acceptInput(e)}cancelRenameInput(){this._renameWidget.cancelInput(!0,"cancelRenameInput command")}focusNextRenameSuggestion(){this._renameWidget.focusNextRenameSuggestion()}focusPreviousRenameSuggestion(){this._renameWidget.focusPreviousRenameSuggestion()}_reportTelemetry(e,t,i){const n=typeof i=="boolean"?{kind:"cancelled",languageId:t,nRenameSuggestionProviders:e}:{kind:"accepted",languageId:t,nRenameSuggestionProviders:e,source:i.stats.source.k,nRenameSuggestions:i.stats.nRenameSuggestions,timeBeforeFirstInputFieldEdit:i.stats.timeBeforeFirstInputFieldEdit,wantsPreview:i.wantsPreview,nRenameSuggestionsInvocations:i.stats.nRenameSuggestionsInvocations,hadAutomaticRenameSuggestionsInvocation:i.stats.hadAutomaticRenameSuggestionsInvocation};this._telemetryService.publicLog2("renameInvokedEvent",n)}},Cj=Yv,Yv.ID="editor.contrib.renameController",Yv);r_=Cj=Hit([_p(1,Xe),_p(2,jn),_p(3,ZE),_p(4,m_),_p(5,pr),_p(6,vF),_p(7,Be),_p(8,Tr)],r_);class Uit extends Ve{constructor(){super({id:"editor.action.rename",label:b("rename.label","Rename Symbol"),alias:"Rename Symbol",precondition:he.and(z.writable,z.hasRenameProvider),kbOpts:{kbExpr:z.editorTextFocus,primary:60,weight:100},contextMenuOpts:{group:"1_modification",order:1.1}})}runCommand(e,t){const i=e.get(ni),[n,r]=Array.isArray(t)&&t||[void 0,void 0];return Je.isUri(n)&&X.isIPosition(r)?i.openCodeEditor({resource:n},i.getActiveCodeEditor()).then(o=>{o&&(o.setPosition(r),o.invokeWithinContext(a=>(this.reportTelemetry(a,o),this.run(a,o))))},ft):super.runCommand(e,t)}run(e,t){const i=e.get(pr),n=r_.get(t);return n?(i.trace("[RenameAction] got controller, running..."),n.run()):(i.trace("[RenameAction] returning early - controller missing"),Promise.resolve())}}Zt(r_.ID,r_,4);ye(Uit);const $Q=fs.bindToContribution(r_.get);Me(new $Q({id:"acceptRenameInput",precondition:AS,handler:s=>s.acceptRenameInput(!1),kbOpts:{weight:199,kbExpr:he.and(z.focus,he.not("isComposing")),primary:3}}));Me(new $Q({id:"acceptRenameInputWithPreview",precondition:he.and(AS,he.has("config.editor.rename.enablePreview")),handler:s=>s.acceptRenameInput(!0),kbOpts:{weight:199,kbExpr:he.and(z.focus,he.not("isComposing")),primary:2051}}));Me(new $Q({id:"cancelRenameInput",precondition:AS,handler:s=>s.cancelRenameInput(),kbOpts:{weight:199,kbExpr:z.focus,primary:9,secondary:[1033]}}));Oi(class extends To{constructor(){super({id:"focusNextRenameSuggestion",title:{...dt("focusNextRenameSuggestion","Focus Next Rename Suggestion")},precondition:AS,keybinding:[{primary:18,weight:199}]})}run(e){const t=e.get(ni).getFocusedCodeEditor();if(!t)return;const i=r_.get(t);i&&i.focusNextRenameSuggestion()}});Oi(class extends To{constructor(){super({id:"focusPreviousRenameSuggestion",title:{...dt("focusPreviousRenameSuggestion","Focus Previous Rename Suggestion")},precondition:AS,keybinding:[{primary:16,weight:199}]})}run(e){const t=e.get(ni).getFocusedCodeEditor();if(!t)return;const i=r_.get(t);i&&i.focusPreviousRenameSuggestion()}});aa("_executeDocumentRenameProvider",function(s,e,t,...i){const[n]=i;ii(typeof n=="string");const{renameProvider:r}=s.get(Be);return zit(r,e,t,n)});aa("_executePrepareRename",async function(s,e,t){const{renameProvider:i}=s.get(Be),r=await new jQ(e,t,i).resolveRenameLocation(kt.None);if(r!=null&&r.rejectReason)throw new Error(r.rejectReason);return r});_n.as(pd.Configuration).registerConfiguration({id:"editor",properties:{"editor.rename.enablePreview":{scope:5,description:b("enablePreview","Enable/disable the ability to preview changes before renaming"),default:!0,type:"boolean"}}});var jit=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Koe=function(s,e){return function(t,i){e(t,i,s)}},Ky;let _M=(Ky=class extends te{constructor(e,t,i){super(),this.editor=e,this.languageConfigurationService=t,this.editorWorkerService=i,this.decorations=this.editor.createDecorationsCollection(),this.options=this.createOptions(e.getOption(73)),this.computePromise=null,this.currentOccurrences={},this._register(e.onDidChangeModel(n=>{this.currentOccurrences={},this.options=this.createOptions(e.getOption(73)),this.stop(),this.computeSectionHeaders.schedule(0)})),this._register(e.onDidChangeModelLanguage(n=>{this.currentOccurrences={},this.options=this.createOptions(e.getOption(73)),this.stop(),this.computeSectionHeaders.schedule(0)})),this._register(t.onDidChange(n=>{var o;const r=(o=this.editor.getModel())==null?void 0:o.getLanguageId();r&&n.affects(r)&&(this.currentOccurrences={},this.options=this.createOptions(e.getOption(73)),this.stop(),this.computeSectionHeaders.schedule(0))})),this._register(e.onDidChangeConfiguration(n=>{this.options&&!n.hasChanged(73)||(this.options=this.createOptions(e.getOption(73)),this.updateDecorations([]),this.stop(),this.computeSectionHeaders.schedule(0))})),this._register(this.editor.onDidChangeModelContent(n=>{this.computeSectionHeaders.schedule()})),this._register(e.onDidChangeModelTokens(n=>{this.computeSectionHeaders.isScheduled()||this.computeSectionHeaders.schedule(1e3)})),this.computeSectionHeaders=this._register(new xi(()=>{this.findSectionHeaders()},250)),this.computeSectionHeaders.schedule(0)}createOptions(e){if(!e||!this.editor.hasModel())return;const t=this.editor.getModel().getLanguageId();if(!t)return;const i=this.languageConfigurationService.getLanguageConfiguration(t).comments,n=this.languageConfigurationService.getLanguageConfiguration(t).foldingRules;if(!(!i&&!(n!=null&&n.markers)))return{foldingRules:n,findMarkSectionHeaders:e.showMarkSectionHeaders,findRegionSectionHeaders:e.showRegionSectionHeaders}}findSectionHeaders(){var i,n;if(!this.editor.hasModel()||!((i=this.options)!=null&&i.findMarkSectionHeaders)&&!((n=this.options)!=null&&n.findRegionSectionHeaders))return;const e=this.editor.getModel();if(e.isDisposed()||e.isTooLargeForSyncing())return;const t=e.getVersionId();this.editorWorkerService.findSectionHeaders(e.uri,this.options).then(r=>{e.isDisposed()||e.getVersionId()!==t||this.updateDecorations(r)})}updateDecorations(e){const t=this.editor.getModel();t&&(e=e.filter(r=>{if(!r.shouldBeInComments)return!0;const o=t.validateRange(r.range),a=t.tokenization.getLineTokens(o.startLineNumber),l=a.findTokenIndexAtOffset(o.startColumn-1),c=a.getStandardTokenType(l);return a.getLanguageId(l)===t.getLanguageId()&&c===1}));const i=Object.values(this.currentOccurrences).map(r=>r.decorationId),n=e.map(r=>$it(r));this.editor.changeDecorations(r=>{const o=r.deltaDecorations(i,n);this.currentOccurrences={};for(let a=0,l=o.length;a<l;a++){const c={sectionHeader:e[a],decorationId:o[a]};this.currentOccurrences[c.decorationId]=c}})}stop(){this.computeSectionHeaders.cancel(),this.computePromise&&(this.computePromise.cancel(),this.computePromise=null)}dispose(){super.dispose(),this.stop(),this.decorations.clear()}},Ky.ID="editor.sectionHeaderDetector",Ky);_M=jit([Koe(1,bn),Koe(2,ca)],_M);function $it(s){return{range:s.range,options:_t.createDynamic({description:"section-header",stickiness:3,collapseOnReplaceEdit:!0,minimap:{color:void 0,position:1,sectionHeaderStyle:s.hasSeparatorLine?2:1,sectionHeaderText:s.text}})}}Zt(_M.ID,_M,1);function qit(s){for(let e=0,t=s.length;e<t;e+=4){const i=s[e+0],n=s[e+1],r=s[e+2],o=s[e+3];s[e+0]=o,s[e+1]=r,s[e+2]=n,s[e+3]=i}}function Kit(s){const e=new Uint8Array(s.buffer,s.byteOffset,s.length*4);return rue()||qit(e),mF.wrap(e)}function Qbe(s){const e=new Uint32Array(Git(s));let t=0;if(e[t++]=s.id,s.type==="full")e[t++]=1,e[t++]=s.data.length,e.set(s.data,t),t+=s.data.length;else{e[t++]=2,e[t++]=s.deltas.length;for(const i of s.deltas)e[t++]=i.start,e[t++]=i.deleteCount,i.data?(e[t++]=i.data.length,e.set(i.data,t),t+=i.data.length):e[t++]=0}return Kit(e)}function Git(s){let e=0;if(e+=2,s.type==="full")e+=1+s.data.length;else{e+=1,e+=3*s.deltas.length;for(const t of s.deltas)t.data&&(e+=t.data.length)}return e}function E5(s){return s&&!!s.data}function Ybe(s){return s&&Array.isArray(s.edits)}class Qit{constructor(e,t,i){this.provider=e,this.tokens=t,this.error=i}}function Xbe(s,e){return s.has(e)}function Yit(s,e){const t=s.orderedGroups(e);return t.length>0?t[0]:[]}async function Zbe(s,e,t,i,n){const r=Yit(s,e),o=await Promise.all(r.map(async a=>{let l,c=null;try{l=await a.provideDocumentSemanticTokens(e,a===t?i:null,n)}catch(d){c=d,l=null}return(!l||!E5(l)&&!Ybe(l))&&(l=null),new Qit(a,l,c)}));for(const a of o){if(a.error)throw a.error;if(a.tokens)return a}return o.length>0?o[0]:null}function Xit(s,e){const t=s.orderedGroups(e);return t.length>0?t[0]:null}class Zit{constructor(e,t){this.provider=e,this.tokens=t}}function Jit(s,e){return s.has(e)}function Jbe(s,e){const t=s.orderedGroups(e);return t.length>0?t[0]:[]}async function qQ(s,e,t,i){const n=Jbe(s,e),r=await Promise.all(n.map(async o=>{let a;try{a=await o.provideDocumentRangeSemanticTokens(e,t,i)}catch(l){Mn(l),a=null}return(!a||!E5(a))&&(a=null),new Zit(o,a)}));for(const o of r)if(o.tokens)return o;return r.length>0?r[0]:null}Gt.registerCommand("_provideDocumentSemanticTokensLegend",async(s,...e)=>{const[t]=e;ii(t instanceof Je);const i=s.get(Gi).getModel(t);if(!i)return;const{documentSemanticTokensProvider:n}=s.get(Be),r=Xit(n,i);return r?r[0].getLegend():s.get(Hi).executeCommand("_provideDocumentRangeSemanticTokensLegend",t)});Gt.registerCommand("_provideDocumentSemanticTokens",async(s,...e)=>{const[t]=e;ii(t instanceof Je);const i=s.get(Gi).getModel(t);if(!i)return;const{documentSemanticTokensProvider:n}=s.get(Be);if(!Xbe(n,i))return s.get(Hi).executeCommand("_provideDocumentRangeSemanticTokens",t,i.getFullModelRange());const r=await Zbe(n,i,null,null,kt.None);if(!r)return;const{provider:o,tokens:a}=r;if(!a||!E5(a))return;const l=Qbe({id:0,type:"full",data:a.data});return a.resultId&&o.releaseDocumentSemanticTokens(a.resultId),l});Gt.registerCommand("_provideDocumentRangeSemanticTokensLegend",async(s,...e)=>{const[t,i]=e;ii(t instanceof Je);const n=s.get(Gi).getModel(t);if(!n)return;const{documentRangeSemanticTokensProvider:r}=s.get(Be),o=Jbe(r,n);if(o.length===0)return;if(o.length===1)return o[0].getLegend();if(!i||!F.isIRange(i))return console.warn("provideDocumentRangeSemanticTokensLegend might be out-of-sync with provideDocumentRangeSemanticTokens unless a range argument is passed in"),o[0].getLegend();const a=await qQ(r,n,F.lift(i),kt.None);if(a)return a.provider.getLegend()});Gt.registerCommand("_provideDocumentRangeSemanticTokens",async(s,...e)=>{const[t,i]=e;ii(t instanceof Je),ii(F.isIRange(i));const n=s.get(Gi).getModel(t);if(!n)return;const{documentRangeSemanticTokensProvider:r}=s.get(Be),o=await qQ(r,n,F.lift(i),kt.None);if(!(!o||!o.tokens))return Qbe({id:0,type:"full",data:o.tokens.data})});const KQ="editor.semanticHighlighting";function n2(s,e,t){var n;const i=(n=t.getValue(KQ,{overrideIdentifier:s.getLanguageId(),resource:s.uri}))==null?void 0:n.enabled;return typeof i=="boolean"?i:e.getColorTheme().semanticHighlighting}var eve=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},lh=function(s,e){return function(t,i){e(t,i,s)}},Cp;let yj=class extends te{constructor(e,t,i,n,r,o){super(),this._watchers=Object.create(null);const a=d=>{this._watchers[d.uri.toString()]=new Sj(d,e,i,r,o)},l=(d,u)=>{u.dispose(),delete this._watchers[d.uri.toString()]},c=()=>{for(const d of t.getModels()){const u=this._watchers[d.uri.toString()];n2(d,i,n)?u||a(d):u&&l(d,u)}};t.getModels().forEach(d=>{n2(d,i,n)&&a(d)}),this._register(t.onModelAdded(d=>{n2(d,i,n)&&a(d)})),this._register(t.onModelRemoved(d=>{const u=this._watchers[d.uri.toString()];u&&l(d,u)})),this._register(n.onDidChangeConfiguration(d=>{d.affectsConfiguration(KQ)&&c()})),this._register(i.onDidColorThemeChange(c))}dispose(){for(const e of Object.values(this._watchers))e.dispose();super.dispose()}};yj=eve([lh(0,CF),lh(1,Gi),lh(2,gs),lh(3,At),lh(4,Fl),lh(5,Be)],yj);var Tm;let Sj=(Tm=class extends te{constructor(e,t,i,n,r){super(),this._semanticTokensStylingService=t,this._isDisposed=!1,this._model=e,this._provider=r.documentSemanticTokensProvider,this._debounceInformation=n.for(this._provider,"DocumentSemanticTokens",{min:Cp.REQUEST_MIN_DELAY,max:Cp.REQUEST_MAX_DELAY}),this._fetchDocumentSemanticTokens=this._register(new xi(()=>this._fetchDocumentSemanticTokensNow(),Cp.REQUEST_MIN_DELAY)),this._currentDocumentResponse=null,this._currentDocumentRequestCancellationTokenSource=null,this._documentProvidersChangeListeners=[],this._providersChangedDuringRequest=!1,this._register(this._model.onDidChangeContent(()=>{this._fetchDocumentSemanticTokens.isScheduled()||this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))})),this._register(this._model.onDidChangeAttached(()=>{this._fetchDocumentSemanticTokens.isScheduled()||this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))})),this._register(this._model.onDidChangeLanguage(()=>{this._currentDocumentResponse&&(this._currentDocumentResponse.dispose(),this._currentDocumentResponse=null),this._currentDocumentRequestCancellationTokenSource&&(this._currentDocumentRequestCancellationTokenSource.cancel(),this._currentDocumentRequestCancellationTokenSource=null),this._setDocumentSemanticTokens(null,null,null,[]),this._fetchDocumentSemanticTokens.schedule(0)}));const o=()=>{Ni(this._documentProvidersChangeListeners),this._documentProvidersChangeListeners=[];for(const a of this._provider.all(e))typeof a.onDidChange=="function"&&this._documentProvidersChangeListeners.push(a.onDidChange(()=>{if(this._currentDocumentRequestCancellationTokenSource){this._providersChangedDuringRequest=!0;return}this._fetchDocumentSemanticTokens.schedule(0)}))};o(),this._register(this._provider.onDidChange(()=>{o(),this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))})),this._register(i.onDidColorThemeChange(a=>{this._setDocumentSemanticTokens(null,null,null,[]),this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))})),this._fetchDocumentSemanticTokens.schedule(0)}dispose(){this._currentDocumentResponse&&(this._currentDocumentResponse.dispose(),this._currentDocumentResponse=null),this._currentDocumentRequestCancellationTokenSource&&(this._currentDocumentRequestCancellationTokenSource.cancel(),this._currentDocumentRequestCancellationTokenSource=null),Ni(this._documentProvidersChangeListeners),this._documentProvidersChangeListeners=[],this._setDocumentSemanticTokens(null,null,null,[]),this._isDisposed=!0,super.dispose()}_fetchDocumentSemanticTokensNow(){if(this._currentDocumentRequestCancellationTokenSource)return;if(!Xbe(this._provider,this._model)){this._currentDocumentResponse&&this._model.tokenization.setSemanticTokens(null,!1);return}if(!this._model.isAttachedToEditor())return;const e=new mn,t=this._currentDocumentResponse?this._currentDocumentResponse.provider:null,i=this._currentDocumentResponse&&this._currentDocumentResponse.resultId||null,n=Zbe(this._provider,this._model,t,i,e.token);this._currentDocumentRequestCancellationTokenSource=e,this._providersChangedDuringRequest=!1;const r=[],o=this._model.onDidChangeContent(l=>{r.push(l)}),a=new Bs(!1);n.then(l=>{if(this._debounceInformation.update(this._model,a.elapsed()),this._currentDocumentRequestCancellationTokenSource=null,o.dispose(),!l)this._setDocumentSemanticTokens(null,null,null,r);else{const{provider:c,tokens:d}=l,u=this._semanticTokensStylingService.getStyling(c);this._setDocumentSemanticTokens(c,d||null,u,r)}},l=>{l&&(xc(l)||typeof l.message=="string"&&l.message.indexOf("busy")!==-1)||ft(l),this._currentDocumentRequestCancellationTokenSource=null,o.dispose(),(r.length>0||this._providersChangedDuringRequest)&&(this._fetchDocumentSemanticTokens.isScheduled()||this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model)))})}static _copy(e,t,i,n,r){r=Math.min(r,i.length-n,e.length-t);for(let o=0;o<r;o++)i[n+o]=e[t+o]}_setDocumentSemanticTokens(e,t,i,n){const r=this._currentDocumentResponse,o=()=>{(n.length>0||this._providersChangedDuringRequest)&&!this._fetchDocumentSemanticTokens.isScheduled()&&this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))};if(this._currentDocumentResponse&&(this._currentDocumentResponse.dispose(),this._currentDocumentResponse=null),this._isDisposed){e&&t&&e.releaseDocumentSemanticTokens(t.resultId);return}if(!e||!i){this._model.tokenization.setSemanticTokens(null,!1);return}if(!t){this._model.tokenization.setSemanticTokens(null,!0),o();return}if(Ybe(t)){if(!r){this._model.tokenization.setSemanticTokens(null,!0);return}if(t.edits.length===0)t={resultId:t.resultId,data:r.data};else{let a=0;for(const h of t.edits)a+=(h.data?h.data.length:0)-h.deleteCount;const l=r.data,c=new Uint32Array(l.length+a);let d=l.length,u=c.length;for(let h=t.edits.length-1;h>=0;h--){const g=t.edits[h];if(g.start>l.length){i.warnInvalidEditStart(r.resultId,t.resultId,h,g.start,l.length),this._model.tokenization.setSemanticTokens(null,!0);return}const p=d-(g.start+g.deleteCount);p>0&&(Cp._copy(l,d-p,c,u-p,p),u-=p),g.data&&(Cp._copy(g.data,0,c,u-g.data.length,g.data.length),u-=g.data.length),d=g.start}d>0&&Cp._copy(l,0,c,0,d),t={resultId:t.resultId,data:c}}}if(E5(t)){this._currentDocumentResponse=new ent(e,t.resultId,t.data);const a=Yhe(t,i,this._model.getLanguageId());if(n.length>0)for(const l of n)for(const c of a)for(const d of l.changes)c.applyEdit(d.range,d.text);this._model.tokenization.setSemanticTokens(a,!0)}else this._model.tokenization.setSemanticTokens(null,!0);o()}},Cp=Tm,Tm.REQUEST_MIN_DELAY=300,Tm.REQUEST_MAX_DELAY=2e3,Tm);Sj=Cp=eve([lh(1,CF),lh(2,gs),lh(3,Fl),lh(4,Be)],Sj);class ent{constructor(e,t,i){this.provider=e,this.resultId=t,this.data=i}dispose(){this.provider.releaseDocumentSemanticTokens(this.resultId)}}LS(yj);var tnt=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Ux=function(s,e){return function(t,i){e(t,i,s)}},Gy;let bM=(Gy=class extends te{constructor(e,t,i,n,r,o){super(),this._semanticTokensStylingService=t,this._themeService=i,this._configurationService=n,this._editor=e,this._provider=o.documentRangeSemanticTokensProvider,this._debounceInformation=r.for(this._provider,"DocumentRangeSemanticTokens",{min:100,max:500}),this._tokenizeViewport=this._register(new xi(()=>this._tokenizeViewportNow(),100)),this._outstandingRequests=[];const a=()=>{this._editor.hasModel()&&this._tokenizeViewport.schedule(this._debounceInformation.get(this._editor.getModel()))};this._register(this._editor.onDidScrollChange(()=>{a()})),this._register(this._editor.onDidChangeModel(()=>{this._cancelAll(),a()})),this._register(this._editor.onDidChangeModelContent(l=>{this._cancelAll(),a()})),this._register(this._provider.onDidChange(()=>{this._cancelAll(),a()})),this._register(this._configurationService.onDidChangeConfiguration(l=>{l.affectsConfiguration(KQ)&&(this._cancelAll(),a())})),this._register(this._themeService.onDidColorThemeChange(()=>{this._cancelAll(),a()})),a()}_cancelAll(){for(const e of this._outstandingRequests)e.cancel();this._outstandingRequests=[]}_removeOutstandingRequest(e){for(let t=0,i=this._outstandingRequests.length;t<i;t++)if(this._outstandingRequests[t]===e){this._outstandingRequests.splice(t,1);return}}_tokenizeViewportNow(){if(!this._editor.hasModel())return;const e=this._editor.getModel();if(e.tokenization.hasCompleteSemanticTokens())return;if(!n2(e,this._themeService,this._configurationService)){e.tokenization.hasSomeSemanticTokens()&&e.tokenization.setSemanticTokens(null,!1);return}if(!Jit(this._provider,e)){e.tokenization.hasSomeSemanticTokens()&&e.tokenization.setSemanticTokens(null,!1);return}const t=this._editor.getVisibleRangesPlusViewportAboveBelow();this._outstandingRequests=this._outstandingRequests.concat(t.map(i=>this._requestRange(e,i)))}_requestRange(e,t){const i=e.getVersionId(),n=xs(o=>Promise.resolve(qQ(this._provider,e,t,o))),r=new Bs(!1);return n.then(o=>{if(this._debounceInformation.update(e,r.elapsed()),!o||!o.tokens||e.isDisposed()||e.getVersionId()!==i)return;const{provider:a,tokens:l}=o,c=this._semanticTokensStylingService.getStyling(a);e.tokenization.setPartialSemanticTokens(t,Yhe(l,c,e.getLanguageId()))}).then(()=>this._removeOutstandingRequest(n),()=>this._removeOutstandingRequest(n)),n}},Gy.ID="editor.contrib.viewportSemanticTokens",Gy);bM=tnt([Ux(1,CF),Ux(2,gs),Ux(3,At),Ux(4,Fl),Ux(5,Be)],bM);Zt(bM.ID,bM,1);class int{constructor(e=!0){this.selectSubwords=e}provideSelectionRanges(e,t){const i=[];for(const n of t){const r=[];i.push(r),this.selectSubwords&&this._addInWordRanges(r,e,n),this._addWordRanges(r,e,n),this._addWhitespaceLine(r,e,n),r.push({range:e.getFullModelRange()})}return i}_addInWordRanges(e,t,i){const n=t.getWordAtPosition(i);if(!n)return;const{word:r,startColumn:o}=n,a=i.column-o;let l=a,c=a,d=0;for(;l>=0;l--){const u=r.charCodeAt(l);if(l!==a&&(u===95||u===45))break;if(zp(u)&&sh(d))break;d=u}for(l+=1;c<r.length;c++){const u=r.charCodeAt(c);if(sh(u)&&zp(d))break;if(u===95||u===45)break;d=u}l<c&&e.push({range:new F(i.lineNumber,o+l,i.lineNumber,o+c)})}_addWordRanges(e,t,i){const n=t.getWordAtPosition(i);n&&e.push({range:new F(i.lineNumber,n.startColumn,i.lineNumber,n.endColumn)})}_addWhitespaceLine(e,t,i){t.getLineLength(i.lineNumber)>0&&t.getLineFirstNonWhitespaceColumn(i.lineNumber)===0&&t.getLineLastNonWhitespaceColumn(i.lineNumber)===0&&e.push({range:new F(i.lineNumber,1,i.lineNumber,t.getLineMaxColumn(i.lineNumber))})}}var nnt=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},snt=function(s,e){return function(t,i){e(t,i,s)}},xj;class GQ{constructor(e,t){this.index=e,this.ranges=t}mov(e){const t=this.index+(e?1:-1);if(t<0||t>=this.ranges.length)return this;const i=new GQ(t,this.ranges);return i.ranges[t].equalsRange(this.ranges[this.index])?i.mov(e):i}}var Xv;let bE=(Xv=class{static get(e){return e.getContribution(xj.ID)}constructor(e,t){this._editor=e,this._languageFeaturesService=t,this._ignoreSelection=!1}dispose(){var e;(e=this._selectionListener)==null||e.dispose()}async run(e){if(!this._editor.hasModel())return;const t=this._editor.getSelections(),i=this._editor.getModel();if(this._state||await ive(this._languageFeaturesService.selectionRangeProvider,i,t.map(r=>r.getPosition()),this._editor.getOption(114),kt.None).then(r=>{var o;if(!(!Xr(r)||r.length!==t.length)&&!(!this._editor.hasModel()||!dn(this._editor.getSelections(),t,(a,l)=>a.equalsSelection(l)))){for(let a=0;a<r.length;a++)r[a]=r[a].filter(l=>l.containsPosition(t[a].getStartPosition())&&l.containsPosition(t[a].getEndPosition())),r[a].unshift(t[a]);this._state=r.map(a=>new GQ(0,a)),(o=this._selectionListener)==null||o.dispose(),this._selectionListener=this._editor.onDidChangeCursorPosition(()=>{var a;this._ignoreSelection||((a=this._selectionListener)==null||a.dispose(),this._state=void 0)})}}),!this._state)return;this._state=this._state.map(r=>r.mov(e));const n=this._state.map(r=>Ue.fromPositions(r.ranges[r.index].getStartPosition(),r.ranges[r.index].getEndPosition()));this._ignoreSelection=!0;try{this._editor.setSelections(n)}finally{this._ignoreSelection=!1}}},xj=Xv,Xv.ID="editor.contrib.smartSelectController",Xv);bE=xj=nnt([snt(1,Be)],bE);class tve extends Ve{constructor(e,t){super(t),this._forward=e}async run(e,t){const i=bE.get(t);i&&await i.run(this._forward)}}class rnt extends tve{constructor(){super(!0,{id:"editor.action.smartSelect.expand",label:b("smartSelect.expand","Expand Selection"),alias:"Expand Selection",precondition:void 0,kbOpts:{kbExpr:z.editorTextFocus,primary:1553,mac:{primary:3345,secondary:[1297]},weight:100},menuOpts:{menuId:ze.MenubarSelectionMenu,group:"1_basic",title:b({key:"miSmartSelectGrow",comment:["&& denotes a mnemonic"]},"&&Expand Selection"),order:2}})}}Gt.registerCommandAlias("editor.action.smartSelect.grow","editor.action.smartSelect.expand");class ont extends tve{constructor(){super(!1,{id:"editor.action.smartSelect.shrink",label:b("smartSelect.shrink","Shrink Selection"),alias:"Shrink Selection",precondition:void 0,kbOpts:{kbExpr:z.editorTextFocus,primary:1551,mac:{primary:3343,secondary:[1295]},weight:100},menuOpts:{menuId:ze.MenubarSelectionMenu,group:"1_basic",title:b({key:"miSmartSelectShrink",comment:["&& denotes a mnemonic"]},"&&Shrink Selection"),order:3}})}}Zt(bE.ID,bE,4);ye(rnt);ye(ont);async function ive(s,e,t,i,n){const r=s.all(e).concat(new int(i.selectSubwords));r.length===1&&r.unshift(new iM);const o=[],a=[];for(const l of r)o.push(Promise.resolve(l.provideSelectionRanges(e,t,n)).then(c=>{if(Xr(c)&&c.length===t.length)for(let d=0;d<t.length;d++){a[d]||(a[d]=[]);for(const u of c[d])F.isIRange(u.range)&&F.containsPosition(u.range,t[d])&&a[d].push(F.lift(u.range))}},Mn));return await Promise.all(o),a.map(l=>{if(l.length===0)return[];l.sort((h,g)=>X.isBefore(h.getStartPosition(),g.getStartPosition())?1:X.isBefore(g.getStartPosition(),h.getStartPosition())||X.isBefore(h.getEndPosition(),g.getEndPosition())?-1:X.isBefore(g.getEndPosition(),h.getEndPosition())?1:0);const c=[];let d;for(const h of l)(!d||F.containsRange(h,d)&&!F.equalsRange(h,d))&&(c.push(h),d=h);if(!i.selectLeadingAndTrailingWhitespace)return c;const u=[c[0]];for(let h=1;h<c.length;h++){const g=c[h-1],p=c[h];if(p.startLineNumber!==g.startLineNumber||p.endLineNumber!==g.endLineNumber){const _=new F(g.startLineNumber,e.getLineFirstNonWhitespaceColumn(g.startLineNumber),g.endLineNumber,e.getLineLastNonWhitespaceColumn(g.endLineNumber));_.containsRange(g)&&!_.equalsRange(g)&&p.containsRange(_)&&!p.equalsRange(_)&&u.push(_);const v=new F(g.startLineNumber,1,g.endLineNumber,e.getLineMaxColumn(g.endLineNumber));v.containsRange(g)&&!v.equalsRange(_)&&p.containsRange(v)&&!p.equalsRange(v)&&u.push(v)}u.push(p)}return u})}Gt.registerCommand("_executeSelectionRangeProvider",async function(s,...e){const[t,i]=e;ii(Je.isUri(t));const n=s.get(Be).selectionRangeProvider,r=await s.get(oa).createModelReference(t);try{return ive(n,r.object.textEditorModel,i,{selectLeadingAndTrailingWhitespace:!0,selectSubwords:!0},kt.None)}finally{r.dispose()}});const ant=Object.freeze({View:dt("view","View"),Help:dt("help","Help"),Test:dt("test","Test"),File:dt("file","File"),Preferences:dt("preferences","Preferences"),Developer:dt({key:"developer",comment:["A developer on Code itself or someone diagnosing issues in Code"]},"Developer")});class dk{constructor(e,t,i,n=null){this.startLineNumbers=e,this.endLineNumbers=t,this.lastLineRelativePosition=i,this.showEndForLine=n}equals(e){return!!e&&this.lastLineRelativePosition===e.lastLineRelativePosition&&this.showEndForLine===e.showEndForLine&&dn(this.startLineNumbers,e.startLineNumbers)&&dn(this.endLineNumbers,e.endLineNumbers)}static get Empty(){return new dk([],[],0)}}const Goe=Og("stickyScrollViewLayer",{createHTML:s=>s}),jB="data-sticky-line-index",Qoe="data-sticky-is-line",lnt="data-sticky-is-line-number",Yoe="data-sticky-is-folding-icon";class cnt extends te{constructor(e){super(),this._editor=e,this._foldingIconStore=new ce,this._rootDomNode=document.createElement("div"),this._lineNumbersDomNode=document.createElement("div"),this._linesDomNodeScrollable=document.createElement("div"),this._linesDomNode=document.createElement("div"),this._lineHeight=this._editor.getOption(67),this._renderedStickyLines=[],this._lineNumbers=[],this._lastLineRelativePosition=0,this._minContentWidthInPx=0,this._isOnGlyphMargin=!1,this._lineNumbersDomNode.className="sticky-widget-line-numbers",this._lineNumbersDomNode.setAttribute("role","none"),this._linesDomNode.className="sticky-widget-lines",this._linesDomNode.setAttribute("role","list"),this._linesDomNodeScrollable.className="sticky-widget-lines-scrollable",this._linesDomNodeScrollable.appendChild(this._linesDomNode),this._rootDomNode.className="sticky-widget",this._rootDomNode.classList.toggle("peek",e instanceof hd),this._rootDomNode.appendChild(this._lineNumbersDomNode),this._rootDomNode.appendChild(this._linesDomNodeScrollable);const t=()=>{this._linesDomNode.style.left=this._editor.getOption(116).scrollWithEditor?`-${this._editor.getScrollLeft()}px`:"0px"};this._register(this._editor.onDidChangeConfiguration(i=>{i.hasChanged(116)&&t(),i.hasChanged(67)&&(this._lineHeight=this._editor.getOption(67))})),this._register(this._editor.onDidScrollChange(i=>{i.scrollLeftChanged&&t(),i.scrollWidthChanged&&this._updateWidgetWidth()})),this._register(this._editor.onDidChangeModel(()=>{t(),this._updateWidgetWidth()})),this._register(this._foldingIconStore),t(),this._register(this._editor.onDidLayoutChange(i=>{this._updateWidgetWidth()})),this._updateWidgetWidth()}get lineNumbers(){return this._lineNumbers}get lineNumberCount(){return this._lineNumbers.length}getRenderedStickyLine(e){return this._renderedStickyLines.find(t=>t.lineNumber===e)}getCurrentLines(){return this._lineNumbers}setState(e,t,i){if(i===void 0&&(!this._previousState&&!e||this._previousState&&this._previousState.equals(e)))return;const n=this._isWidgetHeightZero(e),r=n?void 0:e,o=n?0:this._findLineToRebuildWidgetFrom(e,i);this._renderRootNode(r,t,o),this._previousState=e}_isWidgetHeightZero(e){if(!e)return!0;const t=e.startLineNumbers.length*this._lineHeight+e.lastLineRelativePosition;if(t>0){this._lastLineRelativePosition=e.lastLineRelativePosition;const i=[...e.startLineNumbers];e.showEndForLine!==null&&(i[e.showEndForLine]=e.endLineNumbers[e.showEndForLine]),this._lineNumbers=i}else this._lastLineRelativePosition=0,this._lineNumbers=[];return t===0}_findLineToRebuildWidgetFrom(e,t){if(!e||!this._previousState)return 0;if(t!==void 0)return t;const i=this._previousState,n=e.startLineNumbers.findIndex(r=>!i.startLineNumbers.includes(r));return n===-1?0:n}_updateWidgetWidth(){const e=this._editor.getLayoutInfo(),t=e.contentLeft;this._lineNumbersDomNode.style.width=`${t}px`,this._linesDomNodeScrollable.style.setProperty("--vscode-editorStickyScroll-scrollableWidth",`${this._editor.getScrollWidth()-e.verticalScrollbarWidth}px`),this._rootDomNode.style.width=`${e.width-e.verticalScrollbarWidth}px`}_clearStickyLinesFromLine(e){this._foldingIconStore.clear();for(let t=e;t<this._renderedStickyLines.length;t++){const i=this._renderedStickyLines[t];i.lineNumberDomNode.remove(),i.lineDomNode.remove()}this._renderedStickyLines=this._renderedStickyLines.slice(0,e),this._rootDomNode.style.display="none"}_useFoldingOpacityTransition(e){this._lineNumbersDomNode.style.setProperty("--vscode-editorStickyScroll-foldingOpacityTransition",`opacity ${e?.5:0}s`)}_setFoldingIconsVisibility(e){for(const t of this._renderedStickyLines){const i=t.foldingIcon;i&&i.setVisible(e?!0:i.isCollapsed)}}async _renderRootNode(e,t,i){if(this._clearStickyLinesFromLine(i),!e)return;for(const a of this._renderedStickyLines)this._updateTopAndZIndexOfStickyLine(a);const n=this._editor.getLayoutInfo(),r=this._lineNumbers.slice(i);for(const[a,l]of r.entries()){const c=this._renderChildNode(a+i,l,t,n);c&&(this._linesDomNode.appendChild(c.lineDomNode),this._lineNumbersDomNode.appendChild(c.lineNumberDomNode),this._renderedStickyLines.push(c))}t&&(this._setFoldingHoverListeners(),this._useFoldingOpacityTransition(!this._isOnGlyphMargin));const o=this._lineNumbers.length*this._lineHeight+this._lastLineRelativePosition;this._rootDomNode.style.display="block",this._lineNumbersDomNode.style.height=`${o}px`,this._linesDomNodeScrollable.style.height=`${o}px`,this._rootDomNode.style.height=`${o}px`,this._rootDomNode.style.marginLeft="0px",this._minContentWidthInPx=Math.max(...this._renderedStickyLines.map(a=>a.scrollWidth))+n.verticalScrollbarWidth,this._editor.layoutOverlayWidget(this)}_setFoldingHoverListeners(){this._editor.getOption(111)==="mouseover"&&(this._foldingIconStore.add(oe(this._lineNumbersDomNode,Le.MOUSE_ENTER,()=>{this._isOnGlyphMargin=!0,this._setFoldingIconsVisibility(!0)})),this._foldingIconStore.add(oe(this._lineNumbersDomNode,Le.MOUSE_LEAVE,()=>{this._isOnGlyphMargin=!1,this._useFoldingOpacityTransition(!0),this._setFoldingIconsVisibility(!1)})))}_renderChildNode(e,t,i,n){const r=this._editor._getViewModel();if(!r)return;const o=r.coordinatesConverter.convertModelPositionToViewPosition(new X(t,1)).lineNumber,a=r.getViewLineRenderingData(o),l=this._editor.getOption(68);let c;try{c=vo.filter(a.inlineDecorations,o,a.minColumn,a.maxColumn)}catch{c=[]}const d=new w_(!0,!0,a.content,a.continuesWithWrappedLine,a.isBasicASCII,a.containsRTL,0,a.tokens,c,a.tabSize,a.startVisibleColumn,1,1,1,500,"none",!0,!0,null),u=new hS(2e3),h=dD(d,u);let g;Goe?g=Goe.createHTML(u.build()):g=u.build();const p=document.createElement("span");p.setAttribute(jB,String(e)),p.setAttribute(Qoe,""),p.setAttribute("role","listitem"),p.tabIndex=0,p.className="sticky-line-content",p.classList.add(`stickyLine${t}`),p.style.lineHeight=`${this._lineHeight}px`,p.innerHTML=g;const _=document.createElement("span");_.setAttribute(jB,String(e)),_.setAttribute(lnt,""),_.className="sticky-line-number",_.style.lineHeight=`${this._lineHeight}px`;const v=n.contentLeft;_.style.width=`${v}px`;const C=document.createElement("span");l.renderType===1||l.renderType===3&&t%10===0?C.innerText=t.toString():l.renderType===2&&(C.innerText=Math.abs(t-this._editor.getPosition().lineNumber).toString()),C.className="sticky-line-number-inner",C.style.lineHeight=`${this._lineHeight}px`,C.style.width=`${n.lineNumbersWidth}px`,C.style.paddingLeft=`${n.lineNumbersLeft}px`,_.appendChild(C);const y=this._renderFoldingIconForLine(i,t);y&&_.appendChild(y.domNode),this._editor.applyFontInfo(p),this._editor.applyFontInfo(C),_.style.lineHeight=`${this._lineHeight}px`,p.style.lineHeight=`${this._lineHeight}px`,_.style.height=`${this._lineHeight}px`,p.style.height=`${this._lineHeight}px`;const x=new dnt(e,t,p,_,y,h.characterMapping,p.scrollWidth);return this._updateTopAndZIndexOfStickyLine(x)}_updateTopAndZIndexOfStickyLine(e){var d;const t=e.index,i=e.lineDomNode,n=e.lineNumberDomNode,r=t===this._lineNumbers.length-1,o="0",a="1";i.style.zIndex=r?o:a,n.style.zIndex=r?o:a;const l=`${t*this._lineHeight+this._lastLineRelativePosition+((d=e.foldingIcon)!=null&&d.isCollapsed?1:0)}px`,c=`${t*this._lineHeight}px`;return i.style.top=r?l:c,n.style.top=r?l:c,e}_renderFoldingIconForLine(e,t){const i=this._editor.getOption(111);if(!e||i==="never")return;const n=e.regions,r=n.findRange(t),o=n.getStartLineNumber(r);if(!(t===o))return;const l=n.isCollapsed(r),c=new unt(l,o,n.getEndLineNumber(r),this._lineHeight);return c.setVisible(this._isOnGlyphMargin?!0:l||i==="always"),c.domNode.setAttribute(Yoe,""),c}getId(){return"editor.contrib.stickyScrollWidget"}getDomNode(){return this._rootDomNode}getPosition(){return{preference:2,stackOridinal:10}}getMinContentWidthInPx(){return this._minContentWidthInPx}focusLineWithIndex(e){0<=e&&e<this._renderedStickyLines.length&&this._renderedStickyLines[e].lineDomNode.focus()}getEditorPositionFromNode(e){if(!e||e.children.length>0)return null;const t=this._getRenderedStickyLineFromChildDomNode(e);if(!t)return null;const i=yG(t.characterMapping,e,0);return new X(t.lineNumber,i)}getLineNumberFromChildDomNode(e){var t;return((t=this._getRenderedStickyLineFromChildDomNode(e))==null?void 0:t.lineNumber)??null}_getRenderedStickyLineFromChildDomNode(e){const t=this.getLineIndexFromChildDomNode(e);return t===null||t<0||t>=this._renderedStickyLines.length?null:this._renderedStickyLines[t]}getLineIndexFromChildDomNode(e){const t=this._getAttributeValue(e,jB);return t?parseInt(t,10):null}isInStickyLine(e){return this._getAttributeValue(e,Qoe)!==void 0}isInFoldingIconDomNode(e){return this._getAttributeValue(e,Yoe)!==void 0}_getAttributeValue(e,t){for(;e&&e!==this._rootDomNode;){const i=e.getAttribute(t);if(i!==null)return i;e=e.parentElement}}}class dnt{constructor(e,t,i,n,r,o,a){this.index=e,this.lineNumber=t,this.lineDomNode=i,this.lineNumberDomNode=n,this.foldingIcon=r,this.characterMapping=o,this.scrollWidth=a}}class unt{constructor(e,t,i,n){this.isCollapsed=e,this.foldingStartLine=t,this.foldingEndLine=i,this.dimension=n,this.domNode=document.createElement("div"),this.domNode.style.width=`${n}px`,this.domNode.style.height=`${n}px`,this.domNode.className=at.asClassName(e?$P:jP)}setVisible(e){this.domNode.style.cursor=e?"pointer":"default",this.domNode.style.opacity=e?"1":"0"}}class uk{constructor(e,t){this.startLineNumber=e,this.endLineNumber=t}}class vM{constructor(e,t,i){this.range=e,this.children=t,this.parent=i}}class nve{constructor(e,t,i,n){this.uri=e,this.version=t,this.element=i,this.outlineProviderId=n}}var D5=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},vE=function(s,e){return function(t,i){e(t,i,s)}},hk;(function(s){s.OUTLINE_MODEL="outlineModel",s.FOLDING_PROVIDER_MODEL="foldingProviderModel",s.INDENTATION_MODEL="indentationModel"})(hk||(hk={}));var em;(function(s){s[s.VALID=0]="VALID",s[s.INVALID=1]="INVALID",s[s.CANCELED=2]="CANCELED"})(em||(em={}));let Lj=class extends te{constructor(e,t,i,n){switch(super(),this._editor=e,this._modelProviders=[],this._modelPromise=null,this._updateScheduler=this._register(new bc(300)),this._updateOperation=this._register(new ce),this._editor.getOption(116).defaultModel){case hk.OUTLINE_MODEL:this._modelProviders.push(new kj(this._editor,n));case hk.FOLDING_PROVIDER_MODEL:this._modelProviders.push(new Ej(this._editor,t,n));case hk.INDENTATION_MODEL:this._modelProviders.push(new Ij(this._editor,i));break}}dispose(){this._modelProviders.forEach(e=>e.dispose()),this._updateOperation.clear(),this._cancelModelPromise(),super.dispose()}_cancelModelPromise(){this._modelPromise&&(this._modelPromise.cancel(),this._modelPromise=null)}async update(e){return this._updateOperation.clear(),this._updateOperation.add({dispose:()=>{this._cancelModelPromise(),this._updateScheduler.cancel()}}),this._cancelModelPromise(),await this._updateScheduler.trigger(async()=>{for(const t of this._modelProviders){const{statusPromise:i,modelPromise:n}=t.computeStickyModel(e);this._modelPromise=n;const r=await i;if(this._modelPromise!==n)return null;switch(r){case em.CANCELED:return this._updateOperation.clear(),null;case em.VALID:return t.stickyModel}}return null}).catch(t=>(ft(t),null))}};Lj=D5([vE(2,Xe),vE(3,Be)],Lj);class sve extends te{constructor(e){super(),this._editor=e,this._stickyModel=null}get stickyModel(){return this._stickyModel}_invalid(){return this._stickyModel=null,em.INVALID}computeStickyModel(e){if(e.isCancellationRequested||!this.isProviderValid())return{statusPromise:this._invalid(),modelPromise:null};const t=xs(i=>this.createModelFromProvider(i));return{statusPromise:t.then(i=>this.isModelValid(i)?e.isCancellationRequested?em.CANCELED:(this._stickyModel=this.createStickyModel(e,i),em.VALID):this._invalid()).then(void 0,i=>(ft(i),em.CANCELED)),modelPromise:t}}isModelValid(e){return!0}isProviderValid(){return!0}}let kj=class extends sve{constructor(e,t){super(e),this._languageFeaturesService=t}createModelFromProvider(e){return Rf.create(this._languageFeaturesService.documentSymbolProvider,this._editor.getModel(),e)}createStickyModel(e,t){var o;const{stickyOutlineElement:i,providerID:n}=this._stickyModelFromOutlineModel(t,(o=this._stickyModel)==null?void 0:o.outlineProviderId),r=this._editor.getModel();return new nve(r.uri,r.getVersionId(),i,n)}isModelValid(e){return e&&e.children.size>0}_stickyModelFromOutlineModel(e,t){let i;if(Kt.first(e.children.values())instanceof Lbe){const a=Kt.find(e.children.values(),l=>l.id===t);if(a)i=a.children;else{let l="",c=-1,d;for(const[u,h]of e.children.entries()){const g=this._findSumOfRangesOfGroup(h);g>c&&(d=h,c=g,l=h.id)}t=l,i=d.children}}else i=e.children;const n=[],r=Array.from(i.values()).sort((a,l)=>{const c=new uk(a.symbol.range.startLineNumber,a.symbol.range.endLineNumber),d=new uk(l.symbol.range.startLineNumber,l.symbol.range.endLineNumber);return this._comparator(c,d)});for(const a of r)n.push(this._stickyModelFromOutlineElement(a,a.symbol.selectionRange.startLineNumber));return{stickyOutlineElement:new vM(void 0,n,void 0),providerID:t}}_stickyModelFromOutlineElement(e,t){const i=[];for(const r of e.children.values())if(r.symbol.selectionRange.startLineNumber!==r.symbol.range.endLineNumber)if(r.symbol.selectionRange.startLineNumber!==t)i.push(this._stickyModelFromOutlineElement(r,r.symbol.selectionRange.startLineNumber));else for(const o of r.children.values())i.push(this._stickyModelFromOutlineElement(o,r.symbol.selectionRange.startLineNumber));i.sort((r,o)=>this._comparator(r.range,o.range));const n=new uk(e.symbol.selectionRange.startLineNumber,e.symbol.range.endLineNumber);return new vM(n,i,void 0)}_comparator(e,t){return e.startLineNumber!==t.startLineNumber?e.startLineNumber-t.startLineNumber:t.endLineNumber-e.endLineNumber}_findSumOfRangesOfGroup(e){let t=0;for(const i of e.children.values())t+=this._findSumOfRangesOfGroup(i);return e instanceof pU?t+e.symbol.range.endLineNumber-e.symbol.selectionRange.startLineNumber:t}};kj=D5([vE(1,Be)],kj);class rve extends sve{constructor(e){super(e),this._foldingLimitReporter=new ybe(e)}createStickyModel(e,t){const i=this._fromFoldingRegions(t),n=this._editor.getModel();return new nve(n.uri,n.getVersionId(),i,void 0)}isModelValid(e){return e!==null}_fromFoldingRegions(e){const t=e.length,i=[],n=new vM(void 0,[],void 0);for(let r=0;r<t;r++){const o=e.getParentIndex(r);let a;o!==-1?a=i[o]:a=n;const l=new vM(new uk(e.getStartLineNumber(r),e.getEndLineNumber(r)+1),[],a);a.children.push(l),i.push(l)}return n}}let Ij=class extends rve{constructor(e,t){super(e),this._languageConfigurationService=t,this.provider=this._register(new AQ(e.getModel(),this._languageConfigurationService,this._foldingLimitReporter))}async createModelFromProvider(e){return this.provider.compute(e)}};Ij=D5([vE(1,bn)],Ij);let Ej=class extends rve{constructor(e,t,i){super(e),this._languageFeaturesService=i;const n=s_.getFoldingRangeProviders(this._languageFeaturesService,e.getModel());n.length>0&&(this.provider=this._register(new PQ(e.getModel(),n,t,this._foldingLimitReporter,void 0)))}isProviderValid(){return this.provider!==void 0}async createModelFromProvider(e){var t;return((t=this.provider)==null?void 0:t.compute(e))??null}};Ej=D5([vE(2,Be)],Ej);var hnt=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Xoe=function(s,e){return function(t,i){e(t,i,s)}};class fnt{constructor(e,t,i){this.startLineNumber=e,this.endLineNumber=t,this.nestingDepth=i}}let Dj=class extends te{constructor(e,t,i){super(),this._languageFeaturesService=t,this._languageConfigurationService=i,this._onDidChangeStickyScroll=this._register(new Z),this.onDidChangeStickyScroll=this._onDidChangeStickyScroll.event,this._model=null,this._cts=null,this._stickyModelProvider=null,this._editor=e,this._sessionStore=this._register(new ce),this._updateSoon=this._register(new xi(()=>this.update(),50)),this._register(this._editor.onDidChangeConfiguration(n=>{n.hasChanged(116)&&this.readConfiguration()})),this.readConfiguration()}readConfiguration(){this._sessionStore.clear(),this._editor.getOption(116).enabled&&(this._sessionStore.add(this._editor.onDidChangeModel(()=>{this._model=null,this.updateStickyModelProvider(),this._onDidChangeStickyScroll.fire(),this.update()})),this._sessionStore.add(this._editor.onDidChangeHiddenAreas(()=>this.update())),this._sessionStore.add(this._editor.onDidChangeModelContent(()=>this._updateSoon.schedule())),this._sessionStore.add(this._languageFeaturesService.documentSymbolProvider.onDidChange(()=>this.update())),this._sessionStore.add(Ye(()=>{var t;(t=this._stickyModelProvider)==null||t.dispose(),this._stickyModelProvider=null})),this.updateStickyModelProvider(),this.update())}getVersionId(){var e;return(e=this._model)==null?void 0:e.version}updateStickyModelProvider(){var t;(t=this._stickyModelProvider)==null||t.dispose(),this._stickyModelProvider=null;const e=this._editor;e.hasModel()&&(this._stickyModelProvider=new Lj(e,()=>this._updateSoon.schedule(),this._languageConfigurationService,this._languageFeaturesService))}async update(){var e;(e=this._cts)==null||e.dispose(!0),this._cts=new mn,await this.updateStickyModel(this._cts.token),this._onDidChangeStickyScroll.fire()}async updateStickyModel(e){if(!this._editor.hasModel()||!this._stickyModelProvider||this._editor.getModel().isTooLargeForTokenization()){this._model=null;return}const t=await this._stickyModelProvider.update(e);e.isCancellationRequested||(this._model=t)}updateIndex(e){return e===-1?e=0:e<0&&(e=-e-2),e}getCandidateStickyLinesIntersectingFromStickyModel(e,t,i,n,r){if(t.children.length===0)return;let o=r;const a=[];for(let d=0;d<t.children.length;d++){const u=t.children[d];u.range&&a.push(u.range.startLineNumber)}const l=this.updateIndex($k(a,e.startLineNumber,(d,u)=>d-u)),c=this.updateIndex($k(a,e.startLineNumber+n,(d,u)=>d-u));for(let d=l;d<=c;d++){const u=t.children[d];if(!u)return;if(u.range){const h=u.range.startLineNumber,g=u.range.endLineNumber;e.startLineNumber<=g+1&&h-1<=e.endLineNumber&&h!==o&&(o=h,i.push(new fnt(h,g-1,n+1)),this.getCandidateStickyLinesIntersectingFromStickyModel(e,u,i,n+1,h))}else this.getCandidateStickyLinesIntersectingFromStickyModel(e,u,i,n,r)}}getCandidateStickyLinesIntersecting(e){var n,r;if(!((n=this._model)!=null&&n.element))return[];let t=[];this.getCandidateStickyLinesIntersectingFromStickyModel(e,this._model.element,t,0,-1);const i=(r=this._editor._getViewModel())==null?void 0:r.getHiddenAreas();if(i)for(const o of i)t=t.filter(a=>!(a.startLineNumber>=o.startLineNumber&&a.endLineNumber<=o.endLineNumber+1));return t}};Dj=hnt([Xoe(1,Be),Xoe(2,bn)],Dj);var gnt=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},oC=function(s,e){return function(t,i){e(t,i,s)}},Tj,Zv;let Rg=(Zv=class extends te{constructor(e,t,i,n,r,o,a){super(),this._editor=e,this._contextMenuService=t,this._languageFeaturesService=i,this._instaService=n,this._contextKeyService=a,this._sessionStore=new ce,this._maxStickyLines=Number.MAX_SAFE_INTEGER,this._candidateDefinitionsLength=-1,this._focusedStickyElementIndex=-1,this._enabled=!1,this._focused=!1,this._positionRevealed=!1,this._onMouseDown=!1,this._endLineNumbers=[],this._stickyScrollWidget=new cnt(this._editor),this._stickyLineCandidateProvider=new Dj(this._editor,i,r),this._register(this._stickyScrollWidget),this._register(this._stickyLineCandidateProvider),this._widgetState=dk.Empty,this._onDidResize(),this._readConfiguration();const l=this._stickyScrollWidget.getDomNode();this._register(this._editor.onDidChangeConfiguration(d=>{this._readConfigurationChange(d)})),this._register(oe(l,Le.CONTEXT_MENU,async d=>{this._onContextMenu(nt(l),d)})),this._stickyScrollFocusedContextKey=z.stickyScrollFocused.bindTo(this._contextKeyService),this._stickyScrollVisibleContextKey=z.stickyScrollVisible.bindTo(this._contextKeyService);const c=this._register(hu(l));this._register(c.onDidBlur(d=>{this._positionRevealed===!1&&l.clientHeight===0?(this._focusedStickyElementIndex=-1,this.focus()):this._disposeFocusStickyScrollStore()})),this._register(c.onDidFocus(d=>{this.focus()})),this._registerMouseListeners(),this._register(oe(l,Le.MOUSE_DOWN,d=>{this._onMouseDown=!0}))}static get(e){return e.getContribution(Tj.ID)}_disposeFocusStickyScrollStore(){var e;this._stickyScrollFocusedContextKey.set(!1),(e=this._focusDisposableStore)==null||e.dispose(),this._focused=!1,this._positionRevealed=!1,this._onMouseDown=!1}focus(){if(this._onMouseDown){this._onMouseDown=!1,this._editor.focus();return}this._stickyScrollFocusedContextKey.get()!==!0&&(this._focused=!0,this._focusDisposableStore=new ce,this._stickyScrollFocusedContextKey.set(!0),this._focusedStickyElementIndex=this._stickyScrollWidget.lineNumbers.length-1,this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex))}focusNext(){this._focusedStickyElementIndex<this._stickyScrollWidget.lineNumberCount-1&&this._focusNav(!0)}focusPrevious(){this._focusedStickyElementIndex>0&&this._focusNav(!1)}selectEditor(){this._editor.focus()}_focusNav(e){this._focusedStickyElementIndex=e?this._focusedStickyElementIndex+1:this._focusedStickyElementIndex-1,this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex)}goToFocused(){const e=this._stickyScrollWidget.lineNumbers;this._disposeFocusStickyScrollStore(),this._revealPosition({lineNumber:e[this._focusedStickyElementIndex],column:1})}_revealPosition(e){this._reveaInEditor(e,()=>this._editor.revealPosition(e))}_revealLineInCenterIfOutsideViewport(e){this._reveaInEditor(e,()=>this._editor.revealLineInCenterIfOutsideViewport(e.lineNumber,0))}_reveaInEditor(e,t){this._focused&&this._disposeFocusStickyScrollStore(),this._positionRevealed=!0,t(),this._editor.setSelection(F.fromPositions(e)),this._editor.focus()}_registerMouseListeners(){const e=this._register(new ce),t=this._register(new b5(this._editor,{extractLineNumberFromMouseEvent:r=>{const o=this._stickyScrollWidget.getEditorPositionFromNode(r.target.element);return o?o.lineNumber:0}})),i=r=>{if(!this._editor.hasModel()||r.target.type!==12||r.target.detail!==this._stickyScrollWidget.getId())return null;const o=r.target.element;if(!o||o.innerText!==o.innerHTML)return null;const a=this._stickyScrollWidget.getEditorPositionFromNode(o);return a?{range:new F(a.lineNumber,a.column,a.lineNumber,a.column+o.innerText.length),textElement:o}:null},n=this._stickyScrollWidget.getDomNode();this._register(yn(n,Le.CLICK,r=>{if(r.ctrlKey||r.altKey||r.metaKey||!r.leftButton)return;if(r.shiftKey){const c=this._stickyScrollWidget.getLineIndexFromChildDomNode(r.target);if(c===null)return;const d=new X(this._endLineNumbers[c],1);this._revealLineInCenterIfOutsideViewport(d);return}if(this._stickyScrollWidget.isInFoldingIconDomNode(r.target)){const c=this._stickyScrollWidget.getLineNumberFromChildDomNode(r.target);this._toggleFoldingRegionForLine(c);return}if(!this._stickyScrollWidget.isInStickyLine(r.target))return;let l=this._stickyScrollWidget.getEditorPositionFromNode(r.target);if(!l){const c=this._stickyScrollWidget.getLineNumberFromChildDomNode(r.target);if(c===null)return;l=new X(c,1)}this._revealPosition(l)})),this._register(yn(n,Le.MOUSE_MOVE,r=>{if(r.shiftKey){const o=this._stickyScrollWidget.getLineIndexFromChildDomNode(r.target);if(o===null||this._showEndForLine!==null&&this._showEndForLine===o)return;this._showEndForLine=o,this._renderStickyScroll();return}this._showEndForLine!==void 0&&(this._showEndForLine=void 0,this._renderStickyScroll())})),this._register(oe(n,Le.MOUSE_LEAVE,r=>{this._showEndForLine!==void 0&&(this._showEndForLine=void 0,this._renderStickyScroll())})),this._register(t.onMouseMoveOrRelevantKeyDown(([r,o])=>{const a=i(r);if(!a||!r.hasTriggerModifier||!this._editor.hasModel()){e.clear();return}const{range:l,textElement:c}=a;if(!l.equalsRange(this._stickyRangeProjectedOnEditor))this._stickyRangeProjectedOnEditor=l,e.clear();else if(c.style.textDecoration==="underline")return;const d=new mn;e.add(Ye(()=>d.dispose(!0)));let u;wD(this._languageFeaturesService.definitionProvider,this._editor.getModel(),new X(l.startLineNumber,l.startColumn+1),!1,d.token).then(h=>{if(!d.token.isCancellationRequested)if(h.length!==0){this._candidateDefinitionsLength=h.length;const g=c;u!==g?(e.clear(),u=g,u.style.textDecoration="underline",e.add(Ye(()=>{u.style.textDecoration="none"}))):u||(u=g,u.style.textDecoration="underline",e.add(Ye(()=>{u.style.textDecoration="none"})))}else e.clear()})})),this._register(t.onCancel(()=>{e.clear()})),this._register(t.onExecute(async r=>{if(r.target.type!==12||r.target.detail!==this._stickyScrollWidget.getId())return;const o=this._stickyScrollWidget.getEditorPositionFromNode(r.target.element);o&&(!this._editor.hasModel()||!this._stickyRangeProjectedOnEditor||(this._candidateDefinitionsLength>1&&(this._focused&&this._disposeFocusStickyScrollStore(),this._revealPosition({lineNumber:o.lineNumber,column:1})),this._instaService.invokeFunction(rbe,r,this._editor,{uri:this._editor.getModel().uri,range:this._stickyRangeProjectedOnEditor})))}))}_onContextMenu(e,t){const i=new Xc(e,t);this._contextMenuService.showContextMenu({menuId:ze.StickyScrollContext,getAnchor:()=>i})}_toggleFoldingRegionForLine(e){if(!this._foldingModel||e===null)return;const t=this._stickyScrollWidget.getRenderedStickyLine(e),i=t==null?void 0:t.foldingIcon;if(!i)return;TQ(this._foldingModel,Number.MAX_VALUE,[e]),i.isCollapsed=!i.isCollapsed;const n=(i.isCollapsed?this._editor.getTopForLineNumber(i.foldingEndLine):this._editor.getTopForLineNumber(i.foldingStartLine))-this._editor.getOption(67)*t.index+1;this._editor.setScrollTop(n),this._renderStickyScroll(e)}_readConfiguration(){const e=this._editor.getOption(116);if(e.enabled===!1){this._editor.removeOverlayWidget(this._stickyScrollWidget),this._sessionStore.clear(),this._enabled=!1;return}else e.enabled&&!this._enabled&&(this._editor.addOverlayWidget(this._stickyScrollWidget),this._sessionStore.add(this._editor.onDidScrollChange(i=>{i.scrollTopChanged&&(this._showEndForLine=void 0,this._renderStickyScroll())})),this._sessionStore.add(this._editor.onDidLayoutChange(()=>this._onDidResize())),this._sessionStore.add(this._editor.onDidChangeModelTokens(i=>this._onTokensChange(i))),this._sessionStore.add(this._stickyLineCandidateProvider.onDidChangeStickyScroll(()=>{this._showEndForLine=void 0,this._renderStickyScroll()})),this._enabled=!0);this._editor.getOption(68).renderType===2&&this._sessionStore.add(this._editor.onDidChangeCursorPosition(()=>{this._showEndForLine=void 0,this._renderStickyScroll(0)}))}_readConfigurationChange(e){(e.hasChanged(116)||e.hasChanged(73)||e.hasChanged(67)||e.hasChanged(111)||e.hasChanged(68))&&this._readConfiguration(),e.hasChanged(68)&&this._renderStickyScroll(0)}_needsUpdate(e){const t=this._stickyScrollWidget.getCurrentLines();for(const i of t)for(const n of e.ranges)if(i>=n.fromLineNumber&&i<=n.toLineNumber)return!0;return!1}_onTokensChange(e){this._needsUpdate(e)&&this._renderStickyScroll(0)}_onDidResize(){const t=this._editor.getLayoutInfo().height/this._editor.getOption(67);this._maxStickyLines=Math.round(t*.25)}async _renderStickyScroll(e){const t=this._editor.getModel();if(!t||t.isTooLargeForTokenization()){this._resetState();return}const i=this._updateAndGetMinRebuildFromLine(e),n=this._stickyLineCandidateProvider.getVersionId();if(n===void 0||n===t.getVersionId())if(!this._focused)await this._updateState(i);else if(this._focusedStickyElementIndex===-1)await this._updateState(i),this._focusedStickyElementIndex=this._stickyScrollWidget.lineNumberCount-1,this._focusedStickyElementIndex!==-1&&this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex);else{const o=this._stickyScrollWidget.lineNumbers[this._focusedStickyElementIndex];await this._updateState(i),this._stickyScrollWidget.lineNumberCount===0?this._focusedStickyElementIndex=-1:(this._stickyScrollWidget.lineNumbers.includes(o)||(this._focusedStickyElementIndex=this._stickyScrollWidget.lineNumberCount-1),this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex))}}_updateAndGetMinRebuildFromLine(e){if(e!==void 0){const t=this._minRebuildFromLine!==void 0?this._minRebuildFromLine:1/0;this._minRebuildFromLine=Math.min(e,t)}return this._minRebuildFromLine}async _updateState(e){var i;this._minRebuildFromLine=void 0,this._foldingModel=await((i=s_.get(this._editor))==null?void 0:i.getFoldingModel())??void 0,this._widgetState=this.findScrollWidgetState();const t=this._widgetState.startLineNumbers.length>0;this._stickyScrollVisibleContextKey.set(t),this._stickyScrollWidget.setState(this._widgetState,this._foldingModel,e)}async _resetState(){this._minRebuildFromLine=void 0,this._foldingModel=void 0,this._widgetState=dk.Empty,this._stickyScrollVisibleContextKey.set(!1),this._stickyScrollWidget.setState(void 0,void 0)}findScrollWidgetState(){const e=this._editor.getOption(67),t=Math.min(this._maxStickyLines,this._editor.getOption(116).maxLineCount),i=this._editor.getScrollTop();let n=0;const r=[],o=[],a=this._editor.getVisibleRanges();if(a.length!==0){const l=new uk(a[0].startLineNumber,a[a.length-1].endLineNumber),c=this._stickyLineCandidateProvider.getCandidateStickyLinesIntersecting(l);for(const d of c){const u=d.startLineNumber,h=d.endLineNumber,g=d.nestingDepth;if(h-u>0){const p=(g-1)*e,_=g*e,v=this._editor.getBottomForLineNumber(u)-i,C=this._editor.getTopForLineNumber(h)-i,y=this._editor.getBottomForLineNumber(h)-i;if(p>C&&p<=y){r.push(u),o.push(h+1),n=y-_;break}else _>v&&_<=y&&(r.push(u),o.push(h+1));if(r.length===t)break}}}return this._endLineNumbers=o,new dk(r,o,n,this._showEndForLine)}dispose(){super.dispose(),this._sessionStore.dispose()}},Tj=Zv,Zv.ID="store.contrib.stickyScrollController",Zv);Rg=Tj=gnt([oC(1,Ba),oC(2,Be),oC(3,Xe),oC(4,bn),oC(5,Fl),oC(6,ct)],Rg);class pnt extends To{constructor(){super({id:"editor.action.toggleStickyScroll",title:{...dt("toggleEditorStickyScroll","Toggle Editor Sticky Scroll"),mnemonicTitle:b({key:"mitoggleStickyScroll",comment:["&& denotes a mnemonic"]},"&&Toggle Editor Sticky Scroll")},metadata:{description:dt("toggleEditorStickyScroll.description","Toggle/enable the editor sticky scroll which shows the nested scopes at the top of the viewport")},category:ant.View,toggled:{condition:he.equals("config.editor.stickyScroll.enabled",!0),title:b("stickyScroll","Sticky Scroll"),mnemonicTitle:b({key:"miStickyScroll",comment:["&& denotes a mnemonic"]},"&&Sticky Scroll")},menu:[{id:ze.CommandPalette},{id:ze.MenubarAppearanceMenu,group:"4_editor",order:3},{id:ze.StickyScrollContext}]})}async run(e){const t=e.get(At),i=!t.getValue("editor.stickyScroll.enabled");return t.updateValue("editor.stickyScroll.enabled",i)}}const T5=100;class mnt extends vu{constructor(){super({id:"editor.action.focusStickyScroll",title:{...dt("focusStickyScroll","Focus on the editor sticky scroll"),mnemonicTitle:b({key:"mifocusStickyScroll",comment:["&& denotes a mnemonic"]},"&&Focus Sticky Scroll")},precondition:he.and(he.has("config.editor.stickyScroll.enabled"),z.stickyScrollVisible),menu:[{id:ze.CommandPalette}]})}runEditorCommand(e,t){var i;(i=Rg.get(t))==null||i.focus()}}class _nt extends vu{constructor(){super({id:"editor.action.selectNextStickyScrollLine",title:dt("selectNextStickyScrollLine.title","Select the next editor sticky scroll line"),precondition:z.stickyScrollFocused.isEqualTo(!0),keybinding:{weight:T5,primary:18}})}runEditorCommand(e,t){var i;(i=Rg.get(t))==null||i.focusNext()}}class bnt extends vu{constructor(){super({id:"editor.action.selectPreviousStickyScrollLine",title:dt("selectPreviousStickyScrollLine.title","Select the previous sticky scroll line"),precondition:z.stickyScrollFocused.isEqualTo(!0),keybinding:{weight:T5,primary:16}})}runEditorCommand(e,t){var i;(i=Rg.get(t))==null||i.focusPrevious()}}class vnt extends vu{constructor(){super({id:"editor.action.goToFocusedStickyScrollLine",title:dt("goToFocusedStickyScrollLine.title","Go to the focused sticky scroll line"),precondition:z.stickyScrollFocused.isEqualTo(!0),keybinding:{weight:T5,primary:3}})}runEditorCommand(e,t){var i;(i=Rg.get(t))==null||i.goToFocused()}}class wnt extends vu{constructor(){super({id:"editor.action.selectEditor",title:dt("selectEditor.title","Select Editor"),precondition:z.stickyScrollFocused.isEqualTo(!0),keybinding:{weight:T5,primary:9}})}runEditorCommand(e,t){var i;(i=Rg.get(t))==null||i.selectEditor()}}Zt(Rg.ID,Rg,1);Oi(pnt);Oi(mnt);Oi(bnt);Oi(_nt);Oi(vnt);Oi(wnt);var ove=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},bL=function(s,e){return function(t,i){e(t,i,s)}};class Cnt{constructor(e,t,i,n,r,o){this.range=e,this.insertText=t,this.filterText=i,this.additionalTextEdits=n,this.command=r,this.completion=o}}let Nj=class extends qNe{constructor(e,t,i,n,r,o){super(r.disposable),this.model=e,this.line=t,this.word=i,this.completionModel=n,this._suggestMemoryService=o}canBeReused(e,t,i){return this.model===e&&this.line===t&&this.word.word.length>0&&this.word.startColumn===i.startColumn&&this.word.endColumn<i.endColumn&&this.completionModel.getIncompleteProvider().size===0}get items(){const e=[],{items:t}=this.completionModel,i=this._suggestMemoryService.select(this.model,{lineNumber:this.line,column:this.word.endColumn+this.completionModel.lineContext.characterCountDelta},t),n=Kt.slice(t,i),r=Kt.slice(t,0,i);let o=5;for(const a of Kt.concat(n,r)){if(a.score===ou.Default)continue;const l=new F(a.editStart.lineNumber,a.editStart.column,a.editInsertEnd.lineNumber,a.editInsertEnd.column+this.completionModel.lineContext.characterCountDelta),c=a.completion.insertTextRules&&a.completion.insertTextRules&4?{snippet:a.completion.insertText}:a.completion.insertText;e.push(new Cnt(l,c,a.filterTextLow??a.labelLow,a.completion.additionalTextEdits,a.completion.command,a)),o-->=0&&a.resolve(kt.None)}return e}};Nj=ove([bL(5,L5)],Nj);let Rj=class extends te{constructor(e,t,i,n){super(),this._languageFeatureService=e,this._clipboardService=t,this._suggestMemoryService=i,this._editorService=n,this._store.add(e.inlineCompletionsProvider.register("*",this))}async provideInlineCompletions(e,t,i,n){var g;if(i.selectedSuggestionInfo)return;let r;for(const p of this._editorService.listCodeEditors())if(p.getModel()===e){r=p;break}if(!r)return;const o=r.getOption(90);if(UC.isAllOff(o))return;e.tokenization.tokenizeIfCheap(t.lineNumber);const a=e.tokenization.getLineTokens(t.lineNumber),l=a.getStandardTokenType(a.findTokenIndexAtOffset(Math.max(t.column-1-1,0)));if(UC.valueFor(o,l)!=="inline")return;let c=e.getWordAtPosition(t),d;if(c!=null&&c.word||(d=this._getTriggerCharacterInfo(e,t)),!(c!=null&&c.word)&&!d||(c||(c=e.getWordUntilPosition(t)),c.endColumn!==t.column))return;let u;const h=e.getValueInRange(new F(t.lineNumber,1,t.lineNumber,t.column));if(!d&&((g=this._lastResult)!=null&&g.canBeReused(e,t.lineNumber,c))){const p=new Ooe(h,t.column-this._lastResult.word.endColumn);this._lastResult.completionModel.lineContext=p,this._lastResult.acquire(),u=this._lastResult}else{const p=await MQ(this._languageFeatureService.completionProvider,e,t,new dE(void 0,sM.createSuggestFilter(r).itemKind,d==null?void 0:d.providers),d&&{triggerKind:1,triggerCharacter:d.ch},n);let _;p.needsClipboard&&(_=await this._clipboardService.readText());const v=new Vp(p.items,t.column,new Ooe(h,0),nM.None,r.getOption(119),r.getOption(113),{boostFullMatch:!1,firstMatchCanBeWeak:!1},_);u=new Nj(e,t.lineNumber,c,v,p,this._suggestMemoryService)}return this._lastResult=u,u}handleItemDidShow(e,t){t.completion.resolve(kt.None)}freeInlineCompletions(e){e.release()}_getTriggerCharacterInfo(e,t){var r;const i=e.getValueInRange(F.fromPositions({lineNumber:t.lineNumber,column:t.column-1},t)),n=new Set;for(const o of this._languageFeatureService.completionProvider.all(e))(r=o.triggerCharacters)!=null&&r.includes(i)&&n.add(o);if(n.size!==0)return{providers:n,ch:i}}};Rj=ove([bL(0,Be),bL(1,Wg),bL(2,L5),bL(3,ni)],Rj);LS(Rj);class ynt extends Ve{constructor(){super({id:"editor.action.forceRetokenize",label:b("forceRetokenize","Developer: Force Retokenize"),alias:"Developer: Force Retokenize",precondition:void 0})}run(e,t){if(!t.hasModel())return;const i=t.getModel();i.tokenization.resetTokenization();const n=new Bs;i.tokenization.forceTokenization(i.getLineCount()),n.stop(),console.log(`tokenization took ${n.elapsed()}`)}}ye(ynt);const JO=class JO extends To{constructor(){super({id:JO.ID,title:dt({key:"toggle.tabMovesFocus",comment:["Turn on/off use of tab key for moving focus around VS Code"]},"Toggle Tab Key Moves Focus"),precondition:void 0,keybinding:{primary:2091,mac:{primary:1323},weight:100},metadata:{description:dt("tabMovesFocusDescriptions","Determines whether the tab key moves focus around the workbench or inserts the tab character in the current editor. This is also called tab trapping, tab navigation, or tab focus mode.")},f1:!0})}run(){const t=!R1.getTabFocusMode();R1.setTabFocusMode(t),Eo(t?b("toggle.tabMovesFocus.on","Pressing Tab will now move focus to the next focusable element"):b("toggle.tabMovesFocus.off","Pressing Tab will now insert the tab character"))}};JO.ID="editor.action.toggleTabFocusMode";let Aj=JO;Oi(Aj);var Snt=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Zoe=function(s,e){return function(t,i){e(t,i,s)}};let Pj=class extends te{get enabled(){return this._enabled}set enabled(e){e?(this.el.setAttribute("aria-disabled","false"),this.el.tabIndex=0,this.el.style.pointerEvents="auto",this.el.style.opacity="1",this.el.style.cursor="pointer",this._enabled=!1):(this.el.setAttribute("aria-disabled","true"),this.el.tabIndex=-1,this.el.style.pointerEvents="none",this.el.style.opacity="0.4",this.el.style.cursor="default",this._enabled=!0),this._enabled=e}constructor(e,t,i={},n,r){super(),this._link=t,this._hoverService=n,this._enabled=!0,this.el=me(e,ke("a.monaco-link",{tabIndex:t.tabIndex??0,href:t.href},t.label)),this.hoverDelegate=i.hoverDelegate??No("mouse"),this.setTooltip(t.title),this.el.setAttribute("role","button");const o=this._register(new Ut(this.el,"click")),a=this._register(new Ut(this.el,"keypress")),l=De.chain(a.event,u=>u.map(h=>new Mi(h)).filter(h=>h.keyCode===3)),c=this._register(new Ut(this.el,Vi.Tap)).event;this._register(Er.addTarget(this.el));const d=De.any(o.event,l,c);this._register(d(u=>{this.enabled&&(jt.stop(u,!0),i!=null&&i.opener?i.opener(this._link.href):r.open(this._link.href,{allowCommands:!0}))})),this.enabled=!0}setTooltip(e){this.hoverDelegate.showNativeHover?this.el.title=e??"":!this.hover&&e?this.hover=this._register(this._hoverService.setupManagedHover(this.hoverDelegate,this.el,e)):this.hover&&this.hover.update(e)}};Pj=Snt([Zoe(3,Kh),Zoe(4,la)],Pj);var ave=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},lve=function(s,e){return function(t,i){e(t,i,s)}};const xnt=26;let Mj=class extends te{constructor(e,t){super(),this._editor=e,this.instantiationService=t,this.banner=this._register(this.instantiationService.createInstance(Oj))}hide(){this._editor.setBanner(null,0),this.banner.clear()}show(e){this.banner.show({...e,onClose:()=>{var t;this.hide(),(t=e.onClose)==null||t.call(e)}}),this._editor.setBanner(this.banner.element,xnt)}};Mj=ave([lve(1,Xe)],Mj);let Oj=class extends te{constructor(e){super(),this.instantiationService=e,this.markdownRenderer=this.instantiationService.createInstance(kg,{}),this.element=ke("div.editor-banner"),this.element.tabIndex=0}getAriaLabel(e){if(e.ariaLabel)return e.ariaLabel;if(typeof e.message=="string")return e.message}getBannerMessage(e){if(typeof e=="string"){const t=ke("span");return t.innerText=e,t}return this.markdownRenderer.render(e).element}clear(){Ys(this.element)}show(e){Ys(this.element);const t=this.getAriaLabel(e);t&&this.element.setAttribute("aria-label",t);const i=me(this.element,ke("div.icon-container"));i.setAttribute("aria-hidden","true"),e.icon&&i.appendChild(ke(`div${at.asCSSSelector(e.icon)}`));const n=me(this.element,ke("div.message-container"));if(n.setAttribute("aria-hidden","true"),n.appendChild(this.getBannerMessage(e.message)),this.messageActionsContainer=me(this.element,ke("div.message-actions-container")),e.actions)for(const o of e.actions)this._register(this.instantiationService.createInstance(Pj,this.messageActionsContainer,{...o,tabIndex:-1},{}));const r=me(this.element,ke("div.action-container"));this.actionBar=this._register(new Dl(r)),this.actionBar.push(this._register(new Na("banner.close","Close Banner",at.asClassName(Dpe),!0,()=>{typeof e.onClose=="function"&&e.onClose()})),{icon:!0,label:!1}),this.actionBar.setFocusable(!1)}};Oj=ave([lve(0,Xe)],Oj);var QQ=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Vy=function(s,e){return function(t,i){e(t,i,s)}};const Lnt=Qi("extensions-warning-message",xe.warning,b("warningIcon","Icon shown with a warning message in the extensions editor."));var Qy;let wE=(Qy=class extends te{constructor(e,t,i,n){super(),this._editor=e,this._editorWorkerService=t,this._workspaceTrustService=i,this._highlighter=null,this._bannerClosed=!1,this._updateState=r=>{if(r&&r.hasMore){if(this._bannerClosed)return;const o=Math.max(r.ambiguousCharacterCount,r.nonBasicAsciiCharacterCount,r.invisibleCharacterCount);let a;if(r.nonBasicAsciiCharacterCount>=o)a={message:b("unicodeHighlighting.thisDocumentHasManyNonBasicAsciiUnicodeCharacters","This document contains many non-basic ASCII unicode characters"),command:new yE};else if(r.ambiguousCharacterCount>=o)a={message:b("unicodeHighlighting.thisDocumentHasManyAmbiguousUnicodeCharacters","This document contains many ambiguous unicode characters"),command:new Pw};else if(r.invisibleCharacterCount>=o)a={message:b("unicodeHighlighting.thisDocumentHasManyInvisibleUnicodeCharacters","This document contains many invisible unicode characters"),command:new CE};else throw new Error("Unreachable");this._bannerController.show({id:"unicodeHighlightBanner",message:a.message,icon:Lnt,actions:[{label:a.command.shortLabel,href:`command:${a.command.id}`}],onClose:()=>{this._bannerClosed=!0}})}else this._bannerController.hide()},this._bannerController=this._register(n.createInstance(Mj,e)),this._register(this._editor.onDidChangeModel(()=>{this._bannerClosed=!1,this._updateHighlighter()})),this._options=e.getOption(126),this._register(i.onDidChangeTrust(r=>{this._updateHighlighter()})),this._register(e.onDidChangeConfiguration(r=>{r.hasChanged(126)&&(this._options=e.getOption(126),this._updateHighlighter())})),this._updateHighlighter()}dispose(){this._highlighter&&(this._highlighter.dispose(),this._highlighter=null),super.dispose()}_updateHighlighter(){if(this._updateState(null),this._highlighter&&(this._highlighter.dispose(),this._highlighter=null),!this._editor.hasModel())return;const e=knt(this._workspaceTrustService.isWorkspaceTrusted(),this._options);if([e.nonBasicASCII,e.ambiguousCharacters,e.invisibleCharacters].every(i=>i===!1))return;const t={nonBasicASCII:e.nonBasicASCII,ambiguousCharacters:e.ambiguousCharacters,invisibleCharacters:e.invisibleCharacters,includeComments:e.includeComments,includeStrings:e.includeStrings,allowedCodePoints:Object.keys(e.allowedCharacters).map(i=>i.codePointAt(0)),allowedLocales:Object.keys(e.allowedLocales).map(i=>i==="_os"?new Intl.NumberFormat().resolvedOptions().locale:i==="_vscode"?jTe:i)};this._editorWorkerService.canComputeUnicodeHighlights(this._editor.getModel().uri)?this._highlighter=new Fj(this._editor,t,this._updateState,this._editorWorkerService):this._highlighter=new Int(this._editor,t,this._updateState)}getDecorationInfo(e){return this._highlighter?this._highlighter.getDecorationInfo(e):null}},Qy.ID="editor.contrib.unicodeHighlighter",Qy);wE=QQ([Vy(1,ca),Vy(2,$fe),Vy(3,Xe)],wE);function knt(s,e){return{nonBasicASCII:e.nonBasicASCII===al?!s:e.nonBasicASCII,ambiguousCharacters:e.ambiguousCharacters,invisibleCharacters:e.invisibleCharacters,includeComments:e.includeComments===al?!s:e.includeComments,includeStrings:e.includeStrings===al?!s:e.includeStrings,allowedCharacters:e.allowedCharacters,allowedLocales:e.allowedLocales}}let Fj=class extends te{constructor(e,t,i,n){super(),this._editor=e,this._options=t,this._updateState=i,this._editorWorkerService=n,this._model=this._editor.getModel(),this._decorations=this._editor.createDecorationsCollection(),this._updateSoon=this._register(new xi(()=>this._update(),250)),this._register(this._editor.onDidChangeModelContent(()=>{this._updateSoon.schedule()})),this._updateSoon.schedule()}dispose(){this._decorations.clear(),super.dispose()}_update(){if(this._model.isDisposed())return;if(!this._model.mightContainNonBasicASCII()){this._decorations.clear();return}const e=this._model.getVersionId();this._editorWorkerService.computedUnicodeHighlights(this._model.uri,this._options).then(t=>{if(this._model.isDisposed()||this._model.getVersionId()!==e)return;this._updateState(t);const i=[];if(!t.hasMore)for(const n of t.ranges)i.push({range:n,options:wM.instance.getDecorationFromOptions(this._options)});this._decorations.set(i)})}getDecorationInfo(e){if(!this._decorations.has(e))return null;const t=this._editor.getModel();if(!FG(t,e))return null;const i=t.getValueInRange(e.range);return{reason:dve(i,this._options),inComment:VG(t,e),inString:BG(t,e)}}};Fj=QQ([Vy(3,ca)],Fj);class Int extends te{constructor(e,t,i){super(),this._editor=e,this._options=t,this._updateState=i,this._model=this._editor.getModel(),this._decorations=this._editor.createDecorationsCollection(),this._updateSoon=this._register(new xi(()=>this._update(),250)),this._register(this._editor.onDidLayoutChange(()=>{this._updateSoon.schedule()})),this._register(this._editor.onDidScrollChange(()=>{this._updateSoon.schedule()})),this._register(this._editor.onDidChangeHiddenAreas(()=>{this._updateSoon.schedule()})),this._register(this._editor.onDidChangeModelContent(()=>{this._updateSoon.schedule()})),this._updateSoon.schedule()}dispose(){this._decorations.clear(),super.dispose()}_update(){if(this._model.isDisposed())return;if(!this._model.mightContainNonBasicASCII()){this._decorations.clear();return}const e=this._editor.getVisibleRanges(),t=[],i={ranges:[],ambiguousCharacterCount:0,invisibleCharacterCount:0,nonBasicAsciiCharacterCount:0,hasMore:!1};for(const n of e){const r=Yq.computeUnicodeHighlights(this._model,this._options,n);for(const o of r.ranges)i.ranges.push(o);i.ambiguousCharacterCount+=i.ambiguousCharacterCount,i.invisibleCharacterCount+=i.invisibleCharacterCount,i.nonBasicAsciiCharacterCount+=i.nonBasicAsciiCharacterCount,i.hasMore=i.hasMore||r.hasMore}if(!i.hasMore)for(const n of i.ranges)t.push({range:n,options:wM.instance.getDecorationFromOptions(this._options)});this._updateState(i),this._decorations.set(t)}getDecorationInfo(e){if(!this._decorations.has(e))return null;const t=this._editor.getModel(),i=t.getValueInRange(e.range);return FG(t,e)?{reason:dve(i,this._options),inComment:VG(t,e),inString:BG(t,e)}:null}}const cve=b("unicodeHighlight.configureUnicodeHighlightOptions","Configure Unicode Highlight Options");let Vj=class{constructor(e,t,i){this._editor=e,this._languageService=t,this._openerService=i,this.hoverOrdinal=5}computeSync(e,t){if(!this._editor.hasModel()||e.type!==1)return[];const i=this._editor.getModel(),n=this._editor.getContribution(wE.ID);if(!n)return[];const r=[],o=new Set;let a=300;for(const l of t){const c=n.getDecorationInfo(l);if(!c)continue;const u=i.getValueInRange(l.range).codePointAt(0),h=$B(u);let g;switch(c.reason.kind){case 0:{zE(c.reason.confusableWith)?g=b("unicodeHighlight.characterIsAmbiguousASCII","The character {0} could be confused with the ASCII character {1}, which is more common in source code.",h,$B(c.reason.confusableWith.codePointAt(0))):g=b("unicodeHighlight.characterIsAmbiguous","The character {0} could be confused with the character {1}, which is more common in source code.",h,$B(c.reason.confusableWith.codePointAt(0)));break}case 1:g=b("unicodeHighlight.characterIsInvisible","The character {0} is invisible.",h);break;case 2:g=b("unicodeHighlight.characterIsNonBasicAscii","The character {0} is not a basic ASCII character.",h);break}if(o.has(g))continue;o.add(g);const p={codePoint:u,reason:c.reason,inComment:c.inComment,inString:c.inString},_=b("unicodeHighlight.adjustSettings","Adjust settings"),v=`command:${CM.ID}?${encodeURIComponent(JSON.stringify(p))}`,C=new Lr("",!0).appendMarkdown(g).appendText(" ").appendLink(v,_,cve);r.push(new Yc(this,l.range,[C],!1,a++))}return r}renderHoverParts(e,t){return eYe(e,t,this._editor,this._languageService,this._openerService)}};Vj=QQ([Vy(1,un),Vy(2,la)],Vj);function Bj(s){return`U+${s.toString(16).padStart(4,"0")}`}function $B(s){let e=`\`${Bj(s)}\``;return Gb.isInvisibleCharacter(s)||(e+=` "${`${Ent(s)}`}"`),e}function Ent(s){return s===96?"`` ` ``":"`"+String.fromCodePoint(s)+"`"}function dve(s,e){return Yq.computeUnicodeHighlightReason(s,e)}const e4=class e4{constructor(){this.map=new Map}getDecorationFromOptions(e){return this.getDecoration(!e.includeComments,!e.includeStrings)}getDecoration(e,t){const i=`${e}${t}`;let n=this.map.get(i);return n||(n=_t.createDynamic({description:"unicode-highlight",stickiness:1,className:"unicode-highlight",showIfCollapsed:!0,overviewRuler:null,minimap:null,hideInCommentTokens:e,hideInStringTokens:t}),this.map.set(i,n)),n}};e4.instance=new e4;let wM=e4;class Dnt extends Ve{constructor(){super({id:Pw.ID,label:b("action.unicodeHighlight.disableHighlightingInComments","Disable highlighting of characters in comments"),alias:"Disable highlighting of characters in comments",precondition:void 0}),this.shortLabel=b("unicodeHighlight.disableHighlightingInComments.shortLabel","Disable Highlight In Comments")}async run(e,t,i){const n=e==null?void 0:e.get(At);n&&this.runAction(n)}async runAction(e){await e.updateValue($o.includeComments,!1,2)}}class Tnt extends Ve{constructor(){super({id:Pw.ID,label:b("action.unicodeHighlight.disableHighlightingInStrings","Disable highlighting of characters in strings"),alias:"Disable highlighting of characters in strings",precondition:void 0}),this.shortLabel=b("unicodeHighlight.disableHighlightingInStrings.shortLabel","Disable Highlight In Strings")}async run(e,t,i){const n=e==null?void 0:e.get(At);n&&this.runAction(n)}async runAction(e){await e.updateValue($o.includeStrings,!1,2)}}const t4=class t4 extends Ve{constructor(){super({id:t4.ID,label:b("action.unicodeHighlight.disableHighlightingOfAmbiguousCharacters","Disable highlighting of ambiguous characters"),alias:"Disable highlighting of ambiguous characters",precondition:void 0}),this.shortLabel=b("unicodeHighlight.disableHighlightingOfAmbiguousCharacters.shortLabel","Disable Ambiguous Highlight")}async run(e,t,i){const n=e==null?void 0:e.get(At);n&&this.runAction(n)}async runAction(e){await e.updateValue($o.ambiguousCharacters,!1,2)}};t4.ID="editor.action.unicodeHighlight.disableHighlightingOfAmbiguousCharacters";let Pw=t4;const i4=class i4 extends Ve{constructor(){super({id:i4.ID,label:b("action.unicodeHighlight.disableHighlightingOfInvisibleCharacters","Disable highlighting of invisible characters"),alias:"Disable highlighting of invisible characters",precondition:void 0}),this.shortLabel=b("unicodeHighlight.disableHighlightingOfInvisibleCharacters.shortLabel","Disable Invisible Highlight")}async run(e,t,i){const n=e==null?void 0:e.get(At);n&&this.runAction(n)}async runAction(e){await e.updateValue($o.invisibleCharacters,!1,2)}};i4.ID="editor.action.unicodeHighlight.disableHighlightingOfInvisibleCharacters";let CE=i4;const n4=class n4 extends Ve{constructor(){super({id:n4.ID,label:b("action.unicodeHighlight.disableHighlightingOfNonBasicAsciiCharacters","Disable highlighting of non basic ASCII characters"),alias:"Disable highlighting of non basic ASCII characters",precondition:void 0}),this.shortLabel=b("unicodeHighlight.disableHighlightingOfNonBasicAsciiCharacters.shortLabel","Disable Non ASCII Highlight")}async run(e,t,i){const n=e==null?void 0:e.get(At);n&&this.runAction(n)}async runAction(e){await e.updateValue($o.nonBasicASCII,!1,2)}};n4.ID="editor.action.unicodeHighlight.disableHighlightingOfNonBasicAsciiCharacters";let yE=n4;const s4=class s4 extends Ve{constructor(){super({id:s4.ID,label:b("action.unicodeHighlight.showExcludeOptions","Show Exclude Options"),alias:"Show Exclude Options",precondition:void 0})}async run(e,t,i){const{codePoint:n,reason:r,inString:o,inComment:a}=i,l=String.fromCodePoint(n),c=e.get(kc),d=e.get(At);function u(p){return Gb.isInvisibleCharacter(p)?b("unicodeHighlight.excludeInvisibleCharFromBeingHighlighted","Exclude {0} (invisible character) from being highlighted",Bj(p)):b("unicodeHighlight.excludeCharFromBeingHighlighted","Exclude {0} from being highlighted",`${Bj(p)} "${l}"`)}const h=[];if(r.kind===0)for(const p of r.notAmbiguousInLocales)h.push({label:b("unicodeHighlight.allowCommonCharactersInLanguage",'Allow unicode characters that are more common in the language "{0}".',p),run:async()=>{Rnt(d,[p])}});if(h.push({label:u(n),run:()=>Nnt(d,[n])}),a){const p=new Dnt;h.push({label:p.label,run:async()=>p.runAction(d)})}else if(o){const p=new Tnt;h.push({label:p.label,run:async()=>p.runAction(d)})}if(r.kind===0){const p=new Pw;h.push({label:p.label,run:async()=>p.runAction(d)})}else if(r.kind===1){const p=new CE;h.push({label:p.label,run:async()=>p.runAction(d)})}else if(r.kind===2){const p=new yE;h.push({label:p.label,run:async()=>p.runAction(d)})}else Ant(r);const g=await c.pick(h,{title:cve});g&&await g.run()}};s4.ID="editor.action.unicodeHighlight.showExcludeOptions";let CM=s4;async function Nnt(s,e){const t=s.getValue($o.allowedCharacters);let i;typeof t=="object"&&t?i=t:i={};for(const n of e)i[String.fromCodePoint(n)]=!0;await s.updateValue($o.allowedCharacters,i,2)}async function Rnt(s,e){var n;const t=(n=s.inspect($o.allowedLocales).user)==null?void 0:n.value;let i;typeof t=="object"&&t?i=Object.assign({},t):i={};for(const r of e)i[r]=!0;await s.updateValue($o.allowedLocales,i,2)}function Ant(s){throw new Error(`Unexpected value: ${s}`)}ye(Pw);ye(CE);ye(yE);ye(CM);Zt(wE.ID,wE,1);n0.register(Vj);var Pnt=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Joe=function(s,e){return function(t,i){e(t,i,s)}};const uve="ignoreUnusualLineTerminators";function Mnt(s,e,t){s.setModelProperty(e.uri,uve,t)}function Ont(s,e){return s.getModelProperty(e.uri,uve)}var Yy;let yM=(Yy=class extends te{constructor(e,t,i){super(),this._editor=e,this._dialogService=t,this._codeEditorService=i,this._isPresentingDialog=!1,this._config=this._editor.getOption(127),this._register(this._editor.onDidChangeConfiguration(n=>{n.hasChanged(127)&&(this._config=this._editor.getOption(127),this._checkForUnusualLineTerminators())})),this._register(this._editor.onDidChangeModel(()=>{this._checkForUnusualLineTerminators()})),this._register(this._editor.onDidChangeModelContent(n=>{n.isUndoing||this._checkForUnusualLineTerminators()})),this._checkForUnusualLineTerminators()}async _checkForUnusualLineTerminators(){if(this._config==="off"||!this._editor.hasModel())return;const e=this._editor.getModel();if(!e.mightContainUnusualLineTerminators()||Ont(this._codeEditorService,e)===!0||this._editor.getOption(92))return;if(this._config==="auto"){e.removeUnusualLineTerminators(this._editor.getSelections());return}if(this._isPresentingDialog)return;let i;try{this._isPresentingDialog=!0,i=await this._dialogService.confirm({title:b("unusualLineTerminators.title","Unusual Line Terminators"),message:b("unusualLineTerminators.message","Detected unusual line terminators"),detail:b("unusualLineTerminators.detail","The file '{0}' contains one or more unusual line terminator characters, like Line Separator (LS) or Paragraph Separator (PS).\n\nIt is recommended to remove them from the file. This can be configured via `editor.unusualLineTerminators`.",Cc(e.uri)),primaryButton:b({key:"unusualLineTerminators.fix",comment:["&& denotes a mnemonic"]},"&&Remove Unusual Line Terminators"),cancelButton:b("unusualLineTerminators.ignore","Ignore")})}finally{this._isPresentingDialog=!1}if(!i.confirmed){Mnt(this._codeEditorService,e,!0);return}e.removeUnusualLineTerminators(this._editor.getSelections())}},Yy.ID="editor.contrib.unusualLineTerminatorsDetector",Yy);yM=Pnt([Joe(1,KE),Joe(2,ni)],yM);Zt(yM.ID,yM,1);var Fnt=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Vnt=function(s,e){return function(t,i){e(t,i,s)}};class eae{constructor(){this.selector={language:"*"}}provideDocumentHighlights(e,t,i){const n=[],r=e.getWordAtPosition({lineNumber:t.lineNumber,column:t.column});return r?e.isDisposed()?void 0:e.findMatches(r.word,!0,!1,!0,T2,!1).map(a=>({range:a.range,kind:u1.Text})):Promise.resolve(n)}provideMultiDocumentHighlights(e,t,i,n){const r=new Fs,o=e.getWordAtPosition({lineNumber:t.lineNumber,column:t.column});if(!o)return Promise.resolve(r);for(const a of[e,...i]){if(a.isDisposed())continue;const c=a.findMatches(o.word,!0,!1,!0,T2,!1).map(d=>({range:d.range,kind:u1.Text}));c&&r.set(a.uri,c)}return r}}let Wj=class extends te{constructor(e){super(),this._register(e.documentHighlightProvider.register("*",new eae)),this._register(e.multiDocumentHighlightProvider.register("*",new eae))}};Wj=Fnt([Vnt(0,Be)],Wj);var hve=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},s2=function(s,e){return function(t,i){e(t,i,s)}},Vn,Hj;const YQ=new Oe("hasWordHighlights",!1);function fve(s,e,t,i){const n=s.ordered(e);return Oq(n.map(r=>()=>Promise.resolve(r.provideDocumentHighlights(e,t,i)).then(void 0,Mn)),r=>r!=null).then(r=>{if(r){const o=new Fs;return o.set(e.uri,r),o}return new Fs})}function Bnt(s,e,t,i,n,r){const o=s.ordered(e);return Oq(o.map(a=>()=>{const l=r.filter(c=>Nhe(c)).filter(c=>rK(a.selector,c.uri,c.getLanguageId(),!0,void 0,void 0)>0);return Promise.resolve(a.provideMultiDocumentHighlights(e,t,l,n)).then(void 0,Mn)}),a=>a!=null)}class gve{constructor(e,t,i){this._model=e,this._selection=t,this._wordSeparators=i,this._wordRange=this._getCurrentWordRange(e,t),this._result=null}get result(){return this._result||(this._result=xs(e=>this._compute(this._model,this._selection,this._wordSeparators,e))),this._result}_getCurrentWordRange(e,t){const i=e.getWordAtPosition(t.getPosition());return i?new F(t.startLineNumber,i.startColumn,t.startLineNumber,i.endColumn):null}isValid(e,t,i){const n=t.startLineNumber,r=t.startColumn,o=t.endColumn,a=this._getCurrentWordRange(e,t);let l=!!(this._wordRange&&this._wordRange.equalsRange(a));for(let c=0,d=i.length;!l&&c<d;c++){const u=i.getRange(c);u&&u.startLineNumber===n&&u.startColumn<=r&&u.endColumn>=o&&(l=!0)}return l}cancel(){this.result.cancel()}}class Wnt extends gve{constructor(e,t,i,n){super(e,t,i),this._providers=n}_compute(e,t,i,n){return fve(this._providers,e,t.getPosition(),n).then(r=>r||new Fs)}}class Hnt extends gve{constructor(e,t,i,n,r){super(e,t,i),this._providers=n,this._otherModels=r}_compute(e,t,i,n){return Bnt(this._providers,e,t.getPosition(),i,n,this._otherModels).then(r=>r||new Fs)}}function znt(s,e,t,i,n){return new Wnt(e,t,n,s)}function Unt(s,e,t,i,n,r){return new Hnt(e,t,n,s,r)}aa("_executeDocumentHighlights",async(s,e,t)=>{const i=s.get(Be),n=await fve(i.documentHighlightProvider,e,t,kt.None);return n==null?void 0:n.get(e.uri)});var Nm;let zj=(Nm=class{constructor(e,t,i,n,r){this.toUnhook=new ce,this.workerRequestTokenId=0,this.workerRequestCompleted=!1,this.workerRequestValue=new Fs,this.lastCursorPositionChangeTime=0,this.renderDecorationsTimer=-1,this.runDelayer=this.toUnhook.add(new bc(50)),this.editor=e,this.providers=t,this.multiDocumentProviders=i,this.codeEditorService=r,this._hasWordHighlights=YQ.bindTo(n),this._ignorePositionChangeEvent=!1,this.occurrencesHighlight=this.editor.getOption(81),this.model=this.editor.getModel(),this.toUnhook.add(e.onDidChangeCursorPosition(o=>{this._ignorePositionChangeEvent||this.occurrencesHighlight!=="off"&&this.runDelayer.trigger(()=>{this._onPositionChanged(o)})})),this.toUnhook.add(e.onDidFocusEditorText(o=>{this.occurrencesHighlight!=="off"&&(this.workerRequest||this.runDelayer.trigger(()=>{this._run()}))})),this.toUnhook.add(e.onDidChangeModelContent(o=>{J4(this.model.uri,"output")||this._stopAll()})),this.toUnhook.add(e.onDidChangeModel(o=>{!o.newModelUrl&&o.oldModelUrl?this._stopSingular():Vn.query&&this._run()})),this.toUnhook.add(e.onDidChangeConfiguration(o=>{var l,c;const a=this.editor.getOption(81);if(this.occurrencesHighlight!==a)switch(this.occurrencesHighlight=a,a){case"off":this._stopAll();break;case"singleFile":this._stopAll((c=(l=Vn.query)==null?void 0:l.modelInfo)==null?void 0:c.model);break;case"multiFile":Vn.query&&this._run(!0);break;default:console.warn("Unknown occurrencesHighlight setting value:",a);break}})),this.decorations=this.editor.createDecorationsCollection(),this.workerRequestTokenId=0,this.workerRequest=null,this.workerRequestCompleted=!1,this.lastCursorPositionChangeTime=0,this.renderDecorationsTimer=-1,Vn.query&&this._run()}hasDecorations(){return this.decorations.length>0}restore(){this.occurrencesHighlight!=="off"&&(this.runDelayer.cancel(),this._run())}_getSortedHighlights(){return this.decorations.getRanges().sort(F.compareRangesUsingStarts)}moveNext(){const e=this._getSortedHighlights(),i=(e.findIndex(r=>r.containsPosition(this.editor.getPosition()))+1)%e.length,n=e[i];try{this._ignorePositionChangeEvent=!0,this.editor.setPosition(n.getStartPosition()),this.editor.revealRangeInCenterIfOutsideViewport(n);const r=this._getWord();if(r){const o=this.editor.getModel().getLineContent(n.startLineNumber);Eo(`${o}, ${i+1} of ${e.length} for '${r.word}'`)}}finally{this._ignorePositionChangeEvent=!1}}moveBack(){const e=this._getSortedHighlights(),i=(e.findIndex(r=>r.containsPosition(this.editor.getPosition()))-1+e.length)%e.length,n=e[i];try{this._ignorePositionChangeEvent=!0,this.editor.setPosition(n.getStartPosition()),this.editor.revealRangeInCenterIfOutsideViewport(n);const r=this._getWord();if(r){const o=this.editor.getModel().getLineContent(n.startLineNumber);Eo(`${o}, ${i+1} of ${e.length} for '${r.word}'`)}}finally{this._ignorePositionChangeEvent=!1}}_removeSingleDecorations(){if(!this.editor.hasModel())return;const e=Vn.storedDecorationIDs.get(this.editor.getModel().uri);e&&(this.editor.removeDecorations(e),Vn.storedDecorationIDs.delete(this.editor.getModel().uri),this.decorations.length>0&&(this.decorations.clear(),this._hasWordHighlights.set(!1)))}_removeAllDecorations(e){const t=this.codeEditorService.listCodeEditors(),i=[];for(const n of t){if(!n.hasModel()||wI(n.getModel().uri,e==null?void 0:e.uri))continue;const r=Vn.storedDecorationIDs.get(n.getModel().uri);if(!r)continue;n.removeDecorations(r),i.push(n.getModel().uri);const o=o_.get(n);o!=null&&o.wordHighlighter&&o.wordHighlighter.decorations.length>0&&(o.wordHighlighter.decorations.clear(),o.wordHighlighter.workerRequest=null,o.wordHighlighter._hasWordHighlights.set(!1))}for(const n of i)Vn.storedDecorationIDs.delete(n)}_stopSingular(){var e,t,i,n;this._removeSingleDecorations(),this.editor.hasTextFocus()&&(((e=this.editor.getModel())==null?void 0:e.uri.scheme)!==gt.vscodeNotebookCell&&((i=(t=Vn.query)==null?void 0:t.modelInfo)==null?void 0:i.model.uri.scheme)!==gt.vscodeNotebookCell?(Vn.query=null,this._run()):(n=Vn.query)!=null&&n.modelInfo&&(Vn.query.modelInfo=null)),this.renderDecorationsTimer!==-1&&(clearTimeout(this.renderDecorationsTimer),this.renderDecorationsTimer=-1),this.workerRequest!==null&&(this.workerRequest.cancel(),this.workerRequest=null),this.workerRequestCompleted||(this.workerRequestTokenId++,this.workerRequestCompleted=!0)}_stopAll(e){this._removeAllDecorations(e),this.renderDecorationsTimer!==-1&&(clearTimeout(this.renderDecorationsTimer),this.renderDecorationsTimer=-1),this.workerRequest!==null&&(this.workerRequest.cancel(),this.workerRequest=null),this.workerRequestCompleted||(this.workerRequestTokenId++,this.workerRequestCompleted=!0)}_onPositionChanged(e){var t;if(this.occurrencesHighlight==="off"){this._stopAll();return}if(e.reason!==3&&((t=this.editor.getModel())==null?void 0:t.uri.scheme)!==gt.vscodeNotebookCell){this._stopAll();return}this._run()}_getWord(){const e=this.editor.getSelection(),t=e.startLineNumber,i=e.startColumn;return this.model.isDisposed()?null:this.model.getWordAtPosition({lineNumber:t,column:i})}getOtherModelsToHighlight(e){if(!e)return[];if(e.uri.scheme===gt.vscodeNotebookCell){const r=[],o=this.codeEditorService.listCodeEditors();for(const a of o){const l=a.getModel();l&&l!==e&&l.uri.scheme===gt.vscodeNotebookCell&&r.push(l)}return r}const i=[],n=this.codeEditorService.listCodeEditors();for(const r of n){if(!iQ(r))continue;const o=r.getModel();o&&e===o.modified&&i.push(o.modified)}if(i.length)return i;if(this.occurrencesHighlight==="singleFile")return[];for(const r of n){const o=r.getModel();o&&o!==e&&i.push(o)}return i}_run(e){var n,r;let t;if(this.editor.hasTextFocus()){const o=this.editor.getSelection();if(!o||o.startLineNumber!==o.endLineNumber){Vn.query=null,this._stopAll();return}const a=o.startColumn,l=o.endColumn,c=this._getWord();if(!c||c.startColumn>a||c.endColumn<l){Vn.query=null,this._stopAll();return}t=this.workerRequest&&this.workerRequest.isValid(this.model,o,this.decorations),Vn.query={modelInfo:{model:this.model,selection:o},word:c}}else if(!Vn.query){this._stopAll();return}if(this.lastCursorPositionChangeTime=new Date().getTime(),t)this.workerRequestCompleted&&this.renderDecorationsTimer!==-1&&(clearTimeout(this.renderDecorationsTimer),this.renderDecorationsTimer=-1,this._beginRenderDecorations());else if(wI(this.editor.getModel().uri,(n=Vn.query.modelInfo)==null?void 0:n.model.uri)){if(!e){const l=this.decorations.getRanges();for(const c of l)if(c.containsPosition(this.editor.getPosition()))return}this._stopAll(e?this.model:void 0);const o=++this.workerRequestTokenId;this.workerRequestCompleted=!1;const a=this.getOtherModelsToHighlight(this.editor.getModel());if(!Vn.query||!Vn.query.modelInfo||Vn.query.modelInfo.model.isDisposed())return;this.workerRequest=this.computeWithModel(Vn.query.modelInfo.model,Vn.query.modelInfo.selection,Vn.query.word,a),(r=this.workerRequest)==null||r.result.then(l=>{o===this.workerRequestTokenId&&(this.workerRequestCompleted=!0,this.workerRequestValue=l||[],this._beginRenderDecorations())},ft)}}computeWithModel(e,t,i,n){return n.length?Unt(this.multiDocumentProviders,e,t,i,this.editor.getOption(132),n):znt(this.providers,e,t,i,this.editor.getOption(132))}_beginRenderDecorations(){const e=new Date().getTime(),t=this.lastCursorPositionChangeTime+250;e>=t?(this.renderDecorationsTimer=-1,this.renderDecorations()):this.renderDecorationsTimer=setTimeout(()=>{this.renderDecorations()},t-e)}renderDecorations(){var t,i,n;this.renderDecorationsTimer=-1;const e=this.codeEditorService.listCodeEditors();for(const r of e){const o=o_.get(r);if(!o)continue;const a=[],l=(t=r.getModel())==null?void 0:t.uri;if(l&&this.workerRequestValue.has(l)){const c=Vn.storedDecorationIDs.get(l),d=this.workerRequestValue.get(l);if(d)for(const h of d)h.range&&a.push({range:h.range,options:Ntt(h.kind)});let u=[];r.changeDecorations(h=>{u=h.deltaDecorations(c??[],a)}),Vn.storedDecorationIDs=Vn.storedDecorationIDs.set(l,u),a.length>0&&((i=o.wordHighlighter)==null||i.decorations.set(a),(n=o.wordHighlighter)==null||n._hasWordHighlights.set(!0))}}}dispose(){this._stopSingular(),this.toUnhook.dispose()}},Vn=Nm,Nm.storedDecorationIDs=new Fs,Nm.query=null,Nm);zj=Vn=hve([s2(4,ni)],zj);var Jv;let o_=(Jv=class extends te{static get(e){return e.getContribution(Hj.ID)}constructor(e,t,i,n){super(),this._wordHighlighter=null;const r=()=>{e.hasModel()&&!e.getModel().isTooLargeForTokenization()&&(this._wordHighlighter=new zj(e,i.documentHighlightProvider,i.multiDocumentHighlightProvider,t,n))};this._register(e.onDidChangeModel(o=>{this._wordHighlighter&&(this._wordHighlighter.dispose(),this._wordHighlighter=null),r()})),r()}get wordHighlighter(){return this._wordHighlighter}saveViewState(){return!!(this._wordHighlighter&&this._wordHighlighter.hasDecorations())}moveNext(){var e;(e=this._wordHighlighter)==null||e.moveNext()}moveBack(){var e;(e=this._wordHighlighter)==null||e.moveBack()}restoreViewState(e){this._wordHighlighter&&e&&this._wordHighlighter.restore()}dispose(){this._wordHighlighter&&(this._wordHighlighter.dispose(),this._wordHighlighter=null),super.dispose()}},Hj=Jv,Jv.ID="editor.contrib.wordHighlighter",Jv);o_=Hj=hve([s2(1,ct),s2(2,Be),s2(3,ni)],o_);class pve extends Ve{constructor(e,t){super(t),this._isNext=e}run(e,t){const i=o_.get(t);i&&(this._isNext?i.moveNext():i.moveBack())}}class jnt extends pve{constructor(){super(!0,{id:"editor.action.wordHighlight.next",label:b("wordHighlight.next.label","Go to Next Symbol Highlight"),alias:"Go to Next Symbol Highlight",precondition:YQ,kbOpts:{kbExpr:z.editorTextFocus,primary:65,weight:100}})}}class $nt extends pve{constructor(){super(!1,{id:"editor.action.wordHighlight.prev",label:b("wordHighlight.previous.label","Go to Previous Symbol Highlight"),alias:"Go to Previous Symbol Highlight",precondition:YQ,kbOpts:{kbExpr:z.editorTextFocus,primary:1089,weight:100}})}}class qnt extends Ve{constructor(){super({id:"editor.action.wordHighlight.trigger",label:b("wordHighlight.trigger.label","Trigger Symbol Highlight"),alias:"Trigger Symbol Highlight",precondition:void 0,kbOpts:{kbExpr:z.editorTextFocus,primary:0,weight:100}})}run(e,t,i){const n=o_.get(t);n&&n.restoreViewState(!0)}}Zt(o_.ID,o_,0);ye(jnt);ye($nt);ye(qnt);LS(Wj);class N5 extends fs{constructor(e){super(e),this._inSelectionMode=e.inSelectionMode,this._wordNavigationType=e.wordNavigationType}runEditorCommand(e,t,i){if(!t.hasModel())return;const n=wc(t.getOption(132),t.getOption(131)),r=t.getModel(),o=t.getSelections(),a=o.length>1,l=o.map(c=>{const d=new X(c.positionLineNumber,c.positionColumn),u=this._move(n,r,d,this._wordNavigationType,a);return this._moveTo(c,u,this._inSelectionMode)});if(r.pushStackElement(),t._getViewModel().setCursorStates("moveWordCommand",3,l.map(c=>ti.fromModelSelection(c))),l.length===1){const c=new X(l[0].positionLineNumber,l[0].positionColumn);t.revealPosition(c,0)}}_moveTo(e,t,i){return i?new Ue(e.selectionStartLineNumber,e.selectionStartColumn,t.lineNumber,t.column):new Ue(t.lineNumber,t.column,t.lineNumber,t.column)}}class y_ extends N5{_move(e,t,i,n,r){return hi.moveWordLeft(e,t,i,n,r)}}class S_ extends N5{_move(e,t,i,n,r){return hi.moveWordRight(e,t,i,n)}}class Knt extends y_{constructor(){super({inSelectionMode:!1,wordNavigationType:0,id:"cursorWordStartLeft",precondition:void 0})}}class Gnt extends y_{constructor(){super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordEndLeft",precondition:void 0})}}class Qnt extends y_{constructor(){var e;super({inSelectionMode:!1,wordNavigationType:1,id:"cursorWordLeft",precondition:void 0,kbOpts:{kbExpr:he.and(z.textInputFocus,(e=he.and(XE,$F))==null?void 0:e.negate()),primary:2063,mac:{primary:527},weight:100}})}}class Ynt extends y_{constructor(){super({inSelectionMode:!0,wordNavigationType:0,id:"cursorWordStartLeftSelect",precondition:void 0})}}class Xnt extends y_{constructor(){super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordEndLeftSelect",precondition:void 0})}}class Znt extends y_{constructor(){var e;super({inSelectionMode:!0,wordNavigationType:1,id:"cursorWordLeftSelect",precondition:void 0,kbOpts:{kbExpr:he.and(z.textInputFocus,(e=he.and(XE,$F))==null?void 0:e.negate()),primary:3087,mac:{primary:1551},weight:100}})}}class Jnt extends y_{constructor(){super({inSelectionMode:!1,wordNavigationType:3,id:"cursorWordAccessibilityLeft",precondition:void 0})}_move(e,t,i,n,r){return super._move(wc(bu.wordSeparators.defaultValue,e.intlSegmenterLocales),t,i,n,r)}}class est extends y_{constructor(){super({inSelectionMode:!0,wordNavigationType:3,id:"cursorWordAccessibilityLeftSelect",precondition:void 0})}_move(e,t,i,n,r){return super._move(wc(bu.wordSeparators.defaultValue,e.intlSegmenterLocales),t,i,n,r)}}class tst extends S_{constructor(){super({inSelectionMode:!1,wordNavigationType:0,id:"cursorWordStartRight",precondition:void 0})}}class ist extends S_{constructor(){var e;super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordEndRight",precondition:void 0,kbOpts:{kbExpr:he.and(z.textInputFocus,(e=he.and(XE,$F))==null?void 0:e.negate()),primary:2065,mac:{primary:529},weight:100}})}}class nst extends S_{constructor(){super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordRight",precondition:void 0})}}class sst extends S_{constructor(){super({inSelectionMode:!0,wordNavigationType:0,id:"cursorWordStartRightSelect",precondition:void 0})}}class rst extends S_{constructor(){var e;super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordEndRightSelect",precondition:void 0,kbOpts:{kbExpr:he.and(z.textInputFocus,(e=he.and(XE,$F))==null?void 0:e.negate()),primary:3089,mac:{primary:1553},weight:100}})}}class ost extends S_{constructor(){super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordRightSelect",precondition:void 0})}}class ast extends S_{constructor(){super({inSelectionMode:!1,wordNavigationType:3,id:"cursorWordAccessibilityRight",precondition:void 0})}_move(e,t,i,n,r){return super._move(wc(bu.wordSeparators.defaultValue,e.intlSegmenterLocales),t,i,n,r)}}class lst extends S_{constructor(){super({inSelectionMode:!0,wordNavigationType:3,id:"cursorWordAccessibilityRightSelect",precondition:void 0})}_move(e,t,i,n,r){return super._move(wc(bu.wordSeparators.defaultValue,e.intlSegmenterLocales),t,i,n,r)}}class R5 extends fs{constructor(e){super(e),this._whitespaceHeuristics=e.whitespaceHeuristics,this._wordNavigationType=e.wordNavigationType}runEditorCommand(e,t,i){const n=e.get(bn);if(!t.hasModel())return;const r=wc(t.getOption(132),t.getOption(131)),o=t.getModel(),a=t.getSelections(),l=t.getOption(6),c=t.getOption(11),d=n.getLanguageConfiguration(o.getLanguageId()).getAutoClosingPairs(),u=t._getViewModel(),h=a.map(g=>{const p=this._delete({wordSeparators:r,model:o,selection:g,whitespaceHeuristics:this._whitespaceHeuristics,autoClosingDelete:t.getOption(9),autoClosingBrackets:l,autoClosingQuotes:c,autoClosingPairs:d,autoClosedCharacters:u.getCursorAutoClosedCharacters()},this._wordNavigationType);return new dr(p,"")});t.pushUndoStop(),t.executeCommands(this.id,h),t.pushUndoStop()}}class XQ extends R5{_delete(e,t){const i=hi.deleteWordLeft(e,t);return i||new F(1,1,1,1)}}class ZQ extends R5{_delete(e,t){const i=hi.deleteWordRight(e,t);if(i)return i;const n=e.model.getLineCount(),r=e.model.getLineMaxColumn(n);return new F(n,r,n,r)}}class cst extends XQ{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:0,id:"deleteWordStartLeft",precondition:z.writable})}}class dst extends XQ{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:2,id:"deleteWordEndLeft",precondition:z.writable})}}class ust extends XQ{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:0,id:"deleteWordLeft",precondition:z.writable,kbOpts:{kbExpr:z.textInputFocus,primary:2049,mac:{primary:513},weight:100}})}}class hst extends ZQ{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:0,id:"deleteWordStartRight",precondition:z.writable})}}class fst extends ZQ{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:2,id:"deleteWordEndRight",precondition:z.writable})}}class gst extends ZQ{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:2,id:"deleteWordRight",precondition:z.writable,kbOpts:{kbExpr:z.textInputFocus,primary:2068,mac:{primary:532},weight:100}})}}class pst extends Ve{constructor(){super({id:"deleteInsideWord",precondition:z.writable,label:b("deleteInsideWord","Delete Word"),alias:"Delete Word"})}run(e,t,i){if(!t.hasModel())return;const n=wc(t.getOption(132),t.getOption(131)),r=t.getModel(),a=t.getSelections().map(l=>{const c=hi.deleteInsideWord(n,r,l);return new dr(c,"")});t.pushUndoStop(),t.executeCommands(this.id,a),t.pushUndoStop()}}Me(new Knt);Me(new Gnt);Me(new Qnt);Me(new Ynt);Me(new Xnt);Me(new Znt);Me(new tst);Me(new ist);Me(new nst);Me(new sst);Me(new rst);Me(new ost);Me(new Jnt);Me(new est);Me(new ast);Me(new lst);Me(new cst);Me(new dst);Me(new ust);Me(new hst);Me(new fst);Me(new gst);ye(pst);class mst extends R5{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:0,id:"deleteWordPartLeft",precondition:z.writable,kbOpts:{kbExpr:z.textInputFocus,primary:0,mac:{primary:769},weight:100}})}_delete(e,t){const i=i5.deleteWordPartLeft(e);return i||new F(1,1,1,1)}}class _st extends R5{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:2,id:"deleteWordPartRight",precondition:z.writable,kbOpts:{kbExpr:z.textInputFocus,primary:0,mac:{primary:788},weight:100}})}_delete(e,t){const i=i5.deleteWordPartRight(e);if(i)return i;const n=e.model.getLineCount(),r=e.model.getLineMaxColumn(n);return new F(n,r,n,r)}}class mve extends N5{_move(e,t,i,n,r){return i5.moveWordPartLeft(e,t,i,r)}}class bst extends mve{constructor(){super({inSelectionMode:!1,wordNavigationType:0,id:"cursorWordPartLeft",precondition:void 0,kbOpts:{kbExpr:z.textInputFocus,primary:0,mac:{primary:783},weight:100}})}}Gt.registerCommandAlias("cursorWordPartStartLeft","cursorWordPartLeft");class vst extends mve{constructor(){super({inSelectionMode:!0,wordNavigationType:0,id:"cursorWordPartLeftSelect",precondition:void 0,kbOpts:{kbExpr:z.textInputFocus,primary:0,mac:{primary:1807},weight:100}})}}Gt.registerCommandAlias("cursorWordPartStartLeftSelect","cursorWordPartLeftSelect");class _ve extends N5{_move(e,t,i,n,r){return i5.moveWordPartRight(e,t,i)}}class wst extends _ve{constructor(){super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordPartRight",precondition:void 0,kbOpts:{kbExpr:z.textInputFocus,primary:0,mac:{primary:785},weight:100}})}}class Cst extends _ve{constructor(){super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordPartRightSelect",precondition:void 0,kbOpts:{kbExpr:z.textInputFocus,primary:0,mac:{primary:1809},weight:100}})}}Me(new mst);Me(new _st);Me(new bst);Me(new vst);Me(new wst);Me(new Cst);const uY=class uY extends te{constructor(e){super(),this.editor=e,this._register(this.editor.onDidAttemptReadOnlyEdit(()=>this._onDidAttemptReadOnlyEdit()))}_onDidAttemptReadOnlyEdit(){const e=Aa.get(this.editor);if(e&&this.editor.hasModel()){let t=this.editor.getOptions().get(93);t||(this.editor.isSimpleWidget?t=new Lr(b("editor.simple.readonly","Cannot edit in read-only input")):t=new Lr(b("editor.readonly","Cannot edit in read-only editor"))),e.showMessage(t,this.editor.getPosition())}}};uY.ID="editor.contrib.readOnlyMessageController";let SM=uY;Zt(SM.ID,SM,2);var yst=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},tae=function(s,e){return function(t,i){e(t,i,s)}};let Uj=class extends te{constructor(e,t,i){super(),this._textModel=e,this._languageFeaturesService=t,this._outlineModelService=i,this._currentModel=Rt(this,void 0);const n=cr("documentSymbolProvider.onDidChange",this._languageFeaturesService.documentSymbolProvider.onDidChange),r=cr("_textModel.onDidChangeContent",De.debounce(o=>this._textModel.onDidChangeContent(o),()=>{},100));this._register(Jo(async(o,a)=>{n.read(o),r.read(o);const l=a.add(new oje),c=await this._outlineModelService.getOrCreate(this._textModel,l.token);a.isDisposed||this._currentModel.set(c,void 0)}))}getBreadcrumbItems(e,t){const i=this._currentModel.read(t);if(!i)return[];const n=i.asListOfDocumentSymbols().filter(r=>e.contains(r.range.startLineNumber)&&!e.contains(r.range.endLineNumber));return n.sort(Qde(Co(r=>r.range.endLineNumber-r.range.startLineNumber,td))),n.map(r=>({name:r.name,kind:r.kind,startLineNumber:r.range.startLineNumber}))}};Uj=yst([tae(1,Be),tae(2,SD)],Uj);SP.setBreadcrumbsSourceFactory((s,e)=>e.createInstance(Uj,s));const hY=class hY extends te{constructor(e){super(),this.editor=e,this.widget=null,du&&(this._register(e.onDidChangeConfiguration(()=>this.update())),this.update())}update(){const e=!this.editor.getOption(92);!this.widget&&e?this.widget=new jj(this.editor):this.widget&&!e&&(this.widget.dispose(),this.widget=null)}dispose(){super.dispose(),this.widget&&(this.widget.dispose(),this.widget=null)}};hY.ID="editor.contrib.iPadShowKeyboard";let xM=hY;const r4=class r4 extends te{constructor(e){super(),this.editor=e,this._domNode=document.createElement("textarea"),this._domNode.className="iPadShowKeyboard",this._register(oe(this._domNode,"touchstart",t=>{this.editor.focus()})),this._register(oe(this._domNode,"focus",t=>{this.editor.focus()})),this.editor.addOverlayWidget(this)}dispose(){this.editor.removeOverlayWidget(this),super.dispose()}getId(){return r4.ID}getDomNode(){return this._domNode}getPosition(){return{preference:1}}};r4.ID="editor.contrib.ShowKeyboardWidget";let jj=r4;Zt(xM.ID,xM,3);var Sst=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},iae=function(s,e){return function(t,i){e(t,i,s)}},$j,ew;let SE=(ew=class extends te{static get(e){return e.getContribution($j.ID)}constructor(e,t,i){super(),this._editor=e,this._languageService=i,this._widget=null,this._register(this._editor.onDidChangeModel(n=>this.stop())),this._register(this._editor.onDidChangeModelLanguage(n=>this.stop())),this._register(Ln.onDidChange(n=>this.stop())),this._register(this._editor.onKeyUp(n=>n.keyCode===9&&this.stop()))}dispose(){this.stop(),super.dispose()}launch(){this._widget||this._editor.hasModel()&&(this._widget=new qj(this._editor,this._languageService))}stop(){this._widget&&(this._widget.dispose(),this._widget=null)}},$j=ew,ew.ID="editor.contrib.inspectTokens",ew);SE=$j=Sst([iae(1,Wl),iae(2,un)],SE);class xst extends Ve{constructor(){super({id:"editor.action.inspectTokens",label:J6.inspectTokensAction,alias:"Developer: Inspect Tokens",precondition:void 0})}run(e,t){const i=SE.get(t);i==null||i.launch()}}function Lst(s){let e="";for(let t=0,i=s.length;t<i;t++){const n=s.charCodeAt(t);switch(n){case 9:e+="→";break;case 32:e+="·";break;default:e+=String.fromCharCode(n)}}return e}function kst(s,e){const t=Ln.get(e);if(t)return t;const i=s.encodeLanguageId(e);return{getInitialState:()=>S1,tokenize:(n,r,o)=>EK(e,o),tokenizeEncoded:(n,r,o)=>MF(i,o)}}const o4=class o4 extends te{constructor(e,t){super(),this.allowEditorOverflow=!0,this._editor=e,this._languageService=t,this._model=this._editor.getModel(),this._domNode=document.createElement("div"),this._domNode.className="tokens-inspect-widget",this._tokenizationSupport=kst(this._languageService.languageIdCodec,this._model.getLanguageId()),this._compute(this._editor.getPosition()),this._register(this._editor.onDidChangeCursorPosition(i=>this._compute(this._editor.getPosition()))),this._editor.addContentWidget(this)}dispose(){this._editor.removeContentWidget(this),super.dispose()}getId(){return o4._ID}_compute(e){const t=this._getTokensAtLine(e.lineNumber);let i=0;for(let l=t.tokens1.length-1;l>=0;l--){const c=t.tokens1[l];if(e.column-1>=c.offset){i=l;break}}let n=0;for(let l=t.tokens2.length>>>1;l>=0;l--)if(e.column-1>=t.tokens2[l<<1]){n=l;break}const r=this._model.getLineContent(e.lineNumber);let o="";if(i<t.tokens1.length){const l=t.tokens1[i].offset,c=i+1<t.tokens1.length?t.tokens1[i+1].offset:r.length;o=r.substring(l,c)}Xs(this._domNode,ke("h2.tm-token",void 0,Lst(o),ke("span.tm-token-length",void 0,`${o.length} ${o.length===1?"char":"chars"}`))),me(this._domNode,ke("hr.tokens-inspect-separator",{style:"clear:both"}));const a=(n<<1)+1<t.tokens2.length?this._decodeMetadata(t.tokens2[(n<<1)+1]):null;me(this._domNode,ke("table.tm-metadata-table",void 0,ke("tbody",void 0,ke("tr",void 0,ke("td.tm-metadata-key",void 0,"language"),ke("td.tm-metadata-value",void 0,`${a?a.languageId:"-?-"}`)),ke("tr",void 0,ke("td.tm-metadata-key",void 0,"token type"),ke("td.tm-metadata-value",void 0,`${a?this._tokenTypeToString(a.tokenType):"-?-"}`)),ke("tr",void 0,ke("td.tm-metadata-key",void 0,"font style"),ke("td.tm-metadata-value",void 0,`${a?this._fontStyleToString(a.fontStyle):"-?-"}`)),ke("tr",void 0,ke("td.tm-metadata-key",void 0,"foreground"),ke("td.tm-metadata-value",void 0,`${a?fe.Format.CSS.formatHex(a.foreground):"-?-"}`)),ke("tr",void 0,ke("td.tm-metadata-key",void 0,"background"),ke("td.tm-metadata-value",void 0,`${a?fe.Format.CSS.formatHex(a.background):"-?-"}`))))),me(this._domNode,ke("hr.tokens-inspect-separator")),i<t.tokens1.length&&me(this._domNode,ke("span.tm-token-type",void 0,t.tokens1[i].type)),this._editor.layoutContentWidget(this)}_decodeMetadata(e){const t=Ln.getColorMap(),i=Go.getLanguageId(e),n=Go.getTokenType(e),r=Go.getFontStyle(e),o=Go.getForeground(e),a=Go.getBackground(e);return{languageId:this._languageService.languageIdCodec.decodeLanguageId(i),tokenType:n,fontStyle:r,foreground:t[o],background:t[a]}}_tokenTypeToString(e){switch(e){case 0:return"Other";case 1:return"Comment";case 2:return"String";case 3:return"RegEx";default:return"??"}}_fontStyleToString(e){let t="";return e&1&&(t+="italic "),e&2&&(t+="bold "),e&4&&(t+="underline "),e&8&&(t+="strikethrough "),t.length===0&&(t="---"),t}_getTokensAtLine(e){const t=this._getStateBeforeLine(e),i=this._tokenizationSupport.tokenize(this._model.getLineContent(e),!0,t),n=this._tokenizationSupport.tokenizeEncoded(this._model.getLineContent(e),!0,t);return{startState:t,tokens1:i.tokens,tokens2:n.tokens,endState:i.endState}}_getStateBeforeLine(e){let t=this._tokenizationSupport.getInitialState();for(let i=1;i<e;i++)t=this._tokenizationSupport.tokenize(this._model.getLineContent(i),!0,t).endState;return t}getDomNode(){return this._domNode}getPosition(){return{position:this._editor.getPosition(),preference:[2,1]}}};o4._ID="editor.contrib.inspectTokensWidget";let qj=o4;Zt(SE.ID,SE,4);ye(xst);var Ist=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},nae=function(s,e){return function(t,i){e(t,i,s)}},vL,tw;let Kj=(tw=class{constructor(e,t){this.quickInputService=e,this.keybindingService=t,this.registry=_n.as(Yw.Quickaccess)}provide(e){const t=new ce;return t.add(e.onDidAccept(()=>{const[i]=e.selectedItems;i&&this.quickInputService.quickAccess.show(i.prefix,{preserveValue:!0})})),t.add(e.onDidChangeValue(i=>{const n=this.registry.getQuickAccessProvider(i.substr(vL.PREFIX.length));n&&n.prefix&&n.prefix!==vL.PREFIX&&this.quickInputService.quickAccess.show(n.prefix,{preserveValue:!0})})),e.items=this.getQuickAccessProviders().filter(i=>i.prefix!==vL.PREFIX),t}getQuickAccessProviders(){return this.registry.getQuickAccessProviders().sort((t,i)=>t.prefix.localeCompare(i.prefix)).flatMap(t=>this.createPicks(t))}createPicks(e){return e.helpEntries.map(t=>{const i=t.prefix||e.prefix,n=i||"…";return{prefix:i,label:n,keybinding:t.commandId?this.keybindingService.lookupKeybinding(t.commandId):void 0,ariaLabel:b("helpPickAriaLabel","{0}, {1}",n,t.description),description:t.description}})}},vL=tw,tw.PREFIX="?",tw);Kj=vL=Ist([nae(0,kc),nae(1,pi)],Kj);_n.as(Yw.Quickaccess).registerQuickAccessProvider({ctor:Kj,prefix:"",helpEntries:[{description:e8.helpQuickAccessActionLabel}]});class bve{constructor(e){this.options=e,this.rangeHighlightDecorationId=void 0}provide(e,t,i){var o;const n=new ce;e.canAcceptInBackground=!!((o=this.options)!=null&&o.canAcceptInBackground),e.matchOnLabel=e.matchOnDescription=e.matchOnDetail=e.sortByLabel=!1;const r=n.add(new Es);return r.value=this.doProvide(e,t,i),n.add(this.onDidActiveTextEditorControlChange(()=>{r.value=void 0,r.value=this.doProvide(e,t)})),n}doProvide(e,t,i){const n=new ce,r=this.activeTextEditorControl;if(r&&this.canProvideWithTextEditor(r)){const o={editor:r},a=Lme(r);if(a){let l=r.saveViewState()??void 0;n.add(a.onDidChangeCursorPosition(()=>{l=r.saveViewState()??void 0})),o.restoreViewState=()=>{l&&r===this.activeTextEditorControl&&r.restoreViewState(l)},n.add(Wm(t.onCancellationRequested)(()=>{var c;return(c=o.restoreViewState)==null?void 0:c.call(o)}))}n.add(Ye(()=>this.clearDecorations(r))),n.add(this.provideWithTextEditor(o,e,t,i))}else n.add(this.provideWithoutTextEditor(e,t));return n}canProvideWithTextEditor(e){return!0}gotoLocation({editor:e},t){e.setSelection(t.range,"code.jump"),e.revealRangeInCenter(t.range,0),t.preserveFocus||e.focus();const i=e.getModel();i&&"getLineContent"in i&&Mh(`${i.getLineContent(t.range.startLineNumber)}`)}getModel(e){var t;return iQ(e)?(t=e.getModel())==null?void 0:t.modified:e.getModel()}addDecorations(e,t){e.changeDecorations(i=>{const n=[];this.rangeHighlightDecorationId&&(n.push(this.rangeHighlightDecorationId.overviewRulerDecorationId),n.push(this.rangeHighlightDecorationId.rangeHighlightId),this.rangeHighlightDecorationId=void 0);const r=[{range:t,options:{description:"quick-access-range-highlight",className:"rangeHighlight",isWholeLine:!0}},{range:t,options:{description:"quick-access-range-highlight-overview",overviewRuler:{color:kn(mge),position:Il.Full}}}],[o,a]=i.deltaDecorations(n,r);this.rangeHighlightDecorationId={rangeHighlightId:o,overviewRulerDecorationId:a}})}clearDecorations(e){const t=this.rangeHighlightDecorationId;t&&(e.changeDecorations(i=>{i.deltaDecorations([t.overviewRulerDecorationId,t.rangeHighlightId],[])}),this.rangeHighlightDecorationId=void 0)}}const a4=class a4 extends bve{constructor(){super({canAcceptInBackground:!0})}provideWithoutTextEditor(e){const t=b("cannotRunGotoLine","Open a text editor first to go to a line.");return e.items=[{label:t}],e.ariaLabel=t,te.None}provideWithTextEditor(e,t,i){const n=e.editor,r=new ce;r.add(t.onDidAccept(l=>{const[c]=t.selectedItems;if(c){if(!this.isValidLineNumber(n,c.lineNumber))return;this.gotoLocation(e,{range:this.toRange(c.lineNumber,c.column),keyMods:t.keyMods,preserveFocus:l.inBackground}),l.inBackground||t.hide()}}));const o=()=>{const l=this.parsePosition(n,t.value.trim().substr(a4.PREFIX.length)),c=this.getPickLabel(n,l.lineNumber,l.column);if(t.items=[{lineNumber:l.lineNumber,column:l.column,label:c}],t.ariaLabel=c,!this.isValidLineNumber(n,l.lineNumber)){this.clearDecorations(n);return}const d=this.toRange(l.lineNumber,l.column);n.revealRangeInCenter(d,0),this.addDecorations(n,d)};o(),r.add(t.onDidChangeValue(()=>o()));const a=Lme(n);return a&&a.getOptions().get(68).renderType===2&&(a.updateOptions({lineNumbers:"on"}),r.add(Ye(()=>a.updateOptions({lineNumbers:"relative"})))),r}toRange(e=1,t=1){return{startLineNumber:e,startColumn:t,endLineNumber:e,endColumn:t}}parsePosition(e,t){const i=t.split(/,|:|#/).map(r=>parseInt(r,10)).filter(r=>!isNaN(r)),n=this.lineCount(e)+1;return{lineNumber:i[0]>0?i[0]:n+i[0],column:i[1]}}getPickLabel(e,t,i){if(this.isValidLineNumber(e,t))return this.isValidColumn(e,t,i)?b("gotoLineColumnLabel","Go to line {0} and character {1}.",t,i):b("gotoLineLabel","Go to line {0}.",t);const n=e.getPosition()||{lineNumber:1,column:1},r=this.lineCount(e);return r>1?b("gotoLineLabelEmptyWithLimit","Current Line: {0}, Character: {1}. Type a line number between 1 and {2} to navigate to.",n.lineNumber,n.column,r):b("gotoLineLabelEmpty","Current Line: {0}, Character: {1}. Type a line number to navigate to.",n.lineNumber,n.column)}isValidLineNumber(e,t){return!t||typeof t!="number"?!1:t>0&&t<=this.lineCount(e)}isValidColumn(e,t,i){if(!i||typeof i!="number")return!1;const n=this.getModel(e);if(!n)return!1;const r={lineNumber:t,column:i};return n.validatePosition(r).equals(r)}lineCount(e){var t;return((t=this.getModel(e))==null?void 0:t.getLineCount())??0}};a4.PREFIX=":";let Gj=a4;var Est=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Dst=function(s,e){return function(t,i){e(t,i,s)}};let xE=class extends Gj{constructor(e){super(),this.editorService=e,this.onDidActiveTextEditorControlChange=De.None}get activeTextEditorControl(){return this.editorService.getFocusedCodeEditor()??void 0}};xE=Est([Dst(0,ni)],xE);var iw;let vve=(iw=class extends Ve{constructor(){super({id:iw.ID,label:bA.gotoLineActionLabel,alias:"Go to Line/Column...",precondition:void 0,kbOpts:{kbExpr:z.focus,primary:2085,mac:{primary:293},weight:100}})}run(e){e.get(kc).quickAccess.show(xE.PREFIX)}},iw.ID="editor.action.gotoLine",iw);ye(vve);_n.as(Yw.Quickaccess).registerQuickAccessProvider({ctor:xE,prefix:xE.PREFIX,helpEntries:[{description:bA.gotoLineActionLabel,commandId:vve.ID}]});const wve=[void 0,[]];function qB(s,e,t=0,i=0){const n=e;return n.values&&n.values.length>1?Tst(s,n.values,t,i):Cve(s,e,t,i)}function Tst(s,e,t,i){let n=0;const r=[];for(const o of e){const[a,l]=Cve(s,o,t,i);if(typeof a!="number")return wve;n+=a,r.push(...l)}return[n,Nst(r)]}function Cve(s,e,t,i){const n=mw(e.original,e.originalLowercase,t,s,s.toLowerCase(),i,{firstMatchCanBeWeak:!0,boostFullMatch:!0});return n?[n[0],YE(n)]:wve}function Nst(s){const e=s.sort((n,r)=>n.start-r.start),t=[];let i;for(const n of e)!i||!Rst(i,n)?(i=n,t.push(n)):(i.start=Math.min(i.start,n.start),i.end=Math.max(i.end,n.end));return t}function Rst(s,e){return!(s.end<e.start||e.end<s.start)}function sae(s){return s.startsWith('"')&&s.endsWith('"')}const yve=" ";function Qj(s){typeof s!="string"&&(s="");const e=s.toLowerCase(),{pathNormalized:t,normalized:i,normalizedLowercase:n}=rae(s),r=t.indexOf(tu)>=0,o=sae(s);let a;const l=s.split(yve);if(l.length>1)for(const c of l){const d=sae(c),{pathNormalized:u,normalized:h,normalizedLowercase:g}=rae(c);h&&(a||(a=[]),a.push({original:c,originalLowercase:c.toLowerCase(),pathNormalized:u,normalized:h,normalizedLowercase:g,expectContiguousMatch:d}))}return{original:s,originalLowercase:e,pathNormalized:t,normalized:i,normalizedLowercase:n,values:a,containsPathSeparator:r,expectContiguousMatch:o}}function rae(s){let e;gr?e=s.replace(/\//g,tu):e=s.replace(/\\/g,tu);const t=BRe(e).replace(/\s|"/g,"");return{pathNormalized:e,normalized:t,normalizedLowercase:t.toLowerCase()}}function oae(s){return Array.isArray(s)?Qj(s.map(e=>e.original).join(yve)):Qj(s.original)}var Ast=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},aae=function(s,e){return function(t,i){e(t,i,s)}},r2,Qd;let ov=(Qd=class extends bve{constructor(e,t,i=Object.create(null)){super(i),this._languageFeaturesService=e,this._outlineModelService=t,this.options=i,this.options.canAcceptInBackground=!0}provideWithoutTextEditor(e){return this.provideLabelPick(e,b("cannotRunGotoSymbolWithoutEditor","To go to a symbol, first open a text editor with symbol information.")),te.None}provideWithTextEditor(e,t,i,n){const r=e.editor,o=this.getModel(r);return o?this._languageFeaturesService.documentSymbolProvider.has(o)?this.doProvideWithEditorSymbols(e,o,t,i,n):this.doProvideWithoutEditorSymbols(e,o,t,i):te.None}doProvideWithoutEditorSymbols(e,t,i,n){const r=new ce;return this.provideLabelPick(i,b("cannotRunGotoSymbolWithoutSymbolProvider","The active text editor does not provide symbol information.")),(async()=>!await this.waitForLanguageSymbolRegistry(t,r)||n.isCancellationRequested||r.add(this.doProvideWithEditorSymbols(e,t,i,n)))(),r}provideLabelPick(e,t){e.items=[{label:t,index:0,kind:14}],e.ariaLabel=t}async waitForLanguageSymbolRegistry(e,t){if(this._languageFeaturesService.documentSymbolProvider.has(e))return!0;const i=new lS,n=t.add(this._languageFeaturesService.documentSymbolProvider.onDidChange(()=>{this._languageFeaturesService.documentSymbolProvider.has(e)&&(n.dispose(),i.complete(!0))}));return t.add(Ye(()=>i.complete(!1))),i.p}doProvideWithEditorSymbols(e,t,i,n,r){var u;const o=e.editor,a=new ce;a.add(i.onDidAccept(h=>{var p;const[g]=i.selectedItems;g&&g.range&&(this.gotoLocation(e,{range:g.range.selection,keyMods:i.keyMods,preserveFocus:h.inBackground}),(p=r==null?void 0:r.handleAccept)==null||p.call(r,g),h.inBackground||i.hide())})),a.add(i.onDidTriggerItemButton(({item:h})=>{h&&h.range&&(this.gotoLocation(e,{range:h.range.selection,keyMods:i.keyMods,forceSideBySide:!0}),i.hide())}));const l=this.getDocumentSymbols(t,n);let c;const d=async h=>{c==null||c.dispose(!0),i.busy=!1,c=new mn(n),i.busy=!0;try{const g=Qj(i.value.substr(r2.PREFIX.length).trim()),p=await this.doGetSymbolPicks(l,g,void 0,c.token,t);if(n.isCancellationRequested)return;if(p.length>0){if(i.items=p,h&&g.original.length===0){const _=oI(p,v=>!!(v.type!=="separator"&&v.range&&F.containsPosition(v.range.decoration,h)));_&&(i.activeItems=[_])}}else g.original.length>0?this.provideLabelPick(i,b("noMatchingSymbolResults","No matching editor symbols")):this.provideLabelPick(i,b("noSymbolResults","No editor symbols"))}finally{n.isCancellationRequested||(i.busy=!1)}};return a.add(i.onDidChangeValue(()=>d(void 0))),d((u=o.getSelection())==null?void 0:u.getPosition()),a.add(i.onDidChangeActive(()=>{const[h]=i.activeItems;h&&h.range&&(o.revealRangeInCenter(h.range.selection,0),this.addDecorations(o,h.range.decoration))})),a}async doGetSymbolPicks(e,t,i,n,r){var v,C;const o=await e;if(n.isCancellationRequested)return[];const a=t.original.indexOf(r2.SCOPE_PREFIX)===0,l=a?1:0;let c,d;t.values&&t.values.length>1?(c=oae(t.values[0]),d=oae(t.values.slice(1))):c=t;let u;const h=(C=(v=this.options)==null?void 0:v.openSideBySideDirection)==null?void 0:C.call(v);h&&(u=[{iconClass:h==="right"?at.asClassName(xe.splitHorizontal):at.asClassName(xe.splitVertical),tooltip:h==="right"?b("openToSide","Open to the Side"):b("openToBottom","Open to the Bottom")}]);const g=[];for(let y=0;y<o.length;y++){const x=o[y],L=FRe(x.name),I=`$(${O2.toIcon(x.kind).id}) ${L}`,A=I.length-L.length;let D=x.containerName;i!=null&&i.extraContainerLabel&&(D?D=`${i.extraContainerLabel} • ${D}`:D=i.extraContainerLabel);let N,R,W,H;if(t.original.length>l){let B=!1;if(c!==t&&([N,R]=qB(I,{...t,values:void 0},l,A),typeof N=="number"&&(B=!0)),typeof N!="number"&&([N,R]=qB(I,c,l,A),typeof N!="number"))continue;if(!B&&d){if(D&&d.original.length>0&&([W,H]=qB(D,d)),typeof W!="number")continue;typeof N=="number"&&(N+=W)}}const U=x.tags&&x.tags.indexOf(1)>=0;g.push({index:y,kind:x.kind,score:N,label:I,ariaLabel:TRe(x.name,x.kind),description:D,highlights:U?void 0:{label:R,description:H},range:{selection:F.collapseToStart(x.selectionRange),decoration:x.range},uri:r.uri,symbolName:L,strikethrough:U,buttons:u})}const p=g.sort((y,x)=>a?this.compareByKindAndScore(y,x):this.compareByScore(y,x));let _=[];if(a){let I=function(){x&&typeof y=="number"&&L>0&&(x.label=lw(GB[y]||KB,L))},y,x,L=0;for(const A of p)y!==A.kind?(I(),y=A.kind,L=1,x={type:"separator"},_.push(x)):L++,_.push(A);I()}else p.length>0&&(_=[{label:b("symbols","symbols ({0})",g.length),type:"separator"},...p]);return _}compareByScore(e,t){if(typeof e.score!="number"&&typeof t.score=="number")return 1;if(typeof e.score=="number"&&typeof t.score!="number")return-1;if(typeof e.score=="number"&&typeof t.score=="number"){if(e.score>t.score)return-1;if(e.score<t.score)return 1}return e.index<t.index?-1:e.index>t.index?1:0}compareByKindAndScore(e,t){const i=GB[e.kind]||KB,n=GB[t.kind]||KB,r=i.localeCompare(n);return r===0?this.compareByScore(e,t):r}async getDocumentSymbols(e,t){const i=await this._outlineModelService.getOrCreate(e,t);return t.isCancellationRequested?[]:i.asListOfDocumentSymbols()}},r2=Qd,Qd.PREFIX="@",Qd.SCOPE_PREFIX=":",Qd.PREFIX_BY_CATEGORY=`${Qd.PREFIX}${Qd.SCOPE_PREFIX}`,Qd);ov=r2=Ast([aae(0,Be),aae(1,SD)],ov);const KB=b("property","properties ({0})"),GB={5:b("method","methods ({0})"),11:b("function","functions ({0})"),8:b("_constructor","constructors ({0})"),12:b("variable","variables ({0})"),4:b("class","classes ({0})"),22:b("struct","structs ({0})"),23:b("event","events ({0})"),24:b("operator","operators ({0})"),10:b("interface","interfaces ({0})"),2:b("namespace","namespaces ({0})"),3:b("package","packages ({0})"),25:b("typeParameter","type parameters ({0})"),1:b("modules","modules ({0})"),6:b("property","properties ({0})"),9:b("enum","enumerations ({0})"),21:b("enumMember","enumeration members ({0})"),14:b("string","strings ({0})"),0:b("file","files ({0})"),17:b("array","arrays ({0})"),15:b("number","numbers ({0})"),16:b("boolean","booleans ({0})"),18:b("object","objects ({0})"),19:b("key","keys ({0})"),7:b("field","fields ({0})"),13:b("constant","constants ({0})")};var Pst=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},QB=function(s,e){return function(t,i){e(t,i,s)}};let Yj=class extends ov{constructor(e,t,i){super(t,i),this.editorService=e,this.onDidActiveTextEditorControlChange=De.None}get activeTextEditorControl(){return this.editorService.getFocusedCodeEditor()??void 0}};Yj=Pst([QB(0,ni),QB(1,Be),QB(2,SD)],Yj);const l4=class l4 extends Ve{constructor(){super({id:l4.ID,label:yI.quickOutlineActionLabel,alias:"Go to Symbol...",precondition:z.hasDocumentSymbolProvider,kbOpts:{kbExpr:z.focus,primary:3117,weight:100},contextMenuOpts:{group:"navigation",order:3}})}run(e){e.get(kc).quickAccess.show(ov.PREFIX,{itemActivation:zd.NONE})}};l4.ID="editor.action.quickOutline";let LM=l4;ye(LM);_n.as(Yw.Quickaccess).registerQuickAccessProvider({ctor:Yj,prefix:ov.PREFIX,helpEntries:[{description:yI.quickOutlineActionLabel,prefix:ov.PREFIX,commandId:LM.ID},{description:yI.quickOutlineByCategoryActionLabel,prefix:ov.PREFIX_BY_CATEGORY}]});function Mst(s){const e=new Map;for(const t of s)e.set(t,(e.get(t)??0)+1);return e}class fk{constructor(){this.chunkCount=0,this.chunkOccurrences=new Map,this.documents=new Map}calculateScores(e,t){const i=this.computeEmbedding(e),n=new Map,r=[];for(const[o,a]of this.documents){if(t.isCancellationRequested)return[];for(const l of a.chunks){const c=this.computeSimilarityScore(l,i,n);c>0&&r.push({key:o,score:c})}}return r}static termFrequencies(e){return Mst(fk.splitTerms(e))}static*splitTerms(e){const t=i=>i.toLowerCase();for(const[i]of e.matchAll(new RegExp("\\b\\p{Letter}[\\p{Letter}\\d]{2,}\\b","gu"))){yield t(i);const n=i.replace(/([a-z])([A-Z])/g,"$1 $2").split(/\s+/g);if(n.length>1)for(const r of n)r.length>2&&new RegExp("\\p{Letter}{3,}","gu").test(r)&&(yield t(r))}}updateDocuments(e){for(const{key:t}of e)this.deleteDocument(t);for(const t of e){const i=[];for(const n of t.textChunks){const r=fk.termFrequencies(n);for(const o of r.keys())this.chunkOccurrences.set(o,(this.chunkOccurrences.get(o)??0)+1);i.push({text:n,tf:r})}this.chunkCount+=i.length,this.documents.set(t.key,{chunks:i})}return this}deleteDocument(e){const t=this.documents.get(e);if(t){this.documents.delete(e),this.chunkCount-=t.chunks.length;for(const i of t.chunks)for(const n of i.tf.keys()){const r=this.chunkOccurrences.get(n);if(typeof r=="number"){const o=r-1;o<=0?this.chunkOccurrences.delete(n):this.chunkOccurrences.set(n,o)}}}}computeSimilarityScore(e,t,i){let n=0;for(const[r,o]of Object.entries(t)){const a=e.tf.get(r);if(!a)continue;let l=i.get(r);typeof l!="number"&&(l=this.computeIdf(r),i.set(r,l));const c=a*l;n+=c*o}return n}computeEmbedding(e){const t=fk.termFrequencies(e);return this.computeTfidf(t)}computeIdf(e){const t=this.chunkOccurrences.get(e)??0;return t>0?Math.log((this.chunkCount+1)/t):0}computeTfidf(e){const t=Object.create(null);for(const[i,n]of e){const r=this.computeIdf(i);r>0&&(t[i]=n*r)}return t}}function Ost(s){var i;const e=s.slice(0);e.sort((n,r)=>r.score-n.score);const t=((i=e[0])==null?void 0:i.score)??0;if(t>0)for(const n of e)n.score/=t;return e}var $C;(function(s){s[s.NO_ACTION=0]="NO_ACTION",s[s.CLOSE_PICKER=1]="CLOSE_PICKER",s[s.REFRESH_PICKER=2]="REFRESH_PICKER",s[s.REMOVE_ITEM=3]="REMOVE_ITEM"})($C||($C={}));function YB(s){const e=s;return Array.isArray(e.items)}function lae(s){const e=s;return!!e.picks&&e.additionalPicks instanceof Promise}class Fst extends te{constructor(e,t){super(),this.prefix=e,this.options=t}provide(e,t,i){var c;const n=new ce;e.canAcceptInBackground=!!((c=this.options)!=null&&c.canAcceptInBackground),e.matchOnLabel=e.matchOnDescription=e.matchOnDetail=e.sortByLabel=!1;let r;const o=n.add(new Es),a=async()=>{var v;const d=o.value=new ce;r==null||r.dispose(!0),e.busy=!1,r=new mn(t);const u=r.token;let h=e.value.substring(this.prefix.length);(v=this.options)!=null&&v.shouldSkipTrimPickFilter||(h=h.trim());const g=this._getPicks(h,d,u,i),p=(C,y)=>{var I;let x,L;if(YB(C)?(x=C.items,L=C.active):x=C,x.length===0){if(y)return!1;(h.length>0||e.hideInput)&&((I=this.options)!=null&&I.noResultsPick)&&(Kk(this.options.noResultsPick)?x=[this.options.noResultsPick(h)]:x=[this.options.noResultsPick])}return e.items=x,L&&(e.activeItems=[L]),!0},_=async C=>{let y=!1,x=!1;await Promise.all([(async()=>{typeof C.mergeDelay=="number"&&(await Sg(C.mergeDelay),u.isCancellationRequested)||x||(y=p(C.picks,!0))})(),(async()=>{e.busy=!0;try{const L=await C.additionalPicks;if(u.isCancellationRequested)return;let I,A;YB(C.picks)?(I=C.picks.items,A=C.picks.active):I=C.picks;let D,N;if(YB(L)?(D=L.items,N=L.active):D=L,D.length>0||!y){let R;if(!A&&!N){const W=e.activeItems[0];W&&I.indexOf(W)!==-1&&(R=W)}p({items:[...I,...D],active:A||N||R})}}finally{u.isCancellationRequested||(e.busy=!1),x=!0}})()])};if(g!==null)if(lae(g))await _(g);else if(!(g instanceof Promise))p(g);else{e.busy=!0;try{const C=await g;if(u.isCancellationRequested)return;lae(C)?await _(C):p(C)}finally{u.isCancellationRequested||(e.busy=!1)}}};n.add(e.onDidChangeValue(()=>a())),a(),n.add(e.onDidAccept(d=>{var h;if(i!=null&&i.handleAccept){d.inBackground||e.hide(),(h=i.handleAccept)==null||h.call(i,e.activeItems[0]);return}const[u]=e.selectedItems;typeof(u==null?void 0:u.accept)=="function"&&(d.inBackground||e.hide(),u.accept(e.keyMods,d))}));const l=async(d,u)=>{var g;if(typeof u.trigger!="function")return;const h=((g=u.buttons)==null?void 0:g.indexOf(d))??-1;if(h>=0){const p=u.trigger(h,e.keyMods),_=typeof p=="number"?p:await p;if(t.isCancellationRequested)return;switch(_){case $C.NO_ACTION:break;case $C.CLOSE_PICKER:e.hide();break;case $C.REFRESH_PICKER:a();break;case $C.REMOVE_ITEM:{const v=e.items.indexOf(u);if(v!==-1){const C=e.items.slice(),y=C.splice(v,1),x=e.activeItems.filter(I=>I!==y[0]),L=e.keepScrollPosition;e.keepScrollPosition=!0,e.items=C,x&&(e.activeItems=x),e.keepScrollPosition=L}break}}}};return n.add(e.onDidTriggerItemButton(({button:d,item:u})=>l(d,u))),n.add(e.onDidTriggerSeparatorButton(({button:d,separator:u})=>l(d,u))),n}}var Sve=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},Bp=function(s,e){return function(t,i){e(t,i,s)}},gb,as,gh;let Xj=(gh=class extends Fst{constructor(e,t,i,n,r,o){super(gb.PREFIX,e),this.instantiationService=t,this.keybindingService=i,this.commandService=n,this.telemetryService=r,this.dialogService=o,this.commandsHistory=this._register(this.instantiationService.createInstance(Zj)),this.options=e}async _getPicks(e,t,i,n){var g,p;const r=await this.getCommandPicks(i);if(i.isCancellationRequested)return[];const o=Wm(()=>{const _=new fk;_.updateDocuments(r.map(C=>({key:C.commandId,textChunks:[this.getTfIdfChunk(C)]})));const v=_.calculateScores(e,i);return Ost(v).filter(C=>C.score>gb.TFIDF_THRESHOLD).slice(0,gb.TFIDF_MAX_RESULTS)}),a=[];for(const _ of r){const v=gb.WORD_FILTER(e,_.label)??void 0,C=_.commandAlias?gb.WORD_FILTER(e,_.commandAlias)??void 0:void 0;if(v||C)_.highlights={label:v,detail:this.options.showAlias?C:void 0},a.push(_);else if(e===_.commandId)a.push(_);else if(e.length>=3){const y=o();if(i.isCancellationRequested)return[];const x=y.find(L=>L.key===_.commandId);x&&(_.tfIdfScore=x.score,a.push(_))}}const l=new Map;for(const _ of a){const v=l.get(_.label);v?(_.description=_.commandId,v.description=v.commandId):l.set(_.label,_)}a.sort((_,v)=>{if(_.tfIdfScore&&v.tfIdfScore)return _.tfIdfScore===v.tfIdfScore?_.label.localeCompare(v.label):v.tfIdfScore-_.tfIdfScore;if(_.tfIdfScore)return 1;if(v.tfIdfScore)return-1;const C=this.commandsHistory.peek(_.commandId),y=this.commandsHistory.peek(v.commandId);if(C&&y)return C>y?-1:1;if(C)return-1;if(y)return 1;if(this.options.suggestedCommandIds){const x=this.options.suggestedCommandIds.has(_.commandId),L=this.options.suggestedCommandIds.has(v.commandId);if(x&&L)return 0;if(x)return-1;if(L)return 1}return _.label.localeCompare(v.label)});const c=[];let d=!1,u=!0,h=!!this.options.suggestedCommandIds;for(let _=0;_<a.length;_++){const v=a[_];_===0&&this.commandsHistory.peek(v.commandId)&&(c.push({type:"separator",label:b("recentlyUsed","recently used")}),d=!0),u&&v.tfIdfScore!==void 0&&(c.push({type:"separator",label:b("suggested","similar commands")}),u=!1),h&&v.tfIdfScore===void 0&&!this.commandsHistory.peek(v.commandId)&&((g=this.options.suggestedCommandIds)!=null&&g.has(v.commandId))&&(c.push({type:"separator",label:b("commonlyUsed","commonly used")}),d=!0,h=!1),d&&v.tfIdfScore===void 0&&!this.commandsHistory.peek(v.commandId)&&!((p=this.options.suggestedCommandIds)!=null&&p.has(v.commandId))&&(c.push({type:"separator",label:b("morecCommands","other commands")}),d=!1),c.push(this.toCommandPick(v,n))}return this.hasAdditionalCommandPicks(e,i)?{picks:c,additionalPicks:(async()=>{var C;const _=await this.getAdditionalCommandPicks(r,a,e,i);if(i.isCancellationRequested)return[];const v=_.map(y=>this.toCommandPick(y,n));return u&&((C=v[0])==null?void 0:C.type)!=="separator"&&v.unshift({type:"separator",label:b("suggested","similar commands")}),v})()}:c}toCommandPick(e,t){if(e.type==="separator")return e;const i=this.keybindingService.lookupKeybinding(e.commandId),n=i?b("commandPickAriaLabelWithKeybinding","{0}, {1}",e.label,i.getAriaLabel()):e.label;return{...e,ariaLabel:n,detail:this.options.showAlias&&e.commandAlias!==e.label?e.commandAlias:void 0,keybinding:i,accept:async()=>{var r;this.commandsHistory.push(e.commandId),this.telemetryService.publicLog2("workbenchActionExecuted",{id:e.commandId,from:(t==null?void 0:t.from)??"quick open"});try{(r=e.args)!=null&&r.length?await this.commandService.executeCommand(e.commandId,...e.args):await this.commandService.executeCommand(e.commandId)}catch(o){xc(o)||this.dialogService.error(b("canNotRun","Command '{0}' resulted in an error",e.label),NP(o))}}}}getTfIdfChunk({label:e,commandAlias:t,commandDescription:i}){let n=e;return t&&t!==e&&(n+=` - ${t}`),i&&i.value!==e&&(n+=` - ${i.value===i.original?i.value:`${i.value} (${i.original})`}`),n}},gb=gh,gh.PREFIX=">",gh.TFIDF_THRESHOLD=.5,gh.TFIDF_MAX_RESULTS=5,gh.WORD_FILTER=vK(bI,XFe,Dfe),gh);Xj=gb=Sve([Bp(1,Xe),Bp(2,pi),Bp(3,Hi),Bp(4,Tr),Bp(5,KE)],Xj);var Yd;let Zj=(Yd=class extends te{constructor(e,t,i){super(),this.storageService=e,this.configurationService=t,this.logService=i,this.configuredCommandsHistoryLength=0,this.updateConfiguration(),this.load(),this.registerListeners()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>this.updateConfiguration(e))),this._register(this.storageService.onWillSaveState(e=>{e.reason===kI.SHUTDOWN&&this.saveState()}))}updateConfiguration(e){e&&!e.affectsConfiguration("workbench.commandPalette.history")||(this.configuredCommandsHistoryLength=as.getConfiguredCommandHistoryLength(this.configurationService),as.cache&&as.cache.limit!==this.configuredCommandsHistoryLength&&(as.cache.limit=this.configuredCommandsHistoryLength,as.hasChanges=!0))}load(){const e=this.storageService.get(as.PREF_KEY_CACHE,0);let t;if(e)try{t=JSON.parse(e)}catch(n){this.logService.error(`[CommandsHistory] invalid data: ${n}`)}const i=as.cache=new $h(this.configuredCommandsHistoryLength,1);if(t){let n;t.usesLRU?n=t.entries:n=t.entries.sort((r,o)=>r.value-o.value),n.forEach(r=>i.set(r.key,r.value))}as.counter=this.storageService.getNumber(as.PREF_KEY_COUNTER,0,as.counter)}push(e){as.cache&&(as.cache.set(e,as.counter++),as.hasChanges=!0)}peek(e){var t;return(t=as.cache)==null?void 0:t.peek(e)}saveState(){if(!as.cache||!as.hasChanges)return;const e={usesLRU:!0,entries:[]};as.cache.forEach((t,i)=>e.entries.push({key:i,value:t})),this.storageService.store(as.PREF_KEY_CACHE,JSON.stringify(e),0,0),this.storageService.store(as.PREF_KEY_COUNTER,as.counter,0,0),as.hasChanges=!1}static getConfiguredCommandHistoryLength(e){var n,r;const i=(r=(n=e.getValue().workbench)==null?void 0:n.commandPalette)==null?void 0:r.history;return typeof i=="number"?i:as.DEFAULT_COMMANDS_HISTORY_LENGTH}},as=Yd,Yd.DEFAULT_COMMANDS_HISTORY_LENGTH=50,Yd.PREF_KEY_CACHE="commandPalette.mru.cache",Yd.PREF_KEY_COUNTER="commandPalette.mru.counter",Yd.counter=1,Yd.hasChanges=!1,Yd);Zj=as=Sve([Bp(0,md),Bp(1,At),Bp(2,pr)],Zj);class Vst extends Xj{constructor(e,t,i,n,r,o){super(e,t,i,n,r,o)}getCodeEditorCommandPicks(){var i;const e=this.activeTextEditorControl;if(!e)return[];const t=[];for(const n of e.getSupportedActions()){let r;(i=n.metadata)!=null&&i.description&&(Q9e(n.metadata.description)?r=n.metadata.description:r={original:n.metadata.description,value:n.metadata.description}),t.push({commandId:n.id,commandAlias:n.alias,commandDescription:r,label:LK(n.label)||n.id})}return t}}var Bst=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},aC=function(s,e){return function(t,i){e(t,i,s)}};let LE=class extends Vst{get activeTextEditorControl(){return this.codeEditorService.getFocusedCodeEditor()??void 0}constructor(e,t,i,n,r,o){super({showAlias:!1},e,i,n,r,o),this.codeEditorService=t}async getCommandPicks(){return this.getCodeEditorCommandPicks()}hasAdditionalCommandPicks(){return!1}async getAdditionalCommandPicks(){return[]}};LE=Bst([aC(0,Xe),aC(1,ni),aC(2,pi),aC(3,Hi),aC(4,Tr),aC(5,KE)],LE);const c4=class c4 extends Ve{constructor(){super({id:c4.ID,label:vA.quickCommandActionLabel,alias:"Command Palette",precondition:void 0,kbOpts:{kbExpr:z.focus,primary:59,weight:100},contextMenuOpts:{group:"z_commands",order:1}})}run(e){e.get(kc).quickAccess.show(LE.PREFIX)}};c4.ID="editor.action.quickCommand";let kM=c4;ye(kM);_n.as(Yw.Quickaccess).registerQuickAccessProvider({ctor:LE,prefix:LE.PREFIX,helpEntries:[{description:vA.quickCommandHelp,commandId:kM.ID}]});var Wst=function(s,e,t,i){var n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(r=(n<3?o(r):n>3?o(e,t,r):o(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r},lC=function(s,e){return function(t,i){e(t,i,s)}};let Jj=class extends Tw{constructor(e,t,i,n,r,o,a){super(!0,e,t,i,n,r,o,a)}};Jj=Wst([lC(1,ct),lC(2,ni),lC(3,jn),lC(4,Xe),lC(5,md),lC(6,At)],Jj);Zt(Tw.ID,Jj,4);class Hst extends Ve{constructor(){super({id:"editor.action.toggleHighContrast",label:i8.toggleHighContrast,alias:"Toggle High Contrast Theme",precondition:void 0}),this._originalThemeName=null}run(e,t){const i=e.get(Wl),n=i.getColorTheme();su(n.type)?(i.setTheme(this._originalThemeName||(m1(n.type)?Ey:Bf)),this._originalThemeName=null):(i.setTheme(m1(n.type)?tv:iv),this._originalThemeName=n.themeName)}}ye(Hst);const zst=({initialValue:s="",language:e="javascript",onChange:t,onCursorChange:i,cursors:n=[],readOnly:r=!1})=>{const{isDarkMode:o}=hTe(),a=ie.useRef(null),l=ie.useRef([]),c=ie.useCallback(Fee(h=>{t==null||t(h)},200),[t]),d=ie.useCallback(Fee(h=>{i==null||i(h)},50),[i]),u=h=>{a.current=h,h.onDidChangeCursorPosition(g=>{const p=g.position;d({line:p.lineNumber,column:p.column})})};return ie.useEffect(()=>{if(!a.current)return;const h=n.map(g=>({range:new Dme(g.line,g.column,g.line,g.column+1),options:{className:"cursor-decoration",hoverMessage:{value:`${g.userName}'s cursor`},beforeContentClassName:`cursor-${g.userId}`,marginClassName:`cursor-margin-${g.userId}`,after:{content:`  ${g.userName}`,inlineClassName:"cursor-label"}}}));l.current=a.current.deltaDecorations(l.current,h)},[n]),ie.useEffect(()=>()=>{c.cancel(),d.cancel()},[c,d]),E.jsxs("div",{className:"w-full h-full",children:[E.jsx("style",{children:`
          .cursor-decoration {
            background-color: #007acc;
            width: 2px !important;
          }
          .cursor-label {
            font-size: 12px;
            color: #007acc;
            margin-left: 4px;
            opacity: 0.8;
          }
        `}),E.jsx(uTe,{height:"100%",width:"100%",value:s,language:e,theme:o?"vs-dark":"vs-light",onChange:h=>c(h||""),onMount:u,options:{minimap:{enabled:!0},scrollBeyondLastLine:!1,fontSize:14,lineNumbers:"on",readOnly:r,automaticLayout:!0,scrollbar:{useShadows:!1,verticalScrollbarSize:10,horizontalScrollbarSize:10}}})]})},XB="shared-editor",Ust=()=>{const{teamId:s}=J1(),{user:e}=rDe(),[t,i]=ie.useState(""),[n,r]=ie.useState(!0),[o,a]=ie.useState(!1),[l,c]=ie.useState([]),[d,u]=ie.useState(""),[h,g]=ie.useState(0),[p,_]=ie.useState(!1),v=async()=>{var x;if(!(!s||!e||p)){a(!0),u("");try{const L=Cs(Wi,"teams",s),I=await Dh(L);if(!I.exists())throw new Error("Team not found");const A=I.data();if(!((x=A==null?void 0:A.members)!=null&&x[e.uid]))throw new Error("You do not have permission to access this team");const D=Cs(Wi,"teams",s,"collab",XB),N=await Dh(D);if(N.exists()){const R=N.data();i(R.content||""),g(R.version||1),_(!0);return}await $b(D,{content:t,lastModifiedBy:e.uid,lastModifiedAt:LL(),userName:e.displayName||e.email,version:1}),_(!0),g(1)}catch(L){console.error("Error initializing collaboration:",L);const I=L instanceof Error?L.message:"Failed to initialize collaboration";u(`Initialization failed: ${I}. Please try again.`),_(!1)}finally{a(!1)}}};ie.useEffect(()=>{if(!s||!e)return;const x=async()=>{try{const A=Cs(Wi,"teams",s,"collab",XB);return c1(A,N=>{if(N.exists()){const R=N.data();i(R.content),g(R.version),_(!0)}r(!1)})}catch(A){console.error("Error fetching collab data:",A),u("Failed to load collaboration data"),r(!1)}},L=c1(ta(Wi,"teams",s,"cursors"),A=>{const D=A.docs.filter(N=>N.id!==e.uid).map(N=>({userId:N.id,...N.data()}));c(D)}),I=x();return()=>{I.then(A=>A==null?void 0:A()),L()}},[s,e]);const C=async x=>{if(!(!s||!e))try{const L=Cs(Wi,"teams",s,"collab",XB);await $b(L,{content:x,lastModifiedBy:e.uid,lastModifiedAt:LL(),userName:e.displayName||e.email,version:h+1}),g(I=>I+1)}catch(L){console.error("Error saving collab data:",L),u("Failed to save changes. Please try again.")}},y=async x=>{if(!(!s||!e))try{const L=Cs(Wi,"teams",s,"cursors",e.uid);await $b(L,{userId:e.uid,userName:e.displayName||e.email,line:x.line,column:x.column,timestamp:LL()})}catch(L){console.error("Error updating cursor position:",L)}};return n?E.jsx("div",{className:"flex items-center justify-center h-screen",children:"Loading..."}):E.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-950",children:[E.jsx(zn,{}),E.jsx(Un,{}),E.jsx("div",{className:"pl-[var(--sidebar-width)] pt-14 transition-[padding] duration-200",children:E.jsxs("div",{className:"h-[calc(100vh-3.5rem)]",children:[E.jsx("div",{className:"bg-gray-100 dark:bg-gray-900/40 backdrop-blur-xl border-b border-gray-200 dark:border-gray-700/30 p-2 flex items-center justify-between",children:E.jsxs("div",{className:"flex items-center space-x-2",children:[!p&&E.jsx("button",{onClick:v,disabled:o,className:"px-4 py-1.5 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:o?E.jsxs(E.Fragment,{children:[E.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white"}),E.jsx("span",{children:"Initializing..."})]}):"Start Collaboration"}),d&&E.jsx("div",{className:"text-red-500",children:d})]})}),E.jsx(zst,{initialValue:t,onChange:C,onCursorChange:y,cursors:l,readOnly:!p})]})})]})},jst=()=>{const[s,e]=ie.useState("blogs");return E.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-950",children:[E.jsx(zn,{}),E.jsx(Un,{}),E.jsx("div",{className:"pl-[var(--sidebar-width)] pt-14 transition-[padding] duration-200",children:E.jsxs("div",{className:"max-w-7xl mx-auto p-4 md:p-8",children:[E.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8",children:[E.jsxs("div",{children:[E.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Community"}),E.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Share your knowledge and learn from others"})]}),E.jsxs("div",{className:"flex space-x-4 mt-4 md:mt-0",children:[E.jsx(xl,{to:"/community/new-blog",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Write a Blog"}),E.jsx(xl,{to:"/community/ask-question",className:"inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-700 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Ask a Question"})]})]}),E.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700 mb-6",children:E.jsxs("nav",{className:"-mb-px flex space-x-8",children:[E.jsx("button",{onClick:()=>e("blogs"),className:`${s==="blogs"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-700"} whitespace-nowrap pb-4 px-1 border-b-2 font-medium text-sm`,children:"Blogs"}),E.jsx("button",{onClick:()=>e("questions"),className:`${s==="questions"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-700"} whitespace-nowrap pb-4 px-1 border-b-2 font-medium text-sm`,children:"Questions"})]})}),E.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[1fr,300px] gap-6",children:[E.jsx("div",{className:"space-y-6",children:s==="blogs"?E.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"Blog posts will be displayed here"}):E.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"Questions will be displayed here"})}),E.jsxs("div",{className:"space-y-6",children:[E.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-lg p-4",children:[E.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Trending Topics"}),E.jsx("div",{className:"space-y-2",children:["React","TypeScript","Node.js","Python","Machine Learning"].map(t=>E.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 cursor-pointer",children:["#",t]},t))})]}),E.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-lg p-4",children:[E.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Top Contributors"}),E.jsx("div",{className:"space-y-4",children:[1,2,3].map(t=>E.jsxs("div",{className:"flex items-center space-x-3",children:[E.jsx("div",{className:"w-10 h-10 bg-gray-200 dark:bg-gray-700 rounded-full"}),E.jsxs("div",{children:[E.jsxs("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:["User ",t]}),E.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"5 posts"})]})]},t))})]})]})]})]})})]})},xve="@firebase/installations",JQ="0.6.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lve=1e4,kve=`w:${JQ}`,Ive="FIS_v2",$st="https://firebaseinstallations.googleapis.com/v1",qst=60*60*1e3,Kst="installations",Gst="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qst={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Mw=new Fw(Kst,Gst,Qst);function Eve(s){return s instanceof fd&&s.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dve({projectId:s}){return`${$st}/projects/${s}/installations`}function Tve(s){return{token:s.token,requestStatus:2,expiresIn:Xst(s.expiresIn),creationTime:Date.now()}}async function Nve(s,e){const i=(await e.json()).error;return Mw.create("request-failed",{requestName:s,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function Rve({apiKey:s}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":s})}function Yst(s,{refreshToken:e}){const t=Rve(s);return t.append("Authorization",Zst(e)),t}async function Ave(s){const e=await s();return e.status>=500&&e.status<600?s():e}function Xst(s){return Number(s.replace("s","000"))}function Zst(s){return`${Ive} ${s}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jst({appConfig:s,heartbeatServiceProvider:e},{fid:t}){const i=Dve(s),n=Rve(s),r=e.getImmediate({optional:!0});if(r){const c=await r.getHeartbeatsHeader();c&&n.append("x-firebase-client",c)}const o={fid:t,authVersion:Ive,appId:s.appId,sdkVersion:kve},a={method:"POST",headers:n,body:JSON.stringify(o)},l=await Ave(()=>fetch(i,a));if(l.ok){const c=await l.json();return{fid:c.fid||t,registrationStatus:2,refreshToken:c.refreshToken,authToken:Tve(c.authToken)}}else throw await Nve("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pve(s){return new Promise(e=>{setTimeout(e,s)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ert(s){return btoa(String.fromCharCode(...s)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const trt=/^[cdef][\w-]{21}$/,e$="";function irt(){try{const s=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(s),s[0]=112+s[0]%16;const t=nrt(s);return trt.test(t)?t:e$}catch{return e$}}function nrt(s){return ert(s).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A5(s){return`${s.appName}!${s.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mve=new Map;function Ove(s,e){const t=A5(s);Fve(t,e),srt(t,e)}function Fve(s,e){const t=Mve.get(s);if(t)for(const i of t)i(e)}function srt(s,e){const t=rrt();t&&t.postMessage({key:s,fid:e}),ort()}let jb=null;function rrt(){return!jb&&"BroadcastChannel"in self&&(jb=new BroadcastChannel("[Firebase] FID Change"),jb.onmessage=s=>{Fve(s.data.key,s.data.fid)}),jb}function ort(){Mve.size===0&&jb&&(jb.close(),jb=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const art="firebase-installations-database",lrt=1,Ow="firebase-installations-store";let ZB=null;function eY(){return ZB||(ZB=Xae(art,lrt,{upgrade:(s,e)=>{switch(e){case 0:s.createObjectStore(Ow)}}})),ZB}async function IM(s,e){const t=A5(s),n=(await eY()).transaction(Ow,"readwrite"),r=n.objectStore(Ow),o=await r.get(t);return await r.put(e,t),await n.done,(!o||o.fid!==e.fid)&&Ove(s,e.fid),e}async function Vve(s){const e=A5(s),i=(await eY()).transaction(Ow,"readwrite");await i.objectStore(Ow).delete(e),await i.done}async function P5(s,e){const t=A5(s),n=(await eY()).transaction(Ow,"readwrite"),r=n.objectStore(Ow),o=await r.get(t),a=e(o);return a===void 0?await r.delete(t):await r.put(a,t),await n.done,a&&(!o||o.fid!==a.fid)&&Ove(s,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tY(s){let e;const t=await P5(s.appConfig,i=>{const n=crt(i),r=drt(s,n);return e=r.registrationPromise,r.installationEntry});return t.fid===e$?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function crt(s){const e=s||{fid:irt(),registrationStatus:0};return Bve(e)}function drt(s,e){if(e.registrationStatus===0){if(!navigator.onLine){const n=Promise.reject(Mw.create("app-offline"));return{installationEntry:e,registrationPromise:n}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=urt(s,t);return{installationEntry:t,registrationPromise:i}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:hrt(s)}:{installationEntry:e}}async function urt(s,e){try{const t=await Jst(s,e);return IM(s.appConfig,t)}catch(t){throw Eve(t)&&t.customData.serverCode===409?await Vve(s.appConfig):await IM(s.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function hrt(s){let e=await cae(s.appConfig);for(;e.registrationStatus===1;)await Pve(100),e=await cae(s.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:i}=await tY(s);return i||t}return e}function cae(s){return P5(s,e=>{if(!e)throw Mw.create("installation-not-found");return Bve(e)})}function Bve(s){return frt(s)?{fid:s.fid,registrationStatus:0}:s}function frt(s){return s.registrationStatus===1&&s.registrationTime+Lve<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function grt({appConfig:s,heartbeatServiceProvider:e},t){const i=prt(s,t),n=Yst(s,t),r=e.getImmediate({optional:!0});if(r){const c=await r.getHeartbeatsHeader();c&&n.append("x-firebase-client",c)}const o={installation:{sdkVersion:kve,appId:s.appId}},a={method:"POST",headers:n,body:JSON.stringify(o)},l=await Ave(()=>fetch(i,a));if(l.ok){const c=await l.json();return Tve(c)}else throw await Nve("Generate Auth Token",l)}function prt(s,{fid:e}){return`${Dve(s)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iY(s,e=!1){let t;const i=await P5(s.appConfig,r=>{if(!Wve(r))throw Mw.create("not-registered");const o=r.authToken;if(!e&&brt(o))return r;if(o.requestStatus===1)return t=mrt(s,e),r;{if(!navigator.onLine)throw Mw.create("app-offline");const a=wrt(r);return t=_rt(s,a),a}});return t?await t:i.authToken}async function mrt(s,e){let t=await dae(s.appConfig);for(;t.authToken.requestStatus===1;)await Pve(100),t=await dae(s.appConfig);const i=t.authToken;return i.requestStatus===0?iY(s,e):i}function dae(s){return P5(s,e=>{if(!Wve(e))throw Mw.create("not-registered");const t=e.authToken;return Crt(t)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function _rt(s,e){try{const t=await grt(s,e),i=Object.assign(Object.assign({},e),{authToken:t});return await IM(s.appConfig,i),t}catch(t){if(Eve(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await Vve(s.appConfig);else{const i=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await IM(s.appConfig,i)}throw t}}function Wve(s){return s!==void 0&&s.registrationStatus===2}function brt(s){return s.requestStatus===2&&!vrt(s)}function vrt(s){const e=Date.now();return e<s.creationTime||s.creationTime+s.expiresIn<e+qst}function wrt(s){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},s),{authToken:e})}function Crt(s){return s.requestStatus===1&&s.requestTime+Lve<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yrt(s){const e=s,{installationEntry:t,registrationPromise:i}=await tY(e);return i?i.catch(console.error):iY(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Srt(s,e=!1){const t=s;return await xrt(t),(await iY(t,e)).token}async function xrt(s){const{registrationPromise:e}=await tY(s);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lrt(s){if(!s||!s.options)throw JB("App Configuration");if(!s.name)throw JB("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!s.options[t])throw JB(t);return{appName:s.name,projectId:s.options.projectId,apiKey:s.options.apiKey,appId:s.options.appId}}function JB(s){return Mw.create("missing-app-config-values",{valueName:s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hve="installations",krt="installations-internal",Irt=s=>{const e=s.getProvider("app").getImmediate(),t=Lrt(e),i=c_(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},Ert=s=>{const e=s.getProvider("app").getImmediate(),t=c_(e,Hve).getImmediate();return{getId:()=>yrt(t),getToken:n=>Srt(t,n)}};function Drt(){lu(new nd(Hve,Irt,"PUBLIC")),lu(new nd(krt,Ert,"PRIVATE"))}Drt();Ll(xve,JQ);Ll(xve,JQ,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EM="analytics",Trt="firebase_id",Nrt="origin",Rrt=60*1e3,Art="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",nY="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tl=new f4("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Prt={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},mc=new Fw("analytics","Analytics",Prt);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mrt(s){if(!s.startsWith(nY)){const e=mc.create("invalid-gtag-resource",{gtagURL:s});return Tl.warn(e.message),""}return s}function zve(s){return Promise.all(s.map(e=>e.catch(t=>t)))}function Ort(s,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(s,e)),t}function Frt(s,e){const t=Ort("firebase-js-sdk-policy",{createScriptURL:Mrt}),i=document.createElement("script"),n=`${nY}?l=${s}&id=${e}`;i.src=t?t==null?void 0:t.createScriptURL(n):n,i.async=!0,document.head.appendChild(i)}function Vrt(s){let e=[];return Array.isArray(window[s])?e=window[s]:window[s]=e,e}async function Brt(s,e,t,i,n,r){const o=i[n];try{if(o)await e[o];else{const l=(await zve(t)).find(c=>c.measurementId===n);l&&await e[l.appId]}}catch(a){Tl.error(a)}s("config",n,r)}async function Wrt(s,e,t,i,n){try{let r=[];if(n&&n.send_to){let o=n.send_to;Array.isArray(o)||(o=[o]);const a=await zve(t);for(const l of o){const c=a.find(u=>u.measurementId===l),d=c&&e[c.appId];if(d)r.push(d);else{r=[];break}}}r.length===0&&(r=Object.values(e)),await Promise.all(r),s("event",i,n||{})}catch(r){Tl.error(r)}}function Hrt(s,e,t,i){async function n(r,...o){try{if(r==="event"){const[a,l]=o;await Wrt(s,e,t,a,l)}else if(r==="config"){const[a,l]=o;await Brt(s,e,t,i,a,l)}else if(r==="consent"){const[a,l]=o;s("consent",a,l)}else if(r==="get"){const[a,l,c]=o;s("get",a,l,c)}else if(r==="set"){const[a]=o;s("set",a)}else s(r,...o)}catch(a){Tl.error(a)}}return n}function zrt(s,e,t,i,n){let r=function(...o){window[i].push(arguments)};return window[n]&&typeof window[n]=="function"&&(r=window[n]),window[n]=Hrt(r,s,e,t),{gtagCore:r,wrappedGtag:window[n]}}function Urt(s){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(nY)&&t.src.includes(s))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jrt=30,$rt=1e3;class qrt{constructor(e={},t=$rt){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const Uve=new qrt;function Krt(s){return new Headers({Accept:"application/json","x-goog-api-key":s})}async function Grt(s){var e;const{appId:t,apiKey:i}=s,n={method:"GET",headers:Krt(i)},r=Art.replace("{app-id}",t),o=await fetch(r,n);if(o.status!==200&&o.status!==304){let a="";try{const l=await o.json();!((e=l.error)===null||e===void 0)&&e.message&&(a=l.error.message)}catch{}throw mc.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()}async function Qrt(s,e=Uve,t){const{appId:i,apiKey:n,measurementId:r}=s.options;if(!i)throw mc.create("no-app-id");if(!n){if(r)return{measurementId:r,appId:i};throw mc.create("no-api-key")}const o=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new Zrt;return setTimeout(async()=>{a.abort()},Rrt),jve({appId:i,apiKey:n,measurementId:r},o,a,e)}async function jve(s,{throttleEndTimeMillis:e,backoffCount:t},i,n=Uve){var r;const{appId:o,measurementId:a}=s;try{await Yrt(i,e)}catch(l){if(a)return Tl.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:o,measurementId:a};throw l}try{const l=await Grt(s);return n.deleteThrottleMetadata(o),l}catch(l){const c=l;if(!Xrt(c)){if(n.deleteThrottleMetadata(o),a)return Tl.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:o,measurementId:a};throw l}const d=Number((r=c==null?void 0:c.customData)===null||r===void 0?void 0:r.httpStatus)===503?OZ(t,n.intervalMillis,jrt):OZ(t,n.intervalMillis),u={throttleEndTimeMillis:Date.now()+d,backoffCount:t+1};return n.setThrottleMetadata(o,u),Tl.debug(`Calling attemptFetch again in ${d} millis`),jve(s,u,i,n)}}function Yrt(s,e){return new Promise((t,i)=>{const n=Math.max(e-Date.now(),0),r=setTimeout(t,n);s.addEventListener(()=>{clearTimeout(r),i(mc.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function Xrt(s){if(!(s instanceof fd)||!s.customData)return!1;const e=Number(s.customData.httpStatus);return e===429||e===500||e===503||e===504}class Zrt{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function Jrt(s,e,t,i,n){if(n&&n.global){s("event",t,i);return}else{const r=await e,o=Object.assign(Object.assign({},i),{send_to:r});s("event",t,o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eot(){if(Kae())try{await Gae()}catch(s){return Tl.warn(mc.create("indexeddb-unavailable",{errorInfo:s==null?void 0:s.toString()}).message),!1}else return Tl.warn(mc.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function tot(s,e,t,i,n,r,o){var a;const l=Qrt(s);l.then(g=>{t[g.measurementId]=g.appId,s.options.measurementId&&g.measurementId!==s.options.measurementId&&Tl.warn(`The measurement ID in the local Firebase config (${s.options.measurementId}) does not match the measurement ID fetched from the server (${g.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(g=>Tl.error(g)),e.push(l);const c=eot().then(g=>{if(g)return i.getId()}),[d,u]=await Promise.all([l,c]);Urt(r)||Frt(r,d.measurementId),n("js",new Date);const h=(a=o==null?void 0:o.config)!==null&&a!==void 0?a:{};return h[Nrt]="firebase",h.update=!0,u!=null&&(h[Trt]=u),n("config",d.measurementId,h),d.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iot{constructor(e){this.app=e}_delete(){return delete gk[this.app.options.appId],Promise.resolve()}}let gk={},uae=[];const hae={};let e7="dataLayer",not="gtag",fae,$ve,gae=!1;function sot(){const s=[];if(qae()&&s.push("This is a browser extension environment."),jCe()||s.push("Cookies are not available."),s.length>0){const e=s.map((i,n)=>`(${n+1}) ${i}`).join(" "),t=mc.create("invalid-analytics-context",{errorInfo:e});Tl.warn(t.message)}}function rot(s,e,t){sot();const i=s.options.appId;if(!i)throw mc.create("no-app-id");if(!s.options.apiKey)if(s.options.measurementId)Tl.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${s.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw mc.create("no-api-key");if(gk[i]!=null)throw mc.create("already-exists",{id:i});if(!gae){Vrt(e7);const{wrappedGtag:r,gtagCore:o}=zrt(gk,uae,hae,e7,not);$ve=r,fae=o,gae=!0}return gk[i]=tot(s,uae,hae,e,fae,e7,t),new iot(s)}function oot(s=g4()){s=cs(s);const e=c_(s,EM);return e.isInitialized()?e.getImmediate():aot(s)}function aot(s,e={}){const t=c_(s,EM);if(t.isInitialized()){const n=t.getImmediate();if(kh(e,t.getOptions()))return n;throw mc.create("already-initialized")}return t.initialize({options:e})}function qve(s,e,t,i){s=cs(s),Jrt($ve,gk[s.app.options.appId],e,t,i).catch(n=>Tl.error(n))}const pae="@firebase/analytics",mae="0.10.12";function lot(){lu(new nd(EM,(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),n=e.getProvider("installations-internal").getImmediate();return rot(i,n,t)},"PUBLIC")),lu(new nd("analytics-internal",s,"PRIVATE")),Ll(pae,mae),Ll(pae,mae,"esm2017");function s(e){try{const t=e.getProvider(EM).getImmediate();return{logEvent:(i,n,r)=>qve(t,i,n,r)}}catch(t){throw mc.create("interop-component-reg-failed",{reason:t})}}}lot();const cot=()=>{const[s,e]=ie.useState({totalLikes:0,totalViews:0,totalComments:0,projectCount:0}),[t,i]=ie.useState([]),[n,r]=ie.useState(!0),[o,a]=ie.useState(null);return ie.useEffect(()=>{if(!wt.currentUser)return;const l=oot();qve(l,"dashboard_view"),(async()=>{var d;try{const u=ta(Wi,"projects"),h=Eh(u,og("userId","==",(d=wt.currentUser)==null?void 0:d.uid)),g=c1(h,async p=>{const _=p.docs.map(C=>({id:C.id,...C.data()})),v={totalLikes:_.reduce((C,y)=>{var x;return C+(((x=y.likes)==null?void 0:x.length)||0)},0),totalViews:_.reduce((C,y)=>C+(y.views||0),0),totalComments:_.reduce((C,y)=>C+(y.commentCount||0),0),projectCount:_.length};i(_),e(v),r(!1)});return()=>g()}catch(u){console.error("Error fetching analytics:",u),a("Failed to load analytics data"),r(!1)}})()},[]),wt.currentUser?n?E.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-950",children:[E.jsx(zn,{}),E.jsx(Un,{}),E.jsx("div",{className:"pl-[var(--sidebar-width)] pt-14 transition-[padding] duration-200",children:E.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-3.5rem)]",children:E.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})})})]}):o?E.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-950",children:[E.jsx(zn,{}),E.jsx(Un,{}),E.jsx("div",{className:"pl-[var(--sidebar-width)] pt-14 transition-[padding] duration-200",children:E.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-3.5rem)]",children:E.jsx("p",{className:"text-red-500 dark:text-red-400",children:o})})})]}):E.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-950",children:[E.jsx(zn,{}),E.jsx(Un,{}),E.jsx("div",{className:"pl-[var(--sidebar-width)] pt-14 transition-[padding] duration-200",children:E.jsxs("div",{className:"max-w-7xl mx-auto p-4 md:p-8",children:[E.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900 dark:text-white mb-8",children:"Dashboard"}),E.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[E.jsxs("div",{className:"bg-white dark:bg-gray-900 p-6 rounded-xl shadow-sm border border-gray-200 dark:border-gray-800",children:[E.jsxs("div",{className:"flex items-center justify-between mb-4",children:[E.jsx("h3",{className:"text-gray-500 dark:text-gray-400 text-sm font-medium",children:"Total Projects"}),E.jsx("svg",{className:"w-6 h-6 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})]}),E.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:s.projectCount})]}),E.jsxs("div",{className:"bg-white dark:bg-gray-900 p-6 rounded-xl shadow-sm border border-gray-200 dark:border-gray-800",children:[E.jsxs("div",{className:"flex items-center justify-between mb-4",children:[E.jsx("h3",{className:"text-gray-500 dark:text-gray-400 text-sm font-medium",children:"Total Likes"}),E.jsx("svg",{className:"w-6 h-6 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})]}),E.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:s.totalLikes})]}),E.jsxs("div",{className:"bg-white dark:bg-gray-900 p-6 rounded-xl shadow-sm border border-gray-200 dark:border-gray-800",children:[E.jsxs("div",{className:"flex items-center justify-between mb-4",children:[E.jsx("h3",{className:"text-gray-500 dark:text-gray-400 text-sm font-medium",children:"Total Views"}),E.jsxs("svg",{className:"w-6 h-6 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})]}),E.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:s.totalViews})]}),E.jsxs("div",{className:"bg-white dark:bg-gray-900 p-6 rounded-xl shadow-sm border border-gray-200 dark:border-gray-800",children:[E.jsxs("div",{className:"flex items-center justify-between mb-4",children:[E.jsx("h3",{className:"text-gray-500 dark:text-gray-400 text-sm font-medium",children:"Total Comments"}),E.jsx("svg",{className:"w-6 h-6 text-purple-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})]}),E.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:s.totalComments})]})]}),E.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl shadow-sm border border-gray-200 dark:border-gray-800 overflow-hidden",children:[E.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-800",children:E.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Project Performance"})}),E.jsx("div",{className:"overflow-x-auto",children:E.jsxs("table",{className:"w-full",children:[E.jsx("thead",{children:E.jsxs("tr",{className:"bg-gray-50 dark:bg-gray-800/50",children:[E.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Project"}),E.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Likes"}),E.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Views"}),E.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Comments"})]})}),E.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-800",children:t.map(l=>{var c;return E.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800/50",children:[E.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:l.title}),E.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:((c=l.likes)==null?void 0:c.length)||0}),E.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:l.views||0}),E.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:l.commentCount||0})]},l.id)})})]})})]})]})})]}):E.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-950",children:[E.jsx(zn,{}),E.jsx(Un,{}),E.jsx("div",{className:"pl-[var(--sidebar-width)] pt-14 transition-[padding] duration-200",children:E.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-3.5rem)]",children:E.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Please sign in to view your dashboard"})})})]})};function dot(){const[s,e]=ie.useState(null),[t,i]=ie.useState(!0);return ie.useEffect(()=>{const n=localStorage.getItem("user");n&&e(JSON.parse(n));const r=Sle(wt,o=>{e(o),i(!1),o?localStorage.setItem("user",JSON.stringify(o)):localStorage.removeItem("user")});return()=>r()},[]),t?E.jsx("div",{className:"h-screen w-screen flex items-center justify-center bg-gray-950",children:E.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):E.jsx(vCe,{children:E.jsxs(Y0e,{children:[E.jsx(Ho,{path:"/",element:s?E.jsx(pee,{}):E.jsx(Vc,{})}),E.jsx(Ho,{path:"/home",element:s?E.jsx(pee,{}):E.jsx(Vc,{})}),E.jsx(Ho,{path:"/profile",element:s?E.jsx(qEe,{}):E.jsx(Vc,{})}),E.jsx(Ho,{path:"/upload",element:s?E.jsx(KEe,{}):E.jsx(Vc,{})}),E.jsx(Ho,{path:"/:projectId",element:E.jsx(QEe,{})}),E.jsx(Ho,{path:"/projects",element:s?E.jsx(XEe,{}):E.jsx(Vc,{})}),E.jsx(Ho,{path:"/projects/:projectId",element:s?E.jsx(YEe,{}):E.jsx(Vc,{})}),E.jsx(Ho,{path:"/channel/:handle",element:E.jsx(ZEe,{})}),E.jsx(Ho,{path:"/dashboard",element:s?E.jsx(cot,{}):E.jsx(Vc,{})}),E.jsx(Ho,{path:"/teams",element:s?E.jsx(eDe,{}):E.jsx(Vc,{})}),E.jsx(Ho,{path:"/teams/create",element:s?E.jsx(JEe,{}):E.jsx(Vc,{})}),E.jsx(Ho,{path:"/teams/:teamId",element:s?E.jsx(nDe,{}):E.jsx(Vc,{})}),E.jsx(Ho,{path:"/teams/:teamId/meet",element:E.jsx(sDe,{})}),E.jsx(Ho,{path:"/teams/:teamId/editor",element:s?E.jsx(Ust,{}):E.jsx(Vc,{})}),E.jsx(Ho,{path:"/community",element:s?E.jsx(jst,{}):E.jsx(Vc,{})})]})})}o0e.createRoot(document.getElementById("root")).render(E.jsx(ie.StrictMode,{children:E.jsx(dot,{})}));export{fD as m,Kme as t};
